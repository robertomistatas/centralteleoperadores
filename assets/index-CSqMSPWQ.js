(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function PI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pE={exports:{}},Vh={},mE={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kl=Symbol.for("react.element"),NI=Symbol.for("react.portal"),FI=Symbol.for("react.fragment"),DI=Symbol.for("react.strict_mode"),OI=Symbol.for("react.profiler"),bI=Symbol.for("react.provider"),LI=Symbol.for("react.context"),MI=Symbol.for("react.forward_ref"),VI=Symbol.for("react.suspense"),UI=Symbol.for("react.memo"),BI=Symbol.for("react.lazy"),ux=Symbol.iterator;function jI(t){return t===null||typeof t!="object"?null:(t=ux&&t[ux]||t["@@iterator"],typeof t=="function"?t:null)}var gE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xE=Object.assign,vE={};function qo(t,e,r){this.props=t,this.context=e,this.refs=vE,this.updater=r||gE}qo.prototype.isReactComponent={};qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function _E(){}_E.prototype=qo.prototype;function gm(t,e,r){this.props=t,this.context=e,this.refs=vE,this.updater=r||gE}var xm=gm.prototype=new _E;xm.constructor=gm;xE(xm,qo.prototype);xm.isPureReactComponent=!0;var fx=Array.isArray,yE=Object.prototype.hasOwnProperty,vm={current:null},EE={key:!0,ref:!0,__self:!0,__source:!0};function wE(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)yE.call(e,n)&&!EE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),l=0;l<o;l++)c[l]=arguments[l+2];s.children=c}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Kl,type:t,key:i,ref:a,props:s,_owner:vm.current}}function zI(t,e){return{$$typeof:Kl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _m(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kl}function HI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var hx=/\/+/g;function V0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?HI(""+t.key):e.toString(36)}function hf(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Kl:case NI:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+V0(a,0):n,fx(s)?(r="",t!=null&&(r=t.replace(hx,"$&/")+"/"),hf(s,e,r,"",function(l){return l})):s!=null&&(_m(s)&&(s=zI(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(hx,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",fx(t))for(var o=0;o<t.length;o++){i=t[o];var c=n+V0(i,o);a+=hf(i,e,r,c,s)}else if(c=jI(t),typeof c=="function")for(t=c.call(t),o=0;!(i=t.next()).done;)i=i.value,c=n+V0(i,o++),a+=hf(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Nu(t,e,r){if(t==null)return t;var n=[],s=0;return hf(t,n,"","",function(i){return e.call(r,i,s++)}),n}function $I(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Br={current:null},df={transition:null},WI={ReactCurrentDispatcher:Br,ReactCurrentBatchConfig:df,ReactCurrentOwner:vm};function TE(){throw Error("act(...) is not supported in production builds of React.")}Ge.Children={map:Nu,forEach:function(t,e,r){Nu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Nu(t,function(){e++}),e},toArray:function(t){return Nu(t,function(e){return e})||[]},only:function(t){if(!_m(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ge.Component=qo;Ge.Fragment=FI;Ge.Profiler=OI;Ge.PureComponent=gm;Ge.StrictMode=DI;Ge.Suspense=VI;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WI;Ge.act=TE;Ge.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=xE({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=vm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in e)yE.call(e,c)&&!EE.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var l=0;l<c;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:Kl,type:t.type,key:s,ref:i,props:n,_owner:a}};Ge.createContext=function(t){return t={$$typeof:LI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bI,_context:t},t.Consumer=t};Ge.createElement=wE;Ge.createFactory=function(t){var e=wE.bind(null,t);return e.type=t,e};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(t){return{$$typeof:MI,render:t}};Ge.isValidElement=_m;Ge.lazy=function(t){return{$$typeof:BI,_payload:{_status:-1,_result:t},_init:$I}};Ge.memo=function(t,e){return{$$typeof:UI,type:t,compare:e===void 0?null:e}};Ge.startTransition=function(t){var e=df.transition;df.transition={};try{t()}finally{df.transition=e}};Ge.unstable_act=TE;Ge.useCallback=function(t,e){return Br.current.useCallback(t,e)};Ge.useContext=function(t){return Br.current.useContext(t)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(t){return Br.current.useDeferredValue(t)};Ge.useEffect=function(t,e){return Br.current.useEffect(t,e)};Ge.useId=function(){return Br.current.useId()};Ge.useImperativeHandle=function(t,e,r){return Br.current.useImperativeHandle(t,e,r)};Ge.useInsertionEffect=function(t,e){return Br.current.useInsertionEffect(t,e)};Ge.useLayoutEffect=function(t,e){return Br.current.useLayoutEffect(t,e)};Ge.useMemo=function(t,e){return Br.current.useMemo(t,e)};Ge.useReducer=function(t,e,r){return Br.current.useReducer(t,e,r)};Ge.useRef=function(t){return Br.current.useRef(t)};Ge.useState=function(t){return Br.current.useState(t)};Ge.useSyncExternalStore=function(t,e,r){return Br.current.useSyncExternalStore(t,e,r)};Ge.useTransition=function(){return Br.current.useTransition()};Ge.version="18.3.1";mE.exports=Ge;var We=mE.exports;const GI=PI(We);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KI=We,qI=Symbol.for("react.element"),XI=Symbol.for("react.fragment"),YI=Object.prototype.hasOwnProperty,QI=KI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JI={key:!0,ref:!0,__self:!0,__source:!0};function kE(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)YI.call(e,n)&&!JI.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:qI,type:t,key:i,ref:a,props:s,_owner:QI.current}}Vh.Fragment=XI;Vh.jsx=kE;Vh.jsxs=kE;pE.exports=Vh;var R=pE.exports,Md={},AE={exports:{}},fn={},SE={exports:{}},IE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,W){var fe=ie.length;ie.push(W);e:for(;0<fe;){var ke=fe-1>>>1,L=ie[ke];if(0<s(L,W))ie[ke]=W,ie[fe]=L,fe=ke;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var W=ie[0],fe=ie.pop();if(fe!==W){ie[0]=fe;e:for(var ke=0,L=ie.length,K=L>>>1;ke<K;){var G=2*(ke+1)-1,H=ie[G],re=G+1,de=ie[re];if(0>s(H,fe))re<L&&0>s(de,H)?(ie[ke]=de,ie[re]=fe,ke=re):(ie[ke]=H,ie[G]=fe,ke=G);else if(re<L&&0>s(de,fe))ie[ke]=de,ie[re]=fe,ke=re;else break e}}return W}function s(ie,W){var fe=ie.sortIndex-W.sortIndex;return fe!==0?fe:ie.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],f=1,h=null,d=3,m=!1,g=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(ie){for(var W=r(l);W!==null;){if(W.callback===null)n(l);else if(W.startTime<=ie)n(l),W.sortIndex=W.expirationTime,e(c,W);else break;W=r(l)}}function O(ie){if(x=!1,v(ie),!g)if(r(c)!==null)g=!0,Ce(z);else{var W=r(l);W!==null&&_e(O,W.startTime-ie)}}function z(ie,W){g=!1,x&&(x=!1,T(k),k=-1),m=!0;var fe=d;try{for(v(W),h=r(c);h!==null&&(!(h.expirationTime>W)||ie&&!P());){var ke=h.callback;if(typeof ke=="function"){h.callback=null,d=h.priorityLevel;var L=ke(h.expirationTime<=W);W=t.unstable_now(),typeof L=="function"?h.callback=L:h===r(c)&&n(c),v(W)}else n(c);h=r(c)}if(h!==null)var K=!0;else{var G=r(l);G!==null&&_e(O,G.startTime-W),K=!1}return K}finally{h=null,d=fe,m=!1}}var U=!1,_=null,k=-1,A=5,I=-1;function P(){return!(t.unstable_now()-I<A)}function C(){if(_!==null){var ie=t.unstable_now();I=ie;var W=!0;try{W=_(!0,ie)}finally{W?F():(U=!1,_=null)}}else U=!1}var F;if(typeof w=="function")F=function(){w(C)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,he=me.port2;me.port1.onmessage=C,F=function(){he.postMessage(null)}}else F=function(){E(C,0)};function Ce(ie){_=ie,U||(U=!0,F())}function _e(ie,W){k=E(function(){ie(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,Ce(z))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var fe=d;d=W;try{return ie()}finally{d=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,W){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var fe=d;d=ie;try{return W()}finally{d=fe}},t.unstable_scheduleCallback=function(ie,W,fe){var ke=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ke+fe:ke):fe=ke,ie){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=fe+L,ie={id:f++,callback:W,priorityLevel:ie,startTime:fe,expirationTime:L,sortIndex:-1},fe>ke?(ie.sortIndex=fe,e(l,ie),r(c)===null&&ie===r(l)&&(x?(T(k),k=-1):x=!0,_e(O,fe-ke))):(ie.sortIndex=L,e(c,ie),g||m||(g=!0,Ce(z))),ie},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(ie){var W=d;return function(){var fe=d;d=W;try{return ie.apply(this,arguments)}finally{d=fe}}}})(IE);SE.exports=IE;var ZI=SE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eC=We,ln=ZI;function ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CE=new Set,hl={};function Pa(t,e){Fo(t,e),Fo(t+"Capture",e)}function Fo(t,e){for(hl[t]=e,t=0;t<e.length;t++)CE.add(e[t])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vd=Object.prototype.hasOwnProperty,tC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dx={},px={};function rC(t){return Vd.call(px,t)?!0:Vd.call(dx,t)?!1:tC.test(t)?px[t]=!0:(dx[t]=!0,!1)}function nC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sC(t,e,r,n){if(e===null||typeof e>"u"||nC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jr(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var dr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dr[t]=new jr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dr[e]=new jr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dr[t]=new jr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dr[t]=new jr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dr[t]=new jr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dr[t]=new jr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dr[t]=new jr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dr[t]=new jr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dr[t]=new jr(t,5,!1,t.toLowerCase(),null,!1,!1)});var ym=/[\-:]([a-z])/g;function Em(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ym,Em);dr[e]=new jr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ym,Em);dr[e]=new jr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ym,Em);dr[e]=new jr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dr[t]=new jr(t,1,!1,t.toLowerCase(),null,!1,!1)});dr.xlinkHref=new jr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dr[t]=new jr(t,1,!1,t.toLowerCase(),null,!0,!0)});function wm(t,e,r,n){var s=dr.hasOwnProperty(e)?dr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sC(e,r,s,n)&&(r=null),n||s===null?rC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ws=eC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fu=Symbol.for("react.element"),no=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),Tm=Symbol.for("react.strict_mode"),Ud=Symbol.for("react.profiler"),RE=Symbol.for("react.provider"),PE=Symbol.for("react.context"),km=Symbol.for("react.forward_ref"),Bd=Symbol.for("react.suspense"),jd=Symbol.for("react.suspense_list"),Am=Symbol.for("react.memo"),ti=Symbol.for("react.lazy"),NE=Symbol.for("react.offscreen"),mx=Symbol.iterator;function _c(t){return t===null||typeof t!="object"?null:(t=mx&&t[mx]||t["@@iterator"],typeof t=="function"?t:null)}var At=Object.assign,U0;function Ic(t){if(U0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);U0=e&&e[1]||""}return`
`+U0+t}var B0=!1;function j0(t,e){if(!t||B0)return"";B0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=o);break}}}finally{B0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ic(t):""}function iC(t){switch(t.tag){case 5:return Ic(t.type);case 16:return Ic("Lazy");case 13:return Ic("Suspense");case 19:return Ic("SuspenseList");case 0:case 2:case 15:return t=j0(t.type,!1),t;case 11:return t=j0(t.type.render,!1),t;case 1:return t=j0(t.type,!0),t;default:return""}}function zd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case no:return"Portal";case Ud:return"Profiler";case Tm:return"StrictMode";case Bd:return"Suspense";case jd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case PE:return(t.displayName||"Context")+".Consumer";case RE:return(t._context.displayName||"Context")+".Provider";case km:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Am:return e=t.displayName||null,e!==null?e:zd(t.type)||"Memo";case ti:e=t._payload,t=t._init;try{return zd(t(e))}catch{}}return null}function aC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zd(e);case 8:return e===Tm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oC(t){var e=FE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Du(t){t._valueTracker||(t._valueTracker=oC(t))}function DE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=FE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Of(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hd(t,e){var r=e.checked;return At({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function gx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Pi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OE(t,e){e=e.checked,e!=null&&wm(t,"checked",e,!1)}function $d(t,e){OE(t,e);var r=Pi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Wd(t,e.type,Pi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Wd(t,e,r){(e!=="number"||Of(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Cc=Array.isArray;function vo(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Pi(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Gd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ue(91));return At({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vx(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ue(92));if(Cc(r)){if(1<r.length)throw Error(ue(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Pi(r)}}function bE(t,e){var r=Pi(e.value),n=Pi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function _x(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function LE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?LE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ou,ME=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ou=Ou||document.createElement("div"),Ou.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ou.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dl(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var jc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cC=["Webkit","ms","Moz","O"];Object.keys(jc).forEach(function(t){cC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jc[e]=jc[t]})});function VE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||jc.hasOwnProperty(t)&&jc[t]?(""+e).trim():e+"px"}function UE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=VE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var lC=At({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qd(t,e){if(e){if(lC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ue(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ue(62))}}function Xd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yd=null;function Sm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qd=null,_o=null,yo=null;function yx(t){if(t=Yl(t)){if(typeof Qd!="function")throw Error(ue(280));var e=t.stateNode;e&&(e=Hh(e),Qd(t.stateNode,t.type,e))}}function BE(t){_o?yo?yo.push(t):yo=[t]:_o=t}function jE(){if(_o){var t=_o,e=yo;if(yo=_o=null,yx(t),e)for(t=0;t<e.length;t++)yx(e[t])}}function zE(t,e){return t(e)}function HE(){}var z0=!1;function $E(t,e,r){if(z0)return t(e,r);z0=!0;try{return zE(t,e,r)}finally{z0=!1,(_o!==null||yo!==null)&&(HE(),jE())}}function pl(t,e){var r=t.stateNode;if(r===null)return null;var n=Hh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ue(231,e,typeof r));return r}var Jd=!1;if(Ls)try{var yc={};Object.defineProperty(yc,"passive",{get:function(){Jd=!0}}),window.addEventListener("test",yc,yc),window.removeEventListener("test",yc,yc)}catch{Jd=!1}function uC(t,e,r,n,s,i,a,o,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(f){this.onError(f)}}var zc=!1,bf=null,Lf=!1,Zd=null,fC={onError:function(t){zc=!0,bf=t}};function hC(t,e,r,n,s,i,a,o,c){zc=!1,bf=null,uC.apply(fC,arguments)}function dC(t,e,r,n,s,i,a,o,c){if(hC.apply(this,arguments),zc){if(zc){var l=bf;zc=!1,bf=null}else throw Error(ue(198));Lf||(Lf=!0,Zd=l)}}function Na(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function WE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ex(t){if(Na(t)!==t)throw Error(ue(188))}function pC(t){var e=t.alternate;if(!e){if(e=Na(t),e===null)throw Error(ue(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Ex(s),t;if(i===n)return Ex(s),e;i=i.sibling}throw Error(ue(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(ue(189))}}if(r.alternate!==n)throw Error(ue(190))}if(r.tag!==3)throw Error(ue(188));return r.stateNode.current===r?t:e}function GE(t){return t=pC(t),t!==null?KE(t):null}function KE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=KE(t);if(e!==null)return e;t=t.sibling}return null}var qE=ln.unstable_scheduleCallback,wx=ln.unstable_cancelCallback,mC=ln.unstable_shouldYield,gC=ln.unstable_requestPaint,Ot=ln.unstable_now,xC=ln.unstable_getCurrentPriorityLevel,Im=ln.unstable_ImmediatePriority,XE=ln.unstable_UserBlockingPriority,Mf=ln.unstable_NormalPriority,vC=ln.unstable_LowPriority,YE=ln.unstable_IdlePriority,Uh=null,is=null;function _C(t){if(is&&typeof is.onCommitFiberRoot=="function")try{is.onCommitFiberRoot(Uh,t,void 0,(t.current.flags&128)===128)}catch{}}var Bn=Math.clz32?Math.clz32:wC,yC=Math.log,EC=Math.LN2;function wC(t){return t>>>=0,t===0?32:31-(yC(t)/EC|0)|0}var bu=64,Lu=4194304;function Rc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Rc(o):(i&=a,i!==0&&(n=Rc(i)))}else a=r&~s,a!==0?n=Rc(a):i!==0&&(n=Rc(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Bn(e),s=1<<r,n|=t[r],e&=~s;return n}function TC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Bn(i),o=1<<a,c=s[a];c===-1?(!(o&r)||o&n)&&(s[a]=TC(o,e)):c<=e&&(t.expiredLanes|=o),i&=~o}}function ep(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function QE(){var t=bu;return bu<<=1,!(bu&4194240)&&(bu=64),t}function H0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ql(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Bn(e),t[e]=r}function AC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Bn(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Cm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Bn(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var ct=0;function JE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ZE,Rm,ew,tw,rw,tp=!1,Mu=[],gi=null,xi=null,vi=null,ml=new Map,gl=new Map,si=[],SC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tx(t,e){switch(t){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":xi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":ml.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(e.pointerId)}}function Ec(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Yl(e),e!==null&&Rm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function IC(t,e,r,n,s){switch(e){case"focusin":return gi=Ec(gi,t,e,r,n,s),!0;case"dragenter":return xi=Ec(xi,t,e,r,n,s),!0;case"mouseover":return vi=Ec(vi,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return ml.set(i,Ec(ml.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,gl.set(i,Ec(gl.get(i)||null,t,e,r,n,s)),!0}return!1}function nw(t){var e=ia(t.target);if(e!==null){var r=Na(e);if(r!==null){if(e=r.tag,e===13){if(e=WE(r),e!==null){t.blockedOn=e,rw(t.priority,function(){ew(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=rp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Yd=n,r.target.dispatchEvent(n),Yd=null}else return e=Yl(r),e!==null&&Rm(e),t.blockedOn=r,!1;e.shift()}return!0}function kx(t,e,r){pf(t)&&r.delete(e)}function CC(){tp=!1,gi!==null&&pf(gi)&&(gi=null),xi!==null&&pf(xi)&&(xi=null),vi!==null&&pf(vi)&&(vi=null),ml.forEach(kx),gl.forEach(kx)}function wc(t,e){t.blockedOn===e&&(t.blockedOn=null,tp||(tp=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,CC)))}function xl(t){function e(s){return wc(s,t)}if(0<Mu.length){wc(Mu[0],t);for(var r=1;r<Mu.length;r++){var n=Mu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(gi!==null&&wc(gi,t),xi!==null&&wc(xi,t),vi!==null&&wc(vi,t),ml.forEach(e),gl.forEach(e),r=0;r<si.length;r++)n=si[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<si.length&&(r=si[0],r.blockedOn===null);)nw(r),r.blockedOn===null&&si.shift()}var Eo=Ws.ReactCurrentBatchConfig,Uf=!0;function RC(t,e,r,n){var s=ct,i=Eo.transition;Eo.transition=null;try{ct=1,Pm(t,e,r,n)}finally{ct=s,Eo.transition=i}}function PC(t,e,r,n){var s=ct,i=Eo.transition;Eo.transition=null;try{ct=4,Pm(t,e,r,n)}finally{ct=s,Eo.transition=i}}function Pm(t,e,r,n){if(Uf){var s=rp(t,e,r,n);if(s===null)Z0(t,e,n,Bf,r),Tx(t,n);else if(IC(s,t,e,r,n))n.stopPropagation();else if(Tx(t,n),e&4&&-1<SC.indexOf(t)){for(;s!==null;){var i=Yl(s);if(i!==null&&ZE(i),i=rp(t,e,r,n),i===null&&Z0(t,e,n,Bf,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Z0(t,e,n,null,r)}}var Bf=null;function rp(t,e,r,n){if(Bf=null,t=Sm(n),t=ia(t),t!==null)if(e=Na(t),e===null)t=null;else if(r=e.tag,r===13){if(t=WE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bf=t,null}function sw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xC()){case Im:return 1;case XE:return 4;case Mf:case vC:return 16;case YE:return 536870912;default:return 16}default:return 16}}var fi=null,Nm=null,mf=null;function iw(){if(mf)return mf;var t,e=Nm,r=e.length,n,s="value"in fi?fi.value:fi.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return mf=s.slice(t,1<n?1-n:void 0)}function gf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vu(){return!0}function Ax(){return!1}function hn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Vu:Ax,this.isPropagationStopped=Ax,this}return At(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Vu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Vu)},persist:function(){},isPersistent:Vu}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fm=hn(Xo),Xl=At({},Xo,{view:0,detail:0}),NC=hn(Xl),$0,W0,Tc,Bh=At({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Tc&&(Tc&&t.type==="mousemove"?($0=t.screenX-Tc.screenX,W0=t.screenY-Tc.screenY):W0=$0=0,Tc=t),$0)},movementY:function(t){return"movementY"in t?t.movementY:W0}}),Sx=hn(Bh),FC=At({},Bh,{dataTransfer:0}),DC=hn(FC),OC=At({},Xl,{relatedTarget:0}),G0=hn(OC),bC=At({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),LC=hn(bC),MC=At({},Xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),VC=hn(MC),UC=At({},Xo,{data:0}),Ix=hn(UC),BC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zC[t])?!!e[t]:!1}function Dm(){return HC}var $C=At({},Xl,{key:function(t){if(t.key){var e=BC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dm,charCode:function(t){return t.type==="keypress"?gf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WC=hn($C),GC=At({},Bh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cx=hn(GC),KC=At({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dm}),qC=hn(KC),XC=At({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),YC=hn(XC),QC=At({},Bh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JC=hn(QC),ZC=[9,13,27,32],Om=Ls&&"CompositionEvent"in window,Hc=null;Ls&&"documentMode"in document&&(Hc=document.documentMode);var e4=Ls&&"TextEvent"in window&&!Hc,aw=Ls&&(!Om||Hc&&8<Hc&&11>=Hc),Rx=" ",Px=!1;function ow(t,e){switch(t){case"keyup":return ZC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var io=!1;function t4(t,e){switch(t){case"compositionend":return cw(e);case"keypress":return e.which!==32?null:(Px=!0,Rx);case"textInput":return t=e.data,t===Rx&&Px?null:t;default:return null}}function r4(t,e){if(io)return t==="compositionend"||!Om&&ow(t,e)?(t=iw(),mf=Nm=fi=null,io=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return aw&&e.locale!=="ko"?null:e.data;default:return null}}var n4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!n4[t.type]:e==="textarea"}function lw(t,e,r,n){BE(n),e=jf(e,"onChange"),0<e.length&&(r=new Fm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var $c=null,vl=null;function s4(t){yw(t,0)}function jh(t){var e=co(t);if(DE(e))return t}function i4(t,e){if(t==="change")return e}var uw=!1;if(Ls){var K0;if(Ls){var q0="oninput"in document;if(!q0){var Fx=document.createElement("div");Fx.setAttribute("oninput","return;"),q0=typeof Fx.oninput=="function"}K0=q0}else K0=!1;uw=K0&&(!document.documentMode||9<document.documentMode)}function Dx(){$c&&($c.detachEvent("onpropertychange",fw),vl=$c=null)}function fw(t){if(t.propertyName==="value"&&jh(vl)){var e=[];lw(e,vl,t,Sm(t)),$E(s4,e)}}function a4(t,e,r){t==="focusin"?(Dx(),$c=e,vl=r,$c.attachEvent("onpropertychange",fw)):t==="focusout"&&Dx()}function o4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jh(vl)}function c4(t,e){if(t==="click")return jh(e)}function l4(t,e){if(t==="input"||t==="change")return jh(e)}function u4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Hn=typeof Object.is=="function"?Object.is:u4;function _l(t,e){if(Hn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Vd.call(e,s)||!Hn(t[s],e[s]))return!1}return!0}function Ox(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bx(t,e){var r=Ox(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ox(r)}}function hw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dw(){for(var t=window,e=Of();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Of(t.document)}return e}function bm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function f4(t){var e=dw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&hw(r.ownerDocument.documentElement,r)){if(n!==null&&bm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=bx(r,i);var a=bx(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var h4=Ls&&"documentMode"in document&&11>=document.documentMode,ao=null,np=null,Wc=null,sp=!1;function Lx(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sp||ao==null||ao!==Of(n)||(n=ao,"selectionStart"in n&&bm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Wc&&_l(Wc,n)||(Wc=n,n=jf(np,"onSelect"),0<n.length&&(e=new Fm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ao)))}function Uu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var oo={animationend:Uu("Animation","AnimationEnd"),animationiteration:Uu("Animation","AnimationIteration"),animationstart:Uu("Animation","AnimationStart"),transitionend:Uu("Transition","TransitionEnd")},X0={},pw={};Ls&&(pw=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function zh(t){if(X0[t])return X0[t];if(!oo[t])return t;var e=oo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in pw)return X0[t]=e[r];return t}var mw=zh("animationend"),gw=zh("animationiteration"),xw=zh("animationstart"),vw=zh("transitionend"),_w=new Map,Mx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ji(t,e){_w.set(t,e),Pa(e,[t])}for(var Y0=0;Y0<Mx.length;Y0++){var Q0=Mx[Y0],d4=Q0.toLowerCase(),p4=Q0[0].toUpperCase()+Q0.slice(1);ji(d4,"on"+p4)}ji(mw,"onAnimationEnd");ji(gw,"onAnimationIteration");ji(xw,"onAnimationStart");ji("dblclick","onDoubleClick");ji("focusin","onFocus");ji("focusout","onBlur");ji(vw,"onTransitionEnd");Fo("onMouseEnter",["mouseout","mouseover"]);Fo("onMouseLeave",["mouseout","mouseover"]);Fo("onPointerEnter",["pointerout","pointerover"]);Fo("onPointerLeave",["pointerout","pointerover"]);Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pc));function Vx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,dC(n,e,void 0,t),t.currentTarget=null}function yw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;Vx(s,o,l),i=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;Vx(s,o,l),i=c}}}if(Lf)throw t=Zd,Lf=!1,Zd=null,t}function xt(t,e){var r=e[lp];r===void 0&&(r=e[lp]=new Set);var n=t+"__bubble";r.has(n)||(Ew(e,t,2,!1),r.add(n))}function J0(t,e,r){var n=0;e&&(n|=4),Ew(r,t,n,e)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function yl(t){if(!t[Bu]){t[Bu]=!0,CE.forEach(function(r){r!=="selectionchange"&&(m4.has(r)||J0(r,!1,t),J0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Bu]||(e[Bu]=!0,J0("selectionchange",!1,e))}}function Ew(t,e,r,n){switch(sw(e)){case 1:var s=RC;break;case 4:s=PC;break;default:s=Pm}r=s.bind(null,e,r,t),s=void 0,!Jd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Z0(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=ia(o),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}o=o.parentNode}}n=n.return}$E(function(){var l=i,f=Sm(r),h=[];e:{var d=_w.get(t);if(d!==void 0){var m=Fm,g=t;switch(t){case"keypress":if(gf(r)===0)break e;case"keydown":case"keyup":m=WC;break;case"focusin":g="focus",m=G0;break;case"focusout":g="blur",m=G0;break;case"beforeblur":case"afterblur":m=G0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Sx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=DC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=qC;break;case mw:case gw:case xw:m=LC;break;case vw:m=YC;break;case"scroll":m=NC;break;case"wheel":m=JC;break;case"copy":case"cut":case"paste":m=VC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Cx}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?d!==null?d+"Capture":null:d;x=[];for(var w=l,v;w!==null;){v=w;var O=v.stateNode;if(v.tag===5&&O!==null&&(v=O,T!==null&&(O=pl(w,T),O!=null&&x.push(El(w,O,v)))),E)break;w=w.return}0<x.length&&(d=new m(d,g,null,r,f),h.push({event:d,listeners:x}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==Yd&&(g=r.relatedTarget||r.fromElement)&&(ia(g)||g[Ms]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=l,g=g?ia(g):null,g!==null&&(E=Na(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=l),m!==g)){if(x=Sx,O="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(x=Cx,O="onPointerLeave",T="onPointerEnter",w="pointer"),E=m==null?d:co(m),v=g==null?d:co(g),d=new x(O,w+"leave",m,r,f),d.target=E,d.relatedTarget=v,O=null,ia(f)===l&&(x=new x(T,w+"enter",g,r,f),x.target=v,x.relatedTarget=E,O=x),E=O,m&&g)t:{for(x=m,T=g,w=0,v=x;v;v=Ya(v))w++;for(v=0,O=T;O;O=Ya(O))v++;for(;0<w-v;)x=Ya(x),w--;for(;0<v-w;)T=Ya(T),v--;for(;w--;){if(x===T||T!==null&&x===T.alternate)break t;x=Ya(x),T=Ya(T)}x=null}else x=null;m!==null&&Ux(h,d,m,x,!1),g!==null&&E!==null&&Ux(h,E,g,x,!0)}}e:{if(d=l?co(l):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var z=i4;else if(Nx(d))if(uw)z=l4;else{z=o4;var U=a4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=c4);if(z&&(z=z(t,l))){lw(h,z,r,f);break e}U&&U(t,d,l),t==="focusout"&&(U=d._wrapperState)&&U.controlled&&d.type==="number"&&Wd(d,"number",d.value)}switch(U=l?co(l):window,t){case"focusin":(Nx(U)||U.contentEditable==="true")&&(ao=U,np=l,Wc=null);break;case"focusout":Wc=np=ao=null;break;case"mousedown":sp=!0;break;case"contextmenu":case"mouseup":case"dragend":sp=!1,Lx(h,r,f);break;case"selectionchange":if(h4)break;case"keydown":case"keyup":Lx(h,r,f)}var _;if(Om)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else io?ow(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(aw&&r.locale!=="ko"&&(io||k!=="onCompositionStart"?k==="onCompositionEnd"&&io&&(_=iw()):(fi=f,Nm="value"in fi?fi.value:fi.textContent,io=!0)),U=jf(l,k),0<U.length&&(k=new Ix(k,t,null,r,f),h.push({event:k,listeners:U}),_?k.data=_:(_=cw(r),_!==null&&(k.data=_)))),(_=e4?t4(t,r):r4(t,r))&&(l=jf(l,"onBeforeInput"),0<l.length&&(f=new Ix("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:l}),f.data=_))}yw(h,e)})}function El(t,e,r){return{instance:t,listener:e,currentTarget:r}}function jf(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=pl(t,r),i!=null&&n.unshift(El(t,i,s)),i=pl(t,e),i!=null&&n.push(El(t,i,s))),t=t.return}return n}function Ya(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ux(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,l=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&l!==null&&(o=l,s?(c=pl(r,i),c!=null&&a.unshift(El(r,c,o))):s||(c=pl(r,i),c!=null&&a.push(El(r,c,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var g4=/\r\n?/g,x4=/\u0000|\uFFFD/g;function Bx(t){return(typeof t=="string"?t:""+t).replace(g4,`
`).replace(x4,"")}function ju(t,e,r){if(e=Bx(e),Bx(t)!==e&&r)throw Error(ue(425))}function zf(){}var ip=null,ap=null;function op(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cp=typeof setTimeout=="function"?setTimeout:void 0,v4=typeof clearTimeout=="function"?clearTimeout:void 0,jx=typeof Promise=="function"?Promise:void 0,_4=typeof queueMicrotask=="function"?queueMicrotask:typeof jx<"u"?function(t){return jx.resolve(null).then(t).catch(y4)}:cp;function y4(t){setTimeout(function(){throw t})}function ed(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),xl(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);xl(e)}function _i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function zx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),ts="__reactFiber$"+Yo,wl="__reactProps$"+Yo,Ms="__reactContainer$"+Yo,lp="__reactEvents$"+Yo,E4="__reactListeners$"+Yo,w4="__reactHandles$"+Yo;function ia(t){var e=t[ts];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ms]||r[ts]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=zx(t);t!==null;){if(r=t[ts])return r;t=zx(t)}return e}t=r,r=t.parentNode}return null}function Yl(t){return t=t[ts]||t[Ms],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ue(33))}function Hh(t){return t[wl]||null}var up=[],lo=-1;function zi(t){return{current:t}}function _t(t){0>lo||(t.current=up[lo],up[lo]=null,lo--)}function pt(t,e){lo++,up[lo]=t.current,t.current=e}var Ni={},Rr=zi(Ni),Xr=zi(!1),ga=Ni;function Do(t,e){var r=t.type.contextTypes;if(!r)return Ni;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yr(t){return t=t.childContextTypes,t!=null}function Hf(){_t(Xr),_t(Rr)}function Hx(t,e,r){if(Rr.current!==Ni)throw Error(ue(168));pt(Rr,e),pt(Xr,r)}function ww(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(ue(108,aC(t)||"Unknown",s));return At({},r,n)}function $f(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ni,ga=Rr.current,pt(Rr,t),pt(Xr,Xr.current),!0}function $x(t,e,r){var n=t.stateNode;if(!n)throw Error(ue(169));r?(t=ww(t,e,ga),n.__reactInternalMemoizedMergedChildContext=t,_t(Xr),_t(Rr),pt(Rr,t)):_t(Xr),pt(Xr,r)}var As=null,$h=!1,td=!1;function Tw(t){As===null?As=[t]:As.push(t)}function T4(t){$h=!0,Tw(t)}function Hi(){if(!td&&As!==null){td=!0;var t=0,e=ct;try{var r=As;for(ct=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}As=null,$h=!1}catch(s){throw As!==null&&(As=As.slice(t+1)),qE(Im,Hi),s}finally{ct=e,td=!1}}return null}var uo=[],fo=0,Wf=null,Gf=0,xn=[],vn=0,xa=null,Ss=1,Is="";function ta(t,e){uo[fo++]=Gf,uo[fo++]=Wf,Wf=t,Gf=e}function kw(t,e,r){xn[vn++]=Ss,xn[vn++]=Is,xn[vn++]=xa,xa=t;var n=Ss;t=Is;var s=32-Bn(n)-1;n&=~(1<<s),r+=1;var i=32-Bn(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Ss=1<<32-Bn(e)+s|r<<s|n,Is=i+t}else Ss=1<<i|r<<s|n,Is=t}function Lm(t){t.return!==null&&(ta(t,1),kw(t,1,0))}function Mm(t){for(;t===Wf;)Wf=uo[--fo],uo[fo]=null,Gf=uo[--fo],uo[fo]=null;for(;t===xa;)xa=xn[--vn],xn[vn]=null,Is=xn[--vn],xn[vn]=null,Ss=xn[--vn],xn[vn]=null}var on=null,sn=null,wt=!1,bn=null;function Aw(t,e){var r=En(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Wx(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,on=t,sn=_i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,on=t,sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=xa!==null?{id:Ss,overflow:Is}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=En(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,on=t,sn=null,!0):!1;default:return!1}}function fp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hp(t){if(wt){var e=sn;if(e){var r=e;if(!Wx(t,e)){if(fp(t))throw Error(ue(418));e=_i(r.nextSibling);var n=on;e&&Wx(t,e)?Aw(n,r):(t.flags=t.flags&-4097|2,wt=!1,on=t)}}else{if(fp(t))throw Error(ue(418));t.flags=t.flags&-4097|2,wt=!1,on=t}}}function Gx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;on=t}function zu(t){if(t!==on)return!1;if(!wt)return Gx(t),wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!op(t.type,t.memoizedProps)),e&&(e=sn)){if(fp(t))throw Sw(),Error(ue(418));for(;e;)Aw(t,e),e=_i(e.nextSibling)}if(Gx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ue(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){sn=_i(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}sn=null}}else sn=on?_i(t.stateNode.nextSibling):null;return!0}function Sw(){for(var t=sn;t;)t=_i(t.nextSibling)}function Oo(){sn=on=null,wt=!1}function Vm(t){bn===null?bn=[t]:bn.push(t)}var k4=Ws.ReactCurrentBatchConfig;function kc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ue(309));var n=r.stateNode}if(!n)throw Error(ue(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(ue(284));if(!r._owner)throw Error(ue(290,t))}return t}function Hu(t,e){throw t=Object.prototype.toString.call(e),Error(ue(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kx(t){var e=t._init;return e(t._payload)}function Iw(t){function e(T,w){if(t){var v=T.deletions;v===null?(T.deletions=[w],T.flags|=16):v.push(w)}}function r(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function n(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function s(T,w){return T=Ti(T,w),T.index=0,T.sibling=null,T}function i(T,w,v){return T.index=v,t?(v=T.alternate,v!==null?(v=v.index,v<w?(T.flags|=2,w):v):(T.flags|=2,w)):(T.flags|=1048576,w)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,w,v,O){return w===null||w.tag!==6?(w=cd(v,T.mode,O),w.return=T,w):(w=s(w,v),w.return=T,w)}function c(T,w,v,O){var z=v.type;return z===so?f(T,w,v.props.children,O,v.key):w!==null&&(w.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ti&&Kx(z)===w.type)?(O=s(w,v.props),O.ref=kc(T,w,v),O.return=T,O):(O=Tf(v.type,v.key,v.props,null,T.mode,O),O.ref=kc(T,w,v),O.return=T,O)}function l(T,w,v,O){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=ld(v,T.mode,O),w.return=T,w):(w=s(w,v.children||[]),w.return=T,w)}function f(T,w,v,O,z){return w===null||w.tag!==7?(w=ha(v,T.mode,O,z),w.return=T,w):(w=s(w,v),w.return=T,w)}function h(T,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=cd(""+w,T.mode,v),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fu:return v=Tf(w.type,w.key,w.props,null,T.mode,v),v.ref=kc(T,null,w),v.return=T,v;case no:return w=ld(w,T.mode,v),w.return=T,w;case ti:var O=w._init;return h(T,O(w._payload),v)}if(Cc(w)||_c(w))return w=ha(w,T.mode,v,null),w.return=T,w;Hu(T,w)}return null}function d(T,w,v,O){var z=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return z!==null?null:o(T,w,""+v,O);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Fu:return v.key===z?c(T,w,v,O):null;case no:return v.key===z?l(T,w,v,O):null;case ti:return z=v._init,d(T,w,z(v._payload),O)}if(Cc(v)||_c(v))return z!==null?null:f(T,w,v,O,null);Hu(T,v)}return null}function m(T,w,v,O,z){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(v)||null,o(w,T,""+O,z);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Fu:return T=T.get(O.key===null?v:O.key)||null,c(w,T,O,z);case no:return T=T.get(O.key===null?v:O.key)||null,l(w,T,O,z);case ti:var U=O._init;return m(T,w,v,U(O._payload),z)}if(Cc(O)||_c(O))return T=T.get(v)||null,f(w,T,O,z,null);Hu(w,O)}return null}function g(T,w,v,O){for(var z=null,U=null,_=w,k=w=0,A=null;_!==null&&k<v.length;k++){_.index>k?(A=_,_=null):A=_.sibling;var I=d(T,_,v[k],O);if(I===null){_===null&&(_=A);break}t&&_&&I.alternate===null&&e(T,_),w=i(I,w,k),U===null?z=I:U.sibling=I,U=I,_=A}if(k===v.length)return r(T,_),wt&&ta(T,k),z;if(_===null){for(;k<v.length;k++)_=h(T,v[k],O),_!==null&&(w=i(_,w,k),U===null?z=_:U.sibling=_,U=_);return wt&&ta(T,k),z}for(_=n(T,_);k<v.length;k++)A=m(_,T,k,v[k],O),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?k:A.key),w=i(A,w,k),U===null?z=A:U.sibling=A,U=A);return t&&_.forEach(function(P){return e(T,P)}),wt&&ta(T,k),z}function x(T,w,v,O){var z=_c(v);if(typeof z!="function")throw Error(ue(150));if(v=z.call(v),v==null)throw Error(ue(151));for(var U=z=null,_=w,k=w=0,A=null,I=v.next();_!==null&&!I.done;k++,I=v.next()){_.index>k?(A=_,_=null):A=_.sibling;var P=d(T,_,I.value,O);if(P===null){_===null&&(_=A);break}t&&_&&P.alternate===null&&e(T,_),w=i(P,w,k),U===null?z=P:U.sibling=P,U=P,_=A}if(I.done)return r(T,_),wt&&ta(T,k),z;if(_===null){for(;!I.done;k++,I=v.next())I=h(T,I.value,O),I!==null&&(w=i(I,w,k),U===null?z=I:U.sibling=I,U=I);return wt&&ta(T,k),z}for(_=n(T,_);!I.done;k++,I=v.next())I=m(_,T,k,I.value,O),I!==null&&(t&&I.alternate!==null&&_.delete(I.key===null?k:I.key),w=i(I,w,k),U===null?z=I:U.sibling=I,U=I);return t&&_.forEach(function(C){return e(T,C)}),wt&&ta(T,k),z}function E(T,w,v,O){if(typeof v=="object"&&v!==null&&v.type===so&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Fu:e:{for(var z=v.key,U=w;U!==null;){if(U.key===z){if(z=v.type,z===so){if(U.tag===7){r(T,U.sibling),w=s(U,v.props.children),w.return=T,T=w;break e}}else if(U.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ti&&Kx(z)===U.type){r(T,U.sibling),w=s(U,v.props),w.ref=kc(T,U,v),w.return=T,T=w;break e}r(T,U);break}else e(T,U);U=U.sibling}v.type===so?(w=ha(v.props.children,T.mode,O,v.key),w.return=T,T=w):(O=Tf(v.type,v.key,v.props,null,T.mode,O),O.ref=kc(T,w,v),O.return=T,T=O)}return a(T);case no:e:{for(U=v.key;w!==null;){if(w.key===U)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(T,w.sibling),w=s(w,v.children||[]),w.return=T,T=w;break e}else{r(T,w);break}else e(T,w);w=w.sibling}w=ld(v,T.mode,O),w.return=T,T=w}return a(T);case ti:return U=v._init,E(T,w,U(v._payload),O)}if(Cc(v))return g(T,w,v,O);if(_c(v))return x(T,w,v,O);Hu(T,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(T,w.sibling),w=s(w,v),w.return=T,T=w):(r(T,w),w=cd(v,T.mode,O),w.return=T,T=w),a(T)):r(T,w)}return E}var bo=Iw(!0),Cw=Iw(!1),Kf=zi(null),qf=null,ho=null,Um=null;function Bm(){Um=ho=qf=null}function jm(t){var e=Kf.current;_t(Kf),t._currentValue=e}function dp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function wo(t,e){qf=t,Um=ho=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(qr=!0),t.firstContext=null)}function An(t){var e=t._currentValue;if(Um!==t)if(t={context:t,memoizedValue:e,next:null},ho===null){if(qf===null)throw Error(ue(308));ho=t,qf.dependencies={lanes:0,firstContext:t}}else ho=ho.next=t;return e}var aa=null;function zm(t){aa===null?aa=[t]:aa.push(t)}function Rw(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,zm(e)):(r.next=s.next,s.next=r),e.interleaved=r,Vs(t,n)}function Vs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ri=!1;function Hm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ns(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function yi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,tt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Vs(t,r)}return s=n.interleaved,s===null?(e.next=e,zm(n)):(e.next=s.next,s.next=e),n.interleaved=e,Vs(t,r)}function xf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cm(t,r)}}function qx(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Xf(t,e,r,n){var s=t.updateQueue;ri=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?i=l:a.next=l,a=c;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=l:o.next=l,f.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,f=l=c=null,o=i;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,x=o;switch(d=e,m=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,d=typeof g=="function"?g.call(m,h,d):g,d==null)break e;h=At({},h,d);break e;case 2:ri=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(l=f=m,c=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(c=h),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);_a|=a,t.lanes=a,t.memoizedState=h}}function Xx(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ue(191,s));s.call(n)}}}var Ql={},as=zi(Ql),Tl=zi(Ql),kl=zi(Ql);function oa(t){if(t===Ql)throw Error(ue(174));return t}function $m(t,e){switch(pt(kl,e),pt(Tl,t),pt(as,Ql),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Kd(e,t)}_t(as),pt(as,e)}function Lo(){_t(as),_t(Tl),_t(kl)}function Nw(t){oa(kl.current);var e=oa(as.current),r=Kd(e,t.type);e!==r&&(pt(Tl,t),pt(as,r))}function Wm(t){Tl.current===t&&(_t(as),_t(Tl))}var Tt=zi(0);function Yf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rd=[];function Gm(){for(var t=0;t<rd.length;t++)rd[t]._workInProgressVersionPrimary=null;rd.length=0}var vf=Ws.ReactCurrentDispatcher,nd=Ws.ReactCurrentBatchConfig,va=0,kt=null,Kt=null,er=null,Qf=!1,Gc=!1,Al=0,A4=0;function vr(){throw Error(ue(321))}function Km(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Hn(t[r],e[r]))return!1;return!0}function qm(t,e,r,n,s,i){if(va=i,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vf.current=t===null||t.memoizedState===null?R4:P4,t=r(n,s),Gc){i=0;do{if(Gc=!1,Al=0,25<=i)throw Error(ue(301));i+=1,er=Kt=null,e.updateQueue=null,vf.current=N4,t=r(n,s)}while(Gc)}if(vf.current=Jf,e=Kt!==null&&Kt.next!==null,va=0,er=Kt=kt=null,Qf=!1,e)throw Error(ue(300));return t}function Xm(){var t=Al!==0;return Al=0,t}function Zn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?kt.memoizedState=er=t:er=er.next=t,er}function Sn(){if(Kt===null){var t=kt.alternate;t=t!==null?t.memoizedState:null}else t=Kt.next;var e=er===null?kt.memoizedState:er.next;if(e!==null)er=e,Kt=t;else{if(t===null)throw Error(ue(310));Kt=t,t={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},er===null?kt.memoizedState=er=t:er=er.next=t}return er}function Sl(t,e){return typeof e=="function"?e(t):e}function sd(t){var e=Sn(),r=e.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=t;var n=Kt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,c=null,l=i;do{var f=l.lane;if((va&f)===f)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(o=c=h,a=n):c=c.next=h,kt.lanes|=f,_a|=f}l=l.next}while(l!==null&&l!==i);c===null?a=n:c.next=o,Hn(n,e.memoizedState)||(qr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,kt.lanes|=i,_a|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function id(t){var e=Sn(),r=e.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Hn(i,e.memoizedState)||(qr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Fw(){}function Dw(t,e){var r=kt,n=Sn(),s=e(),i=!Hn(n.memoizedState,s);if(i&&(n.memoizedState=s,qr=!0),n=n.queue,Ym(Lw.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||er!==null&&er.memoizedState.tag&1){if(r.flags|=2048,Il(9,bw.bind(null,r,n,s,e),void 0,null),tr===null)throw Error(ue(349));va&30||Ow(r,e,s)}return s}function Ow(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function bw(t,e,r,n){e.value=r,e.getSnapshot=n,Mw(e)&&Vw(t)}function Lw(t,e,r){return r(function(){Mw(e)&&Vw(t)})}function Mw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Hn(t,r)}catch{return!0}}function Vw(t){var e=Vs(t,1);e!==null&&jn(e,t,1,-1)}function Yx(t){var e=Zn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:t},e.queue=t,t=t.dispatch=C4.bind(null,kt,t),[e.memoizedState,t]}function Il(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Uw(){return Sn().memoizedState}function _f(t,e,r,n){var s=Zn();kt.flags|=t,s.memoizedState=Il(1|e,r,void 0,n===void 0?null:n)}function Wh(t,e,r,n){var s=Sn();n=n===void 0?null:n;var i=void 0;if(Kt!==null){var a=Kt.memoizedState;if(i=a.destroy,n!==null&&Km(n,a.deps)){s.memoizedState=Il(e,r,i,n);return}}kt.flags|=t,s.memoizedState=Il(1|e,r,i,n)}function Qx(t,e){return _f(8390656,8,t,e)}function Ym(t,e){return Wh(2048,8,t,e)}function Bw(t,e){return Wh(4,2,t,e)}function jw(t,e){return Wh(4,4,t,e)}function zw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Hw(t,e,r){return r=r!=null?r.concat([t]):null,Wh(4,4,zw.bind(null,e,t),r)}function Qm(){}function $w(t,e){var r=Sn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Km(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Ww(t,e){var r=Sn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Km(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Gw(t,e,r){return va&21?(Hn(r,e)||(r=QE(),kt.lanes|=r,_a|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,qr=!0),t.memoizedState=r)}function S4(t,e){var r=ct;ct=r!==0&&4>r?r:4,t(!0);var n=nd.transition;nd.transition={};try{t(!1),e()}finally{ct=r,nd.transition=n}}function Kw(){return Sn().memoizedState}function I4(t,e,r){var n=wi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qw(t))Xw(e,r);else if(r=Rw(t,e,r,n),r!==null){var s=Mr();jn(r,t,n,s),Yw(r,e,n)}}function C4(t,e,r){var n=wi(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qw(t))Xw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,Hn(o,a)){var c=e.interleaved;c===null?(s.next=s,zm(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=Rw(t,e,s,n),r!==null&&(s=Mr(),jn(r,t,n,s),Yw(r,e,n))}}function qw(t){var e=t.alternate;return t===kt||e!==null&&e===kt}function Xw(t,e){Gc=Qf=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Yw(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Cm(t,r)}}var Jf={readContext:An,useCallback:vr,useContext:vr,useEffect:vr,useImperativeHandle:vr,useInsertionEffect:vr,useLayoutEffect:vr,useMemo:vr,useReducer:vr,useRef:vr,useState:vr,useDebugValue:vr,useDeferredValue:vr,useTransition:vr,useMutableSource:vr,useSyncExternalStore:vr,useId:vr,unstable_isNewReconciler:!1},R4={readContext:An,useCallback:function(t,e){return Zn().memoizedState=[t,e===void 0?null:e],t},useContext:An,useEffect:Qx,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,_f(4194308,4,zw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return _f(4194308,4,t,e)},useInsertionEffect:function(t,e){return _f(4,2,t,e)},useMemo:function(t,e){var r=Zn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Zn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=I4.bind(null,kt,t),[n.memoizedState,t]},useRef:function(t){var e=Zn();return t={current:t},e.memoizedState=t},useState:Yx,useDebugValue:Qm,useDeferredValue:function(t){return Zn().memoizedState=t},useTransition:function(){var t=Yx(!1),e=t[0];return t=S4.bind(null,t[1]),Zn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=kt,s=Zn();if(wt){if(r===void 0)throw Error(ue(407));r=r()}else{if(r=e(),tr===null)throw Error(ue(349));va&30||Ow(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Qx(Lw.bind(null,n,i,t),[t]),n.flags|=2048,Il(9,bw.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=Zn(),e=tr.identifierPrefix;if(wt){var r=Is,n=Ss;r=(n&~(1<<32-Bn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Al++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=A4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},P4={readContext:An,useCallback:$w,useContext:An,useEffect:Ym,useImperativeHandle:Hw,useInsertionEffect:Bw,useLayoutEffect:jw,useMemo:Ww,useReducer:sd,useRef:Uw,useState:function(){return sd(Sl)},useDebugValue:Qm,useDeferredValue:function(t){var e=Sn();return Gw(e,Kt.memoizedState,t)},useTransition:function(){var t=sd(Sl)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:Fw,useSyncExternalStore:Dw,useId:Kw,unstable_isNewReconciler:!1},N4={readContext:An,useCallback:$w,useContext:An,useEffect:Ym,useImperativeHandle:Hw,useInsertionEffect:Bw,useLayoutEffect:jw,useMemo:Ww,useReducer:id,useRef:Uw,useState:function(){return id(Sl)},useDebugValue:Qm,useDeferredValue:function(t){var e=Sn();return Kt===null?e.memoizedState=t:Gw(e,Kt.memoizedState,t)},useTransition:function(){var t=id(Sl)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:Fw,useSyncExternalStore:Dw,useId:Kw,unstable_isNewReconciler:!1};function Dn(t,e){if(t&&t.defaultProps){e=At({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function pp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:At({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Gh={isMounted:function(t){return(t=t._reactInternals)?Na(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Mr(),s=wi(t),i=Ns(n,s);i.payload=e,r!=null&&(i.callback=r),e=yi(t,i,s),e!==null&&(jn(e,t,s,n),xf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Mr(),s=wi(t),i=Ns(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=yi(t,i,s),e!==null&&(jn(e,t,s,n),xf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Mr(),n=wi(t),s=Ns(r,n);s.tag=2,e!=null&&(s.callback=e),e=yi(t,s,n),e!==null&&(jn(e,t,n,r),xf(e,t,n))}};function Jx(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!_l(r,n)||!_l(s,i):!0}function Qw(t,e,r){var n=!1,s=Ni,i=e.contextType;return typeof i=="object"&&i!==null?i=An(i):(s=Yr(e)?ga:Rr.current,n=e.contextTypes,i=(n=n!=null)?Do(t,s):Ni),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Zx(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Gh.enqueueReplaceState(e,e.state,null)}function mp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Hm(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=An(i):(i=Yr(e)?ga:Rr.current,s.context=Do(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(pp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Gh.enqueueReplaceState(s,s.state,null),Xf(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mo(t,e){try{var r="",n=e;do r+=iC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ad(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function gp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var F4=typeof WeakMap=="function"?WeakMap:Map;function Jw(t,e,r){r=Ns(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){eh||(eh=!0,Sp=n),gp(t,e)},r}function Zw(t,e,r){r=Ns(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){gp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){gp(t,e),typeof n!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function ev(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new F4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=G4.bind(null,t,e,r),e.then(t,t))}function tv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rv(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ns(-1,1),e.tag=2,yi(r,e,1))),r.lanes|=1),t)}var D4=Ws.ReactCurrentOwner,qr=!1;function Dr(t,e,r,n){e.child=t===null?Cw(e,null,r,n):bo(e,t.child,r,n)}function nv(t,e,r,n,s){r=r.render;var i=e.ref;return wo(e,s),n=qm(t,e,r,n,i,s),r=Xm(),t!==null&&!qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Us(t,e,s)):(wt&&r&&Lm(e),e.flags|=1,Dr(t,e,n,s),e.child)}function sv(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!ig(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,e2(t,e,i,n,s)):(t=Tf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:_l,r(a,n)&&t.ref===e.ref)return Us(t,e,s)}return e.flags|=1,t=Ti(i,n),t.ref=e.ref,t.return=e,e.child=t}function e2(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(_l(i,n)&&t.ref===e.ref)if(qr=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(qr=!0);else return e.lanes=t.lanes,Us(t,e,s)}return xp(t,e,r,n,s)}function t2(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(mo,tn),tn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,pt(mo,tn),tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,pt(mo,tn),tn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,pt(mo,tn),tn|=n;return Dr(t,e,s,r),e.child}function r2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function xp(t,e,r,n,s){var i=Yr(r)?ga:Rr.current;return i=Do(e,i),wo(e,s),r=qm(t,e,r,n,i,s),n=Xm(),t!==null&&!qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Us(t,e,s)):(wt&&n&&Lm(e),e.flags|=1,Dr(t,e,r,s),e.child)}function iv(t,e,r,n,s){if(Yr(r)){var i=!0;$f(e)}else i=!1;if(wo(e,s),e.stateNode===null)yf(t,e),Qw(e,r,n),mp(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,l=r.contextType;typeof l=="object"&&l!==null?l=An(l):(l=Yr(r)?ga:Rr.current,l=Do(e,l));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==l)&&Zx(e,a,n,l),ri=!1;var d=e.memoizedState;a.state=d,Xf(e,n,a,s),c=e.memoizedState,o!==n||d!==c||Xr.current||ri?(typeof f=="function"&&(pp(e,r,f,n),c=e.memoizedState),(o=ri||Jx(e,r,o,n,d,c,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),a.props=n,a.state=c,a.context=l,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Pw(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:Dn(e.type,o),a.props=l,h=e.pendingProps,d=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=An(c):(c=Yr(r)?ga:Rr.current,c=Do(e,c));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==c)&&Zx(e,a,n,c),ri=!1,d=e.memoizedState,a.state=d,Xf(e,n,a,s);var g=e.memoizedState;o!==h||d!==g||Xr.current||ri?(typeof m=="function"&&(pp(e,r,m,n),g=e.memoizedState),(l=ri||Jx(e,r,l,n,d,g,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=c,n=l):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return vp(t,e,r,n,i,s)}function vp(t,e,r,n,s,i){r2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&$x(e,r,!1),Us(t,e,i);n=e.stateNode,D4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=bo(e,t.child,null,i),e.child=bo(e,null,o,i)):Dr(t,e,o,i),e.memoizedState=n.state,s&&$x(e,r,!0),e.child}function n2(t){var e=t.stateNode;e.pendingContext?Hx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hx(t,e.context,!1),$m(t,e.containerInfo)}function av(t,e,r,n,s){return Oo(),Vm(s),e.flags|=256,Dr(t,e,r,n),e.child}var _p={dehydrated:null,treeContext:null,retryLane:0};function yp(t){return{baseLanes:t,cachePool:null,transitions:null}}function s2(t,e,r){var n=e.pendingProps,s=Tt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),pt(Tt,s&1),t===null)return hp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Xh(a,n,0,null),t=ha(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=yp(r),e.memoizedState=_p,t):Jm(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return O4(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ti(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Ti(o,i):(i=ha(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?yp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=_p,n}return i=t.child,t=i.sibling,n=Ti(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Jm(t,e){return e=Xh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $u(t,e,r,n){return n!==null&&Vm(n),bo(e,t.child,null,r),t=Jm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O4(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=ad(Error(ue(422))),$u(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Xh({mode:"visible",children:n.children},s,0,null),i=ha(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&bo(e,t.child,null,a),e.child.memoizedState=yp(a),e.memoizedState=_p,i);if(!(e.mode&1))return $u(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ue(419)),n=ad(i,n,void 0),$u(t,e,a,n)}if(o=(a&t.childLanes)!==0,qr||o){if(n=tr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Vs(t,s),jn(n,t,s,-1))}return sg(),n=ad(Error(ue(421))),$u(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=K4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,sn=_i(s.nextSibling),on=e,wt=!0,bn=null,t!==null&&(xn[vn++]=Ss,xn[vn++]=Is,xn[vn++]=xa,Ss=t.id,Is=t.overflow,xa=e),e=Jm(e,n.children),e.flags|=4096,e)}function ov(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),dp(t.return,e,r)}function od(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function i2(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Dr(t,e,n.children,r),n=Tt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ov(t,r,e);else if(t.tag===19)ov(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(pt(Tt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Yf(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),od(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Yf(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}od(e,!0,r,null,i);break;case"together":od(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Us(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),_a|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ue(153));if(e.child!==null){for(t=e.child,r=Ti(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ti(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function b4(t,e,r){switch(e.tag){case 3:n2(e),Oo();break;case 5:Nw(e);break;case 1:Yr(e.type)&&$f(e);break;case 4:$m(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;pt(Kf,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(pt(Tt,Tt.current&1),e.flags|=128,null):r&e.child.childLanes?s2(t,e,r):(pt(Tt,Tt.current&1),t=Us(t,e,r),t!==null?t.sibling:null);pt(Tt,Tt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return i2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),pt(Tt,Tt.current),n)break;return null;case 22:case 23:return e.lanes=0,t2(t,e,r)}return Us(t,e,r)}var a2,Ep,o2,c2;a2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ep=function(){};o2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,oa(as.current);var i=null;switch(r){case"input":s=Hd(t,s),n=Hd(t,n),i=[];break;case"select":s=At({},s,{value:void 0}),n=At({},n,{value:void 0}),i=[];break;case"textarea":s=Gd(t,s),n=Gd(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=zf)}qd(r,n);var a;r=null;for(l in s)if(!n.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var o=s[l];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(hl.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in n){var c=n[l];if(o=s!=null?s[l]:void 0,n.hasOwnProperty(l)&&c!==o&&(c!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(hl.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&xt("scroll",t),i||o===c||(i=[])):(i=i||[]).push(l,c))}r&&(i=i||[]).push("style",r);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};c2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ac(t,e){if(!wt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function _r(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function L4(t,e,r){var n=e.pendingProps;switch(Mm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(e),null;case 1:return Yr(e.type)&&Hf(),_r(e),null;case 3:return n=e.stateNode,Lo(),_t(Xr),_t(Rr),Gm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(zu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(Rp(bn),bn=null))),Ep(t,e),_r(e),null;case 5:Wm(e);var s=oa(kl.current);if(r=e.type,t!==null&&e.stateNode!=null)o2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ue(166));return _r(e),null}if(t=oa(as.current),zu(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[ts]=e,n[wl]=i,t=(e.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(s=0;s<Pc.length;s++)xt(Pc[s],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":gx(n,i),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},xt("invalid",n);break;case"textarea":vx(n,i),xt("invalid",n)}qd(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&ju(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&ju(n.textContent,o,t),s=["children",""+o]):hl.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xt("scroll",n)}switch(r){case"input":Du(n),xx(n,i,!0);break;case"textarea":Du(n),_x(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=zf)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=LE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ts]=e,t[wl]=n,a2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Xd(r,n),r){case"dialog":xt("cancel",t),xt("close",t),s=n;break;case"iframe":case"object":case"embed":xt("load",t),s=n;break;case"video":case"audio":for(s=0;s<Pc.length;s++)xt(Pc[s],t);s=n;break;case"source":xt("error",t),s=n;break;case"img":case"image":case"link":xt("error",t),xt("load",t),s=n;break;case"details":xt("toggle",t),s=n;break;case"input":gx(t,n),s=Hd(t,n),xt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=At({},n,{value:void 0}),xt("invalid",t);break;case"textarea":vx(t,n),s=Gd(t,n),xt("invalid",t);break;default:s=n}qd(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?UE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ME(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&dl(t,c):typeof c=="number"&&dl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(hl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&xt("scroll",t):c!=null&&wm(t,i,c,a))}switch(r){case"input":Du(t),xx(t,n,!1);break;case"textarea":Du(t),_x(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Pi(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?vo(t,!!n.multiple,i,!1):n.defaultValue!=null&&vo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=zf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _r(e),null;case 6:if(t&&e.stateNode!=null)c2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ue(166));if(r=oa(kl.current),oa(as.current),zu(e)){if(n=e.stateNode,r=e.memoizedProps,n[ts]=e,(i=n.nodeValue!==r)&&(t=on,t!==null))switch(t.tag){case 3:ju(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ju(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ts]=e,e.stateNode=n}return _r(e),null;case 13:if(_t(Tt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wt&&sn!==null&&e.mode&1&&!(e.flags&128))Sw(),Oo(),e.flags|=98560,i=!1;else if(i=zu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(ue(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));i[ts]=e}else Oo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_r(e),i=!1}else bn!==null&&(Rp(bn),bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Tt.current&1?qt===0&&(qt=3):sg())),e.updateQueue!==null&&(e.flags|=4),_r(e),null);case 4:return Lo(),Ep(t,e),t===null&&yl(e.stateNode.containerInfo),_r(e),null;case 10:return jm(e.type._context),_r(e),null;case 17:return Yr(e.type)&&Hf(),_r(e),null;case 19:if(_t(Tt),i=e.memoizedState,i===null)return _r(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Ac(i,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Yf(t),a!==null){for(e.flags|=128,Ac(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return pt(Tt,Tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ot()>Vo&&(e.flags|=128,n=!0,Ac(i,!1),e.lanes=4194304)}else{if(!n)if(t=Yf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ac(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!wt)return _r(e),null}else 2*Ot()-i.renderingStartTime>Vo&&r!==1073741824&&(e.flags|=128,n=!0,Ac(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ot(),e.sibling=null,r=Tt.current,pt(Tt,n?r&1|2:r&1),e):(_r(e),null);case 22:case 23:return ng(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?tn&1073741824&&(_r(e),e.subtreeFlags&6&&(e.flags|=8192)):_r(e),null;case 24:return null;case 25:return null}throw Error(ue(156,e.tag))}function M4(t,e){switch(Mm(e),e.tag){case 1:return Yr(e.type)&&Hf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Lo(),_t(Xr),_t(Rr),Gm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wm(e),null;case 13:if(_t(Tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ue(340));Oo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _t(Tt),null;case 4:return Lo(),null;case 10:return jm(e.type._context),null;case 22:case 23:return ng(),null;case 24:return null;default:return null}}var Wu=!1,kr=!1,V4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function po(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ct(t,e,n)}else r.current=null}function wp(t,e,r){try{r()}catch(n){Ct(t,e,n)}}var cv=!1;function U4(t,e){if(ip=Uf,t=dw(),bm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,l=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++l===s&&(o=a),d===i&&++f===n&&(c=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ap={focusedElem:t,selectionRange:r},Uf=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,E=g.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:Dn(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(O){Ct(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return g=cv,cv=!1,g}function Kc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&wp(e,r,i)}s=s.next}while(s!==n)}}function Kh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Tp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function l2(t){var e=t.alternate;e!==null&&(t.alternate=null,l2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ts],delete e[wl],delete e[lp],delete e[E4],delete e[w4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function u2(t){return t.tag===5||t.tag===3||t.tag===4}function lv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||u2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function kp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=zf));else if(n!==4&&(t=t.child,t!==null))for(kp(t,e,r),t=t.sibling;t!==null;)kp(t,e,r),t=t.sibling}function Ap(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Ap(t,e,r),t=t.sibling;t!==null;)Ap(t,e,r),t=t.sibling}var ar=null,On=!1;function Js(t,e,r){for(r=r.child;r!==null;)f2(t,e,r),r=r.sibling}function f2(t,e,r){if(is&&typeof is.onCommitFiberUnmount=="function")try{is.onCommitFiberUnmount(Uh,r)}catch{}switch(r.tag){case 5:kr||po(r,e);case 6:var n=ar,s=On;ar=null,Js(t,e,r),ar=n,On=s,ar!==null&&(On?(t=ar,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ar.removeChild(r.stateNode));break;case 18:ar!==null&&(On?(t=ar,r=r.stateNode,t.nodeType===8?ed(t.parentNode,r):t.nodeType===1&&ed(t,r),xl(t)):ed(ar,r.stateNode));break;case 4:n=ar,s=On,ar=r.stateNode.containerInfo,On=!0,Js(t,e,r),ar=n,On=s;break;case 0:case 11:case 14:case 15:if(!kr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&wp(r,e,a),s=s.next}while(s!==n)}Js(t,e,r);break;case 1:if(!kr&&(po(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ct(r,e,o)}Js(t,e,r);break;case 21:Js(t,e,r);break;case 22:r.mode&1?(kr=(n=kr)||r.memoizedState!==null,Js(t,e,r),kr=n):Js(t,e,r);break;default:Js(t,e,r)}}function uv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new V4),e.forEach(function(n){var s=q4.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Pn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:ar=o.stateNode,On=!1;break e;case 3:ar=o.stateNode.containerInfo,On=!0;break e;case 4:ar=o.stateNode.containerInfo,On=!0;break e}o=o.return}if(ar===null)throw Error(ue(160));f2(i,a,s),ar=null,On=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Ct(s,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h2(e,t),e=e.sibling}function h2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pn(e,t),Yn(t),n&4){try{Kc(3,t,t.return),Kh(3,t)}catch(x){Ct(t,t.return,x)}try{Kc(5,t,t.return)}catch(x){Ct(t,t.return,x)}}break;case 1:Pn(e,t),Yn(t),n&512&&r!==null&&po(r,r.return);break;case 5:if(Pn(e,t),Yn(t),n&512&&r!==null&&po(r,r.return),t.flags&32){var s=t.stateNode;try{dl(s,"")}catch(x){Ct(t,t.return,x)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&OE(s,i),Xd(o,a);var l=Xd(o,i);for(a=0;a<c.length;a+=2){var f=c[a],h=c[a+1];f==="style"?UE(s,h):f==="dangerouslySetInnerHTML"?ME(s,h):f==="children"?dl(s,h):wm(s,f,h,l)}switch(o){case"input":$d(s,i);break;case"textarea":bE(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?vo(s,!!i.multiple,m,!1):d!==!!i.multiple&&(i.defaultValue!=null?vo(s,!!i.multiple,i.defaultValue,!0):vo(s,!!i.multiple,i.multiple?[]:"",!1))}s[wl]=i}catch(x){Ct(t,t.return,x)}}break;case 6:if(Pn(e,t),Yn(t),n&4){if(t.stateNode===null)throw Error(ue(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Ct(t,t.return,x)}}break;case 3:if(Pn(e,t),Yn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xl(e.containerInfo)}catch(x){Ct(t,t.return,x)}break;case 4:Pn(e,t),Yn(t);break;case 13:Pn(e,t),Yn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tg=Ot())),n&4&&uv(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(kr=(l=kr)||f,Pn(e,t),kr=l):Pn(e,t),Yn(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!f&&t.mode&1)for(Ne=t,f=t.child;f!==null;){for(h=Ne=f;Ne!==null;){switch(d=Ne,m=d.child,d.tag){case 0:case 11:case 14:case 15:Kc(4,d,d.return);break;case 1:po(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){Ct(n,r,x)}}break;case 5:po(d,d.return);break;case 22:if(d.memoizedState!==null){hv(h);continue}}m!==null?(m.return=d,Ne=m):hv(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=VE("display",a))}catch(x){Ct(t,t.return,x)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(x){Ct(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Pn(e,t),Yn(t),n&4&&uv(t);break;case 21:break;default:Pn(e,t),Yn(t)}}function Yn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(u2(r)){var n=r;break e}r=r.return}throw Error(ue(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(dl(s,""),n.flags&=-33);var i=lv(t);Ap(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=lv(t);kp(t,o,a);break;default:throw Error(ue(161))}}catch(c){Ct(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function B4(t,e,r){Ne=t,d2(t)}function d2(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var s=Ne,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Wu;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||kr;o=Wu;var l=kr;if(Wu=a,(kr=c)&&!l)for(Ne=s;Ne!==null;)a=Ne,c=a.child,a.tag===22&&a.memoizedState!==null?dv(s):c!==null?(c.return=a,Ne=c):dv(s);for(;i!==null;)Ne=i,d2(i),i=i.sibling;Ne=s,Wu=o,kr=l}fv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ne=i):fv(t)}}function fv(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kr||Kh(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!kr)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Dn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Xx(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Xx(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var f=l.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&xl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}kr||e.flags&512&&Tp(e)}catch(d){Ct(e,e.return,d)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function hv(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function dv(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Kh(4,e)}catch(c){Ct(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Ct(e,s,c)}}var i=e.return;try{Tp(e)}catch(c){Ct(e,i,c)}break;case 5:var a=e.return;try{Tp(e)}catch(c){Ct(e,a,c)}}}catch(c){Ct(e,e.return,c)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var j4=Math.ceil,Zf=Ws.ReactCurrentDispatcher,Zm=Ws.ReactCurrentOwner,wn=Ws.ReactCurrentBatchConfig,tt=0,tr=null,jt=null,ur=0,tn=0,mo=zi(0),qt=0,Cl=null,_a=0,qh=0,eg=0,qc=null,Gr=null,tg=0,Vo=1/0,ks=null,eh=!1,Sp=null,Ei=null,Gu=!1,hi=null,th=0,Xc=0,Ip=null,Ef=-1,wf=0;function Mr(){return tt&6?Ot():Ef!==-1?Ef:Ef=Ot()}function wi(t){return t.mode&1?tt&2&&ur!==0?ur&-ur:k4.transition!==null?(wf===0&&(wf=QE()),wf):(t=ct,t!==0||(t=window.event,t=t===void 0?16:sw(t.type)),t):1}function jn(t,e,r,n){if(50<Xc)throw Xc=0,Ip=null,Error(ue(185));ql(t,r,n),(!(tt&2)||t!==tr)&&(t===tr&&(!(tt&2)&&(qh|=r),qt===4&&ii(t,ur)),Qr(t,n),r===1&&tt===0&&!(e.mode&1)&&(Vo=Ot()+500,$h&&Hi()))}function Qr(t,e){var r=t.callbackNode;kC(t,e);var n=Vf(t,t===tr?ur:0);if(n===0)r!==null&&wx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wx(r),e===1)t.tag===0?T4(pv.bind(null,t)):Tw(pv.bind(null,t)),_4(function(){!(tt&6)&&Hi()}),r=null;else{switch(JE(n)){case 1:r=Im;break;case 4:r=XE;break;case 16:r=Mf;break;case 536870912:r=YE;break;default:r=Mf}r=E2(r,p2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function p2(t,e){if(Ef=-1,wf=0,tt&6)throw Error(ue(327));var r=t.callbackNode;if(To()&&t.callbackNode!==r)return null;var n=Vf(t,t===tr?ur:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=rh(t,n);else{e=n;var s=tt;tt|=2;var i=g2();(tr!==t||ur!==e)&&(ks=null,Vo=Ot()+500,fa(t,e));do try{$4();break}catch(o){m2(t,o)}while(!0);Bm(),Zf.current=i,tt=s,jt!==null?e=0:(tr=null,ur=0,e=qt)}if(e!==0){if(e===2&&(s=ep(t),s!==0&&(n=s,e=Cp(t,s))),e===1)throw r=Cl,fa(t,0),ii(t,n),Qr(t,Ot()),r;if(e===6)ii(t,n);else{if(s=t.current.alternate,!(n&30)&&!z4(s)&&(e=rh(t,n),e===2&&(i=ep(t),i!==0&&(n=i,e=Cp(t,i))),e===1))throw r=Cl,fa(t,0),ii(t,n),Qr(t,Ot()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(ue(345));case 2:ra(t,Gr,ks);break;case 3:if(ii(t,n),(n&130023424)===n&&(e=tg+500-Ot(),10<e)){if(Vf(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Mr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=cp(ra.bind(null,t,Gr,ks),e);break}ra(t,Gr,ks);break;case 4:if(ii(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-Bn(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*j4(n/1960))-n,10<n){t.timeoutHandle=cp(ra.bind(null,t,Gr,ks),n);break}ra(t,Gr,ks);break;case 5:ra(t,Gr,ks);break;default:throw Error(ue(329))}}}return Qr(t,Ot()),t.callbackNode===r?p2.bind(null,t):null}function Cp(t,e){var r=qc;return t.current.memoizedState.isDehydrated&&(fa(t,e).flags|=256),t=rh(t,e),t!==2&&(e=Gr,Gr=r,e!==null&&Rp(e)),t}function Rp(t){Gr===null?Gr=t:Gr.push.apply(Gr,t)}function z4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Hn(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(t,e){for(e&=~eg,e&=~qh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Bn(e),n=1<<r;t[r]=-1,e&=~n}}function pv(t){if(tt&6)throw Error(ue(327));To();var e=Vf(t,0);if(!(e&1))return Qr(t,Ot()),null;var r=rh(t,e);if(t.tag!==0&&r===2){var n=ep(t);n!==0&&(e=n,r=Cp(t,n))}if(r===1)throw r=Cl,fa(t,0),ii(t,e),Qr(t,Ot()),r;if(r===6)throw Error(ue(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ra(t,Gr,ks),Qr(t,Ot()),null}function rg(t,e){var r=tt;tt|=1;try{return t(e)}finally{tt=r,tt===0&&(Vo=Ot()+500,$h&&Hi())}}function ya(t){hi!==null&&hi.tag===0&&!(tt&6)&&To();var e=tt;tt|=1;var r=wn.transition,n=ct;try{if(wn.transition=null,ct=1,t)return t()}finally{ct=n,wn.transition=r,tt=e,!(tt&6)&&Hi()}}function ng(){tn=mo.current,_t(mo)}function fa(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,v4(r)),jt!==null)for(r=jt.return;r!==null;){var n=r;switch(Mm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hf();break;case 3:Lo(),_t(Xr),_t(Rr),Gm();break;case 5:Wm(n);break;case 4:Lo();break;case 13:_t(Tt);break;case 19:_t(Tt);break;case 10:jm(n.type._context);break;case 22:case 23:ng()}r=r.return}if(tr=t,jt=t=Ti(t.current,null),ur=tn=e,qt=0,Cl=null,eg=qh=_a=0,Gr=qc=null,aa!==null){for(e=0;e<aa.length;e++)if(r=aa[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}aa=null}return t}function m2(t,e){do{var r=jt;try{if(Bm(),vf.current=Jf,Qf){for(var n=kt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Qf=!1}if(va=0,er=Kt=kt=null,Gc=!1,Al=0,Zm.current=null,r===null||r.return===null){qt=1,Cl=e,jt=null;break}e:{var i=t,a=r.return,o=r,c=e;if(e=ur,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=tv(a);if(m!==null){m.flags&=-257,rv(m,a,o,i,e),m.mode&1&&ev(i,l,e),e=m,c=l;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){ev(i,l,e),sg();break e}c=Error(ue(426))}}else if(wt&&o.mode&1){var E=tv(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),rv(E,a,o,i,e),Vm(Mo(c,o));break e}}i=c=Mo(c,o),qt!==4&&(qt=2),qc===null?qc=[i]:qc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Jw(i,c,e);qx(i,T);break e;case 1:o=c;var w=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ei===null||!Ei.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var O=Zw(i,o,e);qx(i,O);break e}}i=i.return}while(i!==null)}v2(r)}catch(z){e=z,jt===r&&r!==null&&(jt=r=r.return);continue}break}while(!0)}function g2(){var t=Zf.current;return Zf.current=Jf,t===null?Jf:t}function sg(){(qt===0||qt===3||qt===2)&&(qt=4),tr===null||!(_a&268435455)&&!(qh&268435455)||ii(tr,ur)}function rh(t,e){var r=tt;tt|=2;var n=g2();(tr!==t||ur!==e)&&(ks=null,fa(t,e));do try{H4();break}catch(s){m2(t,s)}while(!0);if(Bm(),tt=r,Zf.current=n,jt!==null)throw Error(ue(261));return tr=null,ur=0,qt}function H4(){for(;jt!==null;)x2(jt)}function $4(){for(;jt!==null&&!mC();)x2(jt)}function x2(t){var e=y2(t.alternate,t,tn);t.memoizedProps=t.pendingProps,e===null?v2(t):jt=e,Zm.current=null}function v2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=M4(r,e),r!==null){r.flags&=32767,jt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,jt=null;return}}else if(r=L4(r,e,tn),r!==null){jt=r;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);qt===0&&(qt=5)}function ra(t,e,r){var n=ct,s=wn.transition;try{wn.transition=null,ct=1,W4(t,e,r,n)}finally{wn.transition=s,ct=n}return null}function W4(t,e,r,n){do To();while(hi!==null);if(tt&6)throw Error(ue(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ue(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(AC(t,i),t===tr&&(jt=tr=null,ur=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Gu||(Gu=!0,E2(Mf,function(){return To(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var a=ct;ct=1;var o=tt;tt|=4,Zm.current=null,U4(t,r),h2(r,t),f4(ap),Uf=!!ip,ap=ip=null,t.current=r,B4(r),gC(),tt=o,ct=a,wn.transition=i}else t.current=r;if(Gu&&(Gu=!1,hi=t,th=s),i=t.pendingLanes,i===0&&(Ei=null),_C(r.stateNode),Qr(t,Ot()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(eh)throw eh=!1,t=Sp,Sp=null,t;return th&1&&t.tag!==0&&To(),i=t.pendingLanes,i&1?t===Ip?Xc++:(Xc=0,Ip=t):Xc=0,Hi(),null}function To(){if(hi!==null){var t=JE(th),e=wn.transition,r=ct;try{if(wn.transition=null,ct=16>t?16:t,hi===null)var n=!1;else{if(t=hi,hi=null,th=0,tt&6)throw Error(ue(331));var s=tt;for(tt|=4,Ne=t.current;Ne!==null;){var i=Ne,a=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var l=o[c];for(Ne=l;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:Kc(8,f,i)}var h=f.child;if(h!==null)h.return=f,Ne=h;else for(;Ne!==null;){f=Ne;var d=f.sibling,m=f.return;if(l2(f),f===l){Ne=null;break}if(d!==null){d.return=m,Ne=d;break}Ne=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}Ne=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ne=a;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Kc(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Ne=T;break e}Ne=i.return}}var w=t.current;for(Ne=w;Ne!==null;){a=Ne;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Ne=v;else e:for(a=w;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Kh(9,o)}}catch(z){Ct(o,o.return,z)}if(o===a){Ne=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,Ne=O;break e}Ne=o.return}}if(tt=s,Hi(),is&&typeof is.onPostCommitFiberRoot=="function")try{is.onPostCommitFiberRoot(Uh,t)}catch{}n=!0}return n}finally{ct=r,wn.transition=e}}return!1}function mv(t,e,r){e=Mo(r,e),e=Jw(t,e,1),t=yi(t,e,1),e=Mr(),t!==null&&(ql(t,1,e),Qr(t,e))}function Ct(t,e,r){if(t.tag===3)mv(t,t,r);else for(;e!==null;){if(e.tag===3){mv(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ei===null||!Ei.has(n))){t=Mo(r,t),t=Zw(e,t,1),e=yi(e,t,1),t=Mr(),e!==null&&(ql(e,1,t),Qr(e,t));break}}e=e.return}}function G4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Mr(),t.pingedLanes|=t.suspendedLanes&r,tr===t&&(ur&r)===r&&(qt===4||qt===3&&(ur&130023424)===ur&&500>Ot()-tg?fa(t,0):eg|=r),Qr(t,e)}function _2(t,e){e===0&&(t.mode&1?(e=Lu,Lu<<=1,!(Lu&130023424)&&(Lu=4194304)):e=1);var r=Mr();t=Vs(t,e),t!==null&&(ql(t,e,r),Qr(t,r))}function K4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),_2(t,r)}function q4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ue(314))}n!==null&&n.delete(e),_2(t,r)}var y2;y2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xr.current)qr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return qr=!1,b4(t,e,r);qr=!!(t.flags&131072)}else qr=!1,wt&&e.flags&1048576&&kw(e,Gf,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;yf(t,e),t=e.pendingProps;var s=Do(e,Rr.current);wo(e,r),s=qm(null,e,n,t,s,r);var i=Xm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yr(n)?(i=!0,$f(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hm(e),s.updater=Gh,e.stateNode=s,s._reactInternals=e,mp(e,n,t,r),e=vp(null,e,n,!0,i,r)):(e.tag=0,wt&&i&&Lm(e),Dr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(yf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Y4(n),t=Dn(n,t),s){case 0:e=xp(null,e,n,t,r);break e;case 1:e=iv(null,e,n,t,r);break e;case 11:e=nv(null,e,n,t,r);break e;case 14:e=sv(null,e,n,Dn(n.type,t),r);break e}throw Error(ue(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Dn(n,s),xp(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Dn(n,s),iv(t,e,n,s,r);case 3:e:{if(n2(e),t===null)throw Error(ue(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Pw(t,e),Xf(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mo(Error(ue(423)),e),e=av(t,e,n,r,s);break e}else if(n!==s){s=Mo(Error(ue(424)),e),e=av(t,e,n,r,s);break e}else for(sn=_i(e.stateNode.containerInfo.firstChild),on=e,wt=!0,bn=null,r=Cw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Oo(),n===s){e=Us(t,e,r);break e}Dr(t,e,n,r)}e=e.child}return e;case 5:return Nw(e),t===null&&hp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,op(n,s)?a=null:i!==null&&op(n,i)&&(e.flags|=32),r2(t,e),Dr(t,e,a,r),e.child;case 6:return t===null&&hp(e),null;case 13:return s2(t,e,r);case 4:return $m(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=bo(e,null,n,r):Dr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Dn(n,s),nv(t,e,n,s,r);case 7:return Dr(t,e,e.pendingProps,r),e.child;case 8:return Dr(t,e,e.pendingProps.children,r),e.child;case 12:return Dr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,pt(Kf,n._currentValue),n._currentValue=a,i!==null)if(Hn(i.value,a)){if(i.children===s.children&&!Xr.current){e=Us(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Ns(-1,r&-r),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),dp(i.return,r,e),o.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ue(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),dp(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,wo(e,r),s=An(s),n=n(s),e.flags|=1,Dr(t,e,n,r),e.child;case 14:return n=e.type,s=Dn(n,e.pendingProps),s=Dn(n.type,s),sv(t,e,n,s,r);case 15:return e2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Dn(n,s),yf(t,e),e.tag=1,Yr(n)?(t=!0,$f(e)):t=!1,wo(e,r),Qw(e,n,s),mp(e,n,s,r),vp(null,e,n,!0,t,r);case 19:return i2(t,e,r);case 22:return t2(t,e,r)}throw Error(ue(156,e.tag))};function E2(t,e){return qE(t,e)}function X4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(t,e,r,n){return new X4(t,e,r,n)}function ig(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Y4(t){if(typeof t=="function")return ig(t)?1:0;if(t!=null){if(t=t.$$typeof,t===km)return 11;if(t===Am)return 14}return 2}function Ti(t,e){var r=t.alternate;return r===null?(r=En(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Tf(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")ig(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case so:return ha(r.children,s,i,e);case Tm:a=8,s|=8;break;case Ud:return t=En(12,r,e,s|2),t.elementType=Ud,t.lanes=i,t;case Bd:return t=En(13,r,e,s),t.elementType=Bd,t.lanes=i,t;case jd:return t=En(19,r,e,s),t.elementType=jd,t.lanes=i,t;case NE:return Xh(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case RE:a=10;break e;case PE:a=9;break e;case km:a=11;break e;case Am:a=14;break e;case ti:a=16,n=null;break e}throw Error(ue(130,t==null?t:typeof t,""))}return e=En(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function ha(t,e,r,n){return t=En(7,t,n,e),t.lanes=r,t}function Xh(t,e,r,n){return t=En(22,t,n,e),t.elementType=NE,t.lanes=r,t.stateNode={isHidden:!1},t}function cd(t,e,r){return t=En(6,t,null,e),t.lanes=r,t}function ld(t,e,r){return e=En(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Q4(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=H0(0),this.expirationTimes=H0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ag(t,e,r,n,s,i,a,o,c){return t=new Q4(t,e,r,o,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=En(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hm(i),t}function J4(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function w2(t){if(!t)return Ni;t=t._reactInternals;e:{if(Na(t)!==t||t.tag!==1)throw Error(ue(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ue(171))}if(t.tag===1){var r=t.type;if(Yr(r))return ww(t,r,e)}return e}function T2(t,e,r,n,s,i,a,o,c){return t=ag(r,n,!0,t,s,i,a,o,c),t.context=w2(null),r=t.current,n=Mr(),s=wi(r),i=Ns(n,s),i.callback=e??null,yi(r,i,s),t.current.lanes=s,ql(t,s,n),Qr(t,n),t}function Yh(t,e,r,n){var s=e.current,i=Mr(),a=wi(s);return r=w2(r),e.context===null?e.context=r:e.pendingContext=r,e=Ns(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=yi(s,e,a),t!==null&&(jn(t,s,a,i),xf(t,s,a)),a}function nh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function og(t,e){gv(t,e),(t=t.alternate)&&gv(t,e)}function Z4(){return null}var k2=typeof reportError=="function"?reportError:function(t){console.error(t)};function cg(t){this._internalRoot=t}Qh.prototype.render=cg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ue(409));Yh(t,e,null,null)};Qh.prototype.unmount=cg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ya(function(){Yh(null,t,null,null)}),e[Ms]=null}};function Qh(t){this._internalRoot=t}Qh.prototype.unstable_scheduleHydration=function(t){if(t){var e=tw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<si.length&&e!==0&&e<si[r].priority;r++);si.splice(r,0,t),r===0&&nw(t)}};function lg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xv(){}function eR(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var l=nh(a);i.call(l)}}var a=T2(e,n,t,0,null,!1,!1,"",xv);return t._reactRootContainer=a,t[Ms]=a.current,yl(t.nodeType===8?t.parentNode:t),ya(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var l=nh(c);o.call(l)}}var c=ag(t,0,!1,null,null,!1,!1,"",xv);return t._reactRootContainer=c,t[Ms]=c.current,yl(t.nodeType===8?t.parentNode:t),ya(function(){Yh(e,c,r,n)}),c}function Zh(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var c=nh(a);o.call(c)}}Yh(e,a,t,s)}else a=eR(r,e,t,s,n);return nh(a)}ZE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Rc(e.pendingLanes);r!==0&&(Cm(e,r|1),Qr(e,Ot()),!(tt&6)&&(Vo=Ot()+500,Hi()))}break;case 13:ya(function(){var n=Vs(t,1);if(n!==null){var s=Mr();jn(n,t,1,s)}}),og(t,1)}};Rm=function(t){if(t.tag===13){var e=Vs(t,134217728);if(e!==null){var r=Mr();jn(e,t,134217728,r)}og(t,134217728)}};ew=function(t){if(t.tag===13){var e=wi(t),r=Vs(t,e);if(r!==null){var n=Mr();jn(r,t,e,n)}og(t,e)}};tw=function(){return ct};rw=function(t,e){var r=ct;try{return ct=t,e()}finally{ct=r}};Qd=function(t,e,r){switch(e){case"input":if($d(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Hh(n);if(!s)throw Error(ue(90));DE(n),$d(n,s)}}}break;case"textarea":bE(t,r);break;case"select":e=r.value,e!=null&&vo(t,!!r.multiple,e,!1)}};zE=rg;HE=ya;var tR={usingClientEntryPoint:!1,Events:[Yl,co,Hh,BE,jE,rg]},Sc={findFiberByHostInstance:ia,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rR={bundleType:Sc.bundleType,version:Sc.version,rendererPackageName:Sc.rendererPackageName,rendererConfig:Sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=GE(t),t===null?null:t.stateNode},findFiberByHostInstance:Sc.findFiberByHostInstance||Z4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ku.isDisabled&&Ku.supportsFiber)try{Uh=Ku.inject(rR),is=Ku}catch{}}fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tR;fn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lg(e))throw Error(ue(200));return J4(t,e,null,r)};fn.createRoot=function(t,e){if(!lg(t))throw Error(ue(299));var r=!1,n="",s=k2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ag(t,1,!1,null,null,r,!1,n,s),t[Ms]=e.current,yl(t.nodeType===8?t.parentNode:t),new cg(e)};fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ue(188)):(t=Object.keys(t).join(","),Error(ue(268,t)));return t=GE(e),t=t===null?null:t.stateNode,t};fn.flushSync=function(t){return ya(t)};fn.hydrate=function(t,e,r){if(!Jh(e))throw Error(ue(200));return Zh(null,t,e,!0,r)};fn.hydrateRoot=function(t,e,r){if(!lg(t))throw Error(ue(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=k2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=T2(e,null,t,1,r??null,s,!1,i,a),t[Ms]=e.current,yl(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Qh(e)};fn.render=function(t,e,r){if(!Jh(e))throw Error(ue(200));return Zh(null,t,e,!1,r)};fn.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(ue(40));return t._reactRootContainer?(ya(function(){Zh(null,null,t,!1,function(){t._reactRootContainer=null,t[Ms]=null})}),!0):!1};fn.unstable_batchedUpdates=rg;fn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Jh(r))throw Error(ue(200));if(t==null||t._reactInternals===void 0)throw Error(ue(38));return Zh(t,e,r,!1,n)};fn.version="18.3.1-next-f1338f8080-20240426";function A2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(A2)}catch(t){console.error(t)}}A2(),AE.exports=fn;var nR=AE.exports,vv=nR;Md.createRoot=vv.createRoot,Md.hydrateRoot=vv.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iR=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),_v=t=>{const e=iR(t);return e.charAt(0).toUpperCase()+e.slice(1)},S2=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),aR=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=We.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...o},c)=>We.createElement("svg",{ref:c,...oR,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:S2("lucide",s),...!i&&!aR(o)&&{"aria-hidden":"true"},...o},[...a.map(([l,f])=>We.createElement(l,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=(t,e)=>{const r=We.forwardRef(({className:n,...s},i)=>We.createElement(cR,{ref:i,iconNode:e,className:S2(`lucide-${sR(_v(t))}`,`lucide-${t}`,n),...s}));return r.displayName=_v(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],yv=Nt("chart-column",lR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Pp=Nt("circle-alert",uR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],hR=Nt("circle-check-big",fR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ud=Nt("clock",dR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mR=Nt("eye-off",pR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xR=Nt("eye",gR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],_R=Nt("file-spreadsheet",vR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ER=Nt("funnel",yR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ev=Nt("lock",wR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],kR=Nt("log-out",TR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],SR=Nt("mail",AR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ni=Nt("phone",IR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],RR=Nt("save",CR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],NR=Nt("search",PR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wv=Nt("trash-2",FR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],OR=Nt("trending-down",DR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],LR=Nt("trending-up",bR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Tv=Nt("upload",MR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],kv=Nt("user-plus",VR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],I2=Nt("user",UR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ea=Nt("users",BR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zR=Nt("x",jR);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var C2=1252,HR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ug={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fg=function(t){HR.indexOf(t)!=-1&&(C2=ug[0]=t)};function $R(){fg(1252)}var Mn=function(t){fg(t)};function R2(){Mn(1200),$R()}function Av(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function WR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function P2(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Nc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?WR(t.slice(2)):e==254&&r==255?P2(t.slice(2)):e==65279?t.slice(1):t},qu=function(e){return String.fromCharCode(e)},Sv=function(e){return String.fromCharCode(e)},Rl,di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Iv(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),i=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,s=t.charCodeAt(l++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),e+=di.charAt(i)+di.charAt(a)+di.charAt(o)+di.charAt(c);return e}function un(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)i=di.indexOf(t.charAt(l++)),a=di.indexOf(t.charAt(l++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=di.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=di.indexOf(t.charAt(l++)),s=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Fa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Fi(t){return Ye?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Cv(t){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ln=function(e){return Ye?Fa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Da(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function hg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return hg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ai=Ye?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Fa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function GR(t){for(var e=[],r=0,n=t.length+250,s=Fi(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Fi(65535),n=65530)}return e.push(s.slice(0,r)),ai(e)}var Vr=/\u0000/g,Fc=/[\u0001-\u0006]/g;function ko(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Vn(t,e){var r=""+t;return r.length>=e?r:Rt("0",e-r.length)+r}function dg(t,e){var r=""+t;return r.length>=e?r:Rt(" ",e-r.length)+r}function sh(t,e){var r=""+t;return r.length>=e?r:r+Rt(" ",e-r.length)}function KR(t,e){var r=""+Math.round(t);return r.length>=e?r:Rt("0",e-r.length)+r}function qR(t,e){var r=""+t;return r.length>=e?r:Rt("0",e-r.length)+r}var Rv=Math.pow(2,32);function Qa(t,e){if(t>Rv||t<-Rv)return KR(t,e);var r=Math.round(t);return qR(r,e)}function ih(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Pv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Nv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ah(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,c=1,l=0,f=0,h=Math.floor(s);l<e&&(h=Math.floor(s),o=h*a+i,f=h*l+c,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,c=l,l=f;if(f>e&&(l>e?(f=c,o=i):(f=l,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function ca(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=r3(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var N2=new Date(1899,11,31,0,0,0),QR=N2.getTime(),JR=new Date(1900,2,1,0,0,0);function F2(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=JR&&(r+=24*60*60*1e3),(r-(QR+(t.getTimezoneOffset()-N2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function pg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function e3(t){var e=t<0?12:11,r=pg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function t3(t){var e=pg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Pl(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=e3(t):e===10?r=t.toFixed(10).substr(0,12):r=t3(t),pg(ZR(r.toUpperCase()))}function Ea(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Pl(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return In(14,F2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function r3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function n3(t,e,r,n){var s="",i=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return fd[r.m-1][1];case 5:return fd[r.m-1][0];default:return fd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return Pv[r.q][0];default:return Pv[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Vn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Vn(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?Vn(c,l):"";return f}function pi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var D2=/%/g;function s3(t,e,r){var n=e.replace(D2,""),s=e.length-n.length;return Fs(t,n,r*Math.pow(10,2*s))+Rt("%",s)}function i3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function O2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+O2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var b2=/# (\?+)( ?)\/( ?)(\d+)/;function a3(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Rt(" ",t[1].length+1+t[4].length):dg(a,t[1].length)+t[2]+"/"+t[3]+Vn(o,t[4].length))}function o3(t,e,r){return r+(e===0?"":""+e)+Rt(" ",t[1].length+2+t[4].length)}var L2=/^#*0*\.([0#]+)/,M2=/\).*[0#]/,V2=/\(###\) ###\\?-####/;function Or(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Fv(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Dv(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function c3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function l3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function mn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(M2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mn("n",n,r):"("+mn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return i3(t,e,r);if(e.indexOf("%")!==-1)return s3(t,e,r);if(e.indexOf("E")!==-1)return O2(e,r);if(e.charCodeAt(0)===36)return"$"+mn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Qa(c,e.length);if(e.match(/^[#?]+$/))return s=Qa(r,0),s==="0"&&(s=""),s.length>e.length?s:Or(e.substr(0,e.length-s.length))+s;if(i=e.match(b2))return a3(i,c,l);if(e.match(/^#+0+$/))return l+Qa(c,e.length-e.indexOf("0"));if(i=e.match(L2))return s=Fv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Or(i[1])).replace(/\.$/,"."+Or(i[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+Rt("0",Or(i[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+Fv(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+pi(Qa(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mn(t,e,-r):pi(""+(Math.floor(r)+c3(r,i[1].length)))+"."+Vn(Dv(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return mn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ko(mn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(V2))return s=mn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=ah(c,Math.pow(10,a)-1,!1),s=""+l,f=Fs("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=sh(o[2],a),f.length<i[4].length&&(f=Or(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=ah(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?dg(o[1],a)+i[2]+"/"+i[3]+sh(o[2],a):Rt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Qa(r,0),e.length<=s.length?s:Or(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Or(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Dv(r,i[1].length),r<0?"-"+mn(t,e,-r):pi(l3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Vn(0,3-g.length):"")+g})+"."+Vn(a,i[1].length);switch(e){case"###,##0.00":return mn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=pi(Qa(c,0));return m!=="0"?l+m:"";case"###,###.00":return mn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return mn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function u3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function f3(t,e,r){var n=e.replace(D2,""),s=e.length-n.length;return Fs(t,n,r*Math.pow(10,2*s))+Rt("%",s)}function U2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+U2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(M2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jn("n",n,r):"("+Jn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return u3(t,e,r);if(e.indexOf("%")!==-1)return f3(t,e,r);if(e.indexOf("E")!==-1)return U2(e,r);if(e.charCodeAt(0)===36)return"$"+Jn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Vn(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Or(e.substr(0,e.length-s.length))+s;if(i=e.match(b2))return o3(i,c,l);if(e.match(/^#+0+$/))return l+Vn(c,e.length-e.indexOf("0"));if(i=e.match(L2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Or(i[1])).replace(/\.$/,"."+Or(i[1])),s=s.replace(/\.(\d*)$/,function(g,x){return"."+x+Rt("0",Or(i[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+pi(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jn(t,e,-r):pi(""+r)+"."+Rt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Jn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ko(Jn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(V2))return s=Jn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=ah(c,Math.pow(10,a)-1,!1),s=""+l,f=Fs("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=sh(o[2],a),f.length<i[4].length&&(f=Or(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=ah(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?dg(o[1],a)+i[2]+"/"+i[3]+sh(o[2],a):Rt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Or(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Or(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jn(t,e,-r):pi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Vn(0,3-g.length):"")+g})+"."+Vn(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=pi(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return Jn(t,e.slice(0,e.lastIndexOf(".")),r)+Or(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Fs(t,e,r){return(r|0)===r?Jn(t,e,r):mn(t,e,r)}function h3(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var B2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qo(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":ih(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(B2))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function d3(t,e,r,n){for(var s=[],i="",a=0,o="",c="t",l,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!ih(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=t.charAt(++a),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=ca(e,r,t.charAt(a+1)==="2"),l==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=ca(e,r),l==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(l==null&&(l=ca(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(x.v=l.H>=12?"P":"A"),x.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(x.v=l.H>=12?"PM":"AM"),x.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(l!=null&&(x.v=l.H>=12?"":""),x.t="T",a+=5,d="h"):(x.t="t",++a),l==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(B2)){if(l==null&&(l=ca(e,r),l==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qo(t)||(s[s.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var E=0,T=0,w;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=d,c="h",E<1&&(E=1);break;case"s":(w=s[a].v.match(/\.0+$/))&&(T=Math.max(T,w[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[a].v.match(/[Hh]/)&&(E=1),E<2&&s[a].v.match(/[Mm]/)&&(E=2),E<3&&s[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",O;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=n3(s[a].t.charCodeAt(0),s[a].v,l,T),s[a].t="t";break;case"n":case"?":for(O=a+1;s[O]!=null&&((o=s[O].t)==="?"||o==="D"||(o===" "||o==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[a].v+=s[O].v,s[O]={v:"",t:";"},++O;v+=s[a].v,a=O-1;break;case"G":s[a].t="t",s[a].v=Ea(e,r);break}var z="",U,_;if(v.length>0){v.charCodeAt(0)==40?(U=e<0&&v.charCodeAt(0)===45?-e:e,_=Fs("n",v,U)):(U=e<0&&n>1?-e:e,_=Fs("n",v,U),U<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),O=_.length-1;var k=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){k=a;break}var A=s.length;if(k===s.length&&_.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(O>=s[a].v.length-1?(O-=s[a].v.length,s[a].v=_.substr(O+1,s[a].v.length)):O<0?s[a].v="":(s[a].v=_.substr(0,O+1),O=-1),s[a].t="t",A=a);O>=0&&A<s.length&&(s[A].v=_.substr(0,O+1)+s[A].v)}else if(k!==s.length&&_.indexOf("E")===-1){for(O=_.indexOf(".")-1,a=k;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")-1:s[a].v.length-1,z=s[a].v.substr(f+1);f>=0;--f)O>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(z=_.charAt(O--)+z);s[a].v=z,s[a].t="t",A=a}for(O>=0&&A<s.length&&(s[A].v=_.substr(0,O+1)+s[A].v),O=_.indexOf(".")+1,a=k;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==k)){for(f=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")+1:0,z=s[a].v.substr(0,f);f<s[a].v.length;++f)O<_.length&&(z+=_.charAt(O++));s[a].v=z,s[a].t="t",A=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(U=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Fs(s[a].t,s[a].v,U),s[a].t="t");var I="";for(a=0;a!==s.length;++a)s[a]!=null&&(I+=s[a].v);return I}var Ov=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bv(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function p3(t,e){var r=h3(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Ov),o=r[1].match(Ov);return bv(e,a)?[n,r[0]]:bv(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function In(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Nv[t]]||ze[Nv[t]]),n==null&&(n=YR[t]||"General");break}if(ih(n,0))return Ea(e,r);e instanceof Date&&(e=F2(e,r.date1904));var s=p3(n,e);if(ih(s[1]))return Ea(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return d3(s[1],e,r,s[0])}function da(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function j2(){ze=XR()}var m3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},z2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function g3(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(z2,"(\\d+)"),new RegExp("^"+e+"$")}function x3(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(e.match(z2)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&s==-1&&i==-1?f:l+"T"+f}var v3=function(){var t={};t.version="1.2.0";function e(){for(var _=0,k=new Array(256),A=0;A!=256;++A)_=A,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,k[A]=_;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(_){var k=0,A=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=_[I];for(I=0;I!=256;++I)for(A=_[I],k=256+I;k<4096;k+=256)A=P[k]=A>>>8^_[A&255];var C=[];for(I=1;I!=16;++I)C[I-1]=typeof Int32Array<"u"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return C}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],l=s[4],f=s[5],h=s[6],d=s[7],m=s[8],g=s[9],x=s[10],E=s[11],T=s[12],w=s[13],v=s[14];function O(_,k){for(var A=k^-1,I=0,P=_.length;I<P;)A=A>>>8^r[(A^_.charCodeAt(I++))&255];return~A}function z(_,k){for(var A=k^-1,I=_.length-15,P=0;P<I;)A=v[_[P++]^A&255]^w[_[P++]^A>>8&255]^T[_[P++]^A>>16&255]^E[_[P++]^A>>>24]^x[_[P++]]^g[_[P++]]^m[_[P++]]^d[_[P++]]^h[_[P++]]^f[_[P++]]^l[_[P++]]^c[_[P++]]^o[_[P++]]^a[_[P++]]^i[_[P++]]^r[_[P++]];for(I+=15;P<I;)A=A>>>8^r[(A^_[P++])&255];return~A}function U(_,k){for(var A=k^-1,I=0,P=_.length,C=0,F=0;I<P;)C=_.charCodeAt(I++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,F=_.charCodeAt(I++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|F>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|F&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return t.table=r,t.bstr=O,t.buf=z,t.str=U,t}(),Je=function(){var e={};e.version="1.2.1";function r(S,M){for(var D=S.split("/"),b=M.split("/"),V=0,B=0,X=Math.min(D.length,b.length);V<X;++V){if(B=D[V].length-b[V].length)return B;if(D[V]!=b[V])return D[V]<b[V]?-1:1}return D.length-b.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(0,M+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(M+1)}function i(S,M){typeof M=="string"&&(M=new Date(M));var D=M.getHours();D=D<<6|M.getMinutes(),D=D<<5|M.getSeconds()>>>1,S.write_shift(2,D);var b=M.getFullYear()-1980;b=b<<4|M.getMonth()+1,b=b<<5|M.getDate(),S.write_shift(2,b)}function a(S){var M=S.read_shift(2)&65535,D=S.read_shift(2)&65535,b=new Date,V=D&31;D>>>=5;var B=D&15;D>>>=4,b.setMilliseconds(0),b.setFullYear(D+1980),b.setMonth(B-1),b.setDate(V);var X=M&31;M>>>=5;var te=M&63;return M>>>=6,b.setHours(M),b.setMinutes(te),b.setSeconds(X<<1),b}function o(S){cr(S,0);for(var M={},D=0;S.l<=S.length-4;){var b=S.read_shift(2),V=S.read_shift(2),B=S.l+V,X={};switch(b){case 21589:D=S.read_shift(1),D&1&&(X.mtime=S.read_shift(4)),V>5&&(D&2&&(X.atime=S.read_shift(4)),D&4&&(X.ctime=S.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}S.l=B,M[b]=X}return M}var c;function l(){return c||(c={})}function f(S,M){if(S[0]==80&&S[1]==75)return uc(S,M);if((S[0]|32)==109&&(S[1]|32)==105)return vu(S,M);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var D=3,b=512,V=0,B=0,X=0,te=0,Y=0,Q=[],J=S.slice(0,512);cr(J,0);var le=h(J);switch(D=le[0],D){case 3:b=512;break;case 4:b=4096;break;case 0:if(le[1]==0)return uc(S,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}b!==512&&(J=S.slice(0,b),cr(J,28));var xe=S.slice(0,b);d(J,D);var Ie=J.read_shift(4,"i");if(D===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);J.l+=4,X=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),te=J.read_shift(4,"i"),V=J.read_shift(4,"i"),Y=J.read_shift(4,"i"),B=J.read_shift(4,"i");for(var pe=-1,Ee=0;Ee<109&&(pe=J.read_shift(4,"i"),!(pe<0));++Ee)Q[Ee]=pe;var Me=m(S,b);E(Y,B,Me,b,Q);var ft=w(Me,X,Q,b);ft[X].name="!Directory",V>0&&te!==F&&(ft[te].name="!MiniFAT"),ft[Q[0]].name="!FAT",ft.fat_addrs=Q,ft.ssz=b;var ot={},yt=[],Es=[],Qi=[];v(X,ft,Me,yt,V,ot,Es,te),g(Es,Qi,yt),yt.shift();var Xs={FileIndex:Es,FullPaths:Qi};return M&&M.raw&&(Xs.raw={header:xe,sectors:Me}),Xs}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(me,"Header Signature: "),S.l+=16;var M=S.read_shift(2,"u");return[S.read_shift(2,"u"),M]}function d(S,M){var D=9;switch(S.l+=2,D=S.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,M){for(var D=Math.ceil(S.length/M)-1,b=[],V=1;V<D;++V)b[V-1]=S.slice(V*M,(V+1)*M);return b[D-1]=S.slice(D*M),b}function g(S,M,D){for(var b=0,V=0,B=0,X=0,te=0,Y=D.length,Q=[],J=[];b<Y;++b)Q[b]=J[b]=b,M[b]=D[b];for(;te<J.length;++te)b=J[te],V=S[b].L,B=S[b].R,X=S[b].C,Q[b]===b&&(V!==-1&&Q[V]!==V&&(Q[b]=Q[V]),B!==-1&&Q[B]!==B&&(Q[b]=Q[B])),X!==-1&&(Q[X]=b),V!==-1&&b!=Q[b]&&(Q[V]=Q[b],J.lastIndexOf(V)<te&&J.push(V)),B!==-1&&b!=Q[b]&&(Q[B]=Q[b],J.lastIndexOf(B)<te&&J.push(B));for(b=1;b<Y;++b)Q[b]===b&&(B!==-1&&Q[B]!==B?Q[b]=Q[B]:V!==-1&&Q[V]!==V&&(Q[b]=Q[V]));for(b=1;b<Y;++b)if(S[b].type!==0){if(te=b,te!=Q[te])do te=Q[te],M[b]=M[te]+"/"+M[b];while(te!==0&&Q[te]!==-1&&te!=Q[te]);Q[b]=-1}for(M[0]+="/",b=1;b<Y;++b)S[b].type!==2&&(M[b]+="/")}function x(S,M,D){for(var b=S.start,V=S.size,B=[],X=b;D&&V>0&&X>=0;)B.push(M.slice(X*C,X*C+C)),V-=C,X=sa(D,X*4);return B.length===0?Gt(0):ai(B).slice(0,S.size)}function E(S,M,D,b,V){var B=F;if(S===F){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var X=D[S],te=(b>>>2)-1;if(!X)return;for(var Y=0;Y<te&&(B=sa(X,Y*4))!==F;++Y)V.push(B);E(sa(X,b-4),M-1,D,b,V)}}function T(S,M,D,b,V){var B=[],X=[];V||(V=[]);var te=b-1,Y=0,Q=0;for(Y=M;Y>=0;){V[Y]=!0,B[B.length]=Y,X.push(S[Y]);var J=D[Math.floor(Y*4/b)];if(Q=Y*4&te,b<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+b);if(!S[J])break;Y=sa(S[J],Q)}return{nodes:B,data:Wv([X])}}function w(S,M,D,b){var V=S.length,B=[],X=[],te=[],Y=[],Q=b-1,J=0,le=0,xe=0,Ie=0;for(J=0;J<V;++J)if(te=[],xe=J+M,xe>=V&&(xe-=V),!X[xe]){Y=[];var pe=[];for(le=xe;le>=0;){pe[le]=!0,X[le]=!0,te[te.length]=le,Y.push(S[le]);var Ee=D[Math.floor(le*4/b)];if(Ie=le*4&Q,b<4+Ie)throw new Error("FAT boundary crossed: "+le+" 4 "+b);if(!S[Ee]||(le=sa(S[Ee],Ie),pe[le]))break}B[xe]={nodes:te,data:Wv([Y])}}return B}function v(S,M,D,b,V,B,X,te){for(var Y=0,Q=b.length?2:0,J=M[S].data,le=0,xe=0,Ie;le<J.length;le+=128){var pe=J.slice(le,le+128);cr(pe,64),xe=pe.read_shift(2),Ie=_g(pe,0,xe-Q),b.push(Ie);var Ee={name:Ie,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Me=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Me!==0&&(Ee.ct=O(pe,pe.l-8));var ft=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);ft!==0&&(Ee.mt=O(pe,pe.l-8)),Ee.start=pe.read_shift(4,"i"),Ee.size=pe.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=F,Ee.name=""),Ee.type===5?(Y=Ee.start,V>0&&Y!==F&&(M[Y].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",M[Ee.start]===void 0&&(M[Ee.start]=T(D,Ee.start,M.fat_addrs,M.ssz)),M[Ee.start].name=Ee.name,Ee.content=M[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:Y!==F&&Ee.start!==F&&M[Y]&&(Ee.content=x(Ee,M[Y].data,(M[te]||{}).data))),Ee.content&&cr(Ee.content,0),B[Ie]=Ee,X.push(Ee)}}function O(S,M){return new Date((rn(S,M+4)/1e7*Math.pow(2,32)+rn(S,M)/1e7-11644473600)*1e3)}function z(S,M){return l(),f(c.readFileSync(S),M)}function U(S,M){var D=M&&M.type;switch(D||Ye&&Buffer.isBuffer(S)&&(D="buffer"),D||"base64"){case"file":return z(S,M);case"base64":return f(Ln(un(S)),M);case"binary":return f(Ln(S),M)}return f(S,M)}function _(S,M){var D=M||{},b=D.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=b+"/",S.FileIndex[0]={name:b,type:5}),D.CLSID&&(S.FileIndex[0].clsid=D.CLSID),k(S)}function k(S){var M="Sh33tJ5";if(!Je.find(S,"/"+M)){var D=Gt(4);D[0]=55,D[1]=D[3]=50,D[2]=54,S.FileIndex.push({name:M,type:2,content:D,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+M),A(S)}}function A(S,M){_(S);for(var D=!1,b=!1,V=S.FullPaths.length-1;V>=0;--V){var B=S.FileIndex[V];switch(B.type){case 0:b?D=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(B.R*B.L*B.C)&&(D=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!M)){var X=new Date(1987,1,19),te=0,Y=Object.create?Object.create(null):{},Q=[];for(V=0;V<S.FullPaths.length;++V)Y[S.FullPaths[V]]=!0,S.FileIndex[V].type!==0&&Q.push([S.FullPaths[V],S.FileIndex[V]]);for(V=0;V<Q.length;++V){var J=n(Q[V][0]);b=Y[J],b||(Q.push([J,{name:s(J).replace("/",""),type:1,clsid:Ce,ct:X,mt:X,content:null}]),Y[J]=!0)}for(Q.sort(function(Ie,pe){return r(Ie[0],pe[0])}),S.FullPaths=[],S.FileIndex=[],V=0;V<Q.length;++V)S.FullPaths[V]=Q[V][0],S.FileIndex[V]=Q[V][1];for(V=0;V<Q.length;++V){var le=S.FileIndex[V],xe=S.FullPaths[V];if(le.name=s(xe).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Ce,V===0)le.C=Q.length>1?1:-1,le.size=0,le.type=5;else if(xe.slice(-1)=="/"){for(te=V+1;te<Q.length&&n(S.FullPaths[te])!=xe;++te);for(le.C=te>=Q.length?-1:te,te=V+1;te<Q.length&&n(S.FullPaths[te])!=n(xe);++te);le.R=te>=Q.length?-1:te,le.type=1}else n(S.FullPaths[V+1]||"")==n(xe)&&(le.R=V+1),le.type=2}}}function I(S,M){var D=M||{};if(D.fileType=="mad")return sr(S,D);switch(A(S),D.fileType){case"zip":return fc(S,D)}var b=function(Ie){for(var pe=0,Ee=0,Me=0;Me<Ie.FileIndex.length;++Me){var ft=Ie.FileIndex[Me];if(ft.content){var ot=ft.content.length;ot>0&&(ot<4096?pe+=ot+63>>6:Ee+=ot+511>>9)}}for(var yt=Ie.FullPaths.length+3>>2,Es=pe+7>>3,Qi=pe+127>>7,Xs=Es+Ee+yt+Qi,Xn=Xs+127>>7,Ga=Xn<=109?0:Math.ceil((Xn-109)/127);Xs+Xn+Ga+127>>7>Xn;)Ga=++Xn<=109?0:Math.ceil((Xn-109)/127);var Zr=[1,Ga,Xn,Qi,yt,Ee,pe,0];return Ie.FileIndex[0].size=pe<<6,Zr[7]=(Ie.FileIndex[0].start=Zr[0]+Zr[1]+Zr[2]+Zr[3]+Zr[4]+Zr[5])+(Zr[6]+7>>3),Zr}(S),V=Gt(b[7]<<9),B=0,X=0;{for(B=0;B<8;++B)V.write_shift(1,he[B]);for(B=0;B<8;++B)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),B=0;B<3;++B)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,b[2]),V.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:F),V.write_shift(4,b[3]),V.write_shift(-4,b[1]?b[0]-1:F),V.write_shift(4,b[1]),B=0;B<109;++B)V.write_shift(-4,B<b[2]?b[1]+B:-1)}if(b[1])for(X=0;X<b[1];++X){for(;B<236+X*127;++B)V.write_shift(-4,B<b[2]?b[1]+B:-1);V.write_shift(-4,X===b[1]-1?F:X+1)}var te=function(Ie){for(X+=Ie;B<X-1;++B)V.write_shift(-4,B+1);Ie&&(++B,V.write_shift(-4,F))};for(X=B=0,X+=b[1];B<X;++B)V.write_shift(-4,_e.DIFSECT);for(X+=b[2];B<X;++B)V.write_shift(-4,_e.FATSECT);te(b[3]),te(b[4]);for(var Y=0,Q=0,J=S.FileIndex[0];Y<S.FileIndex.length;++Y)J=S.FileIndex[Y],J.content&&(Q=J.content.length,!(Q<4096)&&(J.start=X,te(Q+511>>9)));for(te(b[6]+7>>3);V.l&511;)V.write_shift(-4,_e.ENDOFCHAIN);for(X=B=0,Y=0;Y<S.FileIndex.length;++Y)J=S.FileIndex[Y],J.content&&(Q=J.content.length,!(!Q||Q>=4096)&&(J.start=X,te(Q+63>>6)));for(;V.l&511;)V.write_shift(-4,_e.ENDOFCHAIN);for(B=0;B<b[4]<<2;++B){var le=S.FullPaths[B];if(!le||le.length===0){for(Y=0;Y<17;++Y)V.write_shift(4,0);for(Y=0;Y<3;++Y)V.write_shift(4,-1);for(Y=0;Y<12;++Y)V.write_shift(4,0);continue}J=S.FileIndex[B],B===0&&(J.start=J.size?J.start-1:F);var xe=B===0&&D.root||J.name;if(Q=2*(xe.length+1),V.write_shift(64,xe,"utf16le"),V.write_shift(2,Q),V.write_shift(1,J.type),V.write_shift(1,J.color),V.write_shift(-4,J.L),V.write_shift(-4,J.R),V.write_shift(-4,J.C),J.clsid)V.write_shift(16,J.clsid,"hex");else for(Y=0;Y<4;++Y)V.write_shift(4,0);V.write_shift(4,J.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,J.start),V.write_shift(4,J.size),V.write_shift(4,0)}for(B=1;B<S.FileIndex.length;++B)if(J=S.FileIndex[B],J.size>=4096)if(V.l=J.start+1<<9,Ye&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+511&-512;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&511;++Y)V.write_shift(1,0)}for(B=1;B<S.FileIndex.length;++B)if(J=S.FileIndex[B],J.size>0&&J.size<4096)if(Ye&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+63&-64;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&63;++Y)V.write_shift(1,0)}if(Ye)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function P(S,M){var D=S.FullPaths.map(function(Y){return Y.toUpperCase()}),b=D.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),V=!1;M.charCodeAt(0)===47?(V=!0,M=D[0].slice(0,-1)+M):V=M.indexOf("/")!==-1;var B=M.toUpperCase(),X=V===!0?D.indexOf(B):b.indexOf(B);if(X!==-1)return S.FileIndex[X];var te=!B.match(Fc);for(B=B.replace(Vr,""),te&&(B=B.replace(Fc,"!")),X=0;X<D.length;++X)if((te?D[X].replace(Fc,"!"):D[X]).replace(Vr,"")==B||(te?b[X].replace(Fc,"!"):b[X]).replace(Vr,"")==B)return S.FileIndex[X];return null}var C=64,F=-2,me="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(S,M,D){l();var b=I(S,D);c.writeFileSync(M,b)}function W(S){for(var M=new Array(S.length),D=0;D<S.length;++D)M[D]=String.fromCharCode(S[D]);return M.join("")}function fe(S,M){var D=I(S,M);switch(M&&M.type||"buffer"){case"file":return l(),c.writeFileSync(M.filename,D),D;case"binary":return typeof D=="string"?D:W(D);case"base64":return Iv(typeof D=="string"?D:W(D));case"buffer":if(Ye)return Buffer.isBuffer(D)?D:Fa(D);case"array":return typeof D=="string"?Ln(D):D}return D}var ke;function L(S){try{var M=S.InflateRaw,D=new M;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ke=S;else throw new Error("zlib does not expose bytesRead")}catch(b){console.error("cannot use native zlib: "+(b.message||b))}}function K(S,M){if(!ke)return $a(S,M);var D=ke.InflateRaw,b=new D,V=b._processChunk(S.slice(S.l),b._finishFlushFlag);return S.l+=b.bytesRead,V}function G(S){return ke?ke.deflateRawSync(S):ce(S)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(S){var M=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(M>>16|M>>8|M)&255}for(var ge=typeof Uint8Array<"u",ae=ge?new Uint8Array(256):[],He=0;He<256;++He)ae[He]=Ae(He);function j(S,M){var D=ae[S&255];return M<=8?D>>>8-M:(D=D<<8|ae[S>>8&255],M<=16?D>>>16-M:(D=D<<8|ae[S>>16&255],D>>>24-M))}function lt(S,M){var D=M&7,b=M>>>3;return(S[b]|(D<=6?0:S[b+1]<<8))>>>D&3}function $e(S,M){var D=M&7,b=M>>>3;return(S[b]|(D<=5?0:S[b+1]<<8))>>>D&7}function et(S,M){var D=M&7,b=M>>>3;return(S[b]|(D<=4?0:S[b+1]<<8))>>>D&15}function je(S,M){var D=M&7,b=M>>>3;return(S[b]|(D<=3?0:S[b+1]<<8))>>>D&31}function ye(S,M){var D=M&7,b=M>>>3;return(S[b]|(D<=1?0:S[b+1]<<8))>>>D&127}function nt(S,M,D){var b=M&7,V=M>>>3,B=(1<<D)-1,X=S[V]>>>b;return D<8-b||(X|=S[V+1]<<8-b,D<16-b)||(X|=S[V+2]<<16-b,D<24-b)||(X|=S[V+3]<<24-b),X&B}function nr(S,M,D){var b=M&7,V=M>>>3;return b<=5?S[V]|=(D&7)<<b:(S[V]|=D<<b&255,S[V+1]=(D&7)>>8-b),M+3}function $t(S,M,D){var b=M&7,V=M>>>3;return D=(D&1)<<b,S[V]|=D,M+1}function zr(S,M,D){var b=M&7,V=M>>>3;return D<<=b,S[V]|=D&255,D>>>=8,S[V+1]=D,M+8}function vs(S,M,D){var b=M&7,V=M>>>3;return D<<=b,S[V]|=D&255,D>>>=8,S[V+1]=D&255,S[V+2]=D>>>8,M+16}function mr(S,M){var D=S.length,b=2*D>M?2*D:M+5,V=0;if(D>=M)return S;if(Ye){var B=Cv(b);if(S.copy)S.copy(B);else for(;V<S.length;++V)B[V]=S[V];return B}else if(ge){var X=new Uint8Array(b);if(X.set)X.set(S);else for(;V<D;++V)X[V]=S[V];return X}return S.length=b,S}function Wt(S){for(var M=new Array(S),D=0;D<S;++D)M[D]=0;return M}function Hr(S,M,D){var b=1,V=0,B=0,X=0,te=0,Y=S.length,Q=ge?new Uint16Array(32):Wt(32);for(B=0;B<32;++B)Q[B]=0;for(B=Y;B<D;++B)S[B]=0;Y=S.length;var J=ge?new Uint16Array(Y):Wt(Y);for(B=0;B<Y;++B)Q[V=S[B]]++,b<V&&(b=V),J[B]=0;for(Q[0]=0,B=1;B<=b;++B)Q[B+16]=te=te+Q[B-1]<<1;for(B=0;B<Y;++B)te=S[B],te!=0&&(J[B]=Q[te+16]++);var le=0;for(B=0;B<Y;++B)if(le=S[B],le!=0)for(te=j(J[B],b)>>b-le,X=(1<<b+4-le)-1;X>=0;--X)M[te|X<<le]=le&15|B<<4;return b}var ut=ge?new Uint16Array(512):Wt(512),Z=ge?new Uint16Array(32):Wt(32);if(!ge){for(var oe=0;oe<512;++oe)ut[oe]=0;for(oe=0;oe<32;++oe)Z[oe]=0}(function(){for(var S=[],M=0;M<32;M++)S.push(5);Hr(S,Z,32);var D=[];for(M=0;M<=143;M++)D.push(8);for(;M<=255;M++)D.push(9);for(;M<=279;M++)D.push(7);for(;M<=287;M++)D.push(8);Hr(D,ut,288)})();var we=function(){for(var M=ge?new Uint8Array(32768):[],D=0,b=0;D<de.length-1;++D)for(;b<de[D+1];++b)M[b]=D;for(;b<32768;++b)M[b]=29;var V=ge?new Uint8Array(259):[];for(D=0,b=0;D<re.length-1;++D)for(;b<re[D+1];++b)V[b]=D;function B(te,Y){for(var Q=0;Q<te.length;){var J=Math.min(65535,te.length-Q),le=Q+J==te.length;for(Y.write_shift(1,+le),Y.write_shift(2,J),Y.write_shift(2,~J&65535);J-- >0;)Y[Y.l++]=te[Q++]}return Y.l}function X(te,Y){for(var Q=0,J=0,le=ge?new Uint16Array(32768):[];J<te.length;){var xe=Math.min(65535,te.length-J);if(xe<10){for(Q=nr(Y,Q,+(J+xe==te.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,xe),Y.write_shift(2,~xe&65535);xe-- >0;)Y[Y.l++]=te[J++];Q=Y.l*8;continue}Q=nr(Y,Q,+(J+xe==te.length)+2);for(var Ie=0;xe-- >0;){var pe=te[J];Ie=(Ie<<5^pe)&32767;var Ee=-1,Me=0;if((Ee=le[Ie])&&(Ee|=J&-32768,Ee>J&&(Ee-=32768),Ee<J))for(;te[Ee+Me]==te[J+Me]&&Me<250;)++Me;if(Me>2){pe=V[Me],pe<=22?Q=zr(Y,Q,ae[pe+1]>>1)-1:(zr(Y,Q,3),Q+=5,zr(Y,Q,ae[pe-23]>>5),Q+=3);var ft=pe<8?0:pe-4>>2;ft>0&&(vs(Y,Q,Me-re[pe]),Q+=ft),pe=M[J-Ee],Q=zr(Y,Q,ae[pe]>>3),Q-=3;var ot=pe<4?0:pe-2>>1;ot>0&&(vs(Y,Q,J-Ee-de[pe]),Q+=ot);for(var yt=0;yt<Me;++yt)le[Ie]=J&32767,Ie=(Ie<<5^te[J])&32767,++J;xe-=Me-1}else pe<=143?pe=pe+48:Q=$t(Y,Q,1),Q=zr(Y,Q,ae[pe]),le[Ie]=J&32767,++J}Q=zr(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?B(Y,Q):X(Y,Q)}}();function ce(S){var M=Gt(50+Math.floor(S.length*1.1)),D=we(S,M);return M.slice(0,D)}var Te=ge?new Uint16Array(32768):Wt(32768),Pe=ge?new Uint16Array(32768):Wt(32768),De=ge?new Uint16Array(128):Wt(128),it=1,dn=1;function cc(S,M){var D=je(S,M)+257;M+=5;var b=je(S,M)+1;M+=5;var V=et(S,M)+4;M+=4;for(var B=0,X=ge?new Uint8Array(19):Wt(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=ge?new Uint8Array(8):Wt(8),J=ge?new Uint8Array(8):Wt(8),le=X.length,xe=0;xe<V;++xe)X[H[xe]]=B=$e(S,M),Y<B&&(Y=B),Q[B]++,M+=3;var Ie=0;for(Q[0]=0,xe=1;xe<=Y;++xe)J[xe]=Ie=Ie+Q[xe-1]<<1;for(xe=0;xe<le;++xe)(Ie=X[xe])!=0&&(te[xe]=J[Ie]++);var pe=0;for(xe=0;xe<le;++xe)if(pe=X[xe],pe!=0){Ie=ae[te[xe]]>>8-pe;for(var Ee=(1<<7-pe)-1;Ee>=0;--Ee)De[Ie|Ee<<pe]=pe&7|xe<<3}var Me=[];for(Y=1;Me.length<D+b;)switch(Ie=De[ye(S,M)],M+=Ie&7,Ie>>>=3){case 16:for(B=3+lt(S,M),M+=2,Ie=Me[Me.length-1];B-- >0;)Me.push(Ie);break;case 17:for(B=3+$e(S,M),M+=3;B-- >0;)Me.push(0);break;case 18:for(B=11+ye(S,M),M+=7;B-- >0;)Me.push(0);break;default:Me.push(Ie),Y<Ie&&(Y=Ie);break}var ft=Me.slice(0,D),ot=Me.slice(D);for(xe=D;xe<286;++xe)ft[xe]=0;for(xe=b;xe<30;++xe)ot[xe]=0;return it=Hr(ft,Te,286),dn=Hr(ot,Pe,30),M}function R0(S,M){if(S[0]==3&&!(S[1]&3))return[Fi(M),2];for(var D=0,b=0,V=Cv(M||1<<18),B=0,X=V.length>>>0,te=0,Y=0;!(b&1);){if(b=$e(S,D),D+=3,b>>>1)b>>1==1?(te=9,Y=5):(D=cc(S,D),te=it,Y=dn);else{D&7&&(D+=8-(D&7));var Q=S[D>>>3]|S[(D>>>3)+1]<<8;if(D+=32,Q>0)for(!M&&X<B+Q&&(V=mr(V,B+Q),X=V.length);Q-- >0;)V[B++]=S[D>>>3],D+=8;continue}for(;;){!M&&X<B+32767&&(V=mr(V,B+32767),X=V.length);var J=nt(S,D,te),le=b>>>1==1?ut[J]:Te[J];if(D+=le&15,le>>>=4,!(le>>>8&255))V[B++]=le;else{if(le==256)break;le-=257;var xe=le<8?0:le-4>>2;xe>5&&(xe=0);var Ie=B+re[le];xe>0&&(Ie+=nt(S,D,xe),D+=xe),J=nt(S,D,Y),le=b>>>1==1?Z[J]:Pe[J],D+=le&15,le>>>=4;var pe=le<4?0:le-2>>1,Ee=de[le];for(pe>0&&(Ee+=nt(S,D,pe),D+=pe),!M&&X<Ie&&(V=mr(V,Ie+100),X=V.length);B<Ie;)V[B]=V[B-Ee],++B}}}return M?[V,D+7>>>3]:[V.slice(0,B),D+7>>>3]}function $a(S,M){var D=S.slice(S.l||0),b=R0(D,M);return S.l+=b[1],b[0]}function lc(S,M){if(S)typeof console<"u"&&console.error(M);else throw new Error(M)}function uc(S,M){var D=S;cr(D,0);var b=[],V=[],B={FileIndex:b,FullPaths:V};_(B,{root:M.root});for(var X=D.length-4;(D[X]!=80||D[X+1]!=75||D[X+2]!=5||D[X+3]!=6)&&X>=0;)--X;D.l=X+4,D.l+=4;var te=D.read_shift(2);D.l+=6;var Y=D.read_shift(4);for(D.l=Y,X=0;X<te;++X){D.l+=20;var Q=D.read_shift(4),J=D.read_shift(4),le=D.read_shift(2),xe=D.read_shift(2),Ie=D.read_shift(2);D.l+=8;var pe=D.read_shift(4),Ee=o(D.slice(D.l+le,D.l+le+xe));D.l+=le+xe+Ie;var Me=D.l;D.l=pe+4,qi(D,Q,J,B,Ee),D.l=Me}return B}function qi(S,M,D,b,V){S.l+=2;var B=S.read_shift(2),X=S.read_shift(2),te=a(S);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var Y=S.read_shift(4),Q=S.read_shift(4),J=S.read_shift(4),le=S.read_shift(2),xe=S.read_shift(2),Ie="",pe=0;pe<le;++pe)Ie+=String.fromCharCode(S[S.l++]);if(xe){var Ee=o(S.slice(S.l,S.l+xe));(Ee[21589]||{}).mt&&(te=Ee[21589].mt),((V||{})[21589]||{}).mt&&(te=V[21589].mt)}S.l+=xe;var Me=S.slice(S.l,S.l+Q);switch(X){case 8:Me=K(S,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var ft=!1;B&8&&(Y=S.read_shift(4),Y==134695760&&(Y=S.read_shift(4),ft=!0),Q=S.read_shift(4),J=S.read_shift(4)),Q!=M&&lc(ft,"Bad compressed size: "+M+" != "+Q),J!=D&&lc(ft,"Bad uncompressed size: "+D+" != "+J),ys(b,Ie,Me,{unsafe:!0,mt:te})}function fc(S,M){var D=M||{},b=[],V=[],B=Gt(1),X=D.compression?8:0,te=0,Y=0,Q=0,J=0,le=0,xe=S.FullPaths[0],Ie=xe,pe=S.FileIndex[0],Ee=[],Me=0;for(Y=1;Y<S.FullPaths.length;++Y)if(Ie=S.FullPaths[Y].slice(xe.length),pe=S.FileIndex[Y],!(!pe.size||!pe.content||Ie=="Sh33tJ5")){var ft=J,ot=Gt(Ie.length);for(Q=0;Q<Ie.length;++Q)ot.write_shift(1,Ie.charCodeAt(Q)&127);ot=ot.slice(0,ot.l),Ee[le]=v3.buf(pe.content,0);var yt=pe.content;X==8&&(yt=G(yt)),B=Gt(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,te),B.write_shift(2,X),pe.mt?i(B,pe.mt):B.write_shift(4,0),B.write_shift(-4,Ee[le]),B.write_shift(4,yt.length),B.write_shift(4,pe.content.length),B.write_shift(2,ot.length),B.write_shift(2,0),J+=B.length,b.push(B),J+=ot.length,b.push(ot),J+=yt.length,b.push(yt),B=Gt(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,te),B.write_shift(2,X),B.write_shift(4,0),B.write_shift(-4,Ee[le]),B.write_shift(4,yt.length),B.write_shift(4,pe.content.length),B.write_shift(2,ot.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,ft),Me+=B.l,V.push(B),Me+=ot.length,V.push(ot),++le}return B=Gt(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,le),B.write_shift(2,le),B.write_shift(4,Me),B.write_shift(4,J),B.write_shift(2,0),ai([ai(b),ai(V),B])}var qs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _s(S,M){if(S.ctype)return S.ctype;var D=S.name||"",b=D.match(/\.([^\.]+)$/);return b&&qs[b[1]]||M&&(b=(D=M).match(/[\.\\]([^\.\\])+$/),b&&qs[b[1]])?qs[b[1]]:"application/octet-stream"}function gu(S){for(var M=Iv(S),D=[],b=0;b<M.length;b+=76)D.push(M.slice(b,b+76));return D.join(`\r
`)+`\r
`}function Wa(S){var M=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var J=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],b=M.split(`\r
`),V=0;V<b.length;++V){var B=b[V];if(B.length==0){D.push("");continue}for(var X=0;X<B.length;){var te=76,Y=B.slice(X,X+te);Y.charAt(te-1)=="="?te--:Y.charAt(te-2)=="="?te-=2:Y.charAt(te-3)=="="&&(te-=3),Y=B.slice(X,X+te),X+=te,X<B.length&&(Y+="="),D.push(Y)}}return D.join(`\r
`)}function xu(S){for(var M=[],D=0;D<S.length;++D){for(var b=S[D];D<=S.length&&b.charAt(b.length-1)=="=";)b=b.slice(0,b.length-1)+S[++D];M.push(b)}for(var V=0;V<M.length;++V)M[V]=M[V].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Ln(M.join(`\r
`))}function Xi(S,M,D){for(var b="",V="",B="",X,te=0;te<10;++te){var Y=M[te];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":b=Q[2].trim();break;case"content-type":B=Q[2].trim();break;case"content-transfer-encoding":V=Q[2].trim();break}}switch(++te,V.toLowerCase()){case"base64":X=Ln(un(M.slice(te).join("")));break;case"quoted-printable":X=xu(M.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var J=ys(S,b.slice(D.length),X,{unsafe:!0});B&&(J.ctype=B)}function vu(S,M){if(W(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=M&&M.root||"",b=(Ye&&Buffer.isBuffer(S)?S.toString("binary"):W(S)).split(`\r
`),V=0,B="";for(V=0;V<b.length;++V)if(B=b[V],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),D||(D=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),B.slice(0,D.length)!=D););var X=(b[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var te="--"+(X[1]||""),Y=[],Q=[],J={FileIndex:Y,FullPaths:Q};_(J);var le,xe=0;for(V=0;V<b.length;++V){var Ie=b[V];Ie!==te&&Ie!==te+"--"||(xe++&&Xi(J,b.slice(le,V),D),le=V)}return J}function sr(S,M){var D=M||{},b=D.boundary||"SheetJS";b="------="+b;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+b.slice(2)+'"',"","",""],B=S.FullPaths[0],X=B,te=S.FileIndex[0],Y=1;Y<S.FullPaths.length;++Y)if(X=S.FullPaths[Y].slice(B.length),te=S.FileIndex[Y],!(!te.size||!te.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var Q=te.content,J=Ye&&Buffer.isBuffer(Q)?Q.toString("binary"):W(Q),le=0,xe=Math.min(1024,J.length),Ie=0,pe=0;pe<=xe;++pe)(Ie=J.charCodeAt(pe))>=32&&Ie<128&&++le;var Ee=le>=xe*4/5;V.push(b),V.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+X),V.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),V.push("Content-Type: "+_s(te,X)),V.push(""),V.push(Ee?Wa(J):gu(J))}return V.push(b+`--\r
`),V.join(`\r
`)}function _u(S){var M={};return _(M,S),M}function ys(S,M,D,b){var V=b&&b.unsafe;V||_(S);var B=!V&&Je.find(S,M);if(!B){var X=S.FullPaths[0];M.slice(0,X.length)==X?X=M:(X.slice(-1)!="/"&&(X+="/"),X=(X+M).replace("//","/")),B={name:s(M),type:2},S.FileIndex.push(B),S.FullPaths.push(X),V||Je.utils.cfb_gc(S)}return B.content=D,B.size=D?D.length:0,b&&(b.CLSID&&(B.clsid=b.CLSID),b.mt&&(B.mt=b.mt),b.ct&&(B.ct=b.ct)),B}function Yi(S,M){_(S);var D=Je.find(S,M);if(D){for(var b=0;b<S.FileIndex.length;++b)if(S.FileIndex[b]==D)return S.FileIndex.splice(b,1),S.FullPaths.splice(b,1),!0}return!1}function P0(S,M,D){_(S);var b=Je.find(S,M);if(b){for(var V=0;V<S.FileIndex.length;++V)if(S.FileIndex[V]==b)return S.FileIndex[V].name=s(D),S.FullPaths[V]=D,!0}return!1}function N0(S){A(S,!0)}return e.find=P,e.read=U,e.parse=f,e.write=fe,e.writeFile=ie,e.utils={cfb_new:_u,cfb_add:ys,cfb_del:Yi,cfb_mov:P0,cfb_gc:N0,ReadShift:Yc,CheckField:uT,prep_blob:cr,bconcat:ai,use_zlib:L,_deflateRaw:ce,_inflateRaw:$a,consts:_e},e}();function _3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ds(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function mg(t){for(var e=[],r=ds(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var oh=new Date(1899,11,30,0,0,0);function Ur(t,e){var r=t.getTime(),n=oh.getTime()+(t.getTimezoneOffset()-oh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var H2=new Date,y3=oh.getTime()+(H2.getTimezoneOffset()-oh.getTimezoneOffset())*6e4,Lv=H2.getTimezoneOffset();function e0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+y3),e.getTimezoneOffset()!==Lv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Lv)*6e4),e}function E3(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var Mv=new Date("2017-02-19T19:06:09.000Z"),$2=isNaN(Mv.getFullYear())?new Date("2/19/17"):Mv,w3=$2.getFullYear()==2017;function rr(t,e){var r=new Date(t);if(w3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if($2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function wa(t,e){if(Ye&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Oc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Oc(P2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Oc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Oc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function fr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=fr(t[r]));return e}function Rt(t,e){for(var r="";r.length<e;)r+=t;return r}function zn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var T3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&T3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var k3=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function W2(t){return t?t.content&&t.type?wa(t.content,!0):t.data?Nc(t.data):t.asNodeBuffer&&Ye?Nc(t.asNodeBuffer().toString("binary")):t.asBinary?Nc(t.asBinary()):t._data&&t._data.getContent?Nc(wa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function G2(t){if(!t)return null;if(t.data)return Av(t.data);if(t.asNodeBuffer&&Ye)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Av(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function A3(t){return t&&t.name.slice(-4)===".bin"?G2(t):W2(t)}function gn(t,e){for(var r=t.FullPaths||ds(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function gg(t,e){var r=gn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ut(t,e,r){if(!r)return A3(gg(t,e));if(!e)return null;try{return Ut(t,e)}catch{return null}}function nn(t,e,r){if(!r)return W2(gg(t,e));if(!e)return null;try{return nn(t,e)}catch{return null}}function S3(t,e,r){return G2(gg(t,e))}function Vv(t){for(var e=t.FullPaths||ds(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function I3(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ye?n=Fa(r):n=GR(r),Je.utils.cfb_add(t,e,n)}Je.utils.cfb_add(t,e,r)}else t.file(e,r)}function K2(t,e){switch(e.type){case"base64":return Je.read(t,{type:"base64"});case"binary":return Je.read(t,{type:"binary"});case"buffer":case"array":return Je.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Dc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var q2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,C3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Uv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,R3=/<[^>]*>/g,Fr=q2.match(Uv)?Uv:R3,P3=/<\w*:/,N3=/<(\/?)\w+:/;function Le(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(C3),o=0,c="",l=0,f="",h="",d=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(d=(s=h.charCodeAt(i+1))==34||s==39?1:0,c=h.slice(i+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function gs(t){return t.replace(N3,"<$1")}var X2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F3=mg(X2),rt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,c){return X2[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),D3=/[&<>'"]/g,O3=/[\u0000-\u001f]/g;function xg(t){var e=t+"";return e.replace(D3,function(r){return F3[r]}).replace(/\n/g,"<br/>").replace(O3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Bv=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Et(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hd(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function jv(t){var e=Fi(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function zv(t){return Fa(t,"binary").toString("utf8")}var Xu="foo bar baz",mt=Ye&&(zv(Xu)==hd(Xu)&&zv||jv(Xu)==hd(Xu)&&jv)||hd,Oc=Ye?function(t){return Fa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Nl=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Y2=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),b3=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),L3=/<\/?(?:vt:)?variant>/g,M3=/<(?:vt:)([^>]*)>([\s\S]*)</;function Hv(t,e){var r=Le(t),n=t.match(b3(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(L3,"").match(M3);a&&s.push({v:mt(a[2]),t:a[1]})}),s}var V3=/(^\s|\s$|\n)/;function U3(t){return ds(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function B3(t,e,r){return"<"+t+(r!=null?U3(r):"")+(e!=null?(e.match(V3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function vg(t){if(Ye&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return mt(Da(hg(t)));throw new Error("Bad input format: expected Buffer or string")}var Fl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,j3={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},z3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function H3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function $3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var $v=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Wv=Ye?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Fa(e)})):$v(t)}:$v,Gv=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Cs(t,s)));return n.join("").replace(Vr,"")},_g=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Vr,""):Gv(t,e,r)}:Gv,Kv=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},Q2=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Kv(t,e,r)}:Kv,qv=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Ja(t,s)));return n.join("")},Jl=Ye?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):qv(e,r,n)}:qv,J2=function(t,e){var r=rn(t,e);return r>0?Jl(t,e+4,e+4+r-1):""},Z2=J2,eT=function(t,e){var r=rn(t,e);return r>0?Jl(t,e+4,e+4+r-1):""},tT=eT,rT=function(t,e){var r=2*rn(t,e);return r>0?Jl(t,e+4,e+4+r-1):""},nT=rT,sT=function(e,r){var n=rn(e,r);return n>0?_g(e,r+4,r+4+n):""},iT=sT,aT=function(t,e){var r=rn(t,e);return r>0?Jl(t,e+4,e+4+r):""},oT=aT,cT=function(t,e){return H3(t,e)},ch=cT,lT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ye&&(Z2=function(e,r){if(!Buffer.isBuffer(e))return J2(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tT=function(e,r){if(!Buffer.isBuffer(e))return eT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},nT=function(e,r){if(!Buffer.isBuffer(e))return rT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},iT=function(e,r){if(!Buffer.isBuffer(e))return sT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},oT=function(e,r){if(!Buffer.isBuffer(e))return aT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ch=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):cT(e,r)},lT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ja=function(t,e){return t[e]},Cs=function(t,e){return t[e+1]*256+t[e]},W3=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},rn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},sa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},G3=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Yc(t,e){var r="",n,s,i=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Cs(this,l)),l+=2;t*=2;break;case"utf8":r=Jl(this,this.l,this.l+t);break;case"utf16le":t*=2,r=_g(this,this.l,this.l+t);break;case"wstr":return Yc.call(this,t,"dbcs");case"lpstr-ansi":r=Z2(this,this.l),t=4+rn(this,this.l);break;case"lpstr-cp":r=tT(this,this.l),t=4+rn(this,this.l);break;case"lpwstr":r=nT(this,this.l),t=4+2*rn(this,this.l);break;case"lpp4":t=4+rn(this,this.l),r=iT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+rn(this,this.l),r=oT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ja(this,this.l+t++))!==0;)i.push(qu(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Cs(this,this.l+t))!==0;)i.push(qu(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Ja(this,l),this.l=l+1,o=Yc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(qu(Cs(this,l))),l+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Ja(this,l),this.l=l+1,o=Yc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(qu(Ja(this,l))),l+=1}r=i.join("");break;default:switch(t){case 1:return n=Ja(this,this.l),this.l++,n;case 2:return n=(e==="i"?W3:Cs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?sa:G3)(this,this.l),this.l+=4,n):(s=rn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=ch(this,this.l):s=ch([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=Q2(this,this.l,t);break}}return this.l+=t,r}var K3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},q3=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},X3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Y3(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)X3(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,K3(this,e,this.l);break;case 8:if(n=8,r==="f"){$3(this,e,this.l);break}case 16:break;case-4:n=4,q3(this,e,this.l);break}return this.l+=n,this}function uT(t,e){var r=Q2(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function cr(t,e){t.l=e,t.read_shift=Yc,t.chk=uT,t.write_shift=Y3}function Pr(t,e){t.l+=e}function Gt(t){var e=Fi(t);return cr(e,0),e}function Gs(t,e,r){if(t){var n,s,i;cr(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=ph[o]||ph[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;c=t.l+i;var f=l.f&&l.f(t,i,r);if(t.l=c,e(f,l,o))return}}}function Np(){var t=[],e=Ye?256:2048,r=function(l){var f=Gt(l);return cr(f,0),f},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(l){return n&&l<n.length-n.l?n:(s(),n=r(Math.max(l+1,e)))},a=function(){return s(),ai(t)},o=function(l){s(),n=l,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Qc(t,e,r){var n=fr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xv(t,e,r){var n=fr(t);return n.s=Qc(n.s,e.s,r),n.e=Qc(n.e,e.s,r),n}function Jc(t,e){if(t.cRel&&t.c<0)for(t=fr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=fr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ue(t);return!t.cRel&&t.cRel!=null&&(r=Z3(r)),!t.rRel&&t.rRel!=null&&(r=Q3(r)),r}function dd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xt(t.s.c)+":"+(t.e.cRel?"":"$")+Xt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+hr(t.s.r)+":"+(t.e.rRel?"":"$")+hr(t.e.r):Jc(t.s,e.biff)+":"+Jc(t.e,e.biff)}function yg(t){return parseInt(J3(t),10)-1}function hr(t){return""+(t+1)}function Q3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function J3(t){return t.replace(/\$(\d+)$/,"$1")}function Eg(t){for(var e=eP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Xt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Z3(t){return t.replace(/^([A-Z])/,"$$$1")}function eP(t){return t.replace(/^\$([A-Z])/,"$1")}function tP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Lr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ue(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Jo(t){var e=t.indexOf(":");return e==-1?{s:Lr(t),e:Lr(t)}:{s:Lr(t.slice(0,e)),e:Lr(t.slice(e+1))}}function Ze(t,e){return typeof e>"u"||typeof e=="number"?Ze(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof e!="string"&&(e=Ue(e)),t==e?t:t+":"+e)}function Pt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Yv(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=In(t.z,r?Ur(e):e)}catch{}try{return t.w=In((t.XF||{}).numFmtId||(r?14:0),r?Ur(e):e)}catch{return""+e}}function Bs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?La[t.v]||t.v:e==null?Yv(t,t.v):Yv(t,e))}function $i(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function fT(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Lr(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Pt(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),a==-1&&(l.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},g=a+h,x=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>x&&(l.s.c=x),l.e.r<g&&(l.e.r=g),l.e.c<x&&(l.e.c=x),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ze[14],n.cellDates?(m.t="d",m.w=In(m.z,Ur(m.v))):(m.t="n",m.v=Ur(m.v),m.w=In(m.z,m.v))):m.t="s";if(s)i[g]||(i[g]=[]),i[g][x]&&i[g][x].z&&(m.z=i[g][x].z),i[g][x]=m;else{var E=Ue({c:x,r:g});i[E]&&i[E].z&&(m.z=i[E].z),i[E]=m}}}return l.s.c<1e7&&(i["!ref"]=Ze(l)),i}function Zo(t,e){return fT(null,t,e)}function rP(t){return t.read_shift(4,"i")}function Cr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function nP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wg(t,e){var r=t.l,n=t.read_shift(1),s=Cr(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)i.push(nP(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var sP=wg;function Cn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Oa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var iP=Cr;function Tg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var aP=Cr,Fp=Tg;function kg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?ch([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):sa(e,0)>>2;return r?s/100:s}function hT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var ba=hT;function Sr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function oP(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var l=pa[s];l&&(e.rgb=Ol(l));break;case 2:e.rgb=Ol([a,o,c]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function cP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function dT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function lP(t){return dT(t,1)}function uP(t){return dT(t,2)}var Ag=2,$r=3,Yu=11,Qv=12,lh=19,Qu=64,fP=65,hP=71,dP=4108,pP=4126,Jt=80,pT=81,mP=[Jt,pT],gP={1:{n:"CodePage",t:Ag},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:Yu},12:{n:"HeadingPairs",t:dP},13:{n:"TitlesOfParts",t:pP},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:Yu},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:Yu},22:{n:"HyperlinksChanged",t:Yu},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:fP},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:lh},2147483651:{n:"Behavior",t:lh},1919054434:{}},xP={1:{n:"CodePage",t:Ag},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:Qu},11:{n:"LastPrinted",t:Qu},12:{n:"CreatedDate",t:Qu},13:{n:"ModifiedDate",t:Qu},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:hP},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:lh},2147483651:{n:"Behavior",t:lh},1919054434:{}},Jv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},vP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _P(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var yP=_P([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),pa=fr(yP),La={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function EP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wP(t){var e=EP();if(!t||!t.match)return e;var r={};if((t.match(Fr)||[]).forEach(function(n){var s=Le(n);switch(s[0].replace(P3,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[Zv[s.ContentType]]!==void 0&&e[Zv[s.ContentType]].push(s.PartName);break}}),e.xmlns!==j3.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var go={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Dp(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Zc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Fr)||[]).forEach(function(s){var i=Le(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Dc(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var TP="application/vnd.oasis.opendocument.spreadsheet";function kP(t,e){for(var r=vg(t),n,s;n=Fl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Le(n[0],!1),s.path=="/"&&s.type!==TP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var el=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],AP=function(){for(var t=new Array(el.length),e=0;e<el.length;++e){var r=el[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function gT(t){var e={};t=mt(t);for(var r=0;r<el.length;++r){var n=el[r],s=t.match(AP[r]);s!=null&&s.length>0&&(e[n[1]]=rt(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=rr(e[n[1]]))}return e}var SP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function xT(t,e,r,n){var s=[];if(typeof t=="string")s=Hv(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(f){return{v:f}}));var a=typeof e=="string"?Hv(e,n).map(function(f){return f.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==s.length;l+=2){switch(c=+s[l+1].v,s[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function IP(t,e,r){var n={};return e||(e={}),t=mt(t),SP.forEach(function(s){var i=(t.match(Nl(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=rt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&xT(n.HeadingPairs,n.TitlesOfParts,e,r),e}var CP=/<[^>]+>[^<]*/g;function RP(t,e){var r={},n="",s=t.match(CP);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Le(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=rt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=rt(f);break;case"bool":r[n]=Et(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=rr(f);break;case"cy":case"error":r[n]=rt(f);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var PP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pd;function NP(t,e,r){pd||(pd=mg(PP)),e=pd[e]||e,t[e]=r}function Sg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vT(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function _T(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function yT(t,e,r){return e===31?_T(t):vT(t,e,r)}function Op(t,e,r){return yT(t,e,r===!1?0:4)}function FP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return yT(t,e,0)}function DP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Vr,""),t.l-s&2&&(t.l+=2)}return r}function OP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Vr,"");return r}function bP(t){var e=t.l,r=uh(t,pT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=uh(t,$r);return[r,n]}function LP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(bP(t));return r}function e_(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Vr,"").replace(Fc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function ET(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function MP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function uh(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==Qv&&n!==e&&mP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Qv?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return vT(t,n,4).replace(Vr,"");case 31:return _T(t);case 64:return Sg(t);case 65:return ET(t);case 71:return MP(t);case 80:return Op(t,n,!i.raw).replace(Vr,"");case 81:return FP(t,n).replace(Vr,"");case 4108:return LP(t);case 4126:case 4127:return n==4127?DP(t):OP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function t_(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,c=-1,l={};for(a=0;a!=s;++a){var f=t.read_shift(4),h=t.read_shift(4);i[a]=[f,h+r]}i.sort(function(w,v){return w[1]-v[1]});var d={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var m=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(m=!1,t.l=i[a][1]),m)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[i[a][0]];if(d[g.n]=uh(t,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Mn(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(i[a][0]===1){if(o=d.CodePage=uh(t,Ag),Mn(o),c!==-1){var x=t.l;t.l=i[c][1],l=e_(t,o),t.l=x}}else if(i[a][0]===0){if(o===0){c=a,t.l=i[a+1][1];continue}l=e_(t,o)}else{var E=l[i[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=ET(t);break;case 30:t.l+=4,T=Op(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Op(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Ft(t,4);break;case 64:t.l+=4,T=rr(Sg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[E]=T}}return t.l=r+n,d}function r_(t,e,r){var n=t.content;if(!n)return{};cr(n,0);var s,i,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==Je.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=t_(n,e),d={SystemIdentifier:l};for(var m in h)d[m]=h[m];if(d.FMTID=i,s===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=t_(n,null)}catch{}for(m in g)d[m]=g[m];return d.FMTID=[i,a],d}function Zs(t,e){return t.read_shift(e),null}function VP(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Ft(t,e){return t.read_shift(e)===1}function Bt(t){return t.read_shift(2,"u")}function wT(t,e){return VP(t,e,Bt)}function UP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Zl(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function BP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,c={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var l=i==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,l);return s&&(t.l+=4*a),n&&(t.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ta(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function eu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ta(t,n,r)}function Ma(t,e,r){if(r.biff>5)return eu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function jP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function zP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Vr,"");return n&&(t.l+=24),s}function HP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Vr,"");return r+a}function $P(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zP(t);case"0303000000000000c000000000000046":return HP(t);default:throw new Error("Unsupported Moniker "+r)}}function Ju(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Vr,""):"";return r}function WP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,c,l="",f,h;s&16&&(i=Ju(t,r-t.l)),s&128&&(a=Ju(t,r-t.l)),(s&257)===257&&(o=Ju(t,r-t.l)),(s&257)===1&&(c=$P(t,r-t.l)),s&8&&(l=Ju(t,r-t.l)),s&32&&(f=t.read_shift(16)),s&64&&(h=Sg(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return f&&(m.guid=f),h&&(m.time=h),i&&(m.Tooltip=i),m}function TT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function kT(t,e){var r=TT(t);return r[3]=0,r}function xs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function GP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function KP(t,e,r){return e===0?"":Ma(t,e,r)}function qP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function AT(t){var e=t.read_shift(2),r=kg(t);return[e,r]}function XP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Zl(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function t0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function ST(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var YP=ST;function IT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function QP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function JP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function yr(t){t.l+=2,t.l+=t.read_shift(2)}var ZP={0:yr,4:yr,5:yr,6:yr,7:JP,8:yr,9:yr,10:yr,11:yr,12:yr,13:QP,14:yr,15:yr,16:yr,17:yr,18:yr,19:yr,20:yr,21:IT};function eN(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(ZP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Zu(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function tN(t,e){return e===0||t.read_shift(2),1200}function rN(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Ma(t,0,r);return t.read_shift(e+n-t.l),s}function nN(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function sN(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=Zl(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function iN(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(BP(t));return i.Count=n,i.Unique=s,i}function aN(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function oN(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function cN(t){var e=GP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function lN(t){return t.read_shift(2),t.read_shift(4)}function n_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function uN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function fN(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function hN(){}function dN(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Zl(t,0,r),n}function pN(t){var e=xs(t);return e.isst=t.read_shift(4),e}function mN(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=xs(t);r.biff==2&&t.l++;var i=eu(t,n-t.l,r);return s.val=i,s}function gN(t,e,r){var n=t.read_shift(2),s=Ma(t,0,r);return[n,s]}var xN=Ma;function s_(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c}}}function vN(t){var e=t.read_shift(2),r=t.read_shift(2),n=AT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function _N(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(AT(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function yN(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function EN(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return s.patternType=vP[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function wN(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=EN(t,e,n.fStyle,r),n}function TN(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function i_(t,e,r){var n=xs(t);(r.biff==2||e==9)&&++t.l;var s=UP(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function kN(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xs(t),s=Sr(t);return n.val=s,n}var a_=KP;function AN(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ta(t,i),o=[];n>t.l;)o.push(eu(t));return[i,s,a,o]}function o_(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=XP(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var SN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function c_(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Ta(t,a,r);s&32&&(l=SN[l.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:oO(t,f,r,o);return{chKey:i,Name:l,itab:c,rgce:h}}function CT(t,e,r){if(r.biff<8)return IN(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(qP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function IN(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Zl(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function CN(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Ta(t,n,r),a=Ta(t,s,r);return[i,a]}function RN(t,e,r){var n=ST(t);t.l++;var s=t.read_shift(1);return e-=8,[cO(t,e,r),s,n]}function l_(t,e,r){var n=YP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,iO(t,e,r)]}function PN(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function NN(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Ma(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function FN(t,e,r){return NN(t,e,r)}function DN(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(t0(t));return r}function ON(t,e,r){if(r&&r.biff<8)return LN(t,e,r);var n=IT(t),s=eN(t,e-22,n[1]);return{cmo:n,ft:s}}var bN={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function LN(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((bN[n]||Pr)(t,e,r)),{cmo:[s,n,i],ft:a}}function MN(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=jP(t,6,r);var o=t.read_shift(2);t.read_shift(2),Bt(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ta(t,t.lens[l+1]-t.lens[l]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function VN(t,e){var r=t0(t);t.l+=16;var n=WP(t,e-24);return[r,n]}function UN(t,e){t.read_shift(2);var r=t0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Vr,""),[r,n]}function BN(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Jv[r]||r,r=t.read_shift(2),e[1]=Jv[r]||r,e}function jN(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(kT(t));return r}function zN(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(kT(t));return r}function HN(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function RT(t,e,r){if(!r.cellStyles)return Pr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function $N(t,e){var r={};return e<32||(t.l+=16,r.header=Sr(t),r.footer=Sr(t),t.l+=2),r}function WN(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var GN=xs,KN=wT,qN=eu;function XN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function YN(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xs(t);++t.l;var s=Ma(t,e-7,r);return n.t="str",n.val=s,n}function QN(t){var e=xs(t);++t.l;var r=Sr(t);return e.t="n",e.val=r,e}function JN(t){var e=xs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function ZN(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function eF(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function tF(t,e,r){var n=t.l+e,s=xs(t),i=t.read_shift(2),a=Ta(t,i,r);return t.l=n,s.t="str",s.val=a,s}var rF=[2,3,48,49,131,139,140,245],u_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=mg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],f=Fi(1);switch(c.type){case"base64":f=Ln(un(o));break;case"binary":f=Ln(o);break;case"buffer":case"array":f=o;break}cr(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=f.read_shift(2)),f.l+=3,h!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=f.read_shift(2));var T=f.read_shift(2),w=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=t[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],O={},z=Math.min(f.length,h==2?521:E-10-(m?264:0)),U=g?32:11;f.l<z&&f[f.l]!=13;)switch(O={},O.name=Rl.utils.decode(w,f.slice(f.l,f.l+U)).replace(/[\u0000\r\n].*$/g,""),f.l+=U,O.type=String.fromCharCode(f.read_shift(1)),h!=2&&!g&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),h==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&v.push(O),h!=2&&(f.l+=g?13:14),O.type){case"B":(!m||O.len!=8)&&c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var _=0,k=0;for(l[0]=[],k=0;k!=v.length;++k)l[0][k]=v[k].name;for(;x-- >0;){if(f[f.l]===42){f.l+=T;continue}for(++f.l,l[++_]=[],k=0,k=0;k!=v.length;++k){var A=f.slice(f.l,f.l+v[k].len);f.l+=v[k].len,cr(A,0);var I=Rl.utils.decode(w,A);switch(v[k].type){case"C":I.trim().length&&(l[_][k]=I.replace(/\s+$/,""));break;case"D":I.length===8?l[_][k]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):l[_][k]=I;break;case"F":l[_][k]=parseFloat(I.trim());break;case"+":case"I":l[_][k]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":l[_][k]=!0;break;case"N":case"F":l[_][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[_][k]="##MEMO##"+(g?parseInt(I.trim(),10):A.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(l[_][k]=+I||0);break;case"@":l[_][k]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":l[_][k]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":l[_][k]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[_][k]=-A.read_shift(-8,"f");break;case"B":if(m&&v[k].len==8){l[_][k]=A.read_shift(8,"f");break}case"G":case"P":A.l+=v[k].len;break;case"0":if(v[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=v,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Zo(r(o,l),l);return f["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,f}function s(o,c){try{return $i(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&Mn(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Np(),h=Bp(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],x=0,E=0,T=0,w=1;for(x=0;x<d.length;++x){if(((g[x]||{}).DBF||{}).name){d[x]=g[x].DBF.name,++T;continue}if(d[x]!=null){if(++T,typeof d[x]=="number"&&(d[x]=d[x].toString(10)),typeof d[x]!="string")throw new Error("DBF Invalid column name "+d[x]+" |"+typeof d[x]+"|");if(d.indexOf(d[x])!==x){for(E=0;E<1024;++E)if(d.indexOf(d[x]+"_"+E)==-1){d[x]+="_"+E;break}}}}var v=Pt(o["!ref"]),O=[],z=[],U=[];for(x=0;x<=v.e.c-v.s.c;++x){var _="",k="",A=0,I=[];for(E=0;E<m.length;++E)m[E][x]!=null&&I.push(m[E][x]);if(I.length==0||d[x]==null){O[x]="?";continue}for(E=0;E<I.length;++E){switch(typeof I[E]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=I[E]instanceof Date?"D":"C";break;default:k="C"}A=Math.max(A,String(I[E]).length),_=_&&_!=k?"C":k}A>250&&(A=250),k=((g[x]||{}).DBF||{}).type,k=="C"&&g[x].DBF.len>A&&(A=g[x].DBF.len),_=="B"&&k=="N"&&(_="N",U[x]=g[x].DBF.dec,A=g[x].DBF.len),z[x]=_=="C"||k=="N"?A:i[_]||0,w+=z[x],O[x]=_}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*T),P.write_shift(2,w),x=0;x<4;++x)P.write_shift(4,0);for(P.write_shift(4,0|(+e[C2]||3)<<8),x=0,E=0;x<d.length;++x)if(d[x]!=null){var C=f.next(32),F=(d[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,F,"sbcs"),C.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),C.write_shift(4,E),C.write_shift(1,z[x]||i[O[x]]||0),C.write_shift(1,U[x]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),E+=z[x]||i[O[x]]||0}var me=f.next(264);for(me.write_shift(4,13),x=0;x<65;++x)me.write_shift(4,0);for(x=0;x<m.length;++x){var he=f.next(w);for(he.write_shift(1,0),E=0;E<d.length;++E)if(d[E]!=null)switch(O[E]){case"L":he.write_shift(1,m[x][E]==null?63:m[x][E]?84:70);break;case"B":he.write_shift(8,m[x][E]||0,"f");break;case"N":var Ce="0";for(typeof m[x][E]=="number"&&(Ce=m[x][E].toFixed(U[E]||0)),T=0;T<z[E]-Ce.length;++T)he.write_shift(1,32);he.write_shift(1,Ce,"sbcs");break;case"D":m[x][E]?(he.write_shift(4,("0000"+m[x][E].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(m[x][E].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+m[x][E].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(m[x][E]!=null?m[x][E]:"").slice(0,z[E]);for(he.write_shift(1,_e,"sbcs"),T=0;T<z[E]-_e.length;++T)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),nF=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ds(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var g=t[m];return typeof g=="number"?Sv(g):g},n=function(d,m,g){var x=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?d:Sv(x)};t["|"]=254;function s(d,m){switch(m.type){case"base64":return i(un(d),m);case"binary":return i(d,m);case"buffer":return i(Ye&&Buffer.isBuffer(d)?d.toString("binary"):Da(d),m);case"array":return i(wa(d),m)}throw new Error("Unrecognized type "+m.type)}function i(d,m){var g=d.split(/[\n\r]+/),x=-1,E=-1,T=0,w=0,v=[],O=[],z=null,U={},_=[],k=[],A=[],I=0,P;for(+m.codepage>=0&&Mn(+m.codepage);T!==g.length;++T){I=0;var C=g[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=C.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),me=F[0],he;if(C.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&O.push(C.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,_e=!1,ie=!1,W=!1,fe=-1,ke=-1;for(w=1;w<F.length;++w)switch(F[w].charAt(0)){case"A":break;case"X":E=parseInt(F[w].slice(1))-1,_e=!0;break;case"Y":for(x=parseInt(F[w].slice(1))-1,_e||(E=0),P=v.length;P<=x;++P)v[P]=[];break;case"K":he=F[w].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(zn(he))?isNaN(Uo(he).getDate())||(he=rr(he)):(he=zn(he),z!==null&&Qo(z)&&(he=e0(he))),Ce=!0;break;case"E":W=!0;var L=Ao(F[w].slice(1),{r:x,c:E});v[x][E]=[v[x][E],L];break;case"S":ie=!0,v[x][E]=[v[x][E],"S5S"];break;case"G":break;case"R":fe=parseInt(F[w].slice(1))-1;break;case"C":ke=parseInt(F[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(Ce&&(v[x][E]&&v[x][E].length==2?v[x][E][0]=he:v[x][E]=he,z=null),ie){if(W)throw new Error("SYLK shared formula cannot have own formula");var K=fe>-1&&v[fe][ke];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");v[x][E][1]=UT(K[1],{r:x-fe,c:E-ke})}break;case"F":var G=0;for(w=1;w<F.length;++w)switch(F[w].charAt(0)){case"X":E=parseInt(F[w].slice(1))-1,++G;break;case"Y":for(x=parseInt(F[w].slice(1))-1,P=v.length;P<=x;++P)v[P]=[];break;case"M":I=parseInt(F[w].slice(1))/20;break;case"F":break;case"G":break;case"P":z=O[parseInt(F[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=F[w].slice(1).split(" "),P=parseInt(A[0],10);P<=parseInt(A[1],10);++P)I=parseInt(A[2],10),k[P-1]=I===0?{hidden:!0}:{wch:I},Bo(k[P-1]);break;case"C":E=parseInt(F[w].slice(1))-1,k[E]||(k[E]={});break;case"R":x=parseInt(F[w].slice(1))-1,_[x]||(_[x]={}),I>0?(_[x].hpt=I,_[x].hpx=bl(I)):I===0&&(_[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}G<1&&(z=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return _.length>0&&(U["!rows"]=_),k.length>0&&(U["!cols"]=k),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,U]}function a(d,m){var g=s(d,m),x=g[0],E=g[1],T=Zo(x,m);return ds(E).forEach(function(w){T[w]=E[w]}),T}function o(d,m){return $i(a(d,m),m)}function c(d,m,g,x){var E="C;Y"+(g+1)+";X"+(x+1)+";K";switch(d.t){case"n":E+=d.v||0,d.f&&!d.F&&(E+=";E"+HD(d.f,{r:g,c:x}));break;case"b":E+=d.v?"TRUE":"FALSE";break;case"e":E+=d.w||d.v;break;case"d":E+='"'+(d.w||d.v)+'"';break;case"s":E+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function l(d,m){m.forEach(function(g,x){var E="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?E+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=hh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=dh(g.wpx)),typeof g.wch=="number"&&(E+=Math.round(g.wch))),E.charAt(E.length-1)!=" "&&d.push(E)})}function f(d,m){m.forEach(function(g,x){var E="F;";g.hidden?E+="M0;":g.hpt?E+="M"+20*g.hpt+";":g.hpx&&(E+="M"+20*LT(g.hpx)+";"),E.length>2&&d.push(E+"R"+(x+1))})}function h(d,m){var g=["ID;PWXL;N;E"],x=[],E=Pt(d["!ref"]),T,w=Array.isArray(d),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var O=E.s.r;O<=E.e.r;++O)for(var z=E.s.c;z<=E.e.c;++z){var U=Ue({r:O,c:z});T=w?(d[O]||[])[z]:d[U],!(!T||T.v==null&&(!T.f||T.F))&&x.push(c(T,d,O,z))}return g.join(v)+v+x.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),sF=function(){function t(i,a){switch(a.type){case"base64":return e(un(i),a);case"binary":return e(i,a);case"buffer":return e(Ye&&Buffer.isBuffer(i)?i.toString("binary"):Da(i),a);case"array":return e(wa(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),c=-1,l=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),m=d[0],g=d[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++c]=[],l=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[c][l]=!0:x==="FALSE"?h[c][l]=!1:isNaN(zn(g))?isNaN(Uo(g).getDate())?h[c][l]=g:h[c][l]=rr(g):h[c][l]=zn(g),++l;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[c][l++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Zo(t(i,a),a)}function n(i,a){return $i(r(i,a),a)}var s=function(){var i=function(c,l,f,h,d){c.push(l),c.push(f+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,f,h){c.push(l+","+f),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],f=Pt(c["!ref"]),h,d=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(l,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var x=Ue({r:m,c:g});if(h=d?(c[m]||[])[g]:c[x],!h){a(l,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,E,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=In(h.z||ze[14],Ur(rr(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,w=l.join(T);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),iF=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),g=-1,x=-1,E=0,T=[];E!==m.length;++E){var w=m[E].trim().split(":");if(w[0]==="cell"){var v=Lr(w[1]);if(T.length<=v.r)for(g=T.length;g<=v.r;++g)T[g]||(T[g]=[]);switch(g=v.r,x=v.c,w[2]){case"t":T[g][x]=t(w[3]);break;case"v":T[g][x]=+w[3];break;case"vtf":var O=w[w.length-1];case"vtc":switch(w[3]){case"nl":T[g][x]=!!+w[4];break;default:T[g][x]=+w[4];break}w[2]=="vtf"&&(T[g][x]=[T[g][x],O])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return Zo(r(h,d),d)}function s(h,d){return $i(n(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,x="",E=Jo(h["!ref"]),T=Array.isArray(h),w=E.s.r;w<=E.e.r;++w)for(var v=E.s.c;v<=E.e.c;++v)if(x=Ue({r:w,c:v}),g=T?(h[w]||[])[v]:h[x],!(!g||g.v==null||g.t==="z")){switch(m=["cell",x,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var O=Ur(rr(g.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=g.w||In(g.z||ze[14],O);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[i,a,o,a,l(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),Dl=function(){function t(f,h,d,m,g){g.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(zn(f))?isNaN(Uo(f).getDate())?h[d][m]=f:h[d][m]=rr(f):h[d][m]=zn(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var g=f.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var E=10,T=0,w=0;w<=x;++w)T=g[w].indexOf(" "),T==-1?T=g[w].length:T++,E=Math.max(E,T);for(w=0;w<=x;++w){m[w]=[];var v=0;for(t(g[w].slice(0,E).trim(),m,w,v,d),v=1;v<=(g[w].length-E)/10+1;++v)t(g[w].slice(E+(v-1)*10,E+v*10).trim(),m,w,v,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},d=!1,m=0,g=0;m<f.length;++m)(g=f.charCodeAt(m))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[g.pop()[1]]||44}function i(f,h){var d=h||{},m="",g=d.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):d&&d.FS?m=d.FS:m=s(f.slice(0,1024));var E=0,T=0,w=0,v=0,O=0,z=m.charCodeAt(0),U=!1,_=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=d.dateNF!=null?g3(d.dateNF):null;function I(){var P=f.slice(v,O),C={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)C.t="z";else if(d.raw)C.t="s",C.v=P;else if(P.trim().length===0)C.t="s",C.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(C.t="s",C.v=P.slice(2,-1).replace(/""/g,'"')):WD(P)?(C.t="n",C.f=P.slice(1)):(C.t="s",C.v=P);else if(P=="TRUE")C.t="b",C.v=!0;else if(P=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=zn(P)))C.t="n",d.cellText!==!1&&(C.w=P),C.v=w;else if(!isNaN(Uo(P).getDate())||A&&P.match(A)){C.z=d.dateNF||ze[14];var F=0;A&&P.match(A)&&(P=x3(P,d.dateNF,P.match(A)||[]),F=1),d.cellDates?(C.t="d",C.v=rr(P,F)):(C.t="n",C.v=Ur(rr(P,F))),d.cellText!==!1&&(C.w=In(C.z,C.v instanceof Date?Ur(C.v):C.v)),d.cellNF||delete C.z}else C.t="s",C.v=P;if(C.t=="z"||(d.dense?(g[E]||(g[E]=[]),g[E][T]=C):g[Ue({c:T,r:E})]=C),v=O+1,k=f.charCodeAt(v),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),_==z)++T;else if(T=0,++E,d.sheetRows&&d.sheetRows<=E)return!0}e:for(;O<f.length;++O)switch(_=f.charCodeAt(O)){case 34:k===34&&(U=!U);break;case z:case 10:case 13:if(!U&&I())break e;break}return O-v>0&&I(),g["!ref"]=Ze(x),g}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):Zo(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:Og(f,h);switch(h.type){case"base64":d=un(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Rl<"u"||(d=Ye&&Buffer.isBuffer(f)?f.toString("binary"):Da(f));break;case"array":d=wa(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=mt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=mt(d):h.type=="binary"&&typeof Rl<"u",d.slice(0,19)=="socialcalc:version:"?iF.to_sheet(h.type=="string"?d:mt(d),h):a(d,h)}function c(f,h){return $i(o(f,h),h)}function l(f){for(var h=[],d=Pt(f["!ref"]),m,g=Array.isArray(f),x=d.s.r;x<=d.e.r;++x){for(var E=[],T=d.s.c;T<=d.e.c;++T){var w=Ue({r:x,c:T});if(m=g?(f[x]||[])[T]:f[w],!m||m.v==null){E.push("          ");continue}for(var v=(m.w||(Bs(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";E.push(v+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function aF(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=nF.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Dl.to_workbook(t,e)}}var tl=function(){function t(L,K,G){if(L){cr(L,L.l||0);for(var H=G.Enum||fe;L.l<L.length;){var re=L.read_shift(2),de=H[re]||H[65535],Ae=L.read_shift(2),ge=L.l+Ae,ae=de.f&&de.f(L,Ae,G);if(L.l=ge,K(ae,de,re))return}}}function e(L,K){switch(K.type){case"base64":return r(Ln(un(L)),K);case"binary":return r(Ln(L),K);case"buffer":case"array":return r(L,K)}throw"Unsupported type "+K.type}function r(L,K){if(!L)return L;var G=K||{},H=G.dense?[]:{},re="Sheet1",de="",Ae=0,ge={},ae=[],He=[],j={s:{r:0,c:0},e:{r:0,c:0}},lt=G.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)G.Enum=fe,t(L,function(ye,nt,nr){switch(nr){case 0:G.vers=ye,ye>=4096&&(G.qpro=!0);break;case 6:j=ye;break;case 204:ye&&(de=ye);break;case 222:de=ye;break;case 15:case 51:G.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:nr==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=G.dateNF||ze[14],G.cellDates&&(ye[1].t="d",ye[1].v=e0(ye[1].v))),G.qpro&&ye[3]>Ae&&(H["!ref"]=Ze(j),ge[re]=H,ae.push(re),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ae=ye[3],re=de||"Sheet"+(Ae+1),de="");var $t=G.dense?(H[ye[0].r]||[])[ye[0].c]:H[Ue(ye[0])];if($t){$t.t=ye[1].t,$t.v=ye[1].v,ye[1].z!=null&&($t.z=ye[1].z),ye[1].f!=null&&($t.f=ye[1].f);break}G.dense?(H[ye[0].r]||(H[ye[0].r]=[]),H[ye[0].r][ye[0].c]=ye[1]):H[Ue(ye[0])]=ye[1];break}},G);else if(L[2]==26||L[2]==14)G.Enum=ke,L[2]==14&&(G.qpro=!0,L.l=0),t(L,function(ye,nt,nr){switch(nr){case 204:re=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>Ae&&(H["!ref"]=Ze(j),ge[re]=H,ae.push(re),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ae=ye[3],re="Sheet"+(Ae+1)),lt>0&&ye[0].r>=lt)break;G.dense?(H[ye[0].r]||(H[ye[0].r]=[]),H[ye[0].r][ye[0].c]=ye[1]):H[Ue(ye[0])]=ye[1],j.e.c<ye[0].c&&(j.e.c=ye[0].c),j.e.r<ye[0].r&&(j.e.r=ye[0].r);break;case 27:ye[14e3]&&(He[ye[14e3][0]]=ye[14e3][1]);break;case 1537:He[ye[0]]=ye[1],ye[0]==Ae&&(re=ye[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(H["!ref"]=Ze(j),ge[de||re]=H,ae.push(de||re),!He.length)return{SheetNames:ae,Sheets:ge};for(var $e={},et=[],je=0;je<He.length;++je)ge[ae[je]]?(et.push(He[je]||ae[je]),$e[He[je]]=ge[He[je]]||ge[ae[je]]):(et.push(He[je]),$e[He[je]]={"!ref":"A1"});return{SheetNames:et,Sheets:$e}}function n(L,K){var G=K||{};if(+G.codepage>=0&&Mn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Np(),re=Pt(L["!ref"]),de=Array.isArray(L),Ae=[];Fn(H,0,i(1030)),Fn(H,6,c(re));for(var ge=Math.min(re.e.r,8191),ae=re.s.r;ae<=ge;++ae)for(var He=hr(ae),j=re.s.c;j<=re.e.c;++j){ae===re.s.r&&(Ae[j]=Xt(j));var lt=Ae[j]+He,$e=de?(L[ae]||[])[j]:L[lt];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Fn(H,13,m(ae,j,$e.v)):Fn(H,14,x(ae,j,$e.v));else{var et=Bs($e);Fn(H,15,h(ae,j,et.slice(0,239)))}}return Fn(H,1),H.end()}function s(L,K){var G=K||{};if(+G.codepage>=0&&Mn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Np();Fn(H,0,a(L));for(var re=0,de=0;re<L.SheetNames.length;++re)(L.Sheets[L.SheetNames[re]]||{})["!ref"]&&Fn(H,27,W(L.SheetNames[re],de++));var Ae=0;for(re=0;re<L.SheetNames.length;++re){var ge=L.Sheets[L.SheetNames[re]];if(!(!ge||!ge["!ref"])){for(var ae=Pt(ge["!ref"]),He=Array.isArray(ge),j=[],lt=Math.min(ae.e.r,8191),$e=ae.s.r;$e<=lt;++$e)for(var et=hr($e),je=ae.s.c;je<=ae.e.c;++je){$e===ae.s.r&&(j[je]=Xt(je));var ye=j[je]+et,nt=He?(ge[$e]||[])[je]:ge[ye];if(!(!nt||nt.t=="z"))if(nt.t=="n")Fn(H,23,I($e,je,Ae,nt.v));else{var nr=Bs(nt);Fn(H,22,_($e,je,Ae,nr.slice(0,239)))}}++Ae}}return Fn(H,1),H.end()}function i(L){var K=Gt(2);return K.write_shift(2,L),K}function a(L){var K=Gt(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var G=0,H=0,re=0,de=0;de<L.SheetNames.length;++de){var Ae=L.SheetNames[de],ge=L.Sheets[Ae];if(!(!ge||!ge["!ref"])){++re;var ae=Jo(ge["!ref"]);G<ae.e.r&&(G=ae.e.r),H<ae.e.c&&(H=ae.e.c)}}return G>8191&&(G=8191),K.write_shift(2,G),K.write_shift(1,re),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(L,K,G){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&G.qpro?(H.s.c=L.read_shift(1),L.l++,H.s.r=L.read_shift(2),H.e.c=L.read_shift(1),L.l++,H.e.r=L.read_shift(2),H):(H.s.c=L.read_shift(2),H.s.r=L.read_shift(2),K==12&&G.qpro&&(L.l+=2),H.e.c=L.read_shift(2),H.e.r=L.read_shift(2),K==12&&G.qpro&&(L.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(L){var K=Gt(8);return K.write_shift(2,L.s.c),K.write_shift(2,L.s.r),K.write_shift(2,L.e.c),K.write_shift(2,L.e.r),K}function l(L,K,G){var H=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(H[0].c=L.read_shift(1),H[3]=L.read_shift(1),H[0].r=L.read_shift(2),L.l+=2):(H[2]=L.read_shift(1),H[0].c=L.read_shift(2),H[0].r=L.read_shift(2)),H}function f(L,K,G){var H=L.l+K,re=l(L,K,G);if(re[1].t="s",G.vers==20768){L.l++;var de=L.read_shift(1);return re[1].v=L.read_shift(de,"utf8"),re}return G.qpro&&L.l++,re[1].v=L.read_shift(H-L.l,"cstr"),re}function h(L,K,G){var H=Gt(7+G.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(1,39);for(var re=0;re<H.length;++re){var de=G.charCodeAt(re);H.write_shift(1,de>=128?95:de)}return H.write_shift(1,0),H}function d(L,K,G){var H=l(L,K,G);return H[1].v=L.read_shift(2,"i"),H}function m(L,K,G){var H=Gt(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(2,G,"i"),H}function g(L,K,G){var H=l(L,K,G);return H[1].v=L.read_shift(8,"f"),H}function x(L,K,G){var H=Gt(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(8,G,"f"),H}function E(L,K,G){var H=L.l+K,re=l(L,K,G);if(re[1].v=L.read_shift(8,"f"),G.qpro)L.l=H;else{var de=L.read_shift(2);O(L.slice(L.l,L.l+de),re),L.l+=de}return re}function T(L,K,G){var H=K&32768;return K&=-32769,K=(H?L:0)+(K>=8192?K-16384:K),(H?"":"$")+(G?Xt(K):hr(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(L,K){cr(L,0);for(var G=[],H=0,re="",de="",Ae="",ge="";L.l<L.length;){var ae=L[L.l++];switch(ae){case 0:G.push(L.read_shift(8,"f"));break;case 1:de=T(K[0].c,L.read_shift(2),!0),re=T(K[0].r,L.read_shift(2),!1),G.push(de+re);break;case 2:{var He=T(K[0].c,L.read_shift(2),!0),j=T(K[0].r,L.read_shift(2),!1);de=T(K[0].c,L.read_shift(2),!0),re=T(K[0].r,L.read_shift(2),!1),G.push(He+j+":"+de+re)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(L.read_shift(2));break;case 6:{for(var lt="";ae=L[L.l++];)lt+=String.fromCharCode(ae);G.push('"'+lt.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:ge=G.pop(),Ae=G.pop(),G.push(["AND","OR"][ae-20]+"("+Ae+","+ge+")");break;default:if(ae<32&&v[ae])ge=G.pop(),Ae=G.pop(),G.push(Ae+v[ae]+ge);else if(w[ae]){if(H=w[ae][1],H==69&&(H=L[L.l++]),H>G.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+G.join("|")+"|");return}var $e=G.slice(-H);G.length-=H,G.push(w[ae][0]+"("+$e.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}G.length==1?K[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function z(L){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=L.read_shift(2),K[3]=L[L.l++],K[0].c=L[L.l++],K}function U(L,K){var G=z(L);return G[1].t="s",G[1].v=L.read_shift(K-4,"cstr"),G}function _(L,K,G,H){var re=Gt(6+H.length);re.write_shift(2,L),re.write_shift(1,G),re.write_shift(1,K),re.write_shift(1,39);for(var de=0;de<H.length;++de){var Ae=H.charCodeAt(de);re.write_shift(1,Ae>=128?95:Ae)}return re.write_shift(1,0),re}function k(L,K){var G=z(L);G[1].v=L.read_shift(2);var H=G[1].v>>1;if(G[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return G[1].v=H,G}function A(L,K){var G=z(L),H=L.read_shift(4),re=L.read_shift(4),de=L.read_shift(2);if(de==65535)return H===0&&re===3221225472?(G[1].t="e",G[1].v=15):H===0&&re===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ae=de&32768;return de=(de&32767)-16446,G[1].v=(1-Ae*2)*(re*Math.pow(2,de+32)+H*Math.pow(2,de)),G}function I(L,K,G,H){var re=Gt(14);if(re.write_shift(2,L),re.write_shift(1,G),re.write_shift(1,K),H==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var de=0,Ae=0,ge=0,ae=0;return H<0&&(de=1,H=-H),Ae=Math.log2(H)|0,H/=Math.pow(2,Ae-31),ae=H>>>0,ae&2147483648||(H/=2,++Ae,ae=H>>>0),H-=ae,ae|=2147483648,ae>>>=0,H*=Math.pow(2,32),ge=H>>>0,re.write_shift(4,ge),re.write_shift(4,ae),Ae+=16383+(de?32768:0),re.write_shift(2,Ae),re}function P(L,K){var G=A(L);return L.l+=K-14,G}function C(L,K){var G=z(L),H=L.read_shift(4);return G[1].v=H>>6,G}function F(L,K){var G=z(L),H=L.read_shift(8,"f");return G[1].v=H,G}function me(L,K){var G=F(L);return L.l+=K-10,G}function he(L,K){return L[L.l+K-1]==0?L.read_shift(K,"cstr"):""}function Ce(L,K){var G=L[L.l++];G>K-1&&(G=K-1);for(var H="";H.length<G;)H+=String.fromCharCode(L[L.l++]);return H}function _e(L,K,G){if(!(!G.qpro||K<21)){var H=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var re=L.read_shift(K-21,"cstr");return[H,re]}}function ie(L,K){for(var G={},H=L.l+K;L.l<H;){var re=L.read_shift(2);if(re==14e3){for(G[re]=[0,""],G[re][0]=L.read_shift(2);L[L.l];)G[re][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return G}function W(L,K){var G=Gt(5+L.length);G.write_shift(2,14e3),G.write_shift(2,K);for(var H=0;H<L.length;++H){var re=L.charCodeAt(H);G[G.l++]=re>127?95:re}return G[G.l++]=0,G}var fe={0:{n:"BOF",f:Bt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},ke={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function oF(t){var e={},r=t.match(Fr),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Le(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=ug[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var cF=function(){var t=Nl("t"),e=Nl("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:rt(a[1])},c=i.match(e);return c&&(o.s=oF(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),lF=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),uF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,fF=/<(?:\w+:)?r>/,hF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ig(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rt(mt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=mt(t),r&&(n.h=xg(n.t))):t.match(fF)&&(n.r=mt(t),n.t=rt(mt((t.replace(hF,"").match(uF)||[]).join("").replace(Fr,""))),r&&(n.h=lF(cF(n.r)))),n):{t:""}}var dF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,pF=/<(?:\w+:)?(?:si|sstItem)>/g,mF=/<\/(?:\w+:)?(?:si|sstItem)>/;function gF(t,e){var r=[],n="";if(!t)return r;var s=t.match(dF);if(s){n=s[2].replace(pF,"").split(mF);for(var i=0;i!=n.length;++i){var a=Ig(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Le(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function xF(t){return[t.read_shift(4),t.read_shift(4)]}function vF(t,e){var r=[],n=!1;return Gs(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function PT(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ds(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function _F(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ds(t,4),e.U=Ds(t,4),e.W=Ds(t,4),e}function yF(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function EF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(yF(t));return e}function wF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function TF(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ds(t,4),e.U=Ds(t,4),e.W=Ds(t,4),e}function kF(t){var e=TF(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function NT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function FT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function AF(t){var e=Ds(t);switch(e.Minor){case 2:return[e.Minor,SF(t)];case 3:return[e.Minor,IF()];case 4:return[e.Minor,CF(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function SF(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=NT(t,r),s=FT(t,t.length-t.l);return{t:"Std",h:n,v:s}}function IF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CF(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Fr,function(i){var a=Le(i);switch(gs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function RF(t,e){var r={},n=r.EncryptionVersionInfo=Ds(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=NT(t,s),e-=s,r.EncryptionVerifier=FT(t,e),r}function PF(t){var e={},r=e.EncryptionVersionInfo=Ds(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function NF(t){var e=0,r,n=PT(t),s=n.length+1,i,a,o,c,l;for(r=Fi(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var DT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var f=a[l],h=0;h!=7;++h)f&64&&(o^=r[c]),f*=2,--c;return o};return function(a){for(var o=PT(a),c=i(o),l=o.length,f=Fi(16),h=0;h!=16;++h)f[h]=0;var d,m,g;for((l&1)===1&&(d=c>>8,f[l]=s(t[0],d),--l,d=c&255,m=o[o.length-1],f[l]=s(m,d));l>0;)--l,d=c>>8,f[l]=s(o[l],d),--l,d=c&255,f[l]=s(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,f[l]=s(t[g],d),--l,--g,d=c&255,f[l]=s(o[l],d),--l,--g;return f}}(),FF=function(t,e,r,n,s){s||(s=e),n||(n=DT(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},DF=function(t){var e=0,r=DT(t);return function(n){var s=FF("",n,e,r);return e=s[1],s[0]}};function OF(t,e,r,n){var s={key:Bt(t),verificationBytes:Bt(t)};return r.password&&(s.verifier=NF(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=DF(r.password)),s}function bF(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=PF(t):n.Data=RF(t,e),n}function LF(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?bF(t,e-2,n):OF(t,r.biff>=8?e:e-2,r,n),n}var MF=function(){function t(s,i){switch(i.type){case"base64":return e(un(s),i);case"binary":return e(s,i);case"buffer":return e(Ye&&Buffer.isBuffer(s)?s.toString("binary"):Da(s),i);case"array":return e(wa(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,x=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var E=f.slice(m,d.lastIndex-g[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[Ue({r:h,c:x})]=T}break}m=d.lastIndex}x>l.e.c&&(l.e.c=x)}),o["!ref"]=Ze(l),o}function r(s,i){return $i(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Pt(s["!ref"]),o,c=Array.isArray(s),l=a.s.r;l<=a.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Ue({r:l,c:f});o=c?(s[l]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Bs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function VF(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Ol(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function UF(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,c=0,l=s+i;switch(c=a/(l>1?2-l:l),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function BF(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,a[0]+=s,a[1]+=c;break;case 1:c=s*(2-o),a[0]+=c,a[1]+=s;break;case 2:c=s*(o-2),a[1]+=s,a[2]+=c;break;case 3:c=s*(4-o),a[1]+=c,a[2]+=s;break;case 4:c=s*(o-4),a[2]+=s,a[0]+=c;break;case 5:c=s*(6-o),a[2]+=c,a[0]+=s;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function fh(t,e){if(e===0)return t;var r=UF(VF(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Ol(BF(r))}var OT=6,jF=15,zF=1,br=OT;function hh(t){return Math.floor((t+Math.round(128/br)/256)*br)}function dh(t){return Math.floor((t-5)/br*100+.5)/100}function bp(t){return Math.round((t*br+5)/br*256)/256}function md(t){return bp(dh(hh(t)))}function Cg(t){var e=Math.abs(t-md(t)),r=br;if(e>.005)for(br=zF;br<jF;++br)Math.abs(t-md(t))<=e&&(e=Math.abs(t-md(t)),r=br);br=r}function Bo(t){t.width?(t.wpx=hh(t.width),t.wch=dh(t.wpx),t.MDW=br):t.wpx?(t.wch=dh(t.wpx),t.width=bp(t.wch),t.MDW=br):typeof t.wch=="number"&&(t.width=bp(t.wch),t.wpx=hh(t.width),t.MDW=br),t.customWidth&&delete t.customWidth}var HF=96,bT=HF;function LT(t){return t*96/bT}function bl(t){return t*bT/96}var $F={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function WF(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Fr)||[]).forEach(function(a){var o=Le(a);switch(gs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Et(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Et(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function GF(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Fr)||[]).forEach(function(a){var o=Le(a);switch(gs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function KF(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Fr)||[]).forEach(function(a){var o=Le(a);switch(gs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=mt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Et(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Et(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Et(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Et(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Et(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Et(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Et(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ug[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Et(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=pa[s.color.index];s.color.index==81&&(c=pa[1]),c||(c=pa[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=fh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function qF(t,e,r){e.NumberFmt=[];for(var n=ds(ze),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ze[n[s]];var i=t[0].match(Fr);if(i)for(s=0;s<i.length;++s){var a=Le(i[s]);switch(gs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=rt(mt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}da(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var ef=["numFmtId","fillId","fontId","borderId","xfId"],tf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XF(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Fr)||[]).forEach(function(i){var a=Le(i),o=0;switch(gs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<ef.length;++o)n[ef[o]]&&(n[ef[o]]=parseInt(n[ef[o]],10));for(o=0;o<tf.length;++o)n[tf[o]]&&(n[tf[o]]=Et(n[tf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Et(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var YF=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&qF(h,f,l),(h=o.match(s))&&KF(h,f,c,l),(h=o.match(n))&&GF(h,f,c,l),(h=o.match(i))&&WF(h,f,c,l),(h=o.match(r))&&XF(h,f,l),f}}();function QF(t,e){var r=t.read_shift(2),n=Cr(t);return[r,n]}function JF(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=cP(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=oP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Cr(t),n}var ZF=Pr;function eD(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var tD=Pr;function rD(t,e,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return Gs(t,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],da(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=fh(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(f),a=!0;break;case 38:i.pop(),a=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var nD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sD(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Fr)||[]).forEach(function(s){var i=Le(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[nD.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function iD(){}function aD(){}var oD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uD(t,e,r){e.themeElements={};var n;[["clrScheme",oD,sD],["fontScheme",cD,iD],["fmtScheme",lD,aD]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var fD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function MT(t,e){(!t||t.length===0)&&(t=hD());var r,n={};if(!(r=t.match(fD)))throw new Error("themeElements not found in theme");return uD(r[0],n,e),n.raw=t,n}function hD(t,e){var r=[q2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function dD(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=K2(i,{type:"array"})}catch{return}var o=nn(a,"theme/theme/theme1.xml",!0);if(o)return MT(o,r)}}function pD(t){return t.read_shift(4)}function mD(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=gD(t,4);break;case 2:e.xclrValue=TT(t);break;case 3:e.xclrValue=pD(t);break;case 4:t.l+=4;break}return t.l+=8,e}function gD(t,e){return Pr(t,e)}function xD(t,e){return Pr(t,e)}function vD(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=mD(t);break;case 6:n[1]=xD(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function _D(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(vD(t,r-t.l));return{ixfe:n,ext:i}}function yD(t,e){e.forEach(function(r){switch(r[0]){}})}function ED(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Cr(t)}}function wD(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function TD(t){return t.l+=4,t.read_shift(4)!=0}function kD(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return Gs(t,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!l.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function AD(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Fr,function(o){var c=Le(o);switch(gs(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function SD(t){var e=[];if(!t)return e;var r=1;return(t.match(Fr)||[]).forEach(function(n){var s=Le(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function ID(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ue(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function CD(t,e,r){var n=[];return Gs(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function RD(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Gs(t,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},s)}function PD(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function f_(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Lr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var c=Pt(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ze(c);l!==t["!ref"]&&(t["!ref"]=l)}i.c||(i.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}i.c.push(f)})}function ND(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Le(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Lr(c.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Ig(h[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function FD(t,e){var r=[],n=!1,s={},i=0;return t.replace(Fr,function(o,c){var l=Le(o);switch(gs(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":s.t=t.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function DD(t,e){var r=[],n=!1;return t.replace(Fr,function(i){var a=Le(i);switch(gs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function OD(t){var e={};e.iauthor=t.read_shift(4);var r=ba(t);return e.rfx=r.s,e.ref=Ue(r.s),t.l+=16,e}var bD=Cr;function LD(t,e){var r=[],n=[],s={},i=!1;return Gs(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var MD="application/vnd.ms-office.vbaProject";function VD(t){var e=Je.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Je.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Je.write(e)}function UD(){return{"!type":"dialog"}}function BD(){return{"!type":"dialog"}}function jD(){return{"!type":"macro"}}function zD(){return{"!type":"macro"}}var Ao=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,c?l+=e.r:--l,s+(o?"":"$")+Xt(f)+(c?"":"$")+hr(l)}return function(s,i){return e=i,s.replace(t,r)}}(),VT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,HD=function(){return function(e,r){return e.replace(VT,function(n,s,i,a,o,c){var l=Eg(a)-(i?0:r.c),f=yg(c)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return s+"R"+h+"C"+d})}}();function UT(t,e){return t.replace(VT,function(r,n,s,i,a,o){return n+(s=="$"?s+i:Xt(Eg(i)+e.c))+(a=="$"?a+o:hr(yg(o)+e.r))})}function $D(t,e,r){var n=Jo(e),s=n.s,i=Lr(r),a={r:i.r-s.r,c:i.c-s.c};return UT(t,a)}function WD(t){return t.length!=1}function h_(t){return t.replace(/_xlfn\./g,"")}function Mt(t){t.l+=1}function Di(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function BT(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jT(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Di(t),o=Di(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jT(t){var e=Di(t),r=Di(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function GD(t,e,r){if(r.biff<8)return jT(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Di(t),a=Di(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function zT(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return KD(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Di(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function KD(t){var e=Di(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function qD(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function XD(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return YD(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function YD(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function QD(t,e,r){var n=(t[t.l++]&96)>>5,s=BT(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function JD(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=BT(t,i,r);return[n,s,a]}function ZD(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function e6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function t6(t,e,r){var n=(t[t.l++]&96)>>5,s=GD(t,e-1,r);return[n,s]}function r6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function d_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function n6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function s6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function i6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function o6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function HT(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function c6(t){return t.read_shift(2),HT(t)}function l6(t){return t.read_shift(2),HT(t)}function u6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=zT(t,0,r);return[n,s]}function f6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=XD(t,0,r);return[n,s]}function h6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=zT(t,0,r);return[n,s,i]}function d6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[pO[s],GT[s],n]}function p6(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:m6(t);return[s,(i[0]===0?GT:dO)[i[1]]]}function m6(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function g6(t,e,r){t.l+=r&&r.biff==2?3:4}function x6(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function v6(t){return t.l++,La[t.read_shift(1)]}function _6(t){return t.l++,t.read_shift(2)}function y6(t){return t.l++,t.read_shift(1)!==0}function E6(t){return t.l++,Sr(t)}function w6(t,e,r){return t.l++,Zl(t,e-1,r)}function T6(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ft(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=La[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Sr(t);break;case 2:r[1]=Ma(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function k6(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?ba:t0)(t));return s}function A6(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=T6(t,r.biff);return a}function S6(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function I6(t,e,r){if(r.biff==5)return C6(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function C6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function R6(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function P6(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function N6(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function F6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var D6=Pr,O6=Pr,b6=Pr;function tu(t,e,r){return t.l+=2,[qD(t)]}function Rg(t){return t.l+=6,[]}var L6=tu,M6=Rg,V6=Rg,U6=tu;function $T(t){return t.l+=2,[Bt(t),t.read_shift(2)&1]}var B6=tu,j6=$T,z6=Rg,H6=tu,$6=tu,W6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G6(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=W6[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function K6(t){return t.l+=2,[t.read_shift(4)]}function q6(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function X6(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Y6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Q6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function J6(t){return t.l+=4,[0,0]}var p_={1:{n:"PtgExp",f:x6},2:{n:"PtgTbl",f:b6},3:{n:"PtgAdd",f:Mt},4:{n:"PtgSub",f:Mt},5:{n:"PtgMul",f:Mt},6:{n:"PtgDiv",f:Mt},7:{n:"PtgPower",f:Mt},8:{n:"PtgConcat",f:Mt},9:{n:"PtgLt",f:Mt},10:{n:"PtgLe",f:Mt},11:{n:"PtgEq",f:Mt},12:{n:"PtgGe",f:Mt},13:{n:"PtgGt",f:Mt},14:{n:"PtgNe",f:Mt},15:{n:"PtgIsect",f:Mt},16:{n:"PtgUnion",f:Mt},17:{n:"PtgRange",f:Mt},18:{n:"PtgUplus",f:Mt},19:{n:"PtgUminus",f:Mt},20:{n:"PtgPercent",f:Mt},21:{n:"PtgParen",f:Mt},22:{n:"PtgMissArg",f:Mt},23:{n:"PtgStr",f:w6},26:{n:"PtgSheet",f:q6},27:{n:"PtgEndSheet",f:X6},28:{n:"PtgErr",f:v6},29:{n:"PtgBool",f:y6},30:{n:"PtgInt",f:_6},31:{n:"PtgNum",f:E6},32:{n:"PtgArray",f:r6},33:{n:"PtgFunc",f:d6},34:{n:"PtgFuncVar",f:p6},35:{n:"PtgName",f:S6},36:{n:"PtgRef",f:u6},37:{n:"PtgArea",f:QD},38:{n:"PtgMemArea",f:R6},39:{n:"PtgMemErr",f:D6},40:{n:"PtgMemNoMem",f:O6},41:{n:"PtgMemFunc",f:P6},42:{n:"PtgRefErr",f:N6},43:{n:"PtgAreaErr",f:ZD},44:{n:"PtgRefN",f:f6},45:{n:"PtgAreaN",f:t6},46:{n:"PtgMemAreaN",f:Y6},47:{n:"PtgMemNoMemN",f:Q6},57:{n:"PtgNameX",f:I6},58:{n:"PtgRef3d",f:h6},59:{n:"PtgArea3d",f:JD},60:{n:"PtgRefErr3d",f:F6},61:{n:"PtgAreaErr3d",f:e6},255:{}},Z6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eO={1:{n:"PtgElfLel",f:$T},2:{n:"PtgElfRw",f:H6},3:{n:"PtgElfCol",f:L6},6:{n:"PtgElfRwV",f:$6},7:{n:"PtgElfColV",f:U6},10:{n:"PtgElfRadical",f:B6},11:{n:"PtgElfRadicalS",f:z6},13:{n:"PtgElfColS",f:M6},15:{n:"PtgElfColSV",f:V6},16:{n:"PtgElfRadicalLel",f:j6},25:{n:"PtgList",f:G6},29:{n:"PtgSxName",f:K6},255:{}},tO={0:{n:"PtgAttrNoop",f:J6},1:{n:"PtgAttrSemi",f:o6},2:{n:"PtgAttrIf",f:i6},4:{n:"PtgAttrChoose",f:n6},8:{n:"PtgAttrGoto",f:s6},16:{n:"PtgAttrSum",f:g6},32:{n:"PtgAttrBaxcel",f:d_},33:{n:"PtgAttrBaxcel",f:d_},64:{n:"PtgAttrSpace",f:c6},65:{n:"PtgAttrSpaceSemi",f:l6},128:{n:"PtgAttrIfError",f:a6},255:{}};function ru(t,e,r,n){if(n.biff<8)return Pr(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=A6(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=k6(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Pr(t,e)),i}function nu(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=p_[i]||p_[Z6[i]],(i===24||i===25)&&(s=(i===24?eO:tO)[t[t.l+1]]),!s||!s.f?Pr(t,e):a.push([s.n,s.f(t,e,r)]);return a}function rO(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var nO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sO(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function WT(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function m_(t,e,r){var n=WT(t,e,r);return n=="#REF"?n:sO(n,r)}function Tr(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],c,l,f,h=0,d=0,m,g="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,w=t[0].length;T<w;++T){var v=t[0][T];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Rt(" ",t[0][x][1][1]);break;case 1:E=Rt("\r",t[0][x][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}l=l+E,x=-1}o.push(l+nO[v[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Qc(v[1][1],a,s),o.push(Jc(f,i));break;case"PtgRefN":f=r?Qc(v[1][1],r,s):v[1][1],o.push(Jc(f,i));break;case"PtgRef3d":h=v[1][1],f=Qc(v[1][2],a,s),g=m_(n,h,s),o.push(g+"!"+Jc(f,i));break;case"PtgFunc":case"PtgFuncVar":var O=v[1][0],z=v[1][1];O||(O=0),O&=127;var U=O==0?[]:o.slice(-O);o.length-=O,z==="User"&&(z=U.shift()),o.push(z+"("+U.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":m=Xv(v[1][1],r?{s:r}:a,s),o.push(dd(m,s));break;case"PtgArea":m=Xv(v[1][1],a,s),o.push(dd(m,s));break;case"PtgArea3d":h=v[1][1],m=v[1][2],g=m_(n,h,s),o.push(g+"!"+dd(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var _=(n.names||[])[d-1]||(n[0]||[])[d],k=_?_.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!s.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var A=v[1][1];d=v[1][2];var I;if(s.biff<=5)A<0&&(A=-A),n[A]&&(I=n[A][d]);else{var P="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][d]&&n[A][d].itab>0&&(P=n.SheetNames[n[A][d].itab-1]+"!"):P=n.SheetNames[d-1]+"!"),n[A]&&n[A][d])P+=n[A][d].Name;else if(n[0]&&n[0][d])P+=n[0][d].Name;else{var C=(WT(n,A,s)||"").split(";;");C[d-1]?P=C[d-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var F="(",me=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:F=Rt(" ",t[0][x][1][1])+F;break;case 3:F=Rt("\r",t[0][x][1][1])+F;break;case 4:me=Rt(" ",t[0][x][1][1])+me;break;case 5:me=Rt("\r",t[0][x][1][1])+me;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(F+o.pop()+me);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Ue(f)]){var Ce=n.sharedf[Ue(f)];o.push(Tr(Ce,a,he,n,s))}else{var _e=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Tr(l[1],a,he,n,s)),_e=!0;break}_e||o.push(v[1])}break;case"PtgArray":o.push("{"+rO(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&ie.indexOf(t[0][T][0])==-1){v=t[0][x];var W=!0;switch(v[1][0]){case 4:W=!1;case 0:E=Rt(" ",v[1][1]);break;case 5:W=!1;case 1:E=Rt("\r",v[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((W?E:"")+o.pop()+(W?"":E)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function iO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Pr(t,e-2)];var o=nu(t,a,r);return e!==a+s&&(i=ru(t,e-a-s,o,r)),t.l=n,[o,i]}function aO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Pr(t,e-2)];var o=nu(t,a,r);return e!==a+s&&(i=ru(t,e-a-s,o,r)),t.l=n,[o,i]}function oO(t,e,r,n){var s=t.l+e,i=nu(t,n,r),a;return s!==t.l&&(a=ru(t,s-t.l,i,r)),[i,a]}function cO(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=nu(t,i,r);return i==65535?[[],Pr(t,e-2)]:(e!==i+2&&(s=ru(t,n-i-2,a,r)),[a,s])}function lO(t){var e;if(Cs(t,t.l+6)!==65535)return[Sr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function gd(t,e,r){var n=t.l+e,s=xs(t);r.biff==2&&++t.l;var i=lO(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=aO(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function r0(t,e,r){var n=t.read_shift(4),s=nu(t,n,r),i=t.read_shift(4),a=i>0?ru(t,i,s,r):null;return[s,a]}var uO=r0,n0=r0,fO=r0,hO=r0,dO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},GT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function g_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function xd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var rl={},So={};function nl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function KT(t,e,r,n,s,i){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=rr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&da(m3[e]||"General",e),t.t==="e")t.w=t.w||La[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pl(t.v);else if(t.t==="d"){var a=Ur(t.v);(a|0)===a?t.w=a.toString(10):t.w=Pl(a)}else{if(t.v===void 0)return"";t.w=Ea(t.v,So)}else t.t==="d"?t.w=In(e,Ur(t.v),So):t.w=In(e,t.v,So)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=fh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=fh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function mO(t,e){var r=Pt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Ze(r))}var gO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,xO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vO=/<(?:\w:)?hyperlink [^>]*>/mg,_O=/"(\w*:\w*)"/,yO=/<(?:\w:)?col\b[^>]*[\/]?>/g,EO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wO=/<(?:\w:)?pageMargins[^>]*\/>/g,qT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function AO(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",h=t.match(xO);h?(l=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):l=f=t;var d=l.match(qT);d?Pg(d[0],o,s,r):(d=l.match(TO))&&SO(d[0],d[1]||"",o,s,r);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=l.slice(m,m+50).match(_O);g&&mO(o,g[1])}var x=l.match(kO);x&&x[1]&&FO(x[1],s);var E=[];if(e.cellStyles){var T=l.match(yO);T&&RO(E,T)}h&&DO(h[1],o,e,c,i,a);var w=f.match(EO);w&&(o["!autofilter"]=PO(w[0]));var v=[],O=f.match(gO);if(O)for(m=0;m!=O.length;++m)v[m]=Pt(O[m].slice(O[m].indexOf('"')+1));var z=f.match(vO);z&&IO(o,z,n);var U=f.match(wO);if(U&&(o["!margins"]=CO(Le(U[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ze(c)),e.sheetRows>0&&o["!ref"]){var _=Pt(o["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ze(_))}return E.length>0&&(o["!cols"]=E),v.length>0&&(o["!merges"]=v),o}function Pg(t,e,r,n){var s=Le(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=rt(mt(s.codeName)))}function SO(t,e,r,n,s){Pg(t.slice(0,t.indexOf(">")),r,n,s)}function IO(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Le(mt(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+rt(i.location))):(i.Target="#"+rt(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Pt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=Ue({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=i):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=i)}}}function CO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function RO(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Le(e[n],!0);s.hidden&&(s.hidden=Et(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Cg(s.width)),Bo(s);i<=a;)t[i++]=fr(s)}}function PO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var NO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FO(t,e){e.Views||(e.Views=[{}]),(t.match(NO)||[]).forEach(function(r,n){var s=Le(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Et(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var DO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Nl("v"),a=Nl("f");return function(c,l,f,h,d,m){for(var g=0,x="",E=[],T=[],w=0,v=0,O=0,z="",U,_,k=0,A=0,I,P,C=0,F=0,me=Array.isArray(m.CellXf),he,Ce=[],_e=[],ie=Array.isArray(l),W=[],fe={},ke=!1,L=!!f.sheetStubs,K=c.split(e),G=0,H=K.length;G!=H;++G){x=K[G].trim();var re=x.length;if(re!==0){var de=0;e:for(g=0;g<re;++g)switch(x[g]){case">":if(x[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(_=Le(x.slice(de,g),!0),k=_.r!=null?parseInt(_.r,10):k+1,A=-1,f.sheetRows&&f.sheetRows<k)continue;fe={},ke=!1,_.ht&&(ke=!0,fe.hpt=parseFloat(_.ht),fe.hpx=bl(fe.hpt)),_.hidden=="1"&&(ke=!0,fe.hidden=!0),_.outlineLevel!=null&&(ke=!0,fe.level=+_.outlineLevel),ke&&(W[k-1]=fe)}break;case"<":de=g;break}if(de>=g)break;if(_=Le(x.slice(de,g),!0),k=_.r!=null?parseInt(_.r,10):k+1,A=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(fe={},ke=!1,_.ht&&(ke=!0,fe.hpt=parseFloat(_.ht),fe.hpx=bl(fe.hpt)),_.hidden=="1"&&(ke=!0,fe.hidden=!0),_.outlineLevel!=null&&(ke=!0,fe.level=+_.outlineLevel),ke&&(W[k-1]=fe)),E=x.slice(g).split(t);for(var Ae=0;Ae!=E.length&&E[Ae].trim().charAt(0)=="<";++Ae);for(E=E.slice(Ae),g=0;g!=E.length;++g)if(x=E[g].trim(),x.length!==0){if(T=x.match(r),w=g,v=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(w=0,z=T[1],v=0;v!=z.length&&!((O=z.charCodeAt(v)-64)<1||O>26);++v)w=26*w+O;--w,A=w}else++A;for(v=0;v!=x.length&&x.charCodeAt(v)!==62;++v);if(++v,_=Le(x.slice(0,v),!0),_.r||(_.r=Ue({r:k-1,c:A})),z=x.slice(v),U={t:""},(T=z.match(i))!=null&&T[1]!==""&&(U.v=rt(T[1])),f.cellFormula){if((T=z.match(a))!=null&&T[1]!==""){if(U.f=rt(mt(T[1])).replace(/\r\n/g,`
`),f.xlfn||(U.f=h_(U.f)),T[0].indexOf('t="array"')>-1)U.F=(z.match(s)||[])[1],U.F.indexOf(":")>-1&&Ce.push([Pt(U.F),U.F]);else if(T[0].indexOf('t="shared"')>-1){P=Le(T[0]);var ge=rt(mt(T[1]));f.xlfn||(ge=h_(ge)),_e[parseInt(P.si,10)]=[P,ge,_.r]}}else(T=z.match(/<f[^>]*\/>/))&&(P=Le(T[0]),_e[P.si]&&(U.f=$D(_e[P.si][1],_e[P.si][2],_.r)));var ae=Lr(_.r);for(v=0;v<Ce.length;++v)ae.r>=Ce[v][0].s.r&&ae.r<=Ce[v][0].e.r&&ae.c>=Ce[v][0].s.c&&ae.c<=Ce[v][0].e.c&&(U.F=Ce[v][1])}if(_.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(L)U.t="z";else continue;else U.t=_.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),U.t){case"n":if(U.v==""||U.v==null){if(!L)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!L)continue;U.t="z"}else I=rl[parseInt(U.v,10)],U.v=I.t,U.r=I.r,f.cellHTML&&(U.h=I.h);break;case"str":U.t="s",U.v=U.v!=null?mt(U.v):"",f.cellHTML&&(U.h=xg(U.v));break;case"inlineStr":T=z.match(n),U.t="s",T!=null&&(I=Ig(T[1]))?(U.v=I.t,f.cellHTML&&(U.h=I.h)):U.v="";break;case"b":U.v=Et(U.v);break;case"d":f.cellDates?U.v=rr(U.v,1):(U.v=Ur(rr(U.v,1)),U.t="n");break;case"e":(!f||f.cellText!==!1)&&(U.w=U.v),U.v=mT[U.v];break}if(C=F=0,he=null,me&&_.s!==void 0&&(he=m.CellXf[_.s],he!=null&&(he.numFmtId!=null&&(C=he.numFmtId),f.cellStyles&&he.fillId!=null&&(F=he.fillId))),KT(U,C,F,f,d,m),f.cellDates&&me&&U.t=="n"&&Qo(ze[C])&&(U.t="d",U.v=e0(U.v)),_.cm&&f.xlmeta){var He=(f.xlmeta.Cell||[])[+_.cm-1];He&&He.type=="XLDAPR"&&(U.D=!0)}if(ie){var j=Lr(_.r);l[j.r]||(l[j.r]=[]),l[j.r][j.c]=U}else l[_.r]=U}}}}W.length>0&&(l["!rows"]=W)}}();function OO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var bO=ba;function LO(){}function MO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=iP(t),r}function VO(t){var e=Cn(t);return[e]}function UO(t){var e=Oa(t);return[e]}function BO(t){var e=Cn(t),r=t.read_shift(1);return[e,r,"b"]}function jO(t){var e=Oa(t),r=t.read_shift(1);return[e,r,"b"]}function zO(t){var e=Cn(t),r=t.read_shift(1);return[e,r,"e"]}function HO(t){var e=Oa(t),r=t.read_shift(1);return[e,r,"e"]}function $O(t){var e=Cn(t),r=t.read_shift(4);return[e,r,"s"]}function WO(t){var e=Oa(t),r=t.read_shift(4);return[e,r,"s"]}function GO(t){var e=Cn(t),r=Sr(t);return[e,r,"n"]}function XT(t){var e=Oa(t),r=Sr(t);return[e,r,"n"]}function KO(t){var e=Cn(t),r=kg(t);return[e,r,"n"]}function qO(t){var e=Oa(t),r=kg(t);return[e,r,"n"]}function XO(t){var e=Cn(t),r=wg(t);return[e,r,"is"]}function YO(t){var e=Cn(t),r=Cr(t);return[e,r,"str"]}function QO(t){var e=Oa(t),r=Cr(t);return[e,r,"str"]}function JO(t,e,r){var n=t.l+e,s=Cn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=n0(t,n-t.l,r);a[3]=Tr(o,null,s,r.supbooks,r)}else t.l=n;return a}function ZO(t,e,r){var n=t.l+e,s=Cn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=n0(t,n-t.l,r);a[3]=Tr(o,null,s,r.supbooks,r)}else t.l=n;return a}function eb(t,e,r){var n=t.l+e,s=Cn(t);s.r=r["!row"];var i=Sr(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=n0(t,n-t.l,r);a[3]=Tr(o,null,s,r.supbooks,r)}else t.l=n;return a}function tb(t,e,r){var n=t.l+e,s=Cn(t);s.r=r["!row"];var i=Cr(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=n0(t,n-t.l,r);a[3]=Tr(o,null,s,r.supbooks,r)}else t.l=n;return a}var rb=ba;function nb(t,e){var r=t.l+e,n=ba(t),s=Tg(t),i=Cr(t),a=Cr(t),o=Cr(t);t.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function sb(){}function ib(t,e,r){var n=t.l+e,s=hT(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=uO(t,n-t.l,r);a[1]=o}else t.l=n;return a}function ab(t,e,r){var n=t.l+e,s=ba(t),i=[s];if(r.cellFormula){var a=hO(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var ob=["left","right","top","bottom","header","footer"];function cb(t){var e={};return ob.forEach(function(r){e[r]=Sr(t)}),e}function lb(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function ub(){}function fb(){}function hb(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,g,x,E,T,w,v,O,z,U=[];o.biff=12,o["!row"]=0;var _=0,k=!1,A=[],I={},P=o.supbooks||s.supbooks||[[]];if(P.sharedf=I,P.arrayf=A,P.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=P,s.Names))for(var C=0;C<s.Names.length;++C)P[0][C+1]=s.Names[C];var F=[],me=[],he=!1;ph[16]={n:"BrtShortReal",f:XT};var Ce;if(Gs(t,function(W,fe,ke){if(!d)switch(ke){case 148:l=W;break;case 0:m=W,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),O=hr(E=m.r),o["!row"]=m.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=bl(W.hpt)),me[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:W[2]},W[2]){case"n":g.v=W[1];break;case"s":v=rl[W[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!W[1];break;case"e":g.v=W[1],o.cellText!==!1&&(g.w=La[g.v]);break;case"str":g.t="s",g.v=W[1];break;case"is":g.t="s",g.v=W[1].t;break}if((x=a.CellXf[W[0].iStyleRef])&&KT(g,x.numFmtId,null,o,i,a),T=W[0].c==-1?T+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][T]=g):c[Xt(T)+O]=g,o.cellFormula){for(k=!1,_=0;_<A.length;++_){var L=A[_];m.r>=L[0].s.r&&m.r<=L[0].e.r&&T>=L[0].s.c&&T<=L[0].e.c&&(g.F=Ze(L[0]),k=!0)}!k&&W.length>3&&(g.f=W[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),o.cellDates&&x&&g.t=="n"&&Qo(ze[x.numFmtId])){var K=ca(g.v);K&&(g.t="d",g.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}Ce&&(Ce.type=="XLDAPR"&&(g.D=!0),Ce=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},T=W[0].c==-1?T+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][T]=g):c[Xt(T)+O]=g,f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),Ce&&(Ce.type=="XLDAPR"&&(g.D=!0),Ce=void 0);break;case 176:U.push(W);break;case 49:Ce=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var G=n["!id"][W.relId];for(G?(W.Target=G.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=G):W.relId==""&&(W.Target="#"+W.loc),E=W.rfx.s.r;E<=W.rfx.e.r;++E)for(T=W.rfx.s.c;T<=W.rfx.e.c;++T)o.dense?(c[E]||(c[E]=[]),c[E][T]||(c[E][T]={t:"z",v:void 0}),c[E][T].l=W):(w=Ue({c:T,r:E}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=W);break;case 426:if(!o.cellFormula)break;A.push(W),z=o.dense?c[E][T]:c[Xt(T)+O],z.f=Tr(W[1],f,{r:m.r,c:T},P,o),z.F=Ze(W[0]);break;case 427:if(!o.cellFormula)break;I[Ue(W[0].s)]=W[1],z=o.dense?c[E][T]:c[Xt(T)+O],z.f=Tr(W[1],f,{r:m.r,c:T},P,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)F[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},he||(he=!0,Cg(W.w/256)),Bo(F[W.e+1]);break;case 161:c["!autofilter"]={ref:Ze(W)};break;case 476:c["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!fe.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ke.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ze(l||f)),o.sheetRows&&c["!ref"]){var _e=Pt(c["!ref"]);o.sheetRows<=+_e.e.r&&(_e.e.r=o.sheetRows-1,_e.e.r>f.e.r&&(_e.e.r=f.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>f.e.c&&(_e.e.c=f.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ze(_e))}return U.length>0&&(c["!merges"]=U),F.length>0&&(c["!cols"]=F),me.length>0&&(c["!rows"]=me),c}function db(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=rt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function pb(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=db(h);f.s.r=f.s.c=0,f.e.c=o,l=Xt(o),d[0].forEach(function(m,g){a[l+hr(g)]={t:"n",v:m,z:d[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(a["!ref"]=Ze(f)),a}function mb(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(qT);return o&&Pg(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function gb(t,e){t.l+=10;var r=Cr(t);return{name:r}}function xb(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Gs(t,function(c,l,f){switch(f){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var YT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vb=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_b=[],yb=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function x_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Et(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function v_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Et(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function QT(t){v_(t.WBProps,YT),v_(t.CalcPr,yb),x_(t.WBView,vb),x_(t.Sheets,_b),So.date1904=Et(t.WBProps.date1904)}var Eb="][*?/\\".split("");function wb(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Eb.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Tb=/<\w+:workbook/;function kb(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Fr,function(c,l){var f=Le(c);switch(gs(f[0])){case"<?xml":break;case"<workbook":c.match(Tb)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":YT.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Et(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=mt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=rt(mt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=mt(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),Et(f.hidden||"0")&&(i.Hidden=!0),a=l+c.length;break;case"</definedName>":i.Ref=rt(mt(t.slice(a,l))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),z3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return QT(r),r}function Ab(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Fp(t),r.name=Cr(t),r}function Sb(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Cr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Ib(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Cb(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=aP(t),a=fO(t,0,r),o=Tg(t);t.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function Rb(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],ph[16]={n:"BrtFRTArchID$",f:Ib},Gs(t,function(c,l,f){switch(f){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Tr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,c]):a[0]=[f,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!l.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),QT(r),r.Names=i,r.supbooks=a,r}function Pb(t,e,r){return e.slice(-4)===".bin"?Rb(t,r):kb(t,r)}function Nb(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?hb(t,n,r,s,i,a,o):AO(t,n,r,s,i,a,o)}function Fb(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?xb(t,n,r,s,i):mb(t,n,r,s,i)}function Db(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?jD():zD()}function Ob(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?UD():BD()}function bb(t,e,r,n){return e.slice(-4)===".bin"?rD(t,r,n):YF(t,r,n)}function Lb(t,e,r){return MT(t,r)}function Mb(t,e,r){return e.slice(-4)===".bin"?vF(t,r):gF(t,r)}function Vb(t,e,r){return e.slice(-4)===".bin"?LD(t,r):ND(t,r)}function Ub(t,e,r){return e.slice(-4)===".bin"?CD(t):SD(t)}function Bb(t,e,r,n){return r.slice(-4)===".bin"?RD(t,e,r,n):void 0}function jb(t,e,r){return e.slice(-4)===".bin"?kD(t,e,r):AD(t,e,r)}var JT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(JT),i,a,o,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(ZT),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function zb(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(JT),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(ZT),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var sl;function Hb(t,e){var r=sl[t]||rt(t);return r==="General"?Ea(e):In(r,e)}function $b(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Et(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[rt(e)]=s}function Wb(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||La[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pl(t.v):t.w=Ea(t.v):t.w=Hb(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=sl[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Qo(n)){var s=ca(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function Gb(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=$F[n.Pattern]||n.Pattern)}t[e.ID]=e}function Kb(t,e,r,n,s,i,a,o,c,l){var f="General",h=n.StyleID,d={};l=l||{};var m=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&m.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Et(t);break;case"String":n.t="s",n.r=Bv(rt(t)),n.v=t.indexOf("<")>-1?rt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(rr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=rt(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=mT[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Bv(e||t));break}if(Wb(n,f,l),l.cellFormula!==!1)if(n.Formula){var x=rt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Ao(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ao("RC:RC",s):n.ArrayRange&&(n.F=Ao(n.ArrayRange,s),c.push([Pt(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(m.forEach(function(E){!d.patternType&&E.patternType&&(d.patternType=E.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qb(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vd(t,e){var r=e||{};j2();var n=Nc(vg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=mt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=fr(r);return a.type="string",Dl.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){s.indexOf("<"+nt)>=0&&(i=!0)}),i)return n8(n,r);sl={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},h=[],d=r.dense?[]:{},m="",g={},x={},E=Nn('<Data ss:Type="String">'),T=0,w=0,v=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},U={},_="",k=0,A=[],I={},P={},C=0,F=[],me=[],he={},Ce=[],_e,ie=!1,W=[],fe=[],ke={},L=0,K=0,G={Sheets:[],WBProps:{date1904:!1}},H={};Fl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=Fl.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Kb(n.slice(T,o.index),_,E,c[c.length-1][0]=="comment"?he:g,{c:w,r:v},z,Ce[w],x,W,r):(_="",E=Nn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(me.length>0&&(g.c=me),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(d[v]||(d[v]=[]),d[v][w]=g):d[Xt(w)+hr(v)]=g),g.HRef&&(g.l={Target:rt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(L=w+(parseInt(g.MergeAcross,10)|0),K=v+(parseInt(g.MergeDown,10)|0),A.push({s:{c:w,r:v},e:{c:L,r:K}})),!r.sheetStubs)g.MergeAcross?w=L+1:++w;else if(g.MergeAcross||g.MergeDown){for(var de=w;de<=L;++de)for(var Ae=v;Ae<=K;++Ae)(de>w||Ae>v)&&(r.dense?(d[Ae]||(d[Ae]=[]),d[Ae][de]={t:"z"}):d[Xt(de)+hr(Ae)]={t:"z"});w=L+1}else++w;else g=zb(o[0]),g.Index&&(w=+g.Index-1),w<O.s.c&&(O.s.c=w),w>O.e.c&&(O.e.c=w),o[0].slice(-2)==="/>"&&++w,me=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<O.s.r&&(O.s.r=v),v>O.e.r&&(O.e.r=v),o[0].slice(-2)==="/>"&&(x=Nn(o[0]),x.Index&&(v=+x.Index-1)),w=0,++v):(x=Nn(o[0]),x.Index&&(v=+x.Index-1),ke={},(x.AutoFitHeight=="0"||x.Height)&&(ke.hpx=parseInt(x.Height,10),ke.hpt=LT(ke.hpx),fe[v]=ke),x.Hidden=="1"&&(ke.hidden=!0,fe[v]=ke));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(d["!ref"]=Ze(O),r.sheetRows&&r.sheetRows<=O.e.r&&(d["!fullref"]=d["!ref"],O.e.r=r.sheetRows-1,d["!ref"]=Ze(O))),A.length&&(d["!merges"]=A),Ce.length>0&&(d["!cols"]=Ce),fe.length>0&&(d["!rows"]=fe),f[m]=d}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([o[3],!1]),l=Nn(o[0]),m=rt(l.Name),d=r.dense?[]:{},A=[],W=[],fe=[],H={name:m,Hidden:0},G.Sheets.push(H);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ce=[],ie=!1}break;case"style":o[1]==="/"?Gb(z,U,r):U=Nn(o[0]);break;case"numberformat":U.nf=rt(Nn(o[0]).Format||"General"),sl[U.nf]&&(U.nf=sl[U.nf]);for(var ge=0;ge!=392&&ze[ge]!=U.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(ze[ge]==null){da(U.nf,ge);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(_e=Nn(o[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!ie&&_e.wpx>10){ie=!0,br=OT;for(var ae=0;ae<Ce.length;++ae)Ce[ae]&&Bo(Ce[ae])}ie&&Bo(_e),Ce[_e.Index-1||Ce.length]=_e;for(var He=0;He<+_e.Span;++He)Ce[Ce.length]=fr(_e);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var j=Le(o[0]),lt={Name:j.Name,Ref:Ao(j.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(lt.Sheet=G.Sheets.length-1),G.Names.push(lt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=Nn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?NP(I,re,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));qb(he),me.push(he)}else c.push([o[3],!1]),l=Nn(o[0]),he={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=Nn(o[0]);d["!autofilter"]={ref:Ao($e.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return k_(n,r);var et=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else C=o.index+o[0].length;break;case"header":d["!margins"]||nl(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].header=+Le(o[0]).Margin);break;case"footer":d["!margins"]||nl(d["!margins"]={},"xlml"),isNaN(+Le(o[0]).Margin)||(d["!margins"].footer=+Le(o[0]).Margin);break;case"pagemargins":var je=Le(o[0]);d["!margins"]||nl(d["!margins"]={},"xlml"),isNaN(+je.Top)||(d["!margins"].top=+je.Top),isNaN(+je.Left)||(d["!margins"].left=+je.Left),isNaN(+je.Right)||(d["!margins"].right=+je.Right),isNaN(+je.Bottom)||(d["!margins"].bottom=+je.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$b(P,re,F,n.slice(C,o.index)):(F=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ye={};return!r.bookSheets&&!r.bookProps&&(ye.Sheets=f),ye.SheetNames=h,ye.Workbook=G,ye.SSF=fr(ze),ye.Props=I,ye.Custprops=P,ye}function Lp(t,e){switch(Dg(e=e||{}),e.type||"base64"){case"base64":return vd(un(t),e);case"binary":case"buffer":case"file":return vd(t,e);case"array":return vd(Da(t),e)}}function Xb(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=lP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=uP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Yb=[60,1084,2066,2165,2175];function Qb(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var c=Cs(r,r.l),l=Mp[c],f=0;l!=null&&Yb.indexOf(c)>-1;)i=Cs(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),a.push(o),r.l+=4+i,l=Mp[c=Cs(r,r.l)];var h=ai(a);cr(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function Qn(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||La[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Pl(t.v):t.w=Ea(t.v):t.w=In(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Qo(ze[n]||String(n))){var s=ca(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function rf(t,e,r){return{v:t,ixfe:e,t:r}}function Jb(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,c=[],l="",f={},h,d="",m,g,x,E,T={},w=[],v,O,z=[],U=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},A=function(ce){return ce<8?pa[ce]:ce<64&&U[ce-8]||pa[ce]},I=function(ce,Te,Pe){var De=Te.XF.data;if(!(!De||!De.patternType||!Pe||!Pe.cellStyles)){Te.s={},Te.s.patternType=De.patternType;var it;(it=Ol(A(De.icvFore)))&&(Te.s.fgColor={rgb:it}),(it=Ol(A(De.icvBack)))&&(Te.s.bgColor={rgb:it})}},P=function(ce,Te,Pe){if(!(ke>1)&&!(Pe.sheetRows&&ce.r>=Pe.sheetRows)){if(Pe.cellStyles&&Te.XF&&Te.XF.data&&I(ce,Te,Pe),delete Te.ixfe,delete Te.XF,h=ce,d=Ue(ce),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ce.r<a.s.r&&(a.s.r=ce.r),ce.c<a.s.c&&(a.s.c=ce.c),ce.r+1>a.e.r&&(a.e.r=ce.r+1),ce.c+1>a.e.c&&(a.e.c=ce.c+1),Pe.cellFormula&&Te.f){for(var De=0;De<w.length;++De)if(!(w[De][0].s.c>ce.c||w[De][0].s.r>ce.r)&&!(w[De][0].e.c<ce.c||w[De][0].e.r<ce.r)){Te.F=Ze(w[De][0]),(w[De][0].s.c!=ce.c||w[De][0].s.r!=ce.r)&&delete Te.f,Te.f&&(Te.f=""+Tr(w[De][1],a,ce,W,C));break}}Pe.dense?(s[ce.r]||(s[ce.r]=[]),s[ce.r][ce.c]=Te):s[d]=Te}},C={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var F,me=[],he=[],Ce=[],_e=[],ie=!1,W=[];W.SheetNames=C.snames,W.sharedf=C.sharedf,W.arrayf=C.arrayf,W.names=[],W.XTI=[];var fe=0,ke=0,L=0,K=[],G=[],H;C.codepage=1200,Mn(1200);for(var re=!1;t.l<t.length-1;){var de=t.l,Ae=t.read_shift(2);if(Ae===0&&fe===10)break;var ge=t.l===t.length?0:t.read_shift(2),ae=Mp[Ae];if(ae&&ae.f){if(e.bookSheets&&fe===133&&Ae!==133)break;if(fe=Ae,ae.r===2||ae.r==12){var He=t.read_shift(2);if(ge-=2,!C.enc&&He!==Ae&&((He&255)<<8|He>>8)!==Ae)throw new Error("rt mismatch: "+He+"!="+Ae);ae.r==12&&(t.l+=10,ge-=10)}var j={};if(Ae===10?j=ae.f(t,ge,C):j=Qb(Ae,ae,t,ge,C),ke==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(Ae){case 34:r.opts.Date1904=_.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=j;break;case 66:var lt=Number(j);switch(lt){case 21010:lt=1200;break;case 32768:lt=1e4;break;case 32769:lt=1252;break}Mn(C.codepage=lt),re=!0;break;case 317:C.rrtabid=j;break;case 25:C.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:C.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:z.push(j);break;case 430:W.push([j]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(j);break;case 24:case 536:H={Name:j.Name,Ref:Tr(j.rgce,a,null,W,C)},j.itab>0&&(H.Sheet=j.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(G[j.itab-1]={ref:Ze(j.rgce[0][0][1][2])});break;case 22:C.ExternCount=j;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(j),W.XTI=W.XTI.concat(j);break;case 2196:if(C.biff<8)break;H!=null&&(H.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&C.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,C.snames.push(j.name);break;case 10:{if(--ke)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=Ze(a),e.sheetRows&&e.sheetRows<=a.e.r){var $e=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ze(a),a.e.r=$e}a.e.r++,a.e.c++}me.length>0&&(s["!merges"]=me),he.length>0&&(s["!objects"]=he),Ce.length>0&&(s["!cols"]=Ce),_e.length>0&&(s["!rows"]=_e),_.Sheets.push(k)}l===""?f=s:n[l]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),C.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(C.biff=5,re=!0,Mn(C.codepage=28591)),C.biff==8&&j.BIFFVer==0&&j.dt==16&&(C.biff=2),ke++)break;if(s=e.dense?[]:{},C.biff<8&&!re&&(re=!0,Mn(C.codepage=e.codepage||1252)),C.biff<5||j.BIFFVer==0&&j.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:t.l-ge,name:l};i[et.pos]=et,C.snames.push(l)}else l=(i[de]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),me=[],he=[],C.arrayf=w=[],Ce=[],_e=[],ie=!1,k={Hidden:(i[de]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[j.r]||[])[j.c]:s[Ue({c:j.c,r:j.r})])&&++j.c,v={ixfe:j.ixfe,XF:z[j.ixfe]||{},v:j.val,t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e);break;case 5:case 517:v={ixfe:j.ixfe,XF:z[j.ixfe],v:j.val,t:j.t},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e);break;case 638:v={ixfe:j.ixfe,XF:z[j.ixfe],v:j.rknum,t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e);break;case 189:for(var je=j.c;je<=j.C;++je){var ye=j.rkrec[je-j.c][0];v={ixfe:ye,XF:z[ye],v:j.rkrec[je-j.c][1],t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:je,r:j.r},v,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(v=rf(j.val,j.cell.ixfe,j.tt),v.XF=z[v.ixfe],e.cellFormula){var nt=j.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var nr=nt[0][0][1][0],$t=nt[0][0][1][1],zr=Ue({r:nr,c:$t});T[zr]?v.f=""+Tr(j.formula,a,j.cell,W,C):v.F=((e.dense?(s[nr]||[])[$t]:s[zr])||{}).F}else v.f=""+Tr(j.formula,a,j.cell,W,C)}L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P(j.cell,v,e),o=j}break;case 7:case 519:if(o)o.val=j,v=rf(j,o.cell.ixfe,"s"),v.XF=z[v.ixfe],e.cellFormula&&(v.f=""+Tr(o.formula,a,o.cell,W,C)),L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(j);var vs=Ue(j[0].s);if(m=e.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[vs],e.cellFormula&&m){if(!o||!vs||!m)break;m.f=""+Tr(j[1],a,j[0],W,C),m.F=Ze(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Ue(o.cell)]=j[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(m||{}).f=""+Tr(j[0],a,h,W,C)}}break;case 253:v=rf(c[j.isst].t,j.ixfe,"s"),c[j.isst].h&&(v.h=c[j.isst].h),v.XF=z[v.ixfe],L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:j.ixfe,XF:z[j.ixfe],t:"z"},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e));break;case 190:if(e.sheetStubs)for(var mr=j.c;mr<=j.C;++mr){var Wt=j.ixfe[mr-j.c];v={ixfe:Wt,XF:z[Wt],t:"z"},L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:mr,r:j.r},v,e)}break;case 214:case 516:case 4:v=rf(j.val,j.ixfe,"s"),v.XF=z[v.ixfe],L>0&&(v.z=K[v.ixfe>>8&63]),Qn(v,e,r.opts.Date1904),P({c:j.c,r:j.r},v,e);break;case 0:case 512:ke===1&&(a=j);break;case 252:c=j;break;case 1054:if(C.biff==4){K[L++]=j[1];for(var Hr=0;Hr<L+163&&ze[Hr]!=j[1];++Hr);Hr>=163&&da(j[1],L+163)}else da(j[1],j[0]);break;case 30:{K[L++]=j;for(var ut=0;ut<L+163&&ze[ut]!=j;++ut);ut>=163&&da(j,L+163)}break;case 229:me=me.concat(j);break;case 93:he[j.cmo[0]]=C.lastobj=j;break;case 438:C.lastobj.TxO=j;break;case 127:C.lastobj.ImData=j;break;case 440:for(E=j[0].s.r;E<=j[0].e.r;++E)for(x=j[0].s.c;x<=j[0].e.c;++x)m=e.dense?(s[E]||[])[x]:s[Ue({c:x,r:E})],m&&(m.l=j[1]);break;case 2048:for(E=j[0].s.r;E<=j[0].e.r;++E)for(x=j[0].s.c;x<=j[0].e.c;++x)m=e.dense?(s[E]||[])[x]:s[Ue({c:x,r:E})],m&&m.l&&(m.l.Tooltip=j[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;m=e.dense?(s[j[0].r]||[])[j[0].c]:s[Ue(j[0])];var Z=he[j[2]];m||(e.dense?(s[j[0].r]||(s[j[0].r]=[]),m=s[j[0].r][j[0].c]={t:"z"}):m=s[Ue(j[0])]={t:"z"},a.e.r=Math.max(a.e.r,j[0].r),a.s.r=Math.min(a.s.r,j[0].r),a.e.c=Math.max(a.e.c,j[0].c),a.s.c=Math.min(a.s.c,j[0].c)),m.c||(m.c=[]),g={a:j[1],t:Z.TxO.t},m.c.push(g)}break;case 2173:yD(z[j.ixfe],j.ext);break;case 125:{if(!C.cellStyles)break;for(;j.e>=j.s;)Ce[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ie||(ie=!0,Cg(j.w/256)),Bo(Ce[j.e+1])}break;case 520:{var oe={};j.level!=null&&(_e[j.r]=oe,oe.level=j.level),j.hidden&&(_e[j.r]=oe,oe.hidden=!0),j.hpt&&(_e[j.r]=oe,oe.hpt=j.hpt,oe.hpx=bl(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||nl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=j;break;case 161:s["!margins"]||nl(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(_.Views[0].RTL=!0);break;case 146:U=j;break;case 2198:F=j;break;case 140:O=j;break;case 442:l?k.CodeName=j||k.name:_.WBProps.CodeName=j||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),t.l+=ge}return r.SheetNames=ds(i).sort(function(we,ce){return Number(we)-Number(ce)}).map(function(we){return i[we].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&G.forEach(function(we,ce){r.Sheets[r.SheetNames[ce]]["!autofilter"]=we}),r.Strings=c,r.SSF=fr(ze),C.enc&&(r.Encryption=C.enc),F&&(r.Themes=F),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),W.names.length>0&&(_.Names=W.names),r.Workbook=_,r}var __={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Zb(t,e,r){var n=Je.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=r_(n,gP,__.DSI);for(var i in s)e[i]=s[i]}catch(l){if(r.WTF)throw l}var a=Je.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=r_(a,xP,__.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(xT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function ek(t,e){e||(e={}),Dg(e),R2(),e.codepage&&fg(e.codepage);var r,n;if(t.FullPaths){if(Je.find(t,"/encryption"))throw new Error("File is password-protected");r=Je.find(t,"!CompObj"),n=Je.find(t,"/Workbook")||Je.find(t,"/Book")}else{switch(e.type){case"base64":t=Ln(un(t));break;case"binary":t=Ln(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}cr(t,0),n={content:t}}var s,i;if(r&&Xb(r),e.bookProps&&!e.bookSheets)s={};else{var a=Ye?"buffer":"array";if(n&&n.content)s=Jb(n.content,e);else if((i=Je.find(t,"PerfectOffice_MAIN"))&&i.content)s=tl.to_workbook(i.content,(e.type=a,e));else if((i=Je.find(t,"NativeContent_MAIN"))&&i.content)s=tl.to_workbook(i.content,(e.type=a,e));else throw(i=Je.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Je.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=VD(t))}var o={};return t.FullPaths&&Zb(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var ph={0:{f:OO},1:{f:VO},2:{f:KO},3:{f:zO},4:{f:BO},5:{f:GO},6:{f:YO},7:{f:$O},8:{f:tb},9:{f:eb},10:{f:JO},11:{f:ZO},12:{f:UO},13:{f:qO},14:{f:HO},15:{f:jO},16:{f:XT},17:{f:QO},18:{f:WO},19:{f:wg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Cb},40:{},42:{},43:{f:JF},44:{f:QF},45:{f:ZF},46:{f:tD},47:{f:eD},48:{},49:{f:rP},50:{},51:{f:wD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:RT},62:{f:XO},63:{f:ID},64:{f:ub},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MO},148:{f:bO,p:16},151:{f:sb},152:{},153:{f:Sb},154:{},155:{},156:{f:Ab},157:{},158:{},159:{T:1,f:xF},160:{T:-1},161:{T:1,f:ba},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:rb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ED},336:{T:-1},337:{f:TD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:CT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ib},427:{f:ab},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:bD},633:{T:1},634:{T:-1},635:{T:1,f:OD},636:{T:-1},637:{f:sP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mp={6:{f:gd},10:{f:Zs},12:{f:Bt},13:{f:Bt},14:{f:Ft},15:{f:Ft},16:{f:Sr},17:{f:Ft},18:{f:Ft},19:{f:Bt},20:{f:a_},21:{f:a_},23:{f:CT},24:{f:c_},25:{f:Ft},26:{},27:{},28:{f:FN},29:{},34:{f:Ft},35:{f:o_},38:{f:Sr},39:{f:Sr},40:{f:Sr},41:{f:Sr},42:{f:Ft},43:{f:Ft},47:{f:LF},49:{f:dN},51:{f:Bt},60:{},61:{f:uN},64:{f:Ft},65:{f:hN},66:{f:Bt},77:{},80:{},81:{},82:{},85:{f:Bt},89:{},90:{},91:{},92:{f:rN},93:{f:ON},94:{},95:{f:Ft},96:{},97:{},99:{f:Ft},125:{f:RT},128:{f:TN},129:{f:nN},130:{f:Bt},131:{f:Ft},132:{f:Ft},133:{f:sN},134:{},140:{f:BN},141:{f:Bt},144:{},146:{f:zN},151:{},152:{},153:{},154:{},155:{},156:{f:Bt},157:{},158:{},160:{f:KN},161:{f:$N},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_N},190:{f:yN},193:{f:Zs},197:{},198:{},199:{},200:{},201:{},202:{f:Ft},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Bt},220:{},221:{f:Ft},222:{},224:{f:wN},225:{f:tN},226:{f:Zs},227:{},229:{f:DN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:iN},253:{f:pN},255:{f:aN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:wT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ft},353:{f:Zs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:AN},431:{f:Ft},432:{},433:{},434:{},437:{},438:{f:MN},439:{f:Ft},440:{f:VN},441:{},442:{f:eu},443:{},444:{f:Bt},445:{},446:{},448:{f:Zs},449:{f:lN,r:2},450:{f:Zs},512:{f:s_},513:{f:GN},515:{f:kN},516:{f:mN},517:{f:i_},519:{f:qN},520:{f:oN},523:{},545:{f:l_},549:{f:n_},566:{},574:{f:fN},638:{f:vN},659:{},1048:{},1054:{f:gN},1084:{},1212:{f:RN},2048:{f:UN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:HN,r:12},2173:{f:_D,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ft,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:CN,r:12},2197:{},2198:{f:dD,r:12},2199:{},2200:{},2201:{},2202:{f:PN,r:12},2203:{f:Zs},2204:{},2205:{},2206:{},2207:{},2211:{f:cN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Bt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:jN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:s_},1:{},2:{f:JN},3:{f:QN},4:{f:YN},5:{f:i_},7:{f:ZN},8:{},9:{f:Zu},11:{},22:{f:Bt},30:{f:xN},31:{},32:{},33:{f:l_},36:{},37:{f:n_},50:{f:eF},62:{},52:{},67:{},68:{f:Bt},69:{},86:{},126:{},127:{f:XN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:tF},223:{},234:{},354:{},421:{},518:{f:gd},521:{f:Zu},536:{f:c_},547:{f:o_},561:{},579:{},1030:{f:gd},1033:{f:Zu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Fn(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&lT(r)&&t.push(r)}}function y_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,c=k3(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var x=c[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var w=T[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,O=0;v.charAt(0)=="<"&&(O=v.indexOf(">"))>-1;)v=v.slice(O+1);for(var z=0;z<g.length;++z){var U=g[z];U.s.c==f&&U.s.r<l&&l<=U.e.r&&(f=U.e.c+1,z=-1)}var _=Le(w.slice(0,w.indexOf(">")));d=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||d>1)&&g.push({s:{r:l,c:f},e:{r:l+(h||1)-1,c:f+d-1}});var k=_.t||_["data-t"]||"";if(!v.length){f+=d;continue}if(v=Y2(v),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!v.length){f+=d;continue}var A={t:"s",v};r.raw||!v.trim().length||k=="s"||(v==="TRUE"?A={t:"b",v:!0}:v==="FALSE"?A={t:"b",v:!1}:isNaN(zn(v))?isNaN(Uo(v).getDate())||(A={t:"d",v:rr(v)},r.cellDates||(A={t:"n",v:Ur(A.v)}),A.z=r.dateNF||ze[14]):A={t:"n",v:zn(v)}),r.dense?(n[l]||(n[l]=[]),n[l][f]=A):n[Ue({r:l,c:f})]=A,f+=d}}}}return n["!ref"]=Ze(m),g.length&&(n["!merges"]=g),n}function e8(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<s.length;++l)if(!(s[l].s.r>r||s[l].s.c>a)&&!(s[l].e.r<r||s[l].e.c<a)){if(s[l].s.r<r||s[l].s.c<a){o=-1;break}o=s[l].e.r-s[l].s.r+1,c=s[l].e.c-s[l].s.c+1;break}if(!(o<0)){var f=Ue({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||xg(h.w||(Bs(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,i.push(B3("td",d,m))}}var g="<tr>";return g+i.join("")+"</tr>"}var t8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r8="</body></html>";function n8(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $i(y_(r[0],e),e);var n=bg();return r.forEach(function(s,i){Lg(n,y_(s,e),"Sheet"+(i+1))}),n}function s8(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function i8(t,e){var r=e||{},n=r.header!=null?r.header:t8,s=r.footer!=null?r.footer:r8,i=[n],a=Jo(t["!ref"]);r.dense=Array.isArray(t),i.push(s8(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(e8(t,a,o,r));return i.push("</table>"+s),i.join("")}function tk(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Lr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var f=Jo(t["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),s==-1&&(l.e.r=s=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),g=0,x=0,E=0,T=0,w=0,v=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&x<c;++g){var O=o[g];if(E_(O)){if(n.display)continue;m[x]={hidden:!0}}var z=O.children;for(E=T=0;E<z.length;++E){var U=z[E];if(!(n.display&&E_(U))){var _=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):Y2(U.innerHTML),k=U.getAttribute("data-z")||U.getAttribute("z");for(d=0;d<h.length;++d){var A=h[d];A.s.c==T+i&&A.s.r<x+s&&x+s<=A.e.r&&(T=A.e.c+1-i,d=-1)}v=+U.getAttribute("colspan")||1,((w=+U.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:x+s,c:T+i},e:{r:x+s+(w||1)-1,c:T+i+(v||1)-1}});var I={t:"s",v:_},P=U.getAttribute("data-t")||U.getAttribute("t")||"";_!=null&&(_.length==0?I.t=P||"z":n.raw||_.trim().length==0||P=="s"||(_==="TRUE"?I={t:"b",v:!0}:_==="FALSE"?I={t:"b",v:!1}:isNaN(zn(_))?isNaN(Uo(_).getDate())||(I={t:"d",v:rr(_)},n.cellDates||(I={t:"n",v:Ur(I.v)}),I.z=n.dateNF||ze[14]):I={t:"n",v:zn(_)})),I.z===void 0&&k!=null&&(I.z=k);var C="",F=U.getElementsByTagName("A");if(F&&F.length)for(var me=0;me<F.length&&!(F[me].hasAttribute("href")&&(C=F[me].getAttribute("href"),C.charAt(0)!="#"));++me);C&&C.charAt(0)!="#"&&(I.l={Target:C}),n.dense?(t[x+s]||(t[x+s]=[]),t[x+s][T+i]=I):t[Ue({c:T+i,r:x+s})]=I,l.e.c<T+i&&(l.e.c=T+i),T+=v}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,x-1+s),t["!ref"]=Ze(l),x>=c&&(t["!fullref"]=Ze((l.e.r=o.length-g+x-1+s,l))),t}function rk(t,e){var r=e||{},n=r.dense?[]:{};return tk(n,t,e)}function a8(t,e){return $i(rk(t,e),e)}function E_(t){var e="",r=o8(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function o8(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function c8(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=rt(e.replace(/<[^>]*>/g,""));return[r]}var w_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nk(t,e){var r=e||{},n=vg(t),s=[],i,a,o={name:""},c="",l=0,f,h,d={},m=[],g=r.dense?[]:{},x,E,T={value:""},w="",v=0,O=[],z=-1,U=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,A={},I=[],P={},C=0,F=0,me=[],he=1,Ce=1,_e=[],ie={Names:[]},W={},fe=["",""],ke=[],L={},K="",G=0,H=!1,re=!1,de=0;for(Fl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Fl.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?g["!ref"]=Ze(_):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(g["!fullref"]=g["!ref"],_.e.r=r.sheetRows-1,g["!ref"]=Ze(_)),I.length&&(g["!merges"]=I),me.length&&(g["!rows"]=me),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),d[f.name]=g,re=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=Le(x[0],!1),z=U=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,g=r.dense?[]:{},I=[],me=[],re=!0);break;case"table-row-group":x[1]==="/"?--k:++k;break;case"table-row":case"":if(x[1]==="/"){z+=he,he=1;break}if(h=Le(x[0],!1),h.?z=h.-1:z==-1&&(z=0),he=+h["number-rows-repeated"]||1,he<10)for(de=0;de<he;++de)k>0&&(me[z+de]={level:k});U=-1;break;case"covered-table-cell":x[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(g[z]||(g[z]=[]),g[z][U]={t:"z"}):g[Ue({r:z,c:U})]={t:"z"}),w="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++U,T=Le(x[0],!1),Ce=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=g_(rt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=rt(T["string-value"]||""),r.dense?(g[z]||(g[z]=[]),g[z][U]=E):g[Ue({r:z,c:U})]=E),U+=Ce-1;else if(x[1]!=="/"){++U,w="",v=0,O=[],Ce=1;var Ae=he?z+he-1:z;if(U>_.e.c&&(_.e.c=U),U<_.s.c&&(_.s.c=U),z<_.s.r&&(_.s.r=z),Ae>_.e.r&&(_.e.r=Ae),T=Le(x[0],!1),ke=[],L={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=rt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(C=parseInt(T["number-matrix-rows-spanned"],10)||0,F=parseInt(T["number-matrix-columns-spanned"],10)||0,P={s:{r:z,c:U},e:{r:z+C-1,c:U+F-1}},E.F=Ze(P),_e.push([P,E.F])),T.formula)E.f=g_(T.formula);else for(de=0;de<_e.length;++de)z>=_e[de][0].s.r&&z<=_e[de][0].e.r&&U>=_e[de][0].s.c&&U<=_e[de][0].e.c&&(E.F=_e[de][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(C=parseInt(T["number-rows-spanned"],10)||0,F=parseInt(T["number-columns-spanned"],10)||0,P={s:{r:z,c:U},e:{r:z+C-1,c:U+F-1}},I.push(P)),T["number-columns-repeated"]&&(Ce=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Et(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=rr(T["date-value"]),r.cellDates||(E.t="n",E.v=Ur(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=E3(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=e0(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(w=rt(T["string-value"]),O=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=w||"",O.length&&(E.R=O),H=v==0),W.Target&&(E.l=W),ke.length>0&&(E.c=ke,ke=[]),w&&r.cellText!==!1&&(E.w=w),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var ge=0;ge<he;++ge){if(Ce=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(g[z+ge]||(g[z+ge]=[]),g[z+ge][U]=ge==0?E:fr(E);--Ce>0;)g[z+ge][U+Ce]=fr(E);else for(g[Ue({r:z+ge,c:U})]=E;--Ce>0;)g[Ue({r:z+ge,c:U+Ce})]=fr(E);_.e.c<=U&&(_.e.c=U)}Ce=parseInt(T["number-columns-repeated"]||"1",10),U+=Ce-1,Ce=0,E={},w="",O=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i;L.t=w,O.length&&(L.R=O),L.a=K,ke.push(L)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);K="",G=0,w="",v=0,O=[];break;case"creator":x[1]==="/"?K=n.slice(G,x.index):G=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);w="",v=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(A[o.name]=c,(i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=Le(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Le(x[0],!1),c+=w_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Le(x[0],!1),c+=w_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,x.index);break}else l=x.index+x[0].length;break;case"named-range":a=Le(x[0],!1),fe=xd(a["cell-range-address"]);var ae={Name:a.name,Ref:fe[0]+"!"+fe[1]};re&&(ae.Sheet=m.length),ie.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var He=c8(n.slice(v,x.index));w=(w.length>0?w+`
`:"")+He[0]}else Le(x[0],!1),v=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{fe=xd(Le(x[0])["target-range-address"]),d[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(W=Le(x[0],!1),!W.href)break;W.Target=rt(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(fe=xd(W.Target.slice(1)),W.Target="#"+fe[0]+"!"+fe[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:d,SheetNames:m,Workbook:ie};return r.bookSheets&&delete j.Sheets,j}function T_(t,e){e=e||{},gn(t,"META-INF/manifest.xml")&&kP(Ut(t,"META-INF/manifest.xml"),e);var r=nn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=nk(mt(r),e);return gn(t,"meta.xml")&&(n.Props=gT(Ut(t,"meta.xml"))),n}function k_(t,e){return nk(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ng(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Vp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):mt(Da(t))}function Up(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function A_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function l8(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Ll(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Yt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ir(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Ll(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ll(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var l={data:o,type:i};e[s]==null?e[s]=[l]:e[s].push(l)}return e}function Fg(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function u8(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Ll(t,n),i=Ir(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:Yt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Ir(o.data),l=Yt(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=i[3])!=null&&e[0]&&(a.merge=Yt(i[3][0].data)>>>0>0),r.push(a)}return r}function f8(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ll(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(i==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,i==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Up(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(s.push(s[0].slice(-c)),l-=c;l>=s[s.length-1].length;)s.push(s[s.length-1]),l-=s[s.length-1].length;s.push(s[0].slice(-c,-c+l))}}var f=Up(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function h8(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(f8(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Up(e)}function d8(t,e,r,n){var s=Ng(t),i=s.getUint32(4,!0),a=(n>1?12:8)+A_(i&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=A_(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(a,!0),a+=4),i&32&&(l=s.getFloat64(a,!0),a+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function p8(t,e,r){var n=Ng(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);s&1&&(c=l8(t,i),i+=16),s&2&&(l=n.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function m8(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return d8(t,e,r,t[0]);case 5:return p8(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ki(t){var e=Ir(t);return Ll(e[1][0].data)}function S_(t,e){var r=Ir(e.data),n=Yt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Ir(a.data),c=Yt(o[1][0].data)>>>0;switch(n){case 1:i[c]=Vp(o[3][0].data);break;case 8:{var l=t[ki(o[9][0].data)][0],f=Ir(l.data),h=t[ki(f[1][0].data)][0],d=Yt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=Ir(h.data);i[c]=m[3].map(function(g){return Vp(g.data)}).join("")}break}}),i}function g8(t,e){var r,n,s,i,a,o,c,l,f,h,d,m,g,x,E=Ir(t),T=Yt(E[1][0].data)>>>0,w=Yt(E[2][0].data)>>>0,v=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Yt(E[8][0].data)>0||!1,O,z;if((i=(s=E[7])==null?void 0:s[0])!=null&&i.data&&e!=0)O=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,z=(l=(c=E[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(f=E[4])==null?void 0:f[0])!=null&&h.data&&e!=1)O=(m=(d=E[4])==null?void 0:d[0])==null?void 0:m.data,z=(x=(g=E[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var U=v?4:1,_=Ng(O),k=[],A=0;A<O.length/2;++A){var I=_.getUint16(A*2,!0);I<65535&&k.push([A,I])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var P=[];for(A=0;A<k.length-1;++A)P[k[A][0]]=z.subarray(k[A][1]*U,k[A+1][1]*U);return k.length>=1&&(P[k[k.length-1][0]]=z.subarray(k[k.length-1][1]*U)),{R:T,cells:P}}function x8(t,e){var r,n=Ir(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Yt(n[7][0].data)>>>0>0?1:0:-1,i=Fg(n[5],function(a){return g8(a,s)});return{nrows:Yt(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function v8(t,e,r){var n,s=Ir(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Yt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Yt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ze(i);var a=Ir(s[4][0].data),o=S_(t,t[ki(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?S_(t,t[ki(a[17][0].data)][0]):[],l=Ir(a[3][0].data),f=0;l[1].forEach(function(h){var d=Ir(h.data),m=t[ki(d[2][0].data)][0],g=Yt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var x=x8(t,m);x.data.forEach(function(E,T){E.forEach(function(w,v){var O=Ue({r:f+T,c:v}),z=m8(w,o,c);z&&(r[O]=z)})}),f+=x.nrows})}function _8(t,e){var r=Ir(e.data),n={"!ref":"A1"},s=t[ki(r[2][0].data)],i=Yt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return v8(t,s[0],n),n}function y8(t,e){var r,n=Ir(e.data),s={name:(r=n[1])!=null&&r[0]?Vp(n[1][0].data):"",sheets:[]},i=Fg(n[2],ki);return i.forEach(function(a){t[a].forEach(function(o){var c=Yt(o.meta[1][0].data);c==6e3&&s.sheets.push(_8(t,o))})}),s}function E8(t,e){var r=bg(),n=Ir(e.data),s=Fg(n[1],ki);if(s.forEach(function(i){t[i].forEach(function(a){var o=Yt(a.meta[1][0].data);if(o==2){var c=y8(t,a);c.sheets.forEach(function(l,f){Lg(r,l,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function _d(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=h8(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=u8(l)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Yt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(c){i[c].forEach(function(l){var f=Yt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return E8(i,o)}function w8(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Dg(t){w8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function T8(t){return go.WS.indexOf(t)>-1?"sheet":t==go.CS?"chart":t==go.DS?"dialog":t==go.MS?"macro":t&&t.length?t:"sheet"}function k8(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,T8(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function A8(t,e,r,n,s,i,a,o,c,l,f,h){try{i[n]=Zc(nn(t,r,!0),e);var d=Ut(t,e),m;switch(o){case"sheet":m=Nb(d,e,s,c,i[n],l,f,h);break;case"chart":if(m=Fb(d,e,s,c,i[n],l,f,h),!m||!m["!drawel"])break;var g=Dc(m["!drawel"].Target,e),x=Dp(g),E=PD(nn(t,g,!0),Zc(nn(t,x,!0),g)),T=Dc(E,g),w=Dp(T);m=pb(nn(t,T,!0),T,c,Zc(nn(t,w,!0),T),l,m);break;case"macro":m=Db(d,e,s,c,i[n],l,f,h);break;case"dialog":m=Ob(d,e,s,c,i[n],l,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var v=[];i&&i[n]&&ds(i[n]).forEach(function(O){var z="";if(i[n][O].Type==go.CMNT){z=Dc(i[n][O].Target,e);var U=Vb(Ut(t,z,!0),z,c);if(!U||!U.length)return;f_(m,U,!1)}i[n][O].Type==go.TCMNT&&(z=Dc(i[n][O].Target,e),v=v.concat(FD(Ut(t,z,!0),c)))}),v&&v.length&&f_(m,v,!0,c.people||[])}catch(O){if(c.WTF)throw O}}function pn(t){return t.charAt(0)=="/"?t.slice(1):t}function S8(t,e){if(j2(),e=e||{},Dg(e),gn(t,"META-INF/manifest.xml")||gn(t,"objectdata.xml"))return T_(t,e);if(gn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _d<"u"){if(t.FileIndex)return _d(t);var r=Je.utils.cfb_new();return Vv(t).forEach(function(me){I3(r,me,S3(t,me))}),_d(r)}throw new Error("Unsupported NUMBERS file")}if(!gn(t,"[Content_Types].xml"))throw gn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vv(t),s=wP(nn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Ut(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Ut(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(rl=[],s.sst)try{rl=Mb(Ut(t,pn(s.sst)),s.sst,e)}catch(me){if(e.WTF)throw me}e.cellStyles&&s.themes.length&&(c=Lb(nn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(l=bb(Ut(t,pn(s.style)),s.style,c,e))}s.links.map(function(me){try{var he=Zc(nn(t,Dp(pn(me))),me);return Bb(Ut(t,pn(me)),he,me,e)}catch{}});var f=Pb(Ut(t,pn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=Ut(t,pn(s.coreprops[0]),!0),d&&(h=gT(d)),s.extprops.length!==0&&(d=Ut(t,pn(s.extprops[0]),!0),d&&IP(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=nn(t,pn(s.custprops[0]),!0),d&&(m=RP(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=m),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var x={};e.bookDeps&&s.calcchain&&(x=Ub(Ut(t,pn(s.calcchain)),s.calcchain));var E=0,T={},w,v;{var O=f.Sheets;h.Worksheets=O.length,h.SheetNames=[];for(var z=0;z!=O.length;++z)h.SheetNames[z]=O[z].name}var U=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");gn(t,k)||(k="xl/_rels/workbook."+U+".rels");var A=Zc(nn(t,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=jb(Ut(t,pn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=DD(Ut(t,pn(s.people[0])),e)),A&&(A=k8(A,f.Sheets));var I=Ut(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var P="sheet";if(A&&A[E]?(w="xl/"+A[E][1].replace(/[\/]?xl\//,""),gn(t,w)||(w=A[E][1]),gn(t,w)||(w=k.replace(/_rels\/.*$/,"")+A[E][1]),P=A[E][2]):(w="xl/worksheets/sheet"+(E+1-I)+"."+U,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==E&&(C=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[E].toLowerCase()&&(C=1);if(!C)continue e}}A8(t,w,v,h.SheetNames[E],E,T,a,P,e,f,c,l)}return g={Directory:s,Workbook:f,Props:h,Custprops:m,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:rl,Styles:l,Themes:c,SSF:fr(ze)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(me,he){me=me.replace(/^Root Entry[\/]/,""),g.keys.push(me),g.files[me]=t.FileIndex[he]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=Ut(t,pn(s.vba[0]),!0):s.defaults&&s.defaults.bin===MD&&(g.vbaraw=Ut(t,"xl/vbaProject.bin",!0))),g}function I8(t,e){var r=e||{},n="Workbook",s=Je.find(t,n);try{if(n="/!DataSpaces/Version",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(_F(s.content),n="/!DataSpaces/DataSpaceMap",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=EF(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=wF(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);kF(s.content)}catch{}if(n="/EncryptionInfo",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=AF(s.content);if(n="/EncryptedPackage",s=Je.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Og(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=un(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function C8(t,e){return Je.find(t,"EncryptedPackage")?I8(t,e):ek(t,e)}function R8(t,e){var r,n=t,s=e||{};return s.type||(s.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r=K2(n,s),S8(r,s)}function sk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lp(t.slice(r),e);default:break e}return Dl.to_workbook(t,e)}function P8(t,e){var r="",n=Og(t,e);switch(e.type){case"base64":r=un(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=wa(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=mt(r)),e.type="binary",sk(r,e)}function N8(t,e){var r=t;return e.type=="base64"&&(r=un(r)),r=Rl.utils.decode(1200,r.slice(2),"str"),e.type="binary",sk(r,e)}function F8(t){return t.match(/[^\x00-\x7F]/)?Oc(t):t}function yd(t,e,r,n){return n?(r.type="string",Dl.to_workbook(t,r)):Dl.to_workbook(e,r)}function mh(t,e){R2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return mh(new Uint8Array(t),(r=fr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),So={},r.dateNF&&(So.dateNF=r.dateNF),r.type||(r.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ye?"buffer":"binary",n=_3(t),typeof Uint8Array<"u"&&!Ye&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=F8(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=fr(r),r.type="array",mh(hg(n),r)}switch((s=Og(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return C8(Je.read(n,r),r);break;case 9:if(s[1]<=8)return ek(n,r);break;case 60:return Lp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return aF(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?R8(n,r):yd(t,n,r,i);case 239:return s[3]===60?Lp(n,r):yd(t,n,r,i);case 255:if(s[1]===254)return N8(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return tl.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return tl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return u_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return MF.to_workbook(n,r);break;case 10:case 13:case 32:return P8(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return rF.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?u_.to_workbook(n,r):yd(t,n,r,i)}function D8(t,e,r,n,s,i,a,o){var c=hr(r),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var g=a?t[r][m]:t[n[m]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;i[m]!=null&&(d[i[m]]=l);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[m]!=null){if(x==null)if(g.t=="e"&&x===null)d[i[m]]=null;else if(l!==void 0)d[i[m]]=l;else if(f&&x===null)d[i[m]]=null;else continue;else d[i[m]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?x:Bs(g,x,o);x!=null&&(h=!1)}}return{row:d,isempty:h}}function Bp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},f=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=Pt(f);break;case"number":c=Pt(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var h=hr(c.s.r),d=[],m=[],g=0,x=0,E=Array.isArray(t),T=c.s.r,w=0,v={};E&&!t[T]&&(t[T]=[]);var O=l.skipHidden&&t["!cols"]||[],z=l.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(O[w]||{}).hidden)switch(d[w]=Xt(w),r=E?t[T][w]:t[d[w]+h],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=d[w];break;case 3:i[w]=l.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Bs(r,null,l),x=v[a]||0,!x)v[a]=1;else{do o=a+"_"+x++;while(v[o]);v[a]=x,v[o]=1}i[w]=o}for(T=c.s.r+s;T<=c.e.r;++T)if(!(z[T]||{}).hidden){var U=D8(t,c,T,d,n,i,E,l);(U.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[g++]=U.row)}return m.length=g,m}var I_=/"/g;function O8(t,e,r,n,s,i,a,o){for(var c=!0,l=[],f="",h=hr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){c=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Bs(m,null,o));for(var g=0,x=0;g!==f.length;++g)if((x=f.charCodeAt(g))===s||x===i||x===34||o.forceQuotes){f='"'+f.replace(I_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(c=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(I_,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(a)}function ik(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Pt(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(d[g]||{}).hidden||(h[g]=Xt(g));for(var x=0,E=s.s.r;E<=s.e.r;++E)(m[E]||{}).hidden||(f=O8(t,s,E,h,a,c,i,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function b8(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=ik(t,e);return r}function L8(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Pt(t["!ref"]),i="",a=[],o,c=[],l=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=Xt(o);for(var f=s.s.r;f<=s.e.r;++f)for(i=hr(f),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=l?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function ak(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Lr(n.origin):n.origin;a=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=Pt(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+s)}else a==-1&&(a=0,f.e.r=e.length-1+s);var d=n.header||[],m=0;e.forEach(function(x,E){ds(x).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var w=x[T],v="z",O="",z=Ue({c:o+m,r:a+E+s});l=Ml(i,z),w&&typeof w=="object"&&!(w instanceof Date)?i[z]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=Ur(w)),O=n.dateNF||ze[14]):w===null&&n.nullError&&(v="e",w=0),l?(l.t=v,l.v=w,delete l.w,delete l.R,O&&(l.z=O)):i[z]=l={t:v,v:w},O&&(l.z=O))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=hr(a);if(s)for(m=0;m<d.length;++m)i[Xt(m+o)+g]={t:"s",v:d[m]};return i["!ref"]=Ze(f),i}function M8(t,e){return ak(null,t,e)}function Ml(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Lr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ml(t,Ue(e)):Ml(t,Ue({r:e,c:r||0}))}function V8(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function bg(){return{SheetNames:[],Sheets:{}}}function Lg(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(wb(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function U8(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=V8(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function B8(t,e){return t.z=e,t}function ok(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function j8(t,e,r){return ok(t,"#"+e,r)}function z8(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function H8(t,e,r,n){for(var s=typeof e!="string"?e:Pt(e),i=typeof e=="string"?e:Ze(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=Ml(t,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var C_={encode_col:Xt,encode_row:hr,encode_cell:Ue,encode_range:Ze,decode_col:Eg,decode_row:yg,split_cell:tP,decode_cell:Lr,decode_range:Jo,format_cell:Bs,sheet_add_aoa:fT,sheet_add_json:ak,sheet_add_dom:tk,aoa_to_sheet:Zo,json_to_sheet:M8,table_to_sheet:rk,table_to_book:a8,sheet_to_csv:ik,sheet_to_txt:b8,sheet_to_json:Bp,sheet_to_html:i8,sheet_to_formulae:L8,sheet_to_row_object_array:Bp,sheet_get_cell:Ml,book_new:bg,book_append_sheet:Lg,book_set_sheet_visibility:U8,cell_set_number_format:B8,cell_set_hyperlink:ok,cell_set_internal_link:j8,cell_add_comment:z8,sheet_set_array_formula:H8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const $8=()=>{};var R_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},W8=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},lk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,f=i>>2,h=(i&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ck(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):W8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const l=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||l==null||h==null)throw new G8;const d=i<<2|o>>4;if(n.push(d),l!==64){const m=o<<4&240|l>>2;if(n.push(m),h!==64){const g=l<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class G8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K8=function(t){const e=ck(t);return lk.encodeByteArray(e,!0)},gh=function(t){return K8(t).replace(/\./g,"")},uk=function(t){try{return lk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X8=()=>q8().__FIREBASE_DEFAULTS__,Y8=()=>{if(typeof process>"u"||typeof R_>"u")return;const t=R_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Q8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&uk(t[1]);return e&&JSON.parse(e)},s0=()=>{try{return $8()||X8()||Y8()||Q8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},fk=t=>{var e,r;return(r=(e=s0())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},J8=t=>{const e=fk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},hk=()=>{var t;return(t=s0())==null?void 0:t.config},dk=t=>{var e;return(e=s0())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pk(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gh(JSON.stringify(r)),gh(JSON.stringify(a)),""].join(".")}const il={};function tL(){const t={prod:[],emulator:[]};for(const e of Object.keys(il))il[e]?t.emulator.push(e):t.prod.push(e);return t}function rL(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let P_=!1;function mk(t,e){if(typeof window>"u"||typeof document>"u"||!ec(window.location.host)||il[t]===e||il[t]||P_)return;il[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",i=tL().prod.length>0;function a(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function c(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function l(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{P_=!0,a()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=rL(n),m=r("text"),g=document.getElementById(m)||document.createElement("span"),x=r("learnmore"),E=document.getElementById(x)||document.createElement("a"),T=r("preprendIcon"),w=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const v=d.element;o(v),f(E,x);const O=l();c(w,T),v.append(w,g,E,O),document.body.appendChild(v)}i?(g.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nr())}function sL(){var e;const t=(e=s0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oL(){const t=Nr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cL(){return!sL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xk(){try{return typeof indexedDB=="object"}catch{return!1}}function vk(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}function lL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL="FirebaseError";class qn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=uL,Object.setPrototypeOf(this,qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Va.prototype.create)}}class Va{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?fL(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new qn(s,o,n)}}function fL(t,e){return t.replace(hL,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const hL=/\{\$([^}]+)}/g;function dL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Oi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(N_(i)&&N_(a)){if(!Oi(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function N_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function bc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Lc(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function pL(t,e){const r=new mL(t,e);return r.subscribe.bind(r)}class mL{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");gL(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Ed),s.error===void 0&&(s.error=Ed),s.complete===void 0&&(s.complete=Ed);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gL(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Ed(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=1e3,vL=2,_L=4*60*60*1e3,yL=.5;function F_(t,e=xL,r=vL){const n=e*Math.pow(r,t),s=Math.round(yL*n*(Math.random()-.5)*2);return Math.min(_L,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(t){return t&&t._delegate?t._delegate:t}class $n{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Z8;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TL(e))try{this.getOrInitializeService({instanceIdentifier:na})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=na){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=na){return this.instances.has(e)}getOptions(e=na){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:wL(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=na){return this.component?this.component.multipleInstances?e:na:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wL(t){return t===na?void 0:t}function TL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new EL(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ke||(Ke={}));const AL={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},SL=Ke.INFO,IL={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},CL=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=IL[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class i0{constructor(e){this.name=e,this._logLevel=SL,this._logHandler=CL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const RL=(t,e)=>e.some(r=>t instanceof r);let D_,O_;function PL(){return D_||(D_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function NL(){return O_||(O_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _k=new WeakMap,jp=new WeakMap,yk=new WeakMap,wd=new WeakMap,Mg=new WeakMap;function FL(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Ai(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&_k.set(r,t)}).catch(()=>{}),Mg.set(e,t),e}function DL(t){if(jp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});jp.set(t,e)}let zp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return jp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ai(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function OL(t){zp=t(zp)}function bL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Td(this),e,...r);return yk.set(n,e.sort?e.sort():[e]),Ai(n)}:NL().includes(t)?function(...e){return t.apply(Td(this),e),Ai(_k.get(this))}:function(...e){return Ai(t.apply(Td(this),e))}}function LL(t){return typeof t=="function"?bL(t):(t instanceof IDBTransaction&&DL(t),RL(t,PL())?new Proxy(t,zp):t)}function Ai(t){if(t instanceof IDBRequest)return FL(t);if(wd.has(t))return wd.get(t);const e=LL(t);return e!==t&&(wd.set(t,e),Mg.set(e,t)),e}const Td=t=>Mg.get(t);function Ek(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=Ai(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Ai(a.result),c.oldVersion,c.newVersion,Ai(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const ML=["get","getKey","getAll","getAllKeys","count"],VL=["put","add","delete","clear"],kd=new Map;function b_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kd.get(e))return kd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=VL.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||ML.includes(r)))return;const i=async function(a,...o){const c=this.transaction(a,s?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),s&&c.done]))[0]};return kd.set(e,i),i}OL(t=>({...t,get:(e,r,n)=>b_(e,r)||t.get(e,r,n),has:(e,r)=>!!b_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(BL(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function BL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hp="@firebase/app",L_="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new i0("@firebase/app"),jL="@firebase/app-compat",zL="@firebase/analytics-compat",HL="@firebase/analytics",$L="@firebase/app-check-compat",WL="@firebase/app-check",GL="@firebase/auth",KL="@firebase/auth-compat",qL="@firebase/database",XL="@firebase/data-connect",YL="@firebase/database-compat",QL="@firebase/functions",JL="@firebase/functions-compat",ZL="@firebase/installations",e5="@firebase/installations-compat",t5="@firebase/messaging",r5="@firebase/messaging-compat",n5="@firebase/performance",s5="@firebase/performance-compat",i5="@firebase/remote-config",a5="@firebase/remote-config-compat",o5="@firebase/storage",c5="@firebase/storage-compat",l5="@firebase/firestore",u5="@firebase/ai",f5="@firebase/firestore-compat",h5="firebase",d5="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="[DEFAULT]",p5={[Hp]:"fire-core",[jL]:"fire-core-compat",[HL]:"fire-analytics",[zL]:"fire-analytics-compat",[WL]:"fire-app-check",[$L]:"fire-app-check-compat",[GL]:"fire-auth",[KL]:"fire-auth-compat",[qL]:"fire-rtdb",[XL]:"fire-data-connect",[YL]:"fire-rtdb-compat",[QL]:"fire-fn",[JL]:"fire-fn-compat",[ZL]:"fire-iid",[e5]:"fire-iid-compat",[t5]:"fire-fcm",[r5]:"fire-fcm-compat",[n5]:"fire-perf",[s5]:"fire-perf-compat",[i5]:"fire-rc",[a5]:"fire-rc-compat",[o5]:"fire-gcs",[c5]:"fire-gcs-compat",[l5]:"fire-fst",[f5]:"fire-fst-compat",[u5]:"fire-vertex","fire-js":"fire-js",[h5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new Map,m5=new Map,Wp=new Map;function M_(t,e){try{t.container.addComponent(e)}catch(r){js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ps(t){const e=t.name;if(Wp.has(e))return js.debug(`There were multiple attempts to register component ${e}.`),!1;Wp.set(e,t);for(const r of xh.values())M_(r,t);for(const r of m5.values())M_(r,t);return!0}function Ua(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _n(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Si=new Va("app","Firebase",g5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Si.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=d5;function wk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:$p,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Si.create("bad-app-name",{appName:String(s)});if(r||(r=hk()),!r)throw Si.create("no-options");const i=xh.get(s);if(i){if(Oi(r,i.options)&&Oi(n,i.config))return i;throw Si.create("duplicate-app",{appName:s})}const a=new kL(s);for(const c of Wp.values())a.addComponent(c);const o=new x5(r,n,a);return xh.set(s,o),o}function Vg(t=$p){const e=xh.get(t);if(!e&&t===$p&&hk())return wk();if(!e)throw Si.create("no-app",{appName:t});return e}function Tn(t,e,r){let n=p5[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),js.warn(a.join(" "));return}ps(new $n(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5="firebase-heartbeat-database",_5=1,Vl="firebase-heartbeat-store";let Ad=null;function Tk(){return Ad||(Ad=Ek(v5,_5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vl)}catch(r){console.warn(r)}}}}).catch(t=>{throw Si.create("idb-open",{originalErrorMessage:t.message})})),Ad}async function y5(t){try{const r=(await Tk()).transaction(Vl),n=await r.objectStore(Vl).get(kk(t));return await r.done,n}catch(e){if(e instanceof qn)js.warn(e.message);else{const r=Si.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});js.warn(r.message)}}}async function V_(t,e){try{const n=(await Tk()).transaction(Vl,"readwrite");await n.objectStore(Vl).put(e,kk(t)),await n.done}catch(r){if(r instanceof qn)js.warn(r.message);else{const n=Si.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});js.warn(n.message)}}}function kk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=1024,w5=30;class T5{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new A5(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=U_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>w5){const a=S5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){js.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=U_(),{heartbeatsToSend:n,unsentEntries:s}=k5(this._heartbeatsCache.heartbeats),i=gh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return js.warn(r),""}}}function U_(){return new Date().toISOString().substring(0,10)}function k5(t,e=E5){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),B_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),B_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class A5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xk()?vk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await y5(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function B_(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function S5(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(t){ps(new $n("platform-logger",e=>new UL(e),"PRIVATE")),ps(new $n("heartbeat",e=>new T5(e),"PRIVATE")),Tn(Hp,L_,t),Tn(Hp,L_,"esm2020"),Tn("fire-js","")}I5("");function Ak(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const C5=Ak,Sk=new Va("auth","Firebase",Ak());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=new i0("@firebase/auth");function R5(t,...e){vh.logLevel<=Ke.WARN&&vh.warn(`Auth (${tc}): ${t}`,...e)}function kf(t,...e){vh.logLevel<=Ke.ERROR&&vh.error(`Auth (${tc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(t,...e){throw Ug(t,...e)}function os(t,...e){return Ug(t,...e)}function Ik(t,e,r){const n={...C5(),[e]:r};return new Va("auth","Firebase",n).create(e,{appName:t.name})}function Os(t){return Ik(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Sk.create(t,...e)}function Oe(t,e,...r){if(!t)throw Ug(e,...r)}function Rs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw kf(e),new Error(e)}function zs(t,e){t||Rs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function P5(){return j_()==="http:"||j_()==="https:"}function j_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(P5()||gk()||"connection"in navigator)?navigator.onLine:!0}function F5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,r){this.shortDelay=e,this.longDelay=r,zs(r>e,"Short delay should be less than long delay!"),this.isMobile=nL()||aL()}get(){return N5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t,e){zs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b5=new iu(3e4,6e4);function Wi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ks(t,e,r,n,s={}){return Rk(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=su({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...i};return iL()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&ec(t.emulatorConfig.host)&&(l.credentials="include"),Ck.fetch()(await Pk(t,t.config.apiHost,r,o),l)})}async function Rk(t,e,r){t._canInitEmulator=!1;const n={...D5,...e};try{const s=new M5(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw nf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw nf(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw nf(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw nf(t,"user-disabled",a);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Ik(t,f,l);Wn(t,f)}}catch(s){if(s instanceof qn)throw s;Wn(t,"network-request-failed",{message:String(s)})}}async function au(t,e,r,n,s={}){const i=await Ks(t,e,r,n,s);return"mfaPendingCredential"in i&&Wn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Pk(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?Bg(t.config,s):`${t.config.apiScheme}://${s}`;return O5.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function L5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class M5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(os(this.auth,"network-request-failed")),b5.get())})}}function nf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=os(t,e,n);return s.customData._tokenResponse=r,s}function z_(t){return t!==void 0&&t.enterprise!==void 0}class V5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return L5(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function U5(t,e){return Ks(t,"GET","/v2/recaptchaConfig",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(t,e){return Ks(t,"POST","/v1/accounts:delete",e)}async function _h(t,e){return Ks(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function j5(t,e=!1){const r=Lt(t),n=await r.getIdToken(e),s=jg(n);Oe(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:al(Sd(s.auth_time)),issuedAtTime:al(Sd(s.iat)),expirationTime:al(Sd(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Sd(t){return Number(t)*1e3}function jg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return kf("JWT malformed, contained fewer than 3 sections"),null;try{const s=uk(r);return s?JSON.parse(s):(kf("Failed to decode base64 JWT payload"),null)}catch(s){return kf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function H_(t){const e=jg(t);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof qn&&z5(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function z5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=al(this.lastLoginAt),this.creationTime=al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(t){var h;const e=t.auth,r=await t.getIdToken(),n=await jo(t,_h(e,{idToken:r}));Oe(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?Nk(s.providerUserInfo):[],a=W5(t.providerData,i),o=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),l=o?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Kp(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,f)}async function $5(t){const e=Lt(t);await yh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function W5(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Nk(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G5(t,e){const r=await Rk(t,{},async()=>{const n=su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await Pk(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&ec(t.emulatorConfig.host)&&(c.credentials="include"),Ck.fetch()(a,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function K5(t,e){return Ks(t,"POST","/v2/accounts:revokeToken",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):H_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const r=H_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await G5(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new Io;return n&&(Oe(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Oe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Oe(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return Rs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(t,e){Oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Un{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new H5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Kp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await jo(this,this.stsTokenManager.getToken(this.auth,e));return Oe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return j5(this,e)}reload(){return $5(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Un({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await yh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_n(this.auth.app))return Promise.reject(Os(this.auth));const e=await this.getIdToken();return await jo(this,B5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:m,providerData:g,stsTokenManager:x}=r;Oe(h&&x,e,"internal-error");const E=Io.fromJSON(this.name,x);Oe(typeof h=="string",e,"internal-error"),ei(n,e.name),ei(s,e.name),Oe(typeof d=="boolean",e,"internal-error"),Oe(typeof m=="boolean",e,"internal-error"),ei(i,e.name),ei(a,e.name),ei(o,e.name),ei(c,e.name),ei(l,e.name),ei(f,e.name);const T=new Un({uid:h,auth:e,email:s,emailVerified:d,displayName:n,isAnonymous:m,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:E,createdAt:l,lastLoginAt:f});return g&&Array.isArray(g)&&(T.providerData=g.map(w=>({...w}))),c&&(T._redirectEventId=c),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new Io;s.updateFromServerResponse(r);const i=new Un({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await yh(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Oe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Nk(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new Io;o.updateFromIdToken(n);const c=new Un({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Kp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=new Map;function Ps(t){zs(t instanceof Function,"Expected a class definition");let e=$_.get(t);return e?(zs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,$_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Fk.type="NONE";const W_=Fk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t,e,r){return`firebase:${t}:${e}:${r}`}class Co{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Af(this.userKey,s.apiKey,i),this.fullPersistenceKey=Af("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await _h(this.auth,{idToken:e}).catch(()=>{});return r?Un._fromGetAccountInfoResponse(this.auth,r,e):null}return Un._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Co(Ps(W_),e,n);const s=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Ps(W_);const a=Af(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const f=await l._get(a);if(f){let h;if(typeof f=="string"){const d=await _h(e,{idToken:f}).catch(()=>{});if(!d)break;h=await Un._fromGetAccountInfoResponse(e,d,f)}else h=Un._fromJSON(e,f);l!==i&&(o=h),i=l;break}}catch{}const c=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Co(i,e,n):(i=c[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==i)try{await l._remove(a)}catch{}})),new Co(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Lk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Dk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Vk(e))return"Blackberry";if(Uk(e))return"Webos";if(Ok(e))return"Safari";if((e.includes("chrome/")||bk(e))&&!e.includes("edge/"))return"Chrome";if(Mk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Dk(t=Nr()){return/firefox\//i.test(t)}function Ok(t=Nr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bk(t=Nr()){return/crios\//i.test(t)}function Lk(t=Nr()){return/iemobile/i.test(t)}function Mk(t=Nr()){return/android/i.test(t)}function Vk(t=Nr()){return/blackberry/i.test(t)}function Uk(t=Nr()){return/webos/i.test(t)}function zg(t=Nr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function q5(t=Nr()){var e;return zg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function X5(){return oL()&&document.documentMode===10}function Bk(t=Nr()){return zg(t)||Mk(t)||Uk(t)||Vk(t)||/windows phone/i.test(t)||Lk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(t,e=[]){let r;switch(t){case"Browser":r=G_(Nr());break;case"Worker":r=`${G_(Nr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${tc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const c=e(i);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q5(t,e={}){return Ks(t,"GET","/v2/passwordPolicy",Wi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5=6;class Z5{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??J5,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new K_(this),this.idTokenSubscription=new K_(this),this.beforeStateQueue=new Y5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ps(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await _h(this,{idToken:e}),n=await Un._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(_n(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,o=n==null?void 0:n._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await yh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=F5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_n(this.app))return Promise.reject(Os(this));const r=e?Lt(e):null;return r&&Oe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _n(this.app)?Promise.reject(Os(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _n(this.app)?Promise.reject(Os(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ps(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Q5(this),r=new Z5(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Va("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await K5(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ps(e)||this._popupRedirectResolver;Oe(r,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[Ps(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{a=!0,c()}}else{const c=e.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(_n(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&R5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ba(t){return Lt(t)}class K_{constructor(e){this.auth=e,this.observer=null,this.addObserver=pL(r=>this.observer=r)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tM(t){a0=t}function zk(t){return a0.loadJS(t)}function rM(){return a0.recaptchaEnterpriseScript}function nM(){return a0.gapiScript}function sM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class iM{constructor(){this.enterprise=new aM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class aM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const oM="recaptcha-enterprise",Hk="NO_RECAPTCHA";class cM{constructor(e){this.type=oM,this.auth=Ba(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{U5(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new V5(c);return i.tenantId==null?i._agentRecaptchaConfig=l:i._tenantRecaptchaConfigs[i.tenantId]=l,a(l.siteKey)}}).catch(c=>{o(c)})})}function s(i,a,o){const c=window.grecaptcha;z_(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(l=>{a(l)}).catch(()=>{a(Hk)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new iM().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&z_(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=rM();c.length!==0&&(c+=o),zk(c).then(()=>{s(o,i,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function q_(t,e,r,n=!1,s=!1){const i=new cM(t);let a;if(s)a=Hk;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function qp(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await q_(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await q_(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(t,e){const r=Ua(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Oi(i,e??{}))return s;Wn(s,"already-initialized")}return r.initialize({options:e})}function uM(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ps);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function fM(t,e,r){const n=Ba(t);Oe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=$k(e),{host:a,port:o}=hM(e),c=o===null?"":`:${o}`,l={url:`${i}//${a}${c}/`},f=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Oe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Oe(Oi(l,n.config.emulator)&&Oi(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ec(a)?(pk(`${i}//${a}${c}`),mk("Auth",!0)):dM()}function $k(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function hM(t){const e=$k(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:X_(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:X_(a)}}}function X_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dM(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Rs("not implemented")}_getIdTokenResponse(e){return Rs("not implemented")}_linkToIdToken(e,r){return Rs("not implemented")}_getReauthenticationResolver(e){return Rs("not implemented")}}async function pM(t,e){return Ks(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mM(t,e){return au(t,"POST","/v1/accounts:signInWithPassword",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gM(t,e){return au(t,"POST","/v1/accounts:signInWithEmailLink",Wi(t,e))}async function xM(t,e){return au(t,"POST","/v1/accounts:signInWithEmailLink",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul extends Hg{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Ul(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Ul(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return qp(e,r,"signInWithPassword",mM);case"emailLink":return gM(e,{email:this._email,oobCode:this._password});default:Wn(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return qp(e,n,"signUpPassword",pM);case"emailLink":return xM(e,{idToken:r,email:this._email,oobCode:this._password});default:Wn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(t,e){return au(t,"POST","/v1/accounts:signInWithIdp",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM="http://localhost";class ka extends Hg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ka(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new ka(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ro(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ro(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ro(e,r)}buildRequest(){const e={requestUri:vM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=su(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yM(t){const e=bc(Lc(t)).link,r=e?bc(Lc(e)).deep_link_id:null,n=bc(Lc(t)).deep_link_id;return(n?bc(Lc(n)).link:null)||n||r||e||t}class $g{constructor(e){const r=bc(Lc(e)),n=r.apiKey??null,s=r.oobCode??null,i=_M(r.mode??null);Oe(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=yM(e);try{return new $g(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,r){return Ul._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=$g.parseLink(r);return Oe(n,"argument-error"),Ul._fromEmailAndCode(e,n.code,n.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends Wk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends ou{constructor(){super("facebook.com")}static credential(e){return ka._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.FACEBOOK_SIGN_IN_METHOD="facebook.com";oi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci extends ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ka._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ci.credential(r,n)}catch{return null}}}ci.GOOGLE_SIGN_IN_METHOD="google.com";ci.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends ou{constructor(){super("github.com")}static credential(e){return ka._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return li.credential(e.oauthAccessToken)}catch{return null}}}li.GITHUB_SIGN_IN_METHOD="github.com";li.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends ou{constructor(){super("twitter.com")}static credential(e,r){return ka._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ui.credential(r,n)}catch{return null}}}ui.TWITTER_SIGN_IN_METHOD="twitter.com";ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EM(t,e){return au(t,"POST","/v1/accounts:signUp",Wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Un._fromIdTokenResponse(e,n,s),a=Y_(n);return new Aa({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=Y_(n);return new Aa({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function Y_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh extends qn{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Eh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Eh(e,r,n,s)}}function Gk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Eh._fromErrorAndOperation(t,i,e,n):i})}async function wM(t,e,r=!1){const n=await jo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Aa._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TM(t,e,r=!1){const{auth:n}=t;if(_n(n.app))return Promise.reject(Os(n));const s="reauthenticate";try{const i=await jo(t,Gk(n,s,e,t),r);Oe(i.idToken,n,"internal-error");const a=jg(i.idToken);Oe(a,n,"internal-error");const{sub:o}=a;return Oe(t.uid===o,n,"user-mismatch"),Aa._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Wn(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(t,e,r=!1){if(_n(t.app))return Promise.reject(Os(t));const n="signIn",s=await Gk(t,n,e),i=await Aa._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function kM(t,e){return Kk(Ba(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qk(t){const e=Ba(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function AM(t,e,r){if(_n(t.app))return Promise.reject(Os(t));const n=Ba(t),a=await qp(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",EM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&qk(t),c}),o=await Aa._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function SM(t,e,r){return _n(t.app)?Promise.reject(Os(t)):kM(Lt(t),rc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&qk(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IM(t,e){return Ks(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CM(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Lt(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await jo(n,IM(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:c})=>c==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function RM(t,e,r,n){return Lt(t).onIdTokenChanged(e,r,n)}function PM(t,e,r){return Lt(t).beforeAuthStateChanged(e,r)}function NM(t,e,r,n){return Lt(t).onAuthStateChanged(e,r,n)}function FM(t){return Lt(t).signOut()}const wh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(wh,"1"),this.storage.removeItem(wh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DM=1e3,OM=10;class Yk extends Xk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);X5()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,OM):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},DM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Yk.type="LOCAL";const bM=Yk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk extends Xk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Qk.type="SESSION";const Jk=Qk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new o0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async l=>l(r.origin,i)),c=await LM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}o0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,c)=>{const l=Wg("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(d.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(){return window}function VM(t){cs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(){return typeof cs().WorkerGlobalScope<"u"&&typeof cs().importScripts=="function"}async function UM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function BM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function jM(){return Zk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="firebaseLocalStorageDb",zM=1,Th="firebaseLocalStorage",tA="fbase_key";class cu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function c0(t,e){return t.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function HM(){const t=indexedDB.deleteDatabase(eA);return new cu(t).toPromise()}function Xp(){const t=indexedDB.open(eA,zM);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Th,{keyPath:tA})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Th)?e(n):(n.close(),await HM(),e(await Xp()))})})}async function Q_(t,e,r){const n=c0(t,!0).put({[tA]:e,value:r});return new cu(n).toPromise()}async function $M(t,e){const r=c0(t,!1).get(e),n=await new cu(r).toPromise();return n===void 0?null:n.value}function J_(t,e){const r=c0(t,!0).delete(e);return new cu(r).toPromise()}const WM=800,GM=3;class rA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>GM)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=o0._getInstance(jM()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await UM(),!this.activeServiceWorker)return;this.sender=new MM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||BM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xp();return await Q_(e,wh,"1"),await J_(e,wh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Q_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>$M(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>J_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=c0(s,!1).getAll();return new cu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rA.type="LOCAL";const KM=rA;new iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t,e){return e?Ps(e):(Oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg extends Hg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ro(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ro(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ro(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function XM(t){return Kk(t.auth,new Gg(t),t.bypassAuthState)}function YM(t){const{auth:e,user:r}=t;return Oe(r,e,"internal-error"),TM(r,new Gg(t),t.bypassAuthState)}async function QM(t){const{auth:e,user:r}=t;return Oe(r,e,"internal-error"),wM(r,new Gg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XM;case"linkViaPopup":case"linkViaRedirect":return QM;case"reauthViaPopup":case"reauthViaRedirect":return YM;default:Wn(this.auth,"internal-error")}}resolve(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM=new iu(2e3,1e4);class xo extends nA{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,xo.currentPopupAction&&xo.currentPopupAction.cancel(),xo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){zs(this.filter.length===1,"Popup operations only handle one event");const e=Wg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JM.get())};e()}}xo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZM="pendingRedirect",Sf=new Map;class e9 extends nA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Sf.get(this.auth._key());if(!e){try{const n=await t9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Sf.set(this.auth._key(),e)}return this.bypassAuthState||Sf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t9(t,e){const r=s9(e),n=n9(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function r9(t,e){Sf.set(t._key(),e)}function n9(t){return Ps(t._redirectPersistence)}function s9(t){return Af(ZM,t.config.apiKey,t.name)}async function i9(t,e,r=!1){if(_n(t.app))return Promise.reject(Os(t));const n=Ba(t),s=qM(n,e),a=await new e9(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a9=10*60*1e3;class o9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c9(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!sA(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(os(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=a9&&this.cachedEventUids.clear(),this.cachedEventUids.has(Z_(e))}saveEventToCache(e){this.cachedEventUids.add(Z_(e)),this.lastProcessedEventTime=Date.now()}}function Z_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function c9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l9(t,e={}){return Ks(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f9=/^https?/;async function h9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await l9(t);for(const r of e)try{if(d9(r))return}catch{}Wn(t,"unauthorized-domain")}function d9(t){const e=Gp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!f9.test(r))return!1;if(u9.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=new iu(3e4,6e4);function ey(){const t=cs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function m9(t){return new Promise((e,r)=>{var s,i,a;function n(){ey(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ey(),r(os(t,"network-request-failed"))},timeout:p9.get()})}if((i=(s=cs().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=cs().gapi)!=null&&a.load)n();else{const o=sM("iframefcb");return cs()[o]=()=>{gapi.load?n():r(os(t,"network-request-failed"))},zk(`${nM()}?onload=${o}`).catch(c=>r(c))}}).catch(e=>{throw If=null,e})}let If=null;function g9(t){return If=If||m9(t),If}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9=new iu(5e3,15e3),v9="__/auth/iframe",_9="emulator/auth/iframe",y9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w9(t){const e=t.config;Oe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Bg(e,_9):`https://${t.config.authDomain}/${v9}`,n={apiKey:e.apiKey,appName:t.name,v:tc},s=E9.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${su(n).slice(1)}`}async function T9(t){const e=await g9(t),r=cs().gapi;return Oe(r,t,"internal-error"),e.open({where:document.body,url:w9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y9,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=os(t,"network-request-failed"),o=cs().setTimeout(()=>{i(a)},x9.get());function c(){cs().clearTimeout(o),s(n)}n.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},A9=500,S9=600,I9="_blank",C9="http://localhost";class ty{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function R9(t,e,r,n=A9,s=S9){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...k9,width:n.toString(),height:s.toString(),top:i,left:a},l=Nr().toLowerCase();r&&(o=bk(l)?I9:r),Dk(l)&&(e=e||C9,c.scrollbars="yes");const f=Object.entries(c).reduce((d,[m,g])=>`${d}${m}=${g},`,"");if(q5(l)&&o!=="_self")return P9(e||"",o),new ty(null);const h=window.open(e||"",o,f);Oe(h,t,"popup-blocked");try{h.focus()}catch{}return new ty(h)}function P9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9="__/auth/handler",F9="emulator/auth/handler",D9=encodeURIComponent("fac");async function ry(t,e,r,n,s,i){Oe(t.config.authDomain,t,"auth-domain-config-required"),Oe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:tc,eventId:s};if(e instanceof Wk){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",dL(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof ou){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const c=await t._getAppCheckToken(),l=c?`#${D9}=${encodeURIComponent(c)}`:"";return`${O9(t)}?${su(o).slice(1)}${l}`}function O9({config:t}){return t.emulator?Bg(t,F9):`https://${t.authDomain}/${N9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id="webStorageSupport";class b9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Jk,this._completeRedirectFn=i9,this._overrideRedirectResult=r9}async _openPopup(e,r,n,s){var a;zs((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await ry(e,r,n,Gp(),s);return R9(e,i,Wg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await ry(e,r,n,Gp(),s);return VM(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(zs(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await T9(e),n=new o9(e);return r.register("authEvent",s=>(Oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Id,{type:Id},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Id];i!==void 0&&r(!!i),Wn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=h9(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Bk()||Ok()||zg()}}const L9=b9;var ny="@firebase/auth",sy="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function U9(t){ps(new $n("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Oe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jk(t)},l=new eM(n,s,i,c);return uM(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ps(new $n("auth-internal",e=>{const r=Ba(e.getProvider("auth").getImmediate());return(n=>new M9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tn(ny,sy,V9(t)),Tn(ny,sy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9=5*60,j9=dk("authIdTokenMaxAge")||B9;let iy=null;const z9=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>j9)return;const s=r==null?void 0:r.token;iy!==s&&(iy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function H9(t=Vg()){const e=Ua(t,"auth");if(e.isInitialized())return e.getImmediate();const r=lM(t,{popupRedirectResolver:L9,persistence:[KM,bM,Jk]}),n=dk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=z9(i.toString());PM(r,a,()=>a(r.currentUser)),RM(r,o=>a(o))}}const s=fk("auth");return s&&fM(r,`http://${s}`),r}function $9(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}tM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=os("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",$9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});U9("Browser");var W9="firebase",G9="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn(W9,G9,"app");var ay=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ii,iA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,k){function A(){}A.prototype=k.prototype,_.D=k.prototype,_.prototype=new A,_.prototype.constructor=_,_.C=function(I,P,C){for(var F=Array(arguments.length-2),me=2;me<arguments.length;me++)F[me-2]=arguments[me];return k.prototype[P].apply(I,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,k,A){A||(A=0);var I=Array(16);if(typeof k=="string")for(var P=0;16>P;++P)I[P]=k.charCodeAt(A++)|k.charCodeAt(A++)<<8|k.charCodeAt(A++)<<16|k.charCodeAt(A++)<<24;else for(P=0;16>P;++P)I[P]=k[A++]|k[A++]<<8|k[A++]<<16|k[A++]<<24;k=_.g[0],A=_.g[1],P=_.g[2];var C=_.g[3],F=k+(C^A&(P^C))+I[0]+3614090360&4294967295;k=A+(F<<7&4294967295|F>>>25),F=C+(P^k&(A^P))+I[1]+3905402710&4294967295,C=k+(F<<12&4294967295|F>>>20),F=P+(A^C&(k^A))+I[2]+606105819&4294967295,P=C+(F<<17&4294967295|F>>>15),F=A+(k^P&(C^k))+I[3]+3250441966&4294967295,A=P+(F<<22&4294967295|F>>>10),F=k+(C^A&(P^C))+I[4]+4118548399&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(P^k&(A^P))+I[5]+1200080426&4294967295,C=k+(F<<12&4294967295|F>>>20),F=P+(A^C&(k^A))+I[6]+2821735955&4294967295,P=C+(F<<17&4294967295|F>>>15),F=A+(k^P&(C^k))+I[7]+4249261313&4294967295,A=P+(F<<22&4294967295|F>>>10),F=k+(C^A&(P^C))+I[8]+1770035416&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(P^k&(A^P))+I[9]+2336552879&4294967295,C=k+(F<<12&4294967295|F>>>20),F=P+(A^C&(k^A))+I[10]+4294925233&4294967295,P=C+(F<<17&4294967295|F>>>15),F=A+(k^P&(C^k))+I[11]+2304563134&4294967295,A=P+(F<<22&4294967295|F>>>10),F=k+(C^A&(P^C))+I[12]+1804603682&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(P^k&(A^P))+I[13]+4254626195&4294967295,C=k+(F<<12&4294967295|F>>>20),F=P+(A^C&(k^A))+I[14]+2792965006&4294967295,P=C+(F<<17&4294967295|F>>>15),F=A+(k^P&(C^k))+I[15]+1236535329&4294967295,A=P+(F<<22&4294967295|F>>>10),F=k+(P^C&(A^P))+I[1]+4129170786&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^P&(k^A))+I[6]+3225465664&4294967295,C=k+(F<<9&4294967295|F>>>23),F=P+(k^A&(C^k))+I[11]+643717713&4294967295,P=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(P^C))+I[0]+3921069994&4294967295,A=P+(F<<20&4294967295|F>>>12),F=k+(P^C&(A^P))+I[5]+3593408605&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^P&(k^A))+I[10]+38016083&4294967295,C=k+(F<<9&4294967295|F>>>23),F=P+(k^A&(C^k))+I[15]+3634488961&4294967295,P=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(P^C))+I[4]+3889429448&4294967295,A=P+(F<<20&4294967295|F>>>12),F=k+(P^C&(A^P))+I[9]+568446438&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^P&(k^A))+I[14]+3275163606&4294967295,C=k+(F<<9&4294967295|F>>>23),F=P+(k^A&(C^k))+I[3]+4107603335&4294967295,P=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(P^C))+I[8]+1163531501&4294967295,A=P+(F<<20&4294967295|F>>>12),F=k+(P^C&(A^P))+I[13]+2850285829&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^P&(k^A))+I[2]+4243563512&4294967295,C=k+(F<<9&4294967295|F>>>23),F=P+(k^A&(C^k))+I[7]+1735328473&4294967295,P=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(P^C))+I[12]+2368359562&4294967295,A=P+(F<<20&4294967295|F>>>12),F=k+(A^P^C)+I[5]+4294588738&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^P)+I[8]+2272392833&4294967295,C=k+(F<<11&4294967295|F>>>21),F=P+(C^k^A)+I[11]+1839030562&4294967295,P=C+(F<<16&4294967295|F>>>16),F=A+(P^C^k)+I[14]+4259657740&4294967295,A=P+(F<<23&4294967295|F>>>9),F=k+(A^P^C)+I[1]+2763975236&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^P)+I[4]+1272893353&4294967295,C=k+(F<<11&4294967295|F>>>21),F=P+(C^k^A)+I[7]+4139469664&4294967295,P=C+(F<<16&4294967295|F>>>16),F=A+(P^C^k)+I[10]+3200236656&4294967295,A=P+(F<<23&4294967295|F>>>9),F=k+(A^P^C)+I[13]+681279174&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^P)+I[0]+3936430074&4294967295,C=k+(F<<11&4294967295|F>>>21),F=P+(C^k^A)+I[3]+3572445317&4294967295,P=C+(F<<16&4294967295|F>>>16),F=A+(P^C^k)+I[6]+76029189&4294967295,A=P+(F<<23&4294967295|F>>>9),F=k+(A^P^C)+I[9]+3654602809&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^P)+I[12]+3873151461&4294967295,C=k+(F<<11&4294967295|F>>>21),F=P+(C^k^A)+I[15]+530742520&4294967295,P=C+(F<<16&4294967295|F>>>16),F=A+(P^C^k)+I[2]+3299628645&4294967295,A=P+(F<<23&4294967295|F>>>9),F=k+(P^(A|~C))+I[0]+4096336452&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~P))+I[7]+1126891415&4294967295,C=k+(F<<10&4294967295|F>>>22),F=P+(k^(C|~A))+I[14]+2878612391&4294967295,P=C+(F<<15&4294967295|F>>>17),F=A+(C^(P|~k))+I[5]+4237533241&4294967295,A=P+(F<<21&4294967295|F>>>11),F=k+(P^(A|~C))+I[12]+1700485571&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~P))+I[3]+2399980690&4294967295,C=k+(F<<10&4294967295|F>>>22),F=P+(k^(C|~A))+I[10]+4293915773&4294967295,P=C+(F<<15&4294967295|F>>>17),F=A+(C^(P|~k))+I[1]+2240044497&4294967295,A=P+(F<<21&4294967295|F>>>11),F=k+(P^(A|~C))+I[8]+1873313359&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~P))+I[15]+4264355552&4294967295,C=k+(F<<10&4294967295|F>>>22),F=P+(k^(C|~A))+I[6]+2734768916&4294967295,P=C+(F<<15&4294967295|F>>>17),F=A+(C^(P|~k))+I[13]+1309151649&4294967295,A=P+(F<<21&4294967295|F>>>11),F=k+(P^(A|~C))+I[4]+4149444226&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~P))+I[11]+3174756917&4294967295,C=k+(F<<10&4294967295|F>>>22),F=P+(k^(C|~A))+I[2]+718787259&4294967295,P=C+(F<<15&4294967295|F>>>17),F=A+(C^(P|~k))+I[9]+3951481745&4294967295,_.g[0]=_.g[0]+k&4294967295,_.g[1]=_.g[1]+(P+(F<<21&4294967295|F>>>11))&4294967295,_.g[2]=_.g[2]+P&4294967295,_.g[3]=_.g[3]+C&4294967295}n.prototype.u=function(_,k){k===void 0&&(k=_.length);for(var A=k-this.blockSize,I=this.B,P=this.h,C=0;C<k;){if(P==0)for(;C<=A;)s(this,_,C),C+=this.blockSize;if(typeof _=="string"){for(;C<k;)if(I[P++]=_.charCodeAt(C++),P==this.blockSize){s(this,I),P=0;break}}else for(;C<k;)if(I[P++]=_[C++],P==this.blockSize){s(this,I),P=0;break}}this.h=P,this.o+=k},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var k=1;k<_.length-8;++k)_[k]=0;var A=8*this.o;for(k=_.length-8;k<_.length;++k)_[k]=A&255,A/=256;for(this.u(_),_=Array(16),k=A=0;4>k;++k)for(var I=0;32>I;I+=8)_[A++]=this.g[k]>>>I&255;return _};function i(_,k){var A=o;return Object.prototype.hasOwnProperty.call(A,_)?A[_]:A[_]=k(_)}function a(_,k){this.h=k;for(var A=[],I=!0,P=_.length-1;0<=P;P--){var C=_[P]|0;I&&C==k||(A[P]=C,I=!1)}this.g=A}var o={};function c(_){return-128<=_&&128>_?i(_,function(k){return new a([k|0],0>k?-1:0)}):new a([_|0],0>_?-1:0)}function l(_){if(isNaN(_)||!isFinite(_))return h;if(0>_)return E(l(-_));for(var k=[],A=1,I=0;_>=A;I++)k[I]=_/A|0,A*=4294967296;return new a(k,0)}function f(_,k){if(_.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(_.charAt(0)=="-")return E(f(_.substring(1),k));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=l(Math.pow(k,8)),I=h,P=0;P<_.length;P+=8){var C=Math.min(8,_.length-P),F=parseInt(_.substring(P,P+C),k);8>C?(C=l(Math.pow(k,C)),I=I.j(C).add(l(F))):(I=I.j(A),I=I.add(l(F)))}return I}var h=c(0),d=c(1),m=c(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var _=0,k=1,A=0;A<this.g.length;A++){var I=this.i(A);_+=(0<=I?I:4294967296+I)*k,k*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(g(this))return"0";if(x(this))return"-"+E(this).toString(_);for(var k=l(Math.pow(_,6)),A=this,I="";;){var P=O(A,k).g;A=T(A,P.j(k));var C=((0<A.g.length?A.g[0]:A.h)>>>0).toString(_);if(A=P,g(A))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function g(_){if(_.h!=0)return!1;for(var k=0;k<_.g.length;k++)if(_.g[k]!=0)return!1;return!0}function x(_){return _.h==-1}t.l=function(_){return _=T(this,_),x(_)?-1:g(_)?0:1};function E(_){for(var k=_.g.length,A=[],I=0;I<k;I++)A[I]=~_.g[I];return new a(A,~_.h).add(d)}t.abs=function(){return x(this)?E(this):this},t.add=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0,P=0;P<=k;P++){var C=I+(this.i(P)&65535)+(_.i(P)&65535),F=(C>>>16)+(this.i(P)>>>16)+(_.i(P)>>>16);I=F>>>16,C&=65535,F&=65535,A[P]=F<<16|C}return new a(A,A[A.length-1]&-2147483648?-1:0)};function T(_,k){return _.add(E(k))}t.j=function(_){if(g(this)||g(_))return h;if(x(this))return x(_)?E(this).j(E(_)):E(E(this).j(_));if(x(_))return E(this.j(E(_)));if(0>this.l(m)&&0>_.l(m))return l(this.m()*_.m());for(var k=this.g.length+_.g.length,A=[],I=0;I<2*k;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<_.g.length;P++){var C=this.i(I)>>>16,F=this.i(I)&65535,me=_.i(P)>>>16,he=_.i(P)&65535;A[2*I+2*P]+=F*he,w(A,2*I+2*P),A[2*I+2*P+1]+=C*he,w(A,2*I+2*P+1),A[2*I+2*P+1]+=F*me,w(A,2*I+2*P+1),A[2*I+2*P+2]+=C*me,w(A,2*I+2*P+2)}for(I=0;I<k;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=k;I<2*k;I++)A[I]=0;return new a(A,0)};function w(_,k){for(;(_[k]&65535)!=_[k];)_[k+1]+=_[k]>>>16,_[k]&=65535,k++}function v(_,k){this.g=_,this.h=k}function O(_,k){if(g(k))throw Error("division by zero");if(g(_))return new v(h,h);if(x(_))return k=O(E(_),k),new v(E(k.g),E(k.h));if(x(k))return k=O(_,E(k)),new v(E(k.g),k.h);if(30<_.g.length){if(x(_)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var A=d,I=k;0>=I.l(_);)A=z(A),I=z(I);var P=U(A,1),C=U(I,1);for(I=U(I,2),A=U(A,2);!g(I);){var F=C.add(I);0>=F.l(_)&&(P=P.add(A),C=F),I=U(I,1),A=U(A,1)}return k=T(_,P.j(k)),new v(P,k)}for(P=h;0<=_.l(k);){for(A=Math.max(1,Math.floor(_.m()/k.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=l(A),F=C.j(k);x(F)||0<F.l(_);)A-=I,C=l(A),F=C.j(k);g(C)&&(C=d),P=P.add(C),_=T(_,F)}return new v(P,_)}t.A=function(_){return O(this,_).h},t.and=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)&_.i(I);return new a(A,this.h&_.h)},t.or=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)|_.i(I);return new a(A,this.h|_.h)},t.xor=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)^_.i(I);return new a(A,this.h^_.h)};function z(_){for(var k=_.g.length+1,A=[],I=0;I<k;I++)A[I]=_.i(I)<<1|_.i(I-1)>>>31;return new a(A,_.h)}function U(_,k){var A=k>>5;k%=32;for(var I=_.g.length-A,P=[],C=0;C<I;C++)P[C]=0<k?_.i(C+A)>>>k|_.i(C+A+1)<<32-k:_.i(C+A);return new a(P,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,iA=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=f,Ii=a}).apply(typeof ay<"u"?ay:typeof self<"u"?self:typeof window<"u"?window:{});var sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var aA,Mc,oA,Cf,Yp,cA,lA,uA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,y){return u==Array.prototype||u==Object.prototype||(u[p]=y.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof sf=="object"&&sf];for(var p=0;p<u.length;++p){var y=u[p];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=r(this);function s(u,p){if(p)e:{var y=n;u=u.split(".");for(var N=0;N<u.length-1;N++){var q=u[N];if(!(q in y))break e;y=y[q]}u=u[u.length-1],N=y[u],p=p(N),p!=N&&p!=null&&e(y,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var y=0,N=!1,q={next:function(){if(!N&&y<u.length){var ee=y++;return{value:p(ee,u[ee]),done:!1}}return N=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function l(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function f(u,p,y){return u.call.apply(u.bind,arguments)}function h(u,p,y){if(!u)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,N),u.apply(p,q)}}return function(){return u.apply(p,arguments)}}function d(u,p,y){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,p){var y=Array.prototype.slice.call(arguments,1);return function(){var N=y.slice();return N.push.apply(N,arguments),u.apply(this,N)}}function g(u,p){function y(){}y.prototype=p.prototype,u.aa=p.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(N,q,ee){for(var ve=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)ve[ht-2]=arguments[ht];return p.prototype[q].apply(N,ve)}}function x(u){const p=u.length;if(0<p){const y=Array(p);for(let N=0;N<p;N++)y[N]=u[N];return y}return[]}function E(u,p){for(let y=1;y<arguments.length;y++){const N=arguments[y];if(c(N)){const q=u.length||0,ee=N.length||0;u.length=q+ee;for(let ve=0;ve<ee;ve++)u[q+ve]=N[ve]}else u.push(N)}}class T{constructor(p,y){this.i=p,this.j=y,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(u){return/^[\s\xa0]*$/.test(u)}function v(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var z=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function U(u,p,y){for(const N in u)p.call(y,u[N],N,u)}function _(u,p){for(const y in u)p.call(void 0,u[y],y,u)}function k(u){const p={};for(const y in u)p[y]=u[y];return p}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,p){let y,N;for(let q=1;q<arguments.length;q++){N=arguments[q];for(y in N)u[y]=N[y];for(let ee=0;ee<A.length;ee++)y=A[ee],Object.prototype.hasOwnProperty.call(N,y)&&(u[y]=N[y])}}function P(u){var p=1;u=u.split(":");const y=[];for(;0<p&&u.length;)y.push(u.shift()),p--;return u.length&&y.push(u.join(":")),y}function C(u){o.setTimeout(()=>{throw u},0)}function F(){var u=W;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class me{constructor(){this.h=this.g=null}add(p,y){const N=he.get();N.set(p,y),this.h?this.h.next=N:this.g=N,this.h=N}}var he=new T(()=>new Ce,u=>u.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(p,y){this.h=p,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,ie=!1,W=new me,fe=()=>{const u=o.Promise.resolve(void 0);_e=()=>{u.then(ke)}};var ke=()=>{for(var u;u=F();){try{u.h.call(u.g)}catch(y){C(y)}var p=he;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ie=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const y=()=>{};o.addEventListener("test",y,p),o.removeEventListener("test",y,p)}catch{}return u}();function H(u,p){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,N=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(z){e:{try{O(p.nodeName);var q=!0;break e}catch{}q=!1}q||(p=null)}}else y=="mouseover"?p=u.fromElement:y=="mouseout"&&(p=u.toElement);this.relatedTarget=p,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:re[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}g(H,K);var re={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function ge(u,p,y,N,q){this.listener=u,this.proxy=null,this.src=p,this.type=y,this.capture=!!N,this.ha=q,this.key=++Ae,this.da=this.fa=!1}function ae(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function He(u){this.src=u,this.g={},this.h=0}He.prototype.add=function(u,p,y,N,q){var ee=u.toString();u=this.g[ee],u||(u=this.g[ee]=[],this.h++);var ve=lt(u,p,N,q);return-1<ve?(p=u[ve],y||(p.fa=!1)):(p=new ge(p,this.src,ee,!!N,q),p.fa=y,u.push(p)),p};function j(u,p){var y=p.type;if(y in u.g){var N=u.g[y],q=Array.prototype.indexOf.call(N,p,void 0),ee;(ee=0<=q)&&Array.prototype.splice.call(N,q,1),ee&&(ae(p),u.g[y].length==0&&(delete u.g[y],u.h--))}}function lt(u,p,y,N){for(var q=0;q<u.length;++q){var ee=u[q];if(!ee.da&&ee.listener==p&&ee.capture==!!y&&ee.ha==N)return q}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),et={};function je(u,p,y,N,q){if(Array.isArray(p)){for(var ee=0;ee<p.length;ee++)je(u,p[ee],y,N,q);return null}return y=Hr(y),u&&u[de]?u.K(p,y,l(N)?!!N.capture:!1,q):ye(u,p,y,!1,N,q)}function ye(u,p,y,N,q,ee){if(!p)throw Error("Invalid event type");var ve=l(q)?!!q.capture:!!q,ht=mr(u);if(ht||(u[$e]=ht=new He(u)),y=ht.add(p,y,N,ve,ee),y.proxy)return y;if(N=nt(),y.proxy=N,N.src=u,N.listener=y,u.addEventListener)G||(q=ve),q===void 0&&(q=!1),u.addEventListener(p.toString(),N,q);else if(u.attachEvent)u.attachEvent(zr(p.toString()),N);else if(u.addListener&&u.removeListener)u.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return y}function nt(){function u(y){return p.call(u.src,u.listener,y)}const p=vs;return u}function nr(u,p,y,N,q){if(Array.isArray(p))for(var ee=0;ee<p.length;ee++)nr(u,p[ee],y,N,q);else N=l(N)?!!N.capture:!!N,y=Hr(y),u&&u[de]?(u=u.i,p=String(p).toString(),p in u.g&&(ee=u.g[p],y=lt(ee,y,N,q),-1<y&&(ae(ee[y]),Array.prototype.splice.call(ee,y,1),ee.length==0&&(delete u.g[p],u.h--)))):u&&(u=mr(u))&&(p=u.g[p.toString()],u=-1,p&&(u=lt(p,y,N,q)),(y=-1<u?p[u]:null)&&$t(y))}function $t(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[de])j(p.i,u);else{var y=u.type,N=u.proxy;p.removeEventListener?p.removeEventListener(y,N,u.capture):p.detachEvent?p.detachEvent(zr(y),N):p.addListener&&p.removeListener&&p.removeListener(N),(y=mr(p))?(j(y,u),y.h==0&&(y.src=null,p[$e]=null)):ae(u)}}}function zr(u){return u in et?et[u]:et[u]="on"+u}function vs(u,p){if(u.da)u=!0;else{p=new H(p,this);var y=u.listener,N=u.ha||u.src;u.fa&&$t(u),u=y.call(N,p)}return u}function mr(u){return u=u[$e],u instanceof He?u:null}var Wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hr(u){return typeof u=="function"?u:(u[Wt]||(u[Wt]=function(p){return u.handleEvent(p)}),u[Wt])}function ut(){L.call(this),this.i=new He(this),this.M=this,this.F=null}g(ut,L),ut.prototype[de]=!0,ut.prototype.removeEventListener=function(u,p,y,N){nr(this,u,p,y,N)};function Z(u,p){var y,N=u.F;if(N)for(y=[];N;N=N.F)y.push(N);if(u=u.M,N=p.type||p,typeof p=="string")p=new K(p,u);else if(p instanceof K)p.target=p.target||u;else{var q=p;p=new K(N,u),I(p,q)}if(q=!0,y)for(var ee=y.length-1;0<=ee;ee--){var ve=p.g=y[ee];q=oe(ve,N,!0,p)&&q}if(ve=p.g=u,q=oe(ve,N,!0,p)&&q,q=oe(ve,N,!1,p)&&q,y)for(ee=0;ee<y.length;ee++)ve=p.g=y[ee],q=oe(ve,N,!1,p)&&q}ut.prototype.N=function(){if(ut.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var y=u.g[p],N=0;N<y.length;N++)ae(y[N]);delete u.g[p],u.h--}}this.F=null},ut.prototype.K=function(u,p,y,N){return this.i.add(String(u),p,!1,y,N)},ut.prototype.L=function(u,p,y,N){return this.i.add(String(u),p,!0,y,N)};function oe(u,p,y,N){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var q=!0,ee=0;ee<p.length;++ee){var ve=p[ee];if(ve&&!ve.da&&ve.capture==y){var ht=ve.listener,ir=ve.ha||ve.src;ve.fa&&j(u.i,ve),q=ht.call(ir,N)!==!1&&q}}return q&&!N.defaultPrevented}function we(u,p,y){if(typeof u=="function")y&&(u=d(u,y));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function ce(u){u.g=we(()=>{u.g=null,u.i&&(u.i=!1,ce(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Te extends L{constructor(p,y){super(),this.m=p,this.l=y,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ce(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pe(u){L.call(this),this.h=u,this.g={}}g(Pe,L);var De=[];function it(u){U(u.g,function(p,y){this.g.hasOwnProperty(y)&&$t(p)},u),u.g={}}Pe.prototype.N=function(){Pe.aa.N.call(this),it(this)},Pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dn=o.JSON.stringify,cc=o.JSON.parse,R0=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function $a(){}$a.prototype.h=null;function lc(u){return u.h||(u.h=u.i())}function uc(){}var qi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fc(){K.call(this,"d")}g(fc,K);function qs(){K.call(this,"c")}g(qs,K);var _s={},gu=null;function Wa(){return gu=gu||new ut}_s.La="serverreachability";function xu(u){K.call(this,_s.La,u)}g(xu,K);function Xi(u){const p=Wa();Z(p,new xu(p))}_s.STAT_EVENT="statevent";function vu(u,p){K.call(this,_s.STAT_EVENT,u),this.stat=p}g(vu,K);function sr(u){const p=Wa();Z(p,new vu(p,u))}_s.Ma="timingevent";function _u(u,p){K.call(this,_s.Ma,u),this.size=p}g(_u,K);function ys(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function Yi(){this.g=!0}Yi.prototype.xa=function(){this.g=!1};function P0(u,p,y,N,q,ee){u.info(function(){if(u.g)if(ee)for(var ve="",ht=ee.split("&"),ir=0;ir<ht.length;ir++){var st=ht[ir].split("=");if(1<st.length){var gr=st[0];st=st[1];var xr=gr.split("_");ve=2<=xr.length&&xr[1]=="type"?ve+(gr+"="+st+"&"):ve+(gr+"=redacted&")}}else ve=null;else ve=ee;return"XMLHTTP REQ ("+N+") [attempt "+q+"]: "+p+`
`+y+`
`+ve})}function N0(u,p,y,N,q,ee,ve){u.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+q+"]: "+p+`
`+y+`
`+ee+" "+ve})}function S(u,p,y,N){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+D(u,y)+(N?" "+N:"")})}function M(u,p){u.info(function(){return"TIMEOUT: "+p})}Yi.prototype.info=function(){};function D(u,p){if(!u.g)return p;if(!p)return null;try{var y=JSON.parse(p);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var N=y[u];if(!(2>N.length)){var q=N[1];if(Array.isArray(q)&&!(1>q.length)){var ee=q[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var ve=1;ve<q.length;ve++)q[ve]=""}}}}return dn(y)}catch{return p}}var b={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},B;function X(){}g(X,$a),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},B=new X;function te(u,p,y,N){this.j=u,this.i=p,this.l=y,this.R=N||1,this.U=new Pe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},J={};function le(u,p,y){u.L=1,u.v=wu(ws(p)),u.m=y,u.P=!0,xe(u,null)}function xe(u,p){u.F=Date.now(),Ee(u),u.A=ws(u.v);var y=u.A,N=u.R;Array.isArray(N)||(N=[String(N)]),z1(y.i,"t",N),u.C=0,y=u.j.J,u.h=new Y,u.g=ax(u.j,y?p:null,!u.m),0<u.O&&(u.M=new Te(d(u.Y,u,u.g),u.O)),p=u.U,y=u.g,N=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(De[0]=q.toString()),q=De);for(var ee=0;ee<q.length;ee++){var ve=je(y,q[ee],N||p.handleEvent,!1,p.h||p);if(!ve)break;p.g[ve.key]=ve}p=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Xi(),P0(u.i,u.u,u.A,u.l,u.R,u.m)}te.prototype.ca=function(u){u=u.target;const p=this.M;p&&Ts(u)==3?p.j():this.Y(u)},te.prototype.Y=function(u){try{if(u==this.g)e:{const xr=Ts(this.g);var p=this.g.Ba();const Xa=this.g.Z();if(!(3>xr)&&(xr!=3||this.g&&(this.h.h||this.g.oa()||X1(this.g)))){this.J||xr!=4||p==7||(p==8||0>=Xa?Xi(3):Xi(2)),ft(this);var y=this.g.Z();this.X=y;t:if(Ie(this)){var N=X1(this.g);u="";var q=N.length,ee=Ts(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yt(this),ot(this);var ve="";break t}this.h.i=new o.TextDecoder}for(p=0;p<q;p++)this.h.h=!0,u+=this.h.i.decode(N[p],{stream:!(ee&&p==q-1)});N.length=0,this.h.g+=u,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=y==200,N0(this.i,this.u,this.A,this.l,this.R,xr,y),this.o){if(this.T&&!this.K){t:{if(this.g){var ht,ir=this.g;if((ht=ir.g?ir.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(ht)){var st=ht;break t}}st=null}if(y=st)S(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Es(this,y);else{this.o=!1,this.s=3,sr(12),yt(this),ot(this);break e}}if(this.P){y=!0;let Rn;for(;!this.J&&this.C<ve.length;)if(Rn=pe(this,ve),Rn==J){xr==4&&(this.s=4,sr(14),y=!1),S(this.i,this.l,null,"[Incomplete Response]");break}else if(Rn==Q){this.s=4,sr(15),S(this.i,this.l,ve,"[Invalid Chunk]"),y=!1;break}else S(this.i,this.l,Rn,null),Es(this,Rn);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xr!=4||ve.length!=0||this.h.h||(this.s=1,sr(16),y=!1),this.o=this.o&&y,!y)S(this.i,this.l,ve,"[Invalid Chunked Response]"),yt(this),ot(this);else if(0<ve.length&&!this.W){this.W=!0;var gr=this.j;gr.g==this&&gr.ba&&!gr.M&&(gr.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),L0(gr),gr.M=!0,sr(11))}}else S(this.i,this.l,ve,null),Es(this,ve);xr==4&&yt(this),this.o&&!this.J&&(xr==4?rx(this.j,this):(this.o=!1,Ee(this)))}else CI(this.g),y==400&&0<ve.indexOf("Unknown SID")?(this.s=3,sr(12)):(this.s=0,sr(13)),yt(this),ot(this)}}}catch{}finally{}};function Ie(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function pe(u,p){var y=u.C,N=p.indexOf(`
`,y);return N==-1?J:(y=Number(p.substring(y,N)),isNaN(y)?Q:(N+=1,N+y>p.length?J:(p=p.slice(N,N+y),u.C=N+y,p)))}te.prototype.cancel=function(){this.J=!0,yt(this)};function Ee(u){u.S=Date.now()+u.I,Me(u,u.I)}function Me(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=ys(d(u.ba,u),p)}function ft(u){u.B&&(o.clearTimeout(u.B),u.B=null)}te.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(M(this.i,this.A),this.L!=2&&(Xi(),sr(17)),yt(this),this.s=2,ot(this)):Me(this,this.S-u)};function ot(u){u.j.G==0||u.J||rx(u.j,u)}function yt(u){ft(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,it(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Es(u,p){try{var y=u.j;if(y.G!=0&&(y.g==u||Zr(y.h,u))){if(!u.K&&Zr(y.h,u)&&y.G==3){try{var N=y.Da.g.parse(p)}catch{N=null}if(Array.isArray(N)&&N.length==3){var q=N;if(q[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)Cu(y),Su(y);else break e;b0(y),sr(18)}}else y.za=q[1],0<y.za-y.T&&37500>q[2]&&y.F&&y.v==0&&!y.C&&(y.C=ys(d(y.Za,y),6e3));if(1>=Ga(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Zi(y,11)}else if((u.K||y.g==u)&&Cu(y),!w(p))for(q=y.Da.g.parse(p),p=0;p<q.length;p++){let st=q[p];if(y.T=st[0],st=st[1],y.G==2)if(st[0]=="c"){y.K=st[1],y.ia=st[2];const gr=st[3];gr!=null&&(y.la=gr,y.j.info("VER="+y.la));const xr=st[4];xr!=null&&(y.Aa=xr,y.j.info("SVER="+y.Aa));const Xa=st[5];Xa!=null&&typeof Xa=="number"&&0<Xa&&(N=1.5*Xa,y.L=N,y.j.info("backChannelRequestTimeoutMs_="+N)),N=y;const Rn=u.g;if(Rn){const Pu=Rn.g?Rn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pu){var ee=N.h;ee.g||Pu.indexOf("spdy")==-1&&Pu.indexOf("quic")==-1&&Pu.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(F0(ee,ee.h),ee.h=null))}if(N.D){const M0=Rn.g?Rn.g.getResponseHeader("X-HTTP-Session-Id"):null;M0&&(N.ya=M0,gt(N.I,N.D,M0))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),N=y;var ve=u;if(N.qa=ix(N,N.J?N.ia:null,N.W),ve.K){O1(N.h,ve);var ht=ve,ir=N.L;ir&&(ht.I=ir),ht.B&&(ft(ht),Ee(ht)),N.g=ve}else ex(N);0<y.i.length&&Iu(y)}else st[0]!="stop"&&st[0]!="close"||Zi(y,7);else y.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Zi(y,7):O0(y):st[0]!="noop"&&y.l&&y.l.ta(st),y.v=0)}}Xi(4)}catch{}}var Qi=class{constructor(u,p){this.g=u,this.map=p}};function Xs(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ga(u){return u.h?1:u.g?u.g.size:0}function Zr(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function F0(u,p){u.g?u.g.add(p):u.h=p}function O1(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Xs.prototype.cancel=function(){if(this.i=b1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function b1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const y of u.g.values())p=p.concat(y.D);return p}return x(u.i)}function dI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],y=u.length,N=0;N<y;N++)p.push(u[N]);return p}p=[],y=0;for(N in u)p[y++]=u[N];return p}function pI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var y=0;y<u;y++)p.push(y);return p}p=[],y=0;for(const N in u)p[y++]=N;return p}}}function L1(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var y=pI(u),N=dI(u),q=N.length,ee=0;ee<q;ee++)p.call(void 0,N[ee],y&&y[ee],u)}var M1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mI(u,p){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var N=u[y].indexOf("="),q=null;if(0<=N){var ee=u[y].substring(0,N);q=u[y].substring(N+1)}else ee=u[y];p(ee,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Ji(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Ji){this.h=u.h,yu(this,u.j),this.o=u.o,this.g=u.g,Eu(this,u.s),this.l=u.l;var p=u.i,y=new pc;y.i=p.i,p.g&&(y.g=new Map(p.g),y.h=p.h),V1(this,y),this.m=u.m}else u&&(p=String(u).match(M1))?(this.h=!1,yu(this,p[1]||"",!0),this.o=hc(p[2]||""),this.g=hc(p[3]||"",!0),Eu(this,p[4]),this.l=hc(p[5]||"",!0),V1(this,p[6]||"",!0),this.m=hc(p[7]||"")):(this.h=!1,this.i=new pc(null,this.h))}Ji.prototype.toString=function(){var u=[],p=this.j;p&&u.push(dc(p,U1,!0),":");var y=this.g;return(y||p=="file")&&(u.push("//"),(p=this.o)&&u.push(dc(p,U1,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(dc(y,y.charAt(0)=="/"?vI:xI,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",dc(y,yI)),u.join("")};function ws(u){return new Ji(u)}function yu(u,p,y){u.j=y?hc(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Eu(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function V1(u,p,y){p instanceof pc?(u.i=p,EI(u.i,u.h)):(y||(p=dc(p,_I)),u.i=new pc(p,u.h))}function gt(u,p,y){u.i.set(p,y)}function wu(u){return gt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function hc(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function dc(u,p,y){return typeof u=="string"?(u=encodeURI(u).replace(p,gI),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function gI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var U1=/[#\/\?@]/g,xI=/[#\?:]/g,vI=/[#\?]/g,_I=/[#\?@]/g,yI=/#/g;function pc(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ys(u){u.g||(u.g=new Map,u.h=0,u.i&&mI(u.i,function(p,y){u.add(decodeURIComponent(p.replace(/\+/g," ")),y)}))}t=pc.prototype,t.add=function(u,p){Ys(this),this.i=null,u=Ka(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(p),this.h+=1,this};function B1(u,p){Ys(u),p=Ka(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function j1(u,p){return Ys(u),p=Ka(u,p),u.g.has(p)}t.forEach=function(u,p){Ys(this),this.g.forEach(function(y,N){y.forEach(function(q){u.call(p,q,N,this)},this)},this)},t.na=function(){Ys(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),y=[];for(let N=0;N<p.length;N++){const q=u[N];for(let ee=0;ee<q.length;ee++)y.push(p[N])}return y},t.V=function(u){Ys(this);let p=[];if(typeof u=="string")j1(this,u)&&(p=p.concat(this.g.get(Ka(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)p=p.concat(u[y])}return p},t.set=function(u,p){return Ys(this),this.i=null,u=Ka(this,u),j1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function z1(u,p,y){B1(u,p),0<y.length&&(u.i=null,u.g.set(Ka(u,p),x(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var y=0;y<p.length;y++){var N=p[y];const ee=encodeURIComponent(String(N)),ve=this.V(N);for(N=0;N<ve.length;N++){var q=ee;ve[N]!==""&&(q+="="+encodeURIComponent(String(ve[N]))),u.push(q)}}return this.i=u.join("&")};function Ka(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function EI(u,p){p&&!u.j&&(Ys(u),u.i=null,u.g.forEach(function(y,N){var q=N.toLowerCase();N!=q&&(B1(this,N),z1(this,q,y))},u)),u.j=p}function wI(u,p){const y=new Yi;if(o.Image){const N=new Image;N.onload=m(Qs,y,"TestLoadImage: loaded",!0,p,N),N.onerror=m(Qs,y,"TestLoadImage: error",!1,p,N),N.onabort=m(Qs,y,"TestLoadImage: abort",!1,p,N),N.ontimeout=m(Qs,y,"TestLoadImage: timeout",!1,p,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=u}else p(!1)}function TI(u,p){const y=new Yi,N=new AbortController,q=setTimeout(()=>{N.abort(),Qs(y,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:N.signal}).then(ee=>{clearTimeout(q),ee.ok?Qs(y,"TestPingServer: ok",!0,p):Qs(y,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(q),Qs(y,"TestPingServer: error",!1,p)})}function Qs(u,p,y,N,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),N(y)}catch{}}function kI(){this.g=new R0}function AI(u,p,y){const N=y||"";try{L1(u,function(q,ee){let ve=q;l(q)&&(ve=dn(q)),p.push(N+ee+"="+encodeURIComponent(ve))})}catch(q){throw p.push(N+"type="+encodeURIComponent("_badmap")),q}}function Tu(u){this.l=u.Ub||null,this.j=u.eb||!1}g(Tu,$a),Tu.prototype.g=function(){return new ku(this.l,this.j)},Tu.prototype.i=function(u){return function(){return u}}({});function ku(u,p){ut.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(ku,ut),t=ku.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,gc(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,mc(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,gc(this)),this.g&&(this.readyState=3,gc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;H1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function H1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?mc(this):gc(this),this.readyState==3&&H1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,mc(this))},t.Qa=function(u){this.g&&(this.response=u,mc(this))},t.ga=function(){this.g&&mc(this)};function mc(u){u.readyState=4,u.l=null,u.j=null,u.v=null,gc(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var y=p.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=p.next();return u.join(`\r
`)};function gc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function $1(u){let p="";return U(u,function(y,N){p+=N,p+=":",p+=y,p+=`\r
`}),p}function D0(u,p,y){e:{for(N in y){var N=!1;break e}N=!0}N||(y=$1(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):gt(u,p,y))}function It(u){ut.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(It,ut);var SI=/^https?$/i,II=["POST","PUT"];t=It.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,y,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():B.g(),this.v=this.o?lc(this.o):lc(B),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(ee){W1(this,ee);return}if(u=y||"",y=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var q in N)y.set(q,N[q]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ee of N.keys())y.set(ee,N.get(ee));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(y.keys()).find(ee=>ee.toLowerCase()=="content-type"),q=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(II,p,void 0))||N||q||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,ve]of y)this.g.setRequestHeader(ee,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{q1(this),this.u=!0,this.g.send(u),this.u=!1}catch(ee){W1(this,ee)}};function W1(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,G1(u),Au(u)}function G1(u){u.A||(u.A=!0,Z(u,"complete"),Z(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Z(this,"complete"),Z(this,"abort"),Au(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Au(this,!0)),It.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?K1(this):this.bb())},t.bb=function(){K1(this)};function K1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Ts(u)!=4||u.Z()!=2)){if(u.u&&Ts(u)==4)we(u.Ea,0,u);else if(Z(u,"readystatechange"),Ts(u)==4){u.h=!1;try{const ve=u.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var y;if(!(y=p)){var N;if(N=ve===0){var q=String(u.D).match(M1)[1]||null;!q&&o.self&&o.self.location&&(q=o.self.location.protocol.slice(0,-1)),N=!SI.test(q?q.toLowerCase():"")}y=N}if(y)Z(u,"complete"),Z(u,"success");else{u.m=6;try{var ee=2<Ts(u)?u.g.statusText:""}catch{ee=""}u.l=ee+" ["+u.Z()+"]",G1(u)}}finally{Au(u)}}}}function Au(u,p){if(u.g){q1(u);const y=u.g,N=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Z(u,"ready");try{y.onreadystatechange=N}catch{}}}function q1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ts(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ts(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),cc(p)}};function X1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function CI(u){const p={};u=(u.g&&2<=Ts(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<u.length;N++){if(w(u[N]))continue;var y=P(u[N]);const q=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const ee=p[q]||[];p[q]=ee,ee.push(y)}_(p,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xc(u,p,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||p}function Y1(u){this.Aa=0,this.i=[],this.j=new Yi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xc("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xc("baseRetryDelayMs",5e3,u),this.cb=xc("retryDelaySeedMs",1e4,u),this.Wa=xc("forwardChannelMaxRetries",2,u),this.wa=xc("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Xs(u&&u.concurrentRequestLimit),this.Da=new kI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Y1.prototype,t.la=8,t.G=1,t.connect=function(u,p,y,N){sr(0),this.W=u,this.H=p||{},y&&N!==void 0&&(this.H.OSID=y,this.H.OAID=N),this.F=this.X,this.I=ix(this,null,this.W),Iu(this)};function O0(u){if(Q1(u),u.G==3){var p=u.U++,y=ws(u.I);if(gt(y,"SID",u.K),gt(y,"RID",p),gt(y,"TYPE","terminate"),vc(u,y),p=new te(u,u.j,p),p.L=2,p.v=wu(ws(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!y&&o.Image&&(new Image().src=p.v,y=!0),y||(p.g=ax(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Ee(p)}sx(u)}function Su(u){u.g&&(L0(u),u.g.cancel(),u.g=null)}function Q1(u){Su(u),u.u&&(o.clearTimeout(u.u),u.u=null),Cu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Iu(u){if(!Xn(u.h)&&!u.s){u.s=!0;var p=u.Ga;_e||fe(),ie||(_e(),ie=!0),W.add(p,u),u.B=0}}function RI(u,p){return Ga(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=ys(d(u.Ga,u,p),nx(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new te(this,this.j,u);let ee=this.o;if(this.S&&(ee?(ee=k(ee),I(ee,this.S)):ee=this.S),this.m!==null||this.O||(q.H=ee,ee=null),this.P)e:{for(var p=0,y=0;y<this.i.length;y++){t:{var N=this.i[y];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(p+=N,4096<p){p=y;break e}if(p===4096||y===this.i.length-1){p=y+1;break e}}p=1e3}else p=1e3;p=Z1(this,q,p),y=ws(this.I),gt(y,"RID",u),gt(y,"CVER",22),this.D&&gt(y,"X-HTTP-Session-Id",this.D),vc(this,y),ee&&(this.O?p="headers="+encodeURIComponent(String($1(ee)))+"&"+p:this.m&&D0(y,this.m,ee)),F0(this.h,q),this.Ua&&gt(y,"TYPE","init"),this.P?(gt(y,"$req",p),gt(y,"SID","null"),q.T=!0,le(q,y,null)):le(q,y,p),this.G=2}}else this.G==3&&(u?J1(this,u):this.i.length==0||Xn(this.h)||J1(this))};function J1(u,p){var y;p?y=p.l:y=u.U++;const N=ws(u.I);gt(N,"SID",u.K),gt(N,"RID",y),gt(N,"AID",u.T),vc(u,N),u.m&&u.o&&D0(N,u.m,u.o),y=new te(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Z1(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),F0(u.h,y),le(y,N,p)}function vc(u,p){u.H&&U(u.H,function(y,N){gt(p,N,y)}),u.l&&L1({},function(y,N){gt(p,N,y)})}function Z1(u,p,y){y=Math.min(u.i.length,y);var N=u.l?d(u.l.Na,u.l,u):null;e:{var q=u.i;let ee=-1;for(;;){const ve=["count="+y];ee==-1?0<y?(ee=q[0].g,ve.push("ofs="+ee)):ee=0:ve.push("ofs="+ee);let ht=!0;for(let ir=0;ir<y;ir++){let st=q[ir].g;const gr=q[ir].map;if(st-=ee,0>st)ee=Math.max(0,q[ir].g-100),ht=!1;else try{AI(gr,ve,"req"+st+"_")}catch{N&&N(gr)}}if(ht){N=ve.join("&");break e}}}return u=u.i.splice(0,y),p.D=u,N}function ex(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;_e||fe(),ie||(_e(),ie=!0),W.add(p,u),u.v=0}}function b0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=ys(d(u.Fa,u),nx(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,tx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=ys(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,sr(10),Su(this),tx(this))};function L0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function tx(u){u.g=new te(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=ws(u.qa);gt(p,"RID","rpc"),gt(p,"SID",u.K),gt(p,"AID",u.T),gt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&gt(p,"TO",u.ja),gt(p,"TYPE","xmlhttp"),vc(u,p),u.m&&u.o&&D0(p,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=wu(ws(p)),y.m=null,y.P=!0,xe(y,u)}t.Za=function(){this.C!=null&&(this.C=null,Su(this),b0(this),sr(19))};function Cu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function rx(u,p){var y=null;if(u.g==p){Cu(u),L0(u),u.g=null;var N=2}else if(Zr(u.h,p))y=p.D,O1(u.h,p),N=1;else return;if(u.G!=0){if(p.o)if(N==1){y=p.m?p.m.length:0,p=Date.now()-p.F;var q=u.B;N=Wa(),Z(N,new _u(N,y)),Iu(u)}else ex(u);else if(q=p.s,q==3||q==0&&0<p.X||!(N==1&&RI(u,p)||N==2&&b0(u)))switch(y&&0<y.length&&(p=u.h,p.i=p.i.concat(y)),q){case 1:Zi(u,5);break;case 4:Zi(u,10);break;case 3:Zi(u,6);break;default:Zi(u,2)}}}function nx(u,p){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*p}function Zi(u,p){if(u.j.info("Error code "+p),p==2){var y=d(u.fb,u),N=u.Xa;const q=!N;N=new Ji(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||yu(N,"https"),wu(N),q?wI(N.toString(),y):TI(N.toString(),y)}else sr(2);u.G=0,u.l&&u.l.sa(p),sx(u),Q1(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),sr(2)):(this.j.info("Failed to ping google.com"),sr(1))};function sx(u){if(u.G=0,u.ka=[],u.l){const p=b1(u.h);(p.length!=0||u.i.length!=0)&&(E(u.ka,p),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function ix(u,p,y){var N=y instanceof Ji?ws(y):new Ji(y);if(N.g!="")p&&(N.g=p+"."+N.g),Eu(N,N.s);else{var q=o.location;N=q.protocol,p=p?p+"."+q.hostname:q.hostname,q=+q.port;var ee=new Ji(null);N&&yu(ee,N),p&&(ee.g=p),q&&Eu(ee,q),y&&(ee.l=y),N=ee}return y=u.D,p=u.ya,y&&p&&gt(N,y,p),gt(N,"VER",u.la),vc(u,N),N}function ax(u,p,y){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new It(new Tu({eb:y})):new It(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ox(){}t=ox.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ru(){}Ru.prototype.g=function(u,p){return new en(u,p)};function en(u,p){ut.call(this),this.g=new Y1(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!w(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!w(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new qa(this)}g(en,ut),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){O0(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=dn(u),u=y);p.i.push(new Qi(p.Ya++,u)),p.G==3&&Iu(p)},en.prototype.N=function(){this.g.l=null,delete this.j,O0(this.g),delete this.g,en.aa.N.call(this)};function cx(u){fc.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const y in p){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}g(cx,fc);function lx(){qs.call(this),this.status=1}g(lx,qs);function qa(u){this.g=u}g(qa,ox),qa.prototype.ua=function(){Z(this.g,"a")},qa.prototype.ta=function(u){Z(this.g,new cx(u))},qa.prototype.sa=function(u){Z(this.g,new lx)},qa.prototype.ra=function(){Z(this.g,"b")},Ru.prototype.createWebChannel=Ru.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,uA=function(){return new Ru},lA=function(){return Wa()},cA=_s,Yp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},b.NO_ERROR=0,b.TIMEOUT=8,b.HTTP_ERROR=6,Cf=b,V.COMPLETE="complete",oA=V,uc.EventType=qi,qi.OPEN="a",qi.CLOSE="b",qi.ERROR="c",qi.MESSAGE="d",ut.prototype.listen=ut.prototype.K,Mc=uc,It.prototype.listenOnce=It.prototype.L,It.prototype.getLastError=It.prototype.Ka,It.prototype.getLastErrorCode=It.prototype.Ba,It.prototype.getStatus=It.prototype.Z,It.prototype.getResponseJson=It.prototype.Oa,It.prototype.getResponseText=It.prototype.oa,It.prototype.send=It.prototype.ea,It.prototype.setWithCredentials=It.prototype.Ha,aA=It}).apply(typeof sf<"u"?sf:typeof self<"u"?self:typeof window<"u"?window:{});const oy="@firebase/firestore",cy="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wr.UNAUTHENTICATED=new wr(null),wr.GOOGLE_CREDENTIALS=new wr("google-credentials-uid"),wr.FIRST_PARTY=new wr("first-party-uid"),wr.MOCK_USER=new wr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa=new i0("@firebase/firestore");function Za(){return Sa.logLevel}function Re(t,...e){if(Sa.logLevel<=Ke.DEBUG){const r=e.map(Kg);Sa.debug(`Firestore (${nc}): ${t}`,...r)}}function Hs(t,...e){if(Sa.logLevel<=Ke.ERROR){const r=e.map(Kg);Sa.error(`Firestore (${nc}): ${t}`,...r)}}function zo(t,...e){if(Sa.logLevel<=Ke.WARN){const r=e.map(Kg);Sa.warn(`Firestore (${nc}): ${t}`,...r)}}function Kg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,fA(t,n,r)}function fA(t,e,r){let n=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Hs(n),new Error(n)}function at(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||fA(e,s,n)}function Be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends qn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(wr.UNAUTHENTICATED))}shutdown(){}}class q9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class X9{constructor(e){this.t=e,this.currentUser=wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){at(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new bs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new bs,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},o=c=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new bs)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(at(typeof n.accessToken=="string",31837,{l:n}),new hA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new wr(e)}}class Y9{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=wr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Q9{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Y9(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(wr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ly{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J9{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_n(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){at(this.o===void 0,3512);const n=i=>{i.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ly(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(at(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new ly(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=Z9(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function qe(t,e){return t<e?-1:t>e?1:0}function Qp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Cd(s)===Cd(i)?qe(s,i):Cd(s)?1:-1}return qe(t.length,e.length)}const eV=55296,tV=57343;function Cd(t){const e=t.charCodeAt(0);return e>=eV&&e<=tV}function Ho(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="__name__";class es{constructor(e,r,n){r===void 0?r=0:r>e.length&&be(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&be(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return es.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof es?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=es.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return qe(e.length,r.length)}static compareSegments(e,r){const n=es.isNumericId(e),s=es.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?es.extractNumericId(e).compare(es.extractNumericId(r)):Qp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ii.fromString(e.substring(4,e.length-2))}}class dt extends es{construct(e,r,n){return new dt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Se(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new dt(r)}static emptyPath(){return new dt([])}}const rV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lr extends es{construct(e,r,n){return new lr(e,r,n)}static isValidIdentifier(e){return rV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uy}static keyField(){return new lr([uy])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Se(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Se(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Se(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Se(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lr(r)}static emptyPath(){return new lr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(dt.fromString(e))}static fromName(e){return new Fe(dt.fromString(e).popFirst(5))}static empty(){return new Fe(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&dt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return dt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new dt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(t,e,r){if(!r)throw new Se(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nV(t,e,r,n){if(e===!0&&n===!0)throw new Se(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function fy(t){if(!Fe.isDocumentKey(t))throw new Se(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hy(t){if(Fe.isDocumentKey(t))throw new Se(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function pA(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function l0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":be(12329,{type:typeof t})}function Gn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Se(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=l0(t);throw new Se(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,e){const r={typeString:t};return e&&(r.value=e),r}function lu(t,e){if(!pA(t))throw new Se(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Se(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=-62135596800,py=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*py);return new vt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Se(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Se(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<dy)throw new Se(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/py}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(lu(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Ht("string",vt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new vt(0,0))}static max(){return new Ve(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl=-1;function sV(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new vt(r+1,0):new vt(r,n));return new bi(s,Fe.empty(),e)}function iV(t){return new bi(t.readTime,t.key,Bl)}class bi{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new bi(Ve.min(),Fe.empty(),Bl)}static max(){return new bi(Ve.max(),Fe.empty(),Bl)}}function aV(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Fe.comparator(t.documentKey,e.documentKey),r!==0?r:qe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sc(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==oV)throw t;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new se((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof se?r:se.resolve(r)}catch(r){return se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):se.reject(r)}static resolve(e){return new se((r,n)=>{r(e)})}static reject(e){return new se((r,n)=>{n(e)})}static waitFor(e){return new se((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},c=>n(c))}),a=!0,i===s&&r()})}static or(e){let r=se.resolve(!1);for(const n of e)r=r.next(s=>s?se.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new se((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let c=0;c<i;c++){const l=c;r(e[l]).next(f=>{a[l]=f,++o,o===i&&n(a)},f=>s(f))}})}static doWhile(e,r){return new se((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function lV(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function ic(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}u0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=-1;function f0(t){return t==null}function kh(t){return t===0&&1/t==-1/0}function uV(t){return typeof t=="number"&&Number.isInteger(t)&&!kh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="";function fV(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=my(e)),e=hV(t.get(r),e);return my(e)}function hV(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case mA:r+="";break;default:r+=i}}return r}function my(t){return t+mA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Gi(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function gA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,r){this.comparator=e,this.root=r||or.EMPTY}insert(e,r){return new St(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,or.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,or.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new af(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new af(this.root,e,this.comparator,!1)}getReverseIterator(){return new af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new af(this.root,e,this.comparator,!0)}}class af{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class or{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??or.RED,this.left=s??or.EMPTY,this.right=i??or.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new or(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return or.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return or.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw be(27949);return e+(this.isRed()?0:1)}}or.EMPTY=null,or.RED=!0,or.BLACK=!1;or.EMPTY=new class{constructor(){this.size=0}get key(){throw be(57766)}get value(){throw be(16141)}get color(){throw be(16727)}get left(){throw be(29726)}get right(){throw be(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new or(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new xy(this.data.getIterator())}getIteratorFrom(e){return new xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Qt(this.comparator);return r.data=e,r}}class xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.fields=e,e.sort(lr.comparator)}static empty(){return new an([])}unionWith(e){let r=new Qt(lr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new an(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new xA("Invalid base64 string: "+i):i}}(e);return new pr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new pr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pr.EMPTY_BYTE_STRING=new pr("");const dV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Li(t){if(at(!!t,39018),typeof t=="string"){let e=0;const r=dV.exec(t);if(at(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Dt(t.seconds),nanos:Dt(t.nanos)}}function Dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mi(t){return typeof t=="string"?pr.fromBase64String(t):pr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="server_timestamp",_A="__type__",yA="__previous_value__",EA="__local_write_time__";function Yg(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[_A])==null?void 0:n.stringValue)===vA}function h0(t){const e=t.mapValue.fields[yA];return Yg(e)?h0(e):e}function jl(t){const e=Li(t.mapValue.fields[EA].timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,r,n,s,i,a,o,c,l,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=f}}const Ah="(default)";class zl{constructor(e,r){this.projectId=e,this.database=r||Ah}static empty(){return new zl("","")}get isDefaultDatabase(){return this.database===Ah}isEqual(e){return e instanceof zl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA="__type__",mV="__max__",of={mapValue:{}},TA="__vector__",Sh="value";function Vi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Yg(t)?4:xV(t)?9007199254740991:gV(t)?10:11:be(28295,{value:t})}function ms(t,e){if(t===e)return!0;const r=Vi(t);if(r!==Vi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jl(t).isEqual(jl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Li(s.timestampValue),o=Li(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Mi(s.bytesValue).isEqual(Mi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Dt(s.geoPointValue.latitude)===Dt(i.geoPointValue.latitude)&&Dt(s.geoPointValue.longitude)===Dt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Dt(s.integerValue)===Dt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Dt(s.doubleValue),o=Dt(i.doubleValue);return a===o?kh(a)===kh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Ho(t.arrayValue.values||[],e.arrayValue.values||[],ms);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(gy(a)!==gy(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!ms(a[c],o[c])))return!1;return!0}(t,e);default:return be(52216,{left:t})}}function Hl(t,e){return(t.values||[]).find(r=>ms(r,e))!==void 0}function $o(t,e){if(t===e)return 0;const r=Vi(t),n=Vi(e);if(r!==n)return qe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return qe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Dt(i.integerValue||i.doubleValue),c=Dt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return vy(t.timestampValue,e.timestampValue);case 4:return vy(jl(t),jl(e));case 5:return Qp(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Mi(i),c=Mi(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const f=qe(o[l],c[l]);if(f!==0)return f}return qe(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=qe(Dt(i.latitude),Dt(a.latitude));return o!==0?o:qe(Dt(i.longitude),Dt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _y(t.arrayValue,e.arrayValue);case 10:return function(i,a){var d,m,g,x;const o=i.fields||{},c=a.fields||{},l=(d=o[Sh])==null?void 0:d.arrayValue,f=(m=c[Sh])==null?void 0:m.arrayValue,h=qe(((g=l==null?void 0:l.values)==null?void 0:g.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return h!==0?h:_y(l,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===of.mapValue&&a===of.mapValue)return 0;if(i===of.mapValue)return 1;if(a===of.mapValue)return-1;const o=i.fields||{},c=Object.keys(o),l=a.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let h=0;h<c.length&&h<f.length;++h){const d=Qp(c[h],f[h]);if(d!==0)return d;const m=$o(o[c[h]],l[f[h]]);if(m!==0)return m}return qe(c.length,f.length)}(t.mapValue,e.mapValue);default:throw be(23264,{he:r})}}function vy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return qe(t,e);const r=Li(t),n=Li(e),s=qe(r.seconds,n.seconds);return s!==0?s:qe(r.nanos,n.nanos)}function _y(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=$o(r[s],n[s]);if(i)return i}return qe(r.length,n.length)}function Wo(t){return Jp(t)}function Jp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Li(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Mi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Fe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Jp(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${Jp(r.fields[a])}`;return s+"}"}(t.mapValue):be(61005,{value:t})}function Rf(t){switch(Vi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=h0(t);return e?16+Rf(e):16;case 5:return 2*t.stringValue.length;case 6:return Mi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+Rf(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return Gi(n.fields,(i,a)=>{s+=i.length+Rf(a)}),s}(t.mapValue);default:throw be(13486,{value:t})}}function yy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Zp(t){return!!t&&"integerValue"in t}function Qg(t){return!!t&&"arrayValue"in t}function Ey(t){return!!t&&"nullValue"in t}function wy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pf(t){return!!t&&"mapValue"in t}function gV(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[wA])==null?void 0:n.stringValue)===TA}function ol(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Gi(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=ol(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ol(t.arrayValue.values[r]);return e}return{...t}}function xV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===mV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.value=e}static empty(){return new Kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Pf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=ol(r)}setAll(e){let r=lr.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=ol(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Pf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ms(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Pf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Gi(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Kr(ol(this.value))}}function kA(t){const e=[];return Gi(t.fields,(r,n)=>{const s=new lr([r]);if(Pf(n)){const i=kA(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new an(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ar(e,0,Ve.min(),Ve.min(),Ve.min(),Kr.empty(),0)}static newFoundDocument(e,r,n,s){return new Ar(e,1,r,Ve.min(),n,s,0)}static newNoDocument(e,r){return new Ar(e,2,r,Ve.min(),Ve.min(),Kr.empty(),0)}static newUnknownDocument(e,r){return new Ar(e,3,r,Ve.min(),Ve.min(),Kr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,r){this.position=e,this.inclusive=r}}function Ty(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),r.key):n=$o(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ky(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ms(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,r="asc"){this.field=e,this.dir=r}}function vV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{}class zt extends AA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new yV(e,r,n):r==="array-contains"?new TV(e,n):r==="in"?new kV(e,n):r==="not-in"?new AV(e,n):r==="array-contains-any"?new SV(e,n):new zt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new EV(e,n):new wV(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison($o(r,this.value)):r!==null&&Vi(this.value)===Vi(r)&&this.matchesComparison($o(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kn extends AA{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Kn(e,r)}matches(e){return SA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function SA(t){return t.op==="and"}function IA(t){return _V(t)&&SA(t)}function _V(t){for(const e of t.filters)if(e instanceof Kn)return!1;return!0}function em(t){if(t instanceof zt)return t.field.canonicalString()+t.op.toString()+Wo(t.value);if(IA(t))return t.filters.map(e=>em(e)).join(",");{const e=t.filters.map(r=>em(r)).join(",");return`${t.op}(${e})`}}function CA(t,e){return t instanceof zt?function(n,s){return s instanceof zt&&n.op===s.op&&n.field.isEqual(s.field)&&ms(n.value,s.value)}(t,e):t instanceof Kn?function(n,s){return s instanceof Kn&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&CA(a,s.filters[o]),!0):!1}(t,e):void be(19439)}function RA(t){return t instanceof zt?function(r){return`${r.field.canonicalString()} ${r.op} ${Wo(r.value)}`}(t):t instanceof Kn?function(r){return r.op.toString()+" {"+r.getFilters().map(RA).join(" ,")+"}"}(t):"Filter"}class yV extends zt{constructor(e,r,n){super(e,r,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const r=Fe.comparator(e.key,this.key);return this.matchesComparison(r)}}class EV extends zt{constructor(e,r){super(e,"in",r),this.keys=PA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class wV extends zt{constructor(e,r){super(e,"not-in",r),this.keys=PA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function PA(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class TV extends zt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Qg(r)&&Hl(r.arrayValue,this.value)}}class kV extends zt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Hl(this.value.arrayValue,r)}}class AV extends zt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Hl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Hl(this.value.arrayValue,r)}}class SV extends zt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Qg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Hl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function Ay(t,e=null,r=[],n=[],s=null,i=null,a=null){return new IV(t,e,r,n,s,i,a)}function Jg(t){const e=Be(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>em(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),f0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Wo(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Wo(n)).join(",")),e.Te=r}return e.Te}function Zg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!vV(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!CA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ky(t.startAt,e.startAt)&&ky(t.endAt,e.endAt)}function tm(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function CV(t,e,r,n,s,i,a,o){return new uu(t,e,r,n,s,i,a,o)}function e1(t){return new uu(t)}function Sy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function NA(t){return t.collectionGroup!==null}function cl(t){const e=Be(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Qt(lr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ch(i,n))}),r.has(lr.keyField().canonicalString())||e.Ie.push(new Ch(lr.keyField(),n))}return e.Ie}function ls(t){const e=Be(t);return e.Ee||(e.Ee=RV(e,cl(t))),e.Ee}function RV(t,e){if(t.limitType==="F")return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ch(s.field,i)});const r=t.endAt?new Ih(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ih(t.startAt.position,t.startAt.inclusive):null;return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function rm(t,e){const r=t.filters.concat([e]);return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function nm(t,e,r){return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function d0(t,e){return Zg(ls(t),ls(e))&&t.limitType===e.limitType}function FA(t){return`${Jg(ls(t))}|lt:${t.limitType}`}function eo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>RA(s)).join(", ")}]`),f0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Wo(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Wo(s)).join(",")),`Target(${n})`}(ls(t))}; limitType=${t.limitType})`}function p0(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Fe.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of cl(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,c){const l=Ty(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,cl(n),s)||n.endAt&&!function(a,o,c){const l=Ty(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,cl(n),s))}(t,e)}function PV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function DA(t){return(e,r)=>{let n=!1;for(const s of cl(t)){const i=NV(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function NV(t,e,r){const n=t.field.isKeyField()?Fe.comparator(e.key,r.key):function(i,a,o){const c=a.data.field(i),l=o.data.field(i);return c!==null&&l!==null?$o(c,l):be(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return be(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Gi(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return gA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV=new St(Fe.comparator);function $s(){return FV}const OA=new St(Fe.comparator);function Vc(...t){let e=OA;for(const r of t)e=e.insert(r.key,r);return e}function bA(t){let e=OA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function la(){return ll()}function LA(){return ll()}function ll(){return new ja(t=>t.toString(),(t,e)=>t.isEqual(e))}const DV=new St(Fe.comparator),OV=new Qt(Fe.comparator);function Xe(...t){let e=OV;for(const r of t)e=e.add(r);return e}const bV=new Qt(qe);function LV(){return bV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kh(e)?"-0":e}}function MA(t){return{integerValue:""+t}}function MV(t,e){return uV(e)?MA(e):t1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(){this._=void 0}}function VV(t,e,r){return t instanceof Rh?function(s,i){const a={fields:{[_A]:{stringValue:vA},[EA]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Yg(i)&&(i=h0(i)),i&&(a.fields[yA]=i),{mapValue:a}}(r,e):t instanceof $l?UA(t,e):t instanceof Wl?BA(t,e):function(s,i){const a=VA(s,i),o=Iy(a)+Iy(s.Ae);return Zp(a)&&Zp(s.Ae)?MA(o):t1(s.serializer,o)}(t,e)}function UV(t,e,r){return t instanceof $l?UA(t,e):t instanceof Wl?BA(t,e):r}function VA(t,e){return t instanceof Ph?function(n){return Zp(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Rh extends m0{}class $l extends m0{constructor(e){super(),this.elements=e}}function UA(t,e){const r=jA(e);for(const n of t.elements)r.some(s=>ms(s,n))||r.push(n);return{arrayValue:{values:r}}}class Wl extends m0{constructor(e){super(),this.elements=e}}function BA(t,e){let r=jA(e);for(const n of t.elements)r=r.filter(s=>!ms(s,n));return{arrayValue:{values:r}}}class Ph extends m0{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Iy(t){return Dt(t.integerValue||t.doubleValue)}function jA(t){return Qg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function BV(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof $l&&s instanceof $l||n instanceof Wl&&s instanceof Wl?Ho(n.elements,s.elements,ms):n instanceof Ph&&s instanceof Ph?ms(n.Ae,s.Ae):n instanceof Rh&&s instanceof Rh}(t.transform,e.transform)}class jV{constructor(e,r){this.version=e,this.transformResults=r}}class kn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new kn}static exists(e){return new kn(void 0,e)}static updateTime(e){return new kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class g0{}function zA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new r1(t.key,kn.none()):new fu(t.key,t.data,kn.none());{const r=t.data,n=Kr.empty();let s=new Qt(lr.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new Ki(t.key,n,new an(s.toArray()),kn.none())}}function zV(t,e,r){t instanceof fu?function(s,i,a){const o=s.value.clone(),c=Ry(s.fieldTransforms,i,a.transformResults);o.setAll(c),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ki?function(s,i,a){if(!Nf(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Ry(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(HA(s)),c.setAll(o),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function ul(t,e,r,n){return t instanceof fu?function(i,a,o,c){if(!Nf(i.precondition,a))return o;const l=i.value.clone(),f=Py(i.fieldTransforms,c,a);return l.setAll(f),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ki?function(i,a,o,c){if(!Nf(i.precondition,a))return o;const l=Py(i.fieldTransforms,c,a),f=a.data;return f.setAll(HA(i)),f.setAll(l),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return Nf(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function HV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=VA(n.transform,s||null);i!=null&&(r===null&&(r=Kr.empty()),r.set(n.field,i))}return r||null}function Cy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ho(n,s,(i,a)=>BV(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class fu extends g0{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ki extends g0{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function HA(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Ry(t,e,r){const n=new Map;at(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,UV(a,o,r[s]))}return n}function Py(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,VV(i,a,e))}return n}class r1 extends g0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $V extends g0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&zV(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ul(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ul(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=LA();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const c=zA(a,o);c!==null&&n.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,(r,n)=>Cy(r,n))&&Ho(this.baseMutations,e.baseMutations,(r,n)=>Cy(r,n))}}class n1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){at(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return DV}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new n1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt,Qe;function qV(t){switch(t){case ne.OK:return be(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return be(15467,{code:t})}}function $A(t){if(t===void 0)return Hs("GRPC error has no .code"),ne.UNKNOWN;switch(t){case Vt.OK:return ne.OK;case Vt.CANCELLED:return ne.CANCELLED;case Vt.UNKNOWN:return ne.UNKNOWN;case Vt.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Vt.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Vt.INTERNAL:return ne.INTERNAL;case Vt.UNAVAILABLE:return ne.UNAVAILABLE;case Vt.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Vt.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Vt.NOT_FOUND:return ne.NOT_FOUND;case Vt.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Vt.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Vt.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Vt.ABORTED:return ne.ABORTED;case Vt.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Vt.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Vt.DATA_LOSS:return ne.DATA_LOSS;default:return be(39323,{code:t})}}(Qe=Vt||(Vt={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=new Ii([4294967295,4294967295],0);function Ny(t){const e=XV().encode(t),r=new iA;return r.update(e),new Uint8Array(r.digest())}function Fy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ii([r,n],0),new Ii([s,i],0)]}class s1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Uc(`Invalid padding: ${r}`);if(n<0)throw new Uc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Uc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Uc(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ii.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Ii.fromNumber(n)));return s.compare(YV)===1&&(s=new Ii([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ny(e),[n,s]=Fy(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new s1(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=Ny(e),[n,s]=Fy(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Uc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,hu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new x0(Ve.min(),s,new St(qe),$s(),Xe())}}class hu{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new hu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class WA{constructor(e,r){this.targetId=e,this.Ce=r}}class GA{constructor(e,r,n=pr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Dy{constructor(){this.ve=0,this.Fe=Oy(),this.Me=pr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),r=Xe(),n=Xe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:be(38017,{changeType:i})}}),new hu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Oy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class QV{constructor(e){this.Ge=e,this.ze=new Map,this.je=$s(),this.Je=cf(),this.He=cf(),this.Ye=new St(qe)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:be(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(tm(i))if(n===0){const a=new Fe(i.path);this.et(r,a,Ar.newNoDocument(a,Ve.min()))}else at(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),c=o?this.ct(o,e,a):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Mi(n).toUint8Array()}catch(c){if(c instanceof xA)return zo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new s1(a,s,i)}catch(c){return zo(c instanceof Uc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const o=this.ot(a);if(o){if(i.current&&tm(o.target)){const c=new Fe(o.target.path);this.It(c).has(a)||this.Et(a,c)||this.et(a,c,Ar.newNoDocument(c,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=Xe();this.He.forEach((i,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new x0(e,r,this.Ye,this.je,n);return this.je=$s(),this.Je=cf(),this.He=cf(),this.Ye=new St(qe),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Dy,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Qt(qe),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Qt(qe),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Dy),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function cf(){return new St(Fe.comparator)}function Oy(){return new St(Fe.comparator)}const JV={asc:"ASCENDING",desc:"DESCENDING"},ZV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e7={and:"AND",or:"OR"};class t7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function sm(t,e){return t.useProto3Json||f0(e)?e:{value:e}}function Nh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function KA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function r7(t,e){return Nh(t,e.toTimestamp())}function us(t){return at(!!t,49232),Ve.fromTimestamp(function(r){const n=Li(r);return new vt(n.seconds,n.nanos)}(t))}function i1(t,e){return im(t,e).canonicalString()}function im(t,e){const r=function(s){return new dt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function qA(t){const e=dt.fromString(t);return at(ZA(e),10190,{key:e.toString()}),e}function am(t,e){return i1(t.databaseId,e.path)}function Rd(t,e){const r=qA(e);if(r.get(1)!==t.databaseId.projectId)throw new Se(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Se(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Fe(YA(r))}function XA(t,e){return i1(t.databaseId,e)}function n7(t){const e=qA(t);return e.length===4?dt.emptyPath():YA(e)}function om(t){return new dt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function YA(t){return at(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function by(t,e,r){return{name:am(t,e),fields:r.value.mapValue.fields}}function s7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:be(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,f){return l.useProto3Json?(at(f===void 0||typeof f=="string",58123),pr.fromBase64String(f||"")):(at(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),pr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const f=l.code===void 0?ne.UNKNOWN:$A(l.code);return new Se(f,l.message||"")}(a);r=new GA(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Rd(t,n.document.name),i=us(n.document.updateTime),a=n.document.createTime?us(n.document.createTime):Ve.min(),o=new Kr({mapValue:{fields:n.document.fields}}),c=Ar.newFoundDocument(s,i,a,o),l=n.targetIds||[],f=n.removedTargetIds||[];r=new Ff(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Rd(t,n.document),i=n.readTime?us(n.readTime):Ve.min(),a=Ar.newNoDocument(s,i),o=n.removedTargetIds||[];r=new Ff([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Rd(t,n.document),i=n.removedTargetIds||[];r=new Ff([],i,s,null)}else{if(!("filter"in e))return be(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new KV(s,i),o=n.targetId;r=new WA(o,a)}}return r}function i7(t,e){let r;if(e instanceof fu)r={update:by(t,e.key,e.value)};else if(e instanceof r1)r={delete:am(t,e.key)};else if(e instanceof Ki)r={update:by(t,e.key,e.data),updateMask:p7(e.fieldMask)};else{if(!(e instanceof $V))return be(16599,{Vt:e.type});r={verify:am(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof Rh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof $l)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Wl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ph)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw be(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:r7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:be(27497)}(t,e.precondition)),r}function a7(t,e){return t&&t.length>0?(at(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?us(s.updateTime):us(i);return a.isEqual(Ve.min())&&(a=us(i)),new jV(a,s.transformResults||[])}(r,e))):[]}function o7(t,e){return{documents:[XA(t,e.path)]}}function c7(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=XA(t,s);const i=function(l){if(l.length!==0)return JA(Kn.create(l,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(l){if(l.length!==0)return l.map(f=>function(d){return{field:to(d.field),direction:f7(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=sm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:r,parent:s}}function l7(t){let e=n7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){at(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(h){const d=QA(h);return d instanceof Kn&&IA(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(g){return new Ch(ro(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,f0(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(h){const d=!!h.before,m=h.values||[];return new Ih(m,d)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new Ih(m,d)}(r.endAt)),CV(e,s,a,i,o,"F",c,l)}function u7(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return be(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function QA(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ro(r.unaryFilter.field);return zt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ro(r.unaryFilter.field);return zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ro(r.unaryFilter.field);return zt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ro(r.unaryFilter.field);return zt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return be(61313);default:return be(60726)}}(t):t.fieldFilter!==void 0?function(r){return zt.create(ro(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return be(58110);default:return be(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Kn.create(r.compositeFilter.filters.map(n=>QA(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return be(1026)}}(r.compositeFilter.op))}(t):be(30097,{filter:t})}function f7(t){return JV[t]}function h7(t){return ZV[t]}function d7(t){return e7[t]}function to(t){return{fieldPath:t.canonicalString()}}function ro(t){return lr.fromServerFormat(t.fieldPath)}function JA(t){return t instanceof zt?function(r){if(r.op==="=="){if(wy(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NAN"}};if(Ey(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(wy(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NAN"}};if(Ey(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:to(r.field),op:h7(r.op),value:r.value}}}(t):t instanceof Kn?function(r){const n=r.getFilters().map(s=>JA(s));return n.length===1?n[0]:{compositeFilter:{op:d7(r.op),filters:n}}}(t):be(54877,{filter:t})}function p7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ZA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,r,n,s,i=Ve.min(),a=Ve.min(),o=pr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m7{constructor(e){this.yt=e}}function g7(t){const e=l7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(){this.Cn=new v7}addToCollectionParentIndex(e,r){return this.Cn.add(r),se.resolve()}getCollectionParents(e,r){return se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return se.resolve()}deleteFieldIndex(e,r){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,r){return se.resolve()}getDocumentsMatchingTarget(e,r){return se.resolve(null)}getIndexType(e,r){return se.resolve(0)}getFieldIndexes(e,r){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,r){return se.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,r){return se.resolve(bi.min())}updateCollectionGroup(e,r,n){return se.resolve()}updateIndexEntries(e,r){return se.resolve()}}class v7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Qt(dt.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Qt(dt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eS=41943040;class Wr{static withCacheSize(e){return new Wr(e,Wr.DEFAULT_COLLECTION_PERCENTILE,Wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wr.DEFAULT_COLLECTION_PERCENTILE=10,Wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wr.DEFAULT=new Wr(eS,Wr.DEFAULT_COLLECTION_PERCENTILE,Wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wr.DISABLED=new Wr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Go(0)}static cr(){return new Go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="LruGarbageCollector",_7=1048576;function Vy([t,e],[r,n]){const s=qe(t,r);return s===0?qe(e,n):s}class y7{constructor(e){this.Ir=e,this.buffer=new Qt(Vy),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Vy(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class E7{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Re(My,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ic(r)?Re(My,"Ignoring IndexedDB error during garbage collection: ",r):await sc(r)}await this.Vr(3e5)})}}class w7{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return se.resolve(u0.ce);const n=new y7(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Re("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(Ly)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Re("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ly):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,o,c,l;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,a=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),Za()<=Ke.DEBUG&&Re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-f}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function T7(t,e){return new w7(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(){this.changes=new ja(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ar.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&ul(n.mutation,s,an.empty(),vt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const s=la();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Vc();return i.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=la();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=$s();const a=ll(),o=function(){return ll()}();return r.forEach((c,l)=>{const f=n.get(l.key);s.has(l.key)&&(f===void 0||f.mutation instanceof Ki)?i=i.insert(l.key,l):f!==void 0?(a.set(l.key,f.mutation.getFieldMask()),ul(f.mutation,l,f.mutation.getFieldMask(),vt.now())):a.set(l.key,an.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,f)=>a.set(l,f)),r.forEach((l,f)=>o.set(l,new A7(f,a.get(l)??null))),o))}recalculateAndSaveOverlays(e,r){const n=ll();let s=new St((a,o)=>a-o),i=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let f=n.get(c)||an.empty();f=o.applyToLocalView(l,f),n.set(c,f);const h=(s.get(o.batchId)||Xe()).add(c);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,f=c.value,h=LA();f.forEach(d=>{if(!i.has(d)){const m=zA(r.get(d),n.get(d));m!==null&&h.set(d,m),i=i.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return se.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):NA(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):se.resolve(la());let o=Bl,c=i;return a.next(l=>se.forEach(l,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(f)?se.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{c=c.insert(f,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,Xe())).next(f=>({batchId:o,changes:bA(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Fe(r)).next(n=>{let s=Vc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Vc();return this.indexManager.getCollectionParents(e,i).next(o=>se.forEach(o,c=>{const l=function(h,d){return new uu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,n,s).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((c,l)=>{const f=l.getKey();a.get(f)===null&&(a=a.insert(f,Ar.newInvalidDocument(f)))});let o=Vc();return a.forEach((c,l)=>{const f=i.get(c);f!==void 0&&ul(f.mutation,l,an.empty(),vt.now()),p0(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return se.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:us(s.createTime)}}(r)),se.resolve()}getNamedQuery(e,r){return se.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:g7(s.bundledQuery),readTime:us(s.readTime)}}(r)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(){this.overlays=new St(Fe.comparator),this.qr=new Map}getOverlay(e,r){return se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=la();return se.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),se.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),se.resolve()}getOverlaysForCollection(e,r,n){const s=la(),i=r.length+1,a=new Fe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return se.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new St((l,f)=>l-f);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let f=i.get(l.largestBatchId);f===null&&(f=la(),i=i.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const o=la(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>o.set(l,f)),!(o.size()>=s)););return se.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new GV(r,n));let i=this.qr.get(r);i===void 0&&(i=Xe(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(){this.sessionToken=pr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(){this.Qr=new Qt(Zt.$r),this.Ur=new Qt(Zt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Zt(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Zt(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Fe(new dt([])),n=new Zt(r,e),s=new Zt(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Fe(new dt([])),n=new Zt(r,e),s=new Zt(r,e+1);let i=Xe();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new Zt(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Zt{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Fe.comparator(e.key,r.key)||qe(e.Yr,r.Yr)}static Kr(e,r){return qe(e.Yr,r.Yr)||Fe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(Zt.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new WV(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new Zt(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(a)}lookupMutationBatch(e,r){return se.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?Xg:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Zt(r,0),s=new Zt(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const o=this.Xr(a.Yr);i.push(o)}),se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Qt(qe);return r.forEach(s=>{const i=new Zt(s,0),a=new Zt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],o=>{n=n.add(o.Yr)})}),se.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Fe.isDocumentKey(i)||(i=i.child(""));const a=new Zt(new Fe(i),0);let o=new Qt(qe);return this.Zr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===s&&(o=o.add(c.Yr)),!0)},a),se.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){at(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return se.forEach(r.mutations,s=>{const i=new Zt(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Zt(r,0),s=this.Zr.firstAfterOrEqual(n);return se.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(e){this.ri=e,this.docs=function(){return new St(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return se.resolve(n?n.document.mutableCopy():Ar.newInvalidDocument(r))}getEntries(e,r){let n=$s();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Ar.newInvalidDocument(s))}),se.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=$s();const a=r.path,o=new Fe(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||aV(iV(f),n)<=0||(s.has(f.key)||p0(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return se.resolve(i)}getAllFromCollectionGroup(e,r,n,s){be(9500)}ii(e,r){return se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new F7(this)}getSize(e){return se.resolve(this.size)}}class F7 extends k7{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),se.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D7{constructor(e){this.persistence=e,this.si=new ja(r=>Jg(r),Zg),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new a1,this.targetCount=0,this.ai=Go.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),se.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Go(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,se.resolve()}updateTargetData(e,r){return this.Pr(r),se.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(i).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return se.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),se.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),se.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),se.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return se.resolve(n)}containsKey(e,r){return se.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,r){this.ui={},this.overlays={},this.ci=new u0(0),this.li=!1,this.li=!0,this.hi=new R7,this.referenceDelegate=e(this),this.Pi=new D7(this),this.indexManager=new x7,this.remoteDocumentCache=function(s){return new N7(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new m7(r),this.Ii=new I7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new C7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new P7(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Re("MemoryPersistence","Starting transaction:",e);const s=new O7(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return se.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class O7 extends cV{constructor(e){super(),this.currentSequenceNumber=e}}class o1{constructor(e){this.persistence=e,this.Ri=new a1,this.Vi=null}static mi(e){return new o1(e)}get fi(){if(this.Vi)return this.Vi;throw be(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),se.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),se.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,n=>{const s=Fe.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,Ve.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return se.or([()=>se.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Fh{constructor(e,r){this.persistence=e,this.pi=new ja(n=>fV(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=T7(this,r)}static mi(e,r){return new Fh(e,r)}Ei(){}di(e){return se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return se.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?se.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,i.removeEntry(a,Ve.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Rf(e.data.value)),r}br(e,r,n){return se.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return se.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=Xe(),s=Xe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new c1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return cL()?8:lV(Nr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new b7;return this.Ss(e,r,a).next(o=>{if(i.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(Za()<=Ke.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",eo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(Za()<=Ke.DEBUG&&Re("QueryEngine","Query:",eo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Za()<=Ke.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",eo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ls(r))):se.resolve())}ys(e,r){if(Sy(r))return se.resolve(null);let n=ls(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=nm(r,null,"F"),n=ls(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Xe(...i);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Ds(r,o);return this.Cs(r,l,a,c.readTime)?this.ys(e,nm(r,null,"F")):this.vs(e,l,r,c)}))})))}ws(e,r,n,s){return Sy(r)||s.isEqual(Ve.min())?se.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?se.resolve(null):(Za()<=Ke.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),eo(r)),this.vs(e,a,r,sV(s,Bl)).next(o=>o))})}Ds(e,r){let n=new Qt(DA(e));return r.forEach((s,i)=>{p0(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return Za()<=Ke.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",eo(r)),this.ps.getDocumentsMatchingQuery(e,r,bi.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1="LocalStore",M7=3e8;class V7{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new St(qe),this.xs=new ja(i=>Jg(i),Zg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new S7(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function U7(t,e,r,n){return new V7(t,e,r,n)}async function rS(t,e){const r=Be(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let c=Xe();for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(l=>({Ls:l,removedBatchIds:a,addedBatchIds:o}))})})}function B7(t,e){const r=Be(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,l,f){const h=l.batch,d=h.keys();let m=se.resolve();return d.forEach(g=>{m=m.next(()=>f.getEntry(c,g)).next(x=>{const E=l.docVersions.get(g);at(E!==null,48541),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,l),x.isValidDocument()&&(x.setReadTime(l.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Xe();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function nS(t){const e=Be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function j7(t,e){const r=Be(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=s.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(i,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(i,f.addedDocuments,h)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(pr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),s=s.insert(h,m),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=M7?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,f)&&o.push(r.Pi.updateTargetData(i,m))});let c=$s(),l=Xe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),o.push(z7(i,a,e.documentUpdates).next(f=>{c=f.ks,l=f.qs})),!n.isEqual(Ve.min())){const f=r.Pi.getLastRemoteSnapshotVersion(i).next(h=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(f)}return se.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(r.Ms=s,i))}function z7(t,e,r){let n=Xe(),s=Xe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=$s();return r.forEach((o,c)=>{const l=i.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(o)),c.isNoDocument()&&c.version.isEqual(Ve.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):Re(l1,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{ks:a,qs:s}})}function H7(t,e){const r=Be(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Xg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function $7(t,e){const r=Be(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,se.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new mi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function cm(t,e,r){const n=Be(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!ic(a))throw a;Re(l1,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function Uy(t,e,r){const n=Be(t);let s=Ve.min(),i=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,f){const h=Be(c),d=h.xs.get(f);return d!==void 0?se.resolve(h.Ms.get(d)):h.Pi.getTargetData(l,f)}(n,a,ls(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(c=>{i=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:Ve.min(),r?i:Xe())).next(o=>(W7(n,PV(e),o),{documents:o,Qs:i})))}function W7(t,e,r){let n=t.Os.get(e)||Ve.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class By{constructor(){this.activeTargetIds=LV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class G7{constructor(){this.Mo=new By,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new By,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy="ConnectivityMonitor";class zy{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Re(jy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Re(jy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lf=null;function lm(){return lf===null?lf=function(){return 268435456+Math.round(2147483648*Math.random())}():lf++,"0x"+lf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd="RestConnection",q7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class X7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Ah?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=lm(),o=this.zo(e,r.toUriEncodedString());Re(Pd,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:l}=new URL(o),f=ec(l);return this.Jo(e,o,c,n,f).then(h=>(Re(Pd,`Received RPC '${e}' ${a}: `,h),h),h=>{throw zo(Pd,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=q7[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er="WebChannelConnection";class Q7 extends X7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=lm();return new Promise((o,c)=>{const l=new aA;l.setWithCredentials(!0),l.listenOnce(oA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Cf.NO_ERROR:const h=l.getResponseJson();Re(Er,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case Cf.TIMEOUT:Re(Er,`RPC '${e}' ${a} timed out`),c(new Se(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Cf.HTTP_ERROR:const d=l.getStatus();if(Re(Er,`RPC '${e}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(T){const w=T.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(w)>=0?w:ne.UNKNOWN}(g.status);c(new Se(x,g.message))}else c(new Se(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Se(ne.UNAVAILABLE,"Connection failed."));break;default:be(9055,{l_:e,streamId:a,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{Re(Er,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(s);Re(Er,`RPC '${e}' ${a} sending request:`,s),l.send(r,"POST",f,n,15)})}T_(e,r,n){const s=lm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=uA(),o=lA(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=i.join("");Re(Er,`Creating RPC '${e}' stream ${s}: ${f}`,c);const h=a.createWebChannel(f,c);this.I_(h);let d=!1,m=!1;const g=new Y7({Yo:E=>{m?Re(Er,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(d||(Re(Er,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Re(Er,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Zo:()=>h.close()}),x=(E,T,w)=>{E.listen(T,v=>{try{w(v)}catch(O){setTimeout(()=>{throw O},0)}})};return x(h,Mc.EventType.OPEN,()=>{m||(Re(Er,`RPC '${e}' stream ${s} transport opened.`),g.o_())}),x(h,Mc.EventType.CLOSE,()=>{m||(m=!0,Re(Er,`RPC '${e}' stream ${s} transport closed`),g.a_(),this.E_(h))}),x(h,Mc.EventType.ERROR,E=>{m||(m=!0,zo(Er,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),g.a_(new Se(ne.UNAVAILABLE,"The operation could not be completed")))}),x(h,Mc.EventType.MESSAGE,E=>{var T;if(!m){const w=E.data[0];at(!!w,16349);const v=w,O=(v==null?void 0:v.error)||((T=v[0])==null?void 0:T.error);if(O){Re(Er,`RPC '${e}' stream ${s} received error:`,O);const z=O.status;let U=function(A){const I=Vt[A];if(I!==void 0)return $A(I)}(z),_=O.message;U===void 0&&(U=ne.INTERNAL,_="Unknown error status: "+z+" with message "+O.message),m=!0,g.a_(new Se(U,_)),h.close()}else Re(Er,`RPC '${e}' stream ${s} received:`,w),g.u_(w)}}),x(o,cA.STAT_EVENT,E=>{E.stat===Yp.PROXY?Re(Er,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===Yp.NOPROXY&&Re(Er,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Nd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t){return new t7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="PersistentStream";class iS{constructor(e,r,n,s,i,a,o,c){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sS(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(Hs(r.toString()),Hs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Se(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Re(Hy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Re(Hy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class J7 extends iS{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=s7(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ve.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ve.min():a.readTime?us(a.readTime):Ve.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=om(this.serializer),r.addTarget=function(i,a){let o;const c=a.target;if(o=tm(c)?{documents:o7(i,c)}:{query:c7(i,c).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=KA(i,a.resumeToken);const l=sm(i,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(Ve.min())>0){o.readTime=Nh(i,a.snapshotVersion.toTimestamp());const l=sm(i,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=u7(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=om(this.serializer),r.removeTarget=e,this.q_(r)}}class Z7 extends iS{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=a7(e.writeResults,e.commitTime),n=us(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=om(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>i7(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{}class tU extends eU{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Se(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,im(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Se(ne.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,im(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Se(ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class rU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hs(r),this.aa=!1):Re("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia="RemoteStore";class nU{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{za(this)&&(Re(Ia,"Restarting streams for network reachability change."),await async function(c){const l=Be(c);l.Ea.add(4),await du(l),l.Ra.set("Unknown"),l.Ea.delete(4),await _0(l)}(this))})}),this.Ra=new rU(n,s)}}async function _0(t){if(za(t))for(const e of t.da)await e(!0)}async function du(t){for(const e of t.da)await e(!1)}function aS(t,e){const r=Be(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),d1(r)?h1(r):ac(r).O_()&&f1(r,e))}function u1(t,e){const r=Be(t),n=ac(r);r.Ia.delete(e),n.O_()&&oS(r,e),r.Ia.size===0&&(n.O_()?n.L_():za(r)&&r.Ra.set("Unknown"))}function f1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}ac(t).Y_(e)}function oS(t,e){t.Va.Ue(e),ac(t).Z_(e)}function h1(t){t.Va=new QV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ac(t).start(),t.Ra.ua()}function d1(t){return za(t)&&!ac(t).x_()&&t.Ia.size>0}function za(t){return Be(t).Ea.size===0}function cS(t){t.Va=void 0}async function sU(t){t.Ra.set("Online")}async function iU(t){t.Ia.forEach((e,r)=>{f1(t,e)})}async function aU(t,e){cS(t),d1(t)?(t.Ra.ha(e),h1(t)):t.Ra.set("Unknown")}async function oU(t,e,r){if(t.Ra.set("Online"),e instanceof GA&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Re(Ia,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Dh(t,n)}else if(e instanceof Ff?t.Va.Ze(e):e instanceof WA?t.Va.st(e):t.Va.tt(e),!r.isEqual(Ve.min()))try{const n=await nS(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(l);f&&i.Ia.set(l,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(pr.EMPTY_BYTE_STRING,f.snapshotVersion)),oS(i,c);const h=new mi(f.target,c,l,f.sequenceNumber);f1(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Re(Ia,"Failed to raise snapshot:",n),await Dh(t,n)}}async function Dh(t,e,r){if(!ic(e))throw e;t.Ea.add(1),await du(t),t.Ra.set("Offline"),r||(r=()=>nS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Re(Ia,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await _0(t)})}function lS(t,e){return e().catch(r=>Dh(t,r,e))}async function y0(t){const e=Be(t),r=Ui(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xg;for(;cU(e);)try{const s=await H7(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,lU(e,s)}catch(s){await Dh(e,s)}uS(e)&&fS(e)}function cU(t){return za(t)&&t.Ta.length<10}function lU(t,e){t.Ta.push(e);const r=Ui(t);r.O_()&&r.X_&&r.ea(e.mutations)}function uS(t){return za(t)&&!Ui(t).x_()&&t.Ta.length>0}function fS(t){Ui(t).start()}async function uU(t){Ui(t).ra()}async function fU(t){const e=Ui(t);for(const r of t.Ta)e.ea(r.mutations)}async function hU(t,e,r){const n=t.Ta.shift(),s=n1.from(n,e,r);await lS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await y0(t)}async function dU(t,e){e&&Ui(t).X_&&await async function(n,s){if(function(a){return qV(a)&&a!==ne.ABORTED}(s.code)){const i=n.Ta.shift();Ui(n).B_(),await lS(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await y0(n)}}(t,e),uS(t)&&fS(t)}async function $y(t,e){const r=Be(t);r.asyncQueue.verifyOperationInProgress(),Re(Ia,"RemoteStore received new credentials");const n=za(r);r.Ea.add(3),await du(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await _0(r)}async function pU(t,e){const r=Be(t);e?(r.Ea.delete(2),await _0(r)):e||(r.Ea.add(2),await du(r),r.Ra.set("Unknown"))}function ac(t){return t.ma||(t.ma=function(r,n,s){const i=Be(r);return i.sa(),new J7(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:sU.bind(null,t),t_:iU.bind(null,t),r_:aU.bind(null,t),H_:oU.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),d1(t)?h1(t):t.Ra.set("Unknown")):(await t.ma.stop(),cS(t))})),t.ma}function Ui(t){return t.fa||(t.fa=function(r,n,s){const i=Be(r);return i.sa(),new Z7(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:uU.bind(null,t),r_:dU.bind(null,t),ta:fU.bind(null,t),na:hU.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await y0(t)):(await t.fa.stop(),t.Ta.length>0&&(Re(Ia,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new p1(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function m1(t,e){if(Hs("AsyncQueue",`${e}: ${t}`),ic(t))return new Se(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{static emptySet(e){return new Po(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=Vc(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Po)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Po;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.ga=new St(Fe.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):be(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ko{constructor(e,r,n,s,i,a,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Ko(e,r,Po.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&d0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class gU{constructor(){this.queries=Gy(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Be(r),i=s.queries;s.queries=Gy(),i.forEach((a,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new Se(ne.ABORTED,"Firestore shutting down"))}}function Gy(){return new ja(t=>FA(t),d0)}async function hS(t,e){const r=Be(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new mU,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=m1(a,`Initialization of query '${eo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&g1(r)}async function dS(t,e){const r=Be(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function xU(t,e){const r=Be(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&g1(r)}function vU(t,e,r){const n=Be(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function g1(t){t.Ca.forEach(e=>{e.next()})}var um,Ky;(Ky=um||(um={})).Ma="default",Ky.Cache="cache";class pS{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Ko(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==um.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e){this.key=e}}class gS{constructor(e){this.key=e}}class _U{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=DA(e),this.tu=new Po(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Wy,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,h)=>{const d=s.get(f),m=p0(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;d&&m?d.data.isEqual(m.data)?g!==x&&(n.track({type:3,doc:m}),E=!0):this.su(d,m)||(n.track({type:2,doc:m}),E=!0,(c&&this.eu(m,c)>0||l&&this.eu(m,l)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),E=!0):d&&!m&&(n.track({type:1,doc:d}),E=!0,(c||l)&&(o=!0)),E&&(m?(a=a.add(m),i=x?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,h)=>function(m,g){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return be(20277,{Rt:E})}};return x(m)-x(g)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,l=c!==this.Za;return this.Za=c,a.length!==0||l?{snapshot:new Ko(this.query,e.tu,i,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new gS(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new mS(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Xe();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ko.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const x1="SyncEngine";class yU{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class EU{constructor(e){this.key=e,this.hu=!1}}class wU{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ja(o=>FA(o),d0),this.Iu=new Map,this.Eu=new Set,this.du=new St(Fe.comparator),this.Au=new Map,this.Ru=new a1,this.Vu={},this.mu=new Map,this.fu=Go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function TU(t,e,r=!0){const n=wS(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await xS(n,e,r,!0),s}async function kU(t,e){const r=wS(t);await xS(r,e,!0,!1)}async function xS(t,e,r,n){const s=await $7(t.localStore,ls(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await AU(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&aS(t.remoteStore,s),o}async function AU(t,e,r,n,s){t.pu=(h,d,m)=>async function(x,E,T,w){let v=E.view.ru(T);v.Cs&&(v=await Uy(x.localStore,E.query,!1).then(({documents:_})=>E.view.ru(_,v)));const O=w&&w.targetChanges.get(E.targetId),z=w&&w.targetMismatches.get(E.targetId)!=null,U=E.view.applyChanges(v,x.isPrimaryClient,O,z);return Xy(x,E.targetId,U.au),U.snapshot}(t,h,d,m);const i=await Uy(t.localStore,e,!0),a=new _U(e,i.Qs),o=a.ru(i.documents),c=hu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),l=a.applyChanges(o,t.isPrimaryClient,c);Xy(t,r,l.au);const f=new yU(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function SU(t,e,r){const n=Be(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!d0(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await cm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&u1(n.remoteStore,s.targetId),fm(n,s.targetId)}).catch(sc)):(fm(n,s.targetId),await cm(n.localStore,s.targetId,!0))}async function IU(t,e){const r=Be(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),u1(r.remoteStore,n.targetId))}async function CU(t,e,r){const n=bU(t);try{const s=await function(a,o){const c=Be(a),l=vt.now(),f=o.reduce((m,g)=>m.add(g.key),Xe());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=$s(),x=Xe();return c.Ns.getEntries(m,f).next(E=>{g=E,g.forEach((T,w)=>{w.isValidDocument()||(x=x.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(E=>{h=E;const T=[];for(const w of o){const v=HV(w,h.get(w.key).overlayedDocument);v!=null&&T.push(new Ki(w.key,v,kA(v.value.mapValue),kn.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,T,o)}).next(E=>{d=E;const T=E.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,E.batchId,T)})}).then(()=>({batchId:d.batchId,changes:bA(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,c){let l=a.Vu[a.currentUser.toKey()];l||(l=new St(qe)),l=l.insert(o,c),a.Vu[a.currentUser.toKey()]=l}(n,s.batchId,r),await pu(n,s.changes),await y0(n.remoteStore)}catch(s){const i=m1(s,"Failed to persist write");r.reject(i)}}async function vS(t,e){const r=Be(t);try{const n=await j7(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(at(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?at(a.hu,14607):s.removedDocuments.size>0&&(at(a.hu,42227),a.hu=!1))}),await pu(r,n,e)}catch(n){await sc(n)}}function qy(t,e,r){const n=Be(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const c=Be(a);c.onlineState=o;let l=!1;c.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(l=!0)}),l&&g1(c)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function RU(t,e,r){const n=Be(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new St(Fe.comparator);a=a.insert(i,Ar.newNoDocument(i,Ve.min()));const o=Xe().add(i),c=new x0(Ve.min(),new Map,new St(qe),a,o);await vS(n,c),n.du=n.du.remove(i),n.Au.delete(e),v1(n)}else await cm(n.localStore,e,!1).then(()=>fm(n,e,r)).catch(sc)}async function PU(t,e){const r=Be(t),n=e.batch.batchId;try{const s=await B7(r.localStore,e);yS(r,n,null),_S(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await pu(r,s)}catch(s){await sc(s)}}async function NU(t,e,r){const n=Be(t);try{const s=await function(a,o){const c=Be(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(at(h!==null,37113),f=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(n.localStore,e);yS(n,e,r),_S(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await pu(n,s)}catch(s){await sc(s)}}function _S(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function yS(t,e,r){const n=Be(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function fm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||ES(t,n)})}function ES(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(u1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),v1(t))}function Xy(t,e,r){for(const n of r)n instanceof mS?(t.Ru.addReference(n.key,e),FU(t,n)):n instanceof gS?(Re(x1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||ES(t,n.key)):be(19791,{wu:n})}function FU(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Re(x1,"New document in limbo: "+r),t.Eu.add(n),v1(t))}function v1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Fe(dt.fromString(e)),n=t.fu.next();t.Au.set(n,new EU(r)),t.du=t.du.insert(r,n),aS(t.remoteStore,new mi(ls(e1(r.path)),n,"TargetPurposeLimboResolution",u0.ce))}}async function pu(t,e,r){const n=Be(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{a.push(n.pu(c,e,r).then(l=>{var f;if((l||r)&&n.isPrimaryClient){const h=l?!l.fromCache:(f=r==null?void 0:r.targetChanges.get(c.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){s.push(l);const h=c1.As(c.targetId,l);i.push(h)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(c,l){const f=Be(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>se.forEach(l,d=>se.forEach(d.Es,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>se.forEach(d.ds,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!ic(h))throw h;Re(l1,"Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=f.Ms.get(d),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);f.Ms=f.Ms.insert(d,x)}}}(n.localStore,i))}async function DU(t,e){const r=Be(t);if(!r.currentUser.isEqual(e)){Re(x1,"User change. New user:",e.toKey());const n=await rS(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(o=>{o.forEach(c=>{c.reject(new Se(ne.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await pu(r,n.Ls)}}function OU(t,e){const r=Be(t),n=r.Au.get(e);if(n&&n.hu)return Xe().add(n.key);{let s=Xe();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const o=r.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function wS(t){const e=Be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RU.bind(null,e),e.Pu.H_=xU.bind(null,e.eventManager),e.Pu.yu=vU.bind(null,e.eventManager),e}function bU(t){const e=Be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NU.bind(null,e),e}class Oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=v0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return U7(this.persistence,new L7,e.initialUser,this.serializer)}Cu(e){return new tS(o1.mi,this.serializer)}Du(e){return new G7}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oh.provider={build:()=>new Oh};class LU extends Oh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){at(this.persistence.referenceDelegate instanceof Fh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new E7(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Wr.withCacheSize(this.cacheSizeBytes):Wr.DEFAULT;return new tS(n=>Fh.mi(n,r),this.serializer)}}class hm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>qy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=DU.bind(null,this.syncEngine),await pU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gU}()}createDatastore(e){const r=v0(e.databaseInfo.databaseId),n=function(i){return new Q7(i)}(e.databaseInfo);return function(i,a,o,c){return new tU(i,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new nU(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>qy(this.syncEngine,r,0),function(){return zy.v()?new zy:new K7}())}createSyncEngine(e,r){return function(s,i,a,o,c,l,f){const h=new wU(s,i,a,o,c,l);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Be(s);Re(Ia,"RemoteStore shutting down."),i.Ea.add(5),await du(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}hm.provider={build:()=>new hm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi="FirestoreClient";class MU{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=wr.UNAUTHENTICATED,this.clientId=qg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Re(Bi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Re(Bi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=m1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Fd(t,e){t.asyncQueue.verifyOperationInProgress(),Re(Bi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await rS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Yy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await VU(t);Re(Bi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>$y(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>$y(e.remoteStore,s)),t._onlineComponents=e}async function VU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Re(Bi,"Using user provided OfflineComponentProvider");try{await Fd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ne.FAILED_PRECONDITION||s.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;zo("Error using user provided cache. Falling back to memory cache: "+r),await Fd(t,new Oh)}}else Re(Bi,"Using default OfflineComponentProvider"),await Fd(t,new LU(void 0));return t._offlineComponents}async function kS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Re(Bi,"Using user provided OnlineComponentProvider"),await Yy(t,t._uninitializedComponentsProvider._online)):(Re(Bi,"Using default OnlineComponentProvider"),await Yy(t,new hm))),t._onlineComponents}function UU(t){return kS(t).then(e=>e.syncEngine)}async function AS(t){const e=await kS(t),r=e.eventManager;return r.onListen=TU.bind(null,e.syncEngine),r.onUnlisten=SU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=kU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=IU.bind(null,e.syncEngine),r}function BU(t,e,r={}){const n=new bs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,c,l){const f=new TS({next:d=>{f.Nu(),a.enqueueAndForget(()=>dS(i,h));const m=d.docs.has(o);!m&&d.fromCache?l.reject(new Se(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&c&&c.source==="server"?l.reject(new Se(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new pS(e1(o.path),f,{includeMetadataChanges:!0,qa:!0});return hS(i,h)}(await AS(t),t.asyncQueue,e,r,n)),n.promise}function jU(t,e,r={}){const n=new bs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,c,l){const f=new TS({next:d=>{f.Nu(),a.enqueueAndForget(()=>dS(i,h)),d.fromCache&&c.source==="server"?l.reject(new Se(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new pS(o,f,{includeMetadataChanges:!0,qa:!0});return hS(i,h)}(await AS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="firestore.googleapis.com",Jy=!0;class Zy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=IS,this.ssl=Jy}else this.host=e.host,this.ssl=e.ssl??Jy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<_7)throw new Se(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SS(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Se(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Se(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Se(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class E0{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new K9;switch(n.type){case"firstParty":return new Q9(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Se(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Qy.get(r);n&&(Re("ComponentProvider","Removing Datastore"),Qy.delete(r),n.terminate())}(this),Promise.resolve()}}function zU(t,e,r,n={}){var l;t=Gn(t,E0);const s=ec(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(pk(`https://${o}`),mk("Firestore",!0)),i.host!==IS&&i.host!==o&&zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:o,ssl:s,emulatorOptions:n};if(!Oi(c,a)&&(t._setSettings(c),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=wr.MOCK_USER;else{f=eL(n.mockUserToken,(l=t._app)==null?void 0:l.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Se(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new wr(d)}t._authCredentials=new q9(new hA(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new oc(this.firestore,e,this._query)}}class bt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bt(this.firestore,e,this._key)}toJSON(){return{type:bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(lu(r,bt._jsonSchema))return new bt(e,n||null,new Fe(dt.fromString(r.referencePath)))}}bt._jsonSchemaVersion="firestore/documentReference/1.0",bt._jsonSchema={type:Ht("string",bt._jsonSchemaVersion),referencePath:Ht("string")};class Ci extends oc{constructor(e,r,n){super(e,r,e1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bt(this.firestore,null,new Fe(e))}withConverter(e){return new Ci(this.firestore,e,this._path)}}function dm(t,e,...r){if(t=Lt(t),dA("collection","path",e),t instanceof E0){const n=dt.fromString(e,...r);return hy(n),new Ci(t,null,n)}{if(!(t instanceof bt||t instanceof Ci))throw new Se(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(dt.fromString(e,...r));return hy(n),new Ci(t.firestore,null,n)}}function Ri(t,e,...r){if(t=Lt(t),arguments.length===1&&(e=qg.newId()),dA("doc","path",e),t instanceof E0){const n=dt.fromString(e,...r);return fy(n),new bt(t,null,new Fe(n))}{if(!(t instanceof bt||t instanceof Ci))throw new Se(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(dt.fromString(e,...r));return fy(n),new bt(t.firestore,t instanceof Ci?t.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE="AsyncQueue";class tE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sS(this,"async_queue_retry"),this._c=()=>{const n=Nd();n&&Re(eE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Nd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Nd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new bs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ic(e))throw e;Re(eE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Hs("INTERNAL UNHANDLED ERROR: ",rE(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=p1.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&be(47125,{Pc:rE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function rE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ha extends E0{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new tE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tE(e),this._firestoreClient=void 0,await e}}}function HU(t,e){const r=typeof t=="object"?t:Vg(),n=typeof t=="string"?t:Ah,s=Ua(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=J8("firestore");i&&zU(s,...i)}return s}function _1(t){if(t._terminated)throw new Se(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$U(t),t._firestoreClient}function $U(t){var n,s,i;const e=t._freezeSettings(),r=function(o,c,l,f){return new pV(o,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,SS(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new MU(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(pr.fromBase64String(e))}catch(r){throw new Se(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new yn(pr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(lu(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:Ht("string",yn._jsonSchemaVersion),bytes:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Se(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Se(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Se(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fs._jsonSchemaVersion}}static fromJSON(e){if(lu(e,fs._jsonSchema))return new fs(e.latitude,e.longitude)}}fs._jsonSchemaVersion="firestore/geoPoint/1.0",fs._jsonSchema={type:Ht("string",fs._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:hs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(lu(e,hs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new hs(e.vectorValues);throw new Se(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}hs._jsonSchemaVersion="firestore/vectorValue/1.0",hs._jsonSchema={type:Ht("string",hs._jsonSchemaVersion),vectorValues:Ht("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU=/^__.*__$/;class GU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ki(e,this.data,this.fieldMask,r,this.fieldTransforms):new fu(e,this.data,r,this.fieldTransforms)}}class CS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Ki(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function RS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw be(40011,{Ac:t})}}class E1{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new E1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return bh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(RS(this.Ac)&&WU.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class KU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||v0(e)}Cc(e,r,n,s=!1){return new E1({Ac:e,methodName:r,Dc:n,path:lr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function T0(t){const e=t._freezeSettings(),r=v0(t._databaseId);return new KU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function PS(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);w1("Data must be an object, but it was:",a,n);const o=NS(n,a);let c,l;if(i.merge)c=new an(a.fieldMask),l=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const h of i.mergeFields){const d=pm(e,h,r);if(!a.contains(d))throw new Se(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);DS(f,d)||f.push(d)}c=new an(f),l=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=a.fieldTransforms;return new GU(new Kr(o),c,l)}class k0 extends y1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof k0}}function qU(t,e,r,n){const s=t.Cc(1,e,r);w1("Data must be an object, but it was:",s,n);const i=[],a=Kr.empty();Gi(n,(c,l)=>{const f=T1(e,c,r);l=Lt(l);const h=s.yc(f);if(l instanceof k0)i.push(f);else{const d=mu(l,h);d!=null&&(i.push(f),a.set(f,d))}});const o=new an(i);return new CS(a,o,s.fieldTransforms)}function XU(t,e,r,n,s,i){const a=t.Cc(1,e,r),o=[pm(e,n,r)],c=[s];if(i.length%2!=0)throw new Se(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(pm(e,i[d])),c.push(i[d+1]);const l=[],f=Kr.empty();for(let d=o.length-1;d>=0;--d)if(!DS(l,o[d])){const m=o[d];let g=c[d];g=Lt(g);const x=a.yc(m);if(g instanceof k0)l.push(m);else{const E=mu(g,x);E!=null&&(l.push(m),f.set(m,E))}}const h=new an(l);return new CS(f,h,a.fieldTransforms)}function YU(t,e,r,n=!1){return mu(r,t.Cc(n?4:3,e))}function mu(t,e){if(FS(t=Lt(t)))return w1("Unsupported field value:",e,t),NS(t,e);if(t instanceof y1)return function(n,s){if(!RS(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let c=mu(o,s.wc(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Lt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return MV(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=vt.fromDate(n);return{timestampValue:Nh(s.serializer,i)}}if(n instanceof vt){const i=new vt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Nh(s.serializer,i)}}if(n instanceof fs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yn)return{bytesValue:KA(s.serializer,n._byteString)};if(n instanceof bt){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:i1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof hs)return function(a,o){return{mapValue:{fields:{[wA]:{stringValue:TA},[Sh]:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return t1(o.serializer,l)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${l0(n)}`)}(t,e)}function NS(t,e){const r={};return gA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gi(t,(n,s)=>{const i=mu(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function FS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof fs||t instanceof yn||t instanceof bt||t instanceof y1||t instanceof hs)}function w1(t,e,r){if(!FS(r)||!pA(r)){const n=l0(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function pm(t,e,r){if((e=Lt(e))instanceof w0)return e._internalPath;if(typeof e=="string")return T1(t,e);throw bh("Field path arguments must be of type string or ",t,!1,void 0,r)}const QU=new RegExp("[~\\*/\\[\\]]");function T1(t,e,r){if(e.search(QU)>=0)throw bh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new w0(...e.split("."))._internalPath}catch{throw bh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function bh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${n}`),a&&(c+=` in document ${s}`),c+=")"),new Se(ne.INVALID_ARGUMENT,o+t+c)}function DS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(k1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class JU extends OS{data(){return super.data()}}function k1(t,e){return typeof e=="string"?T1(t,e):e instanceof w0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Se(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class A1{}class eB extends A1{}function bS(t,e,...r){let n=[];e instanceof A1&&n.push(e),n=n.concat(r),function(i){const a=i.filter(c=>c instanceof S1).length,o=i.filter(c=>c instanceof A0).length;if(a>1||a>0&&o>0)throw new Se(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class A0 extends eB{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new A0(e,r,n)}_apply(e){const r=this._parse(e);return MS(e._query,r),new oc(e.firestore,e.converter,rm(e._query,r))}_parse(e){const r=T0(e.firestore);return function(i,a,o,c,l,f,h){let d;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Se(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){sE(h,f);const g=[];for(const x of h)g.push(nE(c,i,x));d={arrayValue:{values:g}}}else d=nE(c,i,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||sE(h,f),d=YU(o,a,h,f==="in"||f==="not-in");return zt.create(l,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function LS(t,e,r){const n=e,s=k1("where",t);return A0._create(s,n,r)}class S1 extends A1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new S1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Kn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const c of o)MS(a,c),a=rm(a,c)}(e._query,r),new oc(e.firestore,e.converter,rm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function nE(t,e,r){if(typeof(r=Lt(r))=="string"){if(r==="")throw new Se(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!NA(e)&&r.indexOf("/")!==-1)throw new Se(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(dt.fromString(r));if(!Fe.isDocumentKey(n))throw new Se(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return yy(t,new Fe(n))}if(r instanceof bt)return yy(t,r._key);throw new Se(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${l0(r)}.`)}function sE(t,e){if(!Array.isArray(t)||t.length===0)throw new Se(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MS(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Se(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Se(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class tB{convertValue(e,r="none"){switch(Vi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw be(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Gi(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[Sh].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>Dt(a.doubleValue));return new hs(r)}convertGeoPoint(e){return new fs(Dt(e.latitude),Dt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=h0(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(jl(e));default:return null}}convertTimestamp(e){const r=Li(e);return new vt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=dt.fromString(e);at(ZA(n),9688,{name:e});const s=new zl(n.get(1),n.get(3)),i=new Fe(n.popFirst(5));return s.isEqual(r)||Hs(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Bc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ma extends OS{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Df(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(k1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ma._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ma._jsonSchemaVersion="firestore/documentSnapshot/1.0",ma._jsonSchema={type:Ht("string",ma._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class Df extends ma{data(e={}){return super.data(e)}}class No{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Bc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Df(this._firestore,this._userDataWriter,n.key,n,new Bc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Se(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const c=new Df(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const c=new Df(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,f=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:rB(o.type),doc:c,oldIndex:l,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=No._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=qg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return be(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(t){t=Gn(t,bt);const e=Gn(t.firestore,Ha);return BU(_1(e),t._key).then(r=>iB(e,t,r))}No._jsonSchemaVersion="firestore/querySnapshot/1.0",No._jsonSchema={type:Ht("string",No._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class BS extends tB{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new bt(this.firestore,null,r)}}function jS(t){t=Gn(t,oc);const e=Gn(t.firestore,Ha),r=_1(e),n=new BS(e);return ZU(t._query),jU(r,t._query).then(s=>new No(e,n,t,s))}function zS(t,e,r){t=Gn(t,bt);const n=Gn(t.firestore,Ha),s=VS(t.converter,e);return S0(n,[PS(T0(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,kn.none())])}function nB(t,e,r,...n){t=Gn(t,bt);const s=Gn(t.firestore,Ha),i=T0(s);let a;return a=typeof(e=Lt(e))=="string"||e instanceof w0?XU(i,"updateDoc",t._key,e,r,n):qU(i,"updateDoc",t._key,e),S0(s,[a.toMutation(t._key,kn.exists(!0))])}function HS(t){return S0(Gn(t.firestore,Ha),[new r1(t._key,kn.none())])}function sB(t,e){const r=Gn(t.firestore,Ha),n=Ri(t),s=VS(t.converter,e);return S0(r,[PS(T0(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,kn.exists(!1))]).then(()=>n)}function S0(t,e){return function(n,s){const i=new bs;return n.asyncQueue.enqueueAndForget(async()=>CU(await UU(n),s,i)),i.promise}(_1(t),e)}function iB(t,e,r){const n=r.docs.get(e._key),s=new BS(t);return new ma(t,s,e._key,n,new Bc(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){nc=s})(tc),ps(new $n("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new Ha(new X9(n.getProvider("auth-internal")),new J9(a,n.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Se(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zl(l.options.projectId,f)}(a,s),a);return i={useFetchStreams:r,...i},o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Tn(oy,cy,e),Tn(oy,cy,"esm2020")})();const $S="@firebase/installations",I1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=1e4,GS=`w:${I1}`,KS="FIS_v2",aB="https://firebaseinstallations.googleapis.com/v1",oB=60*60*1e3,cB="installations",lB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ca=new Va(cB,lB,uB);function qS(t){return t instanceof qn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS({projectId:t}){return`${aB}/projects/${t}/installations`}function YS(t){return{token:t.token,requestStatus:2,expiresIn:hB(t.expiresIn),creationTime:Date.now()}}async function QS(t,e){const n=(await e.json()).error;return Ca.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function JS({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function fB(t,{refreshToken:e}){const r=JS(t);return r.append("Authorization",dB(e)),r}async function ZS(t){const e=await t();return e.status>=500&&e.status<600?t():e}function hB(t){return Number(t.replace("s","000"))}function dB(t){return`${KS} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=XS(t),s=JS(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const a={fid:r,authVersion:KS,appId:t.appId,sdkVersion:GS},o={method:"POST",headers:s,body:JSON.stringify(a)},c=await ZS(()=>fetch(n,o));if(c.ok){const l=await c.json();return{fid:l.fid||r,registrationStatus:2,refreshToken:l.refreshToken,authToken:YS(l.authToken)}}else throw await QS("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gB=/^[cdef][\w-]{21}$/,mm="";function xB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=vB(t);return gB.test(r)?r:mm}catch{return mm}}function vB(t){return mB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=new Map;function rI(t,e){const r=I0(t);nI(r,e),_B(r,e)}function nI(t,e){const r=tI.get(t);if(r)for(const n of r)n(e)}function _B(t,e){const r=yB();r&&r.postMessage({key:t,fid:e}),EB()}let ua=null;function yB(){return!ua&&"BroadcastChannel"in self&&(ua=new BroadcastChannel("[Firebase] FID Change"),ua.onmessage=t=>{nI(t.data.key,t.data.fid)}),ua}function EB(){tI.size===0&&ua&&(ua.close(),ua=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB="firebase-installations-database",TB=1,Ra="firebase-installations-store";let Dd=null;function C1(){return Dd||(Dd=Ek(wB,TB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ra)}}})),Dd}async function Lh(t,e){const r=I0(t),s=(await C1()).transaction(Ra,"readwrite"),i=s.objectStore(Ra),a=await i.get(r);return await i.put(e,r),await s.done,(!a||a.fid!==e.fid)&&rI(t,e.fid),e}async function sI(t){const e=I0(t),n=(await C1()).transaction(Ra,"readwrite");await n.objectStore(Ra).delete(e),await n.done}async function C0(t,e){const r=I0(t),s=(await C1()).transaction(Ra,"readwrite"),i=s.objectStore(Ra),a=await i.get(r),o=e(a);return o===void 0?await i.delete(r):await i.put(o,r),await s.done,o&&(!a||a.fid!==o.fid)&&rI(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(t){let e;const r=await C0(t.appConfig,n=>{const s=kB(n),i=AB(t,s);return e=i.registrationPromise,i.installationEntry});return r.fid===mm?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function kB(t){const e=t||{fid:xB(),registrationStatus:0};return iI(e)}function AB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Ca.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=SB(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:IB(t)}:{installationEntry:e}}async function SB(t,e){try{const r=await pB(t,e);return Lh(t.appConfig,r)}catch(r){throw qS(r)&&r.customData.serverCode===409?await sI(t.appConfig):await Lh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function IB(t){let e=await iE(t.appConfig);for(;e.registrationStatus===1;)await eI(100),e=await iE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await R1(t);return n||r}return e}function iE(t){return C0(t,e=>{if(!e)throw Ca.create("installation-not-found");return iI(e)})}function iI(t){return CB(t)?{fid:t.fid,registrationStatus:0}:t}function CB(t){return t.registrationStatus===1&&t.registrationTime+WS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RB({appConfig:t,heartbeatServiceProvider:e},r){const n=PB(t,r),s=fB(t,r),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const a={installation:{sdkVersion:GS,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(a)},c=await ZS(()=>fetch(n,o));if(c.ok){const l=await c.json();return YS(l)}else throw await QS("Generate Auth Token",c)}function PB(t,{fid:e}){return`${XS(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P1(t,e=!1){let r;const n=await C0(t.appConfig,i=>{if(!aI(i))throw Ca.create("not-registered");const a=i.authToken;if(!e&&DB(a))return i;if(a.requestStatus===1)return r=NB(t,e),i;{if(!navigator.onLine)throw Ca.create("app-offline");const o=bB(i);return r=FB(t,o),o}});return r?await r:n.authToken}async function NB(t,e){let r=await aE(t.appConfig);for(;r.authToken.requestStatus===1;)await eI(100),r=await aE(t.appConfig);const n=r.authToken;return n.requestStatus===0?P1(t,e):n}function aE(t){return C0(t,e=>{if(!aI(e))throw Ca.create("not-registered");const r=e.authToken;return LB(r)?{...e,authToken:{requestStatus:0}}:e})}async function FB(t,e){try{const r=await RB(t,e),n={...e,authToken:r};return await Lh(t.appConfig,n),r}catch(r){if(qS(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await sI(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Lh(t.appConfig,n)}throw r}}function aI(t){return t!==void 0&&t.registrationStatus===2}function DB(t){return t.requestStatus===2&&!OB(t)}function OB(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+oB}function bB(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function LB(t){return t.requestStatus===1&&t.requestTime+WS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MB(t){const e=t,{installationEntry:r,registrationPromise:n}=await R1(e);return n?n.catch(console.error):P1(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VB(t,e=!1){const r=t;return await UB(r),(await P1(r,e)).token}async function UB(t){const{registrationPromise:e}=await R1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(t){if(!t||!t.options)throw Od("App Configuration");if(!t.name)throw Od("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw Od(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Od(t){return Ca.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="installations",jB="installations-internal",zB=t=>{const e=t.getProvider("app").getImmediate(),r=BB(e),n=Ua(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},HB=t=>{const e=t.getProvider("app").getImmediate(),r=Ua(e,oI).getImmediate();return{getId:()=>MB(r),getToken:s=>VB(r,s)}};function $B(){ps(new $n(oI,zB,"PUBLIC")),ps(new $n(jB,HB,"PRIVATE"))}$B();Tn($S,I1);Tn($S,I1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="analytics",WB="firebase_id",GB="origin",KB=60*1e3,qB="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",N1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new i0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XB={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},cn=new Va("analytics","Analytics",XB);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YB(t){if(!t.startsWith(N1)){const e=cn.create("invalid-gtag-resource",{gtagURL:t});return Jr.warn(e.message),""}return t}function cI(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function QB(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function JB(t,e){const r=QB("firebase-js-sdk-policy",{createScriptURL:YB}),n=document.createElement("script"),s=`${N1}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function ZB(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function ej(t,e,r,n,s,i){const a=n[s];try{if(a)await e[a];else{const c=(await cI(r)).find(l=>l.measurementId===s);c&&await e[c.appId]}}catch(o){Jr.error(o)}t("config",s,i)}async function tj(t,e,r,n,s){try{let i=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const o=await cI(r);for(const c of a){const l=o.find(h=>h.measurementId===c),f=l&&e[l.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",n,s||{})}catch(i){Jr.error(i)}}function rj(t,e,r,n){async function s(i,...a){try{if(i==="event"){const[o,c]=a;await tj(t,e,r,o,c)}else if(i==="config"){const[o,c]=a;await ej(t,e,r,n,o,c)}else if(i==="consent"){const[o,c]=a;t("consent",o,c)}else if(i==="get"){const[o,c,l]=a;t("get",o,c,l)}else if(i==="set"){const[o]=a;t("set",o)}else t(i,...a)}catch(o){Jr.error(o)}}return s}function nj(t,e,r,n,s){let i=function(...a){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=rj(i,t,e,r),{gtagCore:i,wrappedGtag:window[s]}}function sj(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(N1)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=30,aj=1e3;class oj{constructor(e={},r=aj){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const lI=new oj;function cj(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function lj(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:cj(r)},s=qB.replace("{app-id}",e),i=await fetch(s,n);if(i.status!==200&&i.status!==304){let o="";try{const c=await i.json();(a=c.error)!=null&&a.message&&(o=c.error.message)}catch{}throw cn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function uj(t,e=lI,r){const{appId:n,apiKey:s,measurementId:i}=t.options;if(!n)throw cn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw cn.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new dj;return setTimeout(async()=>{o.abort()},KB),uI({appId:n,apiKey:s,measurementId:i},a,o,e)}async function uI(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=lI){var o;const{appId:i,measurementId:a}=t;try{await fj(n,e)}catch(c){if(a)return Jr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:a};throw c}try{const c=await lj(t);return s.deleteThrottleMetadata(i),c}catch(c){const l=c;if(!hj(l)){if(s.deleteThrottleMetadata(i),a)return Jr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:a};throw c}const f=Number((o=l==null?void 0:l.customData)==null?void 0:o.httpStatus)===503?F_(r,s.intervalMillis,ij):F_(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return s.setThrottleMetadata(i,h),Jr.debug(`Calling attemptFetch again in ${f} millis`),uI(t,h,n,s)}}function fj(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(i),n(cn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function hj(t){if(!(t instanceof qn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class dj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function pj(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const i=await e,a={...n,send_to:i};t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mj(){if(xk())try{await vk()}catch(t){return Jr.warn(cn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Jr.warn(cn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function gj(t,e,r,n,s,i,a){const o=uj(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&Jr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>Jr.error(d)),e.push(o);const c=mj().then(d=>{if(d)return n.getId()}),[l,f]=await Promise.all([o,c]);sj(i)||JB(i,l.measurementId),s("js",new Date);const h=(a==null?void 0:a.config)??{};return h[GB]="firebase",h.update=!0,f!=null&&(h[WB]=f),s("config",l.measurementId,h),l.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e){this.app=e}_delete(){return delete fl[this.app.options.appId],Promise.resolve()}}let fl={},oE=[];const cE={};let bd="dataLayer",vj="gtag",lE,fI,uE=!1;function _j(){const t=[];if(gk()&&t.push("This is a browser extension environment."),lL()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=cn.create("invalid-analytics-context",{errorInfo:e});Jr.warn(r.message)}}function yj(t,e,r){_j();const n=t.options.appId;if(!n)throw cn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Jr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw cn.create("no-api-key");if(fl[n]!=null)throw cn.create("already-exists",{id:n});if(!uE){ZB(bd);const{wrappedGtag:i,gtagCore:a}=nj(fl,oE,cE,bd,vj);fI=i,lE=a,uE=!0}return fl[n]=gj(t,oE,cE,e,lE,bd,r),new xj(t)}function Ej(t=Vg()){t=Lt(t);const e=Ua(t,Mh);return e.isInitialized()?e.getImmediate():wj(t)}function wj(t,e={}){const r=Ua(t,Mh);if(r.isInitialized()){const s=r.getImmediate();if(Oi(e,r.getOptions()))return s;throw cn.create("already-initialized")}return r.initialize({options:e})}function Tj(t,e,r,n){t=Lt(t),pj(fI,fl[t.app.options.appId],e,r,n).catch(s=>Jr.error(s))}const fE="@firebase/analytics",hE="0.10.18";function kj(){ps(new $n(Mh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return yj(n,s,r)},"PUBLIC")),ps(new $n("analytics-internal",t,"PRIVATE")),Tn(fE,hE),Tn(fE,hE,"esm2020");function t(e){try{const r=e.getProvider(Mh).getImmediate();return{logEvent:(n,s,i)=>Tj(r,n,s,i)}}catch(r){throw cn.create("interop-component-reg-failed",{reason:r})}}}kj();const Aj={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},F1=wk(Aj),uf=H9(F1),rs=HU(F1);typeof window<"u"&&Ej(F1);const hI=We.createContext(),D1=()=>{const t=We.useContext(hI);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},Sj=({children:t})=>{const[e,r]=We.useState(null),[n,s]=We.useState(!0),[i,a]=We.useState(null),o=async(h,d,m)=>{try{a(null);const g=await AM(uf,h,d);return m&&await CM(g.user,{displayName:m}),g.user}catch(g){throw a(g.message),g}},c=async(h,d)=>{try{return a(null),(await SM(uf,h,d)).user}catch(m){throw a(m.message),m}},l=async()=>{try{a(null),await FM(uf)}catch(h){throw a(h.message),h}};We.useEffect(()=>NM(uf,d=>{r(d),s(!1)}),[]);const f={user:e,loading:n,error:i,register:o,login:c,logout:l,clearError:()=>a(null)};return R.jsx(hI.Provider,{value:f,children:t})},ns={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData"};let Gl=!1;const ss=(t,e)=>{if(t.code==="permission-denied")return Gl||(console.warn(" Firebase Firestore: Permisos insuficientes. La aplicacin funciona en modo demo."),console.info(" Para habilitar persistencia, configura Firestore siguiendo las instrucciones en FIREBASE_SETUP.md"),Gl=!0),null;if(t.code==="failed-precondition"&&t.message.includes("index"))return console.info(" Firebase est creando ndices necesarios. Usando datos locales temporalmente."),console.info(" Estado del ndice: https://console.firebase.google.com/project/centralteleoperadores/firestore/indexes"),null;throw console.error(`Error en ${e}:`,t),t},Ld={async create(t,e){try{return{id:(await sB(dm(rs,ns.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){return ss(r,"crear operador")}},async getByUser(t){if(Gl)return[];try{const e=bS(dm(rs,ns.OPERATORS),LS("userId","==",t));return(await jS(e)).docs.map(s=>({id:s.id,...s.data()})).sort((s,i)=>{var c,l,f,h;const a=((l=(c=s.createdAt)==null?void 0:c.toDate)==null?void 0:l.call(c))||new Date(0);return(((h=(f=i.createdAt)==null?void 0:f.toDate)==null?void 0:h.call(f))||new Date(0))-a})}catch(e){return ss(e,"obtener operadores")||[]}},async update(t,e){try{const r=Ri(rs,ns.OPERATORS,t);return await nB(r,{...e,updatedAt:new Date}),!0}catch(r){return ss(r,"actualizar operador")}},async delete(t){try{return await HS(Ri(rs,ns.OPERATORS,t)),!0}catch(e){return ss(e,"eliminar operador")}}},ff={async saveOperatorAssignments(t,e,r){try{const n=Ri(rs,ns.ASSIGNMENTS,`${t}_${e}`);return await zS(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date}),!0}catch(n){return ss(n,"guardar asignaciones")}},async getOperatorAssignments(t,e){try{const r=Ri(rs,ns.ASSIGNMENTS,`${t}_${e}`),n=await US(r);return n.exists()?n.data().assignments||[]:[]}catch(r){return ss(r,"obtener asignaciones")||[]}},async getAllUserAssignments(t){if(Gl)return{};try{const e=bS(dm(rs,ns.ASSIGNMENTS),LS("userId","==",t)),r=await jS(e),n={};return r.docs.forEach(s=>{const i=s.data();n[i.operatorId]=i.assignments||[]}),n}catch(e){return ss(e,"obtener todas las asignaciones")||{}}},async deleteOperatorAssignments(t,e){try{return await HS(Ri(rs,ns.ASSIGNMENTS,`${t}_${e}`)),!0}catch(r){return ss(r,"eliminar asignaciones")}}},dE={async saveCallData(t,e){try{const r=Ri(rs,ns.CALL_DATA,t);return await zS(r,{userId:t,callData:e,updatedAt:new Date}),!0}catch(r){return ss(r,"guardar datos de llamadas")}},async getCallData(t){if(Gl)return[];try{const e=Ri(rs,ns.CALL_DATA,t),r=await US(e);return r.exists()?r.data().callData||[]:[]}catch(e){return ss(e,"obtener datos de llamadas")||[]}}},Ij=()=>{const{user:t,logout:e}=D1(),[r,n]=We.useState("dashboard"),[s,i]=We.useState([]),[a,o]=We.useState([]),[c,l]=We.useState([]),[f,h]=We.useState("connecting"),[d,m]=We.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[g,x]=We.useState([]),[E,T]=We.useState([]),[w,v]=We.useState("all"),[O,z]=We.useState(""),[U,_]=We.useState([]),[k,A]=We.useState(!1),[I,P]=We.useState(null),[C,F]=We.useState({name:"",email:"",phone:""}),[me,he]=We.useState({}),[Ce,_e]=We.useState(null),ie=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}],W=We.useRef(!1),[fe,ke]=We.useState(!1);We.useEffect(()=>{t&&!fe&&!W.current&&L()},[t,fe]),We.useEffect(()=>{s.length>0&&a.length>0&&(console.log(" Re-analizando datos tras actualizacin de asignaciones..."),$e(s))},[a]);const L=async()=>{if(!W.current){W.current=!0,h("connecting");try{const Z=await Ld.getByUser(t.uid);if(Z!==null){_(Z||[]);const oe=await ff.getAllUserAssignments(t.uid);he(oe||{});const we=await dE.getCallData(t.uid);i(we||[]),K(oe||{},Z||[]),we&&we.length>0?(console.log(" Analizando datos reales de llamadas..."),setTimeout(()=>$e(we),100)):(console.log(" No hay datos de llamadas, inicializando mtricas por defecto..."),He()),h("connected"),ke(!0),console.log(" Conectado a Firebase - persistencia habilitada")}else throw new Error("Insufficient permissions")}catch{h("demo"),ke(!0),G()}finally{W.current=!1}}},K=(Z,oe)=>{const we=[];Object.entries(Z).forEach(([ce,Te])=>{const Pe=oe.find(De=>De.id===ce);Pe&&Te&&Te.forEach(De=>{we.push({id:De.id,operator:Pe.name,beneficiary:De.beneficiary,phone:De.primaryPhone,commune:De.commune})})}),o(we)},G=()=>{console.log(" Inicializando con datos de ejemplo..."),o(ie),H(),He(),console.log(" Datos de ejemplo inicializados")},H=()=>{const oe=[{id:"sample-1",name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-2",name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-3",name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-4",name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-5",name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325",userId:(t==null?void 0:t.uid)||"demo-user"}].filter(we=>we&&we.id&&we.name);_(oe)},re=async()=>{if(C.name.trim()!=="")try{const Z=await Ld.create(t.uid,C);_([...U,Z]),F({name:"",email:"",phone:""}),A(!1)}catch(Z){console.error("Error creating operator:",Z),alert("Error al crear teleoperador. Intenta nuevamente.")}},de=async Z=>{try{await Ld.delete(Z),await ff.deleteOperatorAssignments(t.uid,Z),_(U.filter(ce=>ce.id!==Z));const oe={...me};delete oe[Z],he(oe);const we=a.filter(ce=>!ce.id.toString().startsWith(`${Z}-`));o(we)}catch(oe){console.error("Error deleting operator:",oe),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},Ae=(Z,oe)=>{const we=Z.target.files[0];if(we){const ce=new FileReader;ce.onload=Te=>{const Pe=new Uint8Array(Te.target.result),De=mh(Pe,{type:"array"}),it=De.SheetNames[0],dn=De.Sheets[it],cc=C_.sheet_to_json(dn,{header:1});ge(cc,oe)},ce.readAsArrayBuffer(we)}Z.target.value=""},ge=async(Z,oe)=>{if(Z.length<2)return;const we=U.find(Te=>Te.id===oe);if(!we)return;const ce=Z.slice(1).map((Te,Pe)=>{const De=Te[1]?String(Te[1]).split(/[\|\-\s]+/).filter(it=>it.trim().length===9):[];return{id:`${oe}-${Pe}`,operatorId:oe,operatorName:we.name,beneficiary:Te[0]||"",phones:De,primaryPhone:De[0]||"",commune:Te[2]||""}}).filter(Te=>Te.beneficiary&&Te.primaryPhone);try{await ff.saveOperatorAssignments(t.uid,oe,ce),he(Pe=>({...Pe,[oe]:ce}));const Te=ce.map(Pe=>({id:Pe.id,operator:Pe.operatorName,beneficiary:Pe.beneficiary,phone:Pe.primaryPhone,commune:Pe.commune}));o(Pe=>[...Pe.filter(it=>!it.id.toString().startsWith(`${oe}-`)),...Te]),_e(null)}catch(Te){console.error("Error saving assignments:",Te),alert("Error al guardar asignaciones. Intenta nuevamente.")}},ae=async Z=>{try{await ff.deleteOperatorAssignments(t.uid,Z);const oe={...me};delete oe[Z],he(oe),o(we=>we.filter(ce=>!ce.id.toString().startsWith(`${Z}-`)))}catch(oe){console.error("Error clearing assignments:",oe),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},He=()=>{if(s.length>0){console.log(" Datos reales disponibles, omitiendo generacin de datos de ejemplo");return}console.log(" Generando datos de ejemplo...");const oe=(U.length>0?U.map(it=>it.name):["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"]).map(it=>({operator:it,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),we=Array.from({length:24},(it,dn)=>({hour:dn,calls:Math.floor(Math.random()*20)+1}));x(oe),T(we),m({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:a.length||5,operators:U.length||5,protocolCompliance:85,pendingFollowUps:12});const ce=["al-dia","pendiente","urgente"],Te={"al-dia":"bg-green-100 text-green-800",pendiente:"bg-yellow-100 text-yellow-800",urgente:"bg-red-100 text-red-800"},De=(a.length>0?a:ie).map(it=>({...it,status:ce[Math.floor(Math.random()*ce.length)],lastCall:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString(),callCount:Math.floor(Math.random()*10)+1,colorClass:Te[ce[Math.floor(Math.random()*ce.length)]]}));l(De)},j=Z=>{const oe=Z.target.files[0];if(oe){const we=new FileReader;we.onload=ce=>{const Te=new Uint8Array(ce.target.result),Pe=mh(Te,{type:"array"}),De=Pe.SheetNames[0],it=Pe.Sheets[De],dn=C_.sheet_to_json(it,{header:1});lt(dn)},we.readAsArrayBuffer(oe)}},lt=async Z=>{if(Z.length<2)return;const oe=Z.slice(1).map(we=>({id:we[0],date:we[1],beneficiary:we[2],commune:we[3],event:we[4],phone:we[5],startTime:we[6],endTime:we[7],duration:we[8],result:we[9],observation:we[10],apiId:we[11]}));try{f==="connected"&&await dE.saveCallData(t.uid,oe)&&console.log(" Datos de llamadas guardados en Firebase")}catch(we){console.error("Error guardando datos en Firebase:",we)}i(oe),$e(oe)},$e=Z=>{const oe=Z.filter(Pe=>Pe.result==="Llamado exitoso"),we=Z.filter(Pe=>Pe.result!=="Llamado exitoso"),ce=new Set(Z.map(Pe=>Pe.beneficiary)).size;m(Pe=>({...Pe,totalCalls:Z.length,successfulCalls:oe.length,failedCalls:we.length,beneficiaries:ce,activeAssignments:a.length,operators:U.length,protocolCompliance:Z.length>0?Math.round(oe.length/Z.length*100):0,pendingFollowUps:we.length}));const Te={};U.forEach(Pe=>{Te[Pe.name]={operator:Pe.name,totalCalls:0,totalMinutes:0,avgDuration:0}}),Z.forEach(Pe=>{const De=a.find(it=>it.beneficiary===Pe.beneficiary);if(De&&Te[De.operator]){Te[De.operator].totalCalls++;const it=parseInt(Pe.duration)||0;Te[De.operator].totalMinutes+=it/60}}),Object.values(Te).forEach(Pe=>{Pe.avgDuration=Pe.totalCalls>0?Math.round(Pe.totalMinutes/Pe.totalCalls):0,Pe.totalMinutes=Math.round(Pe.totalMinutes)}),x(Object.values(Te)),et(Z),je(Z)},et=Z=>{const oe={};Z.forEach(ce=>{const Te=ce.beneficiary;oe[Te]||(oe[Te]={beneficiary:Te,calls:[],lastResult:ce.result,lastDate:ce.date}),oe[Te].calls.push(ce),new Date(ce.date)>new Date(oe[Te].lastDate)&&(oe[Te].lastResult=ce.result,oe[Te].lastDate=ce.date)});const we=Object.values(oe).map(ce=>{const Te=a.find(it=>it.beneficiary===ce.beneficiary);let Pe="pendiente",De="bg-yellow-100 text-yellow-800";return ce.lastResult==="Llamado exitoso"?(Pe="al-dia",De="bg-green-100 text-green-800"):ce.calls.length>3&&(Pe="urgente",De="bg-red-100 text-red-800"),{id:ce.beneficiary,operator:Te?Te.operator:"Sin asignar",beneficiary:ce.beneficiary,phone:Te?Te.phone:"N/A",commune:Te?Te.commune:"N/A",status:Pe,lastCall:ce.lastDate,callCount:ce.calls.length,colorClass:De}});l(we)},je=Z=>{const oe=Array.from({length:24},(we,ce)=>({hour:ce,calls:0}));Z.forEach(we=>{if(we.startTime){const ce=parseInt(we.startTime.split(":")[0])||0;ce>=0&&ce<24&&oe[ce].calls++}}),T(oe)},ye=c.filter(Z=>{const oe=w==="all"||Z.status===w,we=Z.beneficiary.toLowerCase().includes(O.toLowerCase())||Z.operator.toLowerCase().includes(O.toLowerCase());return oe&&we}),nt=({title:Z,value:oe,subtitle:we,icon:ce,trend:Te,color:Pe="blue"})=>R.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{children:[R.jsx("p",{className:"text-sm text-gray-600 mb-1",children:Z}),R.jsx("p",{className:`text-2xl font-bold text-${Pe}-600 mb-1`,children:oe}),R.jsx("p",{className:"text-xs text-gray-500",children:we})]}),R.jsxs("div",{className:"flex items-center",children:[R.jsx(ce,{className:`w-8 h-8 text-${Pe}-500 mr-2`}),Te&&R.jsx("div",{className:`flex items-center ${Te>0?"text-green-500":"text-red-500"}`,children:Te>0?R.jsx(LR,{className:"w-4 h-4"}):R.jsx(OR,{className:"w-4 h-4"})})]})]})}),nr=()=>R.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[R.jsxs("div",{className:"p-6 flex-1",children:[R.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Mistatas - Seguimiento de llamadas"}),R.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),R.jsxs("nav",{className:"space-y-2",children:[R.jsx($t,{icon:yv,label:"Panel principal",active:r==="dashboard",onClick:()=>n("dashboard")}),R.jsx($t,{icon:ni,label:"Registro de Llamadas",active:r==="calls",onClick:()=>n("calls")}),R.jsx($t,{icon:ea,label:"Asignaciones",active:r==="assignments",onClick:()=>n("assignments")}),R.jsx($t,{icon:ud,label:"Historial de Seguimientos",active:r==="history",onClick:()=>n("history")})]})]}),R.jsxs("div",{className:"p-6 border-t border-gray-200",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[R.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:R.jsx(I2,{className:"w-5 h-5 text-blue-600"})}),R.jsxs("div",{className:"flex-1 min-w-0",children:[R.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||"Usuario"}),R.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),R.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-gray-50",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("div",{className:`w-2 h-2 rounded-full ${f==="connected"?"bg-green-500":f==="connecting"?"bg-yellow-500":"bg-orange-500"}`}),R.jsx("span",{className:"text-xs text-gray-600",children:f==="connected"?"Firebase conectado":f==="connecting"?"Conectando...":"Modo demo"})]}),s.length>0&&R.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.length," llamadas cargadas"]})]}),R.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[R.jsx(kR,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]}),$t=({icon:Z,label:oe,active:we,onClick:ce})=>R.jsxs("button",{onClick:ce,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${we?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[R.jsx(Z,{className:"w-5 h-5 mr-3"}),R.jsx("span",{className:"text-sm",children:oe})]}),zr=()=>{const oe=f==="connecting"?{color:"bg-yellow-50 border-yellow-200",icon:"",title:"Conectando...",message:"Conectando con Firebase para cargar datos"}:f==="connected"?s.length>0?{color:"bg-green-50 border-green-200",icon:"",title:"Datos reales activos",message:`Mostrando datos reales de ${s.length} llamadas registradas`}:{color:"bg-blue-50 border-blue-200",icon:"",title:"Firebase conectado - Sin datos de llamadas",message:"Conectado a Firebase. Sube un archivo Excel para ver datos reales"}:{color:"bg-orange-50 border-orange-200",icon:"",title:"Modo demostracin",message:"Mostrando datos de ejemplo. Configura Firebase para persistencia completa"},we=async()=>{f==="connected"&&(ke(!1),await L())};return R.jsx("div",{className:`${oe.color} border rounded-lg p-4 mb-6`,children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{className:"flex items-center",children:[R.jsx("span",{className:"text-lg mr-3",children:oe.icon}),R.jsxs("div",{children:[R.jsx("h3",{className:"font-semibold text-gray-800",children:oe.title}),R.jsx("p",{className:"text-sm text-gray-600",children:oe.message})]})]}),f==="connected"&&R.jsx("button",{onClick:we,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",title:"Recargar datos desde Firebase",children:" Sincronizar"})]})})},vs=()=>R.jsxs("div",{className:"space-y-6",children:[R.jsx(zr,{}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[R.jsx(nt,{title:"Llamadas totales",value:d.totalCalls,subtitle:"Cantidad total de llamadas registradas",icon:ni,color:"blue"}),R.jsx(nt,{title:"Llamadas exitosas",value:d.successfulCalls,subtitle:"Llamadas con resultado exitoso",icon:ni,trend:1,color:"green"}),R.jsx(nt,{title:"Llamadas no exitosas",value:d.failedCalls,subtitle:"No contestadas, fallidas u otro",icon:ni,trend:-1,color:"red"}),R.jsx(nt,{title:"Beneficiarios",value:d.beneficiaries,subtitle:"Personas beneficiarias en la base de datos",icon:ea,color:"purple"})]}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[R.jsx(nt,{title:"Asignaciones activas",value:d.activeAssignments,subtitle:"Relaciones vigentes beneficiario-teleoperadora",icon:ea,color:"blue"}),R.jsx(nt,{title:"Teleoperadoras",value:d.operators,subtitle:"Cantidad de teleoperadoras registradas",icon:ea,color:"blue"}),R.jsx(nt,{title:"Cumplimiento protocolo",value:`${d.protocolCompliance}%`,subtitle:"Promedio de cumplimiento en llamadas",icon:yv,color:"blue"}),R.jsx(nt,{title:"Seguimientos pendientes",value:d.pendingFollowUps,subtitle:"Seguimientos an no realizados",icon:ud,trend:-1,color:"red"})]}),R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Mdulos principales"}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[R.jsx(mr,{title:"Registro de Llamadas",description:"Sube historiales, analiza resultados y clasifica por beneficiario y teleoperadora.",icon:ni,color:"green",onClick:()=>n("calls")}),R.jsx(mr,{title:"Asignaciones",description:"Gestiona relaciones entre beneficiarios y teleoperadoras.",icon:ea,color:"blue",onClick:()=>n("assignments")}),R.jsx(mr,{title:"Historial de Seguimientos",description:"Clasifica beneficiarios por frecuencia y estado de contacto.",icon:ud,color:"orange",onClick:()=>n("history")})]})]}),R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Detalle por Teleoperadora"}),R.jsx("div",{className:"overflow-x-auto",children:R.jsxs("table",{className:"w-full",children:[R.jsx("thead",{children:R.jsxs("tr",{className:"bg-gray-50",children:[R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Teleoperadora"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Cantidad de llamados"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Minutos totales"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tiempo promedio"})]})}),R.jsx("tbody",{children:g.map((Z,oe)=>R.jsxs("tr",{className:"border-b",children:[R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.operator}),R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.totalCalls}),R.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(Z.totalMinutes)," min"]}),R.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(Z.avgDuration)," min"]})]},oe))})]})})]})]}),mr=({title:Z,description:oe,icon:we,color:ce,onClick:Te})=>R.jsxs("div",{className:`bg-${ce}-50 rounded-lg p-6 border border-${ce}-200`,children:[R.jsx("div",{className:"flex items-center justify-center mb-4",children:R.jsx("div",{className:`w-16 h-16 bg-${ce}-500 rounded-lg flex items-center justify-center`,children:R.jsx(we,{className:"w-8 h-8 text-white"})})}),R.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:Z}),R.jsx("p",{className:"text-sm text-gray-600 mb-4",children:oe}),R.jsx("button",{onClick:Te,className:`w-full bg-${ce}-500 text-white py-2 px-4 rounded-lg hover:bg-${ce}-600 transition-colors`,children:"Entrar"})]}),Wt=()=>R.jsxs("div",{className:"space-y-6",children:[R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),R.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),R.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[R.jsx(Tv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),R.jsxs("label",{className:"cursor-pointer",children:[R.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),R.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:j,className:"hidden"})]}),R.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]})]}),s.length>0&&R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),R.jsx("div",{className:"overflow-x-auto",children:R.jsxs("table",{className:"w-full",children:[R.jsx("thead",{children:R.jsxs("tr",{className:"bg-gray-50",children:[R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Evento"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),R.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),R.jsx("tbody",{children:s.slice(0,10).map((Z,oe)=>R.jsxs("tr",{className:"border-b",children:[R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.id}),R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.date}),R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.beneficiary}),R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Z.event}),R.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:R.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Z.result==="Llamado exitoso"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Z.result})}),R.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Z.duration,"s"]})]},oe))})]})})]})]}),Hr=()=>R.jsxs("div",{className:"space-y-6",children:[R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),R.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),R.jsxs("button",{onClick:()=>A(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[R.jsx(kv,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[R.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{children:[R.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),R.jsx("p",{className:"text-2xl font-bold text-blue-600",children:U.length})]}),R.jsx(ea,{className:"w-8 h-8 text-blue-500"})]})}),R.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{children:[R.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),R.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(me).reduce((Z,oe)=>Z+oe.length,0)})]}),R.jsx(ni,{className:"w-8 h-8 text-green-500"})]})}),R.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{children:[R.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),R.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(me).length})]}),R.jsx(_R,{className:"w-8 h-8 text-purple-500"})]})})]})]}),k&&R.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:R.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[R.jsxs("div",{className:"flex justify-between items-center mb-4",children:[R.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),R.jsx("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700",children:R.jsx(zR,{className:"w-5 h-5"})})]}),R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),R.jsx("input",{type:"text",value:C.name,onChange:Z=>F({...C,name:Z.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),R.jsx("input",{type:"email",value:C.email,onChange:Z=>F({...C,email:Z.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),R.jsx("input",{type:"tel",value:C.phone,onChange:Z=>F({...C,phone:Z.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),R.jsxs("div",{className:"flex gap-3 mt-6",children:[R.jsxs("button",{onClick:re,disabled:!C.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[R.jsx(RR,{className:"w-4 h-4"}),"Crear Teleoperador"]}),R.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),R.jsxs("div",{className:"space-y-4",children:[U.filter(Z=>Z&&Z.id).map(Z=>R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsxs("div",{className:"flex justify-between items-start mb-4",children:[R.jsxs("div",{className:"flex-1",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[R.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:Z.name||"Operador sin nombre"}),me[Z.id]&&R.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[me[Z.id].length," beneficiarios"]})]}),R.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[Z.email&&R.jsxs("p",{children:[" ",Z.email]}),Z.phone&&R.jsxs("p",{children:[" ",Z.phone]})]})]}),R.jsxs("div",{className:"flex gap-2",children:[R.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[R.jsx(Tv,{className:"w-4 h-4"}),"Subir Excel",R.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:oe=>Ae(oe,Z.id),className:"hidden"})]}),me[Z.id]&&R.jsxs("button",{onClick:()=>ae(Z.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[R.jsx(wv,{className:"w-4 h-4"}),"Limpiar"]}),R.jsxs("button",{onClick:()=>de(Z.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[R.jsx(wv,{className:"w-4 h-4"}),"Eliminar"]})]})]}),R.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[R.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),R.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[R.jsxs("p",{children:[R.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),R.jsxs("p",{children:[R.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),R.jsxs("p",{children:[R.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),me[Z.id]&&me[Z.id].length>0&&R.jsxs("div",{className:"border-t pt-4",children:[R.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",me[Z.id].length,")"]}),R.jsx("div",{className:"overflow-x-auto",children:R.jsxs("table",{className:"w-full text-sm",children:[R.jsx("thead",{children:R.jsxs("tr",{className:"bg-gray-50",children:[R.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),R.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),R.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),R.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),R.jsxs("tbody",{children:[me[Z.id].slice(0,5).map(oe=>R.jsxs("tr",{className:"border-b",children:[R.jsx("td",{className:"px-3 py-2 text-gray-900",children:oe.beneficiary}),R.jsx("td",{className:"px-3 py-2 text-gray-900",children:oe.primaryPhone}),R.jsx("td",{className:"px-3 py-2 text-gray-600",children:oe.phones.length>1?oe.phones.slice(1).join(", "):"-"}),R.jsx("td",{className:"px-3 py-2 text-gray-900",children:oe.commune})]},oe.id)),me[Z.id].length>5&&R.jsx("tr",{children:R.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",me[Z.id].length-5," beneficiarios ms"]})})]})]})})]})]},Z.id)),U.length===0&&R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[R.jsx(ea,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),R.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),R.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),R.jsxs("button",{onClick:()=>A(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[R.jsx(kv,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),ut=()=>R.jsx("div",{className:"space-y-6",children:R.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[R.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),R.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),R.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx(ER,{className:"w-4 h-4 text-gray-400"}),R.jsxs("select",{value:w,onChange:Z=>v(Z.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[R.jsx("option",{value:"all",children:"Todos los estados"}),R.jsx("option",{value:"al-dia",children:"Al da"}),R.jsx("option",{value:"pendiente",children:"Pendiente"}),R.jsx("option",{value:"urgente",children:"Urgente"})]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx(NR,{className:"w-4 h-4 text-gray-400"}),R.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:O,onChange:Z=>z(Z.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),R.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ye.map(Z=>R.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[R.jsxs("div",{className:"flex items-start justify-between mb-2",children:[R.jsx("h4",{className:"font-medium text-gray-900",children:Z.beneficiary}),R.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Z.status==="al-dia"?"bg-green-100 text-green-800":Z.status==="pendiente"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:Z.status==="al-dia"?"Al da":Z.status==="pendiente"?"Pendiente":"Urgente"})]}),R.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Teleoperadora: ",Z.operator]}),R.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["ltima llamada: ",Z.lastCall]}),R.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total llamadas: ",Z.callCount]}),R.jsxs("p",{className:"text-sm text-gray-600",children:["Telfono: ",Z.phone]}),Z.status==="urgente"&&R.jsxs("div",{className:"mt-2 flex items-center text-red-600 text-sm",children:[R.jsx(Pp,{className:"w-4 h-4 mr-1"}),"Requiere atencin inmediata"]})]},Z.id))})]})});return R.jsxs("div",{className:"flex h-screen bg-gray-100",children:[R.jsx(nr,{}),R.jsx("div",{className:"flex-1 overflow-auto",children:R.jsxs("div",{className:"p-6",children:[R.jsx("div",{className:"mb-6",children:R.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r==="dashboard"&&"Panel principal",r==="calls"&&"Registro de Llamadas",r==="assignments"&&"Asignaciones",r==="history"&&"Historial de Seguimientos"]})}),f==="demo"&&R.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:R.jsxs("div",{className:"flex items-start gap-3",children:[R.jsx(Pp,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),R.jsxs("div",{className:"flex-1",children:[R.jsx("h3",{className:"text-blue-800 font-medium",children:"Modo Local"}),R.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"La aplicacin funciona con datos locales. Para persistencia en la nube, completa la configuracin de Firebase."}),R.jsx("p",{className:"text-blue-600 text-xs mt-2",children:" Consulta FIREBASE_SETUP.md para instrucciones de configuracin"})]})]})}),f==="connecting"&&R.jsx("div",{className:"mb-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),R.jsx("span",{className:"text-slate-700 text-sm",children:"Verificando configuracin de Firebase..."})]})}),r==="dashboard"&&R.jsx(vs,{}),r==="calls"&&R.jsx(Wt,{}),r==="assignments"&&R.jsx(Hr,{}),r==="history"&&R.jsx(ut,{})]})})]})},Cj=()=>{const[t,e]=We.useState(!0),[r,n]=We.useState(!1),[s,i]=We.useState({email:"",password:"",confirmPassword:"",displayName:""}),[a,o]=We.useState(!1),{login:c,register:l,error:f,clearError:h}=D1(),d=E=>{const{name:T,value:w}=E.target;i(v=>({...v,[T]:w})),h()},m=async E=>{E.preventDefault(),o(!0);try{if(t)await c(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await l(s.email,s.password,s.displayName)}}catch(T){console.error("Error en autenticacin:",T)}finally{o(!1)}},g=()=>{e(!t),i({email:"",password:"",confirmPassword:"",displayName:""}),h()},x=E=>E?E.includes("user-not-found")?"Usuario no encontrado":E.includes("wrong-password")?"Contrasea incorrecta":E.includes("email-already-in-use")?"Este email ya est registrado":E.includes("weak-password")?"La contrasea es muy dbil":E.includes("invalid-email")?"Email invlido":E.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":E:"";return R.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:R.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[R.jsxs("div",{className:"text-center mb-8",children:[R.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:R.jsx(ni,{className:"w-8 h-8 text-blue-600"})}),R.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),R.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),f&&R.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[R.jsx(Pp,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),R.jsxs("div",{children:[R.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),R.jsx("p",{className:"text-red-600 text-sm mt-1",children:x(f)})]})]}),R.jsxs("form",{onSubmit:m,className:"space-y-6",children:[!t&&R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),R.jsxs("div",{className:"relative",children:[R.jsx(I2,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),R.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),R.jsxs("div",{className:"relative",children:[R.jsx(SR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),R.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),R.jsxs("div",{className:"relative",children:[R.jsx(Ev,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),R.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:d,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),R.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?R.jsx(mR,{className:"w-5 h-5"}):R.jsx(xR,{className:"w-5 h-5"})})]})]}),!t&&R.jsxs("div",{children:[R.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),R.jsxs("div",{className:"relative",children:[R.jsx(Ev,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),R.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),R.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:a?R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):R.jsx(R.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),R.jsxs("div",{className:"mt-8 text-center",children:[R.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),R.jsx("button",{onClick:g,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),R.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:R.jsxs("div",{className:"flex items-start gap-3",children:[R.jsx(hR,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),R.jsxs("div",{children:[R.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),R.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},Rj=()=>R.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:R.jsxs("div",{className:"text-center",children:[R.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:R.jsx(ni,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),R.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),R.jsxs("div",{className:"flex items-center justify-center gap-2",children:[R.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),R.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),R.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),R.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),Pj=()=>{const{user:t,loading:e}=D1();return e?R.jsx(Rj,{}):t?R.jsx(Ij,{}):R.jsx(Cj,{})};Md.createRoot(document.getElementById("root")).render(R.jsx(GI.StrictMode,{children:R.jsx(Sj,{children:R.jsx(Pj,{})})}));
