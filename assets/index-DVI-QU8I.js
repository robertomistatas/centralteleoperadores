(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function GI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var CE={exports:{}},Kh={},NE={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru=Symbol.for("react.element"),qI=Symbol.for("react.portal"),KI=Symbol.for("react.fragment"),XI=Symbol.for("react.strict_mode"),YI=Symbol.for("react.profiler"),QI=Symbol.for("react.provider"),JI=Symbol.for("react.context"),ZI=Symbol.for("react.forward_ref"),eC=Symbol.for("react.suspense"),tC=Symbol.for("react.memo"),rC=Symbol.for("react.lazy"),_x=Symbol.iterator;function nC(t){return t===null||typeof t!="object"?null:(t=_x&&t[_x]||t["@@iterator"],typeof t=="function"?t:null)}var RE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PE=Object.assign,DE={};function nl(t,e,r){this.props=t,this.context=e,this.refs=DE,this.updater=r||RE}nl.prototype.isReactComponent={};nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bE(){}bE.prototype=nl.prototype;function Tm(t,e,r){this.props=t,this.context=e,this.refs=DE,this.updater=r||RE}var Am=Tm.prototype=new bE;Am.constructor=Tm;PE(Am,nl.prototype);Am.isPureReactComponent=!0;var Ex=Array.isArray,FE=Object.prototype.hasOwnProperty,Sm={current:null},OE={key:!0,ref:!0,__self:!0,__source:!0};function LE(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)FE.call(e,n)&&!OE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:ru,type:t,key:a,ref:i,props:s,_owner:Sm.current}}function sC(t,e){return{$$typeof:ru,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function km(t){return typeof t=="object"&&t!==null&&t.$$typeof===ru}function aC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var wx=/\/+/g;function G0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?aC(""+t.key):e.toString(36)}function vf(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case ru:case qI:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+G0(i,0):n,Ex(s)?(r="",t!=null&&(r=t.replace(wx,"$&/")+"/"),vf(s,e,r,"",function(c){return c})):s!=null&&(km(s)&&(s=sC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(wx,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Ex(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+G0(a,o);i+=vf(a,e,r,l,s)}else if(l=nC(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+G0(a,o++),i+=vf(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Lu(t,e,r){if(t==null)return t;var n=[],s=0;return vf(t,n,"","",function(a){return e.call(r,a,s++)}),n}function iC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Hr={current:null},yf={transition:null},oC={ReactCurrentDispatcher:Hr,ReactCurrentBatchConfig:yf,ReactCurrentOwner:Sm};function ME(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Lu,forEach:function(t,e,r){Lu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Lu(t,function(){e++}),e},toArray:function(t){return Lu(t,function(e){return e})||[]},only:function(t){if(!km(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$e.Component=nl;$e.Fragment=KI;$e.Profiler=YI;$e.PureComponent=Tm;$e.StrictMode=XI;$e.Suspense=eC;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oC;$e.act=ME;$e.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=PE({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=Sm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)FE.call(e,l)&&!OE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ru,type:t.type,key:s,ref:a,props:n,_owner:i}};$e.createContext=function(t){return t={$$typeof:JI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QI,_context:t},t.Consumer=t};$e.createElement=LE;$e.createFactory=function(t){var e=LE.bind(null,t);return e.type=t,e};$e.createRef=function(){return{current:null}};$e.forwardRef=function(t){return{$$typeof:ZI,render:t}};$e.isValidElement=km;$e.lazy=function(t){return{$$typeof:rC,_payload:{_status:-1,_result:t},_init:iC}};$e.memo=function(t,e){return{$$typeof:tC,type:t,compare:e===void 0?null:e}};$e.startTransition=function(t){var e=yf.transition;yf.transition={};try{t()}finally{yf.transition=e}};$e.unstable_act=ME;$e.useCallback=function(t,e){return Hr.current.useCallback(t,e)};$e.useContext=function(t){return Hr.current.useContext(t)};$e.useDebugValue=function(){};$e.useDeferredValue=function(t){return Hr.current.useDeferredValue(t)};$e.useEffect=function(t,e){return Hr.current.useEffect(t,e)};$e.useId=function(){return Hr.current.useId()};$e.useImperativeHandle=function(t,e,r){return Hr.current.useImperativeHandle(t,e,r)};$e.useInsertionEffect=function(t,e){return Hr.current.useInsertionEffect(t,e)};$e.useLayoutEffect=function(t,e){return Hr.current.useLayoutEffect(t,e)};$e.useMemo=function(t,e){return Hr.current.useMemo(t,e)};$e.useReducer=function(t,e,r){return Hr.current.useReducer(t,e,r)};$e.useRef=function(t){return Hr.current.useRef(t)};$e.useState=function(t){return Hr.current.useState(t)};$e.useSyncExternalStore=function(t,e,r){return Hr.current.useSyncExternalStore(t,e,r)};$e.useTransition=function(){return Hr.current.useTransition()};$e.version="18.3.1";NE.exports=$e;var je=NE.exports;const zf=GI(je);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lC=je,cC=Symbol.for("react.element"),uC=Symbol.for("react.fragment"),fC=Object.prototype.hasOwnProperty,hC=lC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dC={key:!0,ref:!0,__self:!0,__source:!0};function VE(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)fC.call(e,n)&&!dC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:cC,type:t,key:a,ref:i,props:s,_owner:hC.current}}Kh.Fragment=uC;Kh.jsx=VE;Kh.jsxs=VE;CE.exports=Kh;var m=CE.exports,Hd={},UE={exports:{}},pn={},BE={exports:{}},jE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,q){var ue=ie.length;ie.push(q);e:for(;0<ue;){var xe=ue-1>>>1,U=ie[xe];if(0<s(U,q))ie[xe]=q,ie[ue]=U,ue=xe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var q=ie[0],ue=ie.pop();if(ue!==q){ie[0]=ue;e:for(var xe=0,U=ie.length,J=U>>>1;xe<J;){var G=2*(xe+1)-1,H=ie[G],re=G+1,he=ie[re];if(0>s(H,ue))re<U&&0>s(he,H)?(ie[xe]=he,ie[re]=ue,xe=re):(ie[xe]=H,ie[G]=ue,xe=G);else if(re<U&&0>s(he,ue))ie[xe]=he,ie[re]=ue,xe=re;else break e}}return q}function s(ie,q){var ue=ie.sortIndex-q.sortIndex;return ue!==0?ue:ie.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,h=null,d=3,p=!1,v=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ie){for(var q=r(c);q!==null;){if(q.callback===null)n(c);else if(q.startTime<=ie)n(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=r(c)}}function M(ie){if(x=!1,y(ie),!v)if(r(l)!==null)v=!0,Ae(z);else{var q=r(c);q!==null&&ve(M,q.startTime-ie)}}function z(ie,q){v=!1,x&&(x=!1,A(k),k=-1),p=!0;var ue=d;try{for(y(q),h=r(l);h!==null&&(!(h.expirationTime>q)||ie&&!F());){var xe=h.callback;if(typeof xe=="function"){h.callback=null,d=h.priorityLevel;var U=xe(h.expirationTime<=q);q=t.unstable_now(),typeof U=="function"?h.callback=U:h===r(l)&&n(l),y(q)}else n(l);h=r(l)}if(h!==null)var J=!0;else{var G=r(c);G!==null&&ve(M,G.startTime-q),J=!1}return J}finally{h=null,d=ue,p=!1}}var B=!1,w=null,k=-1,I=5,R=-1;function F(){return!(t.unstable_now()-R<I)}function O(){if(w!==null){var ie=t.unstable_now();R=ie;var q=!0;try{q=w(!0,ie)}finally{q?L():(B=!1,w=null)}}else B=!1}var L;if(typeof _=="function")L=function(){_(O)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,de=ye.port2;ye.port1.onmessage=O,L=function(){de.postMessage(null)}}else L=function(){E(O,0)};function Ae(ie){w=ie,B||(B=!0,L())}function ve(ie,q){k=E(function(){ie(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,Ae(z))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var ue=d;d=q;try{return ie()}finally{d=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ue=d;d=ie;try{return q()}finally{d=ue}},t.unstable_scheduleCallback=function(ie,q,ue){var xe=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?xe+ue:xe):ue=xe,ie){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=ue+U,ie={id:f++,callback:q,priorityLevel:ie,startTime:ue,expirationTime:U,sortIndex:-1},ue>xe?(ie.sortIndex=ue,e(c,ie),r(l)===null&&ie===r(c)&&(x?(A(k),k=-1):x=!0,ve(M,ue-xe))):(ie.sortIndex=U,e(l,ie),v||p||(v=!0,Ae(z))),ie},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ie){var q=d;return function(){var ue=d;d=q;try{return ie.apply(this,arguments)}finally{d=ue}}}})(jE);BE.exports=jE;var pC=BE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mC=je,hn=pC;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $E=new Set,Ec={};function Mi(t,e){jo(t,e),jo(t+"Capture",e)}function jo(t,e){for(Ec[t]=e,t=0;t<e.length;t++)$E.add(e[t])}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=Object.prototype.hasOwnProperty,gC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tx={},Ax={};function xC(t){return Wd.call(Ax,t)?!0:Wd.call(Tx,t)?!1:gC.test(t)?Ax[t]=!0:(Tx[t]=!0,!1)}function vC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yC(t,e,r,n){if(e===null||typeof e>"u"||vC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wr(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mr[t]=new Wr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mr[e]=new Wr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mr[t]=new Wr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mr[t]=new Wr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mr[t]=new Wr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mr[t]=new Wr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mr[t]=new Wr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mr[t]=new Wr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mr[t]=new Wr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Im=/[\-:]([a-z])/g;function Cm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Im,Cm);mr[e]=new Wr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Im,Cm);mr[e]=new Wr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Im,Cm);mr[e]=new Wr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mr[t]=new Wr(t,1,!1,t.toLowerCase(),null,!1,!1)});mr.xlinkHref=new Wr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mr[t]=new Wr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Nm(t,e,r,n){var s=mr.hasOwnProperty(e)?mr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yC(e,r,s,n)&&(r=null),n||s===null?xC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Js=mC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Mu=Symbol.for("react.element"),ho=Symbol.for("react.portal"),po=Symbol.for("react.fragment"),Rm=Symbol.for("react.strict_mode"),Gd=Symbol.for("react.profiler"),zE=Symbol.for("react.provider"),HE=Symbol.for("react.context"),Pm=Symbol.for("react.forward_ref"),qd=Symbol.for("react.suspense"),Kd=Symbol.for("react.suspense_list"),Dm=Symbol.for("react.memo"),ua=Symbol.for("react.lazy"),WE=Symbol.for("react.offscreen"),Sx=Symbol.iterator;function kl(t){return t===null||typeof t!="object"?null:(t=Sx&&t[Sx]||t["@@iterator"],typeof t=="function"?t:null)}var wt=Object.assign,q0;function Fl(t){if(q0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);q0=e&&e[1]||""}return`
`+q0+t}var K0=!1;function X0(t,e){if(!t||K0)return"";K0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{K0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Fl(t):""}function _C(t){switch(t.tag){case 5:return Fl(t.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return t=X0(t.type,!1),t;case 11:return t=X0(t.type.render,!1),t;case 1:return t=X0(t.type,!0),t;default:return""}}function Xd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case po:return"Fragment";case ho:return"Portal";case Gd:return"Profiler";case Rm:return"StrictMode";case qd:return"Suspense";case Kd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case HE:return(t.displayName||"Context")+".Consumer";case zE:return(t._context.displayName||"Context")+".Provider";case Pm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dm:return e=t.displayName||null,e!==null?e:Xd(t.type)||"Memo";case ua:e=t._payload,t=t._init;try{return Xd(t(e))}catch{}}return null}function EC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xd(e);case 8:return e===Rm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Va(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function GE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wC(t){var e=GE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vu(t){t._valueTracker||(t._valueTracker=wC(t))}function qE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=GE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Hf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yd(t,e){var r=e.checked;return wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function kx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Va(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function KE(t,e){e=e.checked,e!=null&&Nm(t,"checked",e,!1)}function Qd(t,e){KE(t,e);var r=Va(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Jd(t,e.type,Va(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ix(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Jd(t,e,r){(e!=="number"||Hf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ol=Array.isArray;function Io(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Va(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Cx(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(le(92));if(Ol(r)){if(1<r.length)throw Error(le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Va(r)}}function XE(t,e){var r=Va(e.value),n=Va(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Nx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function YE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ep(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?YE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uu,QE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uu=Uu||document.createElement("div"),Uu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Xl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},TC=["Webkit","ms","Moz","O"];Object.keys(Xl).forEach(function(t){TC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Xl[e]=Xl[t]})});function JE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Xl.hasOwnProperty(t)&&Xl[t]?(""+e).trim():e+"px"}function ZE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=JE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var AC=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tp(t,e){if(e){if(AC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function rp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var np=null;function bm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sp=null,Co=null,No=null;function Rx(t){if(t=au(t)){if(typeof sp!="function")throw Error(le(280));var e=t.stateNode;e&&(e=Zh(e),sp(t.stateNode,t.type,e))}}function ew(t){Co?No?No.push(t):No=[t]:Co=t}function tw(){if(Co){var t=Co,e=No;if(No=Co=null,Rx(t),e)for(t=0;t<e.length;t++)Rx(e[t])}}function rw(t,e){return t(e)}function nw(){}var Y0=!1;function sw(t,e,r){if(Y0)return t(e,r);Y0=!0;try{return rw(t,e,r)}finally{Y0=!1,(Co!==null||No!==null)&&(nw(),tw())}}function Tc(t,e){var r=t.stateNode;if(r===null)return null;var n=Zh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(le(231,e,typeof r));return r}var ap=!1;if(zs)try{var Il={};Object.defineProperty(Il,"passive",{get:function(){ap=!0}}),window.addEventListener("test",Il,Il),window.removeEventListener("test",Il,Il)}catch{ap=!1}function SC(t,e,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var Yl=!1,Wf=null,Gf=!1,ip=null,kC={onError:function(t){Yl=!0,Wf=t}};function IC(t,e,r,n,s,a,i,o,l){Yl=!1,Wf=null,SC.apply(kC,arguments)}function CC(t,e,r,n,s,a,i,o,l){if(IC.apply(this,arguments),Yl){if(Yl){var c=Wf;Yl=!1,Wf=null}else throw Error(le(198));Gf||(Gf=!0,ip=c)}}function Vi(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function aw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Px(t){if(Vi(t)!==t)throw Error(le(188))}function NC(t){var e=t.alternate;if(!e){if(e=Vi(t),e===null)throw Error(le(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Px(s),t;if(a===n)return Px(s),e;a=a.sibling}throw Error(le(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?t:e}function iw(t){return t=NC(t),t!==null?ow(t):null}function ow(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ow(t);if(e!==null)return e;t=t.sibling}return null}var lw=hn.unstable_scheduleCallback,Dx=hn.unstable_cancelCallback,RC=hn.unstable_shouldYield,PC=hn.unstable_requestPaint,bt=hn.unstable_now,DC=hn.unstable_getCurrentPriorityLevel,Fm=hn.unstable_ImmediatePriority,cw=hn.unstable_UserBlockingPriority,qf=hn.unstable_NormalPriority,bC=hn.unstable_LowPriority,uw=hn.unstable_IdlePriority,Xh=null,ds=null;function FC(t){if(ds&&typeof ds.onCommitFiberRoot=="function")try{ds.onCommitFiberRoot(Xh,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:MC,OC=Math.log,LC=Math.LN2;function MC(t){return t>>>=0,t===0?32:31-(OC(t)/LC|0)|0}var Bu=64,ju=4194304;function Ll(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Ll(o):(a&=i,a!==0&&(n=Ll(a)))}else i=r&~s,i!==0?n=Ll(i):a!==0&&(n=Ll(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Kn(e),s=1<<r,n|=t[r],e&=~s;return n}function VC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Kn(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=VC(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function op(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fw(){var t=Bu;return Bu<<=1,!(Bu&4194240)&&(Bu=64),t}function Q0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function nu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=r}function BC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Kn(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function Om(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Kn(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var nt=0;function hw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var dw,Lm,pw,mw,gw,lp=!1,$u=[],Aa=null,Sa=null,ka=null,Ac=new Map,Sc=new Map,ha=[],jC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bx(t,e){switch(t){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":Sa=null;break;case"mouseover":case"mouseout":ka=null;break;case"pointerover":case"pointerout":Ac.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sc.delete(e.pointerId)}}function Cl(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=au(e),e!==null&&Lm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function $C(t,e,r,n,s){switch(e){case"focusin":return Aa=Cl(Aa,t,e,r,n,s),!0;case"dragenter":return Sa=Cl(Sa,t,e,r,n,s),!0;case"mouseover":return ka=Cl(ka,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return Ac.set(a,Cl(Ac.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Sc.set(a,Cl(Sc.get(a)||null,t,e,r,n,s)),!0}return!1}function xw(t){var e=hi(t.target);if(e!==null){var r=Vi(e);if(r!==null){if(e=r.tag,e===13){if(e=aw(r),e!==null){t.blockedOn=e,gw(t.priority,function(){pw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _f(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=cp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);np=n,r.target.dispatchEvent(n),np=null}else return e=au(r),e!==null&&Lm(e),t.blockedOn=r,!1;e.shift()}return!0}function Fx(t,e,r){_f(t)&&r.delete(e)}function zC(){lp=!1,Aa!==null&&_f(Aa)&&(Aa=null),Sa!==null&&_f(Sa)&&(Sa=null),ka!==null&&_f(ka)&&(ka=null),Ac.forEach(Fx),Sc.forEach(Fx)}function Nl(t,e){t.blockedOn===e&&(t.blockedOn=null,lp||(lp=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,zC)))}function kc(t){function e(s){return Nl(s,t)}if(0<$u.length){Nl($u[0],t);for(var r=1;r<$u.length;r++){var n=$u[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Aa!==null&&Nl(Aa,t),Sa!==null&&Nl(Sa,t),ka!==null&&Nl(ka,t),Ac.forEach(e),Sc.forEach(e),r=0;r<ha.length;r++)n=ha[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ha.length&&(r=ha[0],r.blockedOn===null);)xw(r),r.blockedOn===null&&ha.shift()}var Ro=Js.ReactCurrentBatchConfig,Xf=!0;function HC(t,e,r,n){var s=nt,a=Ro.transition;Ro.transition=null;try{nt=1,Mm(t,e,r,n)}finally{nt=s,Ro.transition=a}}function WC(t,e,r,n){var s=nt,a=Ro.transition;Ro.transition=null;try{nt=4,Mm(t,e,r,n)}finally{nt=s,Ro.transition=a}}function Mm(t,e,r,n){if(Xf){var s=cp(t,e,r,n);if(s===null)od(t,e,n,Yf,r),bx(t,n);else if($C(s,t,e,r,n))n.stopPropagation();else if(bx(t,n),e&4&&-1<jC.indexOf(t)){for(;s!==null;){var a=au(s);if(a!==null&&dw(a),a=cp(t,e,r,n),a===null&&od(t,e,n,Yf,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else od(t,e,n,null,r)}}var Yf=null;function cp(t,e,r,n){if(Yf=null,t=bm(n),t=hi(t),t!==null)if(e=Vi(t),e===null)t=null;else if(r=e.tag,r===13){if(t=aw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yf=t,null}function vw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DC()){case Fm:return 1;case cw:return 4;case qf:case bC:return 16;case uw:return 536870912;default:return 16}default:return 16}}var ya=null,Vm=null,Ef=null;function yw(){if(Ef)return Ef;var t,e=Vm,r=e.length,n,s="value"in ya?ya.value:ya.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return Ef=s.slice(t,1<n?1-n:void 0)}function wf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zu(){return!0}function Ox(){return!1}function mn(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?zu:Ox,this.isPropagationStopped=Ox,this}return wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=zu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=zu)},persist:function(){},isPersistent:zu}),e}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Um=mn(sl),su=wt({},sl,{view:0,detail:0}),GC=mn(su),J0,Z0,Rl,Yh=wt({},su,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rl&&(Rl&&t.type==="mousemove"?(J0=t.screenX-Rl.screenX,Z0=t.screenY-Rl.screenY):Z0=J0=0,Rl=t),J0)},movementY:function(t){return"movementY"in t?t.movementY:Z0}}),Lx=mn(Yh),qC=wt({},Yh,{dataTransfer:0}),KC=mn(qC),XC=wt({},su,{relatedTarget:0}),ed=mn(XC),YC=wt({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),QC=mn(YC),JC=wt({},sl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZC=mn(JC),e4=wt({},sl,{data:0}),Mx=mn(e4),t4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=n4[t])?!!e[t]:!1}function Bm(){return s4}var a4=wt({},su,{key:function(t){if(t.key){var e=t4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=wf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?r4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bm,charCode:function(t){return t.type==="keypress"?wf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),i4=mn(a4),o4=wt({},Yh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vx=mn(o4),l4=wt({},su,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bm}),c4=mn(l4),u4=wt({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),f4=mn(u4),h4=wt({},Yh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),d4=mn(h4),p4=[9,13,27,32],jm=zs&&"CompositionEvent"in window,Ql=null;zs&&"documentMode"in document&&(Ql=document.documentMode);var m4=zs&&"TextEvent"in window&&!Ql,_w=zs&&(!jm||Ql&&8<Ql&&11>=Ql),Ux=" ",Bx=!1;function Ew(t,e){switch(t){case"keyup":return p4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ww(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mo=!1;function g4(t,e){switch(t){case"compositionend":return ww(e);case"keypress":return e.which!==32?null:(Bx=!0,Ux);case"textInput":return t=e.data,t===Ux&&Bx?null:t;default:return null}}function x4(t,e){if(mo)return t==="compositionend"||!jm&&Ew(t,e)?(t=yw(),Ef=Vm=ya=null,mo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _w&&e.locale!=="ko"?null:e.data;default:return null}}var v4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v4[t.type]:e==="textarea"}function Tw(t,e,r,n){ew(n),e=Qf(e,"onChange"),0<e.length&&(r=new Um("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Jl=null,Ic=null;function y4(t){Fw(t,0)}function Qh(t){var e=vo(t);if(qE(e))return t}function _4(t,e){if(t==="change")return e}var Aw=!1;if(zs){var td;if(zs){var rd="oninput"in document;if(!rd){var $x=document.createElement("div");$x.setAttribute("oninput","return;"),rd=typeof $x.oninput=="function"}td=rd}else td=!1;Aw=td&&(!document.documentMode||9<document.documentMode)}function zx(){Jl&&(Jl.detachEvent("onpropertychange",Sw),Ic=Jl=null)}function Sw(t){if(t.propertyName==="value"&&Qh(Ic)){var e=[];Tw(e,Ic,t,bm(t)),sw(y4,e)}}function E4(t,e,r){t==="focusin"?(zx(),Jl=e,Ic=r,Jl.attachEvent("onpropertychange",Sw)):t==="focusout"&&zx()}function w4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qh(Ic)}function T4(t,e){if(t==="click")return Qh(e)}function A4(t,e){if(t==="input"||t==="change")return Qh(e)}function S4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qn=typeof Object.is=="function"?Object.is:S4;function Cc(t,e){if(Qn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Wd.call(e,s)||!Qn(t[s],e[s]))return!1}return!0}function Hx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wx(t,e){var r=Hx(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Hx(r)}}function kw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?kw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Iw(){for(var t=window,e=Hf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Hf(t.document)}return e}function $m(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function k4(t){var e=Iw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&kw(r.ownerDocument.documentElement,r)){if(n!==null&&$m(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=Wx(r,a);var i=Wx(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var I4=zs&&"documentMode"in document&&11>=document.documentMode,go=null,up=null,Zl=null,fp=!1;function Gx(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fp||go==null||go!==Hf(n)||(n=go,"selectionStart"in n&&$m(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zl&&Cc(Zl,n)||(Zl=n,n=Qf(up,"onSelect"),0<n.length&&(e=new Um("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=go)))}function Hu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xo={animationend:Hu("Animation","AnimationEnd"),animationiteration:Hu("Animation","AnimationIteration"),animationstart:Hu("Animation","AnimationStart"),transitionend:Hu("Transition","TransitionEnd")},nd={},Cw={};zs&&(Cw=document.createElement("div").style,"AnimationEvent"in window||(delete xo.animationend.animation,delete xo.animationiteration.animation,delete xo.animationstart.animation),"TransitionEvent"in window||delete xo.transitionend.transition);function Jh(t){if(nd[t])return nd[t];if(!xo[t])return t;var e=xo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Cw)return nd[t]=e[r];return t}var Nw=Jh("animationend"),Rw=Jh("animationiteration"),Pw=Jh("animationstart"),Dw=Jh("transitionend"),bw=new Map,qx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xa(t,e){bw.set(t,e),Mi(e,[t])}for(var sd=0;sd<qx.length;sd++){var ad=qx[sd],C4=ad.toLowerCase(),N4=ad[0].toUpperCase()+ad.slice(1);Xa(C4,"on"+N4)}Xa(Nw,"onAnimationEnd");Xa(Rw,"onAnimationIteration");Xa(Pw,"onAnimationStart");Xa("dblclick","onDoubleClick");Xa("focusin","onFocus");Xa("focusout","onBlur");Xa(Dw,"onTransitionEnd");jo("onMouseEnter",["mouseout","mouseover"]);jo("onMouseLeave",["mouseout","mouseover"]);jo("onPointerEnter",["pointerout","pointerover"]);jo("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),R4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ml));function Kx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,CC(n,e,void 0,t),t.currentTarget=null}function Fw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Kx(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Kx(s,o,c),a=l}}}if(Gf)throw t=ip,Gf=!1,ip=null,t}function ht(t,e){var r=e[gp];r===void 0&&(r=e[gp]=new Set);var n=t+"__bubble";r.has(n)||(Ow(e,t,2,!1),r.add(n))}function id(t,e,r){var n=0;e&&(n|=4),Ow(r,t,n,e)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function Nc(t){if(!t[Wu]){t[Wu]=!0,$E.forEach(function(r){r!=="selectionchange"&&(R4.has(r)||id(r,!1,t),id(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wu]||(e[Wu]=!0,id("selectionchange",!1,e))}}function Ow(t,e,r,n){switch(vw(e)){case 1:var s=HC;break;case 4:s=WC;break;default:s=Mm}r=s.bind(null,e,r,t),s=void 0,!ap||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function od(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=hi(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}sw(function(){var c=a,f=bm(r),h=[];e:{var d=bw.get(t);if(d!==void 0){var p=Um,v=t;switch(t){case"keypress":if(wf(r)===0)break e;case"keydown":case"keyup":p=i4;break;case"focusin":v="focus",p=ed;break;case"focusout":v="blur",p=ed;break;case"beforeblur":case"afterblur":p=ed;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Lx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=KC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=c4;break;case Nw:case Rw:case Pw:p=QC;break;case Dw:p=f4;break;case"scroll":p=GC;break;case"wheel":p=d4;break;case"copy":case"cut":case"paste":p=ZC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Vx}var x=(e&4)!==0,E=!x&&t==="scroll",A=x?d!==null?d+"Capture":null:d;x=[];for(var _=c,y;_!==null;){y=_;var M=y.stateNode;if(y.tag===5&&M!==null&&(y=M,A!==null&&(M=Tc(_,A),M!=null&&x.push(Rc(_,M,y)))),E)break;_=_.return}0<x.length&&(d=new p(d,v,null,r,f),h.push({event:d,listeners:x}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==np&&(v=r.relatedTarget||r.fromElement)&&(hi(v)||v[Hs]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?hi(v):null,v!==null&&(E=Vi(v),v!==E||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(x=Lx,M="onMouseLeave",A="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=Vx,M="onPointerLeave",A="onPointerEnter",_="pointer"),E=p==null?d:vo(p),y=v==null?d:vo(v),d=new x(M,_+"leave",p,r,f),d.target=E,d.relatedTarget=y,M=null,hi(f)===c&&(x=new x(A,_+"enter",v,r,f),x.target=y,x.relatedTarget=E,M=x),E=M,p&&v)t:{for(x=p,A=v,_=0,y=x;y;y=ao(y))_++;for(y=0,M=A;M;M=ao(M))y++;for(;0<_-y;)x=ao(x),_--;for(;0<y-_;)A=ao(A),y--;for(;_--;){if(x===A||A!==null&&x===A.alternate)break t;x=ao(x),A=ao(A)}x=null}else x=null;p!==null&&Xx(h,d,p,x,!1),v!==null&&E!==null&&Xx(h,E,v,x,!0)}}e:{if(d=c?vo(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var z=_4;else if(jx(d))if(Aw)z=A4;else{z=w4;var B=E4}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=T4);if(z&&(z=z(t,c))){Tw(h,z,r,f);break e}B&&B(t,d,c),t==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&Jd(d,"number",d.value)}switch(B=c?vo(c):window,t){case"focusin":(jx(B)||B.contentEditable==="true")&&(go=B,up=c,Zl=null);break;case"focusout":Zl=up=go=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,Gx(h,r,f);break;case"selectionchange":if(I4)break;case"keydown":case"keyup":Gx(h,r,f)}var w;if(jm)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else mo?Ew(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(_w&&r.locale!=="ko"&&(mo||k!=="onCompositionStart"?k==="onCompositionEnd"&&mo&&(w=yw()):(ya=f,Vm="value"in ya?ya.value:ya.textContent,mo=!0)),B=Qf(c,k),0<B.length&&(k=new Mx(k,t,null,r,f),h.push({event:k,listeners:B}),w?k.data=w:(w=ww(r),w!==null&&(k.data=w)))),(w=m4?g4(t,r):x4(t,r))&&(c=Qf(c,"onBeforeInput"),0<c.length&&(f=new Mx("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=w))}Fw(h,e)})}function Rc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Qf(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Tc(t,r),a!=null&&n.unshift(Rc(t,a,s)),a=Tc(t,e),a!=null&&n.push(Rc(t,a,s))),t=t.return}return n}function ao(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xx(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Tc(r,a),l!=null&&i.unshift(Rc(r,l,o))):s||(l=Tc(r,a),l!=null&&i.push(Rc(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var P4=/\r\n?/g,D4=/\u0000|\uFFFD/g;function Yx(t){return(typeof t=="string"?t:""+t).replace(P4,`
`).replace(D4,"")}function Gu(t,e,r){if(e=Yx(e),Yx(t)!==e&&r)throw Error(le(425))}function Jf(){}var hp=null,dp=null;function pp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mp=typeof setTimeout=="function"?setTimeout:void 0,b4=typeof clearTimeout=="function"?clearTimeout:void 0,Qx=typeof Promise=="function"?Promise:void 0,F4=typeof queueMicrotask=="function"?queueMicrotask:typeof Qx<"u"?function(t){return Qx.resolve(null).then(t).catch(O4)}:mp;function O4(t){setTimeout(function(){throw t})}function ld(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),kc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);kc(e)}function Ia(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var al=Math.random().toString(36).slice(2),cs="__reactFiber$"+al,Pc="__reactProps$"+al,Hs="__reactContainer$"+al,gp="__reactEvents$"+al,L4="__reactListeners$"+al,M4="__reactHandles$"+al;function hi(t){var e=t[cs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Hs]||r[cs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Jx(t);t!==null;){if(r=t[cs])return r;t=Jx(t)}return e}t=r,r=t.parentNode}return null}function au(t){return t=t[cs]||t[Hs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function Zh(t){return t[Pc]||null}var xp=[],yo=-1;function Ya(t){return{current:t}}function pt(t){0>yo||(t.current=xp[yo],xp[yo]=null,yo--)}function ot(t,e){yo++,xp[yo]=t.current,t.current=e}var Ua={},Rr=Ya(Ua),Qr=Ya(!1),Ti=Ua;function $o(t,e){var r=t.type.contextTypes;if(!r)return Ua;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Jr(t){return t=t.childContextTypes,t!=null}function Zf(){pt(Qr),pt(Rr)}function Zx(t,e,r){if(Rr.current!==Ua)throw Error(le(168));ot(Rr,e),ot(Qr,r)}function Lw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(le(108,EC(t)||"Unknown",s));return wt({},r,n)}function eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ua,Ti=Rr.current,ot(Rr,t),ot(Qr,Qr.current),!0}function ev(t,e,r){var n=t.stateNode;if(!n)throw Error(le(169));r?(t=Lw(t,e,Ti),n.__reactInternalMemoizedMergedChildContext=t,pt(Qr),pt(Rr),ot(Rr,t)):pt(Qr),ot(Qr,r)}var Ds=null,e0=!1,cd=!1;function Mw(t){Ds===null?Ds=[t]:Ds.push(t)}function V4(t){e0=!0,Mw(t)}function Qa(){if(!cd&&Ds!==null){cd=!0;var t=0,e=nt;try{var r=Ds;for(nt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ds=null,e0=!1}catch(s){throw Ds!==null&&(Ds=Ds.slice(t+1)),lw(Fm,Qa),s}finally{nt=e,cd=!1}}return null}var _o=[],Eo=0,th=null,rh=0,_n=[],En=0,Ai=null,bs=1,Fs="";function li(t,e){_o[Eo++]=rh,_o[Eo++]=th,th=t,rh=e}function Vw(t,e,r){_n[En++]=bs,_n[En++]=Fs,_n[En++]=Ai,Ai=t;var n=bs;t=Fs;var s=32-Kn(n)-1;n&=~(1<<s),r+=1;var a=32-Kn(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,bs=1<<32-Kn(e)+s|r<<s|n,Fs=a+t}else bs=1<<a|r<<s|n,Fs=t}function zm(t){t.return!==null&&(li(t,1),Vw(t,1,0))}function Hm(t){for(;t===th;)th=_o[--Eo],_o[Eo]=null,rh=_o[--Eo],_o[Eo]=null;for(;t===Ai;)Ai=_n[--En],_n[En]=null,Fs=_n[--En],_n[En]=null,bs=_n[--En],_n[En]=null}var un=null,ln=null,yt=!1,zn=null;function Uw(t,e){var r=An(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function tv(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,un=t,ln=Ia(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,un=t,ln=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ai!==null?{id:bs,overflow:Fs}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=An(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,un=t,ln=null,!0):!1;default:return!1}}function vp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yp(t){if(yt){var e=ln;if(e){var r=e;if(!tv(t,e)){if(vp(t))throw Error(le(418));e=Ia(r.nextSibling);var n=un;e&&tv(t,e)?Uw(n,r):(t.flags=t.flags&-4097|2,yt=!1,un=t)}}else{if(vp(t))throw Error(le(418));t.flags=t.flags&-4097|2,yt=!1,un=t}}}function rv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;un=t}function qu(t){if(t!==un)return!1;if(!yt)return rv(t),yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pp(t.type,t.memoizedProps)),e&&(e=ln)){if(vp(t))throw Bw(),Error(le(418));for(;e;)Uw(t,e),e=Ia(e.nextSibling)}if(rv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ln=Ia(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ln=null}}else ln=un?Ia(t.stateNode.nextSibling):null;return!0}function Bw(){for(var t=ln;t;)t=Ia(t.nextSibling)}function zo(){ln=un=null,yt=!1}function Wm(t){zn===null?zn=[t]:zn.push(t)}var U4=Js.ReactCurrentBatchConfig;function Pl(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,t))}return t}function Ku(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function nv(t){var e=t._init;return e(t._payload)}function jw(t){function e(A,_){if(t){var y=A.deletions;y===null?(A.deletions=[_],A.flags|=16):y.push(_)}}function r(A,_){if(!t)return null;for(;_!==null;)e(A,_),_=_.sibling;return null}function n(A,_){for(A=new Map;_!==null;)_.key!==null?A.set(_.key,_):A.set(_.index,_),_=_.sibling;return A}function s(A,_){return A=Pa(A,_),A.index=0,A.sibling=null,A}function a(A,_,y){return A.index=y,t?(y=A.alternate,y!==null?(y=y.index,y<_?(A.flags|=2,_):y):(A.flags|=2,_)):(A.flags|=1048576,_)}function i(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,_,y,M){return _===null||_.tag!==6?(_=gd(y,A.mode,M),_.return=A,_):(_=s(_,y),_.return=A,_)}function l(A,_,y,M){var z=y.type;return z===po?f(A,_,y.props.children,M,y.key):_!==null&&(_.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ua&&nv(z)===_.type)?(M=s(_,y.props),M.ref=Pl(A,_,y),M.return=A,M):(M=Nf(y.type,y.key,y.props,null,A.mode,M),M.ref=Pl(A,_,y),M.return=A,M)}function c(A,_,y,M){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=xd(y,A.mode,M),_.return=A,_):(_=s(_,y.children||[]),_.return=A,_)}function f(A,_,y,M,z){return _===null||_.tag!==7?(_=yi(y,A.mode,M,z),_.return=A,_):(_=s(_,y),_.return=A,_)}function h(A,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=gd(""+_,A.mode,y),_.return=A,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Mu:return y=Nf(_.type,_.key,_.props,null,A.mode,y),y.ref=Pl(A,null,_),y.return=A,y;case ho:return _=xd(_,A.mode,y),_.return=A,_;case ua:var M=_._init;return h(A,M(_._payload),y)}if(Ol(_)||kl(_))return _=yi(_,A.mode,y,null),_.return=A,_;Ku(A,_)}return null}function d(A,_,y,M){var z=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return z!==null?null:o(A,_,""+y,M);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Mu:return y.key===z?l(A,_,y,M):null;case ho:return y.key===z?c(A,_,y,M):null;case ua:return z=y._init,d(A,_,z(y._payload),M)}if(Ol(y)||kl(y))return z!==null?null:f(A,_,y,M,null);Ku(A,y)}return null}function p(A,_,y,M,z){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(y)||null,o(_,A,""+M,z);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Mu:return A=A.get(M.key===null?y:M.key)||null,l(_,A,M,z);case ho:return A=A.get(M.key===null?y:M.key)||null,c(_,A,M,z);case ua:var B=M._init;return p(A,_,y,B(M._payload),z)}if(Ol(M)||kl(M))return A=A.get(y)||null,f(_,A,M,z,null);Ku(_,M)}return null}function v(A,_,y,M){for(var z=null,B=null,w=_,k=_=0,I=null;w!==null&&k<y.length;k++){w.index>k?(I=w,w=null):I=w.sibling;var R=d(A,w,y[k],M);if(R===null){w===null&&(w=I);break}t&&w&&R.alternate===null&&e(A,w),_=a(R,_,k),B===null?z=R:B.sibling=R,B=R,w=I}if(k===y.length)return r(A,w),yt&&li(A,k),z;if(w===null){for(;k<y.length;k++)w=h(A,y[k],M),w!==null&&(_=a(w,_,k),B===null?z=w:B.sibling=w,B=w);return yt&&li(A,k),z}for(w=n(A,w);k<y.length;k++)I=p(w,A,k,y[k],M),I!==null&&(t&&I.alternate!==null&&w.delete(I.key===null?k:I.key),_=a(I,_,k),B===null?z=I:B.sibling=I,B=I);return t&&w.forEach(function(F){return e(A,F)}),yt&&li(A,k),z}function x(A,_,y,M){var z=kl(y);if(typeof z!="function")throw Error(le(150));if(y=z.call(y),y==null)throw Error(le(151));for(var B=z=null,w=_,k=_=0,I=null,R=y.next();w!==null&&!R.done;k++,R=y.next()){w.index>k?(I=w,w=null):I=w.sibling;var F=d(A,w,R.value,M);if(F===null){w===null&&(w=I);break}t&&w&&F.alternate===null&&e(A,w),_=a(F,_,k),B===null?z=F:B.sibling=F,B=F,w=I}if(R.done)return r(A,w),yt&&li(A,k),z;if(w===null){for(;!R.done;k++,R=y.next())R=h(A,R.value,M),R!==null&&(_=a(R,_,k),B===null?z=R:B.sibling=R,B=R);return yt&&li(A,k),z}for(w=n(A,w);!R.done;k++,R=y.next())R=p(w,A,k,R.value,M),R!==null&&(t&&R.alternate!==null&&w.delete(R.key===null?k:R.key),_=a(R,_,k),B===null?z=R:B.sibling=R,B=R);return t&&w.forEach(function(O){return e(A,O)}),yt&&li(A,k),z}function E(A,_,y,M){if(typeof y=="object"&&y!==null&&y.type===po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Mu:e:{for(var z=y.key,B=_;B!==null;){if(B.key===z){if(z=y.type,z===po){if(B.tag===7){r(A,B.sibling),_=s(B,y.props.children),_.return=A,A=_;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ua&&nv(z)===B.type){r(A,B.sibling),_=s(B,y.props),_.ref=Pl(A,B,y),_.return=A,A=_;break e}r(A,B);break}else e(A,B);B=B.sibling}y.type===po?(_=yi(y.props.children,A.mode,M,y.key),_.return=A,A=_):(M=Nf(y.type,y.key,y.props,null,A.mode,M),M.ref=Pl(A,_,y),M.return=A,A=M)}return i(A);case ho:e:{for(B=y.key;_!==null;){if(_.key===B)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){r(A,_.sibling),_=s(_,y.children||[]),_.return=A,A=_;break e}else{r(A,_);break}else e(A,_);_=_.sibling}_=xd(y,A.mode,M),_.return=A,A=_}return i(A);case ua:return B=y._init,E(A,_,B(y._payload),M)}if(Ol(y))return v(A,_,y,M);if(kl(y))return x(A,_,y,M);Ku(A,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(r(A,_.sibling),_=s(_,y),_.return=A,A=_):(r(A,_),_=gd(y,A.mode,M),_.return=A,A=_),i(A)):r(A,_)}return E}var Ho=jw(!0),$w=jw(!1),nh=Ya(null),sh=null,wo=null,Gm=null;function qm(){Gm=wo=sh=null}function Km(t){var e=nh.current;pt(nh),t._currentValue=e}function _p(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Po(t,e){sh=t,Gm=wo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yr=!0),t.firstContext=null)}function Cn(t){var e=t._currentValue;if(Gm!==t)if(t={context:t,memoizedValue:e,next:null},wo===null){if(sh===null)throw Error(le(308));wo=t,sh.dependencies={lanes:0,firstContext:t}}else wo=wo.next=t;return e}var di=null;function Xm(t){di===null?di=[t]:di.push(t)}function zw(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Xm(e)):(r.next=s.next,s.next=r),e.interleaved=r,Ws(t,n)}function Ws(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var fa=!1;function Ym(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Vs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ca(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ye&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Ws(t,r)}return s=n.interleaved,s===null?(e.next=e,Xm(n)):(e.next=s.next,s.next=e),n.interleaved=e,Ws(t,r)}function Tf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Om(t,r)}}function sv(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ah(t,e,r,n){var s=t.updateQueue;fa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,f=c=l=null,o=a;do{var d=o.lane,p=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,x=o;switch(d=e,p=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(p,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,d=typeof v=="function"?v.call(p,h,d):v,d==null)break e;h=wt({},h,d);break e;case 2:fa=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=h):f=f.next=p,i|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);ki|=i,t.lanes=i,t.memoizedState=h}}function av(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(le(191,s));s.call(n)}}}var iu={},ps=Ya(iu),Dc=Ya(iu),bc=Ya(iu);function pi(t){if(t===iu)throw Error(le(174));return t}function Qm(t,e){switch(ot(bc,e),ot(Dc,t),ot(ps,iu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ep(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ep(e,t)}pt(ps),ot(ps,e)}function Wo(){pt(ps),pt(Dc),pt(bc)}function Ww(t){pi(bc.current);var e=pi(ps.current),r=ep(e,t.type);e!==r&&(ot(Dc,t),ot(ps,r))}function Jm(t){Dc.current===t&&(pt(ps),pt(Dc))}var _t=Ya(0);function ih(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ud=[];function Zm(){for(var t=0;t<ud.length;t++)ud[t]._workInProgressVersionPrimary=null;ud.length=0}var Af=Js.ReactCurrentDispatcher,fd=Js.ReactCurrentBatchConfig,Si=0,Et=null,qt=null,er=null,oh=!1,ec=!1,Fc=0,B4=0;function yr(){throw Error(le(321))}function eg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Qn(t[r],e[r]))return!1;return!0}function tg(t,e,r,n,s,a){if(Si=a,Et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Af.current=t===null||t.memoizedState===null?H4:W4,t=r(n,s),ec){a=0;do{if(ec=!1,Fc=0,25<=a)throw Error(le(301));a+=1,er=qt=null,e.updateQueue=null,Af.current=G4,t=r(n,s)}while(ec)}if(Af.current=lh,e=qt!==null&&qt.next!==null,Si=0,er=qt=Et=null,oh=!1,e)throw Error(le(300));return t}function rg(){var t=Fc!==0;return Fc=0,t}function os(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?Et.memoizedState=er=t:er=er.next=t,er}function Nn(){if(qt===null){var t=Et.alternate;t=t!==null?t.memoizedState:null}else t=qt.next;var e=er===null?Et.memoizedState:er.next;if(e!==null)er=e,qt=t;else{if(t===null)throw Error(le(310));qt=t,t={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},er===null?Et.memoizedState=er=t:er=er.next=t}return er}function Oc(t,e){return typeof e=="function"?e(t):e}function hd(t){var e=Nn(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=qt,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var f=c.lane;if((Si&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Et.lanes|=f,ki|=f}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,Qn(n,e.memoizedState)||(Yr=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,Et.lanes|=a,ki|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function dd(t){var e=Nn(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Qn(a,e.memoizedState)||(Yr=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function Gw(){}function qw(t,e){var r=Et,n=Nn(),s=e(),a=!Qn(n.memoizedState,s);if(a&&(n.memoizedState=s,Yr=!0),n=n.queue,ng(Yw.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||er!==null&&er.memoizedState.tag&1){if(r.flags|=2048,Lc(9,Xw.bind(null,r,n,s,e),void 0,null),tr===null)throw Error(le(349));Si&30||Kw(r,e,s)}return s}function Kw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Xw(t,e,r,n){e.value=r,e.getSnapshot=n,Qw(e)&&Jw(t)}function Yw(t,e,r){return r(function(){Qw(e)&&Jw(t)})}function Qw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Qn(t,r)}catch{return!0}}function Jw(t){var e=Ws(t,1);e!==null&&Xn(e,t,1,-1)}function iv(t){var e=os();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oc,lastRenderedState:t},e.queue=t,t=t.dispatch=z4.bind(null,Et,t),[e.memoizedState,t]}function Lc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Zw(){return Nn().memoizedState}function Sf(t,e,r,n){var s=os();Et.flags|=t,s.memoizedState=Lc(1|e,r,void 0,n===void 0?null:n)}function t0(t,e,r,n){var s=Nn();n=n===void 0?null:n;var a=void 0;if(qt!==null){var i=qt.memoizedState;if(a=i.destroy,n!==null&&eg(n,i.deps)){s.memoizedState=Lc(e,r,a,n);return}}Et.flags|=t,s.memoizedState=Lc(1|e,r,a,n)}function ov(t,e){return Sf(8390656,8,t,e)}function ng(t,e){return t0(2048,8,t,e)}function e2(t,e){return t0(4,2,t,e)}function t2(t,e){return t0(4,4,t,e)}function r2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function n2(t,e,r){return r=r!=null?r.concat([t]):null,t0(4,4,r2.bind(null,e,t),r)}function sg(){}function s2(t,e){var r=Nn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&eg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function a2(t,e){var r=Nn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&eg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function i2(t,e,r){return Si&21?(Qn(r,e)||(r=fw(),Et.lanes|=r,ki|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yr=!0),t.memoizedState=r)}function j4(t,e){var r=nt;nt=r!==0&&4>r?r:4,t(!0);var n=fd.transition;fd.transition={};try{t(!1),e()}finally{nt=r,fd.transition=n}}function o2(){return Nn().memoizedState}function $4(t,e,r){var n=Ra(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},l2(t))c2(e,r);else if(r=zw(t,e,r,n),r!==null){var s=jr();Xn(r,t,n,s),u2(r,e,n)}}function z4(t,e,r){var n=Ra(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(l2(t))c2(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Qn(o,i)){var l=e.interleaved;l===null?(s.next=s,Xm(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=zw(t,e,s,n),r!==null&&(s=jr(),Xn(r,t,n,s),u2(r,e,n))}}function l2(t){var e=t.alternate;return t===Et||e!==null&&e===Et}function c2(t,e){ec=oh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function u2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Om(t,r)}}var lh={readContext:Cn,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useInsertionEffect:yr,useLayoutEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useMutableSource:yr,useSyncExternalStore:yr,useId:yr,unstable_isNewReconciler:!1},H4={readContext:Cn,useCallback:function(t,e){return os().memoizedState=[t,e===void 0?null:e],t},useContext:Cn,useEffect:ov,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Sf(4194308,4,r2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Sf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sf(4,2,t,e)},useMemo:function(t,e){var r=os();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=os();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=$4.bind(null,Et,t),[n.memoizedState,t]},useRef:function(t){var e=os();return t={current:t},e.memoizedState=t},useState:iv,useDebugValue:sg,useDeferredValue:function(t){return os().memoizedState=t},useTransition:function(){var t=iv(!1),e=t[0];return t=j4.bind(null,t[1]),os().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Et,s=os();if(yt){if(r===void 0)throw Error(le(407));r=r()}else{if(r=e(),tr===null)throw Error(le(349));Si&30||Kw(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,ov(Yw.bind(null,n,a,t),[t]),n.flags|=2048,Lc(9,Xw.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=os(),e=tr.identifierPrefix;if(yt){var r=Fs,n=bs;r=(n&~(1<<32-Kn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Fc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=B4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},W4={readContext:Cn,useCallback:s2,useContext:Cn,useEffect:ng,useImperativeHandle:n2,useInsertionEffect:e2,useLayoutEffect:t2,useMemo:a2,useReducer:hd,useRef:Zw,useState:function(){return hd(Oc)},useDebugValue:sg,useDeferredValue:function(t){var e=Nn();return i2(e,qt.memoizedState,t)},useTransition:function(){var t=hd(Oc)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:Gw,useSyncExternalStore:qw,useId:o2,unstable_isNewReconciler:!1},G4={readContext:Cn,useCallback:s2,useContext:Cn,useEffect:ng,useImperativeHandle:n2,useInsertionEffect:e2,useLayoutEffect:t2,useMemo:a2,useReducer:dd,useRef:Zw,useState:function(){return dd(Oc)},useDebugValue:sg,useDeferredValue:function(t){var e=Nn();return qt===null?e.memoizedState=t:i2(e,qt.memoizedState,t)},useTransition:function(){var t=dd(Oc)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:Gw,useSyncExternalStore:qw,useId:o2,unstable_isNewReconciler:!1};function Un(t,e){if(t&&t.defaultProps){e=wt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Ep(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:wt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var r0={isMounted:function(t){return(t=t._reactInternals)?Vi(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=jr(),s=Ra(t),a=Vs(n,s);a.payload=e,r!=null&&(a.callback=r),e=Ca(t,a,s),e!==null&&(Xn(e,t,s,n),Tf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=jr(),s=Ra(t),a=Vs(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Ca(t,a,s),e!==null&&(Xn(e,t,s,n),Tf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=jr(),n=Ra(t),s=Vs(r,n);s.tag=2,e!=null&&(s.callback=e),e=Ca(t,s,n),e!==null&&(Xn(e,t,n,r),Tf(e,t,n))}};function lv(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!Cc(r,n)||!Cc(s,a):!0}function f2(t,e,r){var n=!1,s=Ua,a=e.contextType;return typeof a=="object"&&a!==null?a=Cn(a):(s=Jr(e)?Ti:Rr.current,n=e.contextTypes,a=(n=n!=null)?$o(t,s):Ua),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=r0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function cv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&r0.enqueueReplaceState(e,e.state,null)}function wp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Ym(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Cn(a):(a=Jr(e)?Ti:Rr.current,s.context=$o(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Ep(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&r0.enqueueReplaceState(s,s.state,null),ah(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Go(t,e){try{var r="",n=e;do r+=_C(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function pd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Tp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var q4=typeof WeakMap=="function"?WeakMap:Map;function h2(t,e,r){r=Vs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){uh||(uh=!0,bp=n),Tp(t,e)},r}function d2(t,e,r){r=Vs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Tp(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Tp(t,e),typeof n!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function uv(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new q4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=oN.bind(null,t,e,r),e.then(t,t))}function fv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function hv(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Vs(-1,1),e.tag=2,Ca(r,e,1))),r.lanes|=1),t)}var K4=Js.ReactCurrentOwner,Yr=!1;function Mr(t,e,r,n){e.child=t===null?$w(e,null,r,n):Ho(e,t.child,r,n)}function dv(t,e,r,n,s){r=r.render;var a=e.ref;return Po(e,s),n=tg(t,e,r,n,a,s),r=rg(),t!==null&&!Yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gs(t,e,s)):(yt&&r&&zm(e),e.flags|=1,Mr(t,e,n,s),e.child)}function pv(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!hg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,p2(t,e,a,n,s)):(t=Nf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Cc,r(i,n)&&t.ref===e.ref)return Gs(t,e,s)}return e.flags|=1,t=Pa(a,n),t.ref=e.ref,t.return=e,e.child=t}function p2(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(Cc(a,n)&&t.ref===e.ref)if(Yr=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Yr=!0);else return e.lanes=t.lanes,Gs(t,e,s)}return Ap(t,e,r,n,s)}function m2(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(Ao,sn),sn|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot(Ao,sn),sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,ot(Ao,sn),sn|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,ot(Ao,sn),sn|=n;return Mr(t,e,s,r),e.child}function g2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Ap(t,e,r,n,s){var a=Jr(r)?Ti:Rr.current;return a=$o(e,a),Po(e,s),r=tg(t,e,r,n,a,s),n=rg(),t!==null&&!Yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gs(t,e,s)):(yt&&n&&zm(e),e.flags|=1,Mr(t,e,r,s),e.child)}function mv(t,e,r,n,s){if(Jr(r)){var a=!0;eh(e)}else a=!1;if(Po(e,s),e.stateNode===null)kf(t,e),f2(e,r,n),wp(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Cn(c):(c=Jr(r)?Ti:Rr.current,c=$o(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&cv(e,i,n,c),fa=!1;var d=e.memoizedState;i.state=d,ah(e,n,i,s),l=e.memoizedState,o!==n||d!==l||Qr.current||fa?(typeof f=="function"&&(Ep(e,r,f,n),l=e.memoizedState),(o=fa||lv(e,r,o,n,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,Hw(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Un(e.type,o),i.props=c,h=e.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Cn(l):(l=Jr(r)?Ti:Rr.current,l=$o(e,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||d!==l)&&cv(e,i,n,l),fa=!1,d=e.memoizedState,i.state=d,ah(e,n,i,s);var v=e.memoizedState;o!==h||d!==v||Qr.current||fa?(typeof p=="function"&&(Ep(e,r,p,n),v=e.memoizedState),(c=fa||lv(e,r,c,n,d,v,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),i.props=n,i.state=v,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Sp(t,e,r,n,a,s)}function Sp(t,e,r,n,s,a){g2(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&ev(e,r,!1),Gs(t,e,a);n=e.stateNode,K4.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=Ho(e,t.child,null,a),e.child=Ho(e,null,o,a)):Mr(t,e,o,a),e.memoizedState=n.state,s&&ev(e,r,!0),e.child}function x2(t){var e=t.stateNode;e.pendingContext?Zx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zx(t,e.context,!1),Qm(t,e.containerInfo)}function gv(t,e,r,n,s){return zo(),Wm(s),e.flags|=256,Mr(t,e,r,n),e.child}var kp={dehydrated:null,treeContext:null,retryLane:0};function Ip(t){return{baseLanes:t,cachePool:null,transitions:null}}function v2(t,e,r){var n=e.pendingProps,s=_t.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ot(_t,s&1),t===null)return yp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=a0(i,n,0,null),t=yi(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Ip(r),e.memoizedState=kp,t):ag(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return X4(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Pa(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Pa(o,a):(a=yi(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?Ip(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=kp,n}return a=t.child,t=a.sibling,n=Pa(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function ag(t,e){return e=a0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xu(t,e,r,n){return n!==null&&Wm(n),Ho(e,t.child,null,r),t=ag(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function X4(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=pd(Error(le(422))),Xu(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=a0({mode:"visible",children:n.children},s,0,null),a=yi(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&Ho(e,t.child,null,i),e.child.memoizedState=Ip(i),e.memoizedState=kp,a);if(!(e.mode&1))return Xu(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(le(419)),n=pd(a,n,void 0),Xu(t,e,i,n)}if(o=(i&t.childLanes)!==0,Yr||o){if(n=tr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Ws(t,s),Xn(n,t,s,-1))}return fg(),n=pd(Error(le(421))),Xu(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=lN.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,ln=Ia(s.nextSibling),un=e,yt=!0,zn=null,t!==null&&(_n[En++]=bs,_n[En++]=Fs,_n[En++]=Ai,bs=t.id,Fs=t.overflow,Ai=e),e=ag(e,n.children),e.flags|=4096,e)}function xv(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),_p(t.return,e,r)}function md(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function y2(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Mr(t,e,n.children,r),n=_t.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xv(t,r,e);else if(t.tag===19)xv(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ot(_t,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&ih(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),md(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ih(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}md(e,!0,r,null,a);break;case"together":md(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function kf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ki|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,r=Pa(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Pa(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Y4(t,e,r){switch(e.tag){case 3:x2(e),zo();break;case 5:Ww(e);break;case 1:Jr(e.type)&&eh(e);break;case 4:Qm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;ot(nh,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ot(_t,_t.current&1),e.flags|=128,null):r&e.child.childLanes?v2(t,e,r):(ot(_t,_t.current&1),t=Gs(t,e,r),t!==null?t.sibling:null);ot(_t,_t.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return y2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ot(_t,_t.current),n)break;return null;case 22:case 23:return e.lanes=0,m2(t,e,r)}return Gs(t,e,r)}var _2,Cp,E2,w2;_2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Cp=function(){};E2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,pi(ps.current);var a=null;switch(r){case"input":s=Yd(t,s),n=Yd(t,n),a=[];break;case"select":s=wt({},s,{value:void 0}),n=wt({},n,{value:void 0}),a=[];break;case"textarea":s=Zd(t,s),n=Zd(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Jf)}tp(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ec.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ec.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ht("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};w2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Dl(t,e){if(!yt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function _r(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Q4(t,e,r){var n=e.pendingProps;switch(Hm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(e),null;case 1:return Jr(e.type)&&Zf(),_r(e),null;case 3:return n=e.stateNode,Wo(),pt(Qr),pt(Rr),Zm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(qu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zn!==null&&(Lp(zn),zn=null))),Cp(t,e),_r(e),null;case 5:Jm(e);var s=pi(bc.current);if(r=e.type,t!==null&&e.stateNode!=null)E2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(le(166));return _r(e),null}if(t=pi(ps.current),qu(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[cs]=e,n[Pc]=a,t=(e.mode&1)!==0,r){case"dialog":ht("cancel",n),ht("close",n);break;case"iframe":case"object":case"embed":ht("load",n);break;case"video":case"audio":for(s=0;s<Ml.length;s++)ht(Ml[s],n);break;case"source":ht("error",n);break;case"img":case"image":case"link":ht("error",n),ht("load",n);break;case"details":ht("toggle",n);break;case"input":kx(n,a),ht("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},ht("invalid",n);break;case"textarea":Cx(n,a),ht("invalid",n)}tp(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Gu(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Gu(n.textContent,o,t),s=["children",""+o]):Ec.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ht("scroll",n)}switch(r){case"input":Vu(n),Ix(n,a,!0);break;case"textarea":Vu(n),Nx(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Jf)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=YE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[cs]=e,t[Pc]=n,_2(t,e,!1,!1),e.stateNode=t;e:{switch(i=rp(r,n),r){case"dialog":ht("cancel",t),ht("close",t),s=n;break;case"iframe":case"object":case"embed":ht("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ml.length;s++)ht(Ml[s],t);s=n;break;case"source":ht("error",t),s=n;break;case"img":case"image":case"link":ht("error",t),ht("load",t),s=n;break;case"details":ht("toggle",t),s=n;break;case"input":kx(t,n),s=Yd(t,n),ht("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=wt({},n,{value:void 0}),ht("invalid",t);break;case"textarea":Cx(t,n),s=Zd(t,n),ht("invalid",t);break;default:s=n}tp(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?ZE(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&QE(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&wc(t,l):typeof l=="number"&&wc(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ec.hasOwnProperty(a)?l!=null&&a==="onScroll"&&ht("scroll",t):l!=null&&Nm(t,a,l,i))}switch(r){case"input":Vu(t),Ix(t,n,!1);break;case"textarea":Vu(t),Nx(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Va(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?Io(t,!!n.multiple,a,!1):n.defaultValue!=null&&Io(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _r(e),null;case 6:if(t&&e.stateNode!=null)w2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(le(166));if(r=pi(bc.current),pi(ps.current),qu(e)){if(n=e.stateNode,r=e.memoizedProps,n[cs]=e,(a=n.nodeValue!==r)&&(t=un,t!==null))switch(t.tag){case 3:Gu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gu(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[cs]=e,e.stateNode=n}return _r(e),null;case 13:if(pt(_t),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yt&&ln!==null&&e.mode&1&&!(e.flags&128))Bw(),zo(),e.flags|=98560,a=!1;else if(a=qu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(le(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(le(317));a[cs]=e}else zo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_r(e),a=!1}else zn!==null&&(Lp(zn),zn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||_t.current&1?Kt===0&&(Kt=3):fg())),e.updateQueue!==null&&(e.flags|=4),_r(e),null);case 4:return Wo(),Cp(t,e),t===null&&Nc(e.stateNode.containerInfo),_r(e),null;case 10:return Km(e.type._context),_r(e),null;case 17:return Jr(e.type)&&Zf(),_r(e),null;case 19:if(pt(_t),a=e.memoizedState,a===null)return _r(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)Dl(a,!1);else{if(Kt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ih(t),i!==null){for(e.flags|=128,Dl(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ot(_t,_t.current&1|2),e.child}t=t.sibling}a.tail!==null&&bt()>qo&&(e.flags|=128,n=!0,Dl(a,!1),e.lanes=4194304)}else{if(!n)if(t=ih(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Dl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!yt)return _r(e),null}else 2*bt()-a.renderingStartTime>qo&&r!==1073741824&&(e.flags|=128,n=!0,Dl(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=bt(),e.sibling=null,r=_t.current,ot(_t,n?r&1|2:r&1),e):(_r(e),null);case 22:case 23:return ug(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?sn&1073741824&&(_r(e),e.subtreeFlags&6&&(e.flags|=8192)):_r(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function J4(t,e){switch(Hm(e),e.tag){case 1:return Jr(e.type)&&Zf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wo(),pt(Qr),pt(Rr),Zm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Jm(e),null;case 13:if(pt(_t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));zo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(_t),null;case 4:return Wo(),null;case 10:return Km(e.type._context),null;case 22:case 23:return ug(),null;case 24:return null;default:return null}}var Yu=!1,Sr=!1,Z4=typeof WeakSet=="function"?WeakSet:Set,ke=null;function To(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){It(t,e,n)}else r.current=null}function Np(t,e,r){try{r()}catch(n){It(t,e,n)}}var vv=!1;function eN(t,e){if(hp=Xf,t=Iw(),$m(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===s&&(o=i),d===a&&++f===n&&(l=i),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(dp={focusedElem:t,selectionRange:r},Xf=!1,ke=e;ke!==null;)if(e=ke,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ke=t;else for(;ke!==null;){e=ke;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,E=v.memoizedState,A=e.stateNode,_=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Un(e.type,x),E);A.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(M){It(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ke=t;break}ke=e.return}return v=vv,vv=!1,v}function tc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&Np(e,r,a)}s=s.next}while(s!==n)}}function n0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Rp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function T2(t){var e=t.alternate;e!==null&&(t.alternate=null,T2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[cs],delete e[Pc],delete e[gp],delete e[L4],delete e[M4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function A2(t){return t.tag===5||t.tag===3||t.tag===4}function yv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||A2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Jf));else if(n!==4&&(t=t.child,t!==null))for(Pp(t,e,r),t=t.sibling;t!==null;)Pp(t,e,r),t=t.sibling}function Dp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Dp(t,e,r),t=t.sibling;t!==null;)Dp(t,e,r),t=t.sibling}var lr=null,$n=!1;function oa(t,e,r){for(r=r.child;r!==null;)S2(t,e,r),r=r.sibling}function S2(t,e,r){if(ds&&typeof ds.onCommitFiberUnmount=="function")try{ds.onCommitFiberUnmount(Xh,r)}catch{}switch(r.tag){case 5:Sr||To(r,e);case 6:var n=lr,s=$n;lr=null,oa(t,e,r),lr=n,$n=s,lr!==null&&($n?(t=lr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):lr.removeChild(r.stateNode));break;case 18:lr!==null&&($n?(t=lr,r=r.stateNode,t.nodeType===8?ld(t.parentNode,r):t.nodeType===1&&ld(t,r),kc(t)):ld(lr,r.stateNode));break;case 4:n=lr,s=$n,lr=r.stateNode.containerInfo,$n=!0,oa(t,e,r),lr=n,$n=s;break;case 0:case 11:case 14:case 15:if(!Sr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Np(r,e,i),s=s.next}while(s!==n)}oa(t,e,r);break;case 1:if(!Sr&&(To(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){It(r,e,o)}oa(t,e,r);break;case 21:oa(t,e,r);break;case 22:r.mode&1?(Sr=(n=Sr)||r.memoizedState!==null,oa(t,e,r),Sr=n):oa(t,e,r);break;default:oa(t,e,r)}}function _v(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Z4),e.forEach(function(n){var s=cN.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ln(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:lr=o.stateNode,$n=!1;break e;case 3:lr=o.stateNode.containerInfo,$n=!0;break e;case 4:lr=o.stateNode.containerInfo,$n=!0;break e}o=o.return}if(lr===null)throw Error(le(160));S2(a,i,s),lr=null,$n=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){It(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)k2(e,t),e=e.sibling}function k2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ln(e,t),ss(t),n&4){try{tc(3,t,t.return),n0(3,t)}catch(x){It(t,t.return,x)}try{tc(5,t,t.return)}catch(x){It(t,t.return,x)}}break;case 1:Ln(e,t),ss(t),n&512&&r!==null&&To(r,r.return);break;case 5:if(Ln(e,t),ss(t),n&512&&r!==null&&To(r,r.return),t.flags&32){var s=t.stateNode;try{wc(s,"")}catch(x){It(t,t.return,x)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&KE(s,a),rp(o,i);var c=rp(o,a);for(i=0;i<l.length;i+=2){var f=l[i],h=l[i+1];f==="style"?ZE(s,h):f==="dangerouslySetInnerHTML"?QE(s,h):f==="children"?wc(s,h):Nm(s,f,h,c)}switch(o){case"input":Qd(s,a);break;case"textarea":XE(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Io(s,!!a.multiple,p,!1):d!==!!a.multiple&&(a.defaultValue!=null?Io(s,!!a.multiple,a.defaultValue,!0):Io(s,!!a.multiple,a.multiple?[]:"",!1))}s[Pc]=a}catch(x){It(t,t.return,x)}}break;case 6:if(Ln(e,t),ss(t),n&4){if(t.stateNode===null)throw Error(le(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(x){It(t,t.return,x)}}break;case 3:if(Ln(e,t),ss(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{kc(e.containerInfo)}catch(x){It(t,t.return,x)}break;case 4:Ln(e,t),ss(t);break;case 13:Ln(e,t),ss(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(lg=bt())),n&4&&_v(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Sr=(c=Sr)||f,Ln(e,t),Sr=c):Ln(e,t),ss(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(ke=t,f=t.child;f!==null;){for(h=ke=f;ke!==null;){switch(d=ke,p=d.child,d.tag){case 0:case 11:case 14:case 15:tc(4,d,d.return);break;case 1:To(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){It(n,r,x)}}break;case 5:To(d,d.return);break;case 22:if(d.memoizedState!==null){wv(h);continue}}p!==null?(p.return=d,ke=p):wv(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=JE("display",i))}catch(x){It(t,t.return,x)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){It(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ln(e,t),ss(t),n&4&&_v(t);break;case 21:break;default:Ln(e,t),ss(t)}}function ss(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(A2(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(wc(s,""),n.flags&=-33);var a=yv(t);Dp(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=yv(t);Pp(t,o,i);break;default:throw Error(le(161))}}catch(l){It(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tN(t,e,r){ke=t,I2(t)}function I2(t,e,r){for(var n=(t.mode&1)!==0;ke!==null;){var s=ke,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Yu;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Sr;o=Yu;var c=Sr;if(Yu=i,(Sr=l)&&!c)for(ke=s;ke!==null;)i=ke,l=i.child,i.tag===22&&i.memoizedState!==null?Tv(s):l!==null?(l.return=i,ke=l):Tv(s);for(;a!==null;)ke=a,I2(a),a=a.sibling;ke=s,Yu=o,Sr=c}Ev(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ke=a):Ev(t)}}function Ev(t){for(;ke!==null;){var e=ke;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Sr||n0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Sr)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Un(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&av(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}av(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&kc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Sr||e.flags&512&&Rp(e)}catch(d){It(e,e.return,d)}}if(e===t){ke=null;break}if(r=e.sibling,r!==null){r.return=e.return,ke=r;break}ke=e.return}}function wv(t){for(;ke!==null;){var e=ke;if(e===t){ke=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ke=r;break}ke=e.return}}function Tv(t){for(;ke!==null;){var e=ke;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{n0(4,e)}catch(l){It(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){It(e,s,l)}}var a=e.return;try{Rp(e)}catch(l){It(e,a,l)}break;case 5:var i=e.return;try{Rp(e)}catch(l){It(e,i,l)}}}catch(l){It(e,e.return,l)}if(e===t){ke=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ke=o;break}ke=e.return}}var rN=Math.ceil,ch=Js.ReactCurrentDispatcher,ig=Js.ReactCurrentOwner,Sn=Js.ReactCurrentBatchConfig,Ye=0,tr=null,$t=null,hr=0,sn=0,Ao=Ya(0),Kt=0,Mc=null,ki=0,s0=0,og=0,rc=null,Kr=null,lg=0,qo=1/0,Ps=null,uh=!1,bp=null,Na=null,Qu=!1,_a=null,fh=0,nc=0,Fp=null,If=-1,Cf=0;function jr(){return Ye&6?bt():If!==-1?If:If=bt()}function Ra(t){return t.mode&1?Ye&2&&hr!==0?hr&-hr:U4.transition!==null?(Cf===0&&(Cf=fw()),Cf):(t=nt,t!==0||(t=window.event,t=t===void 0?16:vw(t.type)),t):1}function Xn(t,e,r,n){if(50<nc)throw nc=0,Fp=null,Error(le(185));nu(t,r,n),(!(Ye&2)||t!==tr)&&(t===tr&&(!(Ye&2)&&(s0|=r),Kt===4&&da(t,hr)),Zr(t,n),r===1&&Ye===0&&!(e.mode&1)&&(qo=bt()+500,e0&&Qa()))}function Zr(t,e){var r=t.callbackNode;UC(t,e);var n=Kf(t,t===tr?hr:0);if(n===0)r!==null&&Dx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Dx(r),e===1)t.tag===0?V4(Av.bind(null,t)):Mw(Av.bind(null,t)),F4(function(){!(Ye&6)&&Qa()}),r=null;else{switch(hw(n)){case 1:r=Fm;break;case 4:r=cw;break;case 16:r=qf;break;case 536870912:r=uw;break;default:r=qf}r=O2(r,C2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function C2(t,e){if(If=-1,Cf=0,Ye&6)throw Error(le(327));var r=t.callbackNode;if(Do()&&t.callbackNode!==r)return null;var n=Kf(t,t===tr?hr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=hh(t,n);else{e=n;var s=Ye;Ye|=2;var a=R2();(tr!==t||hr!==e)&&(Ps=null,qo=bt()+500,vi(t,e));do try{aN();break}catch(o){N2(t,o)}while(!0);qm(),ch.current=a,Ye=s,$t!==null?e=0:(tr=null,hr=0,e=Kt)}if(e!==0){if(e===2&&(s=op(t),s!==0&&(n=s,e=Op(t,s))),e===1)throw r=Mc,vi(t,0),da(t,n),Zr(t,bt()),r;if(e===6)da(t,n);else{if(s=t.current.alternate,!(n&30)&&!nN(s)&&(e=hh(t,n),e===2&&(a=op(t),a!==0&&(n=a,e=Op(t,a))),e===1))throw r=Mc,vi(t,0),da(t,n),Zr(t,bt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(le(345));case 2:ci(t,Kr,Ps);break;case 3:if(da(t,n),(n&130023424)===n&&(e=lg+500-bt(),10<e)){if(Kf(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){jr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=mp(ci.bind(null,t,Kr,Ps),e);break}ci(t,Kr,Ps);break;case 4:if(da(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-Kn(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=bt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*rN(n/1960))-n,10<n){t.timeoutHandle=mp(ci.bind(null,t,Kr,Ps),n);break}ci(t,Kr,Ps);break;case 5:ci(t,Kr,Ps);break;default:throw Error(le(329))}}}return Zr(t,bt()),t.callbackNode===r?C2.bind(null,t):null}function Op(t,e){var r=rc;return t.current.memoizedState.isDehydrated&&(vi(t,e).flags|=256),t=hh(t,e),t!==2&&(e=Kr,Kr=r,e!==null&&Lp(e)),t}function Lp(t){Kr===null?Kr=t:Kr.push.apply(Kr,t)}function nN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Qn(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function da(t,e){for(e&=~og,e&=~s0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Kn(e),n=1<<r;t[r]=-1,e&=~n}}function Av(t){if(Ye&6)throw Error(le(327));Do();var e=Kf(t,0);if(!(e&1))return Zr(t,bt()),null;var r=hh(t,e);if(t.tag!==0&&r===2){var n=op(t);n!==0&&(e=n,r=Op(t,n))}if(r===1)throw r=Mc,vi(t,0),da(t,e),Zr(t,bt()),r;if(r===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ci(t,Kr,Ps),Zr(t,bt()),null}function cg(t,e){var r=Ye;Ye|=1;try{return t(e)}finally{Ye=r,Ye===0&&(qo=bt()+500,e0&&Qa())}}function Ii(t){_a!==null&&_a.tag===0&&!(Ye&6)&&Do();var e=Ye;Ye|=1;var r=Sn.transition,n=nt;try{if(Sn.transition=null,nt=1,t)return t()}finally{nt=n,Sn.transition=r,Ye=e,!(Ye&6)&&Qa()}}function ug(){sn=Ao.current,pt(Ao)}function vi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,b4(r)),$t!==null)for(r=$t.return;r!==null;){var n=r;switch(Hm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Zf();break;case 3:Wo(),pt(Qr),pt(Rr),Zm();break;case 5:Jm(n);break;case 4:Wo();break;case 13:pt(_t);break;case 19:pt(_t);break;case 10:Km(n.type._context);break;case 22:case 23:ug()}r=r.return}if(tr=t,$t=t=Pa(t.current,null),hr=sn=e,Kt=0,Mc=null,og=s0=ki=0,Kr=rc=null,di!==null){for(e=0;e<di.length;e++)if(r=di[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}di=null}return t}function N2(t,e){do{var r=$t;try{if(qm(),Af.current=lh,oh){for(var n=Et.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}oh=!1}if(Si=0,er=qt=Et=null,ec=!1,Fc=0,ig.current=null,r===null||r.return===null){Kt=1,Mc=e,$t=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=hr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=fv(i);if(p!==null){p.flags&=-257,hv(p,i,o,a,e),p.mode&1&&uv(a,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var x=new Set;x.add(l),e.updateQueue=x}else v.add(l);break e}else{if(!(e&1)){uv(a,c,e),fg();break e}l=Error(le(426))}}else if(yt&&o.mode&1){var E=fv(i);if(E!==null){!(E.flags&65536)&&(E.flags|=256),hv(E,i,o,a,e),Wm(Go(l,o));break e}}a=l=Go(l,o),Kt!==4&&(Kt=2),rc===null?rc=[a]:rc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var A=h2(a,l,e);sv(a,A);break e;case 1:o=l;var _=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Na===null||!Na.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var M=d2(a,o,e);sv(a,M);break e}}a=a.return}while(a!==null)}D2(r)}catch(z){e=z,$t===r&&r!==null&&($t=r=r.return);continue}break}while(!0)}function R2(){var t=ch.current;return ch.current=lh,t===null?lh:t}function fg(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),tr===null||!(ki&268435455)&&!(s0&268435455)||da(tr,hr)}function hh(t,e){var r=Ye;Ye|=2;var n=R2();(tr!==t||hr!==e)&&(Ps=null,vi(t,e));do try{sN();break}catch(s){N2(t,s)}while(!0);if(qm(),Ye=r,ch.current=n,$t!==null)throw Error(le(261));return tr=null,hr=0,Kt}function sN(){for(;$t!==null;)P2($t)}function aN(){for(;$t!==null&&!RC();)P2($t)}function P2(t){var e=F2(t.alternate,t,sn);t.memoizedProps=t.pendingProps,e===null?D2(t):$t=e,ig.current=null}function D2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=J4(r,e),r!==null){r.flags&=32767,$t=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kt=6,$t=null;return}}else if(r=Q4(r,e,sn),r!==null){$t=r;return}if(e=e.sibling,e!==null){$t=e;return}$t=e=t}while(e!==null);Kt===0&&(Kt=5)}function ci(t,e,r){var n=nt,s=Sn.transition;try{Sn.transition=null,nt=1,iN(t,e,r,n)}finally{Sn.transition=s,nt=n}return null}function iN(t,e,r,n){do Do();while(_a!==null);if(Ye&6)throw Error(le(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(BC(t,a),t===tr&&($t=tr=null,hr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Qu||(Qu=!0,O2(qf,function(){return Do(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Sn.transition,Sn.transition=null;var i=nt;nt=1;var o=Ye;Ye|=4,ig.current=null,eN(t,r),k2(r,t),k4(dp),Xf=!!hp,dp=hp=null,t.current=r,tN(r),PC(),Ye=o,nt=i,Sn.transition=a}else t.current=r;if(Qu&&(Qu=!1,_a=t,fh=s),a=t.pendingLanes,a===0&&(Na=null),FC(r.stateNode),Zr(t,bt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(uh)throw uh=!1,t=bp,bp=null,t;return fh&1&&t.tag!==0&&Do(),a=t.pendingLanes,a&1?t===Fp?nc++:(nc=0,Fp=t):nc=0,Qa(),null}function Do(){if(_a!==null){var t=hw(fh),e=Sn.transition,r=nt;try{if(Sn.transition=null,nt=16>t?16:t,_a===null)var n=!1;else{if(t=_a,_a=null,fh=0,Ye&6)throw Error(le(331));var s=Ye;for(Ye|=4,ke=t.current;ke!==null;){var a=ke,i=a.child;if(ke.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ke=c;ke!==null;){var f=ke;switch(f.tag){case 0:case 11:case 15:tc(8,f,a)}var h=f.child;if(h!==null)h.return=f,ke=h;else for(;ke!==null;){f=ke;var d=f.sibling,p=f.return;if(T2(f),f===c){ke=null;break}if(d!==null){d.return=p,ke=d;break}ke=p}}}var v=a.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}ke=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ke=i;else e:for(;ke!==null;){if(a=ke,a.flags&2048)switch(a.tag){case 0:case 11:case 15:tc(9,a,a.return)}var A=a.sibling;if(A!==null){A.return=a.return,ke=A;break e}ke=a.return}}var _=t.current;for(ke=_;ke!==null;){i=ke;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,ke=y;else e:for(i=_;ke!==null;){if(o=ke,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:n0(9,o)}}catch(z){It(o,o.return,z)}if(o===i){ke=null;break e}var M=o.sibling;if(M!==null){M.return=o.return,ke=M;break e}ke=o.return}}if(Ye=s,Qa(),ds&&typeof ds.onPostCommitFiberRoot=="function")try{ds.onPostCommitFiberRoot(Xh,t)}catch{}n=!0}return n}finally{nt=r,Sn.transition=e}}return!1}function Sv(t,e,r){e=Go(r,e),e=h2(t,e,1),t=Ca(t,e,1),e=jr(),t!==null&&(nu(t,1,e),Zr(t,e))}function It(t,e,r){if(t.tag===3)Sv(t,t,r);else for(;e!==null;){if(e.tag===3){Sv(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Na===null||!Na.has(n))){t=Go(r,t),t=d2(e,t,1),e=Ca(e,t,1),t=jr(),e!==null&&(nu(e,1,t),Zr(e,t));break}}e=e.return}}function oN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=jr(),t.pingedLanes|=t.suspendedLanes&r,tr===t&&(hr&r)===r&&(Kt===4||Kt===3&&(hr&130023424)===hr&&500>bt()-lg?vi(t,0):og|=r),Zr(t,e)}function b2(t,e){e===0&&(t.mode&1?(e=ju,ju<<=1,!(ju&130023424)&&(ju=4194304)):e=1);var r=jr();t=Ws(t,e),t!==null&&(nu(t,e,r),Zr(t,r))}function lN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),b2(t,r)}function cN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(e),b2(t,r)}var F2;F2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qr.current)Yr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Yr=!1,Y4(t,e,r);Yr=!!(t.flags&131072)}else Yr=!1,yt&&e.flags&1048576&&Vw(e,rh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;kf(t,e),t=e.pendingProps;var s=$o(e,Rr.current);Po(e,r),s=tg(null,e,n,t,s,r);var a=rg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jr(n)?(a=!0,eh(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ym(e),s.updater=r0,e.stateNode=s,s._reactInternals=e,wp(e,n,t,r),e=Sp(null,e,n,!0,a,r)):(e.tag=0,yt&&a&&zm(e),Mr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(kf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=fN(n),t=Un(n,t),s){case 0:e=Ap(null,e,n,t,r);break e;case 1:e=mv(null,e,n,t,r);break e;case 11:e=dv(null,e,n,t,r);break e;case 14:e=pv(null,e,n,Un(n.type,t),r);break e}throw Error(le(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Un(n,s),Ap(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Un(n,s),mv(t,e,n,s,r);case 3:e:{if(x2(e),t===null)throw Error(le(387));n=e.pendingProps,a=e.memoizedState,s=a.element,Hw(t,e),ah(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Go(Error(le(423)),e),e=gv(t,e,n,r,s);break e}else if(n!==s){s=Go(Error(le(424)),e),e=gv(t,e,n,r,s);break e}else for(ln=Ia(e.stateNode.containerInfo.firstChild),un=e,yt=!0,zn=null,r=$w(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zo(),n===s){e=Gs(t,e,r);break e}Mr(t,e,n,r)}e=e.child}return e;case 5:return Ww(e),t===null&&yp(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,pp(n,s)?i=null:a!==null&&pp(n,a)&&(e.flags|=32),g2(t,e),Mr(t,e,i,r),e.child;case 6:return t===null&&yp(e),null;case 13:return v2(t,e,r);case 4:return Qm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ho(e,null,n,r):Mr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Un(n,s),dv(t,e,n,s,r);case 7:return Mr(t,e,e.pendingProps,r),e.child;case 8:return Mr(t,e,e.pendingProps.children,r),e.child;case 12:return Mr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,ot(nh,n._currentValue),n._currentValue=i,a!==null)if(Qn(a.value,i)){if(a.children===s.children&&!Qr.current){e=Gs(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Vs(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),_p(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(le(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),_p(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Mr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Po(e,r),s=Cn(s),n=n(s),e.flags|=1,Mr(t,e,n,r),e.child;case 14:return n=e.type,s=Un(n,e.pendingProps),s=Un(n.type,s),pv(t,e,n,s,r);case 15:return p2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Un(n,s),kf(t,e),e.tag=1,Jr(n)?(t=!0,eh(e)):t=!1,Po(e,r),f2(e,n,s),wp(e,n,s,r),Sp(null,e,n,!0,t,r);case 19:return y2(t,e,r);case 22:return m2(t,e,r)}throw Error(le(156,e.tag))};function O2(t,e){return lw(t,e)}function uN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function An(t,e,r,n){return new uN(t,e,r,n)}function hg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fN(t){if(typeof t=="function")return hg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pm)return 11;if(t===Dm)return 14}return 2}function Pa(t,e){var r=t.alternate;return r===null?(r=An(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Nf(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")hg(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case po:return yi(r.children,s,a,e);case Rm:i=8,s|=8;break;case Gd:return t=An(12,r,e,s|2),t.elementType=Gd,t.lanes=a,t;case qd:return t=An(13,r,e,s),t.elementType=qd,t.lanes=a,t;case Kd:return t=An(19,r,e,s),t.elementType=Kd,t.lanes=a,t;case WE:return a0(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zE:i=10;break e;case HE:i=9;break e;case Pm:i=11;break e;case Dm:i=14;break e;case ua:i=16,n=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=An(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function yi(t,e,r,n){return t=An(7,t,n,e),t.lanes=r,t}function a0(t,e,r,n){return t=An(22,t,n,e),t.elementType=WE,t.lanes=r,t.stateNode={isHidden:!1},t}function gd(t,e,r){return t=An(6,t,null,e),t.lanes=r,t}function xd(t,e,r){return e=An(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hN(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q0(0),this.expirationTimes=Q0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function dg(t,e,r,n,s,a,i,o,l){return t=new hN(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=An(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ym(a),t}function dN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ho,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function L2(t){if(!t)return Ua;t=t._reactInternals;e:{if(Vi(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var r=t.type;if(Jr(r))return Lw(t,r,e)}return e}function M2(t,e,r,n,s,a,i,o,l){return t=dg(r,n,!0,t,s,a,i,o,l),t.context=L2(null),r=t.current,n=jr(),s=Ra(r),a=Vs(n,s),a.callback=e??null,Ca(r,a,s),t.current.lanes=s,nu(t,s,n),Zr(t,n),t}function i0(t,e,r,n){var s=e.current,a=jr(),i=Ra(s);return r=L2(r),e.context===null?e.context=r:e.pendingContext=r,e=Vs(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ca(s,e,i),t!==null&&(Xn(t,s,i,a),Tf(t,s,i)),i}function dh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function pg(t,e){kv(t,e),(t=t.alternate)&&kv(t,e)}function pN(){return null}var V2=typeof reportError=="function"?reportError:function(t){console.error(t)};function mg(t){this._internalRoot=t}o0.prototype.render=mg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));i0(t,e,null,null)};o0.prototype.unmount=mg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ii(function(){i0(null,t,null,null)}),e[Hs]=null}};function o0(t){this._internalRoot=t}o0.prototype.unstable_scheduleHydration=function(t){if(t){var e=mw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ha.length&&e!==0&&e<ha[r].priority;r++);ha.splice(r,0,t),r===0&&xw(t)}};function gg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Iv(){}function mN(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=dh(i);a.call(c)}}var i=M2(e,n,t,0,null,!1,!1,"",Iv);return t._reactRootContainer=i,t[Hs]=i.current,Nc(t.nodeType===8?t.parentNode:t),Ii(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=dh(l);o.call(c)}}var l=dg(t,0,!1,null,null,!1,!1,"",Iv);return t._reactRootContainer=l,t[Hs]=l.current,Nc(t.nodeType===8?t.parentNode:t),Ii(function(){i0(e,l,r,n)}),l}function c0(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=dh(i);o.call(l)}}i0(e,i,t,s)}else i=mN(r,e,t,s,n);return dh(i)}dw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ll(e.pendingLanes);r!==0&&(Om(e,r|1),Zr(e,bt()),!(Ye&6)&&(qo=bt()+500,Qa()))}break;case 13:Ii(function(){var n=Ws(t,1);if(n!==null){var s=jr();Xn(n,t,1,s)}}),pg(t,1)}};Lm=function(t){if(t.tag===13){var e=Ws(t,134217728);if(e!==null){var r=jr();Xn(e,t,134217728,r)}pg(t,134217728)}};pw=function(t){if(t.tag===13){var e=Ra(t),r=Ws(t,e);if(r!==null){var n=jr();Xn(r,t,e,n)}pg(t,e)}};mw=function(){return nt};gw=function(t,e){var r=nt;try{return nt=t,e()}finally{nt=r}};sp=function(t,e,r){switch(e){case"input":if(Qd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Zh(n);if(!s)throw Error(le(90));qE(n),Qd(n,s)}}}break;case"textarea":XE(t,r);break;case"select":e=r.value,e!=null&&Io(t,!!r.multiple,e,!1)}};rw=cg;nw=Ii;var gN={usingClientEntryPoint:!1,Events:[au,vo,Zh,ew,tw,cg]},bl={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xN={bundleType:bl.bundleType,version:bl.version,rendererPackageName:bl.rendererPackageName,rendererConfig:bl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Js.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=iw(t),t===null?null:t.stateNode},findFiberByHostInstance:bl.findFiberByHostInstance||pN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ju=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ju.isDisabled&&Ju.supportsFiber)try{Xh=Ju.inject(xN),ds=Ju}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gN;pn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gg(e))throw Error(le(200));return dN(t,e,null,r)};pn.createRoot=function(t,e){if(!gg(t))throw Error(le(299));var r=!1,n="",s=V2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=dg(t,1,!1,null,null,r,!1,n,s),t[Hs]=e.current,Nc(t.nodeType===8?t.parentNode:t),new mg(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=iw(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return Ii(t)};pn.hydrate=function(t,e,r){if(!l0(e))throw Error(le(200));return c0(null,t,e,!0,r)};pn.hydrateRoot=function(t,e,r){if(!gg(t))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=V2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=M2(e,null,t,1,r??null,s,!1,a,i),t[Hs]=e.current,Nc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new o0(e)};pn.render=function(t,e,r){if(!l0(e))throw Error(le(200));return c0(null,t,e,!1,r)};pn.unmountComponentAtNode=function(t){if(!l0(t))throw Error(le(40));return t._reactRootContainer?(Ii(function(){c0(null,null,t,!1,function(){t._reactRootContainer=null,t[Hs]=null})}),!0):!1};pn.unstable_batchedUpdates=cg;pn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!l0(r))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return c0(t,e,r,!1,n)};pn.version="18.3.1-next-f1338f8080-20240426";function U2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U2)}catch(t){console.error(t)}}U2(),UE.exports=pn;var vN=UE.exports,Cv=vN;Hd.createRoot=Cv.createRoot,Hd.hydrateRoot=Cv.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_N=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),Nv=t=>{const e=_N(t);return e.charAt(0).toUpperCase()+e.slice(1)},B2=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),EN=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=je.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>je.createElement("svg",{ref:l,...wN,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:B2("lucide",s),...!a&&!EN(o)&&{"aria-hidden":"true"},...o},[...i.map(([c,f])=>je.createElement(c,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=(t,e)=>{const r=je.forwardRef(({className:n,...s},a)=>je.createElement(TN,{ref:a,iconNode:e,className:B2(`lucide-${yN(Nv(t))}`,`lucide-${t}`,n),...s}));return r.displayName=Nv(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Rf=Rt("chart-column",AN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Vl=Rt("circle-alert",SN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],IN=Rt("circle-check-big",kN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pf=Rt("clock",CN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],RN=Rt("eye-off",NN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],DN=Rt("eye",PN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],sc=Rt("file-spreadsheet",bN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ON=Rt("funnel",FN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Rv=Rt("lock",LN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],VN=Rt("log-out",MN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],BN=Rt("mail",UN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Bn=Rt("phone",jN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],zN=Rt("save",$N);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Zu=Rt("search",HN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Pv=Rt("trash-2",WN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],qN=Rt("trending-down",GN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],j2=Rt("trending-up",KN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Dv=Rt("upload",XN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],bv=Rt("user-plus",YN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xg=Rt("user",QN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jn=Rt("users",JN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fv=Rt("x",ZN);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $2=1252,eR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yg=function(t){eR.indexOf(t)!=-1&&($2=vg[0]=t)};function tR(){yg(1252)}var Wn=function(t){yg(t)};function z2(){Wn(1200),tR()}function Ov(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function rR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function H2(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ul=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?rR(t.slice(2)):e==254&&r==255?H2(t.slice(2)):e==65279?t.slice(1):t},ef=function(e){return String.fromCharCode(e)},Lv=function(e){return String.fromCharCode(e)},Vc,Ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mv(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),a=r>>2,n=t.charCodeAt(c++),i=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ea.charAt(a)+Ea.charAt(i)+Ea.charAt(o)+Ea.charAt(l);return e}function dn(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ea.indexOf(t.charAt(c++)),i=Ea.indexOf(t.charAt(c++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Ea.indexOf(t.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ea.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ui=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ba(t){return Ge?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Vv(t){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Hn=function(e){return Ge?Ui(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Bi(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function _g(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return _g(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var pa=Ge?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ui(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function nR(t){for(var e=[],r=0,n=t.length+250,s=Ba(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Ba(65535),n=65530)}return e.push(s.slice(0,r)),pa(e)}var $r=/\u0000/g,Bl=/[\u0001-\u0006]/g;function bo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Gn(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}function Eg(t,e){var r=""+t;return r.length>=e?r:Ct(" ",e-r.length)+r}function ph(t,e){var r=""+t;return r.length>=e?r:r+Ct(" ",e-r.length)}function sR(t,e){var r=""+Math.round(t);return r.length>=e?r:Ct("0",e-r.length)+r}function aR(t,e){var r=""+t;return r.length>=e?r:Ct("0",e-r.length)+r}var Uv=Math.pow(2,32);function io(t,e){if(t>Uv||t<-Uv)return sR(t,e);var r=Math.round(t);return aR(r,e)}function mh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Bv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ue={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},jv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gh(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,c=0,f=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*i+a,f=h*c+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=a):(f=c,o=i)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function mi(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=dR(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var W2=new Date(1899,11,31,0,0,0),lR=W2.getTime(),cR=new Date(1900,2,1,0,0,0);function G2(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=cR&&(r+=24*60*60*1e3),(r-(lR+(t.getTimezoneOffset()-W2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function wg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function uR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fR(t){var e=t<0?12:11,r=wg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function hR(t){var e=wg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Uc(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=fR(t):e===10?r=t.toFixed(10).substr(0,12):r=hR(t),wg(uR(r.toUpperCase()))}function Ci(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Uc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Rn(14,G2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function dR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function pR(t,e,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return vd[r.m-1][1];case 5:return vd[r.m-1][0];default:return vd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Bv[r.q][0];default:return Bv[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Gn(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Gn(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Gn(l,c):"";return f}function wa(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var q2=/%/g;function mR(t,e,r){var n=e.replace(q2,""),s=e.length-n.length;return Us(t,n,r*Math.pow(10,2*s))+Ct("%",s)}function gR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Us(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function K2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+K2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var X2=/# (\?+)( ?)\/( ?)(\d+)/;function xR(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ct(" ",t[1].length+1+t[4].length):Eg(i,t[1].length)+t[2]+"/"+t[3]+Gn(o,t[4].length))}function vR(t,e,r){return r+(e===0?"":""+e)+Ct(" ",t[1].length+2+t[4].length)}var Y2=/^#*0*\.([0#]+)/,Q2=/\).*[0#]/,J2=/\(###\) ###\\?-####/;function Vr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function $v(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function zv(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function yR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function _R(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function vn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return gR(t,e,r);if(e.indexOf("%")!==-1)return mR(t,e,r);if(e.indexOf("E")!==-1)return K2(e,r);if(e.charCodeAt(0)===36)return"$"+vn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+io(l,e.length);if(e.match(/^[#?]+$/))return s=io(r,0),s==="0"&&(s=""),s.length>e.length?s:Vr(e.substr(0,e.length-s.length))+s;if(a=e.match(X2))return xR(a,l,c);if(e.match(/^#+0+$/))return c+io(l,e.length-e.indexOf("0"));if(a=e.match(Y2))return s=$v(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Vr(a[1])).replace(/\.$/,"."+Vr(a[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Ct("0",Vr(a[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+$v(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+wa(io(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(t,e,-r):wa(""+(Math.floor(r)+yR(r,a[1].length)))+"."+Gn(zv(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return vn(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=bo(vn(t,e.replace(/[\\-]/g,""),r)),i=0,bo(bo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(e.match(J2))return s=vn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=gh(l,Math.pow(10,i)-1,!1),s=""+c,f=Us("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ph(o[2],i),f.length<a[4].length&&(f=Vr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=gh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+ph(o[2],i):Ct(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=io(r,0),e.length<=s.length?s:Vr(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,d=e.length-s.length-h;return Vr(e.substr(0,h)+s+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=zv(r,a[1].length),r<0?"-"+vn(t,e,-r):wa(_R(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Gn(0,3-v.length):"")+v})+"."+Gn(i,a[1].length);switch(e){case"###,##0.00":return vn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=wa(io(l,0));return p!=="0"?c+p:"";case"###,###.00":return vn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function ER(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Us(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function wR(t,e,r){var n=e.replace(q2,""),s=e.length-n.length;return Us(t,n,r*Math.pow(10,2*s))+Ct("%",s)}function Z2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Z2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function is(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?is("n",n,r):"("+is("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ER(t,e,r);if(e.indexOf("%")!==-1)return wR(t,e,r);if(e.indexOf("E")!==-1)return Z2(e,r);if(e.charCodeAt(0)===36)return"$"+is(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Gn(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Vr(e.substr(0,e.length-s.length))+s;if(a=e.match(X2))return vR(a,l,c);if(e.match(/^#+0+$/))return c+Gn(l,e.length-e.indexOf("0"));if(a=e.match(Y2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Vr(a[1])).replace(/\.$/,"."+Vr(a[1])),s=s.replace(/\.(\d*)$/,function(v,x){return"."+x+Ct("0",Vr(a[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+wa(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+is(t,e,-r):wa(""+r)+"."+Ct("0",a[1].length);if(a=e.match(/^#,#*,#0/))return is(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=bo(is(t,e.replace(/[\\-]/g,""),r)),i=0,bo(bo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(e.match(J2))return s=is(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=gh(l,Math.pow(10,i)-1,!1),s=""+c,f=Us("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ph(o[2],i),f.length<a[4].length&&(f=Vr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=gh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+ph(o[2],i):Ct(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Vr(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,d=e.length-s.length-h;return Vr(e.substr(0,h)+s+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+is(t,e,-r):wa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Gn(0,3-v.length):"")+v})+"."+Gn(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=wa(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return is(t,e.slice(0,e.lastIndexOf(".")),r)+Vr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Us(t,e,r){return(r|0)===r?is(t,e,r):vn(t,e,r)}function TR(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var eT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function il(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":mh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(eT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function AR(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",c,f,h,d="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!mh(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=t.charAt(++i),v=p==="("||p===")"?p:"t";s[s.length]={t:v,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(c==null&&(c=mi(e,r,t.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=mi(e,r),c==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=mi(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",d="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",i+=5,d="h"):t.substr(i,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",i+=5,d="h"):(x.t="t",++i),c==null&&x.t==="T")return"";s[s.length]=x,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(eT)){if(c==null&&(c=mi(e,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",il(t)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var E=0,A=0,_;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=d,l="h",E<1&&(E=1);break;case"s":(_=s[i].v.match(/\.0+$/))&&(A=Math.max(A,_[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[i].v.match(/[Hh]/)&&(E=1),E<2&&s[i].v.match(/[Mm]/)&&(E=2),E<3&&s[i].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",M;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=pR(s[i].t.charCodeAt(0),s[i].v,c,A),s[i].t="t";break;case"n":case"?":for(M=i+1;s[M]!=null&&((o=s[M].t)==="?"||o==="D"||(o===" "||o==="t")&&s[M+1]!=null&&(s[M+1].t==="?"||s[M+1].t==="t"&&s[M+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[M].v==="/"||s[M].v===" "&&s[M+1]!=null&&s[M+1].t=="?"));)s[i].v+=s[M].v,s[M]={v:"",t:";"},++M;y+=s[i].v,i=M-1;break;case"G":s[i].t="t",s[i].v=Ci(e,r);break}var z="",B,w;if(y.length>0){y.charCodeAt(0)==40?(B=e<0&&y.charCodeAt(0)===45?-e:e,w=Us("n",y,B)):(B=e<0&&n>1?-e:e,w=Us("n",y,B),B<0&&s[0]&&s[0].t=="t"&&(w=w.substr(1),s[0].v="-"+s[0].v)),M=w.length-1;var k=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){k=i;break}var I=s.length;if(k===s.length&&w.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(M>=s[i].v.length-1?(M-=s[i].v.length,s[i].v=w.substr(M+1,s[i].v.length)):M<0?s[i].v="":(s[i].v=w.substr(0,M+1),M=-1),s[i].t="t",I=i);M>=0&&I<s.length&&(s[I].v=w.substr(0,M+1)+s[I].v)}else if(k!==s.length&&w.indexOf("E")===-1){for(M=w.indexOf(".")-1,i=k;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===k?s[i].v.indexOf(".")-1:s[i].v.length-1,z=s[i].v.substr(f+1);f>=0;--f)M>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(z=w.charAt(M--)+z);s[i].v=z,s[i].t="t",I=i}for(M>=0&&I<s.length&&(s[I].v=w.substr(0,M+1)+s[I].v),M=w.indexOf(".")+1,i=k;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==k)){for(f=s[i].v.indexOf(".")>-1&&i===k?s[i].v.indexOf(".")+1:0,z=s[i].v.substr(0,f);f<s[i].v.length;++f)M<w.length&&(z+=w.charAt(M++));s[i].v=z,s[i].t="t",I=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(B=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Us(s[i].t,s[i].v,B),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var Hv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Wv(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function SR(t,e){var r=TR(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Hv),o=r[1].match(Hv);return Wv(e,i)?[n,r[0]]:Wv(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Rn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ue)[t],n==null&&(n=r.table&&r.table[jv[t]]||Ue[jv[t]]),n==null&&(n=oR[t]||"General");break}if(mh(n,0))return Ci(e,r);e instanceof Date&&(e=G2(e,r.date1904));var s=SR(n,e);if(mh(s[1]))return Ci(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return AR(s[1],e,r,s[0])}function _i(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ue[r]==null){e<0&&(e=r);continue}if(Ue[r]==t){e=r;break}}e<0&&(e=391)}return Ue[e]=t,e}function tT(){Ue=iR()}var kR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function IR(t){var e=typeof t=="number"?Ue[t]:t;return e=e.replace(rT,"(\\d+)"),new RegExp("^"+e+"$")}function CR(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(rT)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?f:c+"T"+f}var NR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,k=new Array(256),I=0;I!=256;++I)w=I,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,k[I]=w;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(w){var k=0,I=0,R=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)F[R]=w[R];for(R=0;R!=256;++R)for(I=w[R],k=256+R;k<4096;k+=256)I=F[k]=I>>>8^w[I&255];var O=[];for(R=1;R!=16;++R)O[R-1]=typeof Int32Array<"u"?F.subarray(R*256,R*256+256):F.slice(R*256,R*256+256);return O}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],f=s[5],h=s[6],d=s[7],p=s[8],v=s[9],x=s[10],E=s[11],A=s[12],_=s[13],y=s[14];function M(w,k){for(var I=k^-1,R=0,F=w.length;R<F;)I=I>>>8^r[(I^w.charCodeAt(R++))&255];return~I}function z(w,k){for(var I=k^-1,R=w.length-15,F=0;F<R;)I=y[w[F++]^I&255]^_[w[F++]^I>>8&255]^A[w[F++]^I>>16&255]^E[w[F++]^I>>>24]^x[w[F++]]^v[w[F++]]^p[w[F++]]^d[w[F++]]^h[w[F++]]^f[w[F++]]^c[w[F++]]^l[w[F++]]^o[w[F++]]^i[w[F++]]^a[w[F++]]^r[w[F++]];for(R+=15;F<R;)I=I>>>8^r[(I^w[F++])&255];return~I}function B(w,k){for(var I=k^-1,R=0,F=w.length,O=0,L=0;R<F;)O=w.charCodeAt(R++),O<128?I=I>>>8^r[(I^O)&255]:O<2048?(I=I>>>8^r[(I^(192|O>>6&31))&255],I=I>>>8^r[(I^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,L=w.charCodeAt(R++)&1023,I=I>>>8^r[(I^(240|O>>8&7))&255],I=I>>>8^r[(I^(128|O>>2&63))&255],I=I>>>8^r[(I^(128|L>>6&15|(O&3)<<4))&255],I=I>>>8^r[(I^(128|L&63))&255]):(I=I>>>8^r[(I^(224|O>>12&15))&255],I=I>>>8^r[(I^(128|O>>6&63))&255],I=I>>>8^r[(I^(128|O&63))&255]);return~I}return t.table=r,t.bstr=M,t.buf=z,t.str=B,t}(),Ke=function(){var e={};e.version="1.2.1";function r(T,P){for(var N=T.split("/"),C=P.split("/"),b=0,D=0,W=Math.min(N.length,C.length);b<W;++b){if(D=N[b].length-C[b].length)return D;if(N[b]!=C[b])return N[b]<C[b]?-1:1}return N.length-C.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var P=T.lastIndexOf("/");return P===-1?T:T.slice(0,P+1)}function s(T){if(T.charAt(T.length-1)=="/")return s(T.slice(0,-1));var P=T.lastIndexOf("/");return P===-1?T:T.slice(P+1)}function a(T,P){typeof P=="string"&&(P=new Date(P));var N=P.getHours();N=N<<6|P.getMinutes(),N=N<<5|P.getSeconds()>>>1,T.write_shift(2,N);var C=P.getFullYear()-1980;C=C<<4|P.getMonth()+1,C=C<<5|P.getDate(),T.write_shift(2,C)}function i(T){var P=T.read_shift(2)&65535,N=T.read_shift(2)&65535,C=new Date,b=N&31;N>>>=5;var D=N&15;N>>>=4,C.setMilliseconds(0),C.setFullYear(N+1980),C.setMonth(D-1),C.setDate(b);var W=P&31;P>>>=5;var K=P&63;return P>>>=6,C.setHours(P),C.setMinutes(K),C.setSeconds(W<<1),C}function o(T){ur(T,0);for(var P={},N=0;T.l<=T.length-4;){var C=T.read_shift(2),b=T.read_shift(2),D=T.l+b,W={};switch(C){case 21589:N=T.read_shift(1),N&1&&(W.mtime=T.read_shift(4)),b>5&&(N&2&&(W.atime=T.read_shift(4)),N&4&&(W.ctime=T.read_shift(4))),W.mtime&&(W.mt=new Date(W.mtime*1e3));break}T.l=D,P[C]=W}return P}var l;function c(){return l||(l={})}function f(T,P){if(T[0]==80&&T[1]==75)return ni(T,P);if((T[0]|32)==109&&(T[1]|32)==105)return eo(T,P);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var N=3,C=512,b=0,D=0,W=0,K=0,Y=0,Q=[],Z=T.slice(0,512);ur(Z,0);var ae=h(Z);switch(N=ae[0],N){case 3:C=512;break;case 4:C=4096;break;case 0:if(ae[1]==0)return ni(T,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}C!==512&&(Z=T.slice(0,C),ur(Z,28));var fe=T.slice(0,C);d(Z,N);var we=Z.read_shift(4,"i");if(N===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);Z.l+=4,W=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),K=Z.read_shift(4,"i"),b=Z.read_shift(4,"i"),Y=Z.read_shift(4,"i"),D=Z.read_shift(4,"i");for(var ce=-1,_e=0;_e<109&&(ce=Z.read_shift(4,"i"),!(ce<0));++_e)Q[_e]=ce;var be=p(T,C);E(Y,D,be,C,Q);var st=_(be,W,Q,C);st[W].name="!Directory",b>0&&K!==L&&(st[K].name="!MiniFAT"),st[Q[0]].name="!FAT",st.fat_addrs=Q,st.ssz=C;var rt={},xt=[],Cs=[],ai=[];y(W,st,be,xt,b,rt,Cs,K),v(Cs,ai,xt),xt.shift();var sa={FileIndex:Cs,FullPaths:ai};return P&&P.raw&&(sa.raw={header:fe,sectors:be}),sa}function h(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(ye,"Header Signature: "),T.l+=16;var P=T.read_shift(2,"u");return[T.read_shift(2,"u"),P]}function d(T,P){var N=9;switch(T.l+=2,N=T.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function p(T,P){for(var N=Math.ceil(T.length/P)-1,C=[],b=1;b<N;++b)C[b-1]=T.slice(b*P,(b+1)*P);return C[N-1]=T.slice(N*P),C}function v(T,P,N){for(var C=0,b=0,D=0,W=0,K=0,Y=N.length,Q=[],Z=[];C<Y;++C)Q[C]=Z[C]=C,P[C]=N[C];for(;K<Z.length;++K)C=Z[K],b=T[C].L,D=T[C].R,W=T[C].C,Q[C]===C&&(b!==-1&&Q[b]!==b&&(Q[C]=Q[b]),D!==-1&&Q[D]!==D&&(Q[C]=Q[D])),W!==-1&&(Q[W]=C),b!==-1&&C!=Q[C]&&(Q[b]=Q[C],Z.lastIndexOf(b)<K&&Z.push(b)),D!==-1&&C!=Q[C]&&(Q[D]=Q[C],Z.lastIndexOf(D)<K&&Z.push(D));for(C=1;C<Y;++C)Q[C]===C&&(D!==-1&&Q[D]!==D?Q[C]=Q[D]:b!==-1&&Q[b]!==b&&(Q[C]=Q[b]));for(C=1;C<Y;++C)if(T[C].type!==0){if(K=C,K!=Q[K])do K=Q[K],P[C]=P[K]+"/"+P[C];while(K!==0&&Q[K]!==-1&&K!=Q[K]);Q[C]=-1}for(P[0]+="/",C=1;C<Y;++C)T[C].type!==2&&(P[C]+="/")}function x(T,P,N){for(var C=T.start,b=T.size,D=[],W=C;N&&b>0&&W>=0;)D.push(P.slice(W*O,W*O+O)),b-=O,W=fi(N,W*4);return D.length===0?Gt(0):pa(D).slice(0,T.size)}function E(T,P,N,C,b){var D=L;if(T===L){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var W=N[T],K=(C>>>2)-1;if(!W)return;for(var Y=0;Y<K&&(D=fi(W,Y*4))!==L;++Y)b.push(D);E(fi(W,C-4),P-1,N,C,b)}}function A(T,P,N,C,b){var D=[],W=[];b||(b=[]);var K=C-1,Y=0,Q=0;for(Y=P;Y>=0;){b[Y]=!0,D[D.length]=Y,W.push(T[Y]);var Z=N[Math.floor(Y*4/C)];if(Q=Y*4&K,C<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+C);if(!T[Z])break;Y=fi(T[Z],Q)}return{nodes:D,data:ty([W])}}function _(T,P,N,C){var b=T.length,D=[],W=[],K=[],Y=[],Q=C-1,Z=0,ae=0,fe=0,we=0;for(Z=0;Z<b;++Z)if(K=[],fe=Z+P,fe>=b&&(fe-=b),!W[fe]){Y=[];var ce=[];for(ae=fe;ae>=0;){ce[ae]=!0,W[ae]=!0,K[K.length]=ae,Y.push(T[ae]);var _e=N[Math.floor(ae*4/C)];if(we=ae*4&Q,C<4+we)throw new Error("FAT boundary crossed: "+ae+" 4 "+C);if(!T[_e]||(ae=fi(T[_e],we),ce[ae]))break}D[fe]={nodes:K,data:ty([Y])}}return D}function y(T,P,N,C,b,D,W,K){for(var Y=0,Q=C.length?2:0,Z=P[T].data,ae=0,fe=0,we;ae<Z.length;ae+=128){var ce=Z.slice(ae,ae+128);ur(ce,64),fe=ce.read_shift(2),we=Ig(ce,0,fe-Q),C.push(we);var _e={name:we,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},be=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);be!==0&&(_e.ct=M(ce,ce.l-8));var st=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);st!==0&&(_e.mt=M(ce,ce.l-8)),_e.start=ce.read_shift(4,"i"),_e.size=ce.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=L,_e.name=""),_e.type===5?(Y=_e.start,b>0&&Y!==L&&(P[Y].name="!StreamData")):_e.size>=4096?(_e.storage="fat",P[_e.start]===void 0&&(P[_e.start]=A(N,_e.start,P.fat_addrs,P.ssz)),P[_e.start].name=_e.name,_e.content=P[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:Y!==L&&_e.start!==L&&P[Y]&&(_e.content=x(_e,P[Y].data,(P[K]||{}).data))),_e.content&&ur(_e.content,0),D[we]=_e,W.push(_e)}}function M(T,P){return new Date((an(T,P+4)/1e7*Math.pow(2,32)+an(T,P)/1e7-11644473600)*1e3)}function z(T,P){return c(),f(l.readFileSync(T),P)}function B(T,P){var N=P&&P.type;switch(N||Ge&&Buffer.isBuffer(T)&&(N="buffer"),N||"base64"){case"file":return z(T,P);case"base64":return f(Hn(dn(T)),P);case"binary":return f(Hn(T),P)}return f(T,P)}function w(T,P){var N=P||{},C=N.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=C+"/",T.FileIndex[0]={name:C,type:5}),N.CLSID&&(T.FileIndex[0].clsid=N.CLSID),k(T)}function k(T){var P="Sh33tJ5";if(!Ke.find(T,"/"+P)){var N=Gt(4);N[0]=55,N[1]=N[3]=50,N[2]=54,T.FileIndex.push({name:P,type:2,content:N,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+P),I(T)}}function I(T,P){w(T);for(var N=!1,C=!1,b=T.FullPaths.length-1;b>=0;--b){var D=T.FileIndex[b];switch(D.type){case 0:C?N=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(D.R*D.L*D.C)&&(N=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!P)){var W=new Date(1987,1,19),K=0,Y=Object.create?Object.create(null):{},Q=[];for(b=0;b<T.FullPaths.length;++b)Y[T.FullPaths[b]]=!0,T.FileIndex[b].type!==0&&Q.push([T.FullPaths[b],T.FileIndex[b]]);for(b=0;b<Q.length;++b){var Z=n(Q[b][0]);C=Y[Z],C||(Q.push([Z,{name:s(Z).replace("/",""),type:1,clsid:Ae,ct:W,mt:W,content:null}]),Y[Z]=!0)}for(Q.sort(function(we,ce){return r(we[0],ce[0])}),T.FullPaths=[],T.FileIndex=[],b=0;b<Q.length;++b)T.FullPaths[b]=Q[b][0],T.FileIndex[b]=Q[b][1];for(b=0;b<Q.length;++b){var ae=T.FileIndex[b],fe=T.FullPaths[b];if(ae.name=s(fe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Ae,b===0)ae.C=Q.length>1?1:-1,ae.size=0,ae.type=5;else if(fe.slice(-1)=="/"){for(K=b+1;K<Q.length&&n(T.FullPaths[K])!=fe;++K);for(ae.C=K>=Q.length?-1:K,K=b+1;K<Q.length&&n(T.FullPaths[K])!=n(fe);++K);ae.R=K>=Q.length?-1:K,ae.type=1}else n(T.FullPaths[b+1]||"")==n(fe)&&(ae.R=b+1),ae.type=2}}}function R(T,P){var N=P||{};if(N.fileType=="mad")return Wt(T,N);switch(I(T),N.fileType){case"zip":return Ji(T,N)}var C=function(we){for(var ce=0,_e=0,be=0;be<we.FileIndex.length;++be){var st=we.FileIndex[be];if(st.content){var rt=st.content.length;rt>0&&(rt<4096?ce+=rt+63>>6:_e+=rt+511>>9)}}for(var xt=we.FullPaths.length+3>>2,Cs=ce+7>>3,ai=ce+127>>7,sa=Cs+_e+xt+ai,ns=sa+127>>7,to=ns<=109?0:Math.ceil((ns-109)/127);sa+ns+to+127>>7>ns;)to=++ns<=109?0:Math.ceil((ns-109)/127);var rn=[1,to,ns,ai,xt,_e,ce,0];return we.FileIndex[0].size=ce<<6,rn[7]=(we.FileIndex[0].start=rn[0]+rn[1]+rn[2]+rn[3]+rn[4]+rn[5])+(rn[6]+7>>3),rn}(T),b=Gt(C[7]<<9),D=0,W=0;{for(D=0;D<8;++D)b.write_shift(1,de[D]);for(D=0;D<8;++D)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),D=0;D<3;++D)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,C[2]),b.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:L),b.write_shift(4,C[3]),b.write_shift(-4,C[1]?C[0]-1:L),b.write_shift(4,C[1]),D=0;D<109;++D)b.write_shift(-4,D<C[2]?C[1]+D:-1)}if(C[1])for(W=0;W<C[1];++W){for(;D<236+W*127;++D)b.write_shift(-4,D<C[2]?C[1]+D:-1);b.write_shift(-4,W===C[1]-1?L:W+1)}var K=function(we){for(W+=we;D<W-1;++D)b.write_shift(-4,D+1);we&&(++D,b.write_shift(-4,L))};for(W=D=0,W+=C[1];D<W;++D)b.write_shift(-4,ve.DIFSECT);for(W+=C[2];D<W;++D)b.write_shift(-4,ve.FATSECT);K(C[3]),K(C[4]);for(var Y=0,Q=0,Z=T.FileIndex[0];Y<T.FileIndex.length;++Y)Z=T.FileIndex[Y],Z.content&&(Q=Z.content.length,!(Q<4096)&&(Z.start=W,K(Q+511>>9)));for(K(C[6]+7>>3);b.l&511;)b.write_shift(-4,ve.ENDOFCHAIN);for(W=D=0,Y=0;Y<T.FileIndex.length;++Y)Z=T.FileIndex[Y],Z.content&&(Q=Z.content.length,!(!Q||Q>=4096)&&(Z.start=W,K(Q+63>>6)));for(;b.l&511;)b.write_shift(-4,ve.ENDOFCHAIN);for(D=0;D<C[4]<<2;++D){var ae=T.FullPaths[D];if(!ae||ae.length===0){for(Y=0;Y<17;++Y)b.write_shift(4,0);for(Y=0;Y<3;++Y)b.write_shift(4,-1);for(Y=0;Y<12;++Y)b.write_shift(4,0);continue}Z=T.FileIndex[D],D===0&&(Z.start=Z.size?Z.start-1:L);var fe=D===0&&N.root||Z.name;if(Q=2*(fe.length+1),b.write_shift(64,fe,"utf16le"),b.write_shift(2,Q),b.write_shift(1,Z.type),b.write_shift(1,Z.color),b.write_shift(-4,Z.L),b.write_shift(-4,Z.R),b.write_shift(-4,Z.C),Z.clsid)b.write_shift(16,Z.clsid,"hex");else for(Y=0;Y<4;++Y)b.write_shift(4,0);b.write_shift(4,Z.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,Z.start),b.write_shift(4,Z.size),b.write_shift(4,0)}for(D=1;D<T.FileIndex.length;++D)if(Z=T.FileIndex[D],Z.size>=4096)if(b.l=Z.start+1<<9,Ge&&Buffer.isBuffer(Z.content))Z.content.copy(b,b.l,0,Z.size),b.l+=Z.size+511&-512;else{for(Y=0;Y<Z.size;++Y)b.write_shift(1,Z.content[Y]);for(;Y&511;++Y)b.write_shift(1,0)}for(D=1;D<T.FileIndex.length;++D)if(Z=T.FileIndex[D],Z.size>0&&Z.size<4096)if(Ge&&Buffer.isBuffer(Z.content))Z.content.copy(b,b.l,0,Z.size),b.l+=Z.size+63&-64;else{for(Y=0;Y<Z.size;++Y)b.write_shift(1,Z.content[Y]);for(;Y&63;++Y)b.write_shift(1,0)}if(Ge)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function F(T,P){var N=T.FullPaths.map(function(Y){return Y.toUpperCase()}),C=N.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),b=!1;P.charCodeAt(0)===47?(b=!0,P=N[0].slice(0,-1)+P):b=P.indexOf("/")!==-1;var D=P.toUpperCase(),W=b===!0?N.indexOf(D):C.indexOf(D);if(W!==-1)return T.FileIndex[W];var K=!D.match(Bl);for(D=D.replace($r,""),K&&(D=D.replace(Bl,"!")),W=0;W<N.length;++W)if((K?N[W].replace(Bl,"!"):N[W]).replace($r,"")==D||(K?C[W].replace(Bl,"!"):C[W]).replace($r,"")==D)return T.FileIndex[W];return null}var O=64,L=-2,ye="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(T,P,N){c();var C=R(T,N);l.writeFileSync(P,C)}function q(T){for(var P=new Array(T.length),N=0;N<T.length;++N)P[N]=String.fromCharCode(T[N]);return P.join("")}function ue(T,P){var N=R(T,P);switch(P&&P.type||"buffer"){case"file":return c(),l.writeFileSync(P.filename,N),N;case"binary":return typeof N=="string"?N:q(N);case"base64":return Mv(typeof N=="string"?N:q(N));case"buffer":if(Ge)return Buffer.isBuffer(N)?N:Ui(N);case"array":return typeof N=="string"?Hn(N):N}return N}var xe;function U(T){try{var P=T.InflateRaw,N=new P;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)xe=T;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function J(T,P){if(!xe)return ra(T,P);var N=xe.InflateRaw,C=new N,b=C._processChunk(T.slice(T.l),C._finishFlushFlag);return T.l+=C.bytesRead,b}function G(T){return xe?xe.deflateRawSync(T):Me(T)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(T){var P=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(P>>16|P>>8|P)&255}for(var pe=typeof Uint8Array<"u",oe=pe?new Uint8Array(256):[],Re=0;Re<256;++Re)oe[Re]=Ee(Re);function j(T,P){var N=oe[T&255];return P<=8?N>>>8-P:(N=N<<8|oe[T>>8&255],P<=16?N>>>16-P:(N=N<<8|oe[T>>16&255],N>>>24-P))}function De(T,P){var N=P&7,C=P>>>3;return(T[C]|(N<=6?0:T[C+1]<<8))>>>N&3}function Be(T,P){var N=P&7,C=P>>>3;return(T[C]|(N<=5?0:T[C+1]<<8))>>>N&7}function Je(T,P){var N=P&7,C=P>>>3;return(T[C]|(N<=4?0:T[C+1]<<8))>>>N&15}function Ve(T,P){var N=P&7,C=P>>>3;return(T[C]|(N<=3?0:T[C+1]<<8))>>>N&31}function me(T,P){var N=P&7,C=P>>>3;return(T[C]|(N<=1?0:T[C+1]<<8))>>>N&127}function ct(T,P,N){var C=P&7,b=P>>>3,D=(1<<N)-1,W=T[b]>>>C;return N<8-C||(W|=T[b+1]<<8-C,N<16-C)||(W|=T[b+2]<<16-C,N<24-C)||(W|=T[b+3]<<24-C),W&D}function Lt(T,P,N){var C=P&7,b=P>>>3;return C<=5?T[b]|=(N&7)<<C:(T[b]|=N<<C&255,T[b+1]=(N&7)>>8-C),P+3}function nr(T,P,N){var C=P&7,b=P>>>3;return N=(N&1)<<C,T[b]|=N,P+1}function sr(T,P,N){var C=P&7,b=P>>>3;return N<<=C,T[b]|=N&255,N>>>=8,T[b+1]=N,P+8}function Dn(T,P,N){var C=P&7,b=P>>>3;return N<<=C,T[b]|=N&255,N>>>=8,T[b+1]=N&255,T[b+2]=N>>>8,P+16}function ar(T,P){var N=T.length,C=2*N>P?2*N:P+5,b=0;if(N>=P)return T;if(Ge){var D=Vv(C);if(T.copy)T.copy(D);else for(;b<T.length;++b)D[b]=T[b];return D}else if(pe){var W=new Uint8Array(C);if(W.set)W.set(T);else for(;b<N;++b)W[b]=T[b];return W}return T.length=C,T}function At(T){for(var P=new Array(T),N=0;N<T;++N)P[N]=0;return P}function Fr(T,P,N){var C=1,b=0,D=0,W=0,K=0,Y=T.length,Q=pe?new Uint16Array(32):At(32);for(D=0;D<32;++D)Q[D]=0;for(D=Y;D<N;++D)T[D]=0;Y=T.length;var Z=pe?new Uint16Array(Y):At(Y);for(D=0;D<Y;++D)Q[b=T[D]]++,C<b&&(C=b),Z[D]=0;for(Q[0]=0,D=1;D<=C;++D)Q[D+16]=K=K+Q[D-1]<<1;for(D=0;D<Y;++D)K=T[D],K!=0&&(Z[D]=Q[K+16]++);var ae=0;for(D=0;D<Y;++D)if(ae=T[D],ae!=0)for(K=j(Z[D],C)>>C-ae,W=(1<<C+4-ae)-1;W>=0;--W)P[K|W<<ae]=ae&15|D<<4;return C}var tt=pe?new Uint16Array(512):At(512),mt=pe?new Uint16Array(32):At(32);if(!pe){for(var St=0;St<512;++St)tt[St]=0;for(St=0;St<32;++St)mt[St]=0}(function(){for(var T=[],P=0;P<32;P++)T.push(5);Fr(T,mt,32);var N=[];for(P=0;P<=143;P++)N.push(8);for(;P<=255;P++)N.push(9);for(;P<=279;P++)N.push(7);for(;P<=287;P++)N.push(8);Fr(N,tt,288)})();var Or=function(){for(var P=pe?new Uint8Array(32768):[],N=0,C=0;N<he.length-1;++N)for(;C<he[N+1];++C)P[C]=N;for(;C<32768;++C)P[C]=29;var b=pe?new Uint8Array(259):[];for(N=0,C=0;N<re.length-1;++N)for(;C<re[N+1];++C)b[C]=N;function D(K,Y){for(var Q=0;Q<K.length;){var Z=Math.min(65535,K.length-Q),ae=Q+Z==K.length;for(Y.write_shift(1,+ae),Y.write_shift(2,Z),Y.write_shift(2,~Z&65535);Z-- >0;)Y[Y.l++]=K[Q++]}return Y.l}function W(K,Y){for(var Q=0,Z=0,ae=pe?new Uint16Array(32768):[];Z<K.length;){var fe=Math.min(65535,K.length-Z);if(fe<10){for(Q=Lt(Y,Q,+(Z+fe==K.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,fe),Y.write_shift(2,~fe&65535);fe-- >0;)Y[Y.l++]=K[Z++];Q=Y.l*8;continue}Q=Lt(Y,Q,+(Z+fe==K.length)+2);for(var we=0;fe-- >0;){var ce=K[Z];we=(we<<5^ce)&32767;var _e=-1,be=0;if((_e=ae[we])&&(_e|=Z&-32768,_e>Z&&(_e-=32768),_e<Z))for(;K[_e+be]==K[Z+be]&&be<250;)++be;if(be>2){ce=b[be],ce<=22?Q=sr(Y,Q,oe[ce+1]>>1)-1:(sr(Y,Q,3),Q+=5,sr(Y,Q,oe[ce-23]>>5),Q+=3);var st=ce<8?0:ce-4>>2;st>0&&(Dn(Y,Q,be-re[ce]),Q+=st),ce=P[Z-_e],Q=sr(Y,Q,oe[ce]>>3),Q-=3;var rt=ce<4?0:ce-2>>1;rt>0&&(Dn(Y,Q,Z-_e-he[ce]),Q+=rt);for(var xt=0;xt<be;++xt)ae[we]=Z&32767,we=(we<<5^K[Z])&32767,++Z;fe-=be-1}else ce<=143?ce=ce+48:Q=nr(Y,Q,1),Q=sr(Y,Q,oe[ce]),ae[we]=Z&32767,++Z}Q=sr(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?D(Y,Q):W(Y,Q)}}();function Me(T){var P=Gt(50+Math.floor(T.length*1.1)),N=Or(T,P);return P.slice(0,N)}var ut=pe?new Uint16Array(32768):At(32768),Mt=pe?new Uint16Array(32768):At(32768),gt=pe?new Uint16Array(128):At(128),gn=1,ta=1;function Qi(T,P){var N=Ve(T,P)+257;P+=5;var C=Ve(T,P)+1;P+=5;var b=Je(T,P)+4;P+=4;for(var D=0,W=pe?new Uint8Array(19):At(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=pe?new Uint8Array(8):At(8),Z=pe?new Uint8Array(8):At(8),ae=W.length,fe=0;fe<b;++fe)W[H[fe]]=D=Be(T,P),Y<D&&(Y=D),Q[D]++,P+=3;var we=0;for(Q[0]=0,fe=1;fe<=Y;++fe)Z[fe]=we=we+Q[fe-1]<<1;for(fe=0;fe<ae;++fe)(we=W[fe])!=0&&(K[fe]=Z[we]++);var ce=0;for(fe=0;fe<ae;++fe)if(ce=W[fe],ce!=0){we=oe[K[fe]]>>8-ce;for(var _e=(1<<7-ce)-1;_e>=0;--_e)gt[we|_e<<ce]=ce&7|fe<<3}var be=[];for(Y=1;be.length<N+C;)switch(we=gt[me(T,P)],P+=we&7,we>>>=3){case 16:for(D=3+De(T,P),P+=2,we=be[be.length-1];D-- >0;)be.push(we);break;case 17:for(D=3+Be(T,P),P+=3;D-- >0;)be.push(0);break;case 18:for(D=11+me(T,P),P+=7;D-- >0;)be.push(0);break;default:be.push(we),Y<we&&(Y=we);break}var st=be.slice(0,N),rt=be.slice(N);for(fe=N;fe<286;++fe)st[fe]=0;for(fe=C;fe<30;++fe)rt[fe]=0;return gn=Fr(st,ut,286),ta=Fr(rt,Mt,30),P}function xl(T,P){if(T[0]==3&&!(T[1]&3))return[Ba(P),2];for(var N=0,C=0,b=Vv(P||1<<18),D=0,W=b.length>>>0,K=0,Y=0;!(C&1);){if(C=Be(T,N),N+=3,C>>>1)C>>1==1?(K=9,Y=5):(N=Qi(T,N),K=gn,Y=ta);else{N&7&&(N+=8-(N&7));var Q=T[N>>>3]|T[(N>>>3)+1]<<8;if(N+=32,Q>0)for(!P&&W<D+Q&&(b=ar(b,D+Q),W=b.length);Q-- >0;)b[D++]=T[N>>>3],N+=8;continue}for(;;){!P&&W<D+32767&&(b=ar(b,D+32767),W=b.length);var Z=ct(T,N,K),ae=C>>>1==1?tt[Z]:ut[Z];if(N+=ae&15,ae>>>=4,!(ae>>>8&255))b[D++]=ae;else{if(ae==256)break;ae-=257;var fe=ae<8?0:ae-4>>2;fe>5&&(fe=0);var we=D+re[ae];fe>0&&(we+=ct(T,N,fe),N+=fe),Z=ct(T,N,Y),ae=C>>>1==1?mt[Z]:Mt[Z],N+=ae&15,ae>>>=4;var ce=ae<4?0:ae-2>>1,_e=he[ae];for(ce>0&&(_e+=ct(T,N,ce),N+=ce),!P&&W<we&&(b=ar(b,we+100),W=b.length);D<we;)b[D]=b[D-_e],++D}}}return P?[b,N+7>>>3]:[b.slice(0,D),N+7>>>3]}function ra(T,P){var N=T.slice(T.l||0),C=xl(N,P);return T.l+=C[1],C[0]}function ri(T,P){if(T)typeof console<"u"&&console.error(P);else throw new Error(P)}function ni(T,P){var N=T;ur(N,0);var C=[],b=[],D={FileIndex:C,FullPaths:b};w(D,{root:P.root});for(var W=N.length-4;(N[W]!=80||N[W+1]!=75||N[W+2]!=5||N[W+3]!=6)&&W>=0;)--W;N.l=W+4,N.l+=4;var K=N.read_shift(2);N.l+=6;var Y=N.read_shift(4);for(N.l=Y,W=0;W<K;++W){N.l+=20;var Q=N.read_shift(4),Z=N.read_shift(4),ae=N.read_shift(2),fe=N.read_shift(2),we=N.read_shift(2);N.l+=8;var ce=N.read_shift(4),_e=o(N.slice(N.l+ae,N.l+ae+fe));N.l+=ae+fe+we;var be=N.l;N.l=ce+4,ks(N,Q,Z,D,_e),N.l=be}return D}function ks(T,P,N,C,b){T.l+=2;var D=T.read_shift(2),W=T.read_shift(2),K=i(T);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var Y=T.read_shift(4),Q=T.read_shift(4),Z=T.read_shift(4),ae=T.read_shift(2),fe=T.read_shift(2),we="",ce=0;ce<ae;++ce)we+=String.fromCharCode(T[T.l++]);if(fe){var _e=o(T.slice(T.l,T.l+fe));(_e[21589]||{}).mt&&(K=_e[21589].mt),((b||{})[21589]||{}).mt&&(K=b[21589].mt)}T.l+=fe;var be=T.slice(T.l,T.l+Q);switch(W){case 8:be=J(T,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+W)}var st=!1;D&8&&(Y=T.read_shift(4),Y==134695760&&(Y=T.read_shift(4),st=!0),Q=T.read_shift(4),Z=T.read_shift(4)),Q!=P&&ri(st,"Bad compressed size: "+P+" != "+Q),Z!=N&&ri(st,"Bad uncompressed size: "+N+" != "+Z),Fn(C,we,be,{unsafe:!0,mt:K})}function Ji(T,P){var N=P||{},C=[],b=[],D=Gt(1),W=N.compression?8:0,K=0,Y=0,Q=0,Z=0,ae=0,fe=T.FullPaths[0],we=fe,ce=T.FileIndex[0],_e=[],be=0;for(Y=1;Y<T.FullPaths.length;++Y)if(we=T.FullPaths[Y].slice(fe.length),ce=T.FileIndex[Y],!(!ce.size||!ce.content||we=="Sh33tJ5")){var st=Z,rt=Gt(we.length);for(Q=0;Q<we.length;++Q)rt.write_shift(1,we.charCodeAt(Q)&127);rt=rt.slice(0,rt.l),_e[ae]=NR.buf(ce.content,0);var xt=ce.content;W==8&&(xt=G(xt)),D=Gt(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,K),D.write_shift(2,W),ce.mt?a(D,ce.mt):D.write_shift(4,0),D.write_shift(-4,_e[ae]),D.write_shift(4,xt.length),D.write_shift(4,ce.content.length),D.write_shift(2,rt.length),D.write_shift(2,0),Z+=D.length,C.push(D),Z+=rt.length,C.push(rt),Z+=xt.length,C.push(xt),D=Gt(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,K),D.write_shift(2,W),D.write_shift(4,0),D.write_shift(-4,_e[ae]),D.write_shift(4,xt.length),D.write_shift(4,ce.content.length),D.write_shift(2,rt.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,st),be+=D.l,b.push(D),be+=rt.length,b.push(rt),++ae}return D=Gt(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,ae),D.write_shift(2,ae),D.write_shift(4,be),D.write_shift(4,Z),D.write_shift(2,0),pa([pa(C),pa(b),D])}var bn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ir(T,P){if(T.ctype)return T.ctype;var N=T.name||"",C=N.match(/\.([^\.]+)$/);return C&&bn[C[1]]||P&&(C=(N=P).match(/[\.\\]([^\.\\])+$/),C&&bn[C[1]])?bn[C[1]]:"application/octet-stream"}function si(T){for(var P=Mv(T),N=[],C=0;C<P.length;C+=76)N.push(P.slice(C,C+76));return N.join(`\r
`)+`\r
`}function Lr(T){var P=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var Z=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],C=P.split(`\r
`),b=0;b<C.length;++b){var D=C[b];if(D.length==0){N.push("");continue}for(var W=0;W<D.length;){var K=76,Y=D.slice(W,W+K);Y.charAt(K-1)=="="?K--:Y.charAt(K-2)=="="?K-=2:Y.charAt(K-3)=="="&&(K-=3),Y=D.slice(W,W+K),W+=K,W<D.length&&(Y+="="),N.push(Y)}}return N.join(`\r
`)}function Zi(T){for(var P=[],N=0;N<T.length;++N){for(var C=T[N];N<=T.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+T[++N];P.push(C)}for(var b=0;b<P.length;++b)P[b]=P[b].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return Hn(P.join(`\r
`))}function tn(T,P,N){for(var C="",b="",D="",W,K=0;K<10;++K){var Y=P[K];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":C=Q[2].trim();break;case"content-type":D=Q[2].trim();break;case"content-transfer-encoding":b=Q[2].trim();break}}switch(++K,b.toLowerCase()){case"base64":W=Hn(dn(P.slice(K).join("")));break;case"quoted-printable":W=Zi(P.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var Z=Fn(T,C.slice(N.length),W,{unsafe:!0});D&&(Z.ctype=D)}function eo(T,P){if(q(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=P&&P.root||"",C=(Ge&&Buffer.isBuffer(T)?T.toString("binary"):q(T)).split(`\r
`),b=0,D="";for(b=0;b<C.length;++b)if(D=C[b],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),N||(N=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),D.slice(0,N.length)!=N););var W=(C[1]||"").match(/boundary="(.*?)"/);if(!W)throw new Error("MAD cannot find boundary");var K="--"+(W[1]||""),Y=[],Q=[],Z={FileIndex:Y,FullPaths:Q};w(Z);var ae,fe=0;for(b=0;b<C.length;++b){var we=C[b];we!==K&&we!==K+"--"||(fe++&&tn(Z,C.slice(ae,b),N),ae=b)}return Z}function Wt(T,P){var N=P||{},C=N.boundary||"SheetJS";C="------="+C;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],D=T.FullPaths[0],W=D,K=T.FileIndex[0],Y=1;Y<T.FullPaths.length;++Y)if(W=T.FullPaths[Y].slice(D.length),K=T.FileIndex[Y],!(!K.size||!K.content||W=="Sh33tJ5")){W=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(be){return"_x"+be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(be){return"_u"+be.charCodeAt(0).toString(16)+"_"});for(var Q=K.content,Z=Ge&&Buffer.isBuffer(Q)?Q.toString("binary"):q(Q),ae=0,fe=Math.min(1024,Z.length),we=0,ce=0;ce<=fe;++ce)(we=Z.charCodeAt(ce))>=32&&we<128&&++ae;var _e=ae>=fe*4/5;b.push(C),b.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+W),b.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),b.push("Content-Type: "+ir(K,W)),b.push(""),b.push(_e?Lr(Z):si(Z))}return b.push(C+`--\r
`),b.join(`\r
`)}function na(T){var P={};return w(P,T),P}function Fn(T,P,N,C){var b=C&&C.unsafe;b||w(T);var D=!b&&Ke.find(T,P);if(!D){var W=T.FullPaths[0];P.slice(0,W.length)==W?W=P:(W.slice(-1)!="/"&&(W+="/"),W=(W+P).replace("//","/")),D={name:s(P),type:2},T.FileIndex.push(D),T.FullPaths.push(W),b||Ke.utils.cfb_gc(T)}return D.content=N,D.size=N?N.length:0,C&&(C.CLSID&&(D.clsid=C.CLSID),C.mt&&(D.mt=C.mt),C.ct&&(D.ct=C.ct)),D}function Is(T,P){w(T);var N=Ke.find(T,P);if(N){for(var C=0;C<T.FileIndex.length;++C)if(T.FileIndex[C]==N)return T.FileIndex.splice(C,1),T.FullPaths.splice(C,1),!0}return!1}function vl(T,P,N){w(T);var C=Ke.find(T,P);if(C){for(var b=0;b<T.FileIndex.length;++b)if(T.FileIndex[b]==C)return T.FileIndex[b].name=s(N),T.FullPaths[b]=N,!0}return!1}function X(T){I(T,!0)}return e.find=F,e.read=B,e.parse=f,e.write=ue,e.writeFile=ie,e.utils={cfb_new:na,cfb_add:Fn,cfb_del:Is,cfb_mov:vl,cfb_gc:X,ReadShift:ac,CheckField:AT,prep_blob:ur,bconcat:pa,use_zlib:U,_deflateRaw:Me,_inflateRaw:ra,consts:ve},e}();function RR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Es(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Tg(t){for(var e=[],r=Es(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var xh=new Date(1899,11,30,0,0,0);function zr(t,e){var r=t.getTime(),n=xh.getTime()+(t.getTimezoneOffset()-xh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var nT=new Date,PR=xh.getTime()+(nT.getTimezoneOffset()-xh.getTimezoneOffset())*6e4,Gv=nT.getTimezoneOffset();function u0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+PR),e.getTimezoneOffset()!==Gv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Gv)*6e4),e}function DR(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var qv=new Date("2017-02-19T19:06:09.000Z"),sT=isNaN(qv.getFullYear())?new Date("2/19/17"):qv,bR=sT.getFullYear()==2017;function rr(t,e){var r=new Date(t);if(bR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(sT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ni(t,e){if(Ge&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return $l(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return $l(H2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return $l(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return $l(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function dr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=dr(t[r]));return e}function Ct(t,e){for(var r="";r.length<e;)r+=t;return r}function Yn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var FR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ko(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&FR.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var OR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function aT(t){return t?t.content&&t.type?Ni(t.content,!0):t.data?Ul(t.data):t.asNodeBuffer&&Ge?Ul(t.asNodeBuffer().toString("binary")):t.asBinary?Ul(t.asBinary()):t._data&&t._data.getContent?Ul(Ni(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function iT(t){if(!t)return null;if(t.data)return Ov(t.data);if(t.asNodeBuffer&&Ge)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Ov(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function LR(t){return t&&t.name.slice(-4)===".bin"?iT(t):aT(t)}function yn(t,e){for(var r=t.FullPaths||Es(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Ag(t,e){var r=yn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Bt(t,e,r){if(!r)return LR(Ag(t,e));if(!e)return null;try{return Bt(t,e)}catch{return null}}function on(t,e,r){if(!r)return aT(Ag(t,e));if(!e)return null;try{return on(t,e)}catch{return null}}function MR(t,e,r){return iT(Ag(t,e))}function Kv(t){for(var e=t.FullPaths||Es(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function VR(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ge?n=Ui(r):n=nR(r),Ke.utils.cfb_add(t,e,n)}Ke.utils.cfb_add(t,e,r)}else t.file(e,r)}function oT(t,e){switch(e.type){case"base64":return Ke.read(t,{type:"base64"});case"binary":return Ke.read(t,{type:"binary"});case"buffer":case"array":return Ke.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function jl(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var lT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,UR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Xv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,BR=/<[^>]*>/g,br=lT.match(Xv)?Xv:BR,jR=/<\w*:/,$R=/<(\/?)\w+:/;function Pe(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(UR),o=0,l="",c=0,f="",h="",d=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(d=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function As(t){return t.replace($R,"<$1")}var cT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zR=Tg(cT),Qe=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return cT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),HR=/[&<>'"]/g,WR=/[\u0000-\u001f]/g;function Sg(t){var e=t+"";return e.replace(HR,function(r){return zR[r]}).replace(/\n/g,"<br/>").replace(WR,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Yv=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function vt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yd(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Qv(t){var e=Ba(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function Jv(t){return Ui(t,"binary").toString("utf8")}var tf="foo bar baz",lt=Ge&&(Jv(tf)==yd(tf)&&Jv||Qv(tf)==yd(tf)&&Qv)||yd,$l=Ge?function(t){return Ui(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Bc=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),uT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),GR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),qR=/<\/?(?:vt:)?variant>/g,KR=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zv(t,e){var r=Pe(t),n=t.match(GR(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(qR,"").match(KR);i&&s.push({v:lt(i[2]),t:i[1]})}),s}var XR=/(^\s|\s$|\n)/;function YR(t){return Es(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function QR(t,e,r){return"<"+t+(r!=null?YR(r):"")+(e!=null?(e.match(XR)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function kg(t){if(Ge&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return lt(Bi(_g(t)));throw new Error("Bad input format: expected Buffer or string")}var jc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,JR={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ZR=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function eP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function tP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var ey=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},ty=Ge?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ui(e)})):ey(t)}:ey,ry=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Os(t,s)));return n.join("").replace($r,"")},Ig=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace($r,""):ry(t,e,r)}:ry,ny=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},fT=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):ny(t,e,r)}:ny,sy=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(oo(t,s)));return n.join("")},ou=Ge?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):sy(e,r,n)}:sy,hT=function(t,e){var r=an(t,e);return r>0?ou(t,e+4,e+4+r-1):""},dT=hT,pT=function(t,e){var r=an(t,e);return r>0?ou(t,e+4,e+4+r-1):""},mT=pT,gT=function(t,e){var r=2*an(t,e);return r>0?ou(t,e+4,e+4+r-1):""},xT=gT,vT=function(e,r){var n=an(e,r);return n>0?Ig(e,r+4,r+4+n):""},yT=vT,_T=function(t,e){var r=an(t,e);return r>0?ou(t,e+4,e+4+r):""},ET=_T,wT=function(t,e){return eP(t,e)},vh=wT,TT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ge&&(dT=function(e,r){if(!Buffer.isBuffer(e))return hT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},mT=function(e,r){if(!Buffer.isBuffer(e))return pT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},xT=function(e,r){if(!Buffer.isBuffer(e))return gT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},yT=function(e,r){if(!Buffer.isBuffer(e))return vT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ET=function(e,r){if(!Buffer.isBuffer(e))return _T(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},vh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):wT(e,r)},TT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var oo=function(t,e){return t[e]},Os=function(t,e){return t[e+1]*256+t[e]},rP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},an=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},fi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},nP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function ac(t,e){var r="",n,s,a=[],i,o,l,c;switch(e){case"dbcs":if(c=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Os(this,c)),c+=2;t*=2;break;case"utf8":r=ou(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ig(this,this.l,this.l+t);break;case"wstr":return ac.call(this,t,"dbcs");case"lpstr-ansi":r=dT(this,this.l),t=4+an(this,this.l);break;case"lpstr-cp":r=mT(this,this.l),t=4+an(this,this.l);break;case"lpwstr":r=xT(this,this.l),t=4+2*an(this,this.l);break;case"lpp4":t=4+an(this,this.l),r=yT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+an(this,this.l),r=ET(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=oo(this,this.l+t++))!==0;)a.push(ef(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Os(this,this.l+t))!==0;)a.push(ef(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=oo(this,c),this.l=c+1,o=ac.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ef(Os(this,c))),c+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=oo(this,c),this.l=c+1,o=ac.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ef(oo(this,c))),c+=1}r=a.join("");break;default:switch(t){case 1:return n=oo(this,this.l),this.l++,n;case 2:return n=(e==="i"?rP:Os)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?fi:nP)(this,this.l),this.l+=4,n):(s=an(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=vh(this,this.l):s=vh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=fT(this,this.l,t);break}}return this.l+=t,r}var sP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},aP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},iP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function oP(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)iP(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,sP(this,e,this.l);break;case 8:if(n=8,r==="f"){tP(this,e,this.l);break}case 16:break;case-4:n=4,aP(this,e,this.l);break}return this.l+=n,this}function AT(t,e){var r=fT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ur(t,e){t.l=e,t.read_shift=ac,t.chk=AT,t.write_shift=oP}function Pr(t,e){t.l+=e}function Gt(t){var e=Ba(t);return ur(e,0),e}function Zs(t,e,r){if(t){var n,s,a;ur(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Ah[o]||Ah[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var f=c.f&&c.f(t,a,r);if(t.l=l,e(f,c,o))return}}}function Mp(){var t=[],e=Ge?256:2048,r=function(c){var f=Gt(c);return ur(f,0),f},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},i=function(){return s(),pa(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function ic(t,e,r){var n=dr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ay(t,e,r){var n=dr(t);return n.s=ic(n.s,e.s,r),n.e=ic(n.e,e.s,r),n}function oc(t,e){if(t.cRel&&t.c<0)for(t=dr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=dr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Oe(t);return!t.cRel&&t.cRel!=null&&(r=uP(r)),!t.rRel&&t.rRel!=null&&(r=lP(r)),r}function _d(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xt(t.s.c)+":"+(t.e.cRel?"":"$")+Xt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+pr(t.s.r)+":"+(t.e.rRel?"":"$")+pr(t.e.r):oc(t.s,e.biff)+":"+oc(t.e,e.biff)}function Cg(t){return parseInt(cP(t),10)-1}function pr(t){return""+(t+1)}function lP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function cP(t){return t.replace(/\$(\d+)$/,"$1")}function Ng(t){for(var e=fP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Xt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function uP(t){return t.replace(/^([A-Z])/,"$$$1")}function fP(t){return t.replace(/^\$([A-Z])/,"$1")}function hP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Br(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Oe(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ol(t){var e=t.indexOf(":");return e==-1?{s:Br(t),e:Br(t)}:{s:Br(t.slice(0,e)),e:Br(t.slice(e+1))}}function Xe(t,e){return typeof e>"u"||typeof e=="number"?Xe(t.s,t.e):(typeof t!="string"&&(t=Oe(t)),typeof e!="string"&&(e=Oe(e)),t==e?t:t+":"+e)}function Nt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function iy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Rn(t.z,r?zr(e):e)}catch{}try{return t.w=Rn((t.XF||{}).numFmtId||(r?14:0),r?zr(e):e)}catch{return""+e}}function qs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?zi[t.v]||t.v:e==null?iy(t,t.v):iy(t,e))}function Ja(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function ST(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Nt(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},v=i+h,x=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>x&&(c.s.c=x),c.e.r<v&&(c.e.r=v),c.e.c<x&&(c.e.c=x),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ue[14],n.cellDates?(p.t="d",p.w=Rn(p.z,zr(p.v))):(p.t="n",p.v=zr(p.v),p.w=Rn(p.z,p.v))):p.t="s";if(s)a[v]||(a[v]=[]),a[v][x]&&a[v][x].z&&(p.z=a[v][x].z),a[v][x]=p;else{var E=Oe({c:x,r:v});a[E]&&a[E].z&&(p.z=a[E].z),a[E]=p}}}return c.s.c<1e7&&(a["!ref"]=Xe(c)),a}function ll(t,e){return ST(null,t,e)}function dP(t){return t.read_shift(4,"i")}function Nr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function pP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Rg(t,e){var r=t.l,n=t.read_shift(1),s=Nr(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(pP(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}var mP=Rg;function Pn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ji(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var gP=Nr;function Pg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var xP=Nr,Vp=Pg;function Dg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?vh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):fi(e,0)>>2;return r?s/100:s}function kT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var $i=kT;function Ir(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function vP(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Ei[s];c&&(e.rgb=zc(c));break;case 2:e.rgb=zc([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function yP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function IT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function _P(t){return IT(t,1)}function EP(t){return IT(t,2)}var bg=2,Gr=3,rf=11,oy=12,yh=19,nf=64,wP=65,TP=71,AP=4108,SP=4126,Jt=80,CT=81,kP=[Jt,CT],IP={1:{n:"CodePage",t:bg},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:Gr},5:{n:"LineCount",t:Gr},6:{n:"ParagraphCount",t:Gr},7:{n:"SlideCount",t:Gr},8:{n:"NoteCount",t:Gr},9:{n:"HiddenCount",t:Gr},10:{n:"MultimediaClipCount",t:Gr},11:{n:"ScaleCrop",t:rf},12:{n:"HeadingPairs",t:AP},13:{n:"TitlesOfParts",t:SP},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:rf},17:{n:"CharacterCount",t:Gr},19:{n:"SharedDoc",t:rf},22:{n:"HyperlinksChanged",t:rf},23:{n:"AppVersion",t:Gr,p:"version"},24:{n:"DigSig",t:wP},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:yh},2147483651:{n:"Behavior",t:yh},1919054434:{}},CP={1:{n:"CodePage",t:bg},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:nf},11:{n:"LastPrinted",t:nf},12:{n:"CreatedDate",t:nf},13:{n:"ModifiedDate",t:nf},14:{n:"PageCount",t:Gr},15:{n:"WordCount",t:Gr},16:{n:"CharCount",t:Gr},17:{n:"Thumbnail",t:TP},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:Gr},255:{},2147483648:{n:"Locale",t:yh},2147483651:{n:"Behavior",t:yh},1919054434:{}},ly={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},NP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function RP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var PP=RP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ei=dr(PP),zi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},NT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function DP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bP(t){var e=DP();if(!t||!t.match)return e;var r={};if((t.match(br)||[]).forEach(function(n){var s=Pe(n);switch(s[0].replace(jR,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[cy[s.ContentType]]!==void 0&&e[cy[s.ContentType]].push(s.PartName);break}}),e.xmlns!==JR.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var So={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Up(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function lc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(br)||[]).forEach(function(s){var a=Pe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:jl(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var FP="application/vnd.oasis.opendocument.spreadsheet";function OP(t,e){for(var r=kg(t),n,s;n=jc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Pe(n[0],!1),s.path=="/"&&s.type!==FP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var cc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],LP=function(){for(var t=new Array(cc.length),e=0;e<cc.length;++e){var r=cc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function RT(t){var e={};t=lt(t);for(var r=0;r<cc.length;++r){var n=cc[r],s=t.match(LP[r]);s!=null&&s.length>0&&(e[n[1]]=Qe(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=rr(e[n[1]]))}return e}var MP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function PT(t,e,r,n){var s=[];if(typeof t=="string")s=Zv(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(f){return{v:f}}));var i=typeof e=="string"?Zv(e,n).map(function(f){return f.v}):e,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function VP(t,e,r){var n={};return e||(e={}),t=lt(t),MP.forEach(function(s){var a=(t.match(Bc(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=Qe(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&PT(n.HeadingPairs,n.TitlesOfParts,e,r),e}var UP=/<[^>]+>[^<]*/g;function BP(t,e){var r={},n="",s=t.match(UP);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Pe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qe(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Qe(f);break;case"bool":r[n]=vt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=rr(f);break;case"cy":case"error":r[n]=Qe(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}var jP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ed;function $P(t,e,r){Ed||(Ed=Tg(jP)),e=Ed[e]||e,t[e]=r}function Fg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function DT(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function bT(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function FT(t,e,r){return e===31?bT(t):DT(t,e,r)}function Bp(t,e,r){return FT(t,e,r===!1?0:4)}function zP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return FT(t,e,0)}function HP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace($r,""),t.l-s&2&&(t.l+=2)}return r}function WP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace($r,"");return r}function GP(t){var e=t.l,r=_h(t,CT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=_h(t,Gr);return[r,n]}function qP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(GP(t));return r}function uy(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace($r,"").replace(Bl,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function OT(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function KP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function _h(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==oy&&n!==e&&kP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===oy?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return DT(t,n,4).replace($r,"");case 31:return bT(t);case 64:return Fg(t);case 65:return OT(t);case 71:return KP(t);case 80:return Bp(t,n,!a.raw).replace($r,"");case 81:return zP(t,n).replace($r,"");case 4108:return qP(t);case 4126:case 4127:return n==4127?HP(t):WP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function fy(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var f=t.read_shift(4),h=t.read_shift(4);a[i]=[f,h+r]}a.sort(function(_,y){return _[1]-y[1]});var d={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var p=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(p=!1,t.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var v=e[a[i][0]];if(d[v.n]=_h(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Wn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(a[i][0]===1){if(o=d.CodePage=_h(t,bg),Wn(o),l!==-1){var x=t.l;t.l=a[l][1],c=uy(t,o),t.l=x}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}c=uy(t,o)}else{var E=c[a[i][0]],A;switch(t[t.l]){case 65:t.l+=4,A=OT(t);break;case 30:t.l+=4,A=Bp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=Bp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=Pt(t,4);break;case 64:t.l+=4,A=rr(Fg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[E]=A}}return t.l=r+n,d}function hy(t,e,r){var n=t.content;if(!n)return{};ur(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ke.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=fy(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=a,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=fy(n,null)}catch{}for(p in v)d[p]=v[p];return d.FMTID=[a,i],d}function la(t,e){return t.read_shift(e),null}function XP(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Pt(t,e){return t.read_shift(e)===1}function jt(t){return t.read_shift(2,"u")}function LT(t,e){return XP(t,e,jt)}function YP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function lu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function QP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ri(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function cu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ri(t,n,r)}function Hi(t,e,r){if(r.biff>5)return cu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function JP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function ZP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace($r,"");return n&&(t.l+=24),s}function e3(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace($r,"");return r+i}function t3(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ZP(t);case"0303000000000000c000000000000046":return e3(t);default:throw new Error("Unsupported Moniker "+r)}}function sf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace($r,""):"";return r}function r3(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,c="",f,h;s&16&&(a=sf(t,r-t.l)),s&128&&(i=sf(t,r-t.l)),(s&257)===257&&(o=sf(t,r-t.l)),(s&257)===1&&(l=t3(t,r-t.l)),s&8&&(c=sf(t,r-t.l)),s&32&&(f=t.read_shift(16)),s&64&&(h=Fg(t)),t.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return f&&(p.guid=f),h&&(p.time=h),a&&(p.Tooltip=a),p}function MT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function VT(t,e){var r=MT(t);return r[3]=0,r}function Ss(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function n3(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function s3(t,e,r){return e===0?"":Hi(t,e,r)}function a3(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function UT(t){var e=t.read_shift(2),r=Dg(t);return[e,r]}function i3(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=lu(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function f0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function BT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var o3=BT;function jT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function l3(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function c3(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Er(t){t.l+=2,t.l+=t.read_shift(2)}var u3={0:Er,4:Er,5:Er,6:Er,7:c3,8:Er,9:Er,10:Er,11:Er,12:Er,13:l3,14:Er,15:Er,16:Er,17:Er,18:Er,19:Er,20:Er,21:jT};function f3(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(u3[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function af(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function h3(t,e){return e===0||t.read_shift(2),1200}function d3(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Hi(t,0,r);return t.read_shift(e+n-t.l),s}function p3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function m3(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=lu(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function g3(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(QP(t));return a.Count=n,a.Unique=s,a}function x3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function v3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function y3(t){var e=n3(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function _3(t){return t.read_shift(2),t.read_shift(4)}function dy(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function E3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function w3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function T3(){}function A3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=lu(t,0,r),n}function S3(t){var e=Ss(t);return e.isst=t.read_shift(4),e}function k3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Ss(t);r.biff==2&&t.l++;var a=cu(t,n-t.l,r);return s.val=a,s}function I3(t,e,r){var n=t.read_shift(2),s=Hi(t,0,r);return[n,s]}var C3=Hi;function py(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function N3(t){var e=t.read_shift(2),r=t.read_shift(2),n=UT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function R3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(UT(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function P3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function D3(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=NP[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function b3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=D3(t,e,n.fStyle,r),n}function F3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function my(t,e,r){var n=Ss(t);(r.biff==2||e==9)&&++t.l;var s=YP(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function O3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ss(t),s=Ir(t);return n.val=s,n}var gy=s3;function L3(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Ri(t,a),o=[];n>t.l;)o.push(cu(t));return[a,s,i,o]}function xy(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=i3(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var M3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vy(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ri(t,i,r);s&32&&(c=M3[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:vO(t,f,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function $T(t,e,r){if(r.biff<8)return V3(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(a3(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function V3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=lu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function U3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Ri(t,n,r),i=Ri(t,s,r);return[a,i]}function B3(t,e,r){var n=BT(t);t.l++;var s=t.read_shift(1);return e-=8,[yO(t,e,r),s,n]}function yy(t,e,r){var n=o3(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,gO(t,e,r)]}function j3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function $3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=Hi(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function z3(t,e,r){return $3(t,e,r)}function H3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(f0(t));return r}function W3(t,e,r){if(r&&r.biff<8)return q3(t,e,r);var n=jT(t),s=f3(t,e-22,n[1]);return{cmo:n,ft:s}}var G3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function q3(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((G3[n]||Pr)(t,e,r)),{cmo:[s,n,a],ft:i}}function K3(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=JP(t,6,r);var o=t.read_shift(2);t.read_shift(2),jt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ri(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function X3(t,e){var r=f0(t);t.l+=16;var n=r3(t,e-24);return[r,n]}function Y3(t,e){t.read_shift(2);var r=f0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace($r,""),[r,n]}function Q3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ly[r]||r,r=t.read_shift(2),e[1]=ly[r]||r,e}function J3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(VT(t));return r}function Z3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(VT(t));return r}function eD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function zT(t,e,r){if(!r.cellStyles)return Pr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function tD(t,e){var r={};return e<32||(t.l+=16,r.header=Ir(t),r.footer=Ir(t),t.l+=2),r}function rD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var nD=Ss,sD=LT,aD=cu;function iD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function oD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ss(t);++t.l;var s=Hi(t,e-7,r);return n.t="str",n.val=s,n}function lD(t){var e=Ss(t);++t.l;var r=Ir(t);return e.t="n",e.val=r,e}function cD(t){var e=Ss(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function uD(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function fD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function hD(t,e,r){var n=t.l+e,s=Ss(t),a=t.read_shift(2),i=Ri(t,a,r);return t.l=n,s.t="str",s.val=i,s}var dD=[2,3,48,49,131,139,140,245],_y=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Tg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Ba(1);switch(l.type){case"base64":f=Hn(dn(o));break;case"binary":f=Hn(o);break;case"buffer":case"array":f=o;break}ur(f,0);var h=f.read_shift(1),d=!!(h&136),p=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=f.read_shift(2)),f.l+=3,h!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=f.read_shift(2));var A=f.read_shift(2),_=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var y=[],M={},z=Math.min(f.length,h==2?521:E-10-(p?264:0)),B=v?32:11;f.l<z&&f[f.l]!=13;)switch(M={},M.name=Vc.utils.decode(_,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,M.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(M.offset=f.read_shift(4)),M.len=f.read_shift(1),h==2&&(M.offset=f.read_shift(2)),M.dec=f.read_shift(1),M.name.length&&y.push(M),h!=2&&(f.l+=v?13:14),M.type){case"B":(!p||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var w=0,k=0;for(c[0]=[],k=0;k!=y.length;++k)c[0][k]=y[k].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,c[++w]=[],k=0,k=0;k!=y.length;++k){var I=f.slice(f.l,f.l+y[k].len);f.l+=y[k].len,ur(I,0);var R=Vc.utils.decode(_,I);switch(y[k].type){case"C":R.trim().length&&(c[w][k]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[w][k]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[w][k]=R;break;case"F":c[w][k]=parseFloat(R.trim());break;case"+":case"I":c[w][k]=v?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[w][k]=!0;break;case"N":case"F":c[w][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][k]="##MEMO##"+(v?parseInt(R.trim(),10):I.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[w][k]=+R||0);break;case"@":c[w][k]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":c[w][k]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":c[w][k]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][k]=-I.read_shift(-8,"f");break;case"B":if(p&&y[k].len==8){c[w][k]=I.read_shift(8,"f");break}case"G":case"P":I.l+=y[k].len;break;case"0":if(y[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=ll(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function s(o,l){try{return Ja(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Wn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Mp(),h=Gp(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),v=o["!cols"]||[],x=0,E=0,A=0,_=1;for(x=0;x<d.length;++x){if(((v[x]||{}).DBF||{}).name){d[x]=v[x].DBF.name,++A;continue}if(d[x]!=null){if(++A,typeof d[x]=="number"&&(d[x]=d[x].toString(10)),typeof d[x]!="string")throw new Error("DBF Invalid column name "+d[x]+" |"+typeof d[x]+"|");if(d.indexOf(d[x])!==x){for(E=0;E<1024;++E)if(d.indexOf(d[x]+"_"+E)==-1){d[x]+="_"+E;break}}}}var y=Nt(o["!ref"]),M=[],z=[],B=[];for(x=0;x<=y.e.c-y.s.c;++x){var w="",k="",I=0,R=[];for(E=0;E<p.length;++E)p[E][x]!=null&&R.push(p[E][x]);if(R.length==0||d[x]==null){M[x]="?";continue}for(E=0;E<R.length;++E){switch(typeof R[E]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=R[E]instanceof Date?"D":"C";break;default:k="C"}I=Math.max(I,String(R[E]).length),w=w&&w!=k?"C":k}I>250&&(I=250),k=((v[x]||{}).DBF||{}).type,k=="C"&&v[x].DBF.len>I&&(I=v[x].DBF.len),w=="B"&&k=="N"&&(w="N",B[x]=v[x].DBF.dec,I=v[x].DBF.len),z[x]=w=="C"||k=="N"?I:a[w]||0,_+=z[x],M[x]=w}var F=f.next(32);for(F.write_shift(4,318902576),F.write_shift(4,p.length),F.write_shift(2,296+32*A),F.write_shift(2,_),x=0;x<4;++x)F.write_shift(4,0);for(F.write_shift(4,0|(+e[$2]||3)<<8),x=0,E=0;x<d.length;++x)if(d[x]!=null){var O=f.next(32),L=(d[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,L,"sbcs"),O.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),O.write_shift(4,E),O.write_shift(1,z[x]||a[M[x]]||0),O.write_shift(1,B[x]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),E+=z[x]||a[M[x]]||0}var ye=f.next(264);for(ye.write_shift(4,13),x=0;x<65;++x)ye.write_shift(4,0);for(x=0;x<p.length;++x){var de=f.next(_);for(de.write_shift(1,0),E=0;E<d.length;++E)if(d[E]!=null)switch(M[E]){case"L":de.write_shift(1,p[x][E]==null?63:p[x][E]?84:70);break;case"B":de.write_shift(8,p[x][E]||0,"f");break;case"N":var Ae="0";for(typeof p[x][E]=="number"&&(Ae=p[x][E].toFixed(B[E]||0)),A=0;A<z[E]-Ae.length;++A)de.write_shift(1,32);de.write_shift(1,Ae,"sbcs");break;case"D":p[x][E]?(de.write_shift(4,("0000"+p[x][E].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(p[x][E].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+p[x][E].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(p[x][E]!=null?p[x][E]:"").slice(0,z[E]);for(de.write_shift(1,ve,"sbcs"),A=0;A<z[E]-ve.length;++A)de.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),pD=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Es(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var v=t[p];return typeof v=="number"?Lv(v):v},n=function(d,p,v){var x=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?d:Lv(x)};t["|"]=254;function s(d,p){switch(p.type){case"base64":return a(dn(d),p);case"binary":return a(d,p);case"buffer":return a(Ge&&Buffer.isBuffer(d)?d.toString("binary"):Bi(d),p);case"array":return a(Ni(d),p)}throw new Error("Unrecognized type "+p.type)}function a(d,p){var v=d.split(/[\n\r]+/),x=-1,E=-1,A=0,_=0,y=[],M=[],z=null,B={},w=[],k=[],I=[],R=0,F;for(+p.codepage>=0&&Wn(+p.codepage);A!==v.length;++A){R=0;var O=v[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),L=O.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ye=L[0],de;if(O.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&M.push(O.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,ve=!1,ie=!1,q=!1,ue=-1,xe=-1;for(_=1;_<L.length;++_)switch(L[_].charAt(0)){case"A":break;case"X":E=parseInt(L[_].slice(1))-1,ve=!0;break;case"Y":for(x=parseInt(L[_].slice(1))-1,ve||(E=0),F=y.length;F<=x;++F)y[F]=[];break;case"K":de=L[_].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Yn(de))?isNaN(Ko(de).getDate())||(de=rr(de)):(de=Yn(de),z!==null&&il(z)&&(de=u0(de))),Ae=!0;break;case"E":q=!0;var U=Fo(L[_].slice(1),{r:x,c:E});y[x][E]=[y[x][E],U];break;case"S":ie=!0,y[x][E]=[y[x][E],"S5S"];break;case"G":break;case"R":ue=parseInt(L[_].slice(1))-1;break;case"C":xe=parseInt(L[_].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}if(Ae&&(y[x][E]&&y[x][E].length==2?y[x][E][0]=de:y[x][E]=de,z=null),ie){if(q)throw new Error("SYLK shared formula cannot have own formula");var J=ue>-1&&y[ue][xe];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");y[x][E][1]=ZT(J[1],{r:x-ue,c:E-xe})}break;case"F":var G=0;for(_=1;_<L.length;++_)switch(L[_].charAt(0)){case"X":E=parseInt(L[_].slice(1))-1,++G;break;case"Y":for(x=parseInt(L[_].slice(1))-1,F=y.length;F<=x;++F)y[F]=[];break;case"M":R=parseInt(L[_].slice(1))/20;break;case"F":break;case"G":break;case"P":z=M[parseInt(L[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=L[_].slice(1).split(" "),F=parseInt(I[0],10);F<=parseInt(I[1],10);++F)R=parseInt(I[2],10),k[F-1]=R===0?{hidden:!0}:{wch:R},Xo(k[F-1]);break;case"C":E=parseInt(L[_].slice(1))-1,k[E]||(k[E]={});break;case"R":x=parseInt(L[_].slice(1))-1,w[x]||(w[x]={}),R>0?(w[x].hpt=R,w[x].hpx=Hc(R)):R===0&&(w[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}G<1&&(z=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}}return w.length>0&&(B["!rows"]=w),k.length>0&&(B["!cols"]=k),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,B]}function i(d,p){var v=s(d,p),x=v[0],E=v[1],A=ll(x,p);return Es(E).forEach(function(_){A[_]=E[_]}),A}function o(d,p){return Ja(i(d,p),p)}function l(d,p,v,x){var E="C;Y"+(v+1)+";X"+(x+1)+";K";switch(d.t){case"n":E+=d.v||0,d.f&&!d.F&&(E+=";E"+eF(d.f,{r:v,c:x}));break;case"b":E+=d.v?"TRUE":"FALSE";break;case"e":E+=d.w||d.v;break;case"d":E+='"'+(d.w||d.v)+'"';break;case"s":E+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(d,p){p.forEach(function(v,x){var E="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=wh(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Th(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&d.push(E)})}function f(d,p){p.forEach(function(v,x){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*YT(v.hpx)+";"),E.length>2&&d.push(E+"R"+(x+1))})}function h(d,p){var v=["ID;PWXL;N;E"],x=[],E=Nt(d["!ref"]),A,_=Array.isArray(d),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&f(v,d["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var z=E.s.c;z<=E.e.c;++z){var B=Oe({r:M,c:z});A=_?(d[M]||[])[z]:d[B],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,d,M,z))}return v.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),mD=function(){function t(a,i){switch(i.type){case"base64":return e(dn(a),i);case"binary":return e(a,i);case"buffer":return e(Ge&&Buffer.isBuffer(a)?a.toString("binary"):Bi(a),i);case"array":return e(Ni(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),p=d[0],v=d[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+p){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Yn(v))?isNaN(Ko(v).getDate())?h[l][c]=v:h[l][c]=rr(v):h[l][c]=Yn(v),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return ll(t(a,i),i)}function n(a,i){return Ja(r(a,i),i)}var s=function(){var a=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=Nt(l["!ref"]),h,d=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var x=Oe({r:p,c:v});if(h=d?(l[p]||[])[v]:l[x],!h){i(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,E,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Rn(h.z||Ue[14],zr(rr(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var A=`\r
`,_=c.join(A);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),gD=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),v=-1,x=-1,E=0,A=[];E!==p.length;++E){var _=p[E].trim().split(":");if(_[0]==="cell"){var y=Br(_[1]);if(A.length<=y.r)for(v=A.length;v<=y.r;++v)A[v]||(A[v]=[]);switch(v=y.r,x=y.c,_[2]){case"t":A[v][x]=t(_[3]);break;case"v":A[v][x]=+_[3];break;case"vtf":var M=_[_.length-1];case"vtc":switch(_[3]){case"nl":A[v][x]=!!+_[4];break;default:A[v][x]=+_[4];break}_[2]=="vtf"&&(A[v][x]=[A[v][x],M])}}}return d&&d.sheetRows&&(A=A.slice(0,d.sheetRows)),A}function n(h,d){return ll(r(h,d),d)}function s(h,d){return Ja(n(h,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],v,x="",E=ol(h["!ref"]),A=Array.isArray(h),_=E.s.r;_<=E.e.r;++_)for(var y=E.s.c;y<=E.e.c;++y)if(x=Oe({r:_,c:y}),v=A?(h[_]||[])[y]:h[x],!(!v||v.v==null||v.t==="z")){switch(p=["cell",x,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=zr(rr(v.v));p[2]="vtc",p[3]="nd",p[4]=""+M,p[5]=v.w||Rn(v.z||Ue[14],M);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[a,i,o,i,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),$c=function(){function t(f,h,d,p,v){v.raw?h[d][p]=f:f===""||(f==="TRUE"?h[d][p]=!0:f==="FALSE"?h[d][p]=!1:isNaN(Yn(f))?isNaN(Ko(f).getDate())?h[d][p]=f:h[d][p]=rr(f):h[d][p]=Yn(f))}function e(f,h){var d=h||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var E=10,A=0,_=0;_<=x;++_)A=v[_].indexOf(" "),A==-1?A=v[_].length:A++,E=Math.max(E,A);for(_=0;_<=x;++_){p[_]=[];var y=0;for(t(v[_].slice(0,E).trim(),p,_,y,d),y=1;y<=(v[_].length-E)/10+1;++y)t(v[_].slice(E+(y-1)*10,E+y*10).trim(),p,_,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},d=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?d=!d:!d&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p]);if(!v.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p])}return v.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[v.pop()[1]]||44}function a(f,h){var d=h||{},p="",v=d.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):d&&d.FS?p=d.FS:p=s(f.slice(0,1024));var E=0,A=0,_=0,y=0,M=0,z=p.charCodeAt(0),B=!1,w=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var I=d.dateNF!=null?IR(d.dateNF):null;function R(){var F=f.slice(y,M),O={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)O.t="z";else if(d.raw)O.t="s",O.v=F;else if(F.trim().length===0)O.t="s",O.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(O.t="s",O.v=F.slice(2,-1).replace(/""/g,'"')):rF(F)?(O.t="n",O.f=F.slice(1)):(O.t="s",O.v=F);else if(F=="TRUE")O.t="b",O.v=!0;else if(F=="FALSE")O.t="b",O.v=!1;else if(!isNaN(_=Yn(F)))O.t="n",d.cellText!==!1&&(O.w=F),O.v=_;else if(!isNaN(Ko(F).getDate())||I&&F.match(I)){O.z=d.dateNF||Ue[14];var L=0;I&&F.match(I)&&(F=CR(F,d.dateNF,F.match(I)||[]),L=1),d.cellDates?(O.t="d",O.v=rr(F,L)):(O.t="n",O.v=zr(rr(F,L))),d.cellText!==!1&&(O.w=Rn(O.z,O.v instanceof Date?zr(O.v):O.v)),d.cellNF||delete O.z}else O.t="s",O.v=F;if(O.t=="z"||(d.dense?(v[E]||(v[E]=[]),v[E][A]=O):v[Oe({c:A,r:E})]=O),y=M+1,k=f.charCodeAt(y),x.e.c<A&&(x.e.c=A),x.e.r<E&&(x.e.r=E),w==z)++A;else if(A=0,++E,d.sheetRows&&d.sheetRows<=E)return!0}e:for(;M<f.length;++M)switch(w=f.charCodeAt(M)){case 34:k===34&&(B=!B);break;case z:case 10:case 13:if(!B&&R())break e;break}return M-y>0&&R(),v["!ref"]=Xe(x),v}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):ll(e(f,h),h)}function o(f,h){var d="",p=h.type=="string"?[0,0,0,0]:$g(f,h);switch(h.type){case"base64":d=dn(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Vc<"u"||(d=Ge&&Buffer.isBuffer(f)?f.toString("binary"):Bi(f));break;case"array":d=Ni(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=lt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=lt(d):h.type=="binary"&&typeof Vc<"u",d.slice(0,19)=="socialcalc:version:"?gD.to_sheet(h.type=="string"?d:lt(d),h):i(d,h)}function l(f,h){return Ja(o(f,h),h)}function c(f){for(var h=[],d=Nt(f["!ref"]),p,v=Array.isArray(f),x=d.s.r;x<=d.e.r;++x){for(var E=[],A=d.s.c;A<=d.e.c;++A){var _=Oe({r:x,c:A});if(p=v?(f[x]||[])[A]:f[_],!p||p.v==null){E.push("          ");continue}for(var y=(p.w||(qs(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";E.push(y+(A===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function xD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=pD.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return $c.to_workbook(t,e)}}var uc=function(){function t(U,J,G){if(U){ur(U,U.l||0);for(var H=G.Enum||ue;U.l<U.length;){var re=U.read_shift(2),he=H[re]||H[65535],Ee=U.read_shift(2),pe=U.l+Ee,oe=he.f&&he.f(U,Ee,G);if(U.l=pe,J(oe,he,re))return}}}function e(U,J){switch(J.type){case"base64":return r(Hn(dn(U)),J);case"binary":return r(Hn(U),J);case"buffer":case"array":return r(U,J)}throw"Unsupported type "+J.type}function r(U,J){if(!U)return U;var G=J||{},H=G.dense?[]:{},re="Sheet1",he="",Ee=0,pe={},oe=[],Re=[],j={s:{r:0,c:0},e:{r:0,c:0}},De=G.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)G.Enum=ue,t(U,function(me,ct,Lt){switch(Lt){case 0:G.vers=me,me>=4096&&(G.qpro=!0);break;case 6:j=me;break;case 204:me&&(he=me);break;case 222:he=me;break;case 15:case 51:G.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Lt==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=G.dateNF||Ue[14],G.cellDates&&(me[1].t="d",me[1].v=u0(me[1].v))),G.qpro&&me[3]>Ee&&(H["!ref"]=Xe(j),pe[re]=H,oe.push(re),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ee=me[3],re=he||"Sheet"+(Ee+1),he="");var nr=G.dense?(H[me[0].r]||[])[me[0].c]:H[Oe(me[0])];if(nr){nr.t=me[1].t,nr.v=me[1].v,me[1].z!=null&&(nr.z=me[1].z),me[1].f!=null&&(nr.f=me[1].f);break}G.dense?(H[me[0].r]||(H[me[0].r]=[]),H[me[0].r][me[0].c]=me[1]):H[Oe(me[0])]=me[1];break}},G);else if(U[2]==26||U[2]==14)G.Enum=xe,U[2]==14&&(G.qpro=!0,U.l=0),t(U,function(me,ct,Lt){switch(Lt){case 204:re=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>Ee&&(H["!ref"]=Xe(j),pe[re]=H,oe.push(re),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},Ee=me[3],re="Sheet"+(Ee+1)),De>0&&me[0].r>=De)break;G.dense?(H[me[0].r]||(H[me[0].r]=[]),H[me[0].r][me[0].c]=me[1]):H[Oe(me[0])]=me[1],j.e.c<me[0].c&&(j.e.c=me[0].c),j.e.r<me[0].r&&(j.e.r=me[0].r);break;case 27:me[14e3]&&(Re[me[14e3][0]]=me[14e3][1]);break;case 1537:Re[me[0]]=me[1],me[0]==Ee&&(re=me[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(H["!ref"]=Xe(j),pe[he||re]=H,oe.push(he||re),!Re.length)return{SheetNames:oe,Sheets:pe};for(var Be={},Je=[],Ve=0;Ve<Re.length;++Ve)pe[oe[Ve]]?(Je.push(Re[Ve]||oe[Ve]),Be[Re[Ve]]=pe[Re[Ve]]||pe[oe[Ve]]):(Je.push(Re[Ve]),Be[Re[Ve]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Be}}function n(U,J){var G=J||{};if(+G.codepage>=0&&Wn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Mp(),re=Nt(U["!ref"]),he=Array.isArray(U),Ee=[];Vn(H,0,a(1030)),Vn(H,6,l(re));for(var pe=Math.min(re.e.r,8191),oe=re.s.r;oe<=pe;++oe)for(var Re=pr(oe),j=re.s.c;j<=re.e.c;++j){oe===re.s.r&&(Ee[j]=Xt(j));var De=Ee[j]+Re,Be=he?(U[oe]||[])[j]:U[De];if(!(!Be||Be.t=="z"))if(Be.t=="n")(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?Vn(H,13,p(oe,j,Be.v)):Vn(H,14,x(oe,j,Be.v));else{var Je=qs(Be);Vn(H,15,h(oe,j,Je.slice(0,239)))}}return Vn(H,1),H.end()}function s(U,J){var G=J||{};if(+G.codepage>=0&&Wn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Mp();Vn(H,0,i(U));for(var re=0,he=0;re<U.SheetNames.length;++re)(U.Sheets[U.SheetNames[re]]||{})["!ref"]&&Vn(H,27,q(U.SheetNames[re],he++));var Ee=0;for(re=0;re<U.SheetNames.length;++re){var pe=U.Sheets[U.SheetNames[re]];if(!(!pe||!pe["!ref"])){for(var oe=Nt(pe["!ref"]),Re=Array.isArray(pe),j=[],De=Math.min(oe.e.r,8191),Be=oe.s.r;Be<=De;++Be)for(var Je=pr(Be),Ve=oe.s.c;Ve<=oe.e.c;++Ve){Be===oe.s.r&&(j[Ve]=Xt(Ve));var me=j[Ve]+Je,ct=Re?(pe[Be]||[])[Ve]:pe[me];if(!(!ct||ct.t=="z"))if(ct.t=="n")Vn(H,23,R(Be,Ve,Ee,ct.v));else{var Lt=qs(ct);Vn(H,22,w(Be,Ve,Ee,Lt.slice(0,239)))}}++Ee}}return Vn(H,1),H.end()}function a(U){var J=Gt(2);return J.write_shift(2,U),J}function i(U){var J=Gt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var G=0,H=0,re=0,he=0;he<U.SheetNames.length;++he){var Ee=U.SheetNames[he],pe=U.Sheets[Ee];if(!(!pe||!pe["!ref"])){++re;var oe=ol(pe["!ref"]);G<oe.e.r&&(G=oe.e.r),H<oe.e.c&&(H=oe.e.c)}}return G>8191&&(G=8191),J.write_shift(2,G),J.write_shift(1,re),J.write_shift(1,H),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(U,J,G){var H={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&G.qpro?(H.s.c=U.read_shift(1),U.l++,H.s.r=U.read_shift(2),H.e.c=U.read_shift(1),U.l++,H.e.r=U.read_shift(2),H):(H.s.c=U.read_shift(2),H.s.r=U.read_shift(2),J==12&&G.qpro&&(U.l+=2),H.e.c=U.read_shift(2),H.e.r=U.read_shift(2),J==12&&G.qpro&&(U.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(U){var J=Gt(8);return J.write_shift(2,U.s.c),J.write_shift(2,U.s.r),J.write_shift(2,U.e.c),J.write_shift(2,U.e.r),J}function c(U,J,G){var H=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(H[0].c=U.read_shift(1),H[3]=U.read_shift(1),H[0].r=U.read_shift(2),U.l+=2):(H[2]=U.read_shift(1),H[0].c=U.read_shift(2),H[0].r=U.read_shift(2)),H}function f(U,J,G){var H=U.l+J,re=c(U,J,G);if(re[1].t="s",G.vers==20768){U.l++;var he=U.read_shift(1);return re[1].v=U.read_shift(he,"utf8"),re}return G.qpro&&U.l++,re[1].v=U.read_shift(H-U.l,"cstr"),re}function h(U,J,G){var H=Gt(7+G.length);H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,U),H.write_shift(1,39);for(var re=0;re<H.length;++re){var he=G.charCodeAt(re);H.write_shift(1,he>=128?95:he)}return H.write_shift(1,0),H}function d(U,J,G){var H=c(U,J,G);return H[1].v=U.read_shift(2,"i"),H}function p(U,J,G){var H=Gt(7);return H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,U),H.write_shift(2,G,"i"),H}function v(U,J,G){var H=c(U,J,G);return H[1].v=U.read_shift(8,"f"),H}function x(U,J,G){var H=Gt(13);return H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,U),H.write_shift(8,G,"f"),H}function E(U,J,G){var H=U.l+J,re=c(U,J,G);if(re[1].v=U.read_shift(8,"f"),G.qpro)U.l=H;else{var he=U.read_shift(2);M(U.slice(U.l,U.l+he),re),U.l+=he}return re}function A(U,J,G){var H=J&32768;return J&=-32769,J=(H?U:0)+(J>=8192?J-16384:J),(H?"":"$")+(G?Xt(J):pr(J))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(U,J){ur(U,0);for(var G=[],H=0,re="",he="",Ee="",pe="";U.l<U.length;){var oe=U[U.l++];switch(oe){case 0:G.push(U.read_shift(8,"f"));break;case 1:he=A(J[0].c,U.read_shift(2),!0),re=A(J[0].r,U.read_shift(2),!1),G.push(he+re);break;case 2:{var Re=A(J[0].c,U.read_shift(2),!0),j=A(J[0].r,U.read_shift(2),!1);he=A(J[0].c,U.read_shift(2),!0),re=A(J[0].r,U.read_shift(2),!1),G.push(Re+j+":"+he+re)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(U.read_shift(2));break;case 6:{for(var De="";oe=U[U.l++];)De+=String.fromCharCode(oe);G.push('"'+De.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:pe=G.pop(),Ee=G.pop(),G.push(["AND","OR"][oe-20]+"("+Ee+","+pe+")");break;default:if(oe<32&&y[oe])pe=G.pop(),Ee=G.pop(),G.push(Ee+y[oe]+pe);else if(_[oe]){if(H=_[oe][1],H==69&&(H=U[U.l++]),H>G.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+G.join("|")+"|");return}var Be=G.slice(-H);G.length-=H,G.push(_[oe][0]+"("+Be.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}G.length==1?J[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function z(U){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=U.read_shift(2),J[3]=U[U.l++],J[0].c=U[U.l++],J}function B(U,J){var G=z(U);return G[1].t="s",G[1].v=U.read_shift(J-4,"cstr"),G}function w(U,J,G,H){var re=Gt(6+H.length);re.write_shift(2,U),re.write_shift(1,G),re.write_shift(1,J),re.write_shift(1,39);for(var he=0;he<H.length;++he){var Ee=H.charCodeAt(he);re.write_shift(1,Ee>=128?95:Ee)}return re.write_shift(1,0),re}function k(U,J){var G=z(U);G[1].v=U.read_shift(2);var H=G[1].v>>1;if(G[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return G[1].v=H,G}function I(U,J){var G=z(U),H=U.read_shift(4),re=U.read_shift(4),he=U.read_shift(2);if(he==65535)return H===0&&re===3221225472?(G[1].t="e",G[1].v=15):H===0&&re===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ee=he&32768;return he=(he&32767)-16446,G[1].v=(1-Ee*2)*(re*Math.pow(2,he+32)+H*Math.pow(2,he)),G}function R(U,J,G,H){var re=Gt(14);if(re.write_shift(2,U),re.write_shift(1,G),re.write_shift(1,J),H==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var he=0,Ee=0,pe=0,oe=0;return H<0&&(he=1,H=-H),Ee=Math.log2(H)|0,H/=Math.pow(2,Ee-31),oe=H>>>0,oe&2147483648||(H/=2,++Ee,oe=H>>>0),H-=oe,oe|=2147483648,oe>>>=0,H*=Math.pow(2,32),pe=H>>>0,re.write_shift(4,pe),re.write_shift(4,oe),Ee+=16383+(he?32768:0),re.write_shift(2,Ee),re}function F(U,J){var G=I(U);return U.l+=J-14,G}function O(U,J){var G=z(U),H=U.read_shift(4);return G[1].v=H>>6,G}function L(U,J){var G=z(U),H=U.read_shift(8,"f");return G[1].v=H,G}function ye(U,J){var G=L(U);return U.l+=J-10,G}function de(U,J){return U[U.l+J-1]==0?U.read_shift(J,"cstr"):""}function Ae(U,J){var G=U[U.l++];G>J-1&&(G=J-1);for(var H="";H.length<G;)H+=String.fromCharCode(U[U.l++]);return H}function ve(U,J,G){if(!(!G.qpro||J<21)){var H=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var re=U.read_shift(J-21,"cstr");return[H,re]}}function ie(U,J){for(var G={},H=U.l+J;U.l<H;){var re=U.read_shift(2);if(re==14e3){for(G[re]=[0,""],G[re][0]=U.read_shift(2);U[U.l];)G[re][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return G}function q(U,J){var G=Gt(5+U.length);G.write_shift(2,14e3),G.write_shift(2,J);for(var H=0;H<U.length;++H){var re=U.charCodeAt(H);G[G.l++]=re>127?95:re}return G[G.l++]=0,G}var ue={0:{n:"BOF",f:jt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function vD(t){var e={},r=t.match(br),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Pe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=vg[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var yD=function(){var t=Bc("t"),e=Bc("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:Qe(i[1])},l=a.match(e);return l&&(o.s=vD(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),_D=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),ED=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wD=/<(?:\w+:)?r>/,TD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Og(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qe(lt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=lt(t),r&&(n.h=Sg(n.t))):t.match(wD)&&(n.r=lt(t),n.t=Qe(lt((t.replace(TD,"").match(ED)||[]).join("").replace(br,""))),r&&(n.h=_D(yD(n.r)))),n):{t:""}}var AD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SD=/<(?:\w+:)?(?:si|sstItem)>/g,kD=/<\/(?:\w+:)?(?:si|sstItem)>/;function ID(t,e){var r=[],n="";if(!t)return r;var s=t.match(AD);if(s){n=s[2].replace(SD,"").split(kD);for(var a=0;a!=n.length;++a){var i=Og(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=Pe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function CD(t){return[t.read_shift(4),t.read_shift(4)]}function ND(t,e){var r=[],n=!1;return Zs(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function HT(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Bs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function RD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Bs(t,4),e.U=Bs(t,4),e.W=Bs(t,4),e}function PD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function DD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(PD(t));return e}function bD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function FD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Bs(t,4),e.U=Bs(t,4),e.W=Bs(t,4),e}function OD(t){var e=FD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function WT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function GT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function LD(t){var e=Bs(t);switch(e.Minor){case 2:return[e.Minor,MD(t)];case 3:return[e.Minor,VD()];case 4:return[e.Minor,UD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function MD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=WT(t,r),s=GT(t,t.length-t.l);return{t:"Std",h:n,v:s}}function VD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function UD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(br,function(a){var i=Pe(a);switch(As(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function BD(t,e){var r={},n=r.EncryptionVersionInfo=Bs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=WT(t,s),e-=s,r.EncryptionVerifier=GT(t,e),r}function jD(t){var e={},r=e.EncryptionVersionInfo=Bs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function $D(t){var e=0,r,n=HT(t),s=n.length+1,a,i,o,l,c;for(r=Ba(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^i;return e^52811}var qT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=HT(i),l=a(o),c=o.length,f=Ba(16),h=0;h!=16;++h)f[h]=0;var d,p,v;for((c&1)===1&&(d=l>>8,f[c]=s(t[0],d),--c,d=l&255,p=o[o.length-1],f[c]=s(p,d));c>0;)--c,d=l>>8,f[c]=s(o[c],d),--c,d=l&255,f[c]=s(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,f[c]=s(t[v],d),--c,--v,d=l&255,f[c]=s(o[c],d),--c,--v;return f}}(),zD=function(t,e,r,n,s){s||(s=e),n||(n=qT(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},HD=function(t){var e=0,r=qT(t);return function(n){var s=zD("",n,e,r);return e=s[1],s[0]}};function WD(t,e,r,n){var s={key:jt(t),verificationBytes:jt(t)};return r.password&&(s.verifier=$D(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=HD(r.password)),s}function GD(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=jD(t):n.Data=BD(t,e),n}function qD(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?GD(t,e-2,n):WD(t,r.biff>=8?e:e-2,r,n),n}var KD=function(){function t(s,a){switch(a.type){case"base64":return e(dn(s),a);case"binary":return e(s,a);case"buffer":return e(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Bi(s),a);case"array":return e(Ni(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,v,x=-1;v=d.exec(f);){switch(v[0]){case"\\cell":var E=f.slice(p,d.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var A={v:E,t:"s"};Array.isArray(o)?o[h][x]=A:o[Oe({r:h,c:x})]=A}break}p=d.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=Xe(c),o}function r(s,a){return Ja(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Nt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Oe({r:c,c:f});o=l?(s[c]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(qs(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function XD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function zc(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function YD(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,c/2]}function QD(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Eh(t,e){if(e===0)return t;var r=YD(XD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),zc(QD(r))}var KT=6,JD=15,ZD=1,Ur=KT;function wh(t){return Math.floor((t+Math.round(128/Ur)/256)*Ur)}function Th(t){return Math.floor((t-5)/Ur*100+.5)/100}function jp(t){return Math.round((t*Ur+5)/Ur*256)/256}function wd(t){return jp(Th(wh(t)))}function Lg(t){var e=Math.abs(t-wd(t)),r=Ur;if(e>.005)for(Ur=ZD;Ur<JD;++Ur)Math.abs(t-wd(t))<=e&&(e=Math.abs(t-wd(t)),r=Ur);Ur=r}function Xo(t){t.width?(t.wpx=wh(t.width),t.wch=Th(t.wpx),t.MDW=Ur):t.wpx?(t.wch=Th(t.wpx),t.width=jp(t.wch),t.MDW=Ur):typeof t.wch=="number"&&(t.width=jp(t.wch),t.wpx=wh(t.width),t.MDW=Ur),t.customWidth&&delete t.customWidth}var eb=96,XT=eb;function YT(t){return t*96/XT}function Hc(t){return t*XT/96}var tb={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rb(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(br)||[]).forEach(function(i){var o=Pe(i);switch(As(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=vt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=vt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function nb(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(br)||[]).forEach(function(i){var o=Pe(i);switch(As(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function sb(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(br)||[]).forEach(function(i){var o=Pe(i);switch(As(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=lt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?vt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?vt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?vt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?vt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?vt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?vt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?vt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=vg[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=vt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Ei[s.color.index];s.color.index==81&&(l=Ei[1]),l||(l=Ei[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Eh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function ab(t,e,r){e.NumberFmt=[];for(var n=Es(Ue),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Ue[n[s]];var a=t[0].match(br);if(a)for(s=0;s<a.length;++s){var i=Pe(a[s]);switch(As(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Qe(lt(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}_i(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var of=["numFmtId","fillId","fontId","borderId","xfId"],lf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ib(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(br)||[]).forEach(function(a){var i=Pe(a),o=0;switch(As(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<of.length;++o)n[of[o]]&&(n[of[o]]=parseInt(n[of[o]],10));for(o=0;o<lf.length;++o)n[lf[o]]&&(n[lf[o]]=vt(n[lf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=vt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var ob=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&ab(h,f,c),(h=o.match(s))&&sb(h,f,l,c),(h=o.match(n))&&nb(h,f,l,c),(h=o.match(a))&&rb(h,f,l,c),(h=o.match(r))&&ib(h,f,c),f}}();function lb(t,e){var r=t.read_shift(2),n=Nr(t);return[r,n]}function cb(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=yP(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=vP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Nr(t),n}var ub=Pr;function fb(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var hb=Pr;function db(t,e,r){var n={};n.NumberFmt=[];for(var s in Ue)n.NumberFmt[s]=Ue[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Zs(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],_i(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Eh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(f);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var pb=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mb(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(br)||[]).forEach(function(s){var a=Pe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[pb.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function gb(){}function xb(){}var vb=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,yb=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_b=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Eb(t,e,r){e.themeElements={};var n;[["clrScheme",vb,mb],["fontScheme",yb,gb],["fmtScheme",_b,xb]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var wb=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function QT(t,e){(!t||t.length===0)&&(t=Tb());var r,n={};if(!(r=t.match(wb)))throw new Error("themeElements not found in theme");return Eb(r[0],n,e),n.raw=t,n}function Tb(t,e){var r=[lT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ab(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=oT(a,{type:"array"})}catch{return}var o=on(i,"theme/theme/theme1.xml",!0);if(o)return QT(o,r)}}function Sb(t){return t.read_shift(4)}function kb(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Ib(t,4);break;case 2:e.xclrValue=MT(t);break;case 3:e.xclrValue=Sb(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Ib(t,e){return Pr(t,e)}function Cb(t,e){return Pr(t,e)}function Nb(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=kb(t);break;case 6:n[1]=Cb(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Rb(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(Nb(t,r-t.l));return{ixfe:n,ext:a}}function Pb(t,e){e.forEach(function(r){switch(r[0]){}})}function Db(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Nr(t)}}function bb(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Fb(t){return t.l+=4,t.read_shift(4)!=0}function Ob(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Zs(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Lb(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(br,function(o){var l=Pe(o);switch(As(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Mb(t){var e=[];if(!t)return e;var r=1;return(t.match(br)||[]).forEach(function(n){var s=Pe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function Vb(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Oe(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Ub(t,e,r){var n=[];return Zs(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Bb(t,e,r,n){if(!t)return t;var s=n||{},a=!1;Zs(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function jb(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function Ey(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=Br(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=Nt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Xe(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}a.c.push(f)})}function $b(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Pe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Br(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Og(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function zb(t,e){var r=[],n=!1,s={},a=0;return t.replace(br,function(o,l){var c=Pe(o);switch(As(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Hb(t,e){var r=[],n=!1;return t.replace(br,function(a){var i=Pe(a);switch(As(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function Wb(t){var e={};e.iauthor=t.read_shift(4);var r=$i(t);return e.rfx=r.s,e.ref=Oe(r.s),t.l+=16,e}var Gb=Nr;function qb(t,e){var r=[],n=[],s={},a=!1;return Zs(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Kb="application/vnd.ms-office.vbaProject";function Xb(t){var e=Ke.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ke.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Ke.write(e)}function Yb(){return{"!type":"dialog"}}function Qb(){return{"!type":"dialog"}}function Jb(){return{"!type":"macro"}}function Zb(){return{"!type":"macro"}}var Fo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,s+(o?"":"$")+Xt(f)+(l?"":"$")+pr(c)}return function(s,a){return e=a,s.replace(t,r)}}(),JT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eF=function(){return function(e,r){return e.replace(JT,function(n,s,a,i,o,l){var c=Ng(i)-(a?0:r.c),f=Cg(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":a?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function ZT(t,e){return t.replace(JT,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Xt(Ng(a)+e.c))+(i=="$"?i+o:pr(Cg(o)+e.r))})}function tF(t,e,r){var n=ol(e),s=n.s,a=Br(r),i={r:a.r-s.r,c:a.c-s.c};return ZT(t,i)}function rF(t){return t.length!=1}function wy(t){return t.replace(/_xlfn\./g,"")}function Vt(t){t.l+=1}function ja(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function eA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tA(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=ja(t),o=ja(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function tA(t){var e=ja(t),r=ja(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function nF(t,e,r){if(r.biff<8)return tA(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=ja(t),i=ja(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function rA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return sF(t);var n=t.read_shift(r&&r.biff==12?4:2),s=ja(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function sF(t){var e=ja(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function aF(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iF(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return oF(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function oF(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function lF(t,e,r){var n=(t[t.l++]&96)>>5,s=eA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function cF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=eA(t,a,r);return[n,s,i]}function uF(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function hF(t,e,r){var n=(t[t.l++]&96)>>5,s=nF(t,e-1,r);return[n,s]}function dF(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ty(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function pF(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function mF(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function gF(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function xF(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function vF(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function nA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function yF(t){return t.read_shift(2),nA(t)}function _F(t){return t.read_shift(2),nA(t)}function EF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=rA(t,0,r);return[n,s]}function wF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=iF(t,0,r);return[n,s]}function TF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=rA(t,0,r);return[n,s,a]}function AF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[SO[s],iA[s],n]}function SF(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:kF(t);return[s,(a[0]===0?iA:AO)[a[1]]]}function kF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function IF(t,e,r){t.l+=r&&r.biff==2?3:4}function CF(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function NF(t){return t.l++,zi[t.read_shift(1)]}function RF(t){return t.l++,t.read_shift(2)}function PF(t){return t.l++,t.read_shift(1)!==0}function DF(t){return t.l++,Ir(t)}function bF(t,e,r){return t.l++,lu(t,e-1,r)}function FF(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=zi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ir(t);break;case 2:r[1]=Hi(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OF(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?$i:f0)(t));return s}function LF(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=FF(t,r.biff);return i}function MF(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function VF(t,e,r){if(r.biff==5)return UF(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function UF(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function BF(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function jF(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function $F(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function zF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var HF=Pr,WF=Pr,GF=Pr;function uu(t,e,r){return t.l+=2,[aF(t)]}function Mg(t){return t.l+=6,[]}var qF=uu,KF=Mg,XF=Mg,YF=uu;function sA(t){return t.l+=2,[jt(t),t.read_shift(2)&1]}var QF=uu,JF=sA,ZF=Mg,eO=uu,tO=uu,rO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nO(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=rO[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function sO(t){return t.l+=2,[t.read_shift(4)]}function aO(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function iO(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oO(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lO(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function cO(t){return t.l+=4,[0,0]}var Ay={1:{n:"PtgExp",f:CF},2:{n:"PtgTbl",f:GF},3:{n:"PtgAdd",f:Vt},4:{n:"PtgSub",f:Vt},5:{n:"PtgMul",f:Vt},6:{n:"PtgDiv",f:Vt},7:{n:"PtgPower",f:Vt},8:{n:"PtgConcat",f:Vt},9:{n:"PtgLt",f:Vt},10:{n:"PtgLe",f:Vt},11:{n:"PtgEq",f:Vt},12:{n:"PtgGe",f:Vt},13:{n:"PtgGt",f:Vt},14:{n:"PtgNe",f:Vt},15:{n:"PtgIsect",f:Vt},16:{n:"PtgUnion",f:Vt},17:{n:"PtgRange",f:Vt},18:{n:"PtgUplus",f:Vt},19:{n:"PtgUminus",f:Vt},20:{n:"PtgPercent",f:Vt},21:{n:"PtgParen",f:Vt},22:{n:"PtgMissArg",f:Vt},23:{n:"PtgStr",f:bF},26:{n:"PtgSheet",f:aO},27:{n:"PtgEndSheet",f:iO},28:{n:"PtgErr",f:NF},29:{n:"PtgBool",f:PF},30:{n:"PtgInt",f:RF},31:{n:"PtgNum",f:DF},32:{n:"PtgArray",f:dF},33:{n:"PtgFunc",f:AF},34:{n:"PtgFuncVar",f:SF},35:{n:"PtgName",f:MF},36:{n:"PtgRef",f:EF},37:{n:"PtgArea",f:lF},38:{n:"PtgMemArea",f:BF},39:{n:"PtgMemErr",f:HF},40:{n:"PtgMemNoMem",f:WF},41:{n:"PtgMemFunc",f:jF},42:{n:"PtgRefErr",f:$F},43:{n:"PtgAreaErr",f:uF},44:{n:"PtgRefN",f:wF},45:{n:"PtgAreaN",f:hF},46:{n:"PtgMemAreaN",f:oO},47:{n:"PtgMemNoMemN",f:lO},57:{n:"PtgNameX",f:VF},58:{n:"PtgRef3d",f:TF},59:{n:"PtgArea3d",f:cF},60:{n:"PtgRefErr3d",f:zF},61:{n:"PtgAreaErr3d",f:fF},255:{}},uO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fO={1:{n:"PtgElfLel",f:sA},2:{n:"PtgElfRw",f:eO},3:{n:"PtgElfCol",f:qF},6:{n:"PtgElfRwV",f:tO},7:{n:"PtgElfColV",f:YF},10:{n:"PtgElfRadical",f:QF},11:{n:"PtgElfRadicalS",f:ZF},13:{n:"PtgElfColS",f:KF},15:{n:"PtgElfColSV",f:XF},16:{n:"PtgElfRadicalLel",f:JF},25:{n:"PtgList",f:nO},29:{n:"PtgSxName",f:sO},255:{}},hO={0:{n:"PtgAttrNoop",f:cO},1:{n:"PtgAttrSemi",f:vF},2:{n:"PtgAttrIf",f:gF},4:{n:"PtgAttrChoose",f:pF},8:{n:"PtgAttrGoto",f:mF},16:{n:"PtgAttrSum",f:IF},32:{n:"PtgAttrBaxcel",f:Ty},33:{n:"PtgAttrBaxcel",f:Ty},64:{n:"PtgAttrSpace",f:yF},65:{n:"PtgAttrSpaceSemi",f:_F},128:{n:"PtgAttrIfError",f:xF},255:{}};function fu(t,e,r,n){if(n.biff<8)return Pr(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=LF(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=OF(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Pr(t,e)),a}function hu(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=Ay[a]||Ay[uO[a]],(a===24||a===25)&&(s=(a===24?fO:hO)[t[t.l+1]]),!s||!s.f?Pr(t,e):i.push([s.n,s.f(t,e,r)]);return i}function dO(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var pO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mO(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function aA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sy(t,e,r){var n=aA(t,e,r);return n=="#REF"?n:mO(n,r)}function Ar(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,p,v="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",A=0,_=t[0].length;A<_;++A){var y=t[0][A];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Ct(" ",t[0][x][1][1]);break;case 1:E=Ct("\r",t[0][x][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+pO[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=ic(y[1][1],i,s),o.push(oc(f,a));break;case"PtgRefN":f=r?ic(y[1][1],r,s):y[1][1],o.push(oc(f,a));break;case"PtgRef3d":h=y[1][1],f=ic(y[1][2],i,s),v=Sy(n,h,s),o.push(v+"!"+oc(f,a));break;case"PtgFunc":case"PtgFuncVar":var M=y[1][0],z=y[1][1];M||(M=0),M&=127;var B=M==0?[]:o.slice(-M);o.length-=M,z==="User"&&(z=B.shift()),o.push(z+"("+B.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=ay(y[1][1],r?{s:r}:i,s),o.push(_d(p,s));break;case"PtgArea":p=ay(y[1][1],i,s),o.push(_d(p,s));break;case"PtgArea3d":h=y[1][1],p=y[1][2],v=Sy(n,h,s),o.push(v+"!"+_d(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var w=(n.names||[])[d-1]||(n[0]||[])[d],k=w?w.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!s.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var I=y[1][1];d=y[1][2];var R;if(s.biff<=5)I<0&&(I=-I),n[I]&&(R=n[I][d]);else{var F="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][d]&&n[I][d].itab>0&&(F=n.SheetNames[n[I][d].itab-1]+"!"):F=n.SheetNames[d-1]+"!"),n[I]&&n[I][d])F+=n[I][d].Name;else if(n[0]&&n[0][d])F+=n[0][d].Name;else{var O=(aA(n,I,s)||"").split(";;");O[d-1]?F=O[d-1]:F+="SH33TJSERRX"}o.push(F);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var L="(",ye=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:L=Ct(" ",t[0][x][1][1])+L;break;case 3:L=Ct("\r",t[0][x][1][1])+L;break;case 4:ye=Ct(" ",t[0][x][1][1])+ye;break;case 5:ye=Ct("\r",t[0][x][1][1])+ye;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(L+o.pop()+ye);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[Oe(f)]){var Ae=n.sharedf[Oe(f)];o.push(Ar(Ae,i,de,n,s))}else{var ve=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Ar(c[1],i,de,n,s)),ve=!0;break}ve||o.push(y[1])}break;case"PtgArray":o.push("{"+dO(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&ie.indexOf(t[0][A][0])==-1){y=t[0][x];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:E=Ct(" ",y[1][1]);break;case 5:q=!1;case 1:E=Ct("\r",y[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((q?E:"")+o.pop()+(q?"":E)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function gO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Pr(t,e-2)];var o=hu(t,i,r);return e!==i+s&&(a=fu(t,e-i-s,o,r)),t.l=n,[o,a]}function xO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Pr(t,e-2)];var o=hu(t,i,r);return e!==i+s&&(a=fu(t,e-i-s,o,r)),t.l=n,[o,a]}function vO(t,e,r,n){var s=t.l+e,a=hu(t,n,r),i;return s!==t.l&&(i=fu(t,s-t.l,a,r)),[a,i]}function yO(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=hu(t,a,r);return a==65535?[[],Pr(t,e-2)]:(e!==a+2&&(s=fu(t,n-a-2,i,r)),[i,s])}function _O(t){var e;if(Os(t,t.l+6)!==65535)return[Ir(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Td(t,e,r){var n=t.l+e,s=Ss(t);r.biff==2&&++t.l;var a=_O(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=xO(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function h0(t,e,r){var n=t.read_shift(4),s=hu(t,n,r),a=t.read_shift(4),i=a>0?fu(t,a,s,r):null;return[s,i]}var EO=h0,d0=h0,wO=h0,TO=h0,AO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},SO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ky(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Ad(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var fc={},Oo={};function hc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function oA(t,e,r,n,s,a){try{n.cellNF&&(t.z=Ue[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=rr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ue[e]==null&&_i(kR[e]||"General",e),t.t==="e")t.w=t.w||zi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uc(t.v);else if(t.t==="d"){var i=zr(t.v);(i|0)===i?t.w=i.toString(10):t.w=Uc(i)}else{if(t.v===void 0)return"";t.w=Ci(t.v,Oo)}else t.t==="d"?t.w=Rn(e,zr(t.v),Oo):t.w=Rn(e,t.v,Oo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Eh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Eh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function kO(t,e){var r=Nt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Xe(r))}var IO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,CO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NO=/<(?:\w:)?hyperlink [^>]*>/mg,RO=/"(\w*:\w*)"/,PO=/<(?:\w:)?col\b[^>]*[\/]?>/g,DO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bO=/<(?:\w:)?pageMargins[^>]*\/>/g,lA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,FO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function LO(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(CO);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(lA);d?Vg(d[0],o,s,r):(d=c.match(FO))&&MO(d[0],d[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match(RO);v&&kO(o,v[1])}var x=c.match(OO);x&&x[1]&&zO(x[1],s);var E=[];if(e.cellStyles){var A=c.match(PO);A&&BO(E,A)}h&&HO(h[1],o,e,l,a,i);var _=f.match(DO);_&&(o["!autofilter"]=jO(_[0]));var y=[],M=f.match(IO);if(M)for(p=0;p!=M.length;++p)y[p]=Nt(M[p].slice(M[p].indexOf('"')+1));var z=f.match(NO);z&&VO(o,z,n);var B=f.match(bO);if(B&&(o["!margins"]=UO(Pe(B[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Xe(l)),e.sheetRows>0&&o["!ref"]){var w=Nt(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xe(w))}return E.length>0&&(o["!cols"]=E),y.length>0&&(o["!merges"]=y),o}function Vg(t,e,r,n){var s=Pe(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Qe(lt(s.codeName)))}function MO(t,e,r,n,s){Vg(t.slice(0,t.indexOf(">")),r,n,s)}function VO(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Pe(lt(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Qe(a.location))):(a.Target="#"+Qe(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Nt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Oe({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=a)}}}function UO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function BO(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Pe(e[n],!0);s.hidden&&(s.hidden=vt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Lg(s.width)),Xo(s);a<=i;)t[a++]=dr(s)}}function jO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var $O=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function zO(t,e){e.Views||(e.Views=[{}]),(t.match($O)||[]).forEach(function(r,n){var s=Pe(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),vt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var HO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Bc("v"),i=Bc("f");return function(l,c,f,h,d,p){for(var v=0,x="",E=[],A=[],_=0,y=0,M=0,z="",B,w,k=0,I=0,R,F,O=0,L=0,ye=Array.isArray(p.CellXf),de,Ae=[],ve=[],ie=Array.isArray(c),q=[],ue={},xe=!1,U=!!f.sheetStubs,J=l.split(e),G=0,H=J.length;G!=H;++G){x=J[G].trim();var re=x.length;if(re!==0){var he=0;e:for(v=0;v<re;++v)switch(x[v]){case">":if(x[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(w=Pe(x.slice(he,v),!0),k=w.r!=null?parseInt(w.r,10):k+1,I=-1,f.sheetRows&&f.sheetRows<k)continue;ue={},xe=!1,w.ht&&(xe=!0,ue.hpt=parseFloat(w.ht),ue.hpx=Hc(ue.hpt)),w.hidden=="1"&&(xe=!0,ue.hidden=!0),w.outlineLevel!=null&&(xe=!0,ue.level=+w.outlineLevel),xe&&(q[k-1]=ue)}break;case"<":he=v;break}if(he>=v)break;if(w=Pe(x.slice(he,v),!0),k=w.r!=null?parseInt(w.r,10):k+1,I=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(ue={},xe=!1,w.ht&&(xe=!0,ue.hpt=parseFloat(w.ht),ue.hpx=Hc(ue.hpt)),w.hidden=="1"&&(xe=!0,ue.hidden=!0),w.outlineLevel!=null&&(xe=!0,ue.level=+w.outlineLevel),xe&&(q[k-1]=ue)),E=x.slice(v).split(t);for(var Ee=0;Ee!=E.length&&E[Ee].trim().charAt(0)=="<";++Ee);for(E=E.slice(Ee),v=0;v!=E.length;++v)if(x=E[v].trim(),x.length!==0){if(A=x.match(r),_=v,y=0,M=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(_=0,z=A[1],y=0;y!=z.length&&!((M=z.charCodeAt(y)-64)<1||M>26);++y)_=26*_+M;--_,I=_}else++I;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,w=Pe(x.slice(0,y),!0),w.r||(w.r=Oe({r:k-1,c:I})),z=x.slice(y),B={t:""},(A=z.match(a))!=null&&A[1]!==""&&(B.v=Qe(A[1])),f.cellFormula){if((A=z.match(i))!=null&&A[1]!==""){if(B.f=Qe(lt(A[1])).replace(/\r\n/g,`
`),f.xlfn||(B.f=wy(B.f)),A[0].indexOf('t="array"')>-1)B.F=(z.match(s)||[])[1],B.F.indexOf(":")>-1&&Ae.push([Nt(B.F),B.F]);else if(A[0].indexOf('t="shared"')>-1){F=Pe(A[0]);var pe=Qe(lt(A[1]));f.xlfn||(pe=wy(pe)),ve[parseInt(F.si,10)]=[F,pe,w.r]}}else(A=z.match(/<f[^>]*\/>/))&&(F=Pe(A[0]),ve[F.si]&&(B.f=tF(ve[F.si][1],ve[F.si][2],w.r)));var oe=Br(w.r);for(y=0;y<Ae.length;++y)oe.r>=Ae[y][0].s.r&&oe.r<=Ae[y][0].e.r&&oe.c>=Ae[y][0].s.c&&oe.c<=Ae[y][0].e.c&&(B.F=Ae[y][1])}if(w.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(U)B.t="z";else continue;else B.t=w.t||"n";switch(h.s.c>I&&(h.s.c=I),h.e.c<I&&(h.e.c=I),B.t){case"n":if(B.v==""||B.v==null){if(!U)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!U)continue;B.t="z"}else R=fc[parseInt(B.v,10)],B.v=R.t,B.r=R.r,f.cellHTML&&(B.h=R.h);break;case"str":B.t="s",B.v=B.v!=null?lt(B.v):"",f.cellHTML&&(B.h=Sg(B.v));break;case"inlineStr":A=z.match(n),B.t="s",A!=null&&(R=Og(A[1]))?(B.v=R.t,f.cellHTML&&(B.h=R.h)):B.v="";break;case"b":B.v=vt(B.v);break;case"d":f.cellDates?B.v=rr(B.v,1):(B.v=zr(rr(B.v,1)),B.t="n");break;case"e":(!f||f.cellText!==!1)&&(B.w=B.v),B.v=NT[B.v];break}if(O=L=0,de=null,ye&&w.s!==void 0&&(de=p.CellXf[w.s],de!=null&&(de.numFmtId!=null&&(O=de.numFmtId),f.cellStyles&&de.fillId!=null&&(L=de.fillId))),oA(B,O,L,f,d,p),f.cellDates&&ye&&B.t=="n"&&il(Ue[O])&&(B.t="d",B.v=u0(B.v)),w.cm&&f.xlmeta){var Re=(f.xlmeta.Cell||[])[+w.cm-1];Re&&Re.type=="XLDAPR"&&(B.D=!0)}if(ie){var j=Br(w.r);c[j.r]||(c[j.r]=[]),c[j.r][j.c]=B}else c[w.r]=B}}}}q.length>0&&(c["!rows"]=q)}}();function WO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var GO=$i;function qO(){}function KO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=gP(t),r}function XO(t){var e=Pn(t);return[e]}function YO(t){var e=ji(t);return[e]}function QO(t){var e=Pn(t),r=t.read_shift(1);return[e,r,"b"]}function JO(t){var e=ji(t),r=t.read_shift(1);return[e,r,"b"]}function ZO(t){var e=Pn(t),r=t.read_shift(1);return[e,r,"e"]}function e6(t){var e=ji(t),r=t.read_shift(1);return[e,r,"e"]}function t6(t){var e=Pn(t),r=t.read_shift(4);return[e,r,"s"]}function r6(t){var e=ji(t),r=t.read_shift(4);return[e,r,"s"]}function n6(t){var e=Pn(t),r=Ir(t);return[e,r,"n"]}function cA(t){var e=ji(t),r=Ir(t);return[e,r,"n"]}function s6(t){var e=Pn(t),r=Dg(t);return[e,r,"n"]}function a6(t){var e=ji(t),r=Dg(t);return[e,r,"n"]}function i6(t){var e=Pn(t),r=Rg(t);return[e,r,"is"]}function o6(t){var e=Pn(t),r=Nr(t);return[e,r,"str"]}function l6(t){var e=ji(t),r=Nr(t);return[e,r,"str"]}function c6(t,e,r){var n=t.l+e,s=Pn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=d0(t,n-t.l,r);i[3]=Ar(o,null,s,r.supbooks,r)}else t.l=n;return i}function u6(t,e,r){var n=t.l+e,s=Pn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=d0(t,n-t.l,r);i[3]=Ar(o,null,s,r.supbooks,r)}else t.l=n;return i}function f6(t,e,r){var n=t.l+e,s=Pn(t);s.r=r["!row"];var a=Ir(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=d0(t,n-t.l,r);i[3]=Ar(o,null,s,r.supbooks,r)}else t.l=n;return i}function h6(t,e,r){var n=t.l+e,s=Pn(t);s.r=r["!row"];var a=Nr(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=d0(t,n-t.l,r);i[3]=Ar(o,null,s,r.supbooks,r)}else t.l=n;return i}var d6=$i;function p6(t,e){var r=t.l+e,n=$i(t),s=Pg(t),a=Nr(t),i=Nr(t),o=Nr(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function m6(){}function g6(t,e,r){var n=t.l+e,s=kT(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=EO(t,n-t.l,r);i[1]=o}else t.l=n;return i}function x6(t,e,r){var n=t.l+e,s=$i(t),a=[s];if(r.cellFormula){var i=TO(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}var v6=["left","right","top","bottom","header","footer"];function y6(t){var e={};return v6.forEach(function(r){e[r]=Ir(t)}),e}function _6(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function E6(){}function w6(){}function T6(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,v,x,E,A,_,y,M,z,B=[];o.biff=12,o["!row"]=0;var w=0,k=!1,I=[],R={},F=o.supbooks||s.supbooks||[[]];if(F.sharedf=R,F.arrayf=I,F.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=F,s.Names))for(var O=0;O<s.Names.length;++O)F[0][O+1]=s.Names[O];var L=[],ye=[],de=!1;Ah[16]={n:"BrtShortReal",f:cA};var Ae;if(Zs(t,function(q,ue,xe){if(!d)switch(xe){case 148:c=q;break;case 0:p=q,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),M=pr(E=p.r),o["!row"]=p.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Hc(q.hpt)),ye[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:q[2]},q[2]){case"n":v.v=q[1];break;case"s":y=fc[q[1]],v.v=y.t,v.r=y.r;break;case"b":v.v=!!q[1];break;case"e":v.v=q[1],o.cellText!==!1&&(v.w=zi[v.v]);break;case"str":v.t="s",v.v=q[1];break;case"is":v.t="s",v.v=q[1].t;break}if((x=i.CellXf[q[0].iStyleRef])&&oA(v,x.numFmtId,null,o,a,i),A=q[0].c==-1?A+1:q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][A]=v):l[Xt(A)+M]=v,o.cellFormula){for(k=!1,w=0;w<I.length;++w){var U=I[w];p.r>=U[0].s.r&&p.r<=U[0].e.r&&A>=U[0].s.c&&A<=U[0].e.c&&(v.F=Xe(U[0]),k=!0)}!k&&q.length>3&&(v.f=q[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>A&&(f.s.c=A),f.e.r<p.r&&(f.e.r=p.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&v.t=="n"&&il(Ue[x.numFmtId])){var J=mi(v.v);J&&(v.t="d",v.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Ae&&(Ae.type=="XLDAPR"&&(v.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},A=q[0].c==-1?A+1:q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][A]=v):l[Xt(A)+M]=v,f.s.r>p.r&&(f.s.r=p.r),f.s.c>A&&(f.s.c=A),f.e.r<p.r&&(f.e.r=p.r),f.e.c<A&&(f.e.c=A),Ae&&(Ae.type=="XLDAPR"&&(v.D=!0),Ae=void 0);break;case 176:B.push(q);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var G=n["!id"][q.relId];for(G?(q.Target=G.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=G):q.relId==""&&(q.Target="#"+q.loc),E=q.rfx.s.r;E<=q.rfx.e.r;++E)for(A=q.rfx.s.c;A<=q.rfx.e.c;++A)o.dense?(l[E]||(l[E]=[]),l[E][A]||(l[E][A]={t:"z",v:void 0}),l[E][A].l=q):(_=Oe({c:A,r:E}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=q);break;case 426:if(!o.cellFormula)break;I.push(q),z=o.dense?l[E][A]:l[Xt(A)+M],z.f=Ar(q[1],f,{r:p.r,c:A},F,o),z.F=Xe(q[0]);break;case 427:if(!o.cellFormula)break;R[Oe(q[0].s)]=q[1],z=o.dense?l[E][A]:l[Xt(A)+M],z.f=Ar(q[1],f,{r:p.r,c:A},F,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)L[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},de||(de=!0,Lg(q.w/256)),Xo(L[q.e+1]);break;case 161:l["!autofilter"]={ref:Xe(q)};break;case 476:l["!margins"]=q;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),q.name&&(s.Sheets[r].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),q.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Xe(c||f)),o.sheetRows&&l["!ref"]){var ve=Nt(l["!ref"]);o.sheetRows<=+ve.e.r&&(ve.e.r=o.sheetRows-1,ve.e.r>f.e.r&&(ve.e.r=f.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>f.e.c&&(ve.e.c=f.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xe(ve))}return B.length>0&&(l["!merges"]=B),L.length>0&&(l["!cols"]=L),ye.length>0&&(l["!rows"]=ye),l}function A6(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=Qe((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function S6(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=A6(h);f.s.r=f.s.c=0,f.e.c=o,c=Xt(o),d[0].forEach(function(p,v){i[c+pr(v)]={t:"n",v:p,z:d[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Xe(f)),i}function k6(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(lA);return o&&Vg(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function I6(t,e){t.l+=10;var r=Nr(t);return{name:r}}function C6(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Zs(t,function(l,c,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var uA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],N6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],R6=[],P6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Iy(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=vt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Cy(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=vt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function fA(t){Cy(t.WBProps,uA),Cy(t.CalcPr,P6),Iy(t.WBView,N6),Iy(t.Sheets,R6),Oo.date1904=vt(t.WBProps.date1904)}var D6="][*?/\\".split("");function b6(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return D6.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var F6=/<\w+:workbook/;function O6(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(br,function(l,c){var f=Pe(l);switch(As(f[0])){case"<?xml":break;case"<workbook":l.match(F6)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uA.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=vt(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=lt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Qe(lt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=lt(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),vt(f.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=Qe(lt(t.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),ZR.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return fA(r),r}function L6(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Vp(t),r.name=Nr(t),r}function M6(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Nr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function V6(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function U6(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=xP(t),i=wO(t,0,r),o=Pg(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function B6(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ah[16]={n:"BrtFRTArchID$",f:V6},Zs(t,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Ar(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),fA(r),r.Names=a,r.supbooks=i,r}function j6(t,e,r){return e.slice(-4)===".bin"?B6(t,r):O6(t,r)}function $6(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?T6(t,n,r,s,a,i,o):LO(t,n,r,s,a,i,o)}function z6(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?C6(t,n,r,s,a):k6(t,n,r,s,a)}function H6(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Jb():Zb()}function W6(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Yb():Qb()}function G6(t,e,r,n){return e.slice(-4)===".bin"?db(t,r,n):ob(t,r,n)}function q6(t,e,r){return QT(t,r)}function K6(t,e,r){return e.slice(-4)===".bin"?ND(t,r):ID(t,r)}function X6(t,e,r){return e.slice(-4)===".bin"?qb(t,r):$b(t,r)}function Y6(t,e,r){return e.slice(-4)===".bin"?Ub(t):Mb(t)}function Q6(t,e,r,n){return r.slice(-4)===".bin"?Bb(t,e,r,n):void 0}function J6(t,e,r){return e.slice(-4)===".bin"?Ob(t,e,r):Lb(t,e,r)}var hA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(hA),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(dA),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Z6(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(hA),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(dA),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var dc;function eL(t,e){var r=dc[t]||Qe(t);return r==="General"?Ci(e):Rn(r,e)}function tL(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=vt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Qe(e)]=s}function rL(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||zi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uc(t.v):t.w=Ci(t.v):t.w=eL(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=dc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&il(n)){var s=mi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function nL(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tb[n.Pattern]||n.Pattern)}t[e.ID]=e}function sL(t,e,r,n,s,a,i,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var p=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=vt(t);break;case"String":n.t="s",n.r=Yv(Qe(t)),n.v=t.indexOf("<")>-1?Qe(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(rr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Qe(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=NT[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Yv(e||t));break}if(rL(n,f,c),c.cellFormula!==!1)if(n.Formula){var x=Qe(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Fo(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Fo("RC:RC",s):n.ArrayRange&&(n.F=Fo(n.ArrayRange,s),l.push([Nt(n.F),n.F]))}else for(v=0;v<l.length;++v)s.r>=l[v][0].s.r&&s.r<=l[v][0].e.r&&s.c>=l[v][0].s.c&&s.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(p.forEach(function(E){!d.patternType&&E.patternType&&(d.patternType=E.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function aL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Sd(t,e){var r=e||{};tT();var n=Ul(kg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=lt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=dr(r);return i.type="string",$c.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){s.indexOf("<"+ct)>=0&&(a=!0)}),a)return pL(n,r);dc={"General Number":"General","General Date":Ue[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ue[15],"Short Date":Ue[14],"Long Time":Ue[19],"Medium Time":Ue[18],"Short Time":Ue[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ue[2],Standard:Ue[4],Percent:Ue[10],Scientific:Ue[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},p="",v={},x={},E=Mn('<Data ss:Type="String">'),A=0,_=0,y=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},B={},w="",k=0,I=[],R={},F={},O=0,L=[],ye=[],de={},Ae=[],ve,ie=!1,q=[],ue=[],xe={},U=0,J=0,G={Sheets:[],WBProps:{date1904:!1}},H={};jc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=jc.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?sL(n.slice(A,o.index),w,E,l[l.length-1][0]=="comment"?de:v,{c:_,r:y},z,Ae[_],x,q,r):(w="",E=Mn(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ye.length>0&&(v.c=ye),(!r.sheetRows||r.sheetRows>y)&&v.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][_]=v):d[Xt(_)+pr(y)]=v),v.HRef&&(v.l={Target:Qe(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(U=_+(parseInt(v.MergeAcross,10)|0),J=y+(parseInt(v.MergeDown,10)|0),I.push({s:{c:_,r:y},e:{c:U,r:J}})),!r.sheetStubs)v.MergeAcross?_=U+1:++_;else if(v.MergeAcross||v.MergeDown){for(var he=_;he<=U;++he)for(var Ee=y;Ee<=J;++Ee)(he>_||Ee>y)&&(r.dense?(d[Ee]||(d[Ee]=[]),d[Ee][he]={t:"z"}):d[Xt(he)+pr(Ee)]={t:"z"});_=U+1}else++_;else v=Z6(o[0]),v.Index&&(_=+v.Index-1),_<M.s.c&&(M.s.c=_),_>M.e.c&&(M.e.c=_),o[0].slice(-2)==="/>"&&++_,ye=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<M.s.r&&(M.s.r=y),y>M.e.r&&(M.e.r=y),o[0].slice(-2)==="/>"&&(x=Mn(o[0]),x.Index&&(y=+x.Index-1)),_=0,++y):(x=Mn(o[0]),x.Index&&(y=+x.Index-1),xe={},(x.AutoFitHeight=="0"||x.Height)&&(xe.hpx=parseInt(x.Height,10),xe.hpt=YT(xe.hpx),ue[y]=xe),x.Hidden=="1"&&(xe.hidden=!0,ue[y]=xe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(d["!ref"]=Xe(M),r.sheetRows&&r.sheetRows<=M.e.r&&(d["!fullref"]=d["!ref"],M.e.r=r.sheetRows-1,d["!ref"]=Xe(M))),I.length&&(d["!merges"]=I),Ae.length>0&&(d["!cols"]=Ae),ue.length>0&&(d["!rows"]=ue),f[p]=d}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=_=0,l.push([o[3],!1]),c=Mn(o[0]),p=Qe(c.Name),d=r.dense?[]:{},I=[],q=[],ue=[],H={name:p,Hidden:0},G.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ae=[],ie=!1}break;case"style":o[1]==="/"?nL(z,B,r):B=Mn(o[0]);break;case"numberformat":B.nf=Qe(Mn(o[0]).Format||"General"),dc[B.nf]&&(B.nf=dc[B.nf]);for(var pe=0;pe!=392&&Ue[pe]!=B.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(Ue[pe]==null){_i(B.nf,pe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ve=Mn(o[0]),ve.Hidden&&(ve.hidden=!0,delete ve.Hidden),ve.Width&&(ve.wpx=parseInt(ve.Width,10)),!ie&&ve.wpx>10){ie=!0,Ur=KT;for(var oe=0;oe<Ae.length;++oe)Ae[oe]&&Xo(Ae[oe])}ie&&Xo(ve),Ae[ve.Index-1||Ae.length]=ve;for(var Re=0;Re<+ve.Span;++Re)Ae[Ae.length]=dr(ve);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var j=Pe(o[0]),De={Name:j.Name,Ref:Fo(j.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(De.Sheet=G.Sheets.length-1),G.Names.push(De);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$P(R,re,n.slice(O,o.index)):O=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));aL(de),ye.push(de)}else l.push([o[3],!1]),c=Mn(o[0]),de={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Be=Mn(o[0]);d["!autofilter"]={ref:Fo(Be.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Fy(n,r);var Je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(O,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else O=o.index+o[0].length;break;case"header":d["!margins"]||hc(d["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(d["!margins"].header=+Pe(o[0]).Margin);break;case"footer":d["!margins"]||hc(d["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(d["!margins"].footer=+Pe(o[0]).Margin);break;case"pagemargins":var Ve=Pe(o[0]);d["!margins"]||hc(d["!margins"]={},"xlml"),isNaN(+Ve.Top)||(d["!margins"].top=+Ve.Top),isNaN(+Ve.Left)||(d["!margins"].left=+Ve.Left),isNaN(+Ve.Right)||(d["!margins"].right=+Ve.Right),isNaN(+Ve.Bottom)||(d["!margins"].bottom=+Ve.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?tL(F,re,L,n.slice(O,o.index)):(L=o,O=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=f),me.SheetNames=h,me.Workbook=G,me.SSF=dr(Ue),me.Props=R,me.Custprops=F,me}function $p(t,e){switch(jg(e=e||{}),e.type||"base64"){case"base64":return Sd(dn(t),e);case"binary":case"buffer":case"file":return Sd(t,e);case"array":return Sd(Bi(t),e)}}function iL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=_P(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=EP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var oL=[60,1084,2066,2165,2175];function lL(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Os(r,r.l),c=zp[l],f=0;c!=null&&oL.indexOf(l)>-1;)a=Os(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,c=zp[l=Os(r,r.l)];var h=pa(i);ur(h,0);var d=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(d),d+=i[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function as(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ue[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||zi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uc(t.v):t.w=Ci(t.v):t.w=Rn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&il(Ue[n]||String(n))){var s=mi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function cf(t,e,r){return{v:t,ixfe:e,t:r}}function cL(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],c="",f={},h,d="",p,v,x,E,A={},_=[],y,M,z=[],B=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},I=function(Me){return Me<8?Ei[Me]:Me<64&&B[Me-8]||Ei[Me]},R=function(Me,ut,Mt){var gt=ut.XF.data;if(!(!gt||!gt.patternType||!Mt||!Mt.cellStyles)){ut.s={},ut.s.patternType=gt.patternType;var gn;(gn=zc(I(gt.icvFore)))&&(ut.s.fgColor={rgb:gn}),(gn=zc(I(gt.icvBack)))&&(ut.s.bgColor={rgb:gn})}},F=function(Me,ut,Mt){if(!(xe>1)&&!(Mt.sheetRows&&Me.r>=Mt.sheetRows)){if(Mt.cellStyles&&ut.XF&&ut.XF.data&&R(Me,ut,Mt),delete ut.ixfe,delete ut.XF,h=Me,d=Oe(Me),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Me.r<i.s.r&&(i.s.r=Me.r),Me.c<i.s.c&&(i.s.c=Me.c),Me.r+1>i.e.r&&(i.e.r=Me.r+1),Me.c+1>i.e.c&&(i.e.c=Me.c+1),Mt.cellFormula&&ut.f){for(var gt=0;gt<_.length;++gt)if(!(_[gt][0].s.c>Me.c||_[gt][0].s.r>Me.r)&&!(_[gt][0].e.c<Me.c||_[gt][0].e.r<Me.r)){ut.F=Xe(_[gt][0]),(_[gt][0].s.c!=Me.c||_[gt][0].s.r!=Me.r)&&delete ut.f,ut.f&&(ut.f=""+Ar(_[gt][1],i,Me,q,O));break}}Mt.dense?(s[Me.r]||(s[Me.r]=[]),s[Me.r][Me.c]=ut):s[d]=ut}},O={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var L,ye=[],de=[],Ae=[],ve=[],ie=!1,q=[];q.SheetNames=O.snames,q.sharedf=O.sharedf,q.arrayf=O.arrayf,q.names=[],q.XTI=[];var ue=0,xe=0,U=0,J=[],G=[],H;O.codepage=1200,Wn(1200);for(var re=!1;t.l<t.length-1;){var he=t.l,Ee=t.read_shift(2);if(Ee===0&&ue===10)break;var pe=t.l===t.length?0:t.read_shift(2),oe=zp[Ee];if(oe&&oe.f){if(e.bookSheets&&ue===133&&Ee!==133)break;if(ue=Ee,oe.r===2||oe.r==12){var Re=t.read_shift(2);if(pe-=2,!O.enc&&Re!==Ee&&((Re&255)<<8|Re>>8)!==Ee)throw new Error("rt mismatch: "+Re+"!="+Ee);oe.r==12&&(t.l+=10,pe-=10)}var j={};if(Ee===10?j=oe.f(t,pe,O):j=lL(Ee,oe,t,pe,O),xe==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(Ee){case 34:r.opts.Date1904=w.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=j;break;case 66:var De=Number(j);switch(De){case 21010:De=1200;break;case 32768:De=1e4;break;case 32769:De=1252;break}Wn(O.codepage=De),re=!0;break;case 317:O.rrtabid=j;break;case 25:O.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:O.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:z.push(j);break;case 430:q.push([j]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(j);break;case 24:case 536:H={Name:j.Name,Ref:Ar(j.rgce,i,null,q,O)},j.itab>0&&(H.Sheet=j.itab-1),q.names.push(H),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(G[j.itab-1]={ref:Xe(j.rgce[0][0][1][2])});break;case 22:O.ExternCount=j;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(j),q.XTI=q.XTI.concat(j);break;case 2196:if(O.biff<8)break;H!=null&&(H.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&O.WTF&&console.error("Password verifier: "+j);break;case 133:a[j.pos]=j,O.snames.push(j.name);break;case 10:{if(--xe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Xe(i),e.sheetRows&&e.sheetRows<=i.e.r){var Be=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Xe(i),i.e.r=Be}i.e.r++,i.e.c++}ye.length>0&&(s["!merges"]=ye),de.length>0&&(s["!objects"]=de),Ae.length>0&&(s["!cols"]=Ae),ve.length>0&&(s["!rows"]=ve),w.Sheets.push(k)}c===""?f=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),O.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(O.biff=5,re=!0,Wn(O.codepage=28591)),O.biff==8&&j.BIFFVer==0&&j.dt==16&&(O.biff=2),xe++)break;if(s=e.dense?[]:{},O.biff<8&&!re&&(re=!0,Wn(O.codepage=e.codepage||1252)),O.biff<5||j.BIFFVer==0&&j.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:t.l-pe,name:c};a[Je.pos]=Je,O.snames.push(c)}else c=(a[he]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),ye=[],de=[],O.arrayf=_=[],Ae=[],ve=[],ie=!1,k={Hidden:(a[he]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[j.r]||[])[j.c]:s[Oe({c:j.c,r:j.r})])&&++j.c,y={ixfe:j.ixfe,XF:z[j.ixfe]||{},v:j.val,t:"n"},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e);break;case 5:case 517:y={ixfe:j.ixfe,XF:z[j.ixfe],v:j.val,t:j.t},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e);break;case 638:y={ixfe:j.ixfe,XF:z[j.ixfe],v:j.rknum,t:"n"},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e);break;case 189:for(var Ve=j.c;Ve<=j.C;++Ve){var me=j.rkrec[Ve-j.c][0];y={ixfe:me,XF:z[me],v:j.rkrec[Ve-j.c][1],t:"n"},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:Ve,r:j.r},y,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(y=cf(j.val,j.cell.ixfe,j.tt),y.XF=z[y.ixfe],e.cellFormula){var ct=j.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var Lt=ct[0][0][1][0],nr=ct[0][0][1][1],sr=Oe({r:Lt,c:nr});A[sr]?y.f=""+Ar(j.formula,i,j.cell,q,O):y.F=((e.dense?(s[Lt]||[])[nr]:s[sr])||{}).F}else y.f=""+Ar(j.formula,i,j.cell,q,O)}U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F(j.cell,y,e),o=j}break;case 7:case 519:if(o)o.val=j,y=cf(j,o.cell.ixfe,"s"),y.XF=z[y.ixfe],e.cellFormula&&(y.f=""+Ar(o.formula,i,o.cell,q,O)),U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(j);var Dn=Oe(j[0].s);if(p=e.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[Dn],e.cellFormula&&p){if(!o||!Dn||!p)break;p.f=""+Ar(j[1],i,j[0],q,O),p.F=Xe(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;A[Oe(o.cell)]=j[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Oe(o.cell)],(p||{}).f=""+Ar(j[0],i,h,q,O)}}break;case 253:y=cf(l[j.isst].t,j.ixfe,"s"),l[j.isst].h&&(y.h=l[j.isst].h),y.XF=z[y.ixfe],U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:j.ixfe,XF:z[j.ixfe],t:"z"},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e));break;case 190:if(e.sheetStubs)for(var ar=j.c;ar<=j.C;++ar){var At=j.ixfe[ar-j.c];y={ixfe:At,XF:z[At],t:"z"},U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:ar,r:j.r},y,e)}break;case 214:case 516:case 4:y=cf(j.val,j.ixfe,"s"),y.XF=z[y.ixfe],U>0&&(y.z=J[y.ixfe>>8&63]),as(y,e,r.opts.Date1904),F({c:j.c,r:j.r},y,e);break;case 0:case 512:xe===1&&(i=j);break;case 252:l=j;break;case 1054:if(O.biff==4){J[U++]=j[1];for(var Fr=0;Fr<U+163&&Ue[Fr]!=j[1];++Fr);Fr>=163&&_i(j[1],U+163)}else _i(j[1],j[0]);break;case 30:{J[U++]=j;for(var tt=0;tt<U+163&&Ue[tt]!=j;++tt);tt>=163&&_i(j,U+163)}break;case 229:ye=ye.concat(j);break;case 93:de[j.cmo[0]]=O.lastobj=j;break;case 438:O.lastobj.TxO=j;break;case 127:O.lastobj.ImData=j;break;case 440:for(E=j[0].s.r;E<=j[0].e.r;++E)for(x=j[0].s.c;x<=j[0].e.c;++x)p=e.dense?(s[E]||[])[x]:s[Oe({c:x,r:E})],p&&(p.l=j[1]);break;case 2048:for(E=j[0].s.r;E<=j[0].e.r;++E)for(x=j[0].s.c;x<=j[0].e.c;++x)p=e.dense?(s[E]||[])[x]:s[Oe({c:x,r:E})],p&&p.l&&(p.l.Tooltip=j[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;p=e.dense?(s[j[0].r]||[])[j[0].c]:s[Oe(j[0])];var mt=de[j[2]];p||(e.dense?(s[j[0].r]||(s[j[0].r]=[]),p=s[j[0].r][j[0].c]={t:"z"}):p=s[Oe(j[0])]={t:"z"},i.e.r=Math.max(i.e.r,j[0].r),i.s.r=Math.min(i.s.r,j[0].r),i.e.c=Math.max(i.e.c,j[0].c),i.s.c=Math.min(i.s.c,j[0].c)),p.c||(p.c=[]),v={a:j[1],t:mt.TxO.t},p.c.push(v)}break;case 2173:Pb(z[j.ixfe],j.ext);break;case 125:{if(!O.cellStyles)break;for(;j.e>=j.s;)Ae[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ie||(ie=!0,Lg(j.w/256)),Xo(Ae[j.e+1])}break;case 520:{var St={};j.level!=null&&(ve[j.r]=St,St.level=j.level),j.hidden&&(ve[j.r]=St,St.hidden=!0),j.hpt&&(ve[j.r]=St,St.hpt=j.hpt,St.hpx=Hc(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||hc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=j;break;case 161:s["!margins"]||hc(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(w.Views[0].RTL=!0);break;case 146:B=j;break;case 2198:L=j;break;case 140:M=j;break;case 442:c?k.CodeName=j||k.name:w.WBProps.CodeName=j||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=pe}return r.SheetNames=Es(a).sort(function(Or,Me){return Number(Or)-Number(Me)}).map(function(Or){return a[Or].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&G.forEach(function(Or,Me){r.Sheets[r.SheetNames[Me]]["!autofilter"]=Or}),r.Strings=l,r.SSF=dr(Ue),O.enc&&(r.Encryption=O.enc),L&&(r.Themes=L),r.Metadata={},M!==void 0&&(r.Metadata.Country=M),q.names.length>0&&(w.Names=q.names),r.Workbook=w,r}var Ny={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function uL(t,e,r){var n=Ke.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=hy(n,IP,Ny.DSI);for(var a in s)e[a]=s[a]}catch(c){if(r.WTF)throw c}var i=Ke.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=hy(i,CP,Ny.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(PT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function pA(t,e){e||(e={}),jg(e),z2(),e.codepage&&yg(e.codepage);var r,n;if(t.FullPaths){if(Ke.find(t,"/encryption"))throw new Error("File is password-protected");r=Ke.find(t,"!CompObj"),n=Ke.find(t,"/Workbook")||Ke.find(t,"/Book")}else{switch(e.type){case"base64":t=Hn(dn(t));break;case"binary":t=Hn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ur(t,0),n={content:t}}var s,a;if(r&&iL(r),e.bookProps&&!e.bookSheets)s={};else{var i=Ge?"buffer":"array";if(n&&n.content)s=cL(n.content,e);else if((a=Ke.find(t,"PerfectOffice_MAIN"))&&a.content)s=uc.to_workbook(a.content,(e.type=i,e));else if((a=Ke.find(t,"NativeContent_MAIN"))&&a.content)s=uc.to_workbook(a.content,(e.type=i,e));else throw(a=Ke.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ke.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Xb(t))}var o={};return t.FullPaths&&uL(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Ah={0:{f:WO},1:{f:XO},2:{f:s6},3:{f:ZO},4:{f:QO},5:{f:n6},6:{f:o6},7:{f:t6},8:{f:h6},9:{f:f6},10:{f:c6},11:{f:u6},12:{f:YO},13:{f:a6},14:{f:e6},15:{f:JO},16:{f:cA},17:{f:l6},18:{f:r6},19:{f:Rg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:U6},40:{},42:{},43:{f:cb},44:{f:lb},45:{f:ub},46:{f:hb},47:{f:fb},48:{},49:{f:dP},50:{},51:{f:bb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zT},62:{f:i6},63:{f:Vb},64:{f:E6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:KO},148:{f:GO,p:16},151:{f:m6},152:{},153:{f:M6},154:{},155:{},156:{f:L6},157:{},158:{},159:{T:1,f:CD},160:{T:-1},161:{T:1,f:$i},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:d6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Db},336:{T:-1},337:{f:Fb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$T},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:g6},427:{f:x6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:y6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:qO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:p6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gb},633:{T:1},634:{T:-1},635:{T:1,f:Wb},636:{T:-1},637:{f:mP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:I6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:w6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zp={6:{f:Td},10:{f:la},12:{f:jt},13:{f:jt},14:{f:Pt},15:{f:Pt},16:{f:Ir},17:{f:Pt},18:{f:Pt},19:{f:jt},20:{f:gy},21:{f:gy},23:{f:$T},24:{f:vy},25:{f:Pt},26:{},27:{},28:{f:z3},29:{},34:{f:Pt},35:{f:xy},38:{f:Ir},39:{f:Ir},40:{f:Ir},41:{f:Ir},42:{f:Pt},43:{f:Pt},47:{f:qD},49:{f:A3},51:{f:jt},60:{},61:{f:E3},64:{f:Pt},65:{f:T3},66:{f:jt},77:{},80:{},81:{},82:{},85:{f:jt},89:{},90:{},91:{},92:{f:d3},93:{f:W3},94:{},95:{f:Pt},96:{},97:{},99:{f:Pt},125:{f:zT},128:{f:F3},129:{f:p3},130:{f:jt},131:{f:Pt},132:{f:Pt},133:{f:m3},134:{},140:{f:Q3},141:{f:jt},144:{},146:{f:Z3},151:{},152:{},153:{},154:{},155:{},156:{f:jt},157:{},158:{},160:{f:sD},161:{f:tD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:R3},190:{f:P3},193:{f:la},197:{},198:{},199:{},200:{},201:{},202:{f:Pt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jt},220:{},221:{f:Pt},222:{},224:{f:b3},225:{f:h3},226:{f:la},227:{},229:{f:H3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:g3},253:{f:S3},255:{f:x3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pt},353:{f:la},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:L3},431:{f:Pt},432:{},433:{},434:{},437:{},438:{f:K3},439:{f:Pt},440:{f:X3},441:{},442:{f:cu},443:{},444:{f:jt},445:{},446:{},448:{f:la},449:{f:_3,r:2},450:{f:la},512:{f:py},513:{f:nD},515:{f:O3},516:{f:k3},517:{f:my},519:{f:aD},520:{f:v3},523:{},545:{f:yy},549:{f:dy},566:{},574:{f:w3},638:{f:N3},659:{},1048:{},1054:{f:I3},1084:{},1212:{f:B3},2048:{f:Y3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:af},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:la},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:eD,r:12},2173:{f:Rb,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:U3,r:12},2197:{},2198:{f:Ab,r:12},2199:{},2200:{},2201:{},2202:{f:j3,r:12},2203:{f:la},2204:{},2205:{},2206:{},2207:{},2211:{f:y3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:rD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:py},1:{},2:{f:cD},3:{f:lD},4:{f:oD},5:{f:my},7:{f:uD},8:{},9:{f:af},11:{},22:{f:jt},30:{f:C3},31:{},32:{},33:{f:yy},36:{},37:{f:dy},50:{f:fD},62:{},52:{},67:{},68:{f:jt},69:{},86:{},126:{},127:{f:iD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hD},223:{},234:{},354:{},421:{},518:{f:Td},521:{f:af},536:{f:vy},547:{f:xy},561:{},579:{},1030:{f:Td},1033:{f:af},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vn(t,e,r,n){var s=e;if(!isNaN(s)){var a=(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&TT(r)&&t.push(r)}}function Ry(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=OR(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var x=l[i].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(E!="<td"&&E!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var _=A[o].trim();if(_.match(/<t[dh]/i)){for(var y=_,M=0;y.charAt(0)=="<"&&(M=y.indexOf(">"))>-1;)y=y.slice(M+1);for(var z=0;z<v.length;++z){var B=v[z];B.s.c==f&&B.s.r<c&&c<=B.e.r&&(f=B.e.c+1,z=-1)}var w=Pe(_.slice(0,_.indexOf(">")));d=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||d>1)&&v.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var k=w.t||w["data-t"]||"";if(!y.length){f+=d;continue}if(y=uT(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=d;continue}var I={t:"s",v:y};r.raw||!y.trim().length||k=="s"||(y==="TRUE"?I={t:"b",v:!0}:y==="FALSE"?I={t:"b",v:!1}:isNaN(Yn(y))?isNaN(Ko(y).getDate())||(I={t:"d",v:rr(y)},r.cellDates||(I={t:"n",v:zr(I.v)}),I.z=r.dateNF||Ue[14]):I={t:"n",v:Yn(y)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=I):n[Oe({r:c,c:f})]=I,f+=d}}}}return n["!ref"]=Xe(p),v.length&&(n["!merges"]=v),n}function fL(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var f=Oe({r,c:i}),h=n.dense?(t[r]||[])[i]:t[f],d=h&&h.v!=null&&(h.h||Sg(h.w||(qs(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(QR("td",d,p))}}var v="<tr>";return v+a.join("")+"</tr>"}var hL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dL="</body></html>";function pL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ja(Ry(r[0],e),e);var n=zg();return r.forEach(function(s,a){Hg(n,Ry(s,e),"Sheet"+(a+1))}),n}function mL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function gL(t,e){var r=e||{},n=r.header!=null?r.header:hL,s=r.footer!=null?r.footer:dL,a=[n],i=ol(t["!ref"]);r.dense=Array.isArray(t),a.push(mL(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(fL(t,i,o,r));return a.push("</table>"+s),a.join("")}function mA(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Br(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var f=ol(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),v=0,x=0,E=0,A=0,_=0,y=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(Py(M)){if(n.display)continue;p[x]={hidden:!0}}var z=M.children;for(E=A=0;E<z.length;++E){var B=z[E];if(!(n.display&&Py(B))){var w=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):uT(B.innerHTML),k=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<h.length;++d){var I=h[d];I.s.c==A+a&&I.s.r<x+s&&x+s<=I.e.r&&(A=I.e.c+1-a,d=-1)}y=+B.getAttribute("colspan")||1,((_=+B.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:x+s,c:A+a},e:{r:x+s+(_||1)-1,c:A+a+(y||1)-1}});var R={t:"s",v:w},F=B.getAttribute("data-t")||B.getAttribute("t")||"";w!=null&&(w.length==0?R.t=F||"z":n.raw||w.trim().length==0||F=="s"||(w==="TRUE"?R={t:"b",v:!0}:w==="FALSE"?R={t:"b",v:!1}:isNaN(Yn(w))?isNaN(Ko(w).getDate())||(R={t:"d",v:rr(w)},n.cellDates||(R={t:"n",v:zr(R.v)}),R.z=n.dateNF||Ue[14]):R={t:"n",v:Yn(w)})),R.z===void 0&&k!=null&&(R.z=k);var O="",L=B.getElementsByTagName("A");if(L&&L.length)for(var ye=0;ye<L.length&&!(L[ye].hasAttribute("href")&&(O=L[ye].getAttribute("href"),O.charAt(0)!="#"));++ye);O&&O.charAt(0)!="#"&&(R.l={Target:O}),n.dense?(t[x+s]||(t[x+s]=[]),t[x+s][A+a]=R):t[Oe({c:A+a,r:x+s})]=R,c.e.c<A+a&&(c.e.c=A+a),A+=y}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+s),t["!ref"]=Xe(c),x>=l&&(t["!fullref"]=Xe((c.e.r=o.length-v+x-1+s,c))),t}function gA(t,e){var r=e||{},n=r.dense?[]:{};return mA(n,t,e)}function xL(t,e){return Ja(gA(t,e),e)}function Py(t){var e="",r=vL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function vL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function yL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qe(e.replace(/<[^>]*>/g,""));return[r]}var Dy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xA(t,e){var r=e||{},n=kg(t),s=[],a,i,o={name:""},l="",c=0,f,h,d={},p=[],v=r.dense?[]:{},x,E,A={value:""},_="",y=0,M=[],z=-1,B=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,I={},R=[],F={},O=0,L=0,ye=[],de=1,Ae=1,ve=[],ie={Names:[]},q={},ue=["",""],xe=[],U={},J="",G=0,H=!1,re=!1,he=0;for(jc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=jc.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=Xe(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=Xe(w)),R.length&&(v["!merges"]=R),ye.length&&(v["!rows"]=ye),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),d[f.name]=v,re=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=Pe(x[0],!1),z=B=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},R=[],ye=[],re=!0);break;case"table-row-group":x[1]==="/"?--k:++k;break;case"table-row":case"":if(x[1]==="/"){z+=de,de=1;break}if(h=Pe(x[0],!1),h.?z=h.-1:z==-1&&(z=0),de=+h["number-rows-repeated"]||1,de<10)for(he=0;he<de;++he)k>0&&(ye[z+he]={level:k});B=-1;break;case"covered-table-cell":x[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(v[z]||(v[z]=[]),v[z][B]={t:"z"}):v[Oe({r:z,c:B})]={t:"z"}),_="",M=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++B,A=Pe(x[0],!1),Ae=parseInt(A["number-columns-repeated"]||"1",10),E={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(E.f=ky(Qe(A.formula))),(A.||A["value-type"])=="string"&&(E.t="s",E.v=Qe(A["string-value"]||""),r.dense?(v[z]||(v[z]=[]),v[z][B]=E):v[Oe({r:z,c:B})]=E),B+=Ae-1;else if(x[1]!=="/"){++B,_="",y=0,M=[],Ae=1;var Ee=de?z+de-1:z;if(B>w.e.c&&(w.e.c=B),B<w.s.c&&(w.s.c=B),z<w.s.r&&(w.s.r=z),Ee>w.e.r&&(w.e.r=Ee),A=Pe(x[0],!1),xe=[],U={},E={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Qe(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(O=parseInt(A["number-matrix-rows-spanned"],10)||0,L=parseInt(A["number-matrix-columns-spanned"],10)||0,F={s:{r:z,c:B},e:{r:z+O-1,c:B+L-1}},E.F=Xe(F),ve.push([F,E.F])),A.formula)E.f=ky(A.formula);else for(he=0;he<ve.length;++he)z>=ve[he][0].s.r&&z<=ve[he][0].e.r&&B>=ve[he][0].s.c&&B<=ve[he][0].e.c&&(E.F=ve[he][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(O=parseInt(A["number-rows-spanned"],10)||0,L=parseInt(A["number-columns-spanned"],10)||0,F={s:{r:z,c:B},e:{r:z+O-1,c:B+L-1}},R.push(F)),A["number-columns-repeated"]&&(Ae=parseInt(A["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=vt(A["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(A.value);break;case"percentage":E.t="n",E.v=parseFloat(A.value);break;case"currency":E.t="n",E.v=parseFloat(A.value);break;case"date":E.t="d",E.v=rr(A["date-value"]),r.cellDates||(E.t="n",E.v=zr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=DR(A["time-value"])/86400,r.cellDates&&(E.t="d",E.v=u0(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(A.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",A["string-value"]!=null&&(_=Qe(A["string-value"]),M=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=_||"",M.length&&(E.R=M),H=y==0),q.Target&&(E.l=q),xe.length>0&&(E.c=xe,xe=[]),_&&r.cellText!==!1&&(E.w=_),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var pe=0;pe<de;++pe){if(Ae=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(v[z+pe]||(v[z+pe]=[]),v[z+pe][B]=pe==0?E:dr(E);--Ae>0;)v[z+pe][B+Ae]=dr(E);else for(v[Oe({r:z+pe,c:B})]=E;--Ae>0;)v[Oe({r:z+pe,c:B+Ae})]=dr(E);w.e.c<=B&&(w.e.c=B)}Ae=parseInt(A["number-columns-repeated"]||"1",10),B+=Ae-1,Ae=0,E={},_="",M=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a;U.t=_,M.length&&(U.R=M),U.a=J,xe.push(U)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);J="",G=0,_="",y=0,M=[];break;case"creator":x[1]==="/"?J=n.slice(G,x.index):G=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);_="",y=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(I[o.name]=l,(a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=Pe(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Pe(x[0],!1),l+=Dy[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Pe(x[0],!1),l+=Dy[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":i=Pe(x[0],!1),ue=Ad(i["cell-range-address"]);var oe={Name:i.name,Ref:ue[0]+"!"+ue[1]};re&&(oe.Sheet=p.length),ie.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var Re=yL(n.slice(y,x.index));_=(_.length>0?_+`
`:"")+Re[0]}else Pe(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ue=Ad(Pe(x[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(q=Pe(x[0],!1),!q.href)break;q.Target=Qe(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ue=Ad(q.Target.slice(1)),q.Target="#"+ue[0]+"!"+ue[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:d,SheetNames:p,Workbook:ie};return r.bookSheets&&delete j.Sheets,j}function by(t,e){e=e||{},yn(t,"META-INF/manifest.xml")&&OP(Bt(t,"META-INF/manifest.xml"),e);var r=on(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=xA(lt(r),e);return yn(t,"meta.xml")&&(n.Props=RT(Bt(t,"meta.xml"))),n}function Fy(t,e){return xA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ug(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Hp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):lt(Bi(t))}function Wp(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Oy(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function _L(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Wc(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Yt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Cr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Wc(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Wc(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Bg(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function EL(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Wc(t,n),a=Cr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Yt(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Cr(o.data),c=Yt(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=a[3])!=null&&e[0]&&(i.merge=Yt(a[3][0].data)>>>0>0),r.push(i)}return r}function wL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Wc(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Wp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var f=Wp(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function TL(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(wL(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Wp(e)}function AL(t,e,r,n){var s=Ug(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Oy(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Oy(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function SL(t,e,r){var n=Ug(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);s&1&&(l=_L(t,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function kL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return AL(t,e,r,t[0]);case 5:return SL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Da(t){var e=Cr(t);return Wc(e[1][0].data)}function Ly(t,e){var r=Cr(e.data),n=Yt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Cr(i.data),l=Yt(o[1][0].data)>>>0;switch(n){case 1:a[l]=Hp(o[3][0].data);break;case 8:{var c=t[Da(o[9][0].data)][0],f=Cr(c.data),h=t[Da(f[1][0].data)][0],d=Yt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Cr(h.data);a[l]=p[3].map(function(v){return Hp(v.data)}).join("")}break}}),a}function IL(t,e){var r,n,s,a,i,o,l,c,f,h,d,p,v,x,E=Cr(t),A=Yt(E[1][0].data)>>>0,_=Yt(E[2][0].data)>>>0,y=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Yt(E[8][0].data)>0||!1,M,z;if((a=(s=E[7])==null?void 0:s[0])!=null&&a.data&&e!=0)M=(o=(i=E[7])==null?void 0:i[0])==null?void 0:o.data,z=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=E[4])==null?void 0:f[0])!=null&&h.data&&e!=1)M=(p=(d=E[4])==null?void 0:d[0])==null?void 0:p.data,z=(x=(v=E[3])==null?void 0:v[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=y?4:1,w=Ug(M),k=[],I=0;I<M.length/2;++I){var R=w.getUint16(I*2,!0);R<65535&&k.push([I,R])}if(k.length!=_)throw"Expected ".concat(_," cells, found ").concat(k.length);var F=[];for(I=0;I<k.length-1;++I)F[k[I][0]]=z.subarray(k[I][1]*B,k[I+1][1]*B);return k.length>=1&&(F[k[k.length-1][0]]=z.subarray(k[k.length-1][1]*B)),{R:A,cells:F}}function CL(t,e){var r,n=Cr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Yt(n[7][0].data)>>>0>0?1:0:-1,a=Bg(n[5],function(i){return IL(i,s)});return{nrows:Yt(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function NL(t,e,r){var n,s=Cr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Yt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Yt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Xe(a);var i=Cr(s[4][0].data),o=Ly(t,t[Da(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Ly(t,t[Da(i[17][0].data)][0]):[],c=Cr(i[3][0].data),f=0;c[1].forEach(function(h){var d=Cr(h.data),p=t[Da(d[2][0].data)][0],v=Yt(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var x=CL(t,p);x.data.forEach(function(E,A){E.forEach(function(_,y){var M=Oe({r:f+A,c:y}),z=kL(_,o,l);z&&(r[M]=z)})}),f+=x.nrows})}function RL(t,e){var r=Cr(e.data),n={"!ref":"A1"},s=t[Da(r[2][0].data)],a=Yt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return NL(t,s[0],n),n}function PL(t,e){var r,n=Cr(e.data),s={name:(r=n[1])!=null&&r[0]?Hp(n[1][0].data):"",sheets:[]},a=Bg(n[2],Da);return a.forEach(function(i){t[i].forEach(function(o){var l=Yt(o.meta[1][0].data);l==6e3&&s.sheets.push(RL(t,o))})}),s}function DL(t,e){var r=zg(),n=Cr(e.data),s=Bg(n[1],Da);if(s.forEach(function(a){t[a].forEach(function(i){var o=Yt(i.meta[1][0].data);if(o==2){var l=PL(t,i);l.sheets.forEach(function(c,f){Hg(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function kd(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=TL(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=EL(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Yt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var f=Yt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return DL(a,o)}function bL(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function jg(t){bL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function FL(t){return So.WS.indexOf(t)>-1?"sheet":t==So.CS?"chart":t==So.DS?"dialog":t==So.MS?"macro":t&&t.length?t:"sheet"}function OL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,FL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function LL(t,e,r,n,s,a,i,o,l,c,f,h){try{a[n]=lc(on(t,r,!0),e);var d=Bt(t,e),p;switch(o){case"sheet":p=$6(d,e,s,l,a[n],c,f,h);break;case"chart":if(p=z6(d,e,s,l,a[n],c,f,h),!p||!p["!drawel"])break;var v=jl(p["!drawel"].Target,e),x=Up(v),E=jb(on(t,v,!0),lc(on(t,x,!0),v)),A=jl(E,v),_=Up(A);p=S6(on(t,A,!0),A,l,lc(on(t,_,!0),A),c,p);break;case"macro":p=H6(d,e,s,l,a[n],c,f,h);break;case"dialog":p=W6(d,e,s,l,a[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&Es(a[n]).forEach(function(M){var z="";if(a[n][M].Type==So.CMNT){z=jl(a[n][M].Target,e);var B=X6(Bt(t,z,!0),z,l);if(!B||!B.length)return;Ey(p,B,!1)}a[n][M].Type==So.TCMNT&&(z=jl(a[n][M].Target,e),y=y.concat(zb(Bt(t,z,!0),l)))}),y&&y.length&&Ey(p,y,!0,l.people||[])}catch(M){if(l.WTF)throw M}}function xn(t){return t.charAt(0)=="/"?t.slice(1):t}function ML(t,e){if(tT(),e=e||{},jg(e),yn(t,"META-INF/manifest.xml")||yn(t,"objectdata.xml"))return by(t,e);if(yn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof kd<"u"){if(t.FileIndex)return kd(t);var r=Ke.utils.cfb_new();return Kv(t).forEach(function(ye){VR(r,ye,MR(t,ye))}),kd(r)}throw new Error("Unsupported NUMBERS file")}if(!yn(t,"[Content_Types].xml"))throw yn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):yn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Kv(t),s=bP(on(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Bt(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Bt(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(fc=[],s.sst)try{fc=K6(Bt(t,xn(s.sst)),s.sst,e)}catch(ye){if(e.WTF)throw ye}e.cellStyles&&s.themes.length&&(l=q6(on(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=G6(Bt(t,xn(s.style)),s.style,l,e))}s.links.map(function(ye){try{var de=lc(on(t,Up(xn(ye))),ye);return Q6(Bt(t,xn(ye)),de,ye,e)}catch{}});var f=j6(Bt(t,xn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=Bt(t,xn(s.coreprops[0]),!0),d&&(h=RT(d)),s.extprops.length!==0&&(d=Bt(t,xn(s.extprops[0]),!0),d&&VP(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=on(t,xn(s.custprops[0]),!0),d&&(p=BP(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(f.Sheets?i=f.Sheets.map(function(de){return de.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=p),e.bookSheets&&typeof i<"u"&&(v.SheetNames=i),e.bookSheets?v.SheetNames:e.bookProps))return v;i={};var x={};e.bookDeps&&s.calcchain&&(x=Y6(Bt(t,xn(s.calcchain)),s.calcchain));var E=0,A={},_,y;{var M=f.Sheets;h.Worksheets=M.length,h.SheetNames=[];for(var z=0;z!=M.length;++z)h.SheetNames[z]=M[z].name}var B=a?"bin":"xml",w=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,w+1)+"_rels/"+s.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");yn(t,k)||(k="xl/_rels/workbook."+B+".rels");var I=lc(on(t,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=J6(Bt(t,xn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Hb(Bt(t,xn(s.people[0])),e)),I&&(I=OL(I,f.Sheets));var R=Bt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var F="sheet";if(I&&I[E]?(_="xl/"+I[E][1].replace(/[\/]?xl\//,""),yn(t,_)||(_=I[E][1]),yn(t,_)||(_=k.replace(/_rels\/.*$/,"")+I[E][1]),F=I[E][2]):(_="xl/worksheets/sheet"+(E+1-R)+"."+B,_=_.replace(/sheet0\./,"sheet.")),y=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==E&&(O=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==h.SheetNames[E].toLowerCase()&&(O=1);if(!O)continue e}}LL(t,_,y,h.SheetNames[E],E,A,i,F,e,f,l,c)}return v={Directory:s,Workbook:f,Props:h,Custprops:p,Deps:x,Sheets:i,SheetNames:h.SheetNames,Strings:fc,Styles:c,Themes:l,SSF:dr(Ue)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(ye,de){ye=ye.replace(/^Root Entry[\/]/,""),v.keys.push(ye),v.files[ye]=t.FileIndex[de]}))),e&&e.bookVBA&&(s.vba.length>0?v.vbaraw=Bt(t,xn(s.vba[0]),!0):s.defaults&&s.defaults.bin===Kb&&(v.vbaraw=Bt(t,"xl/vbaProject.bin",!0))),v}function VL(t,e){var r=e||{},n="Workbook",s=Ke.find(t,n);try{if(n="/!DataSpaces/Version",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(RD(s.content),n="/!DataSpaces/DataSpaceMap",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=DD(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=bD(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);OD(s.content)}catch{}if(n="/EncryptionInfo",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=LD(s.content);if(n="/EncryptedPackage",s=Ke.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function $g(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=dn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function UL(t,e){return Ke.find(t,"EncryptedPackage")?VL(t,e):pA(t,e)}function BL(t,e){var r,n=t,s=e||{};return s.type||(s.type=Ge&&Buffer.isBuffer(t)?"buffer":"base64"),r=oT(n,s),ML(r,s)}function vA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $p(t.slice(r),e);default:break e}return $c.to_workbook(t,e)}function jL(t,e){var r="",n=$g(t,e);switch(e.type){case"base64":r=dn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ni(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=lt(r)),e.type="binary",vA(r,e)}function $L(t,e){var r=t;return e.type=="base64"&&(r=dn(r)),r=Vc.utils.decode(1200,r.slice(2),"str"),e.type="binary",vA(r,e)}function zL(t){return t.match(/[^\x00-\x7F]/)?$l(t):t}function Id(t,e,r,n){return n?(r.type="string",$c.to_workbook(t,r)):$c.to_workbook(e,r)}function Sh(t,e){z2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Sh(new Uint8Array(t),(r=dr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oo={},r.dateNF&&(Oo.dateNF=r.dateNF),r.type||(r.type=Ge&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ge?"buffer":"binary",n=RR(t),typeof Uint8Array<"u"&&!Ge&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=zL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=dr(r),r.type="array",Sh(_g(n),r)}switch((s=$g(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return UL(Ke.read(n,r),r);break;case 9:if(s[1]<=8)return pA(n,r);break;case 60:return $p(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return xD(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return mD.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?BL(n,r):Id(t,n,r,a);case 239:return s[3]===60?$p(n,r):Id(t,n,r,a);case 255:if(s[1]===254)return $L(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return uc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return uc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _y.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return KD.to_workbook(n,r);break;case 10:case 13:case 32:return jL(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dD.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?_y.to_workbook(n,r):Id(t,n,r,a)}function HL(t,e,r,n,s,a,i,o){var l=pr(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=i?t[r][p]:t[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;a[p]!=null&&(d[a[p]]=c);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[p]!=null){if(x==null)if(v.t=="e"&&x===null)d[a[p]]=null;else if(c!==void 0)d[a[p]]=c;else if(f&&x===null)d[a[p]]=null;else continue;else d[a[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:qs(v,x,o);x!=null&&(h=!1)}}return{row:d,isempty:h}}function Gp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Nt(f);break;case"number":l=Nt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var h=pr(l.s.r),d=[],p=[],v=0,x=0,E=Array.isArray(t),A=l.s.r,_=0,y={};E&&!t[A]&&(t[A]=[]);var M=c.skipHidden&&t["!cols"]||[],z=c.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(M[_]||{}).hidden)switch(d[_]=Xt(_),r=E?t[A][_]:t[d[_]+h],n){case 1:a[_]=_-l.s.c;break;case 2:a[_]=d[_];break;case 3:a[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=qs(r,null,c),x=y[i]||0,!x)y[i]=1;else{do o=i+"_"+x++;while(y[o]);y[i]=x,y[o]=1}a[_]=o}for(A=l.s.r+s;A<=l.e.r;++A)if(!(z[A]||{}).hidden){var B=HL(t,l,A,d,n,a,E,c);(B.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=B.row)}return p.length=v,p}var My=/"/g;function WL(t,e,r,n,s,a,i,o){for(var l=!0,c=[],f="",h=pr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:qs(p,null,o));for(var v=0,x=0;v!==f.length;++v)if((x=f.charCodeAt(v))===s||x===a||x===34||o.forceQuotes){f='"'+f.replace(My,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(My,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function yA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Nt(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(d[v]||{}).hidden||(h[v]=Xt(v));for(var x=0,E=s.s.r;E<=s.e.r;++E)(p[E]||{}).hidden||(f=WL(t,s,E,h,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function GL(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=yA(t,e);return r}function qL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Nt(t["!ref"]),a="",i=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=Xt(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=pr(f),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function _A(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var h=Nt(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+e.length-1+s)}else i==-1&&(i=0,f.e.r=e.length-1+s);var d=n.header||[],p=0;e.forEach(function(x,E){Es(x).forEach(function(A){(p=d.indexOf(A))==-1&&(d[p=d.length]=A);var _=x[A],y="z",M="",z=Oe({c:o+p,r:i+E+s});c=Gc(a,z),_&&typeof _=="object"&&!(_ instanceof Date)?a[z]=_:(typeof _=="number"?y="n":typeof _=="boolean"?y="b":typeof _=="string"?y="s":_ instanceof Date?(y="d",n.cellDates||(y="n",_=zr(_)),M=n.dateNF||Ue[14]):_===null&&n.nullError&&(y="e",_=0),c?(c.t=y,c.v=_,delete c.w,delete c.R,M&&(c.z=M)):a[z]=c={t:y,v:_},M&&(c.z=M))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var v=pr(i);if(s)for(p=0;p<d.length;++p)a[Xt(p+o)+v]={t:"s",v:d[p]};return a["!ref"]=Xe(f),a}function KL(t,e){return _A(null,t,e)}function Gc(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Br(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Gc(t,Oe(e)):Gc(t,Oe({r:e,c:r||0}))}function XL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function zg(){return{SheetNames:[],Sheets:{}}}function Hg(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(b6(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function YL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=XL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function QL(t,e){return t.z=e,t}function EA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function JL(t,e,r){return EA(t,"#"+e,r)}function ZL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function e5(t,e,r,n){for(var s=typeof e!="string"?e:Nt(e),a=typeof e=="string"?e:Xe(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Gc(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Vy={encode_col:Xt,encode_row:pr,encode_cell:Oe,encode_range:Xe,decode_col:Ng,decode_row:Cg,split_cell:hP,decode_cell:Br,decode_range:ol,format_cell:qs,sheet_add_aoa:ST,sheet_add_json:_A,sheet_add_dom:mA,aoa_to_sheet:ll,json_to_sheet:KL,table_to_sheet:gA,table_to_book:xL,sheet_to_csv:yA,sheet_to_txt:GL,sheet_to_json:Gp,sheet_to_html:gL,sheet_to_formulae:qL,sheet_to_row_object_array:Gp,sheet_get_cell:Gc,book_new:zg,book_append_sheet:Hg,book_set_sheet_visibility:YL,cell_set_number_format:QL,cell_set_hyperlink:EA,cell_set_internal_link:JL,cell_add_comment:ZL,sheet_set_array_formula:e5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const t5=()=>{};var Uy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},r5=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],i=t[r++],o=t[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],i=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return e.join("")},TA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],i=s+1<t.length,o=i?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,f=a>>2,h=(a&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(d=64)),n.push(r[f],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):r5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||o==null||c==null||h==null)throw new n5;const d=a<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const v=c<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class n5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s5=function(t){const e=wA(t);return TA.encodeByteArray(e,!0)},kh=function(t){return s5(t).replace(/\./g,"")},AA=function(t){try{return TA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5=()=>a5().__FIREBASE_DEFAULTS__,o5=()=>{if(typeof process>"u"||typeof Uy>"u")return;const t=Uy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},l5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&AA(t[1]);return e&&JSON.parse(e)},p0=()=>{try{return t5()||i5()||o5()||l5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SA=t=>{var e,r;return(r=(e=p0())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},c5=t=>{const e=SA(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},kA=()=>{var t;return(t=p0())==null?void 0:t.config},IA=t=>{var e;return(e=p0())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CA(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kh(JSON.stringify(r)),kh(JSON.stringify(i)),""].join(".")}const pc={};function h5(){const t={prod:[],emulator:[]};for(const e of Object.keys(pc))pc[e]?t.emulator.push(e):t.prod.push(e);return t}function d5(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let By=!1;function NA(t,e){if(typeof window>"u"||typeof document>"u"||!cl(window.location.host)||pc[t]===e||pc[t]||By)return;pc[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",a=h5().prod.length>0;function i(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{By=!0,i()},d}function f(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=d5(n),p=r("text"),v=document.getElementById(p)||document.createElement("span"),x=r("learnmore"),E=document.getElementById(x)||document.createElement("a"),A=r("preprendIcon"),_=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const y=d.element;o(y),f(E,x);const M=c();l(_,A),y.append(_,v,E,M),document.body.appendChild(y)}a?(v.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function p5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dr())}function m5(){var e;const t=(e=p0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function g5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function x5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function v5(){const t=Dr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function y5(){return!m5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PA(){try{return typeof indexedDB=="object"}catch{return!1}}function DA(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(r){e(r)}})}function _5(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5="FirebaseError";class rs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=E5,Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wi.prototype.create)}}class Wi{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],i=a?w5(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new rs(s,o,n)}}function w5(t,e){return t.replace(T5,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const T5=/\{\$([^}]+)}/g;function A5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $a(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],i=e[s];if(jy(a)&&jy(i)){if(!$a(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function jy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function zl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Hl(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function S5(t,e){const r=new k5(t,e);return r.subscribe.bind(r)}class k5{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");I5(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Cd),s.error===void 0&&(s.error=Cd),s.complete===void 0&&(s.complete=Cd);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function I5(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Cd(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C5=1e3,N5=2,R5=4*60*60*1e3,P5=.5;function $y(t,e=C5,r=N5){const n=e*Math.pow(r,t),s=Math.round(P5*n*(Math.random()-.5)*2);return Math.min(R5,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t){return t&&t._delegate?t._delegate:t}class Jn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new u5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(F5(e))try{this.getOrInitializeService({instanceIdentifier:ui})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=ui){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ui){return this.instances.has(e)}getOptions(e=ui){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:b5(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ui){return this.component?this.component.multipleInstances?e:ui:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b5(t){return t===ui?void 0:t}function F5(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new D5(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ze||(ze={}));const L5={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},M5=ze.INFO,V5={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},U5=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=V5[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class m0{constructor(e){this.name=e,this._logLevel=M5,this._logHandler=U5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const B5=(t,e)=>e.some(r=>t instanceof r);let zy,Hy;function j5(){return zy||(zy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $5(){return Hy||(Hy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bA=new WeakMap,qp=new WeakMap,FA=new WeakMap,Nd=new WeakMap,Wg=new WeakMap;function z5(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r(ba(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(r=>{r instanceof IDBCursor&&bA.set(r,t)}).catch(()=>{}),Wg.set(e,t),e}function H5(t){if(qp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});qp.set(t,e)}let Kp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return qp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||FA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ba(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function W5(t){Kp=t(Kp)}function G5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Rd(this),e,...r);return FA.set(n,e.sort?e.sort():[e]),ba(n)}:$5().includes(t)?function(...e){return t.apply(Rd(this),e),ba(bA.get(this))}:function(...e){return ba(t.apply(Rd(this),e))}}function q5(t){return typeof t=="function"?G5(t):(t instanceof IDBTransaction&&H5(t),B5(t,j5())?new Proxy(t,Kp):t)}function ba(t){if(t instanceof IDBRequest)return z5(t);if(Nd.has(t))return Nd.get(t);const e=q5(t);return e!==t&&(Nd.set(t,e),Wg.set(e,t)),e}const Rd=t=>Wg.get(t);function OA(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),o=ba(i);return n&&i.addEventListener("upgradeneeded",l=>{n(ba(i.result),l.oldVersion,l.newVersion,ba(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const K5=["get","getKey","getAll","getAllKeys","count"],X5=["put","add","delete","clear"],Pd=new Map;function Wy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Pd.get(e))return Pd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=X5.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||K5.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return Pd.set(e,a),a}W5(t=>({...t,get:(e,r,n)=>Wy(e,r)||t.get(e,r,n),has:(e,r)=>!!Wy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Q5(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Q5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xp="@firebase/app",Gy="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=new m0("@firebase/app"),J5="@firebase/app-compat",Z5="@firebase/analytics-compat",e8="@firebase/analytics",t8="@firebase/app-check-compat",r8="@firebase/app-check",n8="@firebase/auth",s8="@firebase/auth-compat",a8="@firebase/database",i8="@firebase/data-connect",o8="@firebase/database-compat",l8="@firebase/functions",c8="@firebase/functions-compat",u8="@firebase/installations",f8="@firebase/installations-compat",h8="@firebase/messaging",d8="@firebase/messaging-compat",p8="@firebase/performance",m8="@firebase/performance-compat",g8="@firebase/remote-config",x8="@firebase/remote-config-compat",v8="@firebase/storage",y8="@firebase/storage-compat",_8="@firebase/firestore",E8="@firebase/ai",w8="@firebase/firestore-compat",T8="firebase",A8="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="[DEFAULT]",S8={[Xp]:"fire-core",[J5]:"fire-core-compat",[e8]:"fire-analytics",[Z5]:"fire-analytics-compat",[r8]:"fire-app-check",[t8]:"fire-app-check-compat",[n8]:"fire-auth",[s8]:"fire-auth-compat",[a8]:"fire-rtdb",[i8]:"fire-data-connect",[o8]:"fire-rtdb-compat",[l8]:"fire-fn",[c8]:"fire-fn-compat",[u8]:"fire-iid",[f8]:"fire-iid-compat",[h8]:"fire-fcm",[d8]:"fire-fcm-compat",[p8]:"fire-perf",[m8]:"fire-perf-compat",[g8]:"fire-rc",[x8]:"fire-rc-compat",[v8]:"fire-gcs",[y8]:"fire-gcs-compat",[_8]:"fire-fst",[w8]:"fire-fst-compat",[E8]:"fire-vertex","fire-js":"fire-js",[T8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=new Map,k8=new Map,Qp=new Map;function qy(t,e){try{t.container.addComponent(e)}catch(r){Ks.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ws(t){const e=t.name;if(Qp.has(e))return Ks.debug(`There were multiple attempts to register component ${e}.`),!1;Qp.set(e,t);for(const r of Ih.values())qy(r,t);for(const r of k8.values())qy(r,t);return!0}function Gi(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function wn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fa=new Wi("app","Firebase",I8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=A8;function LA(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Yp,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Fa.create("bad-app-name",{appName:String(s)});if(r||(r=kA()),!r)throw Fa.create("no-options");const a=Ih.get(s);if(a){if($a(r,a.options)&&$a(n,a.config))return a;throw Fa.create("duplicate-app",{appName:s})}const i=new O5(s);for(const l of Qp.values())i.addComponent(l);const o=new C8(r,n,i);return Ih.set(s,o),o}function Gg(t=Yp){const e=Ih.get(t);if(!e&&t===Yp&&kA())return LA();if(!e)throw Fa.create("no-app",{appName:t});return e}function kn(t,e,r){let n=S8[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const i=[`Unable to register library "${n}" with version "${e}":`];s&&i.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&i.push("and"),a&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ks.warn(i.join(" "));return}ws(new Jn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8="firebase-heartbeat-database",R8=1,qc="firebase-heartbeat-store";let Dd=null;function MA(){return Dd||(Dd=OA(N8,R8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Fa.create("idb-open",{originalErrorMessage:t.message})})),Dd}async function P8(t){try{const r=(await MA()).transaction(qc),n=await r.objectStore(qc).get(VA(t));return await r.done,n}catch(e){if(e instanceof rs)Ks.warn(e.message);else{const r=Fa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ks.warn(r.message)}}}async function Ky(t,e){try{const n=(await MA()).transaction(qc,"readwrite");await n.objectStore(qc).put(e,VA(t)),await n.done}catch(r){if(r instanceof rs)Ks.warn(r.message);else{const n=Fa.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ks.warn(n.message)}}}function VA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D8=1024,b8=30;class F8{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new L8(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Xy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>b8){const i=M8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ks.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Xy(),{heartbeatsToSend:n,unsentEntries:s}=O8(this._heartbeatsCache.heartbeats),a=kh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Ks.warn(r),""}}}function Xy(){return new Date().toISOString().substring(0,10)}function O8(t,e=D8){const r=[];let n=t.slice();for(const s of t){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),Yy(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Yy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class L8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PA()?DA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await P8(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ky(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ky(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Yy(t){return kh(JSON.stringify({version:2,heartbeats:t})).length}function M8(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V8(t){ws(new Jn("platform-logger",e=>new Y5(e),"PRIVATE")),ws(new Jn("heartbeat",e=>new F8(e),"PRIVATE")),kn(Xp,Gy,t),kn(Xp,Gy,"esm2020"),kn("fire-js","")}V8("");function UA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const U8=UA,BA=new Wi("auth","Firebase",UA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=new m0("@firebase/auth");function B8(t,...e){Ch.logLevel<=ze.WARN&&Ch.warn(`Auth (${ul}): ${t}`,...e)}function Df(t,...e){Ch.logLevel<=ze.ERROR&&Ch.error(`Auth (${ul}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(t,...e){throw qg(t,...e)}function ms(t,...e){return qg(t,...e)}function jA(t,e,r){const n={...U8(),[e]:r};return new Wi("auth","Firebase",n).create(e,{appName:t.name})}function js(t){return jA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return BA.create(t,...e)}function Ce(t,e,...r){if(!t)throw qg(e,...r)}function Ls(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Df(e),new Error(e)}function Xs(t,e){t||Ls(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function j8(){return Qy()==="http:"||Qy()==="https:"}function Qy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(j8()||RA()||"connection"in navigator)?navigator.onLine:!0}function z8(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Xs(r>e,"Short delay should be less than long delay!"),this.isMobile=p5()||x5()}get(){return $8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t,e){Xs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],G8=new pu(3e4,6e4);function Za(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ea(t,e,r,n,s={}){return zA(t,s,async()=>{let a={},i={};n&&(e==="GET"?i=n:a={body:JSON.stringify(n)});const o=du({key:t.config.apiKey,...i}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...a};return g5()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&cl(t.emulatorConfig.host)&&(c.credentials="include"),$A.fetch()(await HA(t,t.config.apiHost,r,o),c)})}async function zA(t,e,r){t._canInitEmulator=!1;const n={...H8,...e};try{const s=new K8(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw uf(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw uf(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw uf(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw uf(t,"user-disabled",i);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw jA(t,f,c);Zn(t,f)}}catch(s){if(s instanceof rs)throw s;Zn(t,"network-request-failed",{message:String(s)})}}async function mu(t,e,r,n,s={}){const a=await ea(t,e,r,n,s);return"mfaPendingCredential"in a&&Zn(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function HA(t,e,r,n){const s=`${e}${r}?${n}`,a=t,i=a.config.emulator?Kg(t.config,s):`${t.config.apiScheme}://${s}`;return W8.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(i).toString():i}function q8(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class K8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ms(this.auth,"network-request-failed")),G8.get())})}}function uf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ms(t,e,n);return s.customData._tokenResponse=r,s}function Jy(t){return t!==void 0&&t.enterprise!==void 0}class X8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return q8(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Y8(t,e){return ea(t,"GET","/v2/recaptchaConfig",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q8(t,e){return ea(t,"POST","/v1/accounts:delete",e)}async function Nh(t,e){return ea(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function J8(t,e=!1){const r=Ot(t),n=await r.getIdToken(e),s=Xg(n);Ce(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:mc(bd(s.auth_time)),issuedAtTime:mc(bd(s.iat)),expirationTime:mc(bd(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function bd(t){return Number(t)*1e3}function Xg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Df("JWT malformed, contained fewer than 3 sections"),null;try{const s=AA(r);return s?JSON.parse(s):(Df("Failed to decode base64 JWT payload"),null)}catch(s){return Df("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Zy(t){const e=Xg(t);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof rs&&Z8(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Z8({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=mc(this.lastLoginAt),this.creationTime=mc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rh(t){var h;const e=t.auth,r=await t.getIdToken(),n=await Yo(t,Nh(e,{idToken:r}));Ce(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const a=(h=s.providerUserInfo)!=null&&h.length?WA(s.providerUserInfo):[],i=rM(t.providerData,a),o=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(i!=null&&i.length),c=o?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Zp(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,f)}async function tM(t){const e=Ot(t);await Rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rM(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function WA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nM(t,e){const r=await zA(t,{},async()=>{const n=du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,i=await HA(t,s,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&cl(t.emulatorConfig.host)&&(l.credentials="include"),$A.fetch()(i,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function sM(t,e){return ea(t,"POST","/v2/accounts:revokeToken",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const r=Zy(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await nM(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Lo;return n&&(Ce(typeof n=="string","internal-error",{appName:e}),i.refreshToken=n),s&&(Ce(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),a&&(Ce(typeof a=="number","internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Lo,this.toJSON())}_performRefresh(){return Ls("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t,e){Ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qn{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new eM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Yo(this,this.stsTokenManager.getToken(this.auth,e));return Ce(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return J8(this,e)}reload(){return tM(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Rh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wn(this.auth.app))return Promise.reject(js(this.auth));const e=await this.getIdToken();return await Yo(this,Q8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,a=r.phoneNumber??void 0,i=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:p,providerData:v,stsTokenManager:x}=r;Ce(h&&x,e,"internal-error");const E=Lo.fromJSON(this.name,x);Ce(typeof h=="string",e,"internal-error"),ca(n,e.name),ca(s,e.name),Ce(typeof d=="boolean",e,"internal-error"),Ce(typeof p=="boolean",e,"internal-error"),ca(a,e.name),ca(i,e.name),ca(o,e.name),ca(l,e.name),ca(c,e.name),ca(f,e.name);const A=new qn({uid:h,auth:e,email:s,emailVerified:d,displayName:n,isAnonymous:p,photoURL:i,phoneNumber:a,tenantId:o,stsTokenManager:E,createdAt:c,lastLoginAt:f});return v&&Array.isArray(v)&&(A.providerData=v.map(_=>({..._}))),l&&(A._redirectEventId=l),A}static async _fromIdTokenResponse(e,r,n=!1){const s=new Lo;s.updateFromServerResponse(r);const a=new qn({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Rh(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Ce(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?WA(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Lo;o.updateFromIdToken(n);const l=new qn({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Zp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;function Ms(t){Xs(t instanceof Function,"Expected a class definition");let e=e_.get(t);return e?(Xs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,e_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}GA.type="NONE";const t_=GA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(t,e,r){return`firebase:${t}:${e}:${r}`}class Mo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=bf(this.userKey,s.apiKey,a),this.fullPersistenceKey=bf("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Nh(this.auth,{idToken:e}).catch(()=>{});return r?qn._fromGetAccountInfoResponse(this.auth,r,e):null}return qn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Mo(Ms(t_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||Ms(t_);const i=bf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(i);if(f){let h;if(typeof f=="string"){const d=await Nh(e,{idToken:f}).catch(()=>{});if(!d)break;h=await qn._fromGetAccountInfoResponse(e,d,f)}else h=qn._fromJSON(e,f);c!==a&&(o=h),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new Mo(a,e,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new Mo(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(YA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(JA(e))return"Blackberry";if(ZA(e))return"Webos";if(KA(e))return"Safari";if((e.includes("chrome/")||XA(e))&&!e.includes("edge/"))return"Chrome";if(QA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function qA(t=Dr()){return/firefox\//i.test(t)}function KA(t=Dr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XA(t=Dr()){return/crios\//i.test(t)}function YA(t=Dr()){return/iemobile/i.test(t)}function QA(t=Dr()){return/android/i.test(t)}function JA(t=Dr()){return/blackberry/i.test(t)}function ZA(t=Dr()){return/webos/i.test(t)}function Yg(t=Dr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aM(t=Dr()){var e;return Yg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function iM(){return v5()&&document.documentMode===10}function eS(t=Dr()){return Yg(t)||QA(t)||ZA(t)||JA(t)||/windows phone/i.test(t)||YA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t,e=[]){let r;switch(t){case"Browser":r=r_(Dr());break;case"Worker":r=`${r_(Dr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ul}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((i,o)=>{try{const l=e(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lM(t,e={}){return ea(t,"GET","/v2/passwordPolicy",Za(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=6;class uM{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??cM,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new n_(this),this.idTokenSubscription=new n_(this),this.beforeStateQueue=new oM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ms(r)),this._initializationPromise=this.queue(async()=>{var n,s,a;if(!this._deleted&&(this.persistenceManager=await Mo.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Nh(this,{idToken:e}),n=await qn._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(wn(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(a=this.redirectUser)==null?void 0:a._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Rh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=z8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wn(this.app))return Promise.reject(js(this));const r=e?Ot(e):null;return r&&Ce(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wn(this.app)?Promise.reject(js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wn(this.app)?Promise.reject(js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ms(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lM(this),r=new uM(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wi("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await sM(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ms(e)||this._popupRedirectResolver;Ce(r,this,"argument-error"),this.redirectPersistenceManager=await Mo.create(this,[Ms(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=e.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&B8(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function qi(t){return Ot(t)}class n_{constructor(e){this.auth=e,this.observer=null,this.addObserver=S5(r=>this.observer=r)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hM(t){g0=t}function rS(t){return g0.loadJS(t)}function dM(){return g0.recaptchaEnterpriseScript}function pM(){return g0.gapiScript}function mM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class gM{constructor(){this.enterprise=new xM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class xM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const vM="recaptcha-enterprise",nS="NO_RECAPTCHA";class yM{constructor(e){this.type=vM,this.auth=qi(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(i,o)=>{Y8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new X8(l);return a.tenantId==null?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,i(c.siteKey)}}).catch(l=>{o(l)})})}function s(a,i,o){const l=window.grecaptcha;Jy(l)?l.enterprise.ready(()=>{l.enterprise.execute(a,{action:e}).then(c=>{i(c)}).catch(()=>{i(nS)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gM().execute("siteKey",{action:"verify"}):new Promise((a,i)=>{n(this.auth).then(o=>{if(!r&&Jy(window.grecaptcha))s(o,a,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let l=dM();l.length!==0&&(l+=o),rS(l).then(()=>{s(o,a,i)}).catch(c=>{i(c)})}}).catch(o=>{i(o)})})}}async function s_(t,e,r,n=!1,s=!1){const a=new yM(t);let i;if(s)i=nS;else try{i=await a.verify(r)}catch{i=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function em(t,e,r,n,s){var a;if((a=t._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await s_(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await s_(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(t,e){const r=Gi(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if($a(a,e??{}))return s;Zn(s,"already-initialized")}return r.initialize({options:e})}function EM(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ms);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function wM(t,e,r){const n=qi(t);Ce(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=sS(e),{host:i,port:o}=TM(e),l=o===null?"":`:${o}`,c={url:`${a}//${i}${l}/`},f=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Ce(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ce($a(c,n.config.emulator)&&$a(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,cl(i)?(CA(`${a}//${i}${l}`),NA("Auth",!0)):AM()}function sS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function TM(t){const e=sS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:a_(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:a_(i)}}}function a_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function AM(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ls("not implemented")}_getIdTokenResponse(e){return Ls("not implemented")}_linkToIdToken(e,r){return Ls("not implemented")}_getReauthenticationResolver(e){return Ls("not implemented")}}async function SM(t,e){return ea(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kM(t,e){return mu(t,"POST","/v1/accounts:signInWithPassword",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IM(t,e){return mu(t,"POST","/v1/accounts:signInWithEmailLink",Za(t,e))}async function CM(t,e){return mu(t,"POST","/v1/accounts:signInWithEmailLink",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc extends Qg{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Kc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Kc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return em(e,r,"signInWithPassword",kM);case"emailLink":return IM(e,{email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return em(e,n,"signUpPassword",SM);case"emailLink":return CM(e,{idToken:r,email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vo(t,e){return mu(t,"POST","/v1/accounts:signInWithIdp",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM="http://localhost";class Pi extends Qg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Zn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...a}=r;if(!n||!s)return null;const i=new Pi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){const r=this.buildRequest();return Vo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Vo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Vo(e,r)}buildRequest(){const e={requestUri:NM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=du(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PM(t){const e=zl(Hl(t)).link,r=e?zl(Hl(e)).deep_link_id:null,n=zl(Hl(t)).deep_link_id;return(n?zl(Hl(n)).link:null)||n||r||e||t}class Jg{constructor(e){const r=zl(Hl(e)),n=r.apiKey??null,s=r.oobCode??null,a=RM(r.mode??null);Ce(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=PM(e);try{return new Jg(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(){this.providerId=fl.PROVIDER_ID}static credential(e,r){return Kc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Jg.parseLink(r);return Ce(n,"argument-error"),Kc._fromEmailAndCode(e,n.code,n.tenantId)}}fl.PROVIDER_ID="password";fl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";fl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu extends aS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma extends gu{constructor(){super("facebook.com")}static credential(e){return Pi._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ma.credentialFromTaggedObject(e)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ma.credential(e.oauthAccessToken)}catch{return null}}}ma.FACEBOOK_SIGN_IN_METHOD="facebook.com";ma.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends gu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Pi._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ga.credential(r,n)}catch{return null}}}ga.GOOGLE_SIGN_IN_METHOD="google.com";ga.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends gu{constructor(){super("github.com")}static credential(e){return Pi._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xa.credential(e.oauthAccessToken)}catch{return null}}}xa.GITHUB_SIGN_IN_METHOD="github.com";xa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends gu{constructor(){super("twitter.com")}static credential(e,r){return Pi._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return va.credential(r,n)}catch{return null}}}va.TWITTER_SIGN_IN_METHOD="twitter.com";va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DM(t,e){return mu(t,"POST","/v1/accounts:signUp",Za(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await qn._fromIdTokenResponse(e,n,s),i=i_(n);return new Di({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=i_(n);return new Di({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function i_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph extends rs{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ph.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Ph(e,r,n,s)}}function iS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Ph._fromErrorAndOperation(t,a,e,n):a})}async function bM(t,e,r=!1){const n=await Yo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Di._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FM(t,e,r=!1){const{auth:n}=t;if(wn(n.app))return Promise.reject(js(n));const s="reauthenticate";try{const a=await Yo(t,iS(n,s,e,t),r);Ce(a.idToken,n,"internal-error");const i=Xg(a.idToken);Ce(i,n,"internal-error");const{sub:o}=i;return Ce(t.uid===o,n,"user-mismatch"),Di._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Zn(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(t,e,r=!1){if(wn(t.app))return Promise.reject(js(t));const n="signIn",s=await iS(t,n,e),a=await Di._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function OM(t,e){return oS(qi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lS(t){const e=qi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function LM(t,e,r){if(wn(t.app))return Promise.reject(js(t));const n=qi(t),i=await em(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DM).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&lS(t),l}),o=await Di._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(o.user),o}function MM(t,e,r){return wn(t.app)?Promise.reject(js(t)):OM(Ot(t),fl.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&lS(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VM(t,e){return ea(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UM(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Ot(t),a={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},i=await Yo(n,VM(n.auth,a));n.displayName=i.displayName||null,n.photoURL=i.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(i)}function BM(t,e,r,n){return Ot(t).onIdTokenChanged(e,r,n)}function jM(t,e,r){return Ot(t).beforeAuthStateChanged(e,r)}function $M(t,e,r,n){return Ot(t).onAuthStateChanged(e,r,n)}function zM(t){return Ot(t).signOut()}const Dh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM=1e3,WM=10;class uS extends cS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);iM()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,WM):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},HM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}uS.type="LOCAL";const GM=uS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS extends cS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}fS.type="SESSION";const hS=fS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new x0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await qM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}x0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=Zg("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(d.data.response);break;default:clearTimeout(f),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(){return window}function XM(t){gs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){return typeof gs().WorkerGlobalScope<"u"&&typeof gs().importScripts=="function"}async function YM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function JM(){return dS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="firebaseLocalStorageDb",ZM=1,bh="firebaseLocalStorage",mS="fbase_key";class xu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function v0(t,e){return t.transaction([bh],e?"readwrite":"readonly").objectStore(bh)}function e9(){const t=indexedDB.deleteDatabase(pS);return new xu(t).toPromise()}function tm(){const t=indexedDB.open(pS,ZM);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(bh,{keyPath:mS})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(bh)?e(n):(n.close(),await e9(),e(await tm()))})})}async function o_(t,e,r){const n=v0(t,!0).put({[mS]:e,value:r});return new xu(n).toPromise()}async function t9(t,e){const r=v0(t,!1).get(e),n=await new xu(r).toPromise();return n===void 0?null:n.value}function l_(t,e){const r=v0(t,!0).delete(e);return new xu(r).toPromise()}const r9=800,n9=3;class gS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>n9)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=x0._getInstance(JM()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await YM(),!this.activeServiceWorker)return;this.sender=new KM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tm();return await o_(e,Dh,"1"),await l_(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>o_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>t9(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>l_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=v0(s,!1).getAll();return new xu(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),r9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gS.type="LOCAL";const s9=gS;new pu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(t,e){return e?Ms(e):(Ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends Qg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Vo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function i9(t){return oS(t.auth,new e1(t),t.bypassAuthState)}function o9(t){const{auth:e,user:r}=t;return Ce(r,e,"internal-error"),FM(r,new e1(t),t.bypassAuthState)}async function l9(t){const{auth:e,user:r}=t;return Ce(r,e,"internal-error"),bM(r,new e1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return i9;case"linkViaPopup":case"linkViaRedirect":return l9;case"reauthViaPopup":case"reauthViaRedirect":return o9;default:Zn(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9=new pu(2e3,1e4);class ko extends xS{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,ko.currentPopupAction&&ko.currentPopupAction.cancel(),ko.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Zg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ms(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ms(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ko.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ms(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,c9.get())};e()}}ko.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="pendingRedirect",Ff=new Map;class f9 extends xS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ff.get(this.auth._key());if(!e){try{const n=await h9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ff.set(this.auth._key(),e)}return this.bypassAuthState||Ff.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function h9(t,e){const r=m9(e),n=p9(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function d9(t,e){Ff.set(t._key(),e)}function p9(t){return Ms(t._redirectPersistence)}function m9(t){return bf(u9,t.config.apiKey,t.name)}async function g9(t,e,r=!1){if(wn(t.app))return Promise.reject(js(t));const n=qi(t),s=a9(n,e),i=await new f9(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9=10*60*1e3;class v9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!y9(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!vS(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(ms(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=x9&&this.cachedEventUids.clear(),this.cachedEventUids.has(c_(e))}saveEventToCache(e){this.cachedEventUids.add(c_(e)),this.lastProcessedEventTime=Date.now()}}function c_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function y9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _9(t,e={}){return ea(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w9=/^https?/;async function T9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _9(t);for(const r of e)try{if(A9(r))return}catch{}Zn(t,"unauthorized-domain")}function A9(t){const e=Jp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!w9.test(r))return!1;if(E9.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S9=new pu(3e4,6e4);function u_(){const t=gs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function k9(t){return new Promise((e,r)=>{var s,a,i;function n(){u_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{u_(),r(ms(t,"network-request-failed"))},timeout:S9.get()})}if((a=(s=gs().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((i=gs().gapi)!=null&&i.load)n();else{const o=mM("iframefcb");return gs()[o]=()=>{gapi.load?n():r(ms(t,"network-request-failed"))},rS(`${pM()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Of=null,e})}let Of=null;function I9(t){return Of=Of||k9(t),Of}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C9=new pu(5e3,15e3),N9="__/auth/iframe",R9="emulator/auth/iframe",P9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b9(t){const e=t.config;Ce(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Kg(e,R9):`https://${t.config.authDomain}/${N9}`,n={apiKey:e.apiKey,appName:t.name,v:ul},s=D9.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${du(n).slice(1)}`}async function F9(t){const e=await I9(t),r=gs().gapi;return Ce(r,t,"internal-error"),e.open({where:document.body,url:b9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:P9,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=ms(t,"network-request-failed"),o=gs().setTimeout(()=>{a(i)},C9.get());function l(){gs().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},L9=500,M9=600,V9="_blank",U9="http://localhost";class f_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function B9(t,e,r,n=L9,s=M9){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...O9,width:n.toString(),height:s.toString(),top:a,left:i},c=Dr().toLowerCase();r&&(o=XA(c)?V9:r),qA(c)&&(e=e||U9,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[p,v])=>`${d}${p}=${v},`,"");if(aM(c)&&o!=="_self")return j9(e||"",o),new f_(null);const h=window.open(e||"",o,f);Ce(h,t,"popup-blocked");try{h.focus()}catch{}return new f_(h)}function j9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $9="__/auth/handler",z9="emulator/auth/handler",H9=encodeURIComponent("fac");async function h_(t,e,r,n,s,a){Ce(t.config.authDomain,t,"auth-domain-config-required"),Ce(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ul,eventId:s};if(e instanceof aS){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",A5(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))i[f]=h}if(e instanceof gu){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(i.scopes=f.join(","))}t.tenantId&&(i.tid=t.tenantId);const o=i;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${H9}=${encodeURIComponent(l)}`:"";return`${W9(t)}?${du(o).slice(1)}${c}`}function W9({config:t}){return t.emulator?Kg(t,z9):`https://${t.authDomain}/${$9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="webStorageSupport";class G9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hS,this._completeRedirectFn=g9,this._overrideRedirectResult=d9}async _openPopup(e,r,n,s){var i;Xs((i=this.eventManagers[e._key()])==null?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await h_(e,r,n,Jp(),s);return B9(e,a,Zg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await h_(e,r,n,Jp(),s);return XM(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(Xs(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await F9(e),n=new v9(e);return r.register("authEvent",s=>(Ce(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Fd,{type:Fd},s=>{var i;const a=(i=s==null?void 0:s[0])==null?void 0:i[Fd];a!==void 0&&r(!!a),Zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=T9(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return eS()||KA()||Yg()}}const q9=G9;var d_="@firebase/auth",p_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Y9(t){ws(new Jn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Ce(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tS(t)},c=new fM(n,s,a,l);return EM(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ws(new Jn("auth-internal",e=>{const r=qi(e.getProvider("auth").getImmediate());return(n=>new K9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),kn(d_,p_,X9(t)),kn(d_,p_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=5*60,J9=IA("authIdTokenMaxAge")||Q9;let m_=null;const Z9=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>J9)return;const s=r==null?void 0:r.token;m_!==s&&(m_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function e7(t=Gg()){const e=Gi(t,"auth");if(e.isInitialized())return e.getImmediate();const r=_M(t,{popupRedirectResolver:q9,persistence:[s9,GM,hS]}),n=IA("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=Z9(a.toString());jM(r,i,()=>i(r.currentUser)),BM(r,o=>i(o))}}const s=SA("auth");return s&&wM(r,`http://${s}`),r}function t7(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}hM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=ms("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",t7().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Y9("Browser");var r7="firebase",n7="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kn(r7,n7,"app");var g_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Oa,yS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,k){function I(){}I.prototype=k.prototype,w.D=k.prototype,w.prototype=new I,w.prototype.constructor=w,w.C=function(R,F,O){for(var L=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)L[ye-2]=arguments[ye];return k.prototype[F].apply(R,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,k,I){I||(I=0);var R=Array(16);if(typeof k=="string")for(var F=0;16>F;++F)R[F]=k.charCodeAt(I++)|k.charCodeAt(I++)<<8|k.charCodeAt(I++)<<16|k.charCodeAt(I++)<<24;else for(F=0;16>F;++F)R[F]=k[I++]|k[I++]<<8|k[I++]<<16|k[I++]<<24;k=w.g[0],I=w.g[1],F=w.g[2];var O=w.g[3],L=k+(O^I&(F^O))+R[0]+3614090360&4294967295;k=I+(L<<7&4294967295|L>>>25),L=O+(F^k&(I^F))+R[1]+3905402710&4294967295,O=k+(L<<12&4294967295|L>>>20),L=F+(I^O&(k^I))+R[2]+606105819&4294967295,F=O+(L<<17&4294967295|L>>>15),L=I+(k^F&(O^k))+R[3]+3250441966&4294967295,I=F+(L<<22&4294967295|L>>>10),L=k+(O^I&(F^O))+R[4]+4118548399&4294967295,k=I+(L<<7&4294967295|L>>>25),L=O+(F^k&(I^F))+R[5]+1200080426&4294967295,O=k+(L<<12&4294967295|L>>>20),L=F+(I^O&(k^I))+R[6]+2821735955&4294967295,F=O+(L<<17&4294967295|L>>>15),L=I+(k^F&(O^k))+R[7]+4249261313&4294967295,I=F+(L<<22&4294967295|L>>>10),L=k+(O^I&(F^O))+R[8]+1770035416&4294967295,k=I+(L<<7&4294967295|L>>>25),L=O+(F^k&(I^F))+R[9]+2336552879&4294967295,O=k+(L<<12&4294967295|L>>>20),L=F+(I^O&(k^I))+R[10]+4294925233&4294967295,F=O+(L<<17&4294967295|L>>>15),L=I+(k^F&(O^k))+R[11]+2304563134&4294967295,I=F+(L<<22&4294967295|L>>>10),L=k+(O^I&(F^O))+R[12]+1804603682&4294967295,k=I+(L<<7&4294967295|L>>>25),L=O+(F^k&(I^F))+R[13]+4254626195&4294967295,O=k+(L<<12&4294967295|L>>>20),L=F+(I^O&(k^I))+R[14]+2792965006&4294967295,F=O+(L<<17&4294967295|L>>>15),L=I+(k^F&(O^k))+R[15]+1236535329&4294967295,I=F+(L<<22&4294967295|L>>>10),L=k+(F^O&(I^F))+R[1]+4129170786&4294967295,k=I+(L<<5&4294967295|L>>>27),L=O+(I^F&(k^I))+R[6]+3225465664&4294967295,O=k+(L<<9&4294967295|L>>>23),L=F+(k^I&(O^k))+R[11]+643717713&4294967295,F=O+(L<<14&4294967295|L>>>18),L=I+(O^k&(F^O))+R[0]+3921069994&4294967295,I=F+(L<<20&4294967295|L>>>12),L=k+(F^O&(I^F))+R[5]+3593408605&4294967295,k=I+(L<<5&4294967295|L>>>27),L=O+(I^F&(k^I))+R[10]+38016083&4294967295,O=k+(L<<9&4294967295|L>>>23),L=F+(k^I&(O^k))+R[15]+3634488961&4294967295,F=O+(L<<14&4294967295|L>>>18),L=I+(O^k&(F^O))+R[4]+3889429448&4294967295,I=F+(L<<20&4294967295|L>>>12),L=k+(F^O&(I^F))+R[9]+568446438&4294967295,k=I+(L<<5&4294967295|L>>>27),L=O+(I^F&(k^I))+R[14]+3275163606&4294967295,O=k+(L<<9&4294967295|L>>>23),L=F+(k^I&(O^k))+R[3]+4107603335&4294967295,F=O+(L<<14&4294967295|L>>>18),L=I+(O^k&(F^O))+R[8]+1163531501&4294967295,I=F+(L<<20&4294967295|L>>>12),L=k+(F^O&(I^F))+R[13]+2850285829&4294967295,k=I+(L<<5&4294967295|L>>>27),L=O+(I^F&(k^I))+R[2]+4243563512&4294967295,O=k+(L<<9&4294967295|L>>>23),L=F+(k^I&(O^k))+R[7]+1735328473&4294967295,F=O+(L<<14&4294967295|L>>>18),L=I+(O^k&(F^O))+R[12]+2368359562&4294967295,I=F+(L<<20&4294967295|L>>>12),L=k+(I^F^O)+R[5]+4294588738&4294967295,k=I+(L<<4&4294967295|L>>>28),L=O+(k^I^F)+R[8]+2272392833&4294967295,O=k+(L<<11&4294967295|L>>>21),L=F+(O^k^I)+R[11]+1839030562&4294967295,F=O+(L<<16&4294967295|L>>>16),L=I+(F^O^k)+R[14]+4259657740&4294967295,I=F+(L<<23&4294967295|L>>>9),L=k+(I^F^O)+R[1]+2763975236&4294967295,k=I+(L<<4&4294967295|L>>>28),L=O+(k^I^F)+R[4]+1272893353&4294967295,O=k+(L<<11&4294967295|L>>>21),L=F+(O^k^I)+R[7]+4139469664&4294967295,F=O+(L<<16&4294967295|L>>>16),L=I+(F^O^k)+R[10]+3200236656&4294967295,I=F+(L<<23&4294967295|L>>>9),L=k+(I^F^O)+R[13]+681279174&4294967295,k=I+(L<<4&4294967295|L>>>28),L=O+(k^I^F)+R[0]+3936430074&4294967295,O=k+(L<<11&4294967295|L>>>21),L=F+(O^k^I)+R[3]+3572445317&4294967295,F=O+(L<<16&4294967295|L>>>16),L=I+(F^O^k)+R[6]+76029189&4294967295,I=F+(L<<23&4294967295|L>>>9),L=k+(I^F^O)+R[9]+3654602809&4294967295,k=I+(L<<4&4294967295|L>>>28),L=O+(k^I^F)+R[12]+3873151461&4294967295,O=k+(L<<11&4294967295|L>>>21),L=F+(O^k^I)+R[15]+530742520&4294967295,F=O+(L<<16&4294967295|L>>>16),L=I+(F^O^k)+R[2]+3299628645&4294967295,I=F+(L<<23&4294967295|L>>>9),L=k+(F^(I|~O))+R[0]+4096336452&4294967295,k=I+(L<<6&4294967295|L>>>26),L=O+(I^(k|~F))+R[7]+1126891415&4294967295,O=k+(L<<10&4294967295|L>>>22),L=F+(k^(O|~I))+R[14]+2878612391&4294967295,F=O+(L<<15&4294967295|L>>>17),L=I+(O^(F|~k))+R[5]+4237533241&4294967295,I=F+(L<<21&4294967295|L>>>11),L=k+(F^(I|~O))+R[12]+1700485571&4294967295,k=I+(L<<6&4294967295|L>>>26),L=O+(I^(k|~F))+R[3]+2399980690&4294967295,O=k+(L<<10&4294967295|L>>>22),L=F+(k^(O|~I))+R[10]+4293915773&4294967295,F=O+(L<<15&4294967295|L>>>17),L=I+(O^(F|~k))+R[1]+2240044497&4294967295,I=F+(L<<21&4294967295|L>>>11),L=k+(F^(I|~O))+R[8]+1873313359&4294967295,k=I+(L<<6&4294967295|L>>>26),L=O+(I^(k|~F))+R[15]+4264355552&4294967295,O=k+(L<<10&4294967295|L>>>22),L=F+(k^(O|~I))+R[6]+2734768916&4294967295,F=O+(L<<15&4294967295|L>>>17),L=I+(O^(F|~k))+R[13]+1309151649&4294967295,I=F+(L<<21&4294967295|L>>>11),L=k+(F^(I|~O))+R[4]+4149444226&4294967295,k=I+(L<<6&4294967295|L>>>26),L=O+(I^(k|~F))+R[11]+3174756917&4294967295,O=k+(L<<10&4294967295|L>>>22),L=F+(k^(O|~I))+R[2]+718787259&4294967295,F=O+(L<<15&4294967295|L>>>17),L=I+(O^(F|~k))+R[9]+3951481745&4294967295,w.g[0]=w.g[0]+k&4294967295,w.g[1]=w.g[1]+(F+(L<<21&4294967295|L>>>11))&4294967295,w.g[2]=w.g[2]+F&4294967295,w.g[3]=w.g[3]+O&4294967295}n.prototype.u=function(w,k){k===void 0&&(k=w.length);for(var I=k-this.blockSize,R=this.B,F=this.h,O=0;O<k;){if(F==0)for(;O<=I;)s(this,w,O),O+=this.blockSize;if(typeof w=="string"){for(;O<k;)if(R[F++]=w.charCodeAt(O++),F==this.blockSize){s(this,R),F=0;break}}else for(;O<k;)if(R[F++]=w[O++],F==this.blockSize){s(this,R),F=0;break}}this.h=F,this.o+=k},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var k=1;k<w.length-8;++k)w[k]=0;var I=8*this.o;for(k=w.length-8;k<w.length;++k)w[k]=I&255,I/=256;for(this.u(w),w=Array(16),k=I=0;4>k;++k)for(var R=0;32>R;R+=8)w[I++]=this.g[k]>>>R&255;return w};function a(w,k){var I=o;return Object.prototype.hasOwnProperty.call(I,w)?I[w]:I[w]=k(w)}function i(w,k){this.h=k;for(var I=[],R=!0,F=w.length-1;0<=F;F--){var O=w[F]|0;R&&O==k||(I[F]=O,R=!1)}this.g=I}var o={};function l(w){return-128<=w&&128>w?a(w,function(k){return new i([k|0],0>k?-1:0)}):new i([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var k=[],I=1,R=0;w>=I;R++)k[R]=w/I|0,I*=4294967296;return new i(k,0)}function f(w,k){if(w.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w.charAt(0)=="-")return E(f(w.substring(1),k));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=c(Math.pow(k,8)),R=h,F=0;F<w.length;F+=8){var O=Math.min(8,w.length-F),L=parseInt(w.substring(F,F+O),k);8>O?(O=c(Math.pow(k,O)),R=R.j(O).add(c(L))):(R=R.j(I),R=R.add(c(L)))}return R}var h=l(0),d=l(1),p=l(16777216);t=i.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,k=1,I=0;I<this.g.length;I++){var R=this.i(I);w+=(0<=R?R:4294967296+R)*k,k*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(v(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var k=c(Math.pow(w,6)),I=this,R="";;){var F=M(I,k).g;I=A(I,F.j(k));var O=((0<I.g.length?I.g[0]:I.h)>>>0).toString(w);if(I=F,v(I))return O+R;for(;6>O.length;)O="0"+O;R=O+R}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function v(w){if(w.h!=0)return!1;for(var k=0;k<w.g.length;k++)if(w.g[k]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=A(this,w),x(w)?-1:v(w)?0:1};function E(w){for(var k=w.g.length,I=[],R=0;R<k;R++)I[R]=~w.g[R];return new i(I,~w.h).add(d)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var k=Math.max(this.g.length,w.g.length),I=[],R=0,F=0;F<=k;F++){var O=R+(this.i(F)&65535)+(w.i(F)&65535),L=(O>>>16)+(this.i(F)>>>16)+(w.i(F)>>>16);R=L>>>16,O&=65535,L&=65535,I[F]=L<<16|O}return new i(I,I[I.length-1]&-2147483648?-1:0)};function A(w,k){return w.add(E(k))}t.j=function(w){if(v(this)||v(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(p)&&0>w.l(p))return c(this.m()*w.m());for(var k=this.g.length+w.g.length,I=[],R=0;R<2*k;R++)I[R]=0;for(R=0;R<this.g.length;R++)for(var F=0;F<w.g.length;F++){var O=this.i(R)>>>16,L=this.i(R)&65535,ye=w.i(F)>>>16,de=w.i(F)&65535;I[2*R+2*F]+=L*de,_(I,2*R+2*F),I[2*R+2*F+1]+=O*de,_(I,2*R+2*F+1),I[2*R+2*F+1]+=L*ye,_(I,2*R+2*F+1),I[2*R+2*F+2]+=O*ye,_(I,2*R+2*F+2)}for(R=0;R<k;R++)I[R]=I[2*R+1]<<16|I[2*R];for(R=k;R<2*k;R++)I[R]=0;return new i(I,0)};function _(w,k){for(;(w[k]&65535)!=w[k];)w[k+1]+=w[k]>>>16,w[k]&=65535,k++}function y(w,k){this.g=w,this.h=k}function M(w,k){if(v(k))throw Error("division by zero");if(v(w))return new y(h,h);if(x(w))return k=M(E(w),k),new y(E(k.g),E(k.h));if(x(k))return k=M(w,E(k)),new y(E(k.g),k.h);if(30<w.g.length){if(x(w)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var I=d,R=k;0>=R.l(w);)I=z(I),R=z(R);var F=B(I,1),O=B(R,1);for(R=B(R,2),I=B(I,2);!v(R);){var L=O.add(R);0>=L.l(w)&&(F=F.add(I),O=L),R=B(R,1),I=B(I,1)}return k=A(w,F.j(k)),new y(F,k)}for(F=h;0<=w.l(k);){for(I=Math.max(1,Math.floor(w.m()/k.m())),R=Math.ceil(Math.log(I)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),O=c(I),L=O.j(k);x(L)||0<L.l(w);)I-=R,O=c(I),L=O.j(k);v(O)&&(O=d),F=F.add(O),w=A(w,L)}return new y(F,w)}t.A=function(w){return M(this,w).h},t.and=function(w){for(var k=Math.max(this.g.length,w.g.length),I=[],R=0;R<k;R++)I[R]=this.i(R)&w.i(R);return new i(I,this.h&w.h)},t.or=function(w){for(var k=Math.max(this.g.length,w.g.length),I=[],R=0;R<k;R++)I[R]=this.i(R)|w.i(R);return new i(I,this.h|w.h)},t.xor=function(w){for(var k=Math.max(this.g.length,w.g.length),I=[],R=0;R<k;R++)I[R]=this.i(R)^w.i(R);return new i(I,this.h^w.h)};function z(w){for(var k=w.g.length+1,I=[],R=0;R<k;R++)I[R]=w.i(R)<<1|w.i(R-1)>>>31;return new i(I,w.h)}function B(w,k){var I=k>>5;k%=32;for(var R=w.g.length-I,F=[],O=0;O<R;O++)F[O]=0<k?w.i(O+I)>>>k|w.i(O+I+1)<<32-k:w.i(O+I);return new i(F,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yS=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=f,Oa=i}).apply(typeof g_<"u"?g_:typeof self<"u"?self:typeof window<"u"?window:{});var ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _S,Wl,ES,Lf,rm,wS,TS,AS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,S){return u==Array.prototype||u==Object.prototype||(u[g]=S.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof ff=="object"&&ff];for(var g=0;g<u.length;++g){var S=u[g];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=r(this);function s(u,g){if(g)e:{var S=n;u=u.split(".");for(var V=0;V<u.length-1;V++){var ee=u[V];if(!(ee in S))break e;S=S[ee]}u=u[u.length-1],V=S[u],g=g(V),g!=V&&g!=null&&e(S,u,{configurable:!0,writable:!0,value:g})}}function a(u,g){u instanceof String&&(u+="");var S=0,V=!1,ee={next:function(){if(!V&&S<u.length){var te=S++;return{value:g(te,u[te]),done:!1}}return V=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}s("Array.prototype.values",function(u){return u||function(){return a(this,function(g,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function f(u,g,S){return u.call.apply(u.bind,arguments)}function h(u,g,S){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,V),u.apply(g,ee)}}return function(){return u.apply(g,arguments)}}function d(u,g,S){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function p(u,g){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function v(u,g){function S(){}S.prototype=g.prototype,u.aa=g.prototype,u.prototype=new S,u.prototype.constructor=u,u.Qb=function(V,ee,te){for(var ge=Array(arguments.length-2),at=2;at<arguments.length;at++)ge[at-2]=arguments[at];return g.prototype[ee].apply(V,ge)}}function x(u){const g=u.length;if(0<g){const S=Array(g);for(let V=0;V<g;V++)S[V]=u[V];return S}return[]}function E(u,g){for(let S=1;S<arguments.length;S++){const V=arguments[S];if(l(V)){const ee=u.length||0,te=V.length||0;u.length=ee+te;for(let ge=0;ge<te;ge++)u[ee+ge]=V[ge]}else u.push(V)}}class A{constructor(g,S){this.i=g,this.j=S,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function _(u){return/^[\s\xa0]*$/.test(u)}function y(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function M(u){return M[" "](u),u}M[" "]=function(){};var z=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function B(u,g,S){for(const V in u)g.call(S,u[V],V,u)}function w(u,g){for(const S in u)g.call(void 0,u[S],S,u)}function k(u){const g={};for(const S in u)g[S]=u[S];return g}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(u,g){let S,V;for(let ee=1;ee<arguments.length;ee++){V=arguments[ee];for(S in V)u[S]=V[S];for(let te=0;te<I.length;te++)S=I[te],Object.prototype.hasOwnProperty.call(V,S)&&(u[S]=V[S])}}function F(u){var g=1;u=u.split(":");const S=[];for(;0<g&&u.length;)S.push(u.shift()),g--;return u.length&&S.push(u.join(":")),S}function O(u){o.setTimeout(()=>{throw u},0)}function L(){var u=q;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class ye{constructor(){this.h=this.g=null}add(g,S){const V=de.get();V.set(g,S),this.h?this.h.next=V:this.g=V,this.h=V}}var de=new A(()=>new Ae,u=>u.reset());class Ae{constructor(){this.next=this.g=this.h=null}set(g,S){this.h=g,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,ie=!1,q=new ye,ue=()=>{const u=o.Promise.resolve(void 0);ve=()=>{u.then(xe)}};var xe=()=>{for(var u;u=L();){try{u.h.call(u.g)}catch(S){O(S)}var g=de;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}ie=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const S=()=>{};o.addEventListener("test",S,g),o.removeEventListener("test",S,g)}catch{}return u}();function H(u,g){if(J.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var S=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(z){e:{try{M(g.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(g=null)}}else S=="mouseover"?g=u.fromElement:S=="mouseout"&&(g=u.toElement);this.relatedTarget=g,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:re[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}v(H,J);var re={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function pe(u,g,S,V,ee){this.listener=u,this.proxy=null,this.src=g,this.type=S,this.capture=!!V,this.ha=ee,this.key=++Ee,this.da=this.fa=!1}function oe(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Re(u){this.src=u,this.g={},this.h=0}Re.prototype.add=function(u,g,S,V,ee){var te=u.toString();u=this.g[te],u||(u=this.g[te]=[],this.h++);var ge=De(u,g,V,ee);return-1<ge?(g=u[ge],S||(g.fa=!1)):(g=new pe(g,this.src,te,!!V,ee),g.fa=S,u.push(g)),g};function j(u,g){var S=g.type;if(S in u.g){var V=u.g[S],ee=Array.prototype.indexOf.call(V,g,void 0),te;(te=0<=ee)&&Array.prototype.splice.call(V,ee,1),te&&(oe(g),u.g[S].length==0&&(delete u.g[S],u.h--))}}function De(u,g,S,V){for(var ee=0;ee<u.length;++ee){var te=u[ee];if(!te.da&&te.listener==g&&te.capture==!!S&&te.ha==V)return ee}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),Je={};function Ve(u,g,S,V,ee){if(Array.isArray(g)){for(var te=0;te<g.length;te++)Ve(u,g[te],S,V,ee);return null}return S=Fr(S),u&&u[he]?u.K(g,S,c(V)?!!V.capture:!1,ee):me(u,g,S,!1,V,ee)}function me(u,g,S,V,ee,te){if(!g)throw Error("Invalid event type");var ge=c(ee)?!!ee.capture:!!ee,at=ar(u);if(at||(u[Be]=at=new Re(u)),S=at.add(g,S,V,ge,te),S.proxy)return S;if(V=ct(),S.proxy=V,V.src=u,V.listener=S,u.addEventListener)G||(ee=ge),ee===void 0&&(ee=!1),u.addEventListener(g.toString(),V,ee);else if(u.attachEvent)u.attachEvent(sr(g.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function ct(){function u(S){return g.call(u.src,u.listener,S)}const g=Dn;return u}function Lt(u,g,S,V,ee){if(Array.isArray(g))for(var te=0;te<g.length;te++)Lt(u,g[te],S,V,ee);else V=c(V)?!!V.capture:!!V,S=Fr(S),u&&u[he]?(u=u.i,g=String(g).toString(),g in u.g&&(te=u.g[g],S=De(te,S,V,ee),-1<S&&(oe(te[S]),Array.prototype.splice.call(te,S,1),te.length==0&&(delete u.g[g],u.h--)))):u&&(u=ar(u))&&(g=u.g[g.toString()],u=-1,g&&(u=De(g,S,V,ee)),(S=-1<u?g[u]:null)&&nr(S))}function nr(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[he])j(g.i,u);else{var S=u.type,V=u.proxy;g.removeEventListener?g.removeEventListener(S,V,u.capture):g.detachEvent?g.detachEvent(sr(S),V):g.addListener&&g.removeListener&&g.removeListener(V),(S=ar(g))?(j(S,u),S.h==0&&(S.src=null,g[Be]=null)):oe(u)}}}function sr(u){return u in Je?Je[u]:Je[u]="on"+u}function Dn(u,g){if(u.da)u=!0;else{g=new H(g,this);var S=u.listener,V=u.ha||u.src;u.fa&&nr(u),u=S.call(V,g)}return u}function ar(u){return u=u[Be],u instanceof Re?u:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fr(u){return typeof u=="function"?u:(u[At]||(u[At]=function(g){return u.handleEvent(g)}),u[At])}function tt(){U.call(this),this.i=new Re(this),this.M=this,this.F=null}v(tt,U),tt.prototype[he]=!0,tt.prototype.removeEventListener=function(u,g,S,V){Lt(this,u,g,S,V)};function mt(u,g){var S,V=u.F;if(V)for(S=[];V;V=V.F)S.push(V);if(u=u.M,V=g.type||g,typeof g=="string")g=new J(g,u);else if(g instanceof J)g.target=g.target||u;else{var ee=g;g=new J(V,u),R(g,ee)}if(ee=!0,S)for(var te=S.length-1;0<=te;te--){var ge=g.g=S[te];ee=St(ge,V,!0,g)&&ee}if(ge=g.g=u,ee=St(ge,V,!0,g)&&ee,ee=St(ge,V,!1,g)&&ee,S)for(te=0;te<S.length;te++)ge=g.g=S[te],ee=St(ge,V,!1,g)&&ee}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var S=u.g[g],V=0;V<S.length;V++)oe(S[V]);delete u.g[g],u.h--}}this.F=null},tt.prototype.K=function(u,g,S,V){return this.i.add(String(u),g,!1,S,V)},tt.prototype.L=function(u,g,S,V){return this.i.add(String(u),g,!0,S,V)};function St(u,g,S,V){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var ee=!0,te=0;te<g.length;++te){var ge=g[te];if(ge&&!ge.da&&ge.capture==S){var at=ge.listener,or=ge.ha||ge.src;ge.fa&&j(u.i,ge),ee=at.call(or,V)!==!1&&ee}}return ee&&!V.defaultPrevented}function Or(u,g,S){if(typeof u=="function")S&&(u=d(u,S));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:o.setTimeout(u,g||0)}function Me(u){u.g=Or(()=>{u.g=null,u.i&&(u.i=!1,Me(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class ut extends U{constructor(g,S){super(),this.m=g,this.l=S,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Me(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(u){U.call(this),this.h=u,this.g={}}v(Mt,U);var gt=[];function gn(u){B(u.g,function(g,S){this.g.hasOwnProperty(S)&&nr(g)},u),u.g={}}Mt.prototype.N=function(){Mt.aa.N.call(this),gn(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ta=o.JSON.stringify,Qi=o.JSON.parse,xl=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function ra(){}ra.prototype.h=null;function ri(u){return u.h||(u.h=u.i())}function ni(){}var ks={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ji(){J.call(this,"d")}v(Ji,J);function bn(){J.call(this,"c")}v(bn,J);var ir={},si=null;function Lr(){return si=si||new tt}ir.La="serverreachability";function Zi(u){J.call(this,ir.La,u)}v(Zi,J);function tn(u){const g=Lr();mt(g,new Zi(g))}ir.STAT_EVENT="statevent";function eo(u,g){J.call(this,ir.STAT_EVENT,u),this.stat=g}v(eo,J);function Wt(u){const g=Lr();mt(g,new eo(g,u))}ir.Ma="timingevent";function na(u,g){J.call(this,ir.Ma,u),this.size=g}v(na,J);function Fn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function Is(){this.g=!0}Is.prototype.xa=function(){this.g=!1};function vl(u,g,S,V,ee,te){u.info(function(){if(u.g)if(te)for(var ge="",at=te.split("&"),or=0;or<at.length;or++){var Ze=at[or].split("=");if(1<Ze.length){var xr=Ze[0];Ze=Ze[1];var vr=xr.split("_");ge=2<=vr.length&&vr[1]=="type"?ge+(xr+"="+Ze+"&"):ge+(xr+"=redacted&")}}else ge=null;else ge=te;return"XMLHTTP REQ ("+V+") [attempt "+ee+"]: "+g+`
`+S+`
`+ge})}function X(u,g,S,V,ee,te,ge){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ee+"]: "+g+`
`+S+`
`+te+" "+ge})}function T(u,g,S,V){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+N(u,S)+(V?" "+V:"")})}function P(u,g){u.info(function(){return"TIMEOUT: "+g})}Is.prototype.info=function(){};function N(u,g){if(!u.g)return g;if(!g)return null;try{var S=JSON.parse(g);if(S){for(u=0;u<S.length;u++)if(Array.isArray(S[u])){var V=S[u];if(!(2>V.length)){var ee=V[1];if(Array.isArray(ee)&&!(1>ee.length)){var te=ee[0];if(te!="noop"&&te!="stop"&&te!="close")for(var ge=1;ge<ee.length;ge++)ee[ge]=""}}}}return ta(S)}catch{return g}}var C={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},b={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},D;function W(){}v(W,ra),W.prototype.g=function(){return new XMLHttpRequest},W.prototype.i=function(){return{}},D=new W;function K(u,g,S,V){this.j=u,this.i=g,this.l=S,this.R=V||1,this.U=new Mt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},Z={};function ae(u,g,S){u.L=1,u.v=Iu(Ns(g)),u.m=S,u.P=!0,fe(u,null)}function fe(u,g){u.F=Date.now(),_e(u),u.A=Ns(u.v);var S=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),J1(S.i,"t",V),u.C=0,S=u.j.J,u.h=new Y,u.g=gx(u.j,S?g:null,!u.m),0<u.O&&(u.M=new ut(d(u.Y,u,u.g),u.O)),g=u.U,S=u.g,V=u.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(gt[0]=ee.toString()),ee=gt);for(var te=0;te<ee.length;te++){var ge=Ve(S,ee[te],V||g.handleEvent,!1,g.h||g);if(!ge)break;g.g[ge.key]=ge}g=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),tn(),vl(u.i,u.u,u.A,u.l,u.R,u.m)}K.prototype.ca=function(u){u=u.target;const g=this.M;g&&Rs(u)==3?g.j():this.Y(u)},K.prototype.Y=function(u){try{if(u==this.g)e:{const vr=Rs(this.g);var g=this.g.Ba();const so=this.g.Z();if(!(3>vr)&&(vr!=3||this.g&&(this.h.h||this.g.oa()||ax(this.g)))){this.J||vr!=4||g==7||(g==8||0>=so?tn(3):tn(2)),st(this);var S=this.g.Z();this.X=S;t:if(we(this)){var V=ax(this.g);u="";var ee=V.length,te=Rs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xt(this),rt(this);var ge="";break t}this.h.i=new o.TextDecoder}for(g=0;g<ee;g++)this.h.h=!0,u+=this.h.i.decode(V[g],{stream:!(te&&g==ee-1)});V.length=0,this.h.g+=u,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=S==200,X(this.i,this.u,this.A,this.l,this.R,vr,S),this.o){if(this.T&&!this.K){t:{if(this.g){var at,or=this.g;if((at=or.g?or.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(at)){var Ze=at;break t}}Ze=null}if(S=Ze)T(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cs(this,S);else{this.o=!1,this.s=3,Wt(12),xt(this),rt(this);break e}}if(this.P){S=!0;let On;for(;!this.J&&this.C<ge.length;)if(On=ce(this,ge),On==Z){vr==4&&(this.s=4,Wt(14),S=!1),T(this.i,this.l,null,"[Incomplete Response]");break}else if(On==Q){this.s=4,Wt(15),T(this.i,this.l,ge,"[Invalid Chunk]"),S=!1;break}else T(this.i,this.l,On,null),Cs(this,On);if(we(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vr!=4||ge.length!=0||this.h.h||(this.s=1,Wt(16),S=!1),this.o=this.o&&S,!S)T(this.i,this.l,ge,"[Invalid Chunked Response]"),xt(this),rt(this);else if(0<ge.length&&!this.W){this.W=!0;var xr=this.j;xr.g==this&&xr.ba&&!xr.M&&(xr.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),H0(xr),xr.M=!0,Wt(11))}}else T(this.i,this.l,ge,null),Cs(this,ge);vr==4&&xt(this),this.o&&!this.J&&(vr==4?hx(this.j,this):(this.o=!1,_e(this)))}else HI(this.g),S==400&&0<ge.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),xt(this),rt(this)}}}catch{}finally{}};function we(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ce(u,g){var S=u.C,V=g.indexOf(`
`,S);return V==-1?Z:(S=Number(g.substring(S,V)),isNaN(S)?Q:(V+=1,V+S>g.length?Z:(g=g.slice(V,V+S),u.C=V+S,g)))}K.prototype.cancel=function(){this.J=!0,xt(this)};function _e(u){u.S=Date.now()+u.I,be(u,u.I)}function be(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Fn(d(u.ba,u),g)}function st(u){u.B&&(o.clearTimeout(u.B),u.B=null)}K.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(P(this.i,this.A),this.L!=2&&(tn(),Wt(17)),xt(this),this.s=2,rt(this)):be(this,this.S-u)};function rt(u){u.j.G==0||u.J||hx(u.j,u)}function xt(u){st(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,gn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Cs(u,g){try{var S=u.j;if(S.G!=0&&(S.g==u||rn(S.h,u))){if(!u.K&&rn(S.h,u)&&S.G==3){try{var V=S.Da.g.parse(g)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ee=V;if(ee[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<u.F)bu(S),Pu(S);else break e;z0(S),Wt(18)}}else S.za=ee[1],0<S.za-S.T&&37500>ee[2]&&S.F&&S.v==0&&!S.C&&(S.C=Fn(d(S.Za,S),6e3));if(1>=to(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else oi(S,11)}else if((u.K||S.g==u)&&bu(S),!_(g))for(ee=S.Da.g.parse(g),g=0;g<ee.length;g++){let Ze=ee[g];if(S.T=Ze[0],Ze=Ze[1],S.G==2)if(Ze[0]=="c"){S.K=Ze[1],S.ia=Ze[2];const xr=Ze[3];xr!=null&&(S.la=xr,S.j.info("VER="+S.la));const vr=Ze[4];vr!=null&&(S.Aa=vr,S.j.info("SVER="+S.Aa));const so=Ze[5];so!=null&&typeof so=="number"&&0<so&&(V=1.5*so,S.L=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const On=u.g;if(On){const Ou=On.g?On.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ou){var te=V.h;te.g||Ou.indexOf("spdy")==-1&&Ou.indexOf("quic")==-1&&Ou.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(B0(te,te.h),te.h=null))}if(V.D){const W0=On.g?On.g.getResponseHeader("X-HTTP-Session-Id"):null;W0&&(V.ya=W0,ft(V.I,V.D,W0))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-u.F,S.j.info("Handshake RTT: "+S.R+"ms")),V=S;var ge=u;if(V.qa=mx(V,V.J?V.ia:null,V.W),ge.K){H1(V.h,ge);var at=ge,or=V.L;or&&(at.I=or),at.B&&(st(at),_e(at)),V.g=ge}else ux(V);0<S.i.length&&Du(S)}else Ze[0]!="stop"&&Ze[0]!="close"||oi(S,7);else S.G==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?oi(S,7):$0(S):Ze[0]!="noop"&&S.l&&S.l.ta(Ze),S.v=0)}}tn(4)}catch{}}var ai=class{constructor(u,g){this.g=u,this.map=g}};function sa(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ns(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function to(u){return u.h?1:u.g?u.g.size:0}function rn(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function B0(u,g){u.g?u.g.add(g):u.h=g}function H1(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}sa.prototype.cancel=function(){if(this.i=W1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function W1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const S of u.g.values())g=g.concat(S.D);return g}return x(u.i)}function NI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],S=u.length,V=0;V<S;V++)g.push(u[V]);return g}g=[],S=0;for(V in u)g[S++]=u[V];return g}function RI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var S=0;S<u;S++)g.push(S);return g}g=[],S=0;for(const V in u)g[S++]=V;return g}}}function G1(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var S=RI(u),V=NI(u),ee=V.length,te=0;te<ee;te++)g.call(void 0,V[te],S&&S[te],u)}var q1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PI(u,g){if(u){u=u.split("&");for(var S=0;S<u.length;S++){var V=u[S].indexOf("="),ee=null;if(0<=V){var te=u[S].substring(0,V);ee=u[S].substring(V+1)}else te=u[S];g(te,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function ii(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ii){this.h=u.h,Su(this,u.j),this.o=u.o,this.g=u.g,ku(this,u.s),this.l=u.l;var g=u.i,S=new El;S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),K1(this,S),this.m=u.m}else u&&(g=String(u).match(q1))?(this.h=!1,Su(this,g[1]||"",!0),this.o=yl(g[2]||""),this.g=yl(g[3]||"",!0),ku(this,g[4]),this.l=yl(g[5]||"",!0),K1(this,g[6]||"",!0),this.m=yl(g[7]||"")):(this.h=!1,this.i=new El(null,this.h))}ii.prototype.toString=function(){var u=[],g=this.j;g&&u.push(_l(g,X1,!0),":");var S=this.g;return(S||g=="file")&&(u.push("//"),(g=this.o)&&u.push(_l(g,X1,!0),"@"),u.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&u.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&u.push("/"),u.push(_l(S,S.charAt(0)=="/"?FI:bI,!0))),(S=this.i.toString())&&u.push("?",S),(S=this.m)&&u.push("#",_l(S,LI)),u.join("")};function Ns(u){return new ii(u)}function Su(u,g,S){u.j=S?yl(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function ku(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function K1(u,g,S){g instanceof El?(u.i=g,MI(u.i,u.h)):(S||(g=_l(g,OI)),u.i=new El(g,u.h))}function ft(u,g,S){u.i.set(g,S)}function Iu(u){return ft(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function yl(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function _l(u,g,S){return typeof u=="string"?(u=encodeURI(u).replace(g,DI),S&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function DI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var X1=/[#\/\?@]/g,bI=/[#\?:]/g,FI=/[#\?]/g,OI=/[#\?@]/g,LI=/#/g;function El(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function aa(u){u.g||(u.g=new Map,u.h=0,u.i&&PI(u.i,function(g,S){u.add(decodeURIComponent(g.replace(/\+/g," ")),S)}))}t=El.prototype,t.add=function(u,g){aa(this),this.i=null,u=ro(this,u);var S=this.g.get(u);return S||this.g.set(u,S=[]),S.push(g),this.h+=1,this};function Y1(u,g){aa(u),g=ro(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Q1(u,g){return aa(u),g=ro(u,g),u.g.has(g)}t.forEach=function(u,g){aa(this),this.g.forEach(function(S,V){S.forEach(function(ee){u.call(g,ee,V,this)},this)},this)},t.na=function(){aa(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),S=[];for(let V=0;V<g.length;V++){const ee=u[V];for(let te=0;te<ee.length;te++)S.push(g[V])}return S},t.V=function(u){aa(this);let g=[];if(typeof u=="string")Q1(this,u)&&(g=g.concat(this.g.get(ro(this,u))));else{u=Array.from(this.g.values());for(let S=0;S<u.length;S++)g=g.concat(u[S])}return g},t.set=function(u,g){return aa(this),this.i=null,u=ro(this,u),Q1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function J1(u,g,S){Y1(u,g),0<S.length&&(u.i=null,u.g.set(ro(u,g),x(S)),u.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var S=0;S<g.length;S++){var V=g[S];const te=encodeURIComponent(String(V)),ge=this.V(V);for(V=0;V<ge.length;V++){var ee=te;ge[V]!==""&&(ee+="="+encodeURIComponent(String(ge[V]))),u.push(ee)}}return this.i=u.join("&")};function ro(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function MI(u,g){g&&!u.j&&(aa(u),u.i=null,u.g.forEach(function(S,V){var ee=V.toLowerCase();V!=ee&&(Y1(this,V),J1(this,ee,S))},u)),u.j=g}function VI(u,g){const S=new Is;if(o.Image){const V=new Image;V.onload=p(ia,S,"TestLoadImage: loaded",!0,g,V),V.onerror=p(ia,S,"TestLoadImage: error",!1,g,V),V.onabort=p(ia,S,"TestLoadImage: abort",!1,g,V),V.ontimeout=p(ia,S,"TestLoadImage: timeout",!1,g,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else g(!1)}function UI(u,g){const S=new Is,V=new AbortController,ee=setTimeout(()=>{V.abort(),ia(S,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:V.signal}).then(te=>{clearTimeout(ee),te.ok?ia(S,"TestPingServer: ok",!0,g):ia(S,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(ee),ia(S,"TestPingServer: error",!1,g)})}function ia(u,g,S,V,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),V(S)}catch{}}function BI(){this.g=new xl}function jI(u,g,S){const V=S||"";try{G1(u,function(ee,te){let ge=ee;c(ee)&&(ge=ta(ee)),g.push(V+te+"="+encodeURIComponent(ge))})}catch(ee){throw g.push(V+"type="+encodeURIComponent("_badmap")),ee}}function Cu(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Cu,ra),Cu.prototype.g=function(){return new Nu(this.l,this.j)},Cu.prototype.i=function(u){return function(){return u}}({});function Nu(u,g){tt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Nu,tt),t=Nu.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Tl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||o).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,wl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Tl(this)),this.g&&(this.readyState=3,Tl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Z1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Z1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?wl(this):Tl(this),this.readyState==3&&Z1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,wl(this))},t.Qa=function(u){this.g&&(this.response=u,wl(this))},t.ga=function(){this.g&&wl(this)};function wl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Tl(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var S=g.next();!S.done;)S=S.value,u.push(S[0]+": "+S[1]),S=g.next();return u.join(`\r
`)};function Tl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Nu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function ex(u){let g="";return B(u,function(S,V){g+=V,g+=":",g+=S,g+=`\r
`}),g}function j0(u,g,S){e:{for(V in S){var V=!1;break e}V=!0}V||(S=ex(S),typeof u=="string"?S!=null&&encodeURIComponent(String(S)):ft(u,g,S))}function kt(u){tt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(kt,tt);var $I=/^https?$/i,zI=["POST","PUT"];t=kt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():D.g(),this.v=this.o?ri(this.o):ri(D),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(te){tx(this,te);return}if(u=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ee in V)S.set(ee,V[ee]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const te of V.keys())S.set(te,V.get(te));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(te=>te.toLowerCase()=="content-type"),ee=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(zI,g,void 0))||V||ee||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ge]of S)this.g.setRequestHeader(te,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sx(this),this.u=!0,this.g.send(u),this.u=!1}catch(te){tx(this,te)}};function tx(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,rx(u),Ru(u)}function rx(u){u.A||(u.A=!0,mt(u,"complete"),mt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,mt(this,"complete"),mt(this,"abort"),Ru(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ru(this,!0)),kt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?nx(this):this.bb())},t.bb=function(){nx(this)};function nx(u){if(u.h&&typeof i<"u"&&(!u.v[1]||Rs(u)!=4||u.Z()!=2)){if(u.u&&Rs(u)==4)Or(u.Ea,0,u);else if(mt(u,"readystatechange"),Rs(u)==4){u.h=!1;try{const ge=u.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var S;if(!(S=g)){var V;if(V=ge===0){var ee=String(u.D).match(q1)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),V=!$I.test(ee?ee.toLowerCase():"")}S=V}if(S)mt(u,"complete"),mt(u,"success");else{u.m=6;try{var te=2<Rs(u)?u.g.statusText:""}catch{te=""}u.l=te+" ["+u.Z()+"]",rx(u)}}finally{Ru(u)}}}}function Ru(u,g){if(u.g){sx(u);const S=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||mt(u,"ready");try{S.onreadystatechange=V}catch{}}}function sx(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Rs(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Rs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Qi(g)}};function ax(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function HI(u){const g={};u=(u.g&&2<=Rs(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(_(u[V]))continue;var S=F(u[V]);const ee=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const te=g[ee]||[];g[ee]=te,te.push(S)}w(g,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Al(u,g,S){return S&&S.internalChannelParams&&S.internalChannelParams[u]||g}function ix(u){this.Aa=0,this.i=[],this.j=new Is,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Al("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Al("baseRetryDelayMs",5e3,u),this.cb=Al("retryDelaySeedMs",1e4,u),this.Wa=Al("forwardChannelMaxRetries",2,u),this.wa=Al("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new sa(u&&u.concurrentRequestLimit),this.Da=new BI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ix.prototype,t.la=8,t.G=1,t.connect=function(u,g,S,V){Wt(0),this.W=u,this.H=g||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.I=mx(this,null,this.W),Du(this)};function $0(u){if(ox(u),u.G==3){var g=u.U++,S=Ns(u.I);if(ft(S,"SID",u.K),ft(S,"RID",g),ft(S,"TYPE","terminate"),Sl(u,S),g=new K(u,u.j,g),g.L=2,g.v=Iu(Ns(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(g.v.toString(),"")}catch{}!S&&o.Image&&(new Image().src=g.v,S=!0),S||(g.g=gx(g.j,null),g.g.ea(g.v)),g.F=Date.now(),_e(g)}px(u)}function Pu(u){u.g&&(H0(u),u.g.cancel(),u.g=null)}function ox(u){Pu(u),u.u&&(o.clearTimeout(u.u),u.u=null),bu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Du(u){if(!ns(u.h)&&!u.s){u.s=!0;var g=u.Ga;ve||ue(),ie||(ve(),ie=!0),q.add(g,u),u.B=0}}function WI(u,g){return to(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Fn(d(u.Ga,u,g),dx(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ee=new K(this,this.j,u);let te=this.o;if(this.S&&(te?(te=k(te),R(te,this.S)):te=this.S),this.m!==null||this.O||(ee.H=te,te=null),this.P)e:{for(var g=0,S=0;S<this.i.length;S++){t:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(g+=V,4096<g){g=S;break e}if(g===4096||S===this.i.length-1){g=S+1;break e}}g=1e3}else g=1e3;g=cx(this,ee,g),S=Ns(this.I),ft(S,"RID",u),ft(S,"CVER",22),this.D&&ft(S,"X-HTTP-Session-Id",this.D),Sl(this,S),te&&(this.O?g="headers="+encodeURIComponent(String(ex(te)))+"&"+g:this.m&&j0(S,this.m,te)),B0(this.h,ee),this.Ua&&ft(S,"TYPE","init"),this.P?(ft(S,"$req",g),ft(S,"SID","null"),ee.T=!0,ae(ee,S,null)):ae(ee,S,g),this.G=2}}else this.G==3&&(u?lx(this,u):this.i.length==0||ns(this.h)||lx(this))};function lx(u,g){var S;g?S=g.l:S=u.U++;const V=Ns(u.I);ft(V,"SID",u.K),ft(V,"RID",S),ft(V,"AID",u.T),Sl(u,V),u.m&&u.o&&j0(V,u.m,u.o),S=new K(u,u.j,S,u.B+1),u.m===null&&(S.H=u.o),g&&(u.i=g.D.concat(u.i)),g=cx(u,S,1e3),S.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),B0(u.h,S),ae(S,V,g)}function Sl(u,g){u.H&&B(u.H,function(S,V){ft(g,V,S)}),u.l&&G1({},function(S,V){ft(g,V,S)})}function cx(u,g,S){S=Math.min(u.i.length,S);var V=u.l?d(u.l.Na,u.l,u):null;e:{var ee=u.i;let te=-1;for(;;){const ge=["count="+S];te==-1?0<S?(te=ee[0].g,ge.push("ofs="+te)):te=0:ge.push("ofs="+te);let at=!0;for(let or=0;or<S;or++){let Ze=ee[or].g;const xr=ee[or].map;if(Ze-=te,0>Ze)te=Math.max(0,ee[or].g-100),at=!1;else try{jI(xr,ge,"req"+Ze+"_")}catch{V&&V(xr)}}if(at){V=ge.join("&");break e}}}return u=u.i.splice(0,S),g.D=u,V}function ux(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;ve||ue(),ie||(ve(),ie=!0),q.add(g,u),u.v=0}}function z0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Fn(d(u.Fa,u),dx(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,fx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Fn(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Wt(10),Pu(this),fx(this))};function H0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function fx(u){u.g=new K(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Ns(u.qa);ft(g,"RID","rpc"),ft(g,"SID",u.K),ft(g,"AID",u.T),ft(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&ft(g,"TO",u.ja),ft(g,"TYPE","xmlhttp"),Sl(u,g),u.m&&u.o&&j0(g,u.m,u.o),u.L&&(u.g.I=u.L);var S=u.g;u=u.ia,S.L=1,S.v=Iu(Ns(g)),S.m=null,S.P=!0,fe(S,u)}t.Za=function(){this.C!=null&&(this.C=null,Pu(this),z0(this),Wt(19))};function bu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function hx(u,g){var S=null;if(u.g==g){bu(u),H0(u),u.g=null;var V=2}else if(rn(u.h,g))S=g.D,H1(u.h,g),V=1;else return;if(u.G!=0){if(g.o)if(V==1){S=g.m?g.m.length:0,g=Date.now()-g.F;var ee=u.B;V=Lr(),mt(V,new na(V,S)),Du(u)}else ux(u);else if(ee=g.s,ee==3||ee==0&&0<g.X||!(V==1&&WI(u,g)||V==2&&z0(u)))switch(S&&0<S.length&&(g=u.h,g.i=g.i.concat(S)),ee){case 1:oi(u,5);break;case 4:oi(u,10);break;case 3:oi(u,6);break;default:oi(u,2)}}}function dx(u,g){let S=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(S*=2),S*g}function oi(u,g){if(u.j.info("Error code "+g),g==2){var S=d(u.fb,u),V=u.Xa;const ee=!V;V=new ii(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Su(V,"https"),Iu(V),ee?VI(V.toString(),S):UI(V.toString(),S)}else Wt(2);u.G=0,u.l&&u.l.sa(g),px(u),ox(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function px(u){if(u.G=0,u.ka=[],u.l){const g=W1(u.h);(g.length!=0||u.i.length!=0)&&(E(u.ka,g),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function mx(u,g,S){var V=S instanceof ii?Ns(S):new ii(S);if(V.g!="")g&&(V.g=g+"."+V.g),ku(V,V.s);else{var ee=o.location;V=ee.protocol,g=g?g+"."+ee.hostname:ee.hostname,ee=+ee.port;var te=new ii(null);V&&Su(te,V),g&&(te.g=g),ee&&ku(te,ee),S&&(te.l=S),V=te}return S=u.D,g=u.ya,S&&g&&ft(V,S,g),ft(V,"VER",u.la),Sl(u,V),V}function gx(u,g,S){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new kt(new Cu({eb:S})):new kt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function xx(){}t=xx.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fu(){}Fu.prototype.g=function(u,g){return new nn(u,g)};function nn(u,g){tt.call(this),this.g=new ix(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!_(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!_(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new no(this)}v(nn,tt),nn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},nn.prototype.close=function(){$0(this.g)},nn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var S={};S.__data__=u,u=S}else this.u&&(S={},S.__data__=ta(u),u=S);g.i.push(new ai(g.Ya++,u)),g.G==3&&Du(g)},nn.prototype.N=function(){this.g.l=null,delete this.j,$0(this.g),delete this.g,nn.aa.N.call(this)};function vx(u){Ji.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const S in g){u=S;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(vx,Ji);function yx(){bn.call(this),this.status=1}v(yx,bn);function no(u){this.g=u}v(no,xx),no.prototype.ua=function(){mt(this.g,"a")},no.prototype.ta=function(u){mt(this.g,new vx(u))},no.prototype.sa=function(u){mt(this.g,new yx)},no.prototype.ra=function(){mt(this.g,"b")},Fu.prototype.createWebChannel=Fu.prototype.g,nn.prototype.send=nn.prototype.o,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,AS=function(){return new Fu},TS=function(){return Lr()},wS=ir,rm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},C.NO_ERROR=0,C.TIMEOUT=8,C.HTTP_ERROR=6,Lf=C,b.COMPLETE="complete",ES=b,ni.EventType=ks,ks.OPEN="a",ks.CLOSE="b",ks.ERROR="c",ks.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Wl=ni,kt.prototype.listenOnce=kt.prototype.L,kt.prototype.getLastError=kt.prototype.Ka,kt.prototype.getLastErrorCode=kt.prototype.Ba,kt.prototype.getStatus=kt.prototype.Z,kt.prototype.getResponseJson=kt.prototype.Oa,kt.prototype.getResponseText=kt.prototype.oa,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Ha,_S=kt}).apply(typeof ff<"u"?ff:typeof self<"u"?self:typeof window<"u"?window:{});const x_="@firebase/firestore",v_="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=new m0("@firebase/firestore");function lo(){return bi.logLevel}function Se(t,...e){if(bi.logLevel<=ze.DEBUG){const r=e.map(t1);bi.debug(`Firestore (${hl}): ${t}`,...r)}}function Ys(t,...e){if(bi.logLevel<=ze.ERROR){const r=e.map(t1);bi.error(`Firestore (${hl}): ${t}`,...r)}}function Qo(t,...e){if(bi.logLevel<=ze.WARN){const r=e.map(t1);bi.warn(`Firestore (${hl}): ${t}`,...r)}}function t1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,SS(t,n,r)}function SS(t,e,r){let n=`FIRESTORE (${hl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ys(n),new Error(n)}function et(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||SS(e,s,n)}function Le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends rs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class s7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Tr.UNAUTHENTICATED))}shutdown(){}}class a7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class i7{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){et(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new $s;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new $s,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new $s)}},0),i()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(et(typeof n.accessToken=="string",31837,{l:n}),new kS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return et(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class o7{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class l7{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new o7(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class y_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c7{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){et(this.o===void 0,3512);const n=a=>{a.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.m;return this.m=a.token,Se("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new y_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(et(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new y_(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=u7(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%62))}return n}}function He(t,e){return t<e?-1:t>e?1:0}function nm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),a=e.charAt(n);if(s!==a)return Od(s)===Od(a)?He(s,a):Od(s)?1:-1}return He(t.length,e.length)}const f7=55296,h7=57343;function Od(t){const e=t.charCodeAt(0);return e>=f7&&e<=h7}function Jo(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __="__name__";class ls{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ne(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ne(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ls.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ls?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=ls.compareSegments(e.get(s),r.get(s));if(a!==0)return a}return He(e.length,r.length)}static compareSegments(e,r){const n=ls.isNumericId(e),s=ls.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?ls.extractNumericId(e).compare(ls.extractNumericId(r)):nm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Oa.fromString(e.substring(4,e.length-2))}}class it extends ls{construct(e,r,n){return new it(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new it(r)}static emptyPath(){return new it([])}}const d7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends ls{construct(e,r,n){return new fr(e,r,n)}static isValidIdentifier(e){return d7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===__}static keyField(){return new fr([__])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Te(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Te(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Te(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Te(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(r)}static emptyPath(){return new fr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(it.fromString(e))}static fromName(e){return new Ie(it.fromString(e).popFirst(5))}static empty(){return new Ie(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return it.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new it(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t,e,r){if(!r)throw new Te(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function p7(t,e,r,n){if(e===!0&&n===!0)throw new Te(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function E_(t){if(!Ie.isDocumentKey(t))throw new Te(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function w_(t){if(Ie.isDocumentKey(t))throw new Te(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function CS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function y0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ne(12329,{type:typeof t})}function es(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=y0(t);throw new Te(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,e){const r={typeString:t};return e&&(r.value=e),r}function vu(t,e){if(!CS(t))throw new Te(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const i=t[n];if(s&&typeof i!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&i!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Te(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=-62135596800,A_=1e6;class dt{static now(){return dt.fromMillis(Date.now())}static fromDate(e){return dt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*A_);return new dt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Te(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<T_)throw new Te(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/A_}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vu(e,dt._jsonSchema))return new dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-T_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}dt._jsonSchemaVersion="firestore/timestamp/1.0",dt._jsonSchema={type:Ht("string",dt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new dt(0,0))}static max(){return new Fe(new dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=-1;function m7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Fe.fromTimestamp(n===1e9?new dt(r+1,0):new dt(r,n));return new za(s,Ie.empty(),e)}function g7(t){return new za(t.readTime,t.key,Xc)}class za{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new za(Fe.min(),Ie.empty(),Xc)}static max(){return new za(Fe.max(),Ie.empty(),Xc)}}function x7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ie.comparator(t.documentKey,e.documentKey),r!==0?r:He(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==v7)throw t;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new se((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof se?r:se.resolve(r)}catch(r){return se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):se.reject(r)}static resolve(e){return new se((r,n)=>{r(e)})}static reject(e){return new se((r,n)=>{n(e)})}static waitFor(e){return new se((r,n)=>{let s=0,a=0,i=!1;e.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(e){let r=se.resolve(!1);for(const n of e)r=r.next(s=>s?se.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new se((n,s)=>{const a=e.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(f=>{i[c]=f,++o,o===a&&n(i)},f=>s(f))}})}static doWhile(e,r){return new se((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}function _7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function pl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1=-1;function E0(t){return t==null}function Fh(t){return t===0&&1/t==-1/0}function E7(t){return typeof t=="number"&&Number.isInteger(t)&&!Fh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="";function w7(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=S_(e)),e=T7(t.get(r),e);return S_(e)}function T7(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case NS:r+="";break;default:r+=a}}return r}function S_(t){return t+NS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ei(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function RS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,r){this.comparator=e,this.root=r||cr.EMPTY}insert(e,r){return new Tt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new Tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hf(this.root,e,this.comparator,!1)}getReverseIterator(){return new hf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hf(this.root,e,this.comparator,!0)}}class hf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??cr.RED,this.left=s??cr.EMPTY,this.right=a??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new cr(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return cr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,r,n,s,a){return this}insert(e,r,n){return new cr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new Tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new I_(this.data.getIterator())}getIteratorFrom(e){return new I_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Qt(this.comparator);return r.data=e,r}}class I_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new cn([])}unionWith(e){let r=new Qt(fr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new cn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new PS("Invalid base64 string: "+a):a}}(e);return new gr(r)}static fromUint8Array(e){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(e);return new gr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gr.EMPTY_BYTE_STRING=new gr("");const A7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ha(t){if(et(!!t,39018),typeof t=="string"){let e=0;const r=A7.exec(t);if(et(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Dt(t.seconds),nanos:Dt(t.nanos)}}function Dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wa(t){return typeof t=="string"?gr.fromBase64String(t):gr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS="server_timestamp",bS="__type__",FS="__previous_value__",OS="__local_write_time__";function s1(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[bS])==null?void 0:n.stringValue)===DS}function w0(t){const e=t.mapValue.fields[FS];return s1(e)?w0(e):e}function Yc(t){const e=Ha(t.mapValue.fields[OS].timestampValue);return new dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e,r,n,s,a,i,o,l,c,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const Oh="(default)";class Qc{constructor(e,r){this.projectId=e,this.database=r||Oh}static empty(){return new Qc("","")}get isDefaultDatabase(){return this.database===Oh}isEqual(e){return e instanceof Qc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="__type__",k7="__max__",df={mapValue:{}},MS="__vector__",Lh="value";function Ga(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?s1(t)?4:C7(t)?9007199254740991:I7(t)?10:11:Ne(28295,{value:t})}function Ts(t,e){if(t===e)return!0;const r=Ga(t);if(r!==Ga(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yc(t).isEqual(Yc(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=Ha(s.timestampValue),o=Ha(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Wa(s.bytesValue).isEqual(Wa(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return Dt(s.geoPointValue.latitude)===Dt(a.geoPointValue.latitude)&&Dt(s.geoPointValue.longitude)===Dt(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Dt(s.integerValue)===Dt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=Dt(s.doubleValue),o=Dt(a.doubleValue);return i===o?Fh(i)===Fh(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Jo(t.arrayValue.values||[],e.arrayValue.values||[],Ts);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(k_(i)!==k_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Ts(i[l],o[l])))return!1;return!0}(t,e);default:return Ne(52216,{left:t})}}function Jc(t,e){return(t.values||[]).find(r=>Ts(r,e))!==void 0}function Zo(t,e){if(t===e)return 0;const r=Ga(t),n=Ga(e);if(r!==n)return He(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return He(t.booleanValue,e.booleanValue);case 2:return function(a,i){const o=Dt(a.integerValue||a.doubleValue),l=Dt(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return C_(t.timestampValue,e.timestampValue);case 4:return C_(Yc(t),Yc(e));case 5:return nm(t.stringValue,e.stringValue);case 6:return function(a,i){const o=Wa(a),l=Wa(i);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=He(o[c],l[c]);if(f!==0)return f}return He(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,i){const o=He(Dt(a.latitude),Dt(i.latitude));return o!==0?o:He(Dt(a.longitude),Dt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return N_(t.arrayValue,e.arrayValue);case 10:return function(a,i){var d,p,v,x;const o=a.fields||{},l=i.fields||{},c=(d=o[Lh])==null?void 0:d.arrayValue,f=(p=l[Lh])==null?void 0:p.arrayValue,h=He(((v=c==null?void 0:c.values)==null?void 0:v.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return h!==0?h:N_(c,f)}(t.mapValue,e.mapValue);case 11:return function(a,i){if(a===df.mapValue&&i===df.mapValue)return 0;if(a===df.mapValue)return 1;if(i===df.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=nm(l[h],f[h]);if(d!==0)return d;const p=Zo(o[l[h]],c[f[h]]);if(p!==0)return p}return He(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Ne(23264,{he:r})}}function C_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return He(t,e);const r=Ha(t),n=Ha(e),s=He(r.seconds,n.seconds);return s!==0?s:He(r.nanos,n.nanos)}function N_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=Zo(r[s],n[s]);if(a)return a}return He(r.length,n.length)}function el(t){return sm(t)}function sm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ha(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Wa(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ie.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=sm(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${sm(r.fields[i])}`;return s+"}"}(t.mapValue):Ne(61005,{value:t})}function Mf(t){switch(Ga(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=w0(t);return e?16+Mf(e):16;case 5:return 2*t.stringValue.length;case 6:return Wa(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,a)=>s+Mf(a),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return ei(n.fields,(a,i)=>{s+=a.length+Mf(i)}),s}(t.mapValue);default:throw Ne(13486,{value:t})}}function R_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function am(t){return!!t&&"integerValue"in t}function a1(t){return!!t&&"arrayValue"in t}function P_(t){return!!t&&"nullValue"in t}function D_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vf(t){return!!t&&"mapValue"in t}function I7(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[LS])==null?void 0:n.stringValue)===MS}function gc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ei(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=gc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=gc(t.arrayValue.values[r]);return e}return{...t}}function C7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===k7}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.value=e}static empty(){return new Xr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Vf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(r)}setAll(e){let r=fr.emptyPath(),n={},s=[];e.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=gc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());Vf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ts(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Vf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ei(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Xr(gc(this.value))}}function VS(t){const e=[];return ei(t.fields,(r,n)=>{const s=new fr([r]);if(Vf(n)){const a=VS(n.mapValue).fields;if(a.length===0)e.push(s);else for(const i of a)e.push(s.child(i))}else e.push(s)}),new cn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,r,n,s,a,i,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(e){return new kr(e,0,Fe.min(),Fe.min(),Fe.min(),Xr.empty(),0)}static newFoundDocument(e,r,n,s){return new kr(e,1,r,Fe.min(),n,s,0)}static newNoDocument(e,r){return new kr(e,2,r,Fe.min(),Fe.min(),Xr.empty(),0)}static newUnknownDocument(e,r){return new kr(e,3,r,Fe.min(),Fe.min(),Xr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,r){this.position=e,this.inclusive=r}}function b_(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],i=t.position[s];if(a.field.isKeyField()?n=Ie.comparator(Ie.fromName(i.referenceValue),r.key):n=Zo(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function F_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ts(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,r="asc"){this.field=e,this.dir=r}}function N7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{}class zt extends US{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new P7(e,r,n):r==="array-contains"?new F7(e,n):r==="in"?new O7(e,n):r==="not-in"?new L7(e,n):r==="array-contains-any"?new M7(e,n):new zt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new D7(e,n):new b7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Zo(r,this.value)):r!==null&&Ga(this.value)===Ga(r)&&this.matchesComparison(Zo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends US{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ts(e,r)}matches(e){return BS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BS(t){return t.op==="and"}function jS(t){return R7(t)&&BS(t)}function R7(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function im(t){if(t instanceof zt)return t.field.canonicalString()+t.op.toString()+el(t.value);if(jS(t))return t.filters.map(e=>im(e)).join(",");{const e=t.filters.map(r=>im(r)).join(",");return`${t.op}(${e})`}}function $S(t,e){return t instanceof zt?function(n,s){return s instanceof zt&&n.op===s.op&&n.field.isEqual(s.field)&&Ts(n.value,s.value)}(t,e):t instanceof ts?function(n,s){return s instanceof ts&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&$S(i,s.filters[o]),!0):!1}(t,e):void Ne(19439)}function zS(t){return t instanceof zt?function(r){return`${r.field.canonicalString()} ${r.op} ${el(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(zS).join(" ,")+"}"}(t):"Filter"}class P7 extends zt{constructor(e,r,n){super(e,r,n),this.key=Ie.fromName(n.referenceValue)}matches(e){const r=Ie.comparator(e.key,this.key);return this.matchesComparison(r)}}class D7 extends zt{constructor(e,r){super(e,"in",r),this.keys=HS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class b7 extends zt{constructor(e,r){super(e,"not-in",r),this.keys=HS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function HS(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Ie.fromName(n.referenceValue))}class F7 extends zt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return a1(r)&&Jc(r.arrayValue,this.value)}}class O7 extends zt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Jc(this.value.arrayValue,r)}}class L7 extends zt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Jc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Jc(this.value.arrayValue,r)}}class M7 extends zt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!a1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Jc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e,r=null,n=[],s=[],a=null,i=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.Te=null}}function O_(t,e=null,r=[],n=[],s=null,a=null,i=null){return new V7(t,e,r,n,s,a,i)}function i1(t){const e=Le(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>im(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),E0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>el(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>el(n)).join(",")),e.Te=r}return e.Te}function o1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!N7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!$S(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!F_(t.startAt,e.startAt)&&F_(t.endAt,e.endAt)}function om(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function U7(t,e,r,n,s,a,i,o){return new yu(t,e,r,n,s,a,i,o)}function l1(t){return new yu(t)}function L_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function WS(t){return t.collectionGroup!==null}function xc(t){const e=Le(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new Qt(fr.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Vh(a,n))}),r.has(fr.keyField().canonicalString())||e.Ie.push(new Vh(fr.keyField(),n))}return e.Ie}function xs(t){const e=Le(t);return e.Ee||(e.Ee=B7(e,xc(t))),e.Ee}function B7(t,e){if(t.limitType==="F")return O_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Vh(s.field,a)});const r=t.endAt?new Mh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Mh(t.startAt.position,t.startAt.inclusive):null;return O_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function lm(t,e){const r=t.filters.concat([e]);return new yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function cm(t,e,r){return new yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function T0(t,e){return o1(xs(t),xs(e))&&t.limitType===e.limitType}function GS(t){return`${i1(xs(t))}|lt:${t.limitType}`}function co(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>zS(s)).join(", ")}]`),E0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>el(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>el(s)).join(",")),`Target(${n})`}(xs(t))}; limitType=${t.limitType})`}function A0(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Ie.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of xc(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=b_(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,xc(n),s)||n.endAt&&!function(i,o,l){const c=b_(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,xc(n),s))}(t,e)}function j7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qS(t){return(e,r)=>{let n=!1;for(const s of xc(t)){const a=$7(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function $7(t,e,r){const n=t.field.isKeyField()?Ie.comparator(e.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?Zo(l,c):Ne(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ne(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ei(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return RS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7=new Tt(Ie.comparator);function Qs(){return z7}const KS=new Tt(Ie.comparator);function Gl(...t){let e=KS;for(const r of t)e=e.insert(r.key,r);return e}function XS(t){let e=KS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function gi(){return vc()}function YS(){return vc()}function vc(){return new Ki(t=>t.toString(),(t,e)=>t.isEqual(e))}const H7=new Tt(Ie.comparator),W7=new Qt(Ie.comparator);function We(...t){let e=W7;for(const r of t)e=e.add(r);return e}const G7=new Qt(He);function q7(){return G7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fh(e)?"-0":e}}function QS(t){return{integerValue:""+t}}function K7(t,e){return E7(e)?QS(e):c1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(){this._=void 0}}function X7(t,e,r){return t instanceof Uh?function(s,a){const i={fields:{[bS]:{stringValue:DS},[OS]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&s1(a)&&(a=w0(a)),a&&(i.fields[FS]=a),{mapValue:i}}(r,e):t instanceof Zc?ZS(t,e):t instanceof eu?ek(t,e):function(s,a){const i=JS(s,a),o=M_(i)+M_(s.Ae);return am(i)&&am(s.Ae)?QS(o):c1(s.serializer,o)}(t,e)}function Y7(t,e,r){return t instanceof Zc?ZS(t,e):t instanceof eu?ek(t,e):r}function JS(t,e){return t instanceof Bh?function(n){return am(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Uh extends S0{}class Zc extends S0{constructor(e){super(),this.elements=e}}function ZS(t,e){const r=tk(e);for(const n of t.elements)r.some(s=>Ts(s,n))||r.push(n);return{arrayValue:{values:r}}}class eu extends S0{constructor(e){super(),this.elements=e}}function ek(t,e){let r=tk(e);for(const n of t.elements)r=r.filter(s=>!Ts(s,n));return{arrayValue:{values:r}}}class Bh extends S0{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function M_(t){return Dt(t.integerValue||t.doubleValue)}function tk(t){return a1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Q7(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Zc&&s instanceof Zc||n instanceof eu&&s instanceof eu?Jo(n.elements,s.elements,Ts):n instanceof Bh&&s instanceof Bh?Ts(n.Ae,s.Ae):n instanceof Uh&&s instanceof Uh}(t.transform,e.transform)}class J7{constructor(e,r){this.version=e,this.transformResults=r}}class In{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new In}static exists(e){return new In(void 0,e)}static updateTime(e){return new In(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class k0{}function rk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new u1(t.key,In.none()):new _u(t.key,t.data,In.none());{const r=t.data,n=Xr.empty();let s=new Qt(fr.comparator);for(let a of e.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new ti(t.key,n,new cn(s.toArray()),In.none())}}function Z7(t,e,r){t instanceof _u?function(s,a,i){const o=s.value.clone(),l=U_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ti?function(s,a,i){if(!Uf(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=U_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(nk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,r)}function yc(t,e,r,n){return t instanceof _u?function(a,i,o,l){if(!Uf(a.precondition,i))return o;const c=a.value.clone(),f=B_(a.fieldTransforms,l,i);return c.setAll(f),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof ti?function(a,i,o,l){if(!Uf(a.precondition,i))return o;const c=B_(a.fieldTransforms,l,i),f=i.data;return f.setAll(nk(a)),f.setAll(c),i.convertToFoundDocument(i.version,f).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,i,o){return Uf(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,r)}function eV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=JS(n.transform,s||null);a!=null&&(r===null&&(r=Xr.empty()),r.set(n.field,a))}return r||null}function V_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Jo(n,s,(a,i)=>Q7(a,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _u extends k0{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ti extends k0{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function nk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function U_(t,e,r){const n=new Map;et(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const a=t[s],i=a.transform,o=e.data.field(a.field);n.set(a.field,Y7(i,o,r[s]))}return n}function B_(t,e,r){const n=new Map;for(const s of t){const a=s.transform,i=r.data.field(s.field);n.set(s.field,X7(a,i,e))}return n}class u1 extends k0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tV extends k0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&Z7(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=yc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=yc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YS();return this.mutations.forEach(s=>{const a=e.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=rk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),We())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(r,n)=>V_(r,n))&&Jo(this.baseMutations,e.baseMutations,(r,n)=>V_(r,n))}}class f1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){et(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return H7}();const a=e.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new f1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut,qe;function aV(t){switch(t){case ne.OK:return Ne(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Ne(15467,{code:t})}}function sk(t){if(t===void 0)return Ys("GRPC error has no .code"),ne.UNKNOWN;switch(t){case Ut.OK:return ne.OK;case Ut.CANCELLED:return ne.CANCELLED;case Ut.UNKNOWN:return ne.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return ne.INTERNAL;case Ut.UNAVAILABLE:return ne.UNAVAILABLE;case Ut.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Ut.NOT_FOUND:return ne.NOT_FOUND;case Ut.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Ut.ABORTED:return ne.ABORTED;case Ut.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Ut.DATA_LOSS:return ne.DATA_LOSS;default:return Ne(39323,{code:t})}}(qe=Ut||(Ut={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=new Oa([4294967295,4294967295],0);function j_(t){const e=iV().encode(t),r=new yS;return r.update(e),new Uint8Array(r.digest())}function $_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Oa([r,n],0),new Oa([s,a],0)]}class h1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ql(`Invalid padding: ${r}`);if(n<0)throw new ql(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ql(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ql(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Oa.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Oa.fromNumber(n)));return s.compare(oV)===1&&(s=new Oa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=j_(e),[n,s]=$_(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);if(!this.we(i))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new h1(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(e){if(this.ge===0)return;const r=j_(e),[n,s]=$_(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);this.Se(i)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ql extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new I0(Fe.min(),s,new Tt(He),Qs(),We())}}class Eu{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Eu(n,r,We(),We(),We())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class ak{constructor(e,r){this.targetId=e,this.Ce=r}}class ik{constructor(e,r,n=gr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class z_{constructor(){this.ve=0,this.Fe=H_(),this.Me=gr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=We(),r=We(),n=We();return this.Fe.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Ne(38017,{changeType:a})}}),new Eu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=H_()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class lV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qs(),this.Je=pf(),this.He=pf(),this.Ye=new Tt(He)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ne(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const a=s.target;if(om(a))if(n===0){const i=new Ie(a.path);this.et(r,i,kr.newNoDocument(i,Fe.min()))}else et(n===1,20013,{expectedCount:n});else{const i=this._t(r);if(i!==n){const o=this.ut(e),l=o?this.ct(o,e,i):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Wa(n).toUint8Array()}catch(l){if(l instanceof PS)return Qo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new h1(i,s,a)}catch(l){return Qo(l instanceof ql?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Ge.ht(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((a,i)=>{const o=this.ot(i);if(o){if(a.current&&om(o.target)){const l=new Ie(o.target.path);this.It(l).has(i)||this.Et(i,l)||this.et(i,l,kr.newNoDocument(l,e))}a.Be&&(r.set(i,a.ke()),a.qe())}});let n=We();this.He.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,i)=>i.setReadTime(e));const s=new I0(e,r,this.Ye,this.je,n);return this.je=Qs(),this.Je=pf(),this.He=pf(),this.Ye=new Tt(He),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new z_,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Qt(He),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Qt(He),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Se("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new z_),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function pf(){return new Tt(Ie.comparator)}function H_(){return new Tt(Ie.comparator)}const cV={asc:"ASCENDING",desc:"DESCENDING"},uV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fV={and:"AND",or:"OR"};class hV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function um(t,e){return t.useProto3Json||E0(e)?e:{value:e}}function jh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ok(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function dV(t,e){return jh(t,e.toTimestamp())}function vs(t){return et(!!t,49232),Fe.fromTimestamp(function(r){const n=Ha(r);return new dt(n.seconds,n.nanos)}(t))}function d1(t,e){return fm(t,e).canonicalString()}function fm(t,e){const r=function(s){return new it(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function lk(t){const e=it.fromString(t);return et(dk(e),10190,{key:e.toString()}),e}function hm(t,e){return d1(t.databaseId,e.path)}function Ld(t,e){const r=lk(e);if(r.get(1)!==t.databaseId.projectId)throw new Te(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Te(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ie(uk(r))}function ck(t,e){return d1(t.databaseId,e)}function pV(t){const e=lk(t);return e.length===4?it.emptyPath():uk(e)}function dm(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uk(t){return et(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function W_(t,e,r){return{name:hm(t,e),fields:r.value.mapValue.fields}}function mV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ne(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(c,f){return c.useProto3Json?(et(f===void 0||typeof f=="string",58123),gr.fromBase64String(f||"")):(et(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),gr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(c){const f=c.code===void 0?ne.UNKNOWN:sk(c.code);return new Te(f,c.message||"")}(i);r=new ik(n,s,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Ld(t,n.document.name),a=vs(n.document.updateTime),i=n.document.createTime?vs(n.document.createTime):Fe.min(),o=new Xr({mapValue:{fields:n.document.fields}}),l=kr.newFoundDocument(s,a,i,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new Bf(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Ld(t,n.document),a=n.readTime?vs(n.readTime):Fe.min(),i=kr.newNoDocument(s,a),o=n.removedTargetIds||[];r=new Bf([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Ld(t,n.document),a=n.removedTargetIds||[];r=new Bf([],a,s,null)}else{if(!("filter"in e))return Ne(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new sV(s,a),o=n.targetId;r=new ak(o,i)}}return r}function gV(t,e){let r;if(e instanceof _u)r={update:W_(t,e.key,e.value)};else if(e instanceof u1)r={delete:hm(t,e.key)};else if(e instanceof ti)r={update:W_(t,e.key,e.data),updateMask:SV(e.fieldMask)};else{if(!(e instanceof tV))return Ne(16599,{Vt:e.type});r={verify:hm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof Uh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Zc)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof eu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Bh)return{fieldPath:i.field.canonicalString(),increment:o.Ae};throw Ne(20930,{transform:i.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:dV(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ne(27497)}(t,e.precondition)),r}function xV(t,e){return t&&t.length>0?(et(e!==void 0,14353),t.map(r=>function(s,a){let i=s.updateTime?vs(s.updateTime):vs(a);return i.isEqual(Fe.min())&&(i=vs(a)),new J7(i,s.transformResults||[])}(r,e))):[]}function vV(t,e){return{documents:[ck(t,e.path)]}}function yV(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=ck(t,s);const a=function(c){if(c.length!==0)return hk(ts.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:uo(d.field),direction:wV(d.dir)}}(f))}(e.orderBy);i&&(r.structuredQuery.orderBy=i);const o=um(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:s}}function _V(t){let e=pV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){et(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let a=[];r.where&&(a=function(h){const d=fk(h);return d instanceof ts&&jS(d)?d.getFilters():[d]}(r.where));let i=[];r.orderBy&&(i=function(h){return h.map(d=>function(v){return new Vh(fo(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,E0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new Mh(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new Mh(p,d)}(r.endAt)),U7(e,s,i,a,o,"F",l,c)}function EV(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function fk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=fo(r.unaryFilter.field);return zt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=fo(r.unaryFilter.field);return zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=fo(r.unaryFilter.field);return zt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=fo(r.unaryFilter.field);return zt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}}(t):t.fieldFilter!==void 0?function(r){return zt.create(fo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>fk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}}(r.compositeFilter.op))}(t):Ne(30097,{filter:t})}function wV(t){return cV[t]}function TV(t){return uV[t]}function AV(t){return fV[t]}function uo(t){return{fieldPath:t.canonicalString()}}function fo(t){return fr.fromServerFormat(t.fieldPath)}function hk(t){return t instanceof zt?function(r){if(r.op==="=="){if(D_(r.value))return{unaryFilter:{field:uo(r.field),op:"IS_NAN"}};if(P_(r.value))return{unaryFilter:{field:uo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(D_(r.value))return{unaryFilter:{field:uo(r.field),op:"IS_NOT_NAN"}};if(P_(r.value))return{unaryFilter:{field:uo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uo(r.field),op:TV(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(s=>hk(s));return n.length===1?n[0]:{compositeFilter:{op:AV(r.op),filters:n}}}(t):Ne(54877,{filter:t})}function SV(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function dk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,r,n,s,a=Fe.min(),i=Fe.min(),o=gr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ta(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e){this.yt=e}}function IV(t){const e=_V({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(){this.Cn=new NV}addToCollectionParentIndex(e,r){return this.Cn.add(r),se.resolve()}getCollectionParents(e,r){return se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return se.resolve()}deleteFieldIndex(e,r){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,r){return se.resolve()}getDocumentsMatchingTarget(e,r){return se.resolve(null)}getIndexType(e,r){return se.resolve(0)}getFieldIndexes(e,r){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,r){return se.resolve(za.min())}getMinOffsetFromCollectionGroup(e,r){return se.resolve(za.min())}updateCollectionGroup(e,r,n){return se.resolve()}updateIndexEntries(e,r){return se.resolve()}}class NV{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Qt(it.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Qt(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pk=41943040;class qr{static withCacheSize(e){return new qr(e,qr.DEFAULT_COLLECTION_PERCENTILE,qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qr.DEFAULT_COLLECTION_PERCENTILE=10,qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qr.DEFAULT=new qr(pk,qr.DEFAULT_COLLECTION_PERCENTILE,qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qr.DISABLED=new qr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new tl(0)}static cr(){return new tl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="LruGarbageCollector",RV=1048576;function K_([t,e],[r,n]){const s=He(t,r);return s===0?He(e,n):s}class PV{constructor(e){this.Ir=e,this.buffer=new Qt(K_),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();K_(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class DV{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Se(q_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){pl(r)?Se(q_,"Ignoring IndexedDB error during garbage collection: ",r):await dl(r)}await this.Vr(3e5)})}}class bV{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return se.resolve(_0.ce);const n=new PV(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(G_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),G_):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,a,i,o,l,c;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,i=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),lo()<=ze.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-f}ms
	Determined least recently used ${s} in `+(o-i)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:h})))}}function FV(t,e){return new bV(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(){this.changes=new Ki(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,kr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&yc(n.mutation,s,cn.empty(),dt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,We()).next(()=>n))}getLocalViewOfDocuments(e,r,n=We()){const s=gi();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let i=Gl();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(e,r){const n=gi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,We()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(e,r,n,s){let a=Qs();const i=vc(),o=function(){return vc()}();return r.forEach((l,c)=>{const f=n.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof ti)?a=a.insert(c.key,c):f!==void 0?(i.set(c.key,f.mutation.getFieldMask()),yc(f.mutation,c,f.mutation.getFieldMask(),dt.now())):i.set(c.key,cn.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,f)=>i.set(c,f)),r.forEach((c,f)=>o.set(c,new LV(f,i.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=vc();let s=new Tt((i,o)=>i-o),a=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||cn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(s.get(o.batchId)||We()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=YS();f.forEach(d=>{if(!a.has(d)){const p=rk(r.get(d),n.get(d));p!==null&&h.set(d,p),a=a.add(d)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return se.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(i){return Ie.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):WS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):se.resolve(gi());let o=Xc,l=a;return i.next(c=>se.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(f)?se.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,We())).next(f=>({batchId:o,changes:XS(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ie(r)).next(n=>{let s=Gl();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let i=Gl();return this.indexManager.getCollectionParents(e,a).next(o=>se.forEach(o,l=>{const c=function(h,d){return new yu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(f=>{f.forEach((h,d)=>{i=i.insert(h,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const f=c.getKey();i.get(f)===null&&(i=i.insert(f,kr.newInvalidDocument(f)))});let o=Gl();return i.forEach((l,c)=>{const f=a.get(l);f!==void 0&&yc(f.mutation,c,cn.empty(),dt.now()),A0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return se.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:vs(s.createTime)}}(r)),se.resolve()}getNamedQuery(e,r){return se.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:IV(s.bundledQuery),readTime:vs(s.readTime)}}(r)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(){this.overlays=new Tt(Ie.comparator),this.qr=new Map}getOverlay(e,r){return se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=gi();return se.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.St(e,r,a)}),se.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),se.resolve()}getOverlaysForCollection(e,r,n){const s=gi(),a=r.length+1,i=new Ie(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return se.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new Tt((c,f)=>c-f);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=a.get(c.largestBatchId);f===null&&(f=gi(),a=a.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=gi(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=s)););return se.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new nV(r,n));let a=this.qr.get(r);a===void 0&&(a=We(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(){this.sessionToken=gr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(){this.Qr=new Qt(Zt.$r),this.Ur=new Qt(Zt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Zt(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Zt(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Ie(new it([])),n=new Zt(r,e),s=new Zt(r,e+1),a=[];return this.Ur.forEachInRange([n,s],i=>{this.Gr(i),a.push(i.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ie(new it([])),n=new Zt(r,e),s=new Zt(r,e+1);let a=We();return this.Ur.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(e){const r=new Zt(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Zt{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ie.comparator(e.key,r.key)||He(e.Yr,r.Yr)}static Kr(e,r){return He(e.Yr,r.Yr)||Ie.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(Zt.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new rV(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.Zr=this.Zr.add(new Zt(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(i)}lookupMutationBatch(e,r){return se.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),a=s<0?0:s;return se.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?n1:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Zt(r,0),s=new Zt(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,s],i=>{const o=this.Xr(i.Yr);a.push(o)}),se.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Qt(He);return r.forEach(s=>{const a=new Zt(s,0),i=new Zt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,i],o=>{n=n.add(o.Yr)})}),se.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Ie.isDocumentKey(a)||(a=a.child(""));const i=new Zt(new Ie(a),0);let o=new Qt(He);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)},i),se.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){et(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return se.forEach(r.mutations,s=>{const a=new Zt(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Zt(r,0),s=this.Zr.firstAfterOrEqual(n);return se.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e){this.ri=e,this.docs=function(){return new Tt(Ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return se.resolve(n?n.document.mutableCopy():kr.newInvalidDocument(r))}getEntries(e,r){let n=Qs();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():kr.newInvalidDocument(s))}),se.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Qs();const i=r.path,o=new Ie(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||x7(g7(f),n)<=0||(s.has(f.key)||A0(r,f))&&(a=a.insert(f.key,f.mutableCopy()))}return se.resolve(a)}getAllFromCollectionGroup(e,r,n,s){Ne(9500)}ii(e,r){return se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new zV(this)}getSize(e){return se.resolve(this.size)}}class zV extends OV{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),se.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e){this.persistence=e,this.si=new Ki(r=>i1(r),o1),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.oi=0,this._i=new p1,this.targetCount=0,this.ai=tl.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),se.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new tl(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,se.resolve()}updateTargetData(e,r){return this.Pr(r),se.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(a).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return se.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),se.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(e,i))}),se.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),se.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return se.resolve(n)}containsKey(e,r){return se.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,r){this.ui={},this.overlays={},this.ci=new _0(0),this.li=!1,this.li=!0,this.hi=new BV,this.referenceDelegate=e(this),this.Pi=new HV(this),this.indexManager=new CV,this.remoteDocumentCache=function(s){return new $V(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new kV(r),this.Ii=new VV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new UV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new jV(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Se("MemoryPersistence","Starting transaction:",e);const s=new WV(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(a=>this.referenceDelegate.di(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ai(e,r){return se.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class WV extends y7{constructor(e){super(),this.currentSequenceNumber=e}}class m1{constructor(e){this.persistence=e,this.Ri=new p1,this.Vi=null}static mi(e){return new m1(e)}get fi(){if(this.Vi)return this.Vi;throw Ne(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),se.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),se.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,n=>{const s=Ie.fromPath(n);return this.gi(e,s).next(a=>{a||r.removeEntry(s,Fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return se.or([()=>se.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class $h{constructor(e,r){this.persistence=e,this.pi=new Ki(n=>w7(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=FV(this,r)}static mi(e,r){return new $h(e,r)}Ei(){}di(e){return se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return se.forEach(this.pi,(n,s)=>this.br(e,n,s).next(a=>a?se.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,i=>this.br(e,i,r).next(o=>{o||(n++,a.removeEntry(i,Fe.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Mf(e.data.value)),r}br(e,r,n){return se.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return se.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=We(),s=We();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new g1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return y5()?8:_7(Dr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.ys(e,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.ws(e,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new GV;return this.Ss(e,r,i).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,i,o.size)})}).next(()=>a.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(lo()<=ze.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",co(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(lo()<=ze.DEBUG&&Se("QueryEngine","Query:",co(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(lo()<=ze.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",co(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xs(r))):se.resolve())}ys(e,r){if(L_(r))return se.resolve(null);let n=xs(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=cm(r,null,"F"),n=xs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=We(...a);return this.ps.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,i,l.readTime)?this.ys(e,cm(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,s){return L_(r)||s.isEqual(Fe.min())?se.resolve(null):this.ps.getDocuments(e,n).next(a=>{const i=this.Ds(r,a);return this.Cs(r,i,n,s)?se.resolve(null):(lo()<=ze.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),co(r)),this.vs(e,i,r,m7(s,Xc)).next(o=>o))})}Ds(e,r){let n=new Qt(qS(e));return r.forEach((s,a)=>{A0(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,r,n){return lo()<=ze.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",co(r)),this.ps.getDocumentsMatchingQuery(e,r,za.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="LocalStore",KV=3e8;class XV{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Tt(He),this.xs=new Ki(a=>i1(a),o1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function YV(t,e,r,n){return new XV(t,e,r,n)}async function gk(t,e){const r=Le(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=We();for(const c of s){i.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of a){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:i,addedBatchIds:o}))})})}function QV(t,e){const r=Le(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let p=se.resolve();return d.forEach(v=>{p=p.next(()=>f.getEntry(l,v)).next(x=>{const E=c.docVersions.get(v);et(E!==null,48541),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),f.addEntry(x)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=We();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function xk(t){const e=Le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function JV(t,e){const r=Le(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=s.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(a,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,f.addedDocuments,h)));let p=d.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(gr.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),s=s.insert(h,p),function(x,E,A){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=KV?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(d,p,f)&&o.push(r.Pi.updateTargetData(a,p))});let l=Qs(),c=We();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,f))}),o.push(ZV(a,i,e.documentUpdates).next(f=>{l=f.ks,c=f.qs})),!n.isEqual(Fe.min())){const f=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(f)}return se.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=s,a))}function ZV(t,e,r){let n=We(),s=We();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let i=Qs();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Fe.min())?(e.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),i=i.insert(o,l)):Se(x1,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:i,qs:s}})}function eU(t,e){const r=Le(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=n1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function tU(t,e){const r=Le(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(a=>a?(s=a,se.resolve(s)):r.Pi.allocateTargetId(n).next(i=>(s=new Ta(e,i,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function pm(t,e,r){const n=Le(t),s=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!pl(i))throw i;Se(x1,`Failed to update sequence numbers for target ${e}: ${i}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function X_(t,e,r){const n=Le(t);let s=Fe.min(),a=We();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,f){const h=Le(l),d=h.xs.get(f);return d!==void 0?se.resolve(h.Ms.get(d)):h.Pi.getTargetData(c,f)}(n,i,xs(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(i,e,r?s:Fe.min(),r?a:We())).next(o=>(rU(n,j7(e),o),{documents:o,Qs:a})))}function rU(t,e,r){let n=t.Os.get(e)||Fe.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class Y_{constructor(){this.activeTargetIds=q7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nU{constructor(){this.Mo=new Y_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Y_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_="ConnectivityMonitor";class J_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Se(Q_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Se(Q_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf=null;function mm(){return mf===null?mf=function(){return 268435456+Math.round(2147483648*Math.random())}():mf++,"0x"+mf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md="RestConnection",aU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Oh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,a){const i=mm(),o=this.zo(e,r.toUriEncodedString());Se(Md,`Sending RPC '${e}' ${i}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,a);const{host:c}=new URL(o),f=cl(c);return this.Jo(e,o,l,n,f).then(h=>(Se(Md,`Received RPC '${e}' ${i}: `,h),h),h=>{throw Qo(Md,`RPC '${e}' ${i} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,a,i){return this.Go(e,r,n,s,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>e[a]=s),n&&n.headers.forEach((s,a)=>e[a]=s)}zo(e,r){const n=aU[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr="WebChannelConnection";class lU extends iU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,a){const i=mm();return new Promise((o,l)=>{const c=new _S;c.setWithCredentials(!0),c.listenOnce(ES.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Lf.NO_ERROR:const h=c.getResponseJson();Se(wr,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Lf.TIMEOUT:Se(wr,`RPC '${e}' ${i} timed out`),l(new Te(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Lf.HTTP_ERROR:const d=c.getStatus();if(Se(wr,`RPC '${e}' ${i} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const x=function(A){const _=A.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(_)>=0?_:ne.UNKNOWN}(v.status);l(new Te(x,v.message))}else l(new Te(ne.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Te(ne.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{l_:e,streamId:i,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Se(wr,`RPC '${e}' ${i} completed.`)}});const f=JSON.stringify(s);Se(wr,`RPC '${e}' ${i} sending request:`,s),c.send(r,"POST",f,n,15)})}T_(e,r,n){const s=mm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=AS(),o=TS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=a.join("");Se(wr,`Creating RPC '${e}' stream ${s}: ${f}`,l);const h=i.createWebChannel(f,l);this.I_(h);let d=!1,p=!1;const v=new oU({Yo:E=>{p?Se(wr,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(d||(Se(wr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Se(wr,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Zo:()=>h.close()}),x=(E,A,_)=>{E.listen(A,y=>{try{_(y)}catch(M){setTimeout(()=>{throw M},0)}})};return x(h,Wl.EventType.OPEN,()=>{p||(Se(wr,`RPC '${e}' stream ${s} transport opened.`),v.o_())}),x(h,Wl.EventType.CLOSE,()=>{p||(p=!0,Se(wr,`RPC '${e}' stream ${s} transport closed`),v.a_(),this.E_(h))}),x(h,Wl.EventType.ERROR,E=>{p||(p=!0,Qo(wr,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new Te(ne.UNAVAILABLE,"The operation could not be completed")))}),x(h,Wl.EventType.MESSAGE,E=>{var A;if(!p){const _=E.data[0];et(!!_,16349);const y=_,M=(y==null?void 0:y.error)||((A=y[0])==null?void 0:A.error);if(M){Se(wr,`RPC '${e}' stream ${s} received error:`,M);const z=M.status;let B=function(I){const R=Ut[I];if(R!==void 0)return sk(R)}(z),w=M.message;B===void 0&&(B=ne.INTERNAL,w="Unknown error status: "+z+" with message "+M.message),p=!0,v.a_(new Te(B,w)),h.close()}else Se(wr,`RPC '${e}' stream ${s} received:`,_),v.u_(_)}}),x(o,wS.STAT_EVENT,E=>{E.stat===rm.PROXY?Se(wr,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===rm.NOPROXY&&Se(wr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Vd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(t){return new hV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e,r,n=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="PersistentStream";class yk{constructor(e,r,n,s,a,i,o,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vk(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(Ys(r.toString()),Ys("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Te(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Se(Z_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Se(Z_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cU extends yk{constructor(e,r,n,s,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=mV(this.serializer,e),n=function(a){if(!("targetChange"in a))return Fe.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Fe.min():i.readTime?vs(i.readTime):Fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=dm(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=om(l)?{documents:vV(a,l)}:{query:yV(a,l).ft},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=ok(a,i.resumeToken);const c=um(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Fe.min())>0){o.readTime=jh(a,i.snapshotVersion.toTimestamp());const c=um(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=EV(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=dm(this.serializer),r.removeTarget=e,this.q_(r)}}class uU extends yk{constructor(e,r,n,s,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=xV(e.writeResults,e.commitTime),n=vs(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=dm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>gV(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{}class hU extends fU{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Te(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Go(e,fm(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Te(ne.UNKNOWN,a.toString())})}Ho(e,r,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(e,fm(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(ne.UNKNOWN,i.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class dU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ys(r),this.aa=!1):Se("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi="RemoteStore";class pU{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(i=>{n.enqueueAndForget(async()=>{Xi(this)&&(Se(Fi,"Restarting streams for network reachability change."),await async function(l){const c=Le(l);c.Ea.add(4),await wu(c),c.Ra.set("Unknown"),c.Ea.delete(4),await N0(c)}(this))})}),this.Ra=new dU(n,s)}}async function N0(t){if(Xi(t))for(const e of t.da)await e(!0)}async function wu(t){for(const e of t.da)await e(!1)}function _k(t,e){const r=Le(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),E1(r)?_1(r):ml(r).O_()&&y1(r,e))}function v1(t,e){const r=Le(t),n=ml(r);r.Ia.delete(e),n.O_()&&Ek(r,e),r.Ia.size===0&&(n.O_()?n.L_():Xi(r)&&r.Ra.set("Unknown"))}function y1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}ml(t).Y_(e)}function Ek(t,e){t.Va.Ue(e),ml(t).Z_(e)}function _1(t){t.Va=new lV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ml(t).start(),t.Ra.ua()}function E1(t){return Xi(t)&&!ml(t).x_()&&t.Ia.size>0}function Xi(t){return Le(t).Ea.size===0}function wk(t){t.Va=void 0}async function mU(t){t.Ra.set("Online")}async function gU(t){t.Ia.forEach((e,r)=>{y1(t,e)})}async function xU(t,e){wk(t),E1(t)?(t.Ra.ha(e),_1(t)):t.Ra.set("Unknown")}async function vU(t,e,r){if(t.Ra.set("Online"),e instanceof ik&&e.state===2&&e.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Se(Fi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await zh(t,n)}else if(e instanceof Bf?t.Va.Ze(e):e instanceof ak?t.Va.st(e):t.Va.tt(e),!r.isEqual(Fe.min()))try{const n=await xk(t.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Va.Tt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=a.Ia.get(c);f&&a.Ia.set(c,f.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const f=a.Ia.get(l);if(!f)return;a.Ia.set(l,f.withResumeToken(gr.EMPTY_BYTE_STRING,f.snapshotVersion)),Ek(a,l);const h=new Ta(f.target,l,c,f.sequenceNumber);y1(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Se(Fi,"Failed to raise snapshot:",n),await zh(t,n)}}async function zh(t,e,r){if(!pl(e))throw e;t.Ea.add(1),await wu(t),t.Ra.set("Offline"),r||(r=()=>xk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Se(Fi,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await N0(t)})}function Tk(t,e){return e().catch(r=>zh(t,r,e))}async function R0(t){const e=Le(t),r=qa(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:n1;for(;yU(e);)try{const s=await eU(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,_U(e,s)}catch(s){await zh(e,s)}Ak(e)&&Sk(e)}function yU(t){return Xi(t)&&t.Ta.length<10}function _U(t,e){t.Ta.push(e);const r=qa(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Ak(t){return Xi(t)&&!qa(t).x_()&&t.Ta.length>0}function Sk(t){qa(t).start()}async function EU(t){qa(t).ra()}async function wU(t){const e=qa(t);for(const r of t.Ta)e.ea(r.mutations)}async function TU(t,e,r){const n=t.Ta.shift(),s=f1.from(n,e,r);await Tk(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await R0(t)}async function AU(t,e){e&&qa(t).X_&&await async function(n,s){if(function(i){return aV(i)&&i!==ne.ABORTED}(s.code)){const a=n.Ta.shift();qa(n).B_(),await Tk(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await R0(n)}}(t,e),Ak(t)&&Sk(t)}async function eE(t,e){const r=Le(t);r.asyncQueue.verifyOperationInProgress(),Se(Fi,"RemoteStore received new credentials");const n=Xi(r);r.Ea.add(3),await wu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await N0(r)}async function SU(t,e){const r=Le(t);e?(r.Ea.delete(2),await N0(r)):e||(r.Ea.add(2),await wu(r),r.Ra.set("Unknown"))}function ml(t){return t.ma||(t.ma=function(r,n,s){const a=Le(r);return a.sa(),new cU(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:mU.bind(null,t),t_:gU.bind(null,t),r_:xU.bind(null,t),H_:vU.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),E1(t)?_1(t):t.Ra.set("Unknown")):(await t.ma.stop(),wk(t))})),t.ma}function qa(t){return t.fa||(t.fa=function(r,n,s){const a=Le(r);return a.sa(),new uU(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:EU.bind(null,t),r_:AU.bind(null,t),ta:wU.bind(null,t),na:TU.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await R0(t)):(await t.fa.stop(),t.Ta.length>0&&(Se(Fi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new $s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const i=Date.now()+n,o=new w1(e,r,i,s,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function T1(t,e){if(Ys("AsyncQueue",`${e}: ${t}`),pl(t))return new Te(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{static emptySet(e){return new Uo(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ie.comparator(r.key,n.key):(r,n)=>Ie.comparator(r.key,n.key),this.keyedMap=Gl(),this.sortedSet=new Tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Uo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Uo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(){this.ga=new Tt(Ie.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ne(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class rl{constructor(e,r,n,s,a,i,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new rl(e,r,Uo.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&T0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class IU{constructor(){this.queries=rE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Le(r),a=s.queries;s.queries=rE(),a.forEach((i,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new Te(ne.ABORTED,"Firestore shutting down"))}}function rE(){return new Ki(t=>GS(t),T0)}async function kk(t,e){const r=Le(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.ba()&&e.Da()&&(n=2):(a=new kU,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(s,!0);break;case 1:a.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=T1(i,`Initialization of query '${co(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&A1(r)}async function Ik(t,e){const r=Le(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const i=a.Sa.indexOf(e);i>=0&&(a.Sa.splice(i,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function CU(t,e){const r=Le(t);let n=!1;for(const s of e){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.Sa)o.Fa(s)&&(n=!0);i.wa=s}}n&&A1(r)}function NU(t,e,r){const n=Le(t),s=n.queries.get(e);if(s)for(const a of s.Sa)a.onError(r);n.queries.delete(e)}function A1(t){t.Ca.forEach(e=>{e.next()})}var gm,nE;(nE=gm||(gm={})).Ma="default",nE.Cache="cache";class Ck{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new rl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=rl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.key=e}}class Rk{constructor(e){this.key=e}}class RU{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=We(),this.mutatedKeys=We(),this.eu=qS(e),this.tu=new Uo(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new tE,s=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,h)=>{const d=s.get(f),p=A0(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),x=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;d&&p?d.data.isEqual(p.data)?v!==x&&(n.track({type:3,doc:p}),E=!0):this.su(d,p)||(n.track({type:2,doc:p}),E=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),E=!0):d&&!p&&(n.track({type:1,doc:d}),E=!0,(l||c)&&(o=!0)),E&&(p?(i=i.add(p),a=x?a.add(f):a.delete(f)):(i=i.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{tu:i,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((f,h)=>function(p,v){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Rt:E})}};return x(p)-x(v)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,i.length!==0||c?{snapshot:new rl(this.query,e.tu,a,i,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new tE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=We(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Rk(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Nk(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=We();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return rl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const S1="SyncEngine";class PU{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class DU{constructor(e){this.key=e,this.hu=!1}}class bU{constructor(e,r,n,s,a,i){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Ki(o=>GS(o),T0),this.Iu=new Map,this.Eu=new Set,this.du=new Tt(Ie.comparator),this.Au=new Map,this.Ru=new p1,this.Vu={},this.mu=new Map,this.fu=tl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FU(t,e,r=!0){const n=Lk(t);let s;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await Pk(n,e,r,!0),s}async function OU(t,e){const r=Lk(t);await Pk(r,e,!0,!1)}async function Pk(t,e,r,n){const s=await tU(t.localStore,xs(e)),a=s.targetId,i=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await LU(t,e,a,i==="current",s.resumeToken)),t.isPrimaryClient&&r&&_k(t.remoteStore,s),o}async function LU(t,e,r,n,s){t.pu=(h,d,p)=>async function(x,E,A,_){let y=E.view.ru(A);y.Cs&&(y=await X_(x.localStore,E.query,!1).then(({documents:w})=>E.view.ru(w,y)));const M=_&&_.targetChanges.get(E.targetId),z=_&&_.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(y,x.isPrimaryClient,M,z);return aE(x,E.targetId,B.au),B.snapshot}(t,h,d,p);const a=await X_(t.localStore,e,!0),i=new RU(e,a.Qs),o=i.ru(a.documents),l=Eu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=i.applyChanges(o,t.isPrimaryClient,l);aE(t,r,c.au);const f=new PU(e,r,i);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function MU(t,e,r){const n=Le(t),s=n.Tu.get(e),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter(i=>!T0(i,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await pm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&v1(n.remoteStore,s.targetId),xm(n,s.targetId)}).catch(dl)):(xm(n,s.targetId),await pm(n.localStore,s.targetId,!0))}async function VU(t,e){const r=Le(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),v1(r.remoteStore,n.targetId))}async function UU(t,e,r){const n=GU(t);try{const s=await function(i,o){const l=Le(i),c=dt.now(),f=o.reduce((p,v)=>p.add(v.key),We());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Qs(),x=We();return l.Ns.getEntries(p,f).next(E=>{v=E,v.forEach((A,_)=>{_.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(E=>{h=E;const A=[];for(const _ of o){const y=eV(_,h.get(_.key).overlayedDocument);y!=null&&A.push(new ti(_.key,y,VS(y.value.mapValue),In.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,A,o)}).next(E=>{d=E;const A=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(p,E.batchId,A)})}).then(()=>({batchId:d.batchId,changes:XS(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Vu[i.currentUser.toKey()];c||(c=new Tt(He)),c=c.insert(o,l),i.Vu[i.currentUser.toKey()]=c}(n,s.batchId,r),await Tu(n,s.changes),await R0(n.remoteStore)}catch(s){const a=T1(s,"Failed to persist write");r.reject(a)}}async function Dk(t,e){const r=Le(t);try{const n=await JV(r.localStore,e);e.targetChanges.forEach((s,a)=>{const i=r.Au.get(a);i&&(et(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?i.hu=!0:s.modifiedDocuments.size>0?et(i.hu,14607):s.removedDocuments.size>0&&(et(i.hu,42227),i.hu=!1))}),await Tu(r,n,e)}catch(n){await dl(n)}}function sE(t,e,r){const n=Le(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((a,i)=>{const o=i.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Le(i);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(c=!0)}),c&&A1(l)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function BU(t,e,r){const n=Le(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),a=s&&s.key;if(a){let i=new Tt(Ie.comparator);i=i.insert(a,kr.newNoDocument(a,Fe.min()));const o=We().add(a),l=new I0(Fe.min(),new Map,new Tt(He),i,o);await Dk(n,l),n.du=n.du.remove(a),n.Au.delete(e),k1(n)}else await pm(n.localStore,e,!1).then(()=>xm(n,e,r)).catch(dl)}async function jU(t,e){const r=Le(t),n=e.batch.batchId;try{const s=await QV(r.localStore,e);Fk(r,n,null),bk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Tu(r,s)}catch(s){await dl(s)}}async function $U(t,e,r){const n=Le(t);try{const s=await function(i,o){const l=Le(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(et(h!==null,37113),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);Fk(n,e,r),bk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Tu(n,s)}catch(s){await dl(s)}}function bk(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Fk(t,e,r){const n=Le(t);let s=n.Vu[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function xm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Ok(t,n)})}function Ok(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(v1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),k1(t))}function aE(t,e,r){for(const n of r)n instanceof Nk?(t.Ru.addReference(n.key,e),zU(t,n)):n instanceof Rk?(Se(S1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Ok(t,n.key)):Ne(19791,{wu:n})}function zU(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Se(S1,"New document in limbo: "+r),t.Eu.add(n),k1(t))}function k1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ie(it.fromString(e)),n=t.fu.next();t.Au.set(n,new DU(r)),t.du=t.du.insert(r,n),_k(t.remoteStore,new Ta(xs(l1(r.path)),n,"TargetPurposeLimboResolution",_0.ce))}}async function Tu(t,e,r){const n=Le(t),s=[],a=[],i=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{i.push(n.pu(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=g1.As(l.targetId,c);a.push(h)}}))}),await Promise.all(i),n.Pu.H_(s),await async function(l,c){const f=Le(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>se.forEach(c,d=>se.forEach(d.Es,p=>f.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>se.forEach(d.ds,p=>f.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!pl(h))throw h;Se(x1,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=f.Ms.get(d),v=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(v);f.Ms=f.Ms.insert(d,x)}}}(n.localStore,a))}async function HU(t,e){const r=Le(t);if(!r.currentUser.isEqual(e)){Se(S1,"User change. New user:",e.toKey());const n=await gk(r.localStore,e);r.currentUser=e,function(a,i){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new Te(ne.CANCELLED,i))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Tu(r,n.Ls)}}function WU(t,e){const r=Le(t),n=r.Au.get(e);if(n&&n.hu)return We().add(n.key);{let s=We();const a=r.Iu.get(e);if(!a)return s;for(const i of a){const o=r.Tu.get(i);s=s.unionWith(o.view.nu)}return s}}function Lk(t){const e=Le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=WU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BU.bind(null,e),e.Pu.H_=CU.bind(null,e.eventManager),e.Pu.yu=NU.bind(null,e.eventManager),e}function GU(t){const e=Le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$U.bind(null,e),e}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=C0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return YV(this.persistence,new qV,e.initialUser,this.serializer)}Cu(e){return new mk(m1.mi,this.serializer)}Du(e){return new nU}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class qU extends Hh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){et(this.persistence.referenceDelegate instanceof $h,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new DV(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?qr.withCacheSize(this.cacheSizeBytes):qr.DEFAULT;return new mk(n=>$h.mi(n,r),this.serializer)}}class vm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>sE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=HU.bind(null,this.syncEngine),await SU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new IU}()}createDatastore(e){const r=C0(e.databaseInfo.databaseId),n=function(a){return new lU(a)}(e.databaseInfo);return function(a,i,o,l){return new hU(a,i,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,i,o){return new pU(n,s,a,i,o)}(this.localStore,this.datastore,e.asyncQueue,r=>sE(this.syncEngine,r,0),function(){return J_.v()?new J_:new sU}())}createSyncEngine(e,r){return function(s,a,i,o,l,c,f){const h=new bU(s,a,i,o,l,c);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Le(s);Se(Fi,"RemoteStore shutting down."),a.Ea.add(5),await wu(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}vm.provider={build:()=>new vm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ys("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka="FirestoreClient";class KU{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Tr.UNAUTHENTICATED,this.clientId=r1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{Se(Ka,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Se(Ka,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=T1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ud(t,e){t.asyncQueue.verifyOperationInProgress(),Se(Ka,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await gk(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function iE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await XU(t);Se(Ka,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>eE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>eE(e.remoteStore,s)),t._onlineComponents=e}async function XU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Se(Ka,"Using user provided OfflineComponentProvider");try{await Ud(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ne.FAILED_PRECONDITION||s.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Qo("Error using user provided cache. Falling back to memory cache: "+r),await Ud(t,new Hh)}}else Se(Ka,"Using default OfflineComponentProvider"),await Ud(t,new qU(void 0));return t._offlineComponents}async function Vk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Se(Ka,"Using user provided OnlineComponentProvider"),await iE(t,t._uninitializedComponentsProvider._online)):(Se(Ka,"Using default OnlineComponentProvider"),await iE(t,new vm))),t._onlineComponents}function YU(t){return Vk(t).then(e=>e.syncEngine)}async function Uk(t){const e=await Vk(t),r=e.eventManager;return r.onListen=FU.bind(null,e.syncEngine),r.onUnlisten=MU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=OU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=VU.bind(null,e.syncEngine),r}function QU(t,e,r={}){const n=new $s;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Mk({next:d=>{f.Nu(),i.enqueueAndForget(()=>Ik(a,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Te(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Te(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Ck(l1(o.path),f,{includeMetadataChanges:!0,qa:!0});return kk(a,h)}(await Uk(t),t.asyncQueue,e,r,n)),n.promise}function JU(t,e,r={}){const n=new $s;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Mk({next:d=>{f.Nu(),i.enqueueAndForget(()=>Ik(a,h)),d.fromCache&&l.source==="server"?c.reject(new Te(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Ck(o,f,{includeMetadataChanges:!0,qa:!0});return kk(a,h)}(await Uk(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk="firestore.googleapis.com",lE=!0;class cE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jk,this.ssl=lE}else this.host=e.host,this.ssl=e.ssl??lE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RV)throw new Te(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}p7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bk(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Te(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Te(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Te(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class P0{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new s7;switch(n.type){case"firstParty":return new l7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=oE.get(r);n&&(Se("ComponentProvider","Removing Datastore"),oE.delete(r),n.terminate())}(this),Promise.resolve()}}function ZU(t,e,r,n={}){var c;t=es(t,P0);const s=cl(e),a=t._getSettings(),i={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(CA(`https://${o}`),NA("Firestore",!0)),a.host!==jk&&a.host!==o&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:s,emulatorOptions:n};if(!$a(l,i)&&(t._setSettings(l),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=Tr.MOCK_USER;else{f=f5(n.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Te(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Tr(d)}t._authCredentials=new a7(new kS(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new gl(this.firestore,e,this._query)}}class Ft{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new La(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}toJSON(){return{type:Ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(vu(r,Ft._jsonSchema))return new Ft(e,n||null,new Ie(it.fromString(r.referencePath)))}}Ft._jsonSchemaVersion="firestore/documentReference/1.0",Ft._jsonSchema={type:Ht("string",Ft._jsonSchemaVersion),referencePath:Ht("string")};class La extends gl{constructor(e,r,n){super(e,r,l1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new Ie(e))}withConverter(e){return new La(this.firestore,e,this._path)}}function ym(t,e,...r){if(t=Ot(t),IS("collection","path",e),t instanceof P0){const n=it.fromString(e,...r);return w_(n),new La(t,null,n)}{if(!(t instanceof Ft||t instanceof La))throw new Te(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(it.fromString(e,...r));return w_(n),new La(t.firestore,null,n)}}function Ma(t,e,...r){if(t=Ot(t),arguments.length===1&&(e=r1.newId()),IS("doc","path",e),t instanceof P0){const n=it.fromString(e,...r);return E_(n),new Ft(t,null,new Ie(n))}{if(!(t instanceof Ft||t instanceof La))throw new Te(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(it.fromString(e,...r));return E_(n),new Ft(t.firestore,t instanceof La?t.converter:null,new Ie(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="AsyncQueue";class fE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vk(this,"async_queue_retry"),this._c=()=>{const n=Vd();n&&Se(uE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Vd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Vd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new $s;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!pl(e))throw e;Se(uE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Ys("INTERNAL UNHANDLED ERROR: ",hE(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=w1.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(s),s}uc(){this.nc&&Ne(47125,{Pc:hE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function hE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Yi extends P0{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new fE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fE(e),this._firestoreClient=void 0,await e}}}function eB(t,e){const r=typeof t=="object"?t:Gg(),n=typeof t=="string"?t:Oh,s=Gi(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=c5("firestore");a&&ZU(s,...a)}return s}function I1(t){if(t._terminated)throw new Te(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tB(t),t._firestoreClient}function tB(t){var n,s,a;const e=t._freezeSettings(),r=function(o,l,c,f){return new S7(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Bk(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new KU(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tn(gr.fromBase64String(e))}catch(r){throw new Te(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Tn(gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vu(e,Tn._jsonSchema))return Tn.fromBase64String(e.bytes)}}Tn._jsonSchemaVersion="firestore/bytes/1.0",Tn._jsonSchema={type:Ht("string",Tn._jsonSchemaVersion),bytes:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Te(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Te(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Te(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ys._jsonSchemaVersion}}static fromJSON(e){if(vu(e,ys._jsonSchema))return new ys(e.latitude,e.longitude)}}ys._jsonSchemaVersion="firestore/geoPoint/1.0",ys._jsonSchema={type:Ht("string",ys._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:_s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vu(e,_s._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new _s(e.vectorValues);throw new Te(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_s._jsonSchemaVersion="firestore/vectorValue/1.0",_s._jsonSchema={type:Ht("string",_s._jsonSchemaVersion),vectorValues:Ht("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB=/^__.*__$/;class nB{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ti(e,this.data,this.fieldMask,r,this.fieldTransforms):new _u(e,this.data,r,this.fieldTransforms)}}class $k{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ti(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function zk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ac:t})}}class N1{constructor(e,r,n,s,a,i){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new N1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(zk(this.Ac)&&rB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class sB{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||C0(e)}Cc(e,r,n,s=!1){return new N1({Ac:e,methodName:r,Dc:n,path:fr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function b0(t){const e=t._freezeSettings(),r=C0(t._databaseId);return new sB(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hk(t,e,r,n,s,a={}){const i=t.Cc(a.merge||a.mergeFields?2:0,e,r,s);R1("Data must be an object, but it was:",i,n);const o=Wk(n,i);let l,c;if(a.merge)l=new cn(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const f=[];for(const h of a.mergeFields){const d=_m(e,h,r);if(!i.contains(d))throw new Te(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);qk(f,d)||f.push(d)}l=new cn(f),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new nB(new Xr(o),l,c)}class F0 extends C1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof F0}}function aB(t,e,r,n){const s=t.Cc(1,e,r);R1("Data must be an object, but it was:",s,n);const a=[],i=Xr.empty();ei(n,(l,c)=>{const f=P1(e,l,r);c=Ot(c);const h=s.yc(f);if(c instanceof F0)a.push(f);else{const d=Au(c,h);d!=null&&(a.push(f),i.set(f,d))}});const o=new cn(a);return new $k(i,o,s.fieldTransforms)}function iB(t,e,r,n,s,a){const i=t.Cc(1,e,r),o=[_m(e,n,r)],l=[s];if(a.length%2!=0)throw new Te(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<a.length;d+=2)o.push(_m(e,a[d])),l.push(a[d+1]);const c=[],f=Xr.empty();for(let d=o.length-1;d>=0;--d)if(!qk(c,o[d])){const p=o[d];let v=l[d];v=Ot(v);const x=i.yc(p);if(v instanceof F0)c.push(p);else{const E=Au(v,x);E!=null&&(c.push(p),f.set(p,E))}}const h=new cn(c);return new $k(f,h,i.fieldTransforms)}function oB(t,e,r,n=!1){return Au(r,t.Cc(n?4:3,e))}function Au(t,e){if(Gk(t=Ot(t)))return R1("Unsupported field value:",e,t),Wk(t,e);if(t instanceof C1)return function(n,s){if(!zk(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Au(o,s.wc(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=Ot(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return K7(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=dt.fromDate(n);return{timestampValue:jh(s.serializer,a)}}if(n instanceof dt){const a=new dt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:jh(s.serializer,a)}}if(n instanceof ys)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Tn)return{bytesValue:ok(s.serializer,n._byteString)};if(n instanceof Ft){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:d1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof _s)return function(i,o){return{mapValue:{fields:{[LS]:{stringValue:MS},[Lh]:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return c1(o.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${y0(n)}`)}(t,e)}function Wk(t,e){const r={};return RS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ei(t,(n,s)=>{const a=Au(s,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function Gk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dt||t instanceof ys||t instanceof Tn||t instanceof Ft||t instanceof C1||t instanceof _s)}function R1(t,e,r){if(!Gk(r)||!CS(r)){const n=y0(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function _m(t,e,r){if((e=Ot(e))instanceof D0)return e._internalPath;if(typeof e=="string")return P1(t,e);throw Wh("Field path arguments must be of type string or ",t,!1,void 0,r)}const lB=new RegExp("[~\\*/\\[\\]]");function P1(t,e,r){if(e.search(lB)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new D0(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Wh(t,e,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Te(ne.INVALID_ARGUMENT,o+t+l)}function qk(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(D1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class cB extends Kk{data(){return super.data()}}function D1(t,e){return typeof e=="string"?P1(t,e):e instanceof D0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class b1{}class fB extends b1{}function Xk(t,e,...r){let n=[];e instanceof b1&&n.push(e),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof F1).length,o=a.filter(l=>l instanceof O0).length;if(i>1||i>0&&o>0)throw new Te(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class O0 extends fB{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new O0(e,r,n)}_apply(e){const r=this._parse(e);return Qk(e._query,r),new gl(e.firestore,e.converter,lm(e._query,r))}_parse(e){const r=b0(e.firestore);return function(a,i,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Te(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){pE(h,f);const v=[];for(const x of h)v.push(dE(l,a,x));d={arrayValue:{values:v}}}else d=dE(l,a,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||pE(h,f),d=oB(o,i,h,f==="in"||f==="not-in");return zt.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Yk(t,e,r){const n=e,s=D1("where",t);return O0._create(s,n,r)}class F1 extends b1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new F1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)Qk(i,l),i=lm(i,l)}(e._query,r),new gl(e.firestore,e.converter,lm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function dE(t,e,r){if(typeof(r=Ot(r))=="string"){if(r==="")throw new Te(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!WS(e)&&r.indexOf("/")!==-1)throw new Te(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(it.fromString(r));if(!Ie.isDocumentKey(n))throw new Te(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return R_(t,new Ie(n))}if(r instanceof Ft)return R_(t,r._key);throw new Te(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${y0(r)}.`)}function pE(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Qk(t,e){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Te(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class hB{convertValue(e,r="none"){switch(Ga(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ei(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var n,s,a;const r=(a=(s=(n=e.fields)==null?void 0:n[Lh].arrayValue)==null?void 0:s.values)==null?void 0:a.map(i=>Dt(i.doubleValue));return new _s(r)}convertGeoPoint(e){return new ys(Dt(e.latitude),Dt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=w0(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const r=Ha(e);return new dt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=it.fromString(e);et(dk(n),9688,{name:e});const s=new Qc(n.get(1),n.get(3)),a=new Ie(n.popFirst(5));return s.isEqual(r)||Ys(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Kl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wi extends Kk{constructor(e,r,n,s,a,i){super(e,r,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new jf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(D1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=wi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",wi._jsonSchema={type:Ht("string",wi._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class jf extends wi{data(e={}){return super.data(e)}}class Bo{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Kl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new jf(this._firestore,this._userDataWriter,n.key,n,new Kl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new jf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Kl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new jf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Kl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),f=i.indexOf(o.doc.key)),{type:dB(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=r1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(t){t=es(t,Ft);const e=es(t.firestore,Yi);return QU(I1(e),t._key).then(r=>gB(e,t,r))}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:Ht("string",Bo._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class eI extends hB{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,r)}}function tI(t){t=es(t,gl);const e=es(t.firestore,Yi),r=I1(e),n=new eI(e);return uB(t._query),JU(r,t._query).then(s=>new Bo(e,n,t,s))}function rI(t,e,r){t=es(t,Ft);const n=es(t.firestore,Yi),s=Jk(t.converter,e);return L0(n,[Hk(b0(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,In.none())])}function pB(t,e,r,...n){t=es(t,Ft);const s=es(t.firestore,Yi),a=b0(s);let i;return i=typeof(e=Ot(e))=="string"||e instanceof D0?iB(a,"updateDoc",t._key,e,r,n):aB(a,"updateDoc",t._key,e),L0(s,[i.toMutation(t._key,In.exists(!0))])}function nI(t){return L0(es(t.firestore,Yi),[new u1(t._key,In.none())])}function mB(t,e){const r=es(t.firestore,Yi),n=Ma(t),s=Jk(t.converter,e);return L0(r,[Hk(b0(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,In.exists(!1))]).then(()=>n)}function L0(t,e){return function(n,s){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>UU(await YU(n),s,a)),a.promise}(I1(t),e)}function gB(t,e,r){const n=r.docs.get(e._key),s=new eI(t);return new wi(t,s,e._key,n,new Kl(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){hl=s})(ul),ws(new Jn("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new Yi(new i7(n.getProvider("auth-internal")),new c7(i,n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Te(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qc(c.options.projectId,f)}(i,s),i);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),kn(x_,v_,e),kn(x_,v_,"esm2020")})();const sI="@firebase/installations",O1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI=1e4,iI=`w:${O1}`,oI="FIS_v2",xB="https://firebaseinstallations.googleapis.com/v1",vB=60*60*1e3,yB="installations",_B="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Oi=new Wi(yB,_B,EB);function lI(t){return t instanceof rs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI({projectId:t}){return`${xB}/projects/${t}/installations`}function uI(t){return{token:t.token,requestStatus:2,expiresIn:TB(t.expiresIn),creationTime:Date.now()}}async function fI(t,e){const n=(await e.json()).error;return Oi.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function hI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function wB(t,{refreshToken:e}){const r=hI(t);return r.append("Authorization",AB(e)),r}async function dI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function TB(t){return Number(t.replace("s","000"))}function AB(t){return`${oI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SB({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=cI(t),s=hI(t),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const i={fid:r,authVersion:oI,appId:t.appId,sdkVersion:iI},o={method:"POST",headers:s,body:JSON.stringify(i)},l=await dI(()=>fetch(n,o));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:uI(c.authToken)}}else throw await fI("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IB=/^[cdef][\w-]{21}$/,Em="";function CB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=NB(t);return IB.test(r)?r:Em}catch{return Em}}function NB(t){return kB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI=new Map;function gI(t,e){const r=M0(t);xI(r,e),RB(r,e)}function xI(t,e){const r=mI.get(t);if(r)for(const n of r)n(e)}function RB(t,e){const r=PB();r&&r.postMessage({key:t,fid:e}),DB()}let xi=null;function PB(){return!xi&&"BroadcastChannel"in self&&(xi=new BroadcastChannel("[Firebase] FID Change"),xi.onmessage=t=>{xI(t.data.key,t.data.fid)}),xi}function DB(){mI.size===0&&xi&&(xi.close(),xi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB="firebase-installations-database",FB=1,Li="firebase-installations-store";let Bd=null;function L1(){return Bd||(Bd=OA(bB,FB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Li)}}})),Bd}async function Gh(t,e){const r=M0(t),s=(await L1()).transaction(Li,"readwrite"),a=s.objectStore(Li),i=await a.get(r);return await a.put(e,r),await s.done,(!i||i.fid!==e.fid)&&gI(t,e.fid),e}async function vI(t){const e=M0(t),n=(await L1()).transaction(Li,"readwrite");await n.objectStore(Li).delete(e),await n.done}async function V0(t,e){const r=M0(t),s=(await L1()).transaction(Li,"readwrite"),a=s.objectStore(Li),i=await a.get(r),o=e(i);return o===void 0?await a.delete(r):await a.put(o,r),await s.done,o&&(!i||i.fid!==o.fid)&&gI(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(t){let e;const r=await V0(t.appConfig,n=>{const s=OB(n),a=LB(t,s);return e=a.registrationPromise,a.installationEntry});return r.fid===Em?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function OB(t){const e=t||{fid:CB(),registrationStatus:0};return yI(e)}function LB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Oi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=MB(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:VB(t)}:{installationEntry:e}}async function MB(t,e){try{const r=await SB(t,e);return Gh(t.appConfig,r)}catch(r){throw lI(r)&&r.customData.serverCode===409?await vI(t.appConfig):await Gh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function VB(t){let e=await mE(t.appConfig);for(;e.registrationStatus===1;)await pI(100),e=await mE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await M1(t);return n||r}return e}function mE(t){return V0(t,e=>{if(!e)throw Oi.create("installation-not-found");return yI(e)})}function yI(t){return UB(t)?{fid:t.fid,registrationStatus:0}:t}function UB(t){return t.registrationStatus===1&&t.registrationTime+aI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BB({appConfig:t,heartbeatServiceProvider:e},r){const n=jB(t,r),s=wB(t,r),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const i={installation:{sdkVersion:iI,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(i)},l=await dI(()=>fetch(n,o));if(l.ok){const c=await l.json();return uI(c)}else throw await fI("Generate Auth Token",l)}function jB(t,{fid:e}){return`${cI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V1(t,e=!1){let r;const n=await V0(t.appConfig,a=>{if(!_I(a))throw Oi.create("not-registered");const i=a.authToken;if(!e&&HB(i))return a;if(i.requestStatus===1)return r=$B(t,e),a;{if(!navigator.onLine)throw Oi.create("app-offline");const o=GB(a);return r=zB(t,o),o}});return r?await r:n.authToken}async function $B(t,e){let r=await gE(t.appConfig);for(;r.authToken.requestStatus===1;)await pI(100),r=await gE(t.appConfig);const n=r.authToken;return n.requestStatus===0?V1(t,e):n}function gE(t){return V0(t,e=>{if(!_I(e))throw Oi.create("not-registered");const r=e.authToken;return qB(r)?{...e,authToken:{requestStatus:0}}:e})}async function zB(t,e){try{const r=await BB(t,e),n={...e,authToken:r};return await Gh(t.appConfig,n),r}catch(r){if(lI(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await vI(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Gh(t.appConfig,n)}throw r}}function _I(t){return t!==void 0&&t.registrationStatus===2}function HB(t){return t.requestStatus===2&&!WB(t)}function WB(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+vB}function GB(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function qB(t){return t.requestStatus===1&&t.requestTime+aI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KB(t){const e=t,{installationEntry:r,registrationPromise:n}=await M1(e);return n?n.catch(console.error):V1(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XB(t,e=!1){const r=t;return await YB(r),(await V1(r,e)).token}async function YB(t){const{registrationPromise:e}=await M1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QB(t){if(!t||!t.options)throw jd("App Configuration");if(!t.name)throw jd("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw jd(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function jd(t){return Oi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI="installations",JB="installations-internal",ZB=t=>{const e=t.getProvider("app").getImmediate(),r=QB(e),n=Gi(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},ej=t=>{const e=t.getProvider("app").getImmediate(),r=Gi(e,EI).getImmediate();return{getId:()=>KB(r),getToken:s=>XB(r,s)}};function tj(){ws(new Jn(EI,ZB,"PUBLIC")),ws(new Jn(JB,ej,"PRIVATE"))}tj();kn(sI,O1);kn(sI,O1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh="analytics",rj="firebase_id",nj="origin",sj=60*1e3,aj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",U1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en=new m0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},fn=new Wi("analytics","Analytics",ij);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(t){if(!t.startsWith(U1)){const e=fn.create("invalid-gtag-resource",{gtagURL:t});return en.warn(e.message),""}return t}function wI(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function lj(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function cj(t,e){const r=lj("firebase-js-sdk-policy",{createScriptURL:oj}),n=document.createElement("script"),s=`${U1}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function uj(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function fj(t,e,r,n,s,a){const i=n[s];try{if(i)await e[i];else{const l=(await wI(r)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(o){en.error(o)}t("config",s,a)}async function hj(t,e,r,n,s){try{let a=[];if(s&&s.send_to){let i=s.send_to;Array.isArray(i)||(i=[i]);const o=await wI(r);for(const l of i){const c=o.find(h=>h.measurementId===l),f=c&&e[c.appId];if(f)a.push(f);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),t("event",n,s||{})}catch(a){en.error(a)}}function dj(t,e,r,n){async function s(a,...i){try{if(a==="event"){const[o,l]=i;await hj(t,e,r,o,l)}else if(a==="config"){const[o,l]=i;await fj(t,e,r,n,o,l)}else if(a==="consent"){const[o,l]=i;t("consent",o,l)}else if(a==="get"){const[o,l,c]=i;t("get",o,l,c)}else if(a==="set"){const[o]=i;t("set",o)}else t(a,...i)}catch(o){en.error(o)}}return s}function pj(t,e,r,n,s){let a=function(...i){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=dj(a,t,e,r),{gtagCore:a,wrappedGtag:window[s]}}function mj(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(U1)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj=30,xj=1e3;class vj{constructor(e={},r=xj){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const TI=new vj;function yj(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function _j(t){var i;const{appId:e,apiKey:r}=t,n={method:"GET",headers:yj(r)},s=aj.replace("{app-id}",e),a=await fetch(s,n);if(a.status!==200&&a.status!==304){let o="";try{const l=await a.json();(i=l.error)!=null&&i.message&&(o=l.error.message)}catch{}throw fn.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function Ej(t,e=TI,r){const{appId:n,apiKey:s,measurementId:a}=t.options;if(!n)throw fn.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:n};throw fn.create("no-api-key")}const i=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Aj;return setTimeout(async()=>{o.abort()},sj),AI({appId:n,apiKey:s,measurementId:a},i,o,e)}async function AI(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=TI){var o;const{appId:a,measurementId:i}=t;try{await wj(n,e)}catch(l){if(i)return en.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:a,measurementId:i};throw l}try{const l=await _j(t);return s.deleteThrottleMetadata(a),l}catch(l){const c=l;if(!Tj(c)){if(s.deleteThrottleMetadata(a),i)return en.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:a,measurementId:i};throw l}const f=Number((o=c==null?void 0:c.customData)==null?void 0:o.httpStatus)===503?$y(r,s.intervalMillis,gj):$y(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return s.setThrottleMetadata(a,h),en.debug(`Calling attemptFetch again in ${f} millis`),AI(t,h,n,s)}}function wj(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(a),n(fn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Tj(t){if(!(t instanceof rs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Aj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Sj(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const a=await e,i={...n,send_to:a};t("event",r,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(){if(PA())try{await DA()}catch(t){return en.warn(fn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return en.warn(fn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Ij(t,e,r,n,s,a,i){const o=Ej(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&en.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>en.error(d)),e.push(o);const l=kj().then(d=>{if(d)return n.getId()}),[c,f]=await Promise.all([o,l]);mj(a)||cj(a,c.measurementId),s("js",new Date);const h=(i==null?void 0:i.config)??{};return h[nj]="firebase",h.update=!0,f!=null&&(h[rj]=f),s("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e){this.app=e}_delete(){return delete _c[this.app.options.appId],Promise.resolve()}}let _c={},xE=[];const vE={};let $d="dataLayer",Nj="gtag",yE,SI,_E=!1;function Rj(){const t=[];if(RA()&&t.push("This is a browser extension environment."),_5()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=fn.create("invalid-analytics-context",{errorInfo:e});en.warn(r.message)}}function Pj(t,e,r){Rj();const n=t.options.appId;if(!n)throw fn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)en.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw fn.create("no-api-key");if(_c[n]!=null)throw fn.create("already-exists",{id:n});if(!_E){uj($d);const{wrappedGtag:a,gtagCore:i}=pj(_c,xE,vE,$d,Nj);SI=a,yE=i,_E=!0}return _c[n]=Ij(t,xE,vE,e,yE,$d,r),new Cj(t)}function Dj(t=Gg()){t=Ot(t);const e=Gi(t,qh);return e.isInitialized()?e.getImmediate():bj(t)}function bj(t,e={}){const r=Gi(t,qh);if(r.isInitialized()){const s=r.getImmediate();if($a(e,r.getOptions()))return s;throw fn.create("already-initialized")}return r.initialize({options:e})}function Fj(t,e,r,n){t=Ot(t),Sj(SI,_c[t.app.options.appId],e,r,n).catch(s=>en.error(s))}const EE="@firebase/analytics",wE="0.10.18";function Oj(){ws(new Jn(qh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Pj(n,s,r)},"PUBLIC")),ws(new Jn("analytics-internal",t,"PRIVATE")),kn(EE,wE),kn(EE,wE,"esm2020");function t(e){try{const r=e.getProvider(qh).getImmediate();return{logEvent:(n,s,a)=>Fj(r,n,s,a)}}catch(r){throw fn.create("interop-component-reg-failed",{reason:r})}}}Oj();const Lj={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},B1=LA(Lj),gf=e7(B1),us=eB(B1);typeof window<"u"&&Dj(B1);const kI=je.createContext(),j1=()=>{const t=je.useContext(kI);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},Mj=({children:t})=>{const[e,r]=je.useState(null),[n,s]=je.useState(!0),[a,i]=je.useState(null),o=async(h,d,p)=>{try{i(null);const v=await LM(gf,h,d);return p&&await UM(v.user,{displayName:p}),v.user}catch(v){throw i(v.message),v}},l=async(h,d)=>{try{return i(null),(await MM(gf,h,d)).user}catch(p){throw i(p.message),p}},c=async()=>{try{i(null),await zM(gf)}catch(h){throw i(h.message),h}};je.useEffect(()=>$M(gf,d=>{r(d),s(!1)}),[]);const f={user:e,loading:n,error:a,register:o,login:l,logout:c,clearError:()=>i(null)};return m.jsx(kI.Provider,{value:f,children:t})},fs={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData"};let tu=!1;const hs=(t,e)=>{if(t.code==="permission-denied")return tu||(console.warn(" Firebase Firestore: Permisos insuficientes. La aplicacin funciona en modo demo."),console.info(" Para habilitar persistencia, configura Firestore siguiendo las instrucciones en FIREBASE_SETUP.md"),tu=!0),null;if(t.code==="failed-precondition"&&t.message.includes("index"))return console.info(" Firebase est creando ndices necesarios. Usando datos locales temporalmente."),console.info(" Estado del ndice: https://console.firebase.google.com/project/centralteleoperadores/firestore/indexes"),null;throw console.error(`Error en ${e}:`,t),t},zd={async create(t,e){try{return{id:(await mB(ym(us,fs.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){return hs(r,"crear operador")}},async getByUser(t){if(tu)return[];try{const e=Xk(ym(us,fs.OPERATORS),Yk("userId","==",t));return(await tI(e)).docs.map(s=>({id:s.id,...s.data()})).sort((s,a)=>{var l,c,f,h;const i=((c=(l=s.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(0);return(((h=(f=a.createdAt)==null?void 0:f.toDate)==null?void 0:h.call(f))||new Date(0))-i})}catch(e){return hs(e,"obtener operadores")||[]}},async update(t,e){try{const r=Ma(us,fs.OPERATORS,t);return await pB(r,{...e,updatedAt:new Date}),!0}catch(r){return hs(r,"actualizar operador")}},async delete(t){try{return await nI(Ma(us,fs.OPERATORS,t)),!0}catch(e){return hs(e,"eliminar operador")}}},xf={async saveOperatorAssignments(t,e,r){try{const n=Ma(us,fs.ASSIGNMENTS,`${t}_${e}`);return await rI(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date}),!0}catch(n){return hs(n,"guardar asignaciones")}},async getOperatorAssignments(t,e){try{const r=Ma(us,fs.ASSIGNMENTS,`${t}_${e}`),n=await Zk(r);return n.exists()?n.data().assignments||[]:[]}catch(r){return hs(r,"obtener asignaciones")||[]}},async getAllUserAssignments(t){if(tu)return{};try{const e=Xk(ym(us,fs.ASSIGNMENTS),Yk("userId","==",t)),r=await tI(e),n={};return r.docs.forEach(s=>{const a=s.data();n[a.operatorId]=a.assignments||[]}),n}catch(e){return hs(e,"obtener todas las asignaciones")||{}}},async deleteOperatorAssignments(t,e){try{return await nI(Ma(us,fs.ASSIGNMENTS,`${t}_${e}`)),!0}catch(r){return hs(r,"eliminar asignaciones")}}},TE={async saveCallData(t,e){try{const r=Ma(us,fs.CALL_DATA,t);return await rI(r,{userId:t,callData:e,updatedAt:new Date}),!0}catch(r){return hs(r,"guardar datos de llamadas")}},async getCallData(t){if(tu)return[];try{const e=Ma(us,fs.CALL_DATA,t),r=await Zk(e);return r.exists()?r.data().callData||[]:[]}catch(e){return hs(e,"obtener datos de llamadas")||[]}}},AE=t=>{let e;const r=new Set,n=(c,f)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const d=e;e=f??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,d))}},s=()=>e,o={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,s,o);return o},Vj=t=>t?AE(t):AE,Uj=t=>t;function Bj(t,e=Uj){const r=zf.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return zf.useDebugValue(r),r}const SE=t=>{const e=Vj(t),r=n=>Bj(e,n);return Object.assign(r,e),r},$1=t=>t?SE(t):SE;function U0(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var a;const i=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(s))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const wm=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return wm(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return wm(n)(r)}}}},jj=(t,e)=>(r,n,s)=>{let a={storage:U0(()=>localStorage),partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...e},i=!1;const o=new Set,l=new Set;let c=a.storage;if(!c)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...x)},n,s);const f=()=>{const x=a.partialize({...n()});return c.setItem(a.name,{state:x,version:a.version})},h=s.setState;s.setState=(x,E)=>{h(x,E),f()};const d=t((...x)=>{r(...x),f()},n,s);s.getInitialState=()=>d;let p;const v=()=>{var x,E;if(!c)return;i=!1,o.forEach(_=>{var y;return _((y=n())!=null?y:d)});const A=((E=a.onRehydrateStorage)==null?void 0:E.call(a,(x=n())!=null?x:d))||void 0;return wm(c.getItem.bind(c))(a.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==a.version){if(a.migrate){const y=a.migrate(_.state,_.version);return y instanceof Promise?y.then(M=>[!0,M]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var y;const[M,z]=_;if(p=a.merge(z,(y=n())!=null?y:d),r(p,!0),M)return f()}).then(()=>{A==null||A(p,void 0),p=n(),i=!0,l.forEach(_=>_(p))}).catch(_=>{A==null||A(void 0,_)})};return s.persist={setOptions:x=>{a={...a,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c==null||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>i,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},a.skipHydration||v(),p||d},z1=jj;$1(z1((t,e)=>({user:null,isAuthenticated:!1,loading:!1,error:null,setUser:r=>{t({user:r,isAuthenticated:!!r,error:null})},setLoading:r=>{t({loading:r})},setError:r=>{t({error:r})},logout:()=>{t({user:null,isAuthenticated:!1,loading:!1,error:null})},updateUser:r=>{const n=e().user;n&&t({user:{...n,...r}})},getUserDisplayName:()=>{const{user:r}=e();return(r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"Usuario"},getUserEmail:()=>{const{user:r}=e();return(r==null?void 0:r.email)||""},isAdmin:()=>{const{user:r}=e();return(r==null?void 0:r.role)==="admin"||!1}}),{name:"user-storage",storage:U0(()=>localStorage),partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated})}));const II=$1(z1((t,e)=>({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},isLoading:!1,loadingStage:null,loadingMessage:"",lastUpdated:null,dataSource:null,filters:{dateRange:null,operator:null,status:"all",commune:null},setCallData:(r,n="excel")=>{const s=new Date().toISOString();t({callData:r,dataSource:n,lastUpdated:s,isLoading:!1,loadingStage:"complete",loadingMessage:`${r.length} llamadas cargadas exitosamente`}),e().analyzeCallData()},setLoading:(r,n=null,s="")=>{t({isLoading:r,loadingStage:n,loadingMessage:s})},setLoadingStage:(r,n="")=>{t({loadingStage:r,loadingMessage:n||{uploading:"Subiendo archivo Excel...",processing:"Procesando datos del archivo...",analyzing:"Analizando llamadas y generando mtricas...",complete:"Anlisis completado exitosamente",error:"Error durante el procesamiento"}[r]||"",isLoading:r!=="complete"&&r!=="error"})},analyzeCallData:()=>{const{callData:r}=e();if(e().setLoadingStage("analyzing","Analizando datos de llamadas..."),!r||r.length===0){t({processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},loadingStage:"complete",loadingMessage:"No hay datos para analizar",isLoading:!1});return}setTimeout(()=>{const n=r.map(f=>({...f,duracion:parseInt(f.duracion)||0,isSuccessful:f.categoria==="exitosa"||f.result==="Llamado exitoso",fecha:f.fecha||"N/A",hora:f.hora?parseInt(f.hora.split(":")[0]):null})),s=n.filter(f=>f.isSuccessful),a=new Set(n.map(f=>f.beneficiario||f.beneficiary)).size,i=n.reduce((f,h)=>f+(h.duracion||0),0),o=n.length>0?Math.round(i/n.length):0,l=n.length>0?Math.round(s.length/n.length*100):0,c={totalCalls:n.length,successfulCalls:s.length,failedCalls:n.length-s.length,averageDuration:o,uniqueBeneficiaries:a,protocolCompliance:l};t({processedData:n,callMetrics:c,loadingStage:"complete",loadingMessage:`Anlisis completado: ${n.length} llamadas procesadas`,isLoading:!1})},800)},setFilters:r=>{t(n=>({filters:{...n.filters,...r}}))},getFilteredData:()=>{const{processedData:r,filters:n}=e();let s=[...r];if(n.operator&&n.operator!=="all"&&(s=s.filter(a=>a.operator===n.operator)),n.status&&n.status!=="all"&&(n.status==="successful"?s=s.filter(a=>a.isSuccessful):n.status==="failed"&&(s=s.filter(a=>!a.isSuccessful))),n.commune&&n.commune!=="all"&&(s=s.filter(a=>a.commune===n.commune)),n.dateRange){const{start:a,end:i}=n.dateRange;s=s.filter(o=>{const l=new Date(o.date);return l>=new Date(a)&&l<=new Date(i)})}return s},clearData:()=>{t({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},lastUpdated:null,dataSource:null,isLoading:!1,loadingStage:null,loadingMessage:""})},getOperatorMetrics:(r=null,n=null)=>{var c;const{processedData:s}=e();console.log(" [AUDIT CRITICAL] === ANLISIS DE MTRICAS DE OPERADORES ==="),console.log(" [AUDIT CRITICAL] ProcessedData disponible:",(s==null?void 0:s.length)||0,"llamadas"),console.log(" [AUDIT CRITICAL] Operators recibidos:",(r==null?void 0:r.length)||0),console.log(" [AUDIT CRITICAL] OperatorAssignments recibidos:",n?Object.keys(n).length:0);const a=(c=window.useAppStore)==null?void 0:c.getState(),i=r||(a==null?void 0:a.operators)||[],o=n||(a==null?void 0:a.operatorAssignments)||{};if(console.log(" [AUDIT CRITICAL] === DATOS FINALES PARA ANLISIS ==="),console.log(" [AUDIT CRITICAL] Operadores finales:",i.length),console.log(" [AUDIT CRITICAL] Asignaciones finales:",Object.keys(o).length),i.length>0&&s.length>0){console.log(" [AUDIT CRITICAL] USANDO OPERADORES REALES DEL SISTEMA");const f={};i.forEach(d=>{f[d.name]={operador:d.name,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0},console.log(" [AUDIT CRITICAL] Operador real inicializado:",d.name)}),s.forEach((d,p)=>{const v=d.beneficiario||d.beneficiary;if(!v)return;let x=null;if(Object.entries(o).forEach(([E,A])=>{if(A&&Array.isArray(A)&&A.find(y=>y.beneficiary===v||y.beneficiario===v)){const y=i.find(M=>M.id===E);y&&(x=y.name)}}),x&&f[x]){const E=f[x];E.totalLlamadas++,(d.categoria==="exitosa"||d.resultado==="Llamado exitoso")&&E.llamadasExitosas++,E.tiempoTotal+=d.duracion||0,p<10&&console.log(` [AUDIT CRITICAL] Llamada ${p}: ${v}  ${x}`)}else p<10&&console.log(` [AUDIT CRITICAL] Llamada ${p}: ${v}  No asignado`)}),Object.values(f).forEach(d=>{d.promedioLlamada=d.totalLlamadas>0?Math.round(d.tiempoTotal/d.totalLlamadas):0});const h=Object.values(f).filter(d=>d.totalLlamadas>0);if(console.log(" [AUDIT CRITICAL] === RESULTADO FINAL CORREGIDO ==="),h.forEach((d,p)=>{console.log(`${p+1}. "${d.operador}": ${d.totalLlamadas} llamadas`)}),h.length===0){console.log(" [AUDIT CRITICAL] No se encontraron llamadas asignadas a operadores reales"),console.log(" [AUDIT CRITICAL] Verificando si hay beneficiarios en comn...");const d=new Set(s.map(E=>E.beneficiario||E.beneficiary)),p=new Set;Object.values(o).forEach(E=>{E&&Array.isArray(E)&&E.forEach(A=>p.add(A.beneficiary||A.beneficiario))}),console.log(" [AUDIT DEBUG] Beneficiarios en llamadas:",d.size),console.log(" [AUDIT DEBUG] Beneficiarios en asignaciones:",p.size);const v=Array.from(d).slice(0,5),x=Array.from(p).slice(0,5);console.log(" [AUDIT DEBUG] Muestra llamadas:",v),console.log(" [AUDIT DEBUG] Muestra asignaciones:",x)}return h}if((!r||r.length===0)&&(!n||Object.keys(n).length===0)){console.log(" [AUDIT CRITICAL] Analizando operadores directamente de datos de llamadas...");const f={},h=p=>{if(!p||typeof p!="string")return!1;const v=p.trim();return v.length<2?!1:/^(sin respuesta|llamado exitoso|ocupado|no contesta|busy|answered|no answer|hangup|ringing|failed|success)$/i.test(v)?(console.log(` [AUDIT CRITICAL] Estado de llamada rechazado: "${v}"`),!1):/^(no|si|n\/a|na|null|undefined|pendiente|solo)$/i.test(v)?(console.log(` [AUDIT CRITICAL] Valor tcnico rechazado: "${v}"`),!1):/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(v)||/^\d{1,2}:\d{2}/.test(v)||/^\d+$/.test(v)?!1:/^[A-Za-z\s\-\.']{2,}$/.test(v)&&/[A-Za-z]/.test(v)?(console.log(` [AUDIT CRITICAL] Nombre VLIDO detectado: "${v}"`),!0):(console.log(` [AUDIT CRITICAL] Nombre RECHAZADO: "${v}" (no parece nombre de persona)`),!1)};console.log(" [AUDIT CRITICAL] === EXTRAYENDO OPERADORES DE LLAMADAS ==="),s.forEach((p,v)=>{let x=p.operador||p.operator||p.teleoperadora||p.agente;v<5&&console.log(` [AUDIT CRITICAL] Llamada ${v}: operador="${x}", beneficiario="${p.beneficiario}"`),!h(x)||x===p.beneficiario||x===p.beneficiary?(v<5&&x&&console.log(` [AUDIT CRITICAL] Llamada ${v}: Operador "${x}" rechazado - ser "No identificado"`),x="No identificado"):v<5&&console.log(` [AUDIT CRITICAL] Llamada ${v}: Operador "${x}" ACEPTADO`),f[x]||(f[x]={operador:x,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0},console.log(" [AUDIT CRITICAL] Inicializada mtrica para:",x));const E=f[x];E.totalLlamadas++,(p.categoria==="exitosa"||p.resultado==="Llamado exitoso")&&E.llamadasExitosas++,E.tiempoTotal+=p.duracion||0}),console.log(" [AUDIT CRITICAL] === OPERADORES FINALES ENCONTRADOS ==="),Object.keys(f).forEach((p,v)=>{console.log(`${v+1}. "${p}": ${f[p].totalLlamadas} llamadas`)}),Object.values(f).forEach(p=>{p.promedioLlamada=p.totalLlamadas>0?Math.round(p.tiempoTotal/p.totalLlamadas):0});const d=Object.values(f);return console.log(" [AUDIT CRITICAL] RESULTADO FINAL:",d.length,"operadores con mtricas"),d}const l={};try{Object.values(n).flat().forEach(f=>{f.operatorName&&!l[f.operatorName]&&(l[f.operatorName]={operador:f.operatorName,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0})})}catch(f){return console.warn("Error procesando operatorAssignments:",f),[]}return s.forEach(f=>{try{const h=Object.values(n).flat().find(d=>d.beneficiary===f.beneficiary);if(h&&l[h.operatorName]){const d=l[h.operatorName];d.totalLlamadas++,f.categoria==="exitosa"&&d.llamadasExitosas++,d.tiempoTotal+=f.duracion||0}}catch(h){console.warn("Error procesando call data:",h)}}),Object.values(l).forEach(f=>{f.promedioLlamada=f.totalLlamadas>0?Math.round(f.tiempoTotal/f.totalLlamadas):0}),Object.values(l)},getHourlyDistribution:()=>{const{processedData:r}=e(),n=Array.from({length:24},(s,a)=>({hour:a,calls:0}));return Array.isArray(r)&&r.forEach(s=>{try{let a=null;if(s.hora){const o=s.hora.toString().match(/^(\d{1,2})/);o&&(a=parseInt(o[1]))}else s.hour!==void 0&&(a=parseInt(s.hour));a!==null&&a>=0&&a<24&&n[a].calls++}catch(a){console.warn("Error procesando hora de llamada:",a)}}),n},getFollowUpData:r=>{const{processedData:n}=e();if(console.log(" getFollowUpData iniciando con assignments:",r),console.log(" getFollowUpData - processedData:",n==null?void 0:n.length,"llamadas"),!n||n.length===0)return console.log(" No hay processedData disponible"),[];const s=l=>{if(!l)return"N/A";try{let c;if(typeof l=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(l)){const f=l.split(/[-\/]/),h=parseInt(f[0]),d=parseInt(f[1]),p=parseInt(f[2]);if(h<=31&&d<=12&&p>=1900)return`${h.toString().padStart(2,"0")}-${d.toString().padStart(2,"0")}-${p}`}if(typeof l=="number"?c=new Date((l-25569)*86400*1e3):c=new Date(l),c&&!isNaN(c.getTime())){const f=c.getDate().toString().padStart(2,"0"),h=(c.getMonth()+1).toString().padStart(2,"0"),d=c.getFullYear();return`${f}-${h}-${d}`}return"Fecha invlida"}catch{return typeof l=="string"?l:"Error en fecha"}},a=l=>{if(!l||l==="N/A")return null;try{if(typeof l=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(l)){const[c,f,h]=l.split(/[-\/]/);return new Date(parseInt(h),parseInt(f)-1,parseInt(c))}return typeof l=="number"?new Date((l-25569)*86400*1e3):new Date(l)}catch(c){return console.warn("Error parseando fecha:",l,c),null}},i={};n.forEach(l=>{const c=l.beneficiario||l.beneficiary,f=l.resultado||l.result||(l.categoria==="exitosa"?"Llamado exitoso":"Llamado fallido"),h=l.fecha||l.date;if(c&&c.includes("Sara")&&console.log(" SARA DEBUG - Procesando llamada:",{beneficiary:c,date:h,result:f,rawCall:l}),!c)return;i[c]||(i[c]={beneficiary:c,calls:[],lastResult:f,lastDate:h}),i[c].calls.push(l);const d=a(h),p=a(i[c].lastDate);c&&c.includes("Sara")&&console.log(" SARA DEBUG - Comparacin de fechas CORREGIDA:",{beneficiary:c,currentDateString:h,currentDateParsed:d,currentDateValid:d!==null,lastDateString:i[c].lastDate,lastDateParsed:p,lastDateValid:p!==null,currentIsNewer:d&&p?d>p:!1,willUpdate:d&&(!p||d>p)}),d&&(!p||d>p)&&(i[c].lastResult=f,i[c].lastDate=h,c&&c.includes("Sara")&&console.log(" SARA DEBUG - Fecha actualizada CORREGIDA:",{beneficiary:c,newLastDate:h,newLastResult:f,totalCalls:i[c].calls.length}))});const o=Object.values(i).map(l=>{if(console.log(" Procesando beneficiario:",l.beneficiary),l.beneficiary&&l.beneficiary.includes("Sara")){console.log(" SARA DEBUG - Anlisis completo:",{beneficiary:l.beneficiary,totalCalls:l.calls.length,lastDate:l.lastDate,lastResult:l.lastResult,allDates:l.calls.map(_=>_.fecha||_.date),sortedDates:l.calls.map(_=>_.fecha||_.date).sort(),uniqueDates:[...new Set(l.calls.map(_=>_.fecha||_.date))]});const E=l.calls.map(_=>_.fecha||_.date).filter(_=>_&&_!=="N/A");console.log(" SARA DEBUG - Todas las fechas sin filtrar:",E);const A=E.map(_=>{if(typeof _=="string"&&/^\d{1,2}-\d{1,2}-\d{4}$/.test(_)){const[y,M,z]=_.split("-");return{original:_,parsed:new Date(z,M-1,y),timestamp:new Date(z,M-1,y).getTime()}}else return{original:_,parsed:new Date(_),timestamp:new Date(_).getTime()}}).filter(_=>!isNaN(_.timestamp));A.sort((_,y)=>y.timestamp-_.timestamp),console.log(" SARA DEBUG - Fechas ordenadas manualmente:",A),A.length>0&&console.log(" SARA DEBUG - Fecha ms reciente encontrada:",A[0].original)}let c=null;r&&Array.isArray(r)?(console.log(" Buscando assignment para:",l.beneficiary),console.log(" Total assignments disponibles:",r.length),c=r.find(E=>{const A=(E.beneficiary||E.beneficiario||"").trim(),_=(l.beneficiary||"").trim();if(console.log(` Comparando: "${A}" vs "${_}"`),A===_)return console.log(" Coincidencia exacta encontrada"),!0;if(A.toLowerCase()===_.toLowerCase())return console.log(" Coincidencia exacta (case insensitive) encontrada"),!0;const y=A.toLowerCase(),M=_.toLowerCase();return y&&M&&(y.includes(M)||M.includes(y))?(console.log(" Coincidencia parcial encontrada"),!0):!1}),c?console.log(" Assignment encontrado para",l.beneficiary,":",c):(console.log(" No se encontr assignment para:",l.beneficiary),console.log(" Assignments disponibles:",r==null?void 0:r.map(E=>({beneficiary:E.beneficiary||E.beneficiario,operator:E.operator||E.operatorName}))),console.log(" Comparacin detallada para:",l.beneficiary),r==null||r.forEach((E,A)=>{const _=(E.beneficiary||E.beneficiario||"").trim().toLowerCase(),y=(l.beneficiary||"").trim().toLowerCase();console.log(`  [${A}] "${_}" vs "${y}" - Exacta: ${_===y}`)}))):console.log(" No hay assignments array disponible");let f="pendiente",h="bg-yellow-100 text-yellow-800";l.lastResult==="Llamado exitoso"||l.lastResult==="exitosa"?(f="al-dia",h="bg-green-100 text-green-800"):l.calls.length>3&&(f="urgente",h="bg-red-100 text-red-800");let d="No Asignado",p="N/A",v="N/A";if(c){console.log(" Assignment encontrado para",l.beneficiary,":",c);const E=c.operator||c.operador||c.operatorName||c.teleoperadora||c.name;console.log(" Candidate operator:",E),E&&E!=="Solo HANGUP"&&E!=="HANGUP"&&E!=="No identificado"&&E!=="Llamado exitoso"&&E!=="Llamado fallido"&&E!=="exitosa"&&E!=="fallida"&&E.trim().length>2&&!/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(E)?(d=E,console.log(" Operadora asignada encontrada:",d)):console.log(" Operadora invlida filtrada:",E),p=c.phone||c.telefono||c.primaryPhone||c.numero_cliente||"N/A",v=c.commune||c.comuna||"N/A"}else console.log(" No hay asignacin para beneficiario:",l.beneficiary);const x={id:l.beneficiary,operator:d,beneficiary:l.beneficiary,phone:p,commune:v,status:f,lastCall:s(l.lastDate),callCount:l.calls.length,colorClass:h};return l.beneficiary&&l.beneficiary.includes("Sara")&&console.log(" SARA DEBUG - Resultado final:",x),x});return console.log(" Total de beneficiarios en seguimiento:",o.length),o},hasData:()=>{const{callData:r}=e();return r&&r.length>0},getSuccessRate:()=>{const{callMetrics:r}=e();return!r||!r.totalCalls||r.totalCalls===0?0:Math.round(r.successfulCalls/r.totalCalls*100)},getDataSummary:()=>{const{callMetrics:r,lastUpdated:n,dataSource:s}=e();return{...r,lastUpdated:n,dataSource:s,successRate:e().getSuccessRate()}}}),{name:"call-audit-storage",storage:U0(()=>localStorage),partialize:t=>({callData:t.callData,processedData:t.processedData,callMetrics:t.callMetrics,lastUpdated:t.lastUpdated,dataSource:t.dataSource,filters:t.filters,loadingStage:t.loadingStage,loadingMessage:t.loadingMessage})})),CI=$1(z1((t,e)=>({operators:[],operatorAssignments:{},activeTab:"dashboard",isLoading:!1,settings:{autoRefresh:!1,refreshInterval:3e4,defaultView:"dashboard"},setOperators:r=>{t({operators:r||[]})},addOperator:r=>{t(n=>({operators:[...n.operators,r]}))},updateOperator:(r,n)=>{t(s=>({operators:s.operators.map(a=>a.id===r?{...a,...n}:a)}))},removeOperator:r=>{t(n=>({operators:n.operators.filter(s=>s.id!==r),operatorAssignments:Object.fromEntries(Object.entries(n.operatorAssignments).filter(([s])=>s!==r))}))},setOperatorAssignments:r=>{t({operatorAssignments:r||{}})},updateOperatorAssignments:(r,n)=>{t(s=>({operatorAssignments:{...s.operatorAssignments,[r]:n}}))},clearOperatorAssignments:r=>{t(n=>{const s={...n.operatorAssignments};return delete s[r],{operatorAssignments:s}})},setActiveTab:r=>{t({activeTab:r})},setLoading:r=>{t({isLoading:r})},updateSettings:r=>{t(n=>({settings:{...n.settings,...r}}))},getOperatorById:r=>{const{operators:n}=e();return n.find(s=>s.id===r)||null},getOperatorAssignments:r=>{const{operatorAssignments:n}=e();return n[r]||[]},getAllAssignments:()=>{const{operatorAssignments:r,operators:n}=e(),s=[];return console.log(" getAllAssignments - operatorAssignments:",r),console.log(" getAllAssignments - operators:",n),Object.entries(r).forEach(([a,i])=>{const o=n.find(l=>l.id===a);o&&i&&(console.log(` Procesando asignaciones para ${o.name}:`,i.length),i.forEach(l=>{const c={id:l.id,operator:o.name,operatorName:o.name,beneficiary:l.beneficiary,phone:l.primaryPhone,commune:l.commune};s.push(c),console.log(" Asignacin agregada:",c)}))}),console.log(" Total asignaciones devueltas:",s.length),s},getTotalAssignments:()=>{const{operatorAssignments:r}=e();return Object.values(r).reduce((n,s)=>n+((s==null?void 0:s.length)||0),0)},clearAllData:()=>{t({operators:[],operatorAssignments:{},activeTab:"dashboard"})}}),{name:"app-storage",storage:U0(()=>localStorage),partialize:t=>({operators:t.operators,operatorAssignments:t.operatorAssignments,settings:t.settings})})),kE={manualMappings:{ocupado:null,sin_respuesta:null,llamado_exitoso:null,no_identificado:null,busy:null,no_answer:null},excludePatterns:[/^ocupado$/i,/^sin\s+respuesta$/i,/^no\s+identificado$/i,/^llamado\s+exitoso$/i,/^busy$/i,/^no\s+answer$/i,/^\d+$/,/^[A-Z]{2,}$/]};function $f(t){if(!t||typeof t!="string")return"";let e=t;return e=e.toLowerCase(),e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),e=e.replace(/[^\w\s]/g,""),e=e.replace(/\s+/g," ").trim(),e}function $j(t){if(!t)return!0;const e=$f(t);return kE.manualMappings[e]===null?!0:kE.excludePatterns.some(r=>r.test(t))}function zj(t,e,r){if(!t||!e||!r)return null;const n=$f(t);for(const[s,a]of Object.entries(e))if(a.find(o=>$f(o)===n)){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"exact"}}for(const[s,a]of Object.entries(e))if(a.find(o=>{const l=$f(o);return l.includes(n)||n.includes(l)})){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"partial"}}return null}function Hj(){const{callData:t,callMetrics:e,processedData:r,isLoading:n,lastUpdated:s,dataSource:a,clearData:i,hasData:o,getSuccessRate:l,getOperatorMetrics:c,getHourlyDistribution:f,getFollowUpData:h}=II(),{operators:d,operatorAssignments:p,getAllAssignments:v}=CI();je.useEffect(()=>{},[r,d,p]);const x=y=>{if(!y||isNaN(y))return"0:00";const M=Math.floor(y/60),z=y%60;return`${M}:${z.toString().padStart(2,"0")}`},E=y=>{if(!y)return"N/A";try{return new Date(y).toLocaleString()}catch{return"N/A"}};c&&c(),f&&f();const _=(()=>{if(console.log(" [AUDIT CRITICAL] === MAPEO INTELIGENTE CON UTILIDADES ==="),console.log(" [AUDIT] Datos disponibles:",(r==null?void 0:r.length)||0),console.log(" [AUDIT] Operadores disponibles:",(d==null?void 0:d.length)||0),console.log(" [AUDIT] Asignaciones disponibles:",p?Object.keys(p).length:0),!r||r.length===0||!d||d.length===0)return console.log(" [AUDIT] Sin datos suficientes para anlisis"),[];const y={};let M=0,z=0,B=0;r.forEach((k,I)=>{const R=k.beneficiario||k.beneficiary||"";I<5&&console.log(` [AUDIT] Llamada ${I}: beneficiario="${R}"`);const F=k.operador||k.operator||k.teleoperadora;F&&$j(F)&&(B++,I<10&&console.log(` [AUDIT] Excluido estado como operador: "${F}"`));const O=zj(R,p,d);if(O){M++;const L=O.operatorName;y[L]||(y[L]={operatorInfo:O.operatorInfo,totalCalls:0,successfulCalls:0,totalDuration:0,beneficiaries:new Set,assignedBeneficiaries:0}),y[L].totalCalls++,y[L].beneficiaries.add(R),(k.isSuccessful||k.categoria==="exitosa"||k.resultado==="Llamado exitoso")&&y[L].successfulCalls++,y[L].totalDuration+=k.duracion||0}else z++,I<10&&console.log(` [AUDIT] Llamada sin mapeo: beneficiario="${R}"`)}),console.log(` [AUDIT] Resultado del mapeo: ${M} mapeadas, ${z} sin mapeo, ${B} excluidas`),console.log(" [AUDIT] Operadores con actividad:",Object.keys(y));const w=Object.entries(y).map(([k,I])=>{var L;const R=I.operatorInfo.id,F=((L=p==null?void 0:p[R])==null?void 0:L.length)||0,O=F>0?Math.round(I.totalCalls/F*10)/10:0;return{operatorName:k,operatorInfo:I.operatorInfo,totalCalls:I.totalCalls,assignedBeneficiaries:F,averageCallsPerBeneficiary:O,beneficiariesWithCalls:I.beneficiaries.size,successfulCalls:I.successfulCalls,successRate:I.totalCalls>0?Math.round(I.successfulCalls/I.totalCalls*100):0}});return d&&d.forEach(k=>{var I;if(!y[k.name]){const R=((I=p==null?void 0:p[k.id])==null?void 0:I.length)||0;w.push({operatorName:k.name,operatorInfo:k,totalCalls:0,assignedBeneficiaries:R,averageCallsPerBeneficiary:0,beneficiariesWithCalls:0,successfulCalls:0,successRate:0})}}),console.log(" [AUDIT] Mtricas finales calculadas:",w.length,"operadores"),w.forEach((k,I)=>{console.log(`  ${I+1}. "${k.operatorName}": ${k.totalCalls} llamadas, ${k.assignedBeneficiaries} asignados, ${k.beneficiariesWithCalls} activos`)}),w.sort((k,I)=>I.totalCalls-k.totalCalls)})();return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[m.jsx(Rf,{className:"w-6 h-6 text-blue-600"}),"Auditora Avanzada de Llamadas"]}),m.jsxs("p",{className:"text-gray-600",children:["Anlisis detallado y mtricas en tiempo real de todas las llamadas registradas en el sistema. Estado de datos: ",m.jsx("span",{className:"font-semibold",children:o&&o()?"Datos cargados":"Sin datos"}),s&&` | ltima actualizacin: ${E(s)}`]})]}),o&&o()&&m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Total Llamadas"}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(e==null?void 0:e.totalCalls)||0})]}),m.jsx(Bn,{className:"w-8 h-8 text-blue-500"})]}),m.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Registros procesados"})]}),m.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Tasa de xito"}),m.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l?l():0,"%"]})]}),m.jsx(j2,{className:"w-8 h-8 text-green-500"})]}),m.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Llamadas exitosas"})]}),m.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-purple-800 mb-1",children:"Operadores Activos"}),m.jsx("p",{className:"text-2xl font-bold text-purple-600",children:(_==null?void 0:_.length)||0})]}),m.jsx(jn,{className:"w-8 h-8 text-purple-500"})]}),m.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Con actividad registrada"})]}),m.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-orange-800 mb-1",children:"Duracin Promedio"}),m.jsx("p",{className:"text-2xl font-bold text-orange-600",children:x((e==null?void 0:e.averageDuration)||0)})]}),m.jsx(Pf,{className:"w-8 h-8 text-orange-500"})]}),m.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"Tiempo por llamada"})]})]}),_.length>0&&m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[m.jsx(jn,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),m.jsx("div",{className:"mb-4",children:!o||!o()?m.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),m.jsxs("p",{className:"text-blue-700 text-sm",children:[m.jsx("span",{className:"font-medium",children:"Modo Asignaciones:"})," Mostrando teleoperadoras con sus asignaciones actuales.",m.jsx("span",{className:"font-medium",children:"Carga datos de llamadas"})," para ver mtricas completas."]})]})}):m.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),m.jsxs("p",{className:"text-green-700 text-sm",children:[m.jsx("span",{className:"font-medium",children:"Datos Completos:"})," Mostrando mtricas extradas directamente de llamadas."]})]}),!1]})})}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map((y,M)=>{var z;return m.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow bg-gradient-to-br from-blue-50 to-indigo-50",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[m.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:m.jsx(xg,{className:"w-5 h-5 text-white"})}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y.operatorName}),m.jsx("p",{className:"text-xs text-gray-500",children:((z=y.operatorInfo)==null?void 0:z.email)||`${y.operatorName.toLowerCase().replace(/\s+/g,".")}@mistatas.com`})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Total Llamadas:"}),m.jsx("span",{className:"font-bold text-lg text-blue-600",children:y.totalCalls})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados:"}),m.jsx("span",{className:"font-medium text-gray-700",children:y.assignedBeneficiaries})]}),y.assignedBeneficiaries>0&&m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Promedio por Beneficiario:"}),m.jsx("span",{className:"font-medium text-gray-700",children:y.averageCallsPerBeneficiary})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Con Actividad:"}),m.jsxs("span",{className:"font-medium text-gray-700",children:[y.beneficiariesWithCalls," / ",y.assignedBeneficiaries]})]}),y.successfulCalls!==void 0&&y.totalCalls>0&&m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Llamadas Exitosas:"}),m.jsxs("span",{className:"font-medium text-green-600",children:[y.successfulCalls," (",y.successRate,"%)"]})]})]}),m.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:o&&o()?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-xs text-gray-500",children:"Rendimiento:"}),m.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.totalCalls>=20?"bg-green-100 text-green-800":y.totalCalls>=10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:y.totalCalls>=20?"Alto":y.totalCalls>=10?"Medio":"Bajo"})]}),m.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${y.totalCalls>=20?"bg-green-500":y.totalCalls>=10?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(y.totalCalls/30*100,100)}%`}})})]}):m.jsx("div",{className:"text-center",children:m.jsx("span",{className:"text-xs text-gray-400",children:y.assignedBeneficiaries>0?` ${y.assignedBeneficiaries} beneficiarios asignados`:" Sin asignaciones"})})})]},y.operatorName)})}),m.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[m.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resumen Estadstico"}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Total Teleoperadoras:"}),m.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.length})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Llamadas Totales:"}),m.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.reduce((y,M)=>y+M.totalCalls,0)})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Beneficiarios Totales:"}),m.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.reduce((y,M)=>y+M.assignedBeneficiaries,0)})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Promedio General:"}),m.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.length>0?Math.round(_.reduce((y,M)=>y+M.totalCalls,0)/_.length*10)/10:0})]})]})]})]}),_.length===0&&m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[m.jsx(jn,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),m.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(sc,{className:"w-5 h-5 text-yellow-500"}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-yellow-800 font-medium",children:"No hay teleoperadoras disponibles"}),m.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Para ver las mtricas por teleoperadora, necesitas:"}),m.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 list-disc list-inside",children:[m.jsx("li",{children:'Crear teleoperadoras en el mdulo "Asignaciones"'}),m.jsx("li",{children:"Asignar beneficiarios a las teleoperadoras"}),m.jsx("li",{children:"Opcionalmente, cargar datos de llamadas para mtricas completas"})]})]})]})})]}),(!o||!o())&&m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[m.jsx(sc,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),m.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No hay datos de auditora disponibles"}),m.jsx("p",{className:"text-gray-500 mb-4",children:'Sube un archivo Excel en la seccin "Registro de Llamadas" para comenzar el anlisis de auditora avanzada.'}),m.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:m.jsxs("p",{className:"text-blue-800 text-sm",children:[" ",m.jsx("strong",{children:"Tip:"})," Una vez que subas datos, vers mtricas detalladas, anlisis por operador y distribucin temporal de llamadas."]})})]}),o&&o()&&m.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{className:"text-sm text-gray-600",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Fuente de datos:"})," ",a||"Desconocida"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"ltima actualizacin:"})," ",E(s)]})]}),i&&m.jsx("button",{onClick:i,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:" Limpiar Datos"})]})})]})}const Wj=()=>{var r,n,s,a,i,o;console.log(" INICIANDO DIAGNSTICO DE SINCRONIZACIN DE DATOS..."),console.log(`
 1. VERIFICANDO STORES ZUSTAND:`);const t=(r=window.useAppStore)==null?void 0:r.getState(),e=(n=window.useCallStore)==null?void 0:n.getState();if(t?console.log(" useAppStore accesible:",{operators:((s=t.operators)==null?void 0:s.length)||0,operatorAssignments:Object.keys(t.operatorAssignments||{}).length,allAssignments:t.getAllAssignments?(a=t.getAllAssignments())==null?void 0:a.length:"N/A"}):console.log(" useAppStore no accesible"),e?console.log(" useCallStore accesible:",{callData:((i=e.callData)==null?void 0:i.length)||0,processedData:((o=e.processedData)==null?void 0:o.length)||0,callMetrics:e.callMetrics?"disponible":"no disponible"}):console.log(" useCallStore no accesible"),console.log(`
 2. PROBANDO getOperatorMetrics:`),e&&e.getOperatorMetrics)try{const l=e.getOperatorMetrics();if(console.log(" Mtricas sin parmetros:",l),t){const c=e.getOperatorMetrics(t.operators,t.operatorAssignments);console.log(" Mtricas con parmetros:",c)}}catch(l){console.error(" Error ejecutando getOperatorMetrics:",l)}if(console.log(`
 3. VERIFICANDO DATOS DE EJEMPLO:`),t&&t.operators&&(console.log(" Operadores disponibles:"),t.operators.forEach((l,c)=>{console.log(`  ${c+1}. ${l.name} (ID: ${l.id})`)})),t&&t.operatorAssignments&&(console.log(" Asignaciones por operador:"),Object.entries(t.operatorAssignments).forEach(([l,c])=>{var h;const f=(h=t.operators)==null?void 0:h.find(d=>d.id===l);console.log(`  ${(f==null?void 0:f.name)||l}: ${(c==null?void 0:c.length)||0} asignaciones`)})),console.log(`
 4. BSQUEDA ESPECFICA DE HERMES:`),t&&t.getAllAssignments){const l=t.getAllAssignments(),c=l.find(f=>{var h,d;return((h=f.beneficiary)==null?void 0:h.toLowerCase().includes("hermes"))||((d=f.beneficiario)==null?void 0:d.toLowerCase().includes("hermes"))});c?console.log(" Hermes encontrado en asignaciones:",c):(console.log(" Hermes NO encontrado en asignaciones"),console.log(" Primeros 5 beneficiarios:",l.slice(0,5).map(f=>f.beneficiary||f.beneficiario)))}if(console.log(`
 5. VERIFICANDO DATOS DE LLAMADAS:`),e&&e.processedData&&(console.log(` Total llamadas procesadas: ${e.processedData.length}`),e.processedData.length>0)){const l=e.processedData[0];console.log(" Primera llamada (muestra):",{beneficiario:l.beneficiario,operador:l.operador,fecha:l.fecha,resultado:l.resultado});const c=e.processedData.find(f=>{var h;return(h=f.beneficiario)==null?void 0:h.toLowerCase().includes("hermes")});c?console.log(" Llamada de Hermes encontrada:",c):console.log(" No se encontraron llamadas de Hermes")}console.log(`
 DIAGNSTICO COMPLETADO
`)};window.runDataSyncDiagnostic=Wj;const Gj=()=>{var r,n,s,a,i,o;console.log(" [AUDIT DIAGNOSIS] === DIAGNSTICO ESPECFICO DEL PROBLEMA ===");const t=(r=window.useAppStore)==null?void 0:r.getState(),e=(n=window.useCallStore)==null?void 0:n.getState();if(!t){console.error(" [AUDIT DIAGNOSIS] useAppStore no est disponible en window");return}if(!e){console.error(" [AUDIT DIAGNOSIS] useCallStore no est disponible en window");return}if(console.log(" [AUDIT DIAGNOSIS] Stores disponibles"),console.log(`
 [AUDIT DIAGNOSIS] ESTADO DE DATOS:`),console.log("- Operadores:",((s=t.operators)==null?void 0:s.length)||0),console.log("- Asignaciones activas:",Object.keys(t.operatorAssignments||{}).length),console.log("- Llamadas procesadas:",((a=e.processedData)==null?void 0:a.length)||0),console.log("- CallData crudo:",((i=e.callData)==null?void 0:i.length)||0),console.log(`
 [AUDIT DIAGNOSIS] ANLISIS DE ASIGNACIONES:`),t.operatorAssignments&&Object.entries(t.operatorAssignments).forEach(([l,c])=>{var h,d,p;const f=(h=t.operators)==null?void 0:h.find(v=>v.id===l);console.log(` ${(f==null?void 0:f.name)||l}: ${(c==null?void 0:c.length)||0} beneficiarios`),c&&c.length>0&&console.log(`    Primer beneficiario: "${((d=c[0])==null?void 0:d.beneficiary)||((p=c[0])==null?void 0:p.beneficiario)}"`)}),console.log(`
 [AUDIT DIAGNOSIS] ANLISIS DE LLAMADAS:`),e.processedData&&e.processedData.length>0){console.log(" Hay llamadas procesadas disponibles"),e.processedData.slice(0,3).forEach((h,d)=>{console.log(` Llamada ${d+1}:`,{beneficiario:h.beneficiario||h.beneficiary,operador:h.operador||h.operator,resultado:h.resultado||h.categoria,duracion:h.duracion})});const l=new Set(e.processedData.map(h=>h.beneficiario||h.beneficiary)),c=new Set;Object.values(t.operatorAssignments||{}).forEach(h=>{h&&Array.isArray(h)&&h.forEach(d=>{c.add(d.beneficiary||d.beneficiario)})}),console.log(` Beneficiarios en llamadas: ${l.size}`),console.log(` Beneficiarios en asignaciones: ${c.size}`);const f=Array.from(l).filter(h=>c.has(h));console.log(` Coincidencias encontradas: ${f.length}`),f.length>0?console.log(" Ejemplos de coincidencias:",f.slice(0,3)):(console.log(" No hay coincidencias - ESTE ES EL PROBLEMA"),console.log(" Muestra llamadas:",Array.from(l).slice(0,3)),console.log(" Muestra asignaciones:",Array.from(c).slice(0,3)))}else console.log(" No hay llamadas procesadas disponibles");console.log(`
 [AUDIT DIAGNOSIS] PROBANDO getOperatorMetrics:`);try{const l=e.getOperatorMetrics(t.operators,t.operatorAssignments);console.log(" Resultado de getOperatorMetrics:",l),l.length===0?console.log(" getOperatorMetrics devuelve array vaco - CONFIRMADO EL PROBLEMA"):(console.log(" getOperatorMetrics funciona correctamente"),l.forEach((c,f)=>{console.log(`${f+1}. ${c.operador}: ${c.totalLlamadas} llamadas`)}))}catch(l){console.error(" Error ejecutando getOperatorMetrics:",l)}console.log(`
 [AUDIT DIAGNOSIS] RECOMENDACIONES:`),((o=e.processedData)==null?void 0:o.length)===0?(console.log(" PROBLEMA: No hay datos de llamadas procesados"),console.log(" SOLUCIN: Cargar archivo Excel con datos de llamadas")):Object.keys(t.operatorAssignments||{}).length===0?(console.log(" PROBLEMA: No hay asignaciones de operadores"),console.log(" SOLUCIN: Configurar asignaciones en el mdulo de Asignaciones")):(console.log(" PROBLEMA: Datos disponibles pero no se mapean correctamente"),console.log(" SOLUCIN: Verificar formato de nombres de beneficiarios")),console.log(`
 [AUDIT DIAGNOSIS] DIAGNSTICO COMPLETADO`)};window.diagnoseAuditProblem=Gj;class IE extends zf.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error capturado por ErrorBoundary:",e,r)}render(){return this.state.hasError?m.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 m-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error en la aplicacin"}),m.jsx("p",{className:"text-red-600 mb-4",children:"Ha ocurrido un error inesperado. Por favor, recarga la pgina."}),m.jsxs("details",{className:"text-sm text-red-700",children:[m.jsx("summary",{className:"cursor-pointer",children:"Detalles tcnicos"}),m.jsx("pre",{className:"mt-2 whitespace-pre-wrap",children:this.state.error&&this.state.error.toString()})]}),m.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Recargar pgina"})]}):this.props.children}}const qj=()=>{const{user:t,logout:e}=j1(),r=X=>{if(!X)return"N/A";try{let T;if(typeof X=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(X)){const P=X.split(/[-\/]/),N=parseInt(P[0]),C=parseInt(P[1]),b=parseInt(P[2]);if(N<=31&&C<=12&&b>=1900)return`${N.toString().padStart(2,"0")}-${C.toString().padStart(2,"0")}-${b}`}if(typeof X=="number"?T=new Date((X-25569)*86400*1e3):T=new Date(X),T&&!isNaN(T.getTime())){const P=T.getDate().toString().padStart(2,"0"),N=(T.getMonth()+1).toString().padStart(2,"0"),C=T.getFullYear();return`${P}-${N}-${C}`}return"Fecha invlida"}catch{return typeof X=="string"?X:"Error en fecha"}},{callData:n,processedData:s,callMetrics:a,setCallData:i,analyzeCallData:o,getOperatorMetrics:l,getHourlyDistribution:c,getFollowUpData:f,hasData:h,isLoading:d,loadingStage:p,loadingMessage:v,setLoadingStage:x}=II(),{operators:E,operatorAssignments:A,activeTab:_,setOperators:y,setOperatorAssignments:M,setActiveTab:z,getAllAssignments:B}=CI(),[w,k]=je.useState("dashboard"),[I,R]=je.useState([]),[F,O]=je.useState([]),[L,ye]=je.useState("connecting"),[de,Ae]=je.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[ve,ie]=je.useState([]),[q,ue]=je.useState([]),[xe,U]=je.useState("all"),[J,G]=je.useState(""),[H,re]=je.useState([]),[he,Ee]=je.useState(!1),[pe,oe]=je.useState(null),[Re,j]=je.useState({name:"",email:"",phone:""}),[De,Be]=je.useState({}),[Je,Ve]=je.useState(null),[me,ct]=je.useState(!1),[Lt,nr]=je.useState(""),[sr,Dn]=je.useState([]),ar=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}],At=je.useRef(!1),[Fr,tt]=je.useState(!1);je.useEffect(()=>{t&&!Fr&&!At.current&&mt()},[t,Fr]),je.useEffect(()=>{n.length>0&&F.length>0&&(console.log(" Re-analizando datos tras actualizacin de asignaciones..."),o())},[F]);const mt=async()=>{if(!At.current){At.current=!0,ye("connecting");try{const X=await zd.getByUser(t.uid);if(X!==null){re(X||[]),y(X||[]),console.log(" Operadores cargados y sincronizados desde Firebase:",(X==null?void 0:X.length)||0);const T=await xf.getAllUserAssignments(t.uid);Be(T||{});const P=await TE.getCallData(t.uid);R(P||[]),St(T||{},X||[]),P&&P.length>0?(console.log(" Cargando y analizando datos reales de llamadas..."),i(P,"firebase"),console.log(" Datos sincronizados con Zustand:",P.length,"llamadas"),setTimeout(()=>o(),100)):(console.log(" No hay datos de llamadas, inicializando mtricas por defecto..."),Qi()),ye("connected"),tt(!0),console.log(" Conectado a Firebase - persistencia habilitada")}else throw new Error("Insufficient permissions")}catch{ye("demo"),tt(!0),Or()}finally{At.current=!1}}},St=(X,T)=>{const P=[];Object.entries(X).forEach(([N,C])=>{const b=T.find(D=>D.id===N);b&&C&&C.forEach(D=>{P.push({id:D.id,operator:b.name,beneficiary:D.beneficiary,phone:D.primaryPhone,commune:D.commune})})}),O(P)},Or=()=>{console.log(" Inicializando con datos de ejemplo..."),O(ar);const X={};ar.forEach(P=>{let C=`operator-${P.operator.toLowerCase().replace(/\s+/g,"-")}`;X[C]||(X[C]=[]),X[C].push({id:P.id,beneficiary:P.beneficiary,beneficiario:P.beneficiary,primaryPhone:P.phone,phone:P.phone,commune:P.commune,comuna:P.commune})});const T=[...new Set(ar.map(P=>P.operator))].map((P,N)=>({id:`operator-${P.toLowerCase().replace(/\s+/g,"-")}`,name:P,email:`${P.toLowerCase().replace(/\s+/g,".")}@example.com`,phone:`+56${N+1}12345678`}));y(T),M(X),console.log(" Datos sincronizados con Zustand:",{operators:T,assignments:X}),Me(),Qi(),console.log(" Datos de ejemplo inicializados")},Me=()=>{const T=[{id:"sample-1",name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-2",name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-3",name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-4",name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-5",name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325",userId:(t==null?void 0:t.uid)||"demo-user"}].filter(P=>P&&P.id&&P.name);re(T),y(T),console.log(" Operadores inicializados y sincronizados:",T.length)},ut=async()=>{if(Re.name.trim()!=="")try{const X=await zd.create(t.uid,Re);re([...H,X]),y([...H,X]),console.log(" Operador creado y sincronizado:",X),j({name:"",email:"",phone:""}),Ee(!1)}catch(X){console.error("Error creating operator:",X),alert("Error al crear teleoperador. Intenta nuevamente.")}},Mt=async X=>{try{await zd.delete(X),await xf.deleteOperatorAssignments(t.uid,X);const T=H.filter(C=>C.id!==X);re(T),y(T),console.log(" Operador eliminado y sincronizado:",X);const P={...De};delete P[X],Be(P);const N=F.filter(C=>!C.id.toString().startsWith(`${X}-`));O(N)}catch(T){console.error("Error deleting operator:",T),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},gt=(X,T)=>{const P=X.target.files[0];if(P){const N=new FileReader;N.onload=C=>{const b=new Uint8Array(C.target.result),D=Sh(b,{type:"array"}),W=D.SheetNames[0],K=D.Sheets[W],Y=Vy.sheet_to_json(K,{header:1});gn(Y,T)},N.readAsArrayBuffer(P)}X.target.value=""},gn=async(X,T)=>{if(X.length<2)return;const P=H.find(C=>C.id===T);if(!P)return;const N=X.slice(1).map((C,b)=>{const D=C[1]?String(C[1]).split(/[\|\-\s]+/).filter(W=>W.trim().length===9):[];return{id:`${T}-${b}`,operatorId:T,operatorName:P.name,beneficiary:C[0]||"",phones:D,primaryPhone:D[0]||"",commune:C[2]||""}}).filter(C=>C.beneficiary&&C.primaryPhone);try{await xf.saveOperatorAssignments(t.uid,T,N),Be(b=>({...b,[T]:N}));const C=N.map(b=>({id:b.id,operator:b.operatorName,beneficiary:b.beneficiary,phone:b.primaryPhone,commune:b.commune}));O(b=>[...b.filter(W=>!W.id.toString().startsWith(`${T}-`)),...C]),Ve(null)}catch(C){console.error("Error saving assignments:",C),alert("Error al guardar asignaciones. Intenta nuevamente.")}},ta=async X=>{try{await xf.deleteOperatorAssignments(t.uid,X);const T={...De};delete T[X],Be(T),O(P=>P.filter(N=>!N.id.toString().startsWith(`${X}-`)))}catch(T){console.error("Error clearing assignments:",T),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},Qi=()=>{if(I.length>0){console.log(" Datos reales disponibles, omitiendo generacin de datos de ejemplo");return}console.log(" Generando datos de ejemplo...");const T=(H.length>0?H.map(N=>N.name):["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"]).map(N=>({operator:N,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),P=Array.from({length:24},(N,C)=>({hour:C,calls:Math.floor(Math.random()*20)+1}));ie(T),ue(P),Ae({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:F.length||5,operators:H.length||5,protocolCompliance:85,pendingFollowUps:12}),F.length>0},xl=X=>{if(!X.trim()){Dn([]);return}console.log(" Iniciando bsqueda para:",X);const T=[];Object.entries(De).forEach(([b,D])=>{const W=H.find(K=>K.id===b);D&&Array.isArray(D)&&D.forEach(K=>{T.push({beneficiary:K.beneficiary||K.beneficiario,beneficiario:K.beneficiary||K.beneficiario,operatorName:(W==null?void 0:W.name)||K.operator||K.operatorName||"Operador no encontrado",operator:(W==null?void 0:W.name)||K.operator||K.operatorName,phone:K.primaryPhone||K.phone||K.telefono||K.numero_cliente||K.phones&&K.phones[0]||"N/A",primaryPhone:K.primaryPhone,phones:K.phones||[],telefono:K.telefono,numero_cliente:K.numero_cliente,commune:K.commune||K.comuna||"N/A",comuna:K.comuna,operatorId:b,source:"operatorAssignments",id:K.id})})});const P=B();console.log(" Asignaciones de Zustand:",P),P.forEach(b=>{T.push({beneficiary:b.beneficiary||b.beneficiario,beneficiario:b.beneficiary||b.beneficiario,operatorName:b.operator||b.operatorName||b.name||"Sin asignar",operator:b.operator||b.operatorName||b.name,phone:b.phone||b.telefono||b.numero_cliente||"N/A",commune:b.commune||b.comuna||"N/A",operatorId:b.operatorId||"zustand",source:"zustand"})}),console.log(" Total asignaciones encontradas:",T.length),console.log(" Muestra de asignaciones:",T.slice(0,3));const N=X.toLowerCase().trim(),C=T.filter(b=>{const D=(b.beneficiary||b.beneficiario||"").toLowerCase(),W=(b.operatorName||b.operator||"").toLowerCase(),K=(b.commune||b.comuna||"").toLowerCase(),Y=[b.phone,b.primaryPhone,b.telefono,b.numero_cliente,...b.phones||[]].filter(ce=>ce&&ce!=="N/A").join(" ").toLowerCase(),Q=D.includes(N),Z=W.includes(N),ae=Y.includes(N),fe=K.includes(N),we=Q||Z||ae||fe;return we&&console.log(" Coincidencia encontrada:",{beneficiary:D,operator:W,phones:Y,commune:K,searchTerm:N,matches:{beneficiaryName:Q,operatorName:Z,phones:ae,commune:fe},source:b.source}),we});console.log(" Resultados filtrados:",C.length),Dn(C)},ra=X=>{nr(X),xl(X)},ri=X=>{const T=X.target.files[0];if(T){x("uploading",`Subiendo archivo: ${T.name}`);const P=new FileReader;P.onload=N=>{try{x("processing","Leyendo datos del archivo Excel...");const C=new Uint8Array(N.target.result),b=Sh(C,{type:"array"}),D=b.SheetNames[0],W=b.Sheets[D],K=Vy.sheet_to_json(W,{header:1});ni(K)}catch(C){console.error("Error al procesar archivo Excel:",C),x("error","Error al procesar el archivo Excel")}},P.onerror=()=>{x("error","Error al leer el archivo")},P.readAsArrayBuffer(T)}X.target.value=""},ni=async X=>{if(X.length<2){x("error","El archivo Excel no contiene datos vlidos");return}try{x("processing",`Procesando ${X.length-1} filas de datos...`);const P=(C=>{const b=C.slice(1,Math.min(6,C.length)),D=Q=>!Q||typeof Q!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(Q)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(Q)||!isNaN(Date.parse(Q))||/^\d+$/.test(Q)||Q.trim().length<3?!1:!!(Q.trim().split(/\s+/).filter(ae=>ae.length>1).length>=2||/^[a-zA-Z\s\-\.]+$/.test(Q)),W={};for(let Q=0;Q<15;Q++){let Z=0;const ae=b.map(fe=>fe[Q]).filter(fe=>fe!=null);if(ae.length!==0){for(const fe of ae)D(String(fe))&&Z++;Z>0&&(W[Q]={score:Z,percentage:Z/ae.length*100,sampleValues:ae.slice(0,3)})}}console.log(" Anlisis de columnas para detectar operadores:",W);let K=7,Y=0;for(const[Q,Z]of Object.entries(W))(Z.score>Y||Z.score===Y&&Z.percentage>50)&&(Y=Z.score,K=parseInt(Q));return console.log(` Columna de operadores detectada: ${K} (puntuacin: ${Y})`),K})(X),N=X.slice(1).map((C,b)=>{b<3&&console.log(`Fila ${b}:`,{col0:C[0],col1:C[1],col2:C[2],col3:C[3],col4:C[4],col5:C[5],col6:C[6],col7:C[7],col8:C[8],col9:C[9],col10:C[10],col11:C[11],operadorDetectado:C[P]});let D=C[P];if(D&&/^\d{1,2}:\d{2}/.test(String(D))){console.warn(` Valor de operador parece ser hora: "${D}". Buscando en otras columnas...`);for(let K=0;K<C.length;K++){const Y=C[K];if(Y&&typeof Y=="string"&&!/^\d{1,2}:\d{2}/.test(Y)&&!/^\d+$/.test(Y)&&Y.trim().split(/\s+/).length>=2){D=Y,console.log(` Operador encontrado en columna ${K}: "${D}"`);break}}}const W=r;return{id:C[0]||`call-${b}-${Date.now()}`,fecha:W(C[1]),beneficiario:C[2],comuna:C[3],tipo_llamada:C[4]==="Entrante"?"entrante":"saliente",numero_cliente:C[5],hora:C[6]||"09:00:00",operador:D||"No identificado",duracion:parseInt(C[8])||0,categoria:C[9]==="Llamado exitoso"?"exitosa":"fallida",resultado:C[9],observacion:C[10],apiId:C[11]}});try{L==="connected"&&await TE.saveCallData(t.uid,N)&&console.log(" Datos de llamadas guardados en Firebase")}catch(C){console.error("Error guardando datos en Firebase:",C)}i(N,"excel"),allAssignments.length===0&&N.length>0&&(console.log(" No hay asignaciones previas, creando asignaciones basadas en operadoras detectadas..."),ks(N)),console.log(` Procesados ${N.length} registros en Zustand`)}catch(T){console.error("Error durante el procesamiento de datos:",T),x("error","Error al procesar los datos del Excel")}},ks=X=>{try{const T={},P=D=>!D||typeof D!="string"?!1:D.trim().length>2&&!/^\d{1,2}:\d{2}/.test(D)&&!/^\d+$/.test(D)&&!/^(si|no|exitoso|fallido|pendiente|hangup|solo)$/i.test(D)&&/^[a-zA-Z\s\-\.]{3,}$/.test(D);X.forEach(D=>{const W=D.beneficiario||D.beneficiary,K=D.operador||D.operator||D.teleoperadora;W&&K&&P(K)&&(T[K]||(T[K]=new Set),T[K].add(W))});const N=Object.keys(T).map((D,W)=>({id:`auto-operator-${W+1}`,name:D,email:`${D.toLowerCase().replace(/\s+/g,".")}@auto.com`,phone:`+56${W+1}87654321`})),C={},b=[];Object.entries(T).forEach(([D,W],K)=>{const Y=`auto-operator-${K+1}`;C[Y]=[],Array.from(W).forEach((Q,Z)=>{const ae={id:`auto-${Y}-${Z+1}`,beneficiary:Q,beneficiario:Q,primaryPhone:"N/A",phone:"N/A",commune:"N/A",comuna:"N/A"};C[Y].push(ae),b.push({...ae,operator:D})})}),N.length>0&&(y(N),M(C),O(b),console.log(" Asignaciones automticas creadas:",{operators:N.length,assignments:b.length,operatorMap:T}))}catch(T){console.error("Error creando asignaciones automticas:",T)}},bn=(()=>{const X=[];console.log(" App.jsx - operatorAssignments (fuente de verdad):",De),console.log(" App.jsx - operators disponibles:",H),Object.entries(De).forEach(([P,N])=>{const C=H.find(b=>b.id===P);C&&N&&Array.isArray(N)?(console.log(` Procesando asignaciones para ${C.name}:`,N.length),N.forEach(b=>{const D={id:b.id,operator:C.name,operatorName:C.name,beneficiary:b.beneficiary,phone:b.primaryPhone,commune:b.commune};X.push(D),console.log(" Asignacin local agregada:",D)})):console.log(` Problemas con operador ${P}:`,{operator:C,assignments:N,isArray:Array.isArray(N)})}),console.log(" Total asignaciones locales:",X.length),console.log(" DIAGNSTICO - Buscando Hermes Eduardo Valbuena Romero en resultado final...");const T=X.find(P=>{var N,C;return((N=P.beneficiary)==null?void 0:N.includes("Hermes"))||((C=P.beneficiary)==null?void 0:C.includes("HERMES"))});return T?console.log(" Hermes encontrado en resultado final:",T):(console.log(" Hermes NO encontrado en resultado final"),console.log(" Primeros 5 beneficiarios disponibles:",X.slice(0,5).map(P=>P.beneficiary))),X})();console.log(" App.jsx - assignmentsToUse final:",bn);const ir=f(bn);console.log(" App.jsx - followUpData resultado:",ir);const si=ir.filter(X=>{if(xe==="no-asignados"){const N=X.operator==="No Asignado"||X.operator==="Sin asignar"||!X.operator||X.operator.trim()==="",C=X.beneficiary.toLowerCase().includes(J.toLowerCase())||X.operator.toLowerCase().includes(J.toLowerCase());return N&&C}const T=xe==="all"||X.status===xe,P=X.beneficiary.toLowerCase().includes(J.toLowerCase())||X.operator.toLowerCase().includes(J.toLowerCase());return T&&P}),Lr=({title:X,value:T,subtitle:P,icon:N,trend:C,color:b="blue"})=>m.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-gray-600 mb-1",children:X}),m.jsx("p",{className:`text-2xl font-bold text-${b}-600 mb-1`,children:T}),m.jsx("p",{className:"text-xs text-gray-500",children:P})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(N,{className:`w-8 h-8 text-${b}-500 mr-2`}),C&&m.jsx("div",{className:`flex items-center ${C>0?"text-green-500":"text-red-500"}`,children:C>0?m.jsx(j2,{className:"w-4 h-4"}):m.jsx(qN,{className:"w-4 h-4"})})]})]})}),Zi=()=>m.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[m.jsxs("div",{className:"p-6 flex-1",children:[m.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Mistatas - Seguimiento de llamadas"}),m.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),m.jsxs("nav",{className:"space-y-2",children:[m.jsx(tn,{icon:Rf,label:"Panel principal",active:w==="dashboard",onClick:()=>k("dashboard")}),m.jsx(tn,{icon:Bn,label:"Registro de Llamadas",active:w==="calls",onClick:()=>k("calls")}),m.jsx(tn,{icon:jn,label:"Asignaciones",active:w==="assignments",onClick:()=>k("assignments")}),m.jsx(tn,{icon:Pf,label:"Historial de Seguimientos",active:w==="history",onClick:()=>k("history")}),m.jsx(tn,{icon:Rf,label:"Auditora Avanzada",active:w==="audit",onClick:()=>k("audit")})]})]}),m.jsxs("div",{className:"p-6 border-t border-gray-200",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[m.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:m.jsx(xg,{className:"w-5 h-5 text-blue-600"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||"Usuario"}),m.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),m.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-gray-50",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:`w-2 h-2 rounded-full ${L==="connected"?"bg-green-500":L==="connecting"?"bg-yellow-500":"bg-orange-500"}`}),m.jsx("span",{className:"text-xs text-gray-600",children:L==="connected"?"Firebase conectado":L==="connecting"?"Conectando...":"Modo demo"})]}),n.length>0&&m.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n.length," llamadas cargadas"]})]}),m.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[m.jsx(VN,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]}),tn=({icon:X,label:T,active:P,onClick:N})=>m.jsxs("button",{onClick:N,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${P?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[m.jsx(X,{className:"w-5 h-5 mr-3"}),m.jsx("span",{className:"text-sm",children:T})]}),eo=()=>{const T=L==="connecting"?{color:"bg-yellow-50 border-yellow-200",icon:"",title:"Conectando...",message:"Conectando con Firebase para cargar datos"}:L==="connected"?n.length>0?{color:"bg-green-50 border-green-200",icon:"",title:"Datos reales activos",message:`Mostrando datos reales de ${n.length} llamadas registradas`}:{color:"bg-blue-50 border-blue-200",icon:"",title:"Firebase conectado - Sin datos de llamadas",message:"Conectado a Firebase. Sube un archivo Excel para ver datos reales"}:{color:"bg-orange-50 border-orange-200",icon:"",title:"Modo demostracin",message:"Mostrando datos de ejemplo. Configura Firebase para persistencia completa"},P=async()=>{L==="connected"&&(tt(!1),await mt())};return m.jsx("div",{className:`${T.color} border rounded-lg p-4 mb-6`,children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("span",{className:"text-lg mr-3",children:T.icon}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-gray-800",children:T.title}),m.jsx("p",{className:"text-sm text-gray-600",children:T.message})]})]}),L==="connected"&&m.jsx("button",{onClick:P,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",title:"Recargar datos desde Firebase",children:" Sincronizar"})]})})},Wt=()=>{const X=a||{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0};console.log(" DASHBOARD METRICS - Anlisis completo:",{zustandCallData_length:(n==null?void 0:n.length)||0,callData_length:(I==null?void 0:I.length)||0,zustandCallMetrics:a,metrics_used:X,dashboard_totalCalls:X.totalCalls,banner_shows:I.length,sidebar_shows:I.length});const T=H.length,P=Object.values(De).reduce((N,C)=>N+(C?C.length:0),0);return console.log(" DASHBOARD SYNC - Contadores CORREGIDOS:",{operatorCount:T,totalAssignments:P,operatorsLocal:H.length,operatorsZustand:E.length,operatorAssignmentsLocal:Object.keys(De).length,operatorAssignmentsZustand:A?Object.keys(A).length:0,operatorAssignmentsDetalle:Object.entries(De).map(([N,C])=>({operatorId:N,assignmentCount:C?C.length:0}))}),m.jsxs("div",{className:"space-y-6",children:[m.jsx(eo,{}),!1,m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[m.jsx(Lr,{title:"Llamadas totales",value:X.totalCalls,subtitle:"Anlisis en tiempo real con Zustand",icon:Bn,color:"blue"}),m.jsx(Lr,{title:"Llamadas exitosas",value:X.successfulCalls,subtitle:"Llamadas con resultado exitoso",icon:Bn,trend:1,color:"green"}),m.jsx(Lr,{title:"Llamadas no exitosas",value:X.failedCalls,subtitle:"No contestadas, fallidas u otro",icon:Bn,trend:-1,color:"red"}),m.jsx(Lr,{title:"Beneficiarios nicos",value:X.uniqueBeneficiaries,subtitle:"Personas contactadas nicas",icon:jn,color:"purple"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[m.jsx(Lr,{title:"Asignaciones activas",value:P,subtitle:"Total de beneficiarios asignados",icon:jn,color:"blue"}),m.jsx(Lr,{title:"Teleoperadoras",value:T,subtitle:"Operadoras registradas en el sistema",icon:jn,color:"blue"}),m.jsx(Lr,{title:"Cumplimiento de protocolo",value:`${X.protocolCompliance}%`,subtitle:"Adherencia a procedimientos establecidos",icon:Rf,color:"green"}),m.jsx(Lr,{title:"Duracin promedio",value:`${Math.round(X.averageDuration/60)}min`,subtitle:"Tiempo promedio por llamada",icon:Pf,color:"orange"})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Mdulos principales"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[m.jsx(na,{title:"Registro de Llamadas",description:"Sube historiales, analiza resultados y clasifica por beneficiario y teleoperadora.",icon:Bn,color:"green",onClick:()=>k("calls")}),m.jsx(na,{title:"Asignaciones",description:"Gestiona relaciones entre beneficiarios y teleoperadoras.",icon:jn,color:"blue",onClick:()=>k("assignments")}),m.jsx(na,{title:"Historial de Seguimientos",description:"Clasifica beneficiarios por frecuencia y estado de contacto.",icon:Pf,color:"orange",onClick:()=>k("history")})]})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Detalle por Teleoperadora"}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-50",children:[m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Teleoperadora"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Cantidad de llamados"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Minutos totales"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tiempo promedio"})]})}),m.jsxs("tbody",{children:[(l&&l(H,De)||[]).map((N,C)=>m.jsxs("tr",{className:"border-b",children:[m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N.operador}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N.totalLlamadas}),m.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(N.tiempoTotal/60)," min"]}),m.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(N.promedioLlamada/60)," min"]})]},C)),(!l||l(H,De).length===0)&&m.jsx("tr",{children:m.jsx("td",{colSpan:"4",className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No hay datos de operadores disponibles. Sube un archivo Excel para ver las mtricas."})})]})]})})]})]})},na=({title:X,description:T,icon:P,color:N,onClick:C})=>m.jsxs("div",{className:`bg-${N}-50 rounded-lg p-6 border border-${N}-200`,children:[m.jsx("div",{className:"flex items-center justify-center mb-4",children:m.jsx("div",{className:`w-16 h-16 bg-${N}-500 rounded-lg flex items-center justify-center`,children:m.jsx(P,{className:"w-8 h-8 text-white"})})}),m.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:X}),m.jsx("p",{className:"text-sm text-gray-600 mb-4",children:T}),m.jsx("button",{onClick:C,className:`w-full bg-${N}-500 text-white py-2 px-4 rounded-lg hover:bg-${N}-600 transition-colors`,children:"Entrar"})]}),Fn=()=>m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),m.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),m.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[m.jsx(Dv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),m.jsxs("label",{className:"cursor-pointer",children:[m.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),m.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ri,className:"hidden"})]}),m.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]}),d&&m.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),m.jsxs("div",{children:[m.jsxs("h4",{className:"text-sm font-medium text-blue-900",children:[p==="uploading"&&" Subiendo archivo...",p==="processing"&&" Procesando datos...",p==="analyzing"&&" Analizando llamadas..."]}),m.jsx("p",{className:"text-sm text-blue-700",children:v})]})]}),m.jsx("div",{className:"mt-3 w-full bg-blue-200 rounded-full h-2",children:m.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:p==="uploading"?"25%":p==="processing"?"50%":p==="analyzing"?"75%":"100%"}})})]}),p==="complete"&&!d&&n.length>0&&m.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("div",{className:"w-6 h-6 bg-green-600 rounded-full flex items-center justify-center",children:m.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-sm font-medium text-green-900",children:" Anlisis completado exitosamente"}),m.jsx("p",{className:"text-sm text-green-700",children:v})]})]})}),p==="error"&&!d&&m.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("div",{className:"w-6 h-6 bg-red-600 rounded-full flex items-center justify-center",children:m.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-sm font-medium text-red-900",children:" Error en el procesamiento"}),m.jsx("p",{className:"text-sm text-red-700",children:v}),m.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Por favor, verifica el formato del archivo e intenta nuevamente."})]})]})})]}),n.length>0&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resumen del Anlisis"}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),m.jsx("div",{className:"text-sm text-gray-600",children:"Total Llamadas"})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(X=>X.categoria==="exitosa"||X.resultado==="Llamado exitoso").length}),m.jsx("div",{className:"text-sm text-gray-600",children:"Exitosas"})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.filter(X=>X.categoria!=="exitosa"&&X.resultado!=="Llamado exitoso").length}),m.jsx("div",{className:"text-sm text-gray-600",children:"Fallidas"})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(n.map(X=>X.beneficiario).filter(Boolean)).size}),m.jsx("div",{className:"text-sm text-gray-600",children:"Beneficiarios"})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-50",children:[m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Comuna"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Operador"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tipo"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),m.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),m.jsx("tbody",{children:n.slice(0,10).map((X,T)=>m.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.id||`call-${T}`}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.fecha||"N/A"}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:X.beneficiario||"N/A"}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.comuna||"N/A"}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.operador||"No identificado"}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:m.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${X.tipo_llamada==="entrante"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:X.tipo_llamada==="entrante"?"Entrante":"Saliente"})}),m.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:m.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${X.resultado==="Llamado exitoso"||X.categoria==="exitosa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:X.resultado||(X.categoria==="exitosa"?"Exitoso":"Fallido")})}),m.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[X.duracion||0,"s"]})]},X.id||T))})]}),m.jsxs("div",{className:"mt-4 flex justify-between items-center text-sm text-gray-600",children:[m.jsxs("span",{children:["Mostrando ",Math.min(10,n.length)," de ",n.length," llamadas procesadas"]}),n.length>10&&m.jsx("span",{className:"text-blue-600",children:"Mostrando solo las primeras 10 filas"})]})]})]})]})]}),Is=()=>m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),m.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),m.jsxs("button",{onClick:()=>Ee(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[m.jsx(bv,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[m.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:H.length})]}),m.jsx(jn,{className:"w-8 h-8 text-blue-500"})]})}),m.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),m.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(De).reduce((X,T)=>X+T.length,0)})]}),m.jsx(Bn,{className:"w-8 h-8 text-green-500"})]})}),m.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),m.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(De).length})]}),m.jsx(sc,{className:"w-8 h-8 text-purple-500"})]})})]})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Bsqueda de Beneficiarios"}),m.jsx("p",{className:"text-sm text-gray-600",children:"Encuentra rpidamente qu teleoperadora est asignada a un beneficiario"})]}),m.jsxs("button",{onClick:()=>ct(!me),className:`px-4 py-2 rounded-lg transition-colors flex items-center gap-2 ${me?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[m.jsx(Zu,{className:"w-4 h-4"}),me?"Cerrar Bsqueda":"Buscar Beneficiario"]})]}),me&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex gap-4 items-center",children:[m.jsx("div",{className:"flex-1",children:m.jsx("input",{type:"text",placeholder:"Buscar por nombre del beneficiario, teleoperadora, telfono o comuna...",value:Lt,onChange:X=>ra(X.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),m.jsx("button",{onClick:()=>{nr(""),Dn([])},className:"px-3 py-2 text-gray-500 hover:text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:m.jsx(Fv,{className:"w-4 h-4"})})]}),sr.length>0&&m.jsxs("div",{className:"border border-gray-200 rounded-lg divide-y divide-gray-200 max-h-96 overflow-y-auto",children:[m.jsxs("div",{className:"bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700",children:[sr.length," resultado(s) encontrado(s)"]}),sr.map((X,T)=>m.jsx("div",{className:"p-4 hover:bg-gray-50",children:m.jsx("div",{className:"flex justify-between items-start",children:m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.jsx("h5",{className:"font-semibold text-gray-900",children:X.beneficiary||X.beneficiario}),m.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"Beneficiario"}),m.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:X.source})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(jn,{className:"w-4 h-4 text-gray-400"}),m.jsxs("span",{children:[m.jsx("strong",{children:"Teleoperadora:"})," ",X.operatorName||X.operator||"Sin asignar"]})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(Bn,{className:"w-4 h-4 text-gray-400"}),m.jsxs("span",{children:[m.jsx("strong",{children:"Telfono Principal:"})," ",X.primaryPhone||X.phone||X.telefono||X.numero_cliente||"N/A"]})]}),X.phones&&X.phones.length>1&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(Bn,{className:"w-4 h-4 text-gray-400"}),m.jsxs("span",{children:[m.jsx("strong",{children:"Otros Telfonos:"})," ",X.phones.slice(1).join(", ")]})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(sc,{className:"w-4 h-4 text-gray-400"}),m.jsxs("span",{children:[m.jsx("strong",{children:"Comuna:"})," ",X.commune||X.comuna||"N/A"]})]})]})]})})},`${X.id||T}-${X.source}`))]}),Lt&&sr.length===0&&m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(Zu,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),m.jsxs("p",{children:['No se encontraron beneficiarios que coincidan con "',Lt,'"']}),m.jsx("p",{className:"text-sm mt-1",children:"Intenta con otro trmino de bsqueda"})]}),!Lt&&m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(Zu,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),m.jsx("p",{children:"Escribe el nombre de un beneficiario, teleoperadora, telfono o comuna para buscar"}),m.jsx("p",{className:"text-sm mt-1",children:"La bsqueda incluye todas las asignaciones registradas"})]})]})]}),he&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),m.jsx("button",{onClick:()=>Ee(!1),className:"text-gray-500 hover:text-gray-700",children:m.jsx(Fv,{className:"w-5 h-5"})})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),m.jsx("input",{type:"text",value:Re.name,onChange:X=>j({...Re,name:X.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),m.jsx("input",{type:"email",value:Re.email,onChange:X=>j({...Re,email:X.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),m.jsx("input",{type:"tel",value:Re.phone,onChange:X=>j({...Re,phone:X.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),m.jsxs("div",{className:"flex gap-3 mt-6",children:[m.jsxs("button",{onClick:ut,disabled:!Re.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[m.jsx(zN,{className:"w-4 h-4"}),"Crear Teleoperador"]}),m.jsx("button",{onClick:()=>Ee(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),m.jsxs("div",{className:"space-y-4",children:[H.filter(X=>X&&X.id).map(X=>m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsxs("div",{className:"flex justify-between items-start mb-4",children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[m.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:X.name||"Operador sin nombre"}),De[X.id]&&m.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[De[X.id].length," beneficiarios"]})]}),m.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[X.email&&m.jsxs("p",{children:[" ",X.email]}),X.phone&&m.jsxs("p",{children:[" ",X.phone]})]})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[m.jsx(Dv,{className:"w-4 h-4"}),"Subir Excel",m.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:T=>gt(T,X.id),className:"hidden"})]}),De[X.id]&&m.jsxs("button",{onClick:()=>ta(X.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[m.jsx(Pv,{className:"w-4 h-4"}),"Limpiar"]}),m.jsxs("button",{onClick:()=>Mt(X.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[m.jsx(Pv,{className:"w-4 h-4"}),"Eliminar"]})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[m.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),m.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),De[X.id]&&De[X.id].length>0&&m.jsxs("div",{className:"border-t pt-4",children:[m.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",De[X.id].length,")"]}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-sm",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-50",children:[m.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),m.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),m.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),m.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),m.jsxs("tbody",{children:[De[X.id].slice(0,5).map(T=>m.jsxs("tr",{className:"border-b",children:[m.jsx("td",{className:"px-3 py-2 text-gray-900",children:T.beneficiary}),m.jsx("td",{className:"px-3 py-2 text-gray-900",children:T.primaryPhone}),m.jsx("td",{className:"px-3 py-2 text-gray-600",children:T.phones.length>1?T.phones.slice(1).join(", "):"-"}),m.jsx("td",{className:"px-3 py-2 text-gray-900",children:T.commune})]},T.id)),De[X.id].length>5&&m.jsx("tr",{children:m.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",De[X.id].length-5," beneficiarios ms"]})})]})]})})]})]},X.id)),H.length===0&&m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[m.jsx(jn,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),m.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),m.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),m.jsxs("button",{onClick:()=>Ee(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[m.jsx(bv,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),vl=()=>{const X=ir.length,T=ir.filter(D=>D.operator==="No Asignado"||D.operator==="Sin asignar"||!D.operator||D.operator.trim()==="").length,P=X-T,N=ir.filter(D=>D.status==="urgente").length,C=ir.filter(D=>D.status==="pendiente").length,b=ir.filter(D=>D.status==="al-dia").length;return m.jsx("div",{className:"space-y-6",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[m.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),m.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[m.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-blue-600",children:X}),m.jsx("div",{className:"text-sm text-blue-700 font-medium",children:"Total"})]}),m.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-green-600",children:P}),m.jsx("div",{className:"text-sm text-green-700 font-medium",children:"Asignados"})]}),m.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-orange-600",children:T}),m.jsx("div",{className:"text-sm text-orange-700 font-medium",children:"No Asignados"})]}),m.jsxs("div",{className:"bg-green-100 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-green-800",children:b}),m.jsx("div",{className:"text-sm text-green-800 font-medium",children:"Al da"})]}),m.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:C}),m.jsx("div",{className:"text-sm text-yellow-700 font-medium",children:"Pendientes"})]}),m.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-red-600",children:N}),m.jsx("div",{className:"text-sm text-red-700 font-medium",children:"Urgentes"})]})]}),m.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(ON,{className:"w-4 h-4 text-gray-400"}),m.jsxs("select",{value:xe,onChange:D=>U(D.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[m.jsx("option",{value:"all",children:"Todos los estados"}),m.jsx("option",{value:"al-dia",children:"Al da"}),m.jsx("option",{value:"pendiente",children:"Pendiente"}),m.jsx("option",{value:"urgente",children:"Urgente"}),m.jsx("option",{value:"no-asignados",children:"No asignados"})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Zu,{className:"w-4 h-4 text-gray-400"}),m.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:J,onChange:D=>G(D.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),xe==="no-asignados"&&m.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx(Vl,{className:"w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-orange-800 font-medium",children:"Filtro: Beneficiarios No Asignados"}),m.jsxs("p",{className:"text-orange-700 text-sm mt-1",children:["Mostrando beneficiarios que no tienen una teleoperadora asignada.",T>0?` Se encontraron ${T} beneficiarios sin asignar.`:" Excelente! Todos los beneficiarios tienen asignacin."]}),T>0&&m.jsxs("p",{className:"text-orange-600 text-xs mt-2",children:[" Ve al mdulo ",m.jsx("strong",{children:"Asignaciones"})," para asignar teleoperadoras a estos beneficiarios"]})]})]})}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:si.length===0?m.jsx("div",{className:"col-span-full bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx(sc,{className:"w-12 h-12 text-gray-400 mb-4"}),m.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:xe==="no-asignados"?"Excelente! No hay beneficiarios sin asignar":"No hay datos de seguimiento"}),m.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:h?xe==="no-asignados"?'Todos los beneficiarios tienen una teleoperadora asignada. Puedes gestionar las asignaciones desde el mdulo "Asignaciones".':"No se encontraron seguimientos que coincidan con los filtros aplicados.":"Para ver el historial de seguimientos, sube un archivo Excel con datos de llamadas desde el Panel Principal."}),!h&&m.jsxs("div",{className:"text-sm text-gray-500",children:[" Ve al ",m.jsx("strong",{children:"Panel Principal"}),"  ",m.jsx("strong",{children:"Cargar Excel"})," para comenzar"]}),xe==="no-asignados"&&h&&m.jsx("div",{className:"text-sm text-green-600",children:" Todas las asignaciones estn completas"})]})}):si.map(D=>{const W=D.operator==="No Asignado"||D.operator==="Sin asignar"||!D.operator||D.operator.trim()==="";return m.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-md transition-shadow ${W?"border-orange-200 bg-orange-50":""}`,children:[m.jsxs("div",{className:"flex items-start justify-between mb-2",children:[m.jsx("h4",{className:"font-medium text-gray-900",children:D.beneficiary}),m.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D.status==="al-dia"?"bg-green-100 text-green-800":D.status==="pendiente"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:D.status==="al-dia"?"Al da":D.status==="pendiente"?"Pendiente":"Urgente"})]}),m.jsxs("p",{className:`text-sm mb-2 ${W?"text-orange-700 font-medium":"text-gray-600"}`,children:["Teleoperadora: ",W?m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Vl,{className:"w-4 h-4"}),D.operator]}):D.operator]}),m.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["ltima llamada: ",D.lastCall]}),m.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total llamadas: ",D.callCount]}),m.jsxs("p",{className:"text-sm text-gray-600",children:["Telfono: ",D.phone]}),D.status==="urgente"&&m.jsxs("div",{className:"mt-2 flex items-center text-red-600 text-sm",children:[m.jsx(Vl,{className:"w-4 h-4 mr-1"}),"Requiere atencin inmediata"]})]},D.id)})})]})})};return m.jsxs("div",{className:"flex h-screen bg-gray-100",children:[m.jsx(Zi,{}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("div",{className:"p-6",children:[m.jsx("div",{className:"mb-6",children:m.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[w==="dashboard"&&"Panel principal",w==="calls"&&"Registro de Llamadas",w==="assignments"&&"Asignaciones",w==="history"&&"Historial de Seguimientos",w==="audit"&&"Auditora Avanzada"]})}),L==="demo"&&m.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx(Vl,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-blue-800 font-medium",children:"Modo Local"}),m.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"La aplicacin funciona con datos locales. Para persistencia en la nube, completa la configuracin de Firebase."}),m.jsx("p",{className:"text-blue-600 text-xs mt-2",children:" Consulta FIREBASE_SETUP.md para instrucciones de configuracin"})]})]})}),L==="connecting"&&m.jsx("div",{className:"mb-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),m.jsx("span",{className:"text-slate-700 text-sm",children:"Verificando configuracin de Firebase..."})]})}),w==="dashboard"&&m.jsx(IE,{children:m.jsx(Wt,{})}),w==="calls"&&m.jsx(Fn,{}),w==="assignments"&&m.jsx(Is,{}),w==="history"&&m.jsx(vl,{}),w==="audit"&&m.jsx(IE,{children:m.jsx(Hj,{})})]})})]})},Kj=()=>{const[t,e]=je.useState(!0),[r,n]=je.useState(!1),[s,a]=je.useState({email:"",password:"",confirmPassword:"",displayName:""}),[i,o]=je.useState(!1),{login:l,register:c,error:f,clearError:h}=j1(),d=E=>{const{name:A,value:_}=E.target;a(y=>({...y,[A]:_})),h()},p=async E=>{E.preventDefault(),o(!0);try{if(t)await l(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await c(s.email,s.password,s.displayName)}}catch(A){console.error("Error en autenticacin:",A)}finally{o(!1)}},v=()=>{e(!t),a({email:"",password:"",confirmPassword:"",displayName:""}),h()},x=E=>E?E.includes("user-not-found")?"Usuario no encontrado":E.includes("wrong-password")?"Contrasea incorrecta":E.includes("email-already-in-use")?"Este email ya est registrado":E.includes("weak-password")?"La contrasea es muy dbil":E.includes("invalid-email")?"Email invlido":E.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":E:"";return m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:m.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[m.jsxs("div",{className:"text-center mb-8",children:[m.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(Bn,{className:"w-8 h-8 text-blue-600"})}),m.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),m.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),f&&m.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[m.jsx(Vl,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),m.jsx("p",{className:"text-red-600 text-sm mt-1",children:x(f)})]})]}),m.jsxs("form",{onSubmit:p,className:"space-y-6",children:[!t&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),m.jsxs("div",{className:"relative",children:[m.jsx(xg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),m.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),m.jsxs("div",{className:"relative",children:[m.jsx(BN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),m.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),m.jsxs("div",{className:"relative",children:[m.jsx(Rv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),m.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:d,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),m.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?m.jsx(RN,{className:"w-5 h-5"}):m.jsx(DN,{className:"w-5 h-5"})})]})]}),!t&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),m.jsxs("div",{className:"relative",children:[m.jsx(Rv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),m.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),m.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:i?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):m.jsx(m.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),m.jsxs("div",{className:"mt-8 text-center",children:[m.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),m.jsx("button",{onClick:v,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),m.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx(IN,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),m.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},Xj=()=>m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:m.jsx(Bn,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),m.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),m.jsxs("div",{className:"flex items-center justify-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),m.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),m.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),m.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),Yj=()=>{const{user:t,loading:e}=j1();return e?m.jsx(Xj,{}):t?m.jsx(qj,{}):m.jsx(Kj,{})};Hd.createRoot(document.getElementById("root")).render(m.jsx(zf.StrictMode,{children:m.jsx(Mj,{children:m.jsx(Yj,{})})}));
