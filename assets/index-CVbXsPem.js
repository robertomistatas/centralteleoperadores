(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function RI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fE={exports:{}},Lh={},hE={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gl=Symbol.for("react.element"),PI=Symbol.for("react.portal"),NI=Symbol.for("react.fragment"),FI=Symbol.for("react.strict_mode"),DI=Symbol.for("react.profiler"),OI=Symbol.for("react.provider"),LI=Symbol.for("react.context"),bI=Symbol.for("react.forward_ref"),MI=Symbol.for("react.suspense"),VI=Symbol.for("react.memo"),UI=Symbol.for("react.lazy"),cv=Symbol.iterator;function BI(t){return t===null||typeof t!="object"?null:(t=cv&&t[cv]||t["@@iterator"],typeof t=="function"?t:null)}var dE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pE=Object.assign,mE={};function qo(t,e,r){this.props=t,this.context=e,this.refs=mE,this.updater=r||dE}qo.prototype.isReactComponent={};qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gE(){}gE.prototype=qo.prototype;function pm(t,e,r){this.props=t,this.context=e,this.refs=mE,this.updater=r||dE}var mm=pm.prototype=new gE;mm.constructor=pm;pE(mm,qo.prototype);mm.isPureReactComponent=!0;var lv=Array.isArray,vE=Object.prototype.hasOwnProperty,gm={current:null},xE={key:!0,ref:!0,__self:!0,__source:!0};function _E(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)vE.call(e,n)&&!xE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),l=0;l<o;l++)c[l]=arguments[l+2];s.children=c}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Gl,type:t,key:i,ref:a,props:s,_owner:gm.current}}function jI(t,e){return{$$typeof:Gl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gl}function zI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var uv=/\/+/g;function M0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zI(""+t.key):e.toString(36)}function uf(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Gl:case PI:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+M0(a,0):n,lv(s)?(r="",t!=null&&(r=t.replace(uv,"$&/")+"/"),uf(s,e,r,"",function(l){return l})):s!=null&&(vm(s)&&(s=jI(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(uv,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",lv(t))for(var o=0;o<t.length;o++){i=t[o];var c=n+M0(i,o);a+=uf(i,e,r,c,s)}else if(c=BI(t),typeof c=="function")for(t=c.call(t),o=0;!(i=t.next()).done;)i=i.value,c=n+M0(i,o++),a+=uf(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ru(t,e,r){if(t==null)return t;var n=[],s=0;return uf(t,n,"","",function(i){return e.call(r,i,s++)}),n}function HI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var jr={current:null},ff={transition:null},$I={ReactCurrentDispatcher:jr,ReactCurrentBatchConfig:ff,ReactCurrentOwner:gm};function yE(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Ru,forEach:function(t,e,r){Ru(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ru(t,function(){e++}),e},toArray:function(t){return Ru(t,function(e){return e})||[]},only:function(t){if(!vm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=qo;We.Fragment=NI;We.Profiler=DI;We.PureComponent=pm;We.StrictMode=FI;We.Suspense=MI;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$I;We.act=yE;We.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=pE({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=gm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in e)vE.call(e,c)&&!xE.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var l=0;l<c;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:Gl,type:t.type,key:s,ref:i,props:n,_owner:a}};We.createContext=function(t){return t={$$typeof:LI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:OI,_context:t},t.Consumer=t};We.createElement=_E;We.createFactory=function(t){var e=_E.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:bI,render:t}};We.isValidElement=vm;We.lazy=function(t){return{$$typeof:UI,_payload:{_status:-1,_result:t},_init:HI}};We.memo=function(t,e){return{$$typeof:VI,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=ff.transition;ff.transition={};try{t()}finally{ff.transition=e}};We.unstable_act=yE;We.useCallback=function(t,e){return jr.current.useCallback(t,e)};We.useContext=function(t){return jr.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return jr.current.useDeferredValue(t)};We.useEffect=function(t,e){return jr.current.useEffect(t,e)};We.useId=function(){return jr.current.useId()};We.useImperativeHandle=function(t,e,r){return jr.current.useImperativeHandle(t,e,r)};We.useInsertionEffect=function(t,e){return jr.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return jr.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return jr.current.useMemo(t,e)};We.useReducer=function(t,e,r){return jr.current.useReducer(t,e,r)};We.useRef=function(t){return jr.current.useRef(t)};We.useState=function(t){return jr.current.useState(t)};We.useSyncExternalStore=function(t,e,r){return jr.current.useSyncExternalStore(t,e,r)};We.useTransition=function(){return jr.current.useTransition()};We.version="18.3.1";hE.exports=We;var Ze=hE.exports;const WI=RI(Ze);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GI=Ze,KI=Symbol.for("react.element"),qI=Symbol.for("react.fragment"),XI=Object.prototype.hasOwnProperty,YI=GI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QI={key:!0,ref:!0,__self:!0,__source:!0};function EE(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)XI.call(e,n)&&!QI.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:KI,type:t,key:i,ref:a,props:s,_owner:YI.current}}Lh.Fragment=qI;Lh.jsx=EE;Lh.jsxs=EE;fE.exports=Lh;var F=fE.exports,bd={},wE={exports:{}},fn={},TE={exports:{}},kE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,W){var le=ie.length;ie.push(W);e:for(;0<le;){var Te=le-1>>>1,M=ie[Te];if(0<s(M,W))ie[Te]=W,ie[le]=M,le=Te;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var W=ie[0],le=ie.pop();if(le!==W){ie[0]=le;e:for(var Te=0,M=ie.length,K=M>>>1;Te<K;){var G=2*(Te+1)-1,H=ie[G],te=G+1,ue=ie[te];if(0>s(H,le))te<M&&0>s(ue,H)?(ie[Te]=ue,ie[te]=le,Te=te):(ie[Te]=H,ie[G]=le,Te=G);else if(te<M&&0>s(ue,le))ie[Te]=ue,ie[te]=le,Te=te;else break e}}return W}function s(ie,W){var le=ie.sortIndex-W.sortIndex;return le!==0?le:ie.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],f=1,h=null,d=3,m=!1,g=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ie){for(var W=r(l);W!==null;){if(W.callback===null)n(l);else if(W.startTime<=ie)n(l),W.sortIndex=W.expirationTime,e(c,W);else break;W=r(l)}}function O(ie){if(v=!1,x(ie),!g)if(r(c)!==null)g=!0,we(z);else{var W=r(l);W!==null&&ge(O,W.startTime-ie)}}function z(ie,W){g=!1,v&&(v=!1,T(k),k=-1),m=!0;var le=d;try{for(x(W),h=r(c);h!==null&&(!(h.expirationTime>W)||ie&&!R());){var Te=h.callback;if(typeof Te=="function"){h.callback=null,d=h.priorityLevel;var M=Te(h.expirationTime<=W);W=t.unstable_now(),typeof M=="function"?h.callback=M:h===r(c)&&n(c),x(W)}else n(c);h=r(c)}if(h!==null)var K=!0;else{var G=r(l);G!==null&&ge(O,G.startTime-W),K=!1}return K}finally{h=null,d=le,m=!1}}var B=!1,_=null,k=-1,A=5,I=-1;function R(){return!(t.unstable_now()-I<A)}function C(){if(_!==null){var ie=t.unstable_now();I=ie;var W=!0;try{W=_(!0,ie)}finally{W?N():(B=!1,_=null)}}else B=!1}var N;if(typeof w=="function")N=function(){w(C)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,he=ye.port2;ye.port1.onmessage=C,N=function(){he.postMessage(null)}}else N=function(){E(C,0)};function we(ie){_=ie,B||(B=!0,N())}function ge(ie,W){k=E(function(){ie(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,we(z))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var le=d;d=W;try{return ie()}finally{d=le}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,W){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var le=d;d=ie;try{return W()}finally{d=le}},t.unstable_scheduleCallback=function(ie,W,le){var Te=t.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Te+le:Te):le=Te,ie){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=le+M,ie={id:f++,callback:W,priorityLevel:ie,startTime:le,expirationTime:M,sortIndex:-1},le>Te?(ie.sortIndex=le,e(l,ie),r(c)===null&&ie===r(l)&&(v?(T(k),k=-1):v=!0,ge(O,le-Te))):(ie.sortIndex=M,e(c,ie),g||m||(g=!0,we(z))),ie},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(ie){var W=d;return function(){var le=d;d=W;try{return ie.apply(this,arguments)}finally{d=le}}}})(kE);TE.exports=kE;var JI=TE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZI=Ze,ln=JI;function ce(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var AE=new Set,fl={};function Ca(t,e){Fo(t,e),Fo(t+"Capture",e)}function Fo(t,e){for(fl[t]=e,t=0;t<e.length;t++)AE.add(e[t])}var Os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Md=Object.prototype.hasOwnProperty,eC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fv={},hv={};function tC(t){return Md.call(hv,t)?!0:Md.call(fv,t)?!1:eC.test(t)?hv[t]=!0:(fv[t]=!0,!1)}function rC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nC(t,e,r,n){if(e===null||typeof e>"u"||rC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zr(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mr[t]=new zr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mr[e]=new zr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mr[t]=new zr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mr[t]=new zr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mr[t]=new zr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mr[t]=new zr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mr[t]=new zr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mr[t]=new zr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mr[t]=new zr(t,5,!1,t.toLowerCase(),null,!1,!1)});var xm=/[\-:]([a-z])/g;function _m(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xm,_m);mr[e]=new zr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xm,_m);mr[e]=new zr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xm,_m);mr[e]=new zr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mr[t]=new zr(t,1,!1,t.toLowerCase(),null,!1,!1)});mr.xlinkHref=new zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mr[t]=new zr(t,1,!1,t.toLowerCase(),null,!0,!0)});function ym(t,e,r,n){var s=mr.hasOwnProperty(e)?mr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nC(e,r,s,n)&&(r=null),n||s===null?tC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Hs=ZI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pu=Symbol.for("react.element"),no=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),Em=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),SE=Symbol.for("react.provider"),IE=Symbol.for("react.context"),wm=Symbol.for("react.forward_ref"),Ud=Symbol.for("react.suspense"),Bd=Symbol.for("react.suspense_list"),Tm=Symbol.for("react.memo"),Zs=Symbol.for("react.lazy"),CE=Symbol.for("react.offscreen"),dv=Symbol.iterator;function xc(t){return t===null||typeof t!="object"?null:(t=dv&&t[dv]||t["@@iterator"],typeof t=="function"?t:null)}var It=Object.assign,V0;function Sc(t){if(V0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);V0=e&&e[1]||""}return`
`+V0+t}var U0=!1;function B0(t,e){if(!t||U0)return"";U0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=o);break}}}finally{U0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Sc(t):""}function sC(t){switch(t.tag){case 5:return Sc(t.type);case 16:return Sc("Lazy");case 13:return Sc("Suspense");case 19:return Sc("SuspenseList");case 0:case 2:case 15:return t=B0(t.type,!1),t;case 11:return t=B0(t.type.render,!1),t;case 1:return t=B0(t.type,!0),t;default:return""}}function jd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case no:return"Portal";case Vd:return"Profiler";case Em:return"StrictMode";case Ud:return"Suspense";case Bd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case IE:return(t.displayName||"Context")+".Consumer";case SE:return(t._context.displayName||"Context")+".Provider";case wm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Tm:return e=t.displayName||null,e!==null?e:jd(t.type)||"Memo";case Zs:e=t._payload,t=t._init;try{return jd(t(e))}catch{}}return null}function iC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jd(e);case 8:return e===Em?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ci(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function RE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aC(t){var e=RE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nu(t){t._valueTracker||(t._valueTracker=aC(t))}function PE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=RE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ff(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zd(t,e){var r=e.checked;return It({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function pv(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ci(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NE(t,e){e=e.checked,e!=null&&ym(t,"checked",e,!1)}function Hd(t,e){NE(t,e);var r=Ci(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$d(t,e.type,r):e.hasOwnProperty("defaultValue")&&$d(t,e.type,Ci(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mv(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function $d(t,e,r){(e!=="number"||Ff(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ic=Array.isArray;function xo(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ci(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Wd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return It({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gv(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ce(92));if(Ic(r)){if(1<r.length)throw Error(ce(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ci(r)}}function FE(t,e){var r=Ci(e.value),n=Ci(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function vv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fu,OE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fu=Fu||document.createElement("div"),Fu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hl(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Bc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oC=["Webkit","ms","Moz","O"];Object.keys(Bc).forEach(function(t){oC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bc[e]=Bc[t]})});function LE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Bc.hasOwnProperty(t)&&Bc[t]?(""+e).trim():e+"px"}function bE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=LE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var cC=It({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kd(t,e){if(e){if(cC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function qd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xd=null;function km(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yd=null,_o=null,yo=null;function xv(t){if(t=Xl(t)){if(typeof Yd!="function")throw Error(ce(280));var e=t.stateNode;e&&(e=Bh(e),Yd(t.stateNode,t.type,e))}}function ME(t){_o?yo?yo.push(t):yo=[t]:_o=t}function VE(){if(_o){var t=_o,e=yo;if(yo=_o=null,xv(t),e)for(t=0;t<e.length;t++)xv(e[t])}}function UE(t,e){return t(e)}function BE(){}var j0=!1;function jE(t,e,r){if(j0)return t(e,r);j0=!0;try{return UE(t,e,r)}finally{j0=!1,(_o!==null||yo!==null)&&(BE(),VE())}}function dl(t,e){var r=t.stateNode;if(r===null)return null;var n=Bh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ce(231,e,typeof r));return r}var Qd=!1;if(Os)try{var _c={};Object.defineProperty(_c,"passive",{get:function(){Qd=!0}}),window.addEventListener("test",_c,_c),window.removeEventListener("test",_c,_c)}catch{Qd=!1}function lC(t,e,r,n,s,i,a,o,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(f){this.onError(f)}}var jc=!1,Df=null,Of=!1,Jd=null,uC={onError:function(t){jc=!0,Df=t}};function fC(t,e,r,n,s,i,a,o,c){jc=!1,Df=null,lC.apply(uC,arguments)}function hC(t,e,r,n,s,i,a,o,c){if(fC.apply(this,arguments),jc){if(jc){var l=Df;jc=!1,Df=null}else throw Error(ce(198));Of||(Of=!0,Jd=l)}}function Ra(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function zE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _v(t){if(Ra(t)!==t)throw Error(ce(188))}function dC(t){var e=t.alternate;if(!e){if(e=Ra(t),e===null)throw Error(ce(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return _v(s),t;if(i===n)return _v(s),e;i=i.sibling}throw Error(ce(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?t:e}function HE(t){return t=dC(t),t!==null?$E(t):null}function $E(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$E(t);if(e!==null)return e;t=t.sibling}return null}var WE=ln.unstable_scheduleCallback,yv=ln.unstable_cancelCallback,pC=ln.unstable_shouldYield,mC=ln.unstable_requestPaint,Vt=ln.unstable_now,gC=ln.unstable_getCurrentPriorityLevel,Am=ln.unstable_ImmediatePriority,GE=ln.unstable_UserBlockingPriority,Lf=ln.unstable_NormalPriority,vC=ln.unstable_LowPriority,KE=ln.unstable_IdlePriority,bh=null,ss=null;function xC(t){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot(bh,t,void 0,(t.current.flags&128)===128)}catch{}}var Un=Math.clz32?Math.clz32:EC,_C=Math.log,yC=Math.LN2;function EC(t){return t>>>=0,t===0?32:31-(_C(t)/yC|0)|0}var Du=64,Ou=4194304;function Cc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function bf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Cc(o):(i&=a,i!==0&&(n=Cc(i)))}else a=r&~s,a!==0?n=Cc(a):i!==0&&(n=Cc(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Un(e),s=1<<r,n|=t[r],e&=~s;return n}function wC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Un(i),o=1<<a,c=s[a];c===-1?(!(o&r)||o&n)&&(s[a]=wC(o,e)):c<=e&&(t.expiredLanes|=o),i&=~o}}function Zd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function qE(){var t=Du;return Du<<=1,!(Du&4194240)&&(Du=64),t}function z0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Kl(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Un(e),t[e]=r}function kC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Un(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Sm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Un(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var lt=0;function XE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var YE,Im,QE,JE,ZE,ep=!1,Lu=[],pi=null,mi=null,gi=null,pl=new Map,ml=new Map,ri=[],AC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ev(t,e){switch(t){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":mi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":pl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ml.delete(e.pointerId)}}function yc(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Xl(e),e!==null&&Im(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function SC(t,e,r,n,s){switch(e){case"focusin":return pi=yc(pi,t,e,r,n,s),!0;case"dragenter":return mi=yc(mi,t,e,r,n,s),!0;case"mouseover":return gi=yc(gi,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return pl.set(i,yc(pl.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ml.set(i,yc(ml.get(i)||null,t,e,r,n,s)),!0}return!1}function ew(t){var e=na(t.target);if(e!==null){var r=Ra(e);if(r!==null){if(e=r.tag,e===13){if(e=zE(r),e!==null){t.blockedOn=e,ZE(t.priority,function(){QE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=tp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Xd=n,r.target.dispatchEvent(n),Xd=null}else return e=Xl(r),e!==null&&Im(e),t.blockedOn=r,!1;e.shift()}return!0}function wv(t,e,r){hf(t)&&r.delete(e)}function IC(){ep=!1,pi!==null&&hf(pi)&&(pi=null),mi!==null&&hf(mi)&&(mi=null),gi!==null&&hf(gi)&&(gi=null),pl.forEach(wv),ml.forEach(wv)}function Ec(t,e){t.blockedOn===e&&(t.blockedOn=null,ep||(ep=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,IC)))}function gl(t){function e(s){return Ec(s,t)}if(0<Lu.length){Ec(Lu[0],t);for(var r=1;r<Lu.length;r++){var n=Lu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(pi!==null&&Ec(pi,t),mi!==null&&Ec(mi,t),gi!==null&&Ec(gi,t),pl.forEach(e),ml.forEach(e),r=0;r<ri.length;r++)n=ri[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ri.length&&(r=ri[0],r.blockedOn===null);)ew(r),r.blockedOn===null&&ri.shift()}var Eo=Hs.ReactCurrentBatchConfig,Mf=!0;function CC(t,e,r,n){var s=lt,i=Eo.transition;Eo.transition=null;try{lt=1,Cm(t,e,r,n)}finally{lt=s,Eo.transition=i}}function RC(t,e,r,n){var s=lt,i=Eo.transition;Eo.transition=null;try{lt=4,Cm(t,e,r,n)}finally{lt=s,Eo.transition=i}}function Cm(t,e,r,n){if(Mf){var s=tp(t,e,r,n);if(s===null)J0(t,e,n,Vf,r),Ev(t,n);else if(SC(s,t,e,r,n))n.stopPropagation();else if(Ev(t,n),e&4&&-1<AC.indexOf(t)){for(;s!==null;){var i=Xl(s);if(i!==null&&YE(i),i=tp(t,e,r,n),i===null&&J0(t,e,n,Vf,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else J0(t,e,n,null,r)}}var Vf=null;function tp(t,e,r,n){if(Vf=null,t=km(n),t=na(t),t!==null)if(e=Ra(t),e===null)t=null;else if(r=e.tag,r===13){if(t=zE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vf=t,null}function tw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gC()){case Am:return 1;case GE:return 4;case Lf:case vC:return 16;case KE:return 536870912;default:return 16}default:return 16}}var li=null,Rm=null,df=null;function rw(){if(df)return df;var t,e=Rm,r=e.length,n,s="value"in li?li.value:li.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return df=s.slice(t,1<n?1-n:void 0)}function pf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bu(){return!0}function Tv(){return!1}function hn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?bu:Tv,this.isPropagationStopped=Tv,this}return It(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bu)},persist:function(){},isPersistent:bu}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pm=hn(Xo),ql=It({},Xo,{view:0,detail:0}),PC=hn(ql),H0,$0,wc,Mh=It({},ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wc&&(wc&&t.type==="mousemove"?(H0=t.screenX-wc.screenX,$0=t.screenY-wc.screenY):$0=H0=0,wc=t),H0)},movementY:function(t){return"movementY"in t?t.movementY:$0}}),kv=hn(Mh),NC=It({},Mh,{dataTransfer:0}),FC=hn(NC),DC=It({},ql,{relatedTarget:0}),W0=hn(DC),OC=It({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),LC=hn(OC),bC=It({},Xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),MC=hn(bC),VC=It({},Xo,{data:0}),Av=hn(VC),UC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=jC[t])?!!e[t]:!1}function Nm(){return zC}var HC=It({},ql,{key:function(t){if(t.key){var e=UC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?BC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nm,charCode:function(t){return t.type==="keypress"?pf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$C=hn(HC),WC=It({},Mh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sv=hn(WC),GC=It({},ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nm}),KC=hn(GC),qC=It({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),XC=hn(qC),YC=It({},Mh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QC=hn(YC),JC=[9,13,27,32],Fm=Os&&"CompositionEvent"in window,zc=null;Os&&"documentMode"in document&&(zc=document.documentMode);var ZC=Os&&"TextEvent"in window&&!zc,nw=Os&&(!Fm||zc&&8<zc&&11>=zc),Iv=" ",Cv=!1;function sw(t,e){switch(t){case"keyup":return JC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var io=!1;function e4(t,e){switch(t){case"compositionend":return iw(e);case"keypress":return e.which!==32?null:(Cv=!0,Iv);case"textInput":return t=e.data,t===Iv&&Cv?null:t;default:return null}}function t4(t,e){if(io)return t==="compositionend"||!Fm&&sw(t,e)?(t=rw(),df=Rm=li=null,io=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nw&&e.locale!=="ko"?null:e.data;default:return null}}var r4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!r4[t.type]:e==="textarea"}function aw(t,e,r,n){ME(n),e=Uf(e,"onChange"),0<e.length&&(r=new Pm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Hc=null,vl=null;function n4(t){vw(t,0)}function Vh(t){var e=co(t);if(PE(e))return t}function s4(t,e){if(t==="change")return e}var ow=!1;if(Os){var G0;if(Os){var K0="oninput"in document;if(!K0){var Pv=document.createElement("div");Pv.setAttribute("oninput","return;"),K0=typeof Pv.oninput=="function"}G0=K0}else G0=!1;ow=G0&&(!document.documentMode||9<document.documentMode)}function Nv(){Hc&&(Hc.detachEvent("onpropertychange",cw),vl=Hc=null)}function cw(t){if(t.propertyName==="value"&&Vh(vl)){var e=[];aw(e,vl,t,km(t)),jE(n4,e)}}function i4(t,e,r){t==="focusin"?(Nv(),Hc=e,vl=r,Hc.attachEvent("onpropertychange",cw)):t==="focusout"&&Nv()}function a4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vh(vl)}function o4(t,e){if(t==="click")return Vh(e)}function c4(t,e){if(t==="input"||t==="change")return Vh(e)}function l4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zn=typeof Object.is=="function"?Object.is:l4;function xl(t,e){if(zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Md.call(e,s)||!zn(t[s],e[s]))return!1}return!0}function Fv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dv(t,e){var r=Fv(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Fv(r)}}function lw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?lw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uw(){for(var t=window,e=Ff();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ff(t.document)}return e}function Dm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function u4(t){var e=uw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&lw(r.ownerDocument.documentElement,r)){if(n!==null&&Dm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Dv(r,i);var a=Dv(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var f4=Os&&"documentMode"in document&&11>=document.documentMode,ao=null,rp=null,$c=null,np=!1;function Ov(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;np||ao==null||ao!==Ff(n)||(n=ao,"selectionStart"in n&&Dm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),$c&&xl($c,n)||($c=n,n=Uf(rp,"onSelect"),0<n.length&&(e=new Pm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ao)))}function Mu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var oo={animationend:Mu("Animation","AnimationEnd"),animationiteration:Mu("Animation","AnimationIteration"),animationstart:Mu("Animation","AnimationStart"),transitionend:Mu("Transition","TransitionEnd")},q0={},fw={};Os&&(fw=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function Uh(t){if(q0[t])return q0[t];if(!oo[t])return t;var e=oo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in fw)return q0[t]=e[r];return t}var hw=Uh("animationend"),dw=Uh("animationiteration"),pw=Uh("animationstart"),mw=Uh("transitionend"),gw=new Map,Lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ui(t,e){gw.set(t,e),Ca(e,[t])}for(var X0=0;X0<Lv.length;X0++){var Y0=Lv[X0],h4=Y0.toLowerCase(),d4=Y0[0].toUpperCase()+Y0.slice(1);Ui(h4,"on"+d4)}Ui(hw,"onAnimationEnd");Ui(dw,"onAnimationIteration");Ui(pw,"onAnimationStart");Ui("dblclick","onDoubleClick");Ui("focusin","onFocus");Ui("focusout","onBlur");Ui(mw,"onTransitionEnd");Fo("onMouseEnter",["mouseout","mouseover"]);Fo("onMouseLeave",["mouseout","mouseover"]);Fo("onPointerEnter",["pointerout","pointerover"]);Fo("onPointerLeave",["pointerout","pointerover"]);Ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rc));function bv(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,hC(n,e,void 0,t),t.currentTarget=null}function vw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;bv(s,o,l),i=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;bv(s,o,l),i=c}}}if(Of)throw t=Jd,Of=!1,Jd=null,t}function xt(t,e){var r=e[cp];r===void 0&&(r=e[cp]=new Set);var n=t+"__bubble";r.has(n)||(xw(e,t,2,!1),r.add(n))}function Q0(t,e,r){var n=0;e&&(n|=4),xw(r,t,n,e)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function _l(t){if(!t[Vu]){t[Vu]=!0,AE.forEach(function(r){r!=="selectionchange"&&(p4.has(r)||Q0(r,!1,t),Q0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vu]||(e[Vu]=!0,Q0("selectionchange",!1,e))}}function xw(t,e,r,n){switch(tw(e)){case 1:var s=CC;break;case 4:s=RC;break;default:s=Cm}r=s.bind(null,e,r,t),s=void 0,!Qd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function J0(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=na(o),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}o=o.parentNode}}n=n.return}jE(function(){var l=i,f=km(r),h=[];e:{var d=gw.get(t);if(d!==void 0){var m=Pm,g=t;switch(t){case"keypress":if(pf(r)===0)break e;case"keydown":case"keyup":m=$C;break;case"focusin":g="focus",m=W0;break;case"focusout":g="blur",m=W0;break;case"beforeblur":case"afterblur":m=W0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=FC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=KC;break;case hw:case dw:case pw:m=LC;break;case mw:m=XC;break;case"scroll":m=PC;break;case"wheel":m=QC;break;case"copy":case"cut":case"paste":m=MC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Sv}var v=(e&4)!==0,E=!v&&t==="scroll",T=v?d!==null?d+"Capture":null:d;v=[];for(var w=l,x;w!==null;){x=w;var O=x.stateNode;if(x.tag===5&&O!==null&&(x=O,T!==null&&(O=dl(w,T),O!=null&&v.push(yl(w,O,x)))),E)break;w=w.return}0<v.length&&(d=new m(d,g,null,r,f),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==Xd&&(g=r.relatedTarget||r.fromElement)&&(na(g)||g[Ls]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=l,g=g?na(g):null,g!==null&&(E=Ra(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=l),m!==g)){if(v=kv,O="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=Sv,O="onPointerLeave",T="onPointerEnter",w="pointer"),E=m==null?d:co(m),x=g==null?d:co(g),d=new v(O,w+"leave",m,r,f),d.target=E,d.relatedTarget=x,O=null,na(f)===l&&(v=new v(T,w+"enter",g,r,f),v.target=x,v.relatedTarget=E,O=v),E=O,m&&g)t:{for(v=m,T=g,w=0,x=v;x;x=Ya(x))w++;for(x=0,O=T;O;O=Ya(O))x++;for(;0<w-x;)v=Ya(v),w--;for(;0<x-w;)T=Ya(T),x--;for(;w--;){if(v===T||T!==null&&v===T.alternate)break t;v=Ya(v),T=Ya(T)}v=null}else v=null;m!==null&&Mv(h,d,m,v,!1),g!==null&&E!==null&&Mv(h,E,g,v,!0)}}e:{if(d=l?co(l):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var z=s4;else if(Rv(d))if(ow)z=c4;else{z=a4;var B=i4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=o4);if(z&&(z=z(t,l))){aw(h,z,r,f);break e}B&&B(t,d,l),t==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&$d(d,"number",d.value)}switch(B=l?co(l):window,t){case"focusin":(Rv(B)||B.contentEditable==="true")&&(ao=B,rp=l,$c=null);break;case"focusout":$c=rp=ao=null;break;case"mousedown":np=!0;break;case"contextmenu":case"mouseup":case"dragend":np=!1,Ov(h,r,f);break;case"selectionchange":if(f4)break;case"keydown":case"keyup":Ov(h,r,f)}var _;if(Fm)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else io?sw(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(nw&&r.locale!=="ko"&&(io||k!=="onCompositionStart"?k==="onCompositionEnd"&&io&&(_=rw()):(li=f,Rm="value"in li?li.value:li.textContent,io=!0)),B=Uf(l,k),0<B.length&&(k=new Av(k,t,null,r,f),h.push({event:k,listeners:B}),_?k.data=_:(_=iw(r),_!==null&&(k.data=_)))),(_=ZC?e4(t,r):t4(t,r))&&(l=Uf(l,"onBeforeInput"),0<l.length&&(f=new Av("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:l}),f.data=_))}vw(h,e)})}function yl(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Uf(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=dl(t,r),i!=null&&n.unshift(yl(t,i,s)),i=dl(t,e),i!=null&&n.push(yl(t,i,s))),t=t.return}return n}function Ya(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mv(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,l=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&l!==null&&(o=l,s?(c=dl(r,i),c!=null&&a.unshift(yl(r,c,o))):s||(c=dl(r,i),c!=null&&a.push(yl(r,c,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var m4=/\r\n?/g,g4=/\u0000|\uFFFD/g;function Vv(t){return(typeof t=="string"?t:""+t).replace(m4,`
`).replace(g4,"")}function Uu(t,e,r){if(e=Vv(e),Vv(t)!==e&&r)throw Error(ce(425))}function Bf(){}var sp=null,ip=null;function ap(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var op=typeof setTimeout=="function"?setTimeout:void 0,v4=typeof clearTimeout=="function"?clearTimeout:void 0,Uv=typeof Promise=="function"?Promise:void 0,x4=typeof queueMicrotask=="function"?queueMicrotask:typeof Uv<"u"?function(t){return Uv.resolve(null).then(t).catch(_4)}:op;function _4(t){setTimeout(function(){throw t})}function Z0(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),gl(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);gl(e)}function vi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Bv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),ts="__reactFiber$"+Yo,El="__reactProps$"+Yo,Ls="__reactContainer$"+Yo,cp="__reactEvents$"+Yo,y4="__reactListeners$"+Yo,E4="__reactHandles$"+Yo;function na(t){var e=t[ts];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ls]||r[ts]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Bv(t);t!==null;){if(r=t[ts])return r;t=Bv(t)}return e}t=r,r=t.parentNode}return null}function Xl(t){return t=t[ts]||t[Ls],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ce(33))}function Bh(t){return t[El]||null}var lp=[],lo=-1;function Bi(t){return{current:t}}function yt(t){0>lo||(t.current=lp[lo],lp[lo]=null,lo--)}function dt(t,e){lo++,lp[lo]=t.current,t.current=e}var Ri={},Pr=Bi(Ri),qr=Bi(!1),pa=Ri;function Do(t,e){var r=t.type.contextTypes;if(!r)return Ri;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Xr(t){return t=t.childContextTypes,t!=null}function jf(){yt(qr),yt(Pr)}function jv(t,e,r){if(Pr.current!==Ri)throw Error(ce(168));dt(Pr,e),dt(qr,r)}function _w(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(ce(108,iC(t)||"Unknown",s));return It({},r,n)}function zf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ri,pa=Pr.current,dt(Pr,t),dt(qr,qr.current),!0}function zv(t,e,r){var n=t.stateNode;if(!n)throw Error(ce(169));r?(t=_w(t,e,pa),n.__reactInternalMemoizedMergedChildContext=t,yt(qr),yt(Pr),dt(Pr,t)):yt(qr),dt(qr,r)}var Ts=null,jh=!1,ed=!1;function yw(t){Ts===null?Ts=[t]:Ts.push(t)}function w4(t){jh=!0,yw(t)}function ji(){if(!ed&&Ts!==null){ed=!0;var t=0,e=lt;try{var r=Ts;for(lt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ts=null,jh=!1}catch(s){throw Ts!==null&&(Ts=Ts.slice(t+1)),WE(Am,ji),s}finally{lt=e,ed=!1}}return null}var uo=[],fo=0,Hf=null,$f=0,gn=[],vn=0,ma=null,ks=1,As="";function Zi(t,e){uo[fo++]=$f,uo[fo++]=Hf,Hf=t,$f=e}function Ew(t,e,r){gn[vn++]=ks,gn[vn++]=As,gn[vn++]=ma,ma=t;var n=ks;t=As;var s=32-Un(n)-1;n&=~(1<<s),r+=1;var i=32-Un(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,ks=1<<32-Un(e)+s|r<<s|n,As=i+t}else ks=1<<i|r<<s|n,As=t}function Om(t){t.return!==null&&(Zi(t,1),Ew(t,1,0))}function Lm(t){for(;t===Hf;)Hf=uo[--fo],uo[fo]=null,$f=uo[--fo],uo[fo]=null;for(;t===ma;)ma=gn[--vn],gn[vn]=null,As=gn[--vn],gn[vn]=null,ks=gn[--vn],gn[vn]=null}var on=null,sn=null,Tt=!1,On=null;function ww(t,e){var r=yn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Hv(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,on=t,sn=vi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,on=t,sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ma!==null?{id:ks,overflow:As}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=yn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,on=t,sn=null,!0):!1;default:return!1}}function up(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fp(t){if(Tt){var e=sn;if(e){var r=e;if(!Hv(t,e)){if(up(t))throw Error(ce(418));e=vi(r.nextSibling);var n=on;e&&Hv(t,e)?ww(n,r):(t.flags=t.flags&-4097|2,Tt=!1,on=t)}}else{if(up(t))throw Error(ce(418));t.flags=t.flags&-4097|2,Tt=!1,on=t}}}function $v(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;on=t}function Bu(t){if(t!==on)return!1;if(!Tt)return $v(t),Tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ap(t.type,t.memoizedProps)),e&&(e=sn)){if(up(t))throw Tw(),Error(ce(418));for(;e;)ww(t,e),e=vi(e.nextSibling)}if($v(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ce(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){sn=vi(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}sn=null}}else sn=on?vi(t.stateNode.nextSibling):null;return!0}function Tw(){for(var t=sn;t;)t=vi(t.nextSibling)}function Oo(){sn=on=null,Tt=!1}function bm(t){On===null?On=[t]:On.push(t)}var T4=Hs.ReactCurrentBatchConfig;function Tc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,t))}return t}function ju(t,e){throw t=Object.prototype.toString.call(e),Error(ce(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wv(t){var e=t._init;return e(t._payload)}function kw(t){function e(T,w){if(t){var x=T.deletions;x===null?(T.deletions=[w],T.flags|=16):x.push(w)}}function r(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function n(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function s(T,w){return T=Ei(T,w),T.index=0,T.sibling=null,T}function i(T,w,x){return T.index=x,t?(x=T.alternate,x!==null?(x=x.index,x<w?(T.flags|=2,w):x):(T.flags|=2,w)):(T.flags|=1048576,w)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,w,x,O){return w===null||w.tag!==6?(w=od(x,T.mode,O),w.return=T,w):(w=s(w,x),w.return=T,w)}function c(T,w,x,O){var z=x.type;return z===so?f(T,w,x.props.children,O,x.key):w!==null&&(w.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Zs&&Wv(z)===w.type)?(O=s(w,x.props),O.ref=Tc(T,w,x),O.return=T,O):(O=Ef(x.type,x.key,x.props,null,T.mode,O),O.ref=Tc(T,w,x),O.return=T,O)}function l(T,w,x,O){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=cd(x,T.mode,O),w.return=T,w):(w=s(w,x.children||[]),w.return=T,w)}function f(T,w,x,O,z){return w===null||w.tag!==7?(w=ua(x,T.mode,O,z),w.return=T,w):(w=s(w,x),w.return=T,w)}function h(T,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=od(""+w,T.mode,x),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Pu:return x=Ef(w.type,w.key,w.props,null,T.mode,x),x.ref=Tc(T,null,w),x.return=T,x;case no:return w=cd(w,T.mode,x),w.return=T,w;case Zs:var O=w._init;return h(T,O(w._payload),x)}if(Ic(w)||xc(w))return w=ua(w,T.mode,x,null),w.return=T,w;ju(T,w)}return null}function d(T,w,x,O){var z=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return z!==null?null:o(T,w,""+x,O);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Pu:return x.key===z?c(T,w,x,O):null;case no:return x.key===z?l(T,w,x,O):null;case Zs:return z=x._init,d(T,w,z(x._payload),O)}if(Ic(x)||xc(x))return z!==null?null:f(T,w,x,O,null);ju(T,x)}return null}function m(T,w,x,O,z){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(x)||null,o(w,T,""+O,z);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Pu:return T=T.get(O.key===null?x:O.key)||null,c(w,T,O,z);case no:return T=T.get(O.key===null?x:O.key)||null,l(w,T,O,z);case Zs:var B=O._init;return m(T,w,x,B(O._payload),z)}if(Ic(O)||xc(O))return T=T.get(x)||null,f(w,T,O,z,null);ju(w,O)}return null}function g(T,w,x,O){for(var z=null,B=null,_=w,k=w=0,A=null;_!==null&&k<x.length;k++){_.index>k?(A=_,_=null):A=_.sibling;var I=d(T,_,x[k],O);if(I===null){_===null&&(_=A);break}t&&_&&I.alternate===null&&e(T,_),w=i(I,w,k),B===null?z=I:B.sibling=I,B=I,_=A}if(k===x.length)return r(T,_),Tt&&Zi(T,k),z;if(_===null){for(;k<x.length;k++)_=h(T,x[k],O),_!==null&&(w=i(_,w,k),B===null?z=_:B.sibling=_,B=_);return Tt&&Zi(T,k),z}for(_=n(T,_);k<x.length;k++)A=m(_,T,k,x[k],O),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?k:A.key),w=i(A,w,k),B===null?z=A:B.sibling=A,B=A);return t&&_.forEach(function(R){return e(T,R)}),Tt&&Zi(T,k),z}function v(T,w,x,O){var z=xc(x);if(typeof z!="function")throw Error(ce(150));if(x=z.call(x),x==null)throw Error(ce(151));for(var B=z=null,_=w,k=w=0,A=null,I=x.next();_!==null&&!I.done;k++,I=x.next()){_.index>k?(A=_,_=null):A=_.sibling;var R=d(T,_,I.value,O);if(R===null){_===null&&(_=A);break}t&&_&&R.alternate===null&&e(T,_),w=i(R,w,k),B===null?z=R:B.sibling=R,B=R,_=A}if(I.done)return r(T,_),Tt&&Zi(T,k),z;if(_===null){for(;!I.done;k++,I=x.next())I=h(T,I.value,O),I!==null&&(w=i(I,w,k),B===null?z=I:B.sibling=I,B=I);return Tt&&Zi(T,k),z}for(_=n(T,_);!I.done;k++,I=x.next())I=m(_,T,k,I.value,O),I!==null&&(t&&I.alternate!==null&&_.delete(I.key===null?k:I.key),w=i(I,w,k),B===null?z=I:B.sibling=I,B=I);return t&&_.forEach(function(C){return e(T,C)}),Tt&&Zi(T,k),z}function E(T,w,x,O){if(typeof x=="object"&&x!==null&&x.type===so&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Pu:e:{for(var z=x.key,B=w;B!==null;){if(B.key===z){if(z=x.type,z===so){if(B.tag===7){r(T,B.sibling),w=s(B,x.props.children),w.return=T,T=w;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Zs&&Wv(z)===B.type){r(T,B.sibling),w=s(B,x.props),w.ref=Tc(T,B,x),w.return=T,T=w;break e}r(T,B);break}else e(T,B);B=B.sibling}x.type===so?(w=ua(x.props.children,T.mode,O,x.key),w.return=T,T=w):(O=Ef(x.type,x.key,x.props,null,T.mode,O),O.ref=Tc(T,w,x),O.return=T,T=O)}return a(T);case no:e:{for(B=x.key;w!==null;){if(w.key===B)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(T,w.sibling),w=s(w,x.children||[]),w.return=T,T=w;break e}else{r(T,w);break}else e(T,w);w=w.sibling}w=cd(x,T.mode,O),w.return=T,T=w}return a(T);case Zs:return B=x._init,E(T,w,B(x._payload),O)}if(Ic(x))return g(T,w,x,O);if(xc(x))return v(T,w,x,O);ju(T,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(T,w.sibling),w=s(w,x),w.return=T,T=w):(r(T,w),w=od(x,T.mode,O),w.return=T,T=w),a(T)):r(T,w)}return E}var Lo=kw(!0),Aw=kw(!1),Wf=Bi(null),Gf=null,ho=null,Mm=null;function Vm(){Mm=ho=Gf=null}function Um(t){var e=Wf.current;yt(Wf),t._currentValue=e}function hp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function wo(t,e){Gf=t,Mm=ho=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Kr=!0),t.firstContext=null)}function kn(t){var e=t._currentValue;if(Mm!==t)if(t={context:t,memoizedValue:e,next:null},ho===null){if(Gf===null)throw Error(ce(308));ho=t,Gf.dependencies={lanes:0,firstContext:t}}else ho=ho.next=t;return e}var sa=null;function Bm(t){sa===null?sa=[t]:sa.push(t)}function Sw(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Bm(e)):(r.next=s.next,s.next=r),e.interleaved=r,bs(t,n)}function bs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ei=!1;function jm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Iw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Rs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function xi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,nt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,bs(t,r)}return s=n.interleaved,s===null?(e.next=e,Bm(n)):(e.next=s.next,s.next=e),n.interleaved=e,bs(t,r)}function mf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Sm(t,r)}}function Gv(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Kf(t,e,r,n){var s=t.updateQueue;ei=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?i=l:a.next=l,a=c;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=l:o.next=l,f.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,f=l=c=null,o=i;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,v=o;switch(d=e,m=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(m,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,d=typeof g=="function"?g.call(m,h,d):g,d==null)break e;h=It({},h,d);break e;case 2:ei=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(l=f=m,c=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(c=h),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);va|=a,t.lanes=a,t.memoizedState=h}}function Kv(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ce(191,s));s.call(n)}}}var Yl={},is=Bi(Yl),wl=Bi(Yl),Tl=Bi(Yl);function ia(t){if(t===Yl)throw Error(ce(174));return t}function zm(t,e){switch(dt(Tl,e),dt(wl,t),dt(is,Yl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gd(e,t)}yt(is),dt(is,e)}function bo(){yt(is),yt(wl),yt(Tl)}function Cw(t){ia(Tl.current);var e=ia(is.current),r=Gd(e,t.type);e!==r&&(dt(wl,t),dt(is,r))}function Hm(t){wl.current===t&&(yt(is),yt(wl))}var At=Bi(0);function qf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var td=[];function $m(){for(var t=0;t<td.length;t++)td[t]._workInProgressVersionPrimary=null;td.length=0}var gf=Hs.ReactCurrentDispatcher,rd=Hs.ReactCurrentBatchConfig,ga=0,St=null,Xt=null,nr=null,Xf=!1,Wc=!1,kl=0,k4=0;function _r(){throw Error(ce(321))}function Wm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!zn(t[r],e[r]))return!1;return!0}function Gm(t,e,r,n,s,i){if(ga=i,St=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gf.current=t===null||t.memoizedState===null?C4:R4,t=r(n,s),Wc){i=0;do{if(Wc=!1,kl=0,25<=i)throw Error(ce(301));i+=1,nr=Xt=null,e.updateQueue=null,gf.current=P4,t=r(n,s)}while(Wc)}if(gf.current=Yf,e=Xt!==null&&Xt.next!==null,ga=0,nr=Xt=St=null,Xf=!1,e)throw Error(ce(300));return t}function Km(){var t=kl!==0;return kl=0,t}function Zn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nr===null?St.memoizedState=nr=t:nr=nr.next=t,nr}function An(){if(Xt===null){var t=St.alternate;t=t!==null?t.memoizedState:null}else t=Xt.next;var e=nr===null?St.memoizedState:nr.next;if(e!==null)nr=e,Xt=t;else{if(t===null)throw Error(ce(310));Xt=t,t={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},nr===null?St.memoizedState=nr=t:nr=nr.next=t}return nr}function Al(t,e){return typeof e=="function"?e(t):e}function nd(t){var e=An(),r=e.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=t;var n=Xt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,c=null,l=i;do{var f=l.lane;if((ga&f)===f)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(o=c=h,a=n):c=c.next=h,St.lanes|=f,va|=f}l=l.next}while(l!==null&&l!==i);c===null?a=n:c.next=o,zn(n,e.memoizedState)||(Kr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,St.lanes|=i,va|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function sd(t){var e=An(),r=e.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);zn(i,e.memoizedState)||(Kr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Rw(){}function Pw(t,e){var r=St,n=An(),s=e(),i=!zn(n.memoizedState,s);if(i&&(n.memoizedState=s,Kr=!0),n=n.queue,qm(Dw.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||nr!==null&&nr.memoizedState.tag&1){if(r.flags|=2048,Sl(9,Fw.bind(null,r,n,s,e),void 0,null),sr===null)throw Error(ce(349));ga&30||Nw(r,e,s)}return s}function Nw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Fw(t,e,r,n){e.value=r,e.getSnapshot=n,Ow(e)&&Lw(t)}function Dw(t,e,r){return r(function(){Ow(e)&&Lw(t)})}function Ow(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!zn(t,r)}catch{return!0}}function Lw(t){var e=bs(t,1);e!==null&&Bn(e,t,1,-1)}function qv(t){var e=Zn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Al,lastRenderedState:t},e.queue=t,t=t.dispatch=I4.bind(null,St,t),[e.memoizedState,t]}function Sl(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function bw(){return An().memoizedState}function vf(t,e,r,n){var s=Zn();St.flags|=t,s.memoizedState=Sl(1|e,r,void 0,n===void 0?null:n)}function zh(t,e,r,n){var s=An();n=n===void 0?null:n;var i=void 0;if(Xt!==null){var a=Xt.memoizedState;if(i=a.destroy,n!==null&&Wm(n,a.deps)){s.memoizedState=Sl(e,r,i,n);return}}St.flags|=t,s.memoizedState=Sl(1|e,r,i,n)}function Xv(t,e){return vf(8390656,8,t,e)}function qm(t,e){return zh(2048,8,t,e)}function Mw(t,e){return zh(4,2,t,e)}function Vw(t,e){return zh(4,4,t,e)}function Uw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Bw(t,e,r){return r=r!=null?r.concat([t]):null,zh(4,4,Uw.bind(null,e,t),r)}function Xm(){}function jw(t,e){var r=An();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Wm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function zw(t,e){var r=An();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Wm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Hw(t,e,r){return ga&21?(zn(r,e)||(r=qE(),St.lanes|=r,va|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Kr=!0),t.memoizedState=r)}function A4(t,e){var r=lt;lt=r!==0&&4>r?r:4,t(!0);var n=rd.transition;rd.transition={};try{t(!1),e()}finally{lt=r,rd.transition=n}}function $w(){return An().memoizedState}function S4(t,e,r){var n=yi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ww(t))Gw(e,r);else if(r=Sw(t,e,r,n),r!==null){var s=Vr();Bn(r,t,n,s),Kw(r,e,n)}}function I4(t,e,r){var n=yi(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ww(t))Gw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,zn(o,a)){var c=e.interleaved;c===null?(s.next=s,Bm(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=Sw(t,e,s,n),r!==null&&(s=Vr(),Bn(r,t,n,s),Kw(r,e,n))}}function Ww(t){var e=t.alternate;return t===St||e!==null&&e===St}function Gw(t,e){Wc=Xf=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Kw(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Sm(t,r)}}var Yf={readContext:kn,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useInsertionEffect:_r,useLayoutEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useMutableSource:_r,useSyncExternalStore:_r,useId:_r,unstable_isNewReconciler:!1},C4={readContext:kn,useCallback:function(t,e){return Zn().memoizedState=[t,e===void 0?null:e],t},useContext:kn,useEffect:Xv,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,vf(4194308,4,Uw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return vf(4194308,4,t,e)},useInsertionEffect:function(t,e){return vf(4,2,t,e)},useMemo:function(t,e){var r=Zn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Zn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=S4.bind(null,St,t),[n.memoizedState,t]},useRef:function(t){var e=Zn();return t={current:t},e.memoizedState=t},useState:qv,useDebugValue:Xm,useDeferredValue:function(t){return Zn().memoizedState=t},useTransition:function(){var t=qv(!1),e=t[0];return t=A4.bind(null,t[1]),Zn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=St,s=Zn();if(Tt){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=e(),sr===null)throw Error(ce(349));ga&30||Nw(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Xv(Dw.bind(null,n,i,t),[t]),n.flags|=2048,Sl(9,Fw.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=Zn(),e=sr.identifierPrefix;if(Tt){var r=As,n=ks;r=(n&~(1<<32-Un(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=kl++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=k4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},R4={readContext:kn,useCallback:jw,useContext:kn,useEffect:qm,useImperativeHandle:Bw,useInsertionEffect:Mw,useLayoutEffect:Vw,useMemo:zw,useReducer:nd,useRef:bw,useState:function(){return nd(Al)},useDebugValue:Xm,useDeferredValue:function(t){var e=An();return Hw(e,Xt.memoizedState,t)},useTransition:function(){var t=nd(Al)[0],e=An().memoizedState;return[t,e]},useMutableSource:Rw,useSyncExternalStore:Pw,useId:$w,unstable_isNewReconciler:!1},P4={readContext:kn,useCallback:jw,useContext:kn,useEffect:qm,useImperativeHandle:Bw,useInsertionEffect:Mw,useLayoutEffect:Vw,useMemo:zw,useReducer:sd,useRef:bw,useState:function(){return sd(Al)},useDebugValue:Xm,useDeferredValue:function(t){var e=An();return Xt===null?e.memoizedState=t:Hw(e,Xt.memoizedState,t)},useTransition:function(){var t=sd(Al)[0],e=An().memoizedState;return[t,e]},useMutableSource:Rw,useSyncExternalStore:Pw,useId:$w,unstable_isNewReconciler:!1};function Fn(t,e){if(t&&t.defaultProps){e=It({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function dp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:It({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Hh={isMounted:function(t){return(t=t._reactInternals)?Ra(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Vr(),s=yi(t),i=Rs(n,s);i.payload=e,r!=null&&(i.callback=r),e=xi(t,i,s),e!==null&&(Bn(e,t,s,n),mf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Vr(),s=yi(t),i=Rs(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=xi(t,i,s),e!==null&&(Bn(e,t,s,n),mf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Vr(),n=yi(t),s=Rs(r,n);s.tag=2,e!=null&&(s.callback=e),e=xi(t,s,n),e!==null&&(Bn(e,t,n,r),mf(e,t,n))}};function Yv(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!xl(r,n)||!xl(s,i):!0}function qw(t,e,r){var n=!1,s=Ri,i=e.contextType;return typeof i=="object"&&i!==null?i=kn(i):(s=Xr(e)?pa:Pr.current,n=e.contextTypes,i=(n=n!=null)?Do(t,s):Ri),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Qv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Hh.enqueueReplaceState(e,e.state,null)}function pp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},jm(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=kn(i):(i=Xr(e)?pa:Pr.current,s.context=Do(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(dp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hh.enqueueReplaceState(s,s.state,null),Kf(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mo(t,e){try{var r="",n=e;do r+=sC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function id(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function mp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var N4=typeof WeakMap=="function"?WeakMap:Map;function Xw(t,e,r){r=Rs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Jf||(Jf=!0,Ap=n),mp(t,e)},r}function Yw(t,e,r){r=Rs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){mp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){mp(t,e),typeof n!="function"&&(_i===null?_i=new Set([this]):_i.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function Jv(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new N4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=W4.bind(null,t,e,r),e.then(t,t))}function Zv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ex(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Rs(-1,1),e.tag=2,xi(r,e,1))),r.lanes|=1),t)}var F4=Hs.ReactCurrentOwner,Kr=!1;function Or(t,e,r,n){e.child=t===null?Aw(e,null,r,n):Lo(e,t.child,r,n)}function tx(t,e,r,n,s){r=r.render;var i=e.ref;return wo(e,s),n=Gm(t,e,r,n,i,s),r=Km(),t!==null&&!Kr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ms(t,e,s)):(Tt&&r&&Om(e),e.flags|=1,Or(t,e,n,s),e.child)}function rx(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!ng(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,Qw(t,e,i,n,s)):(t=Ef(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:xl,r(a,n)&&t.ref===e.ref)return Ms(t,e,s)}return e.flags|=1,t=Ei(i,n),t.ref=e.ref,t.return=e,e.child=t}function Qw(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(xl(i,n)&&t.ref===e.ref)if(Kr=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Kr=!0);else return e.lanes=t.lanes,Ms(t,e,s)}return gp(t,e,r,n,s)}function Jw(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(mo,tn),tn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,dt(mo,tn),tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,dt(mo,tn),tn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,dt(mo,tn),tn|=n;return Or(t,e,s,r),e.child}function Zw(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function gp(t,e,r,n,s){var i=Xr(r)?pa:Pr.current;return i=Do(e,i),wo(e,s),r=Gm(t,e,r,n,i,s),n=Km(),t!==null&&!Kr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ms(t,e,s)):(Tt&&n&&Om(e),e.flags|=1,Or(t,e,r,s),e.child)}function nx(t,e,r,n,s){if(Xr(r)){var i=!0;zf(e)}else i=!1;if(wo(e,s),e.stateNode===null)xf(t,e),qw(e,r,n),pp(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,l=r.contextType;typeof l=="object"&&l!==null?l=kn(l):(l=Xr(r)?pa:Pr.current,l=Do(e,l));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==l)&&Qv(e,a,n,l),ei=!1;var d=e.memoizedState;a.state=d,Kf(e,n,a,s),c=e.memoizedState,o!==n||d!==c||qr.current||ei?(typeof f=="function"&&(dp(e,r,f,n),c=e.memoizedState),(o=ei||Yv(e,r,o,n,d,c,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),a.props=n,a.state=c,a.context=l,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Iw(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:Fn(e.type,o),a.props=l,h=e.pendingProps,d=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=kn(c):(c=Xr(r)?pa:Pr.current,c=Do(e,c));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==c)&&Qv(e,a,n,c),ei=!1,d=e.memoizedState,a.state=d,Kf(e,n,a,s);var g=e.memoizedState;o!==h||d!==g||qr.current||ei?(typeof m=="function"&&(dp(e,r,m,n),g=e.memoizedState),(l=ei||Yv(e,r,l,n,d,g,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=c,n=l):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return vp(t,e,r,n,i,s)}function vp(t,e,r,n,s,i){Zw(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&zv(e,r,!1),Ms(t,e,i);n=e.stateNode,F4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Lo(e,t.child,null,i),e.child=Lo(e,null,o,i)):Or(t,e,o,i),e.memoizedState=n.state,s&&zv(e,r,!0),e.child}function e2(t){var e=t.stateNode;e.pendingContext?jv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&jv(t,e.context,!1),zm(t,e.containerInfo)}function sx(t,e,r,n,s){return Oo(),bm(s),e.flags|=256,Or(t,e,r,n),e.child}var xp={dehydrated:null,treeContext:null,retryLane:0};function _p(t){return{baseLanes:t,cachePool:null,transitions:null}}function t2(t,e,r){var n=e.pendingProps,s=At.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),dt(At,s&1),t===null)return fp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Gh(a,n,0,null),t=ua(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=_p(r),e.memoizedState=xp,t):Ym(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return D4(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ei(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Ei(o,i):(i=ua(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?_p(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=xp,n}return i=t.child,t=i.sibling,n=Ei(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ym(t,e){return e=Gh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zu(t,e,r,n){return n!==null&&bm(n),Lo(e,t.child,null,r),t=Ym(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function D4(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=id(Error(ce(422))),zu(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Gh({mode:"visible",children:n.children},s,0,null),i=ua(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Lo(e,t.child,null,a),e.child.memoizedState=_p(a),e.memoizedState=xp,i);if(!(e.mode&1))return zu(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ce(419)),n=id(i,n,void 0),zu(t,e,a,n)}if(o=(a&t.childLanes)!==0,Kr||o){if(n=sr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,bs(t,s),Bn(n,t,s,-1))}return rg(),n=id(Error(ce(421))),zu(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=G4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,sn=vi(s.nextSibling),on=e,Tt=!0,On=null,t!==null&&(gn[vn++]=ks,gn[vn++]=As,gn[vn++]=ma,ks=t.id,As=t.overflow,ma=e),e=Ym(e,n.children),e.flags|=4096,e)}function ix(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),hp(t.return,e,r)}function ad(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function r2(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Or(t,e,n.children,r),n=At.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ix(t,r,e);else if(t.tag===19)ix(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(dt(At,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&qf(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),ad(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&qf(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}ad(e,!0,r,null,i);break;case"together":ad(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ms(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),va|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ce(153));if(e.child!==null){for(t=e.child,r=Ei(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ei(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function O4(t,e,r){switch(e.tag){case 3:e2(e),Oo();break;case 5:Cw(e);break;case 1:Xr(e.type)&&zf(e);break;case 4:zm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;dt(Wf,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(dt(At,At.current&1),e.flags|=128,null):r&e.child.childLanes?t2(t,e,r):(dt(At,At.current&1),t=Ms(t,e,r),t!==null?t.sibling:null);dt(At,At.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return r2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),dt(At,At.current),n)break;return null;case 22:case 23:return e.lanes=0,Jw(t,e,r)}return Ms(t,e,r)}var n2,yp,s2,i2;n2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yp=function(){};s2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ia(is.current);var i=null;switch(r){case"input":s=zd(t,s),n=zd(t,n),i=[];break;case"select":s=It({},s,{value:void 0}),n=It({},n,{value:void 0}),i=[];break;case"textarea":s=Wd(t,s),n=Wd(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Bf)}Kd(r,n);var a;r=null;for(l in s)if(!n.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var o=s[l];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(fl.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in n){var c=n[l];if(o=s!=null?s[l]:void 0,n.hasOwnProperty(l)&&c!==o&&(c!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(fl.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&xt("scroll",t),i||o===c||(i=[])):(i=i||[]).push(l,c))}r&&(i=i||[]).push("style",r);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};i2=function(t,e,r,n){r!==n&&(e.flags|=4)};function kc(t,e){if(!Tt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function yr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function L4(t,e,r){var n=e.pendingProps;switch(Lm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yr(e),null;case 1:return Xr(e.type)&&jf(),yr(e),null;case 3:return n=e.stateNode,bo(),yt(qr),yt(Pr),$m(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Bu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,On!==null&&(Cp(On),On=null))),yp(t,e),yr(e),null;case 5:Hm(e);var s=ia(Tl.current);if(r=e.type,t!==null&&e.stateNode!=null)s2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ce(166));return yr(e),null}if(t=ia(is.current),Bu(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[ts]=e,n[El]=i,t=(e.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(s=0;s<Rc.length;s++)xt(Rc[s],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":pv(n,i),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},xt("invalid",n);break;case"textarea":gv(n,i),xt("invalid",n)}Kd(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Uu(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Uu(n.textContent,o,t),s=["children",""+o]):fl.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xt("scroll",n)}switch(r){case"input":Nu(n),mv(n,i,!0);break;case"textarea":Nu(n),vv(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Bf)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ts]=e,t[El]=n,n2(t,e,!1,!1),e.stateNode=t;e:{switch(a=qd(r,n),r){case"dialog":xt("cancel",t),xt("close",t),s=n;break;case"iframe":case"object":case"embed":xt("load",t),s=n;break;case"video":case"audio":for(s=0;s<Rc.length;s++)xt(Rc[s],t);s=n;break;case"source":xt("error",t),s=n;break;case"img":case"image":case"link":xt("error",t),xt("load",t),s=n;break;case"details":xt("toggle",t),s=n;break;case"input":pv(t,n),s=zd(t,n),xt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=It({},n,{value:void 0}),xt("invalid",t);break;case"textarea":gv(t,n),s=Wd(t,n),xt("invalid",t);break;default:s=n}Kd(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?bE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&OE(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&hl(t,c):typeof c=="number"&&hl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(fl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&xt("scroll",t):c!=null&&ym(t,i,c,a))}switch(r){case"input":Nu(t),mv(t,n,!1);break;case"textarea":Nu(t),vv(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ci(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?xo(t,!!n.multiple,i,!1):n.defaultValue!=null&&xo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Bf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return yr(e),null;case 6:if(t&&e.stateNode!=null)i2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ce(166));if(r=ia(Tl.current),ia(is.current),Bu(e)){if(n=e.stateNode,r=e.memoizedProps,n[ts]=e,(i=n.nodeValue!==r)&&(t=on,t!==null))switch(t.tag){case 3:Uu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Uu(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ts]=e,e.stateNode=n}return yr(e),null;case 13:if(yt(At),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Tt&&sn!==null&&e.mode&1&&!(e.flags&128))Tw(),Oo(),e.flags|=98560,i=!1;else if(i=Bu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(ce(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[ts]=e}else Oo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;yr(e),i=!1}else On!==null&&(Cp(On),On=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||At.current&1?Yt===0&&(Yt=3):rg())),e.updateQueue!==null&&(e.flags|=4),yr(e),null);case 4:return bo(),yp(t,e),t===null&&_l(e.stateNode.containerInfo),yr(e),null;case 10:return Um(e.type._context),yr(e),null;case 17:return Xr(e.type)&&jf(),yr(e),null;case 19:if(yt(At),i=e.memoizedState,i===null)return yr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)kc(i,!1);else{if(Yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=qf(t),a!==null){for(e.flags|=128,kc(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return dt(At,At.current&1|2),e.child}t=t.sibling}i.tail!==null&&Vt()>Vo&&(e.flags|=128,n=!0,kc(i,!1),e.lanes=4194304)}else{if(!n)if(t=qf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),kc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Tt)return yr(e),null}else 2*Vt()-i.renderingStartTime>Vo&&r!==1073741824&&(e.flags|=128,n=!0,kc(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Vt(),e.sibling=null,r=At.current,dt(At,n?r&1|2:r&1),e):(yr(e),null);case 22:case 23:return tg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?tn&1073741824&&(yr(e),e.subtreeFlags&6&&(e.flags|=8192)):yr(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function b4(t,e){switch(Lm(e),e.tag){case 1:return Xr(e.type)&&jf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return bo(),yt(qr),yt(Pr),$m(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hm(e),null;case 13:if(yt(At),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));Oo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yt(At),null;case 4:return bo(),null;case 10:return Um(e.type._context),null;case 22:case 23:return tg(),null;case 24:return null;default:return null}}var Hu=!1,Ar=!1,M4=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function po(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ft(t,e,n)}else r.current=null}function Ep(t,e,r){try{r()}catch(n){Ft(t,e,n)}}var ax=!1;function V4(t,e){if(sp=Mf,t=uw(),Dm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,l=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++l===s&&(o=a),d===i&&++f===n&&(c=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ip={focusedElem:t,selectionRange:r},Mf=!1,Ie=e;Ie!==null;)if(e=Ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ie=t;else for(;Ie!==null;){e=Ie;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,E=g.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?v:Fn(e.type,v),E);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(O){Ft(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Ie=t;break}Ie=e.return}return g=ax,ax=!1,g}function Gc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ep(e,r,i)}s=s.next}while(s!==n)}}function $h(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function wp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function a2(t){var e=t.alternate;e!==null&&(t.alternate=null,a2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ts],delete e[El],delete e[cp],delete e[y4],delete e[E4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function o2(t){return t.tag===5||t.tag===3||t.tag===4}function ox(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||o2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Tp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Bf));else if(n!==4&&(t=t.child,t!==null))for(Tp(t,e,r),t=t.sibling;t!==null;)Tp(t,e,r),t=t.sibling}function kp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(kp(t,e,r),t=t.sibling;t!==null;)kp(t,e,r),t=t.sibling}var cr=null,Dn=!1;function Ys(t,e,r){for(r=r.child;r!==null;)c2(t,e,r),r=r.sibling}function c2(t,e,r){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount(bh,r)}catch{}switch(r.tag){case 5:Ar||po(r,e);case 6:var n=cr,s=Dn;cr=null,Ys(t,e,r),cr=n,Dn=s,cr!==null&&(Dn?(t=cr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):cr.removeChild(r.stateNode));break;case 18:cr!==null&&(Dn?(t=cr,r=r.stateNode,t.nodeType===8?Z0(t.parentNode,r):t.nodeType===1&&Z0(t,r),gl(t)):Z0(cr,r.stateNode));break;case 4:n=cr,s=Dn,cr=r.stateNode.containerInfo,Dn=!0,Ys(t,e,r),cr=n,Dn=s;break;case 0:case 11:case 14:case 15:if(!Ar&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Ep(r,e,a),s=s.next}while(s!==n)}Ys(t,e,r);break;case 1:if(!Ar&&(po(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ft(r,e,o)}Ys(t,e,r);break;case 21:Ys(t,e,r);break;case 22:r.mode&1?(Ar=(n=Ar)||r.memoizedState!==null,Ys(t,e,r),Ar=n):Ys(t,e,r);break;default:Ys(t,e,r)}}function cx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new M4),e.forEach(function(n){var s=K4.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Rn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:cr=o.stateNode,Dn=!1;break e;case 3:cr=o.stateNode.containerInfo,Dn=!0;break e;case 4:cr=o.stateNode.containerInfo,Dn=!0;break e}o=o.return}if(cr===null)throw Error(ce(160));c2(i,a,s),cr=null,Dn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Ft(s,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)l2(e,t),e=e.sibling}function l2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rn(e,t),Yn(t),n&4){try{Gc(3,t,t.return),$h(3,t)}catch(v){Ft(t,t.return,v)}try{Gc(5,t,t.return)}catch(v){Ft(t,t.return,v)}}break;case 1:Rn(e,t),Yn(t),n&512&&r!==null&&po(r,r.return);break;case 5:if(Rn(e,t),Yn(t),n&512&&r!==null&&po(r,r.return),t.flags&32){var s=t.stateNode;try{hl(s,"")}catch(v){Ft(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&NE(s,i),qd(o,a);var l=qd(o,i);for(a=0;a<c.length;a+=2){var f=c[a],h=c[a+1];f==="style"?bE(s,h):f==="dangerouslySetInnerHTML"?OE(s,h):f==="children"?hl(s,h):ym(s,f,h,l)}switch(o){case"input":Hd(s,i);break;case"textarea":FE(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?xo(s,!!i.multiple,m,!1):d!==!!i.multiple&&(i.defaultValue!=null?xo(s,!!i.multiple,i.defaultValue,!0):xo(s,!!i.multiple,i.multiple?[]:"",!1))}s[El]=i}catch(v){Ft(t,t.return,v)}}break;case 6:if(Rn(e,t),Yn(t),n&4){if(t.stateNode===null)throw Error(ce(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){Ft(t,t.return,v)}}break;case 3:if(Rn(e,t),Yn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{gl(e.containerInfo)}catch(v){Ft(t,t.return,v)}break;case 4:Rn(e,t),Yn(t);break;case 13:Rn(e,t),Yn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zm=Vt())),n&4&&cx(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Ar=(l=Ar)||f,Rn(e,t),Ar=l):Rn(e,t),Yn(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!f&&t.mode&1)for(Ie=t,f=t.child;f!==null;){for(h=Ie=f;Ie!==null;){switch(d=Ie,m=d.child,d.tag){case 0:case 11:case 14:case 15:Gc(4,d,d.return);break;case 1:po(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Ft(n,r,v)}}break;case 5:po(d,d.return);break;case 22:if(d.memoizedState!==null){ux(h);continue}}m!==null?(m.return=d,Ie=m):ux(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=LE("display",a))}catch(v){Ft(t,t.return,v)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(v){Ft(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Rn(e,t),Yn(t),n&4&&cx(t);break;case 21:break;default:Rn(e,t),Yn(t)}}function Yn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(o2(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(hl(s,""),n.flags&=-33);var i=ox(t);kp(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=ox(t);Tp(t,o,a);break;default:throw Error(ce(161))}}catch(c){Ft(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function U4(t,e,r){Ie=t,u2(t)}function u2(t,e,r){for(var n=(t.mode&1)!==0;Ie!==null;){var s=Ie,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Hu;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Ar;o=Hu;var l=Ar;if(Hu=a,(Ar=c)&&!l)for(Ie=s;Ie!==null;)a=Ie,c=a.child,a.tag===22&&a.memoizedState!==null?fx(s):c!==null?(c.return=a,Ie=c):fx(s);for(;i!==null;)Ie=i,u2(i),i=i.sibling;Ie=s,Hu=o,Ar=l}lx(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ie=i):lx(t)}}function lx(t){for(;Ie!==null;){var e=Ie;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ar||$h(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ar)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Fn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Kv(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Kv(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var f=l.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&gl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Ar||e.flags&512&&wp(e)}catch(d){Ft(e,e.return,d)}}if(e===t){Ie=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ie=r;break}Ie=e.return}}function ux(t){for(;Ie!==null;){var e=Ie;if(e===t){Ie=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ie=r;break}Ie=e.return}}function fx(t){for(;Ie!==null;){var e=Ie;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{$h(4,e)}catch(c){Ft(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){Ft(e,s,c)}}var i=e.return;try{wp(e)}catch(c){Ft(e,i,c)}break;case 5:var a=e.return;try{wp(e)}catch(c){Ft(e,a,c)}}}catch(c){Ft(e,e.return,c)}if(e===t){Ie=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ie=o;break}Ie=e.return}}var B4=Math.ceil,Qf=Hs.ReactCurrentDispatcher,Qm=Hs.ReactCurrentOwner,En=Hs.ReactCurrentBatchConfig,nt=0,sr=null,Wt=null,hr=0,tn=0,mo=Bi(0),Yt=0,Il=null,va=0,Wh=0,Jm=0,Kc=null,Wr=null,Zm=0,Vo=1/0,ws=null,Jf=!1,Ap=null,_i=null,$u=!1,ui=null,Zf=0,qc=0,Sp=null,_f=-1,yf=0;function Vr(){return nt&6?Vt():_f!==-1?_f:_f=Vt()}function yi(t){return t.mode&1?nt&2&&hr!==0?hr&-hr:T4.transition!==null?(yf===0&&(yf=qE()),yf):(t=lt,t!==0||(t=window.event,t=t===void 0?16:tw(t.type)),t):1}function Bn(t,e,r,n){if(50<qc)throw qc=0,Sp=null,Error(ce(185));Kl(t,r,n),(!(nt&2)||t!==sr)&&(t===sr&&(!(nt&2)&&(Wh|=r),Yt===4&&ni(t,hr)),Yr(t,n),r===1&&nt===0&&!(e.mode&1)&&(Vo=Vt()+500,jh&&ji()))}function Yr(t,e){var r=t.callbackNode;TC(t,e);var n=bf(t,t===sr?hr:0);if(n===0)r!==null&&yv(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&yv(r),e===1)t.tag===0?w4(hx.bind(null,t)):yw(hx.bind(null,t)),x4(function(){!(nt&6)&&ji()}),r=null;else{switch(XE(n)){case 1:r=Am;break;case 4:r=GE;break;case 16:r=Lf;break;case 536870912:r=KE;break;default:r=Lf}r=x2(r,f2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function f2(t,e){if(_f=-1,yf=0,nt&6)throw Error(ce(327));var r=t.callbackNode;if(To()&&t.callbackNode!==r)return null;var n=bf(t,t===sr?hr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=eh(t,n);else{e=n;var s=nt;nt|=2;var i=d2();(sr!==t||hr!==e)&&(ws=null,Vo=Vt()+500,la(t,e));do try{H4();break}catch(o){h2(t,o)}while(!0);Vm(),Qf.current=i,nt=s,Wt!==null?e=0:(sr=null,hr=0,e=Yt)}if(e!==0){if(e===2&&(s=Zd(t),s!==0&&(n=s,e=Ip(t,s))),e===1)throw r=Il,la(t,0),ni(t,n),Yr(t,Vt()),r;if(e===6)ni(t,n);else{if(s=t.current.alternate,!(n&30)&&!j4(s)&&(e=eh(t,n),e===2&&(i=Zd(t),i!==0&&(n=i,e=Ip(t,i))),e===1))throw r=Il,la(t,0),ni(t,n),Yr(t,Vt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(ce(345));case 2:ea(t,Wr,ws);break;case 3:if(ni(t,n),(n&130023424)===n&&(e=Zm+500-Vt(),10<e)){if(bf(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Vr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=op(ea.bind(null,t,Wr,ws),e);break}ea(t,Wr,ws);break;case 4:if(ni(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-Un(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Vt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*B4(n/1960))-n,10<n){t.timeoutHandle=op(ea.bind(null,t,Wr,ws),n);break}ea(t,Wr,ws);break;case 5:ea(t,Wr,ws);break;default:throw Error(ce(329))}}}return Yr(t,Vt()),t.callbackNode===r?f2.bind(null,t):null}function Ip(t,e){var r=Kc;return t.current.memoizedState.isDehydrated&&(la(t,e).flags|=256),t=eh(t,e),t!==2&&(e=Wr,Wr=r,e!==null&&Cp(e)),t}function Cp(t){Wr===null?Wr=t:Wr.push.apply(Wr,t)}function j4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!zn(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ni(t,e){for(e&=~Jm,e&=~Wh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Un(e),n=1<<r;t[r]=-1,e&=~n}}function hx(t){if(nt&6)throw Error(ce(327));To();var e=bf(t,0);if(!(e&1))return Yr(t,Vt()),null;var r=eh(t,e);if(t.tag!==0&&r===2){var n=Zd(t);n!==0&&(e=n,r=Ip(t,n))}if(r===1)throw r=Il,la(t,0),ni(t,e),Yr(t,Vt()),r;if(r===6)throw Error(ce(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ea(t,Wr,ws),Yr(t,Vt()),null}function eg(t,e){var r=nt;nt|=1;try{return t(e)}finally{nt=r,nt===0&&(Vo=Vt()+500,jh&&ji())}}function xa(t){ui!==null&&ui.tag===0&&!(nt&6)&&To();var e=nt;nt|=1;var r=En.transition,n=lt;try{if(En.transition=null,lt=1,t)return t()}finally{lt=n,En.transition=r,nt=e,!(nt&6)&&ji()}}function tg(){tn=mo.current,yt(mo)}function la(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,v4(r)),Wt!==null)for(r=Wt.return;r!==null;){var n=r;switch(Lm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&jf();break;case 3:bo(),yt(qr),yt(Pr),$m();break;case 5:Hm(n);break;case 4:bo();break;case 13:yt(At);break;case 19:yt(At);break;case 10:Um(n.type._context);break;case 22:case 23:tg()}r=r.return}if(sr=t,Wt=t=Ei(t.current,null),hr=tn=e,Yt=0,Il=null,Jm=Wh=va=0,Wr=Kc=null,sa!==null){for(e=0;e<sa.length;e++)if(r=sa[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}sa=null}return t}function h2(t,e){do{var r=Wt;try{if(Vm(),gf.current=Yf,Xf){for(var n=St.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Xf=!1}if(ga=0,nr=Xt=St=null,Wc=!1,kl=0,Qm.current=null,r===null||r.return===null){Yt=1,Il=e,Wt=null;break}e:{var i=t,a=r.return,o=r,c=e;if(e=hr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Zv(a);if(m!==null){m.flags&=-257,ex(m,a,o,i,e),m.mode&1&&Jv(i,l,e),e=m,c=l;var g=e.updateQueue;if(g===null){var v=new Set;v.add(c),e.updateQueue=v}else g.add(c);break e}else{if(!(e&1)){Jv(i,l,e),rg();break e}c=Error(ce(426))}}else if(Tt&&o.mode&1){var E=Zv(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),ex(E,a,o,i,e),bm(Mo(c,o));break e}}i=c=Mo(c,o),Yt!==4&&(Yt=2),Kc===null?Kc=[i]:Kc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Xw(i,c,e);Gv(i,T);break e;case 1:o=c;var w=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(_i===null||!_i.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var O=Yw(i,o,e);Gv(i,O);break e}}i=i.return}while(i!==null)}m2(r)}catch(z){e=z,Wt===r&&r!==null&&(Wt=r=r.return);continue}break}while(!0)}function d2(){var t=Qf.current;return Qf.current=Yf,t===null?Yf:t}function rg(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sr===null||!(va&268435455)&&!(Wh&268435455)||ni(sr,hr)}function eh(t,e){var r=nt;nt|=2;var n=d2();(sr!==t||hr!==e)&&(ws=null,la(t,e));do try{z4();break}catch(s){h2(t,s)}while(!0);if(Vm(),nt=r,Qf.current=n,Wt!==null)throw Error(ce(261));return sr=null,hr=0,Yt}function z4(){for(;Wt!==null;)p2(Wt)}function H4(){for(;Wt!==null&&!pC();)p2(Wt)}function p2(t){var e=v2(t.alternate,t,tn);t.memoizedProps=t.pendingProps,e===null?m2(t):Wt=e,Qm.current=null}function m2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=b4(r,e),r!==null){r.flags&=32767,Wt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yt=6,Wt=null;return}}else if(r=L4(r,e,tn),r!==null){Wt=r;return}if(e=e.sibling,e!==null){Wt=e;return}Wt=e=t}while(e!==null);Yt===0&&(Yt=5)}function ea(t,e,r){var n=lt,s=En.transition;try{En.transition=null,lt=1,$4(t,e,r,n)}finally{En.transition=s,lt=n}return null}function $4(t,e,r,n){do To();while(ui!==null);if(nt&6)throw Error(ce(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ce(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(kC(t,i),t===sr&&(Wt=sr=null,hr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$u||($u=!0,x2(Lf,function(){return To(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=En.transition,En.transition=null;var a=lt;lt=1;var o=nt;nt|=4,Qm.current=null,V4(t,r),l2(r,t),u4(ip),Mf=!!sp,ip=sp=null,t.current=r,U4(r),mC(),nt=o,lt=a,En.transition=i}else t.current=r;if($u&&($u=!1,ui=t,Zf=s),i=t.pendingLanes,i===0&&(_i=null),xC(r.stateNode),Yr(t,Vt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Jf)throw Jf=!1,t=Ap,Ap=null,t;return Zf&1&&t.tag!==0&&To(),i=t.pendingLanes,i&1?t===Sp?qc++:(qc=0,Sp=t):qc=0,ji(),null}function To(){if(ui!==null){var t=XE(Zf),e=En.transition,r=lt;try{if(En.transition=null,lt=16>t?16:t,ui===null)var n=!1;else{if(t=ui,ui=null,Zf=0,nt&6)throw Error(ce(331));var s=nt;for(nt|=4,Ie=t.current;Ie!==null;){var i=Ie,a=i.child;if(Ie.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var l=o[c];for(Ie=l;Ie!==null;){var f=Ie;switch(f.tag){case 0:case 11:case 15:Gc(8,f,i)}var h=f.child;if(h!==null)h.return=f,Ie=h;else for(;Ie!==null;){f=Ie;var d=f.sibling,m=f.return;if(a2(f),f===l){Ie=null;break}if(d!==null){d.return=m,Ie=d;break}Ie=m}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}Ie=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ie=a;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Gc(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Ie=T;break e}Ie=i.return}}var w=t.current;for(Ie=w;Ie!==null;){a=Ie;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,Ie=x;else e:for(a=w;Ie!==null;){if(o=Ie,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:$h(9,o)}}catch(z){Ft(o,o.return,z)}if(o===a){Ie=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,Ie=O;break e}Ie=o.return}}if(nt=s,ji(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot(bh,t)}catch{}n=!0}return n}finally{lt=r,En.transition=e}}return!1}function dx(t,e,r){e=Mo(r,e),e=Xw(t,e,1),t=xi(t,e,1),e=Vr(),t!==null&&(Kl(t,1,e),Yr(t,e))}function Ft(t,e,r){if(t.tag===3)dx(t,t,r);else for(;e!==null;){if(e.tag===3){dx(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(_i===null||!_i.has(n))){t=Mo(r,t),t=Yw(e,t,1),e=xi(e,t,1),t=Vr(),e!==null&&(Kl(e,1,t),Yr(e,t));break}}e=e.return}}function W4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Vr(),t.pingedLanes|=t.suspendedLanes&r,sr===t&&(hr&r)===r&&(Yt===4||Yt===3&&(hr&130023424)===hr&&500>Vt()-Zm?la(t,0):Jm|=r),Yr(t,e)}function g2(t,e){e===0&&(t.mode&1?(e=Ou,Ou<<=1,!(Ou&130023424)&&(Ou=4194304)):e=1);var r=Vr();t=bs(t,e),t!==null&&(Kl(t,e,r),Yr(t,r))}function G4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),g2(t,r)}function K4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(e),g2(t,r)}var v2;v2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||qr.current)Kr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Kr=!1,O4(t,e,r);Kr=!!(t.flags&131072)}else Kr=!1,Tt&&e.flags&1048576&&Ew(e,$f,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;xf(t,e),t=e.pendingProps;var s=Do(e,Pr.current);wo(e,r),s=Gm(null,e,n,t,s,r);var i=Km();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xr(n)?(i=!0,zf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jm(e),s.updater=Hh,e.stateNode=s,s._reactInternals=e,pp(e,n,t,r),e=vp(null,e,n,!0,i,r)):(e.tag=0,Tt&&i&&Om(e),Or(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(xf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=X4(n),t=Fn(n,t),s){case 0:e=gp(null,e,n,t,r);break e;case 1:e=nx(null,e,n,t,r);break e;case 11:e=tx(null,e,n,t,r);break e;case 14:e=rx(null,e,n,Fn(n.type,t),r);break e}throw Error(ce(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fn(n,s),gp(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fn(n,s),nx(t,e,n,s,r);case 3:e:{if(e2(e),t===null)throw Error(ce(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Iw(t,e),Kf(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mo(Error(ce(423)),e),e=sx(t,e,n,r,s);break e}else if(n!==s){s=Mo(Error(ce(424)),e),e=sx(t,e,n,r,s);break e}else for(sn=vi(e.stateNode.containerInfo.firstChild),on=e,Tt=!0,On=null,r=Aw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Oo(),n===s){e=Ms(t,e,r);break e}Or(t,e,n,r)}e=e.child}return e;case 5:return Cw(e),t===null&&fp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,ap(n,s)?a=null:i!==null&&ap(n,i)&&(e.flags|=32),Zw(t,e),Or(t,e,a,r),e.child;case 6:return t===null&&fp(e),null;case 13:return t2(t,e,r);case 4:return zm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Lo(e,null,n,r):Or(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fn(n,s),tx(t,e,n,s,r);case 7:return Or(t,e,e.pendingProps,r),e.child;case 8:return Or(t,e,e.pendingProps.children,r),e.child;case 12:return Or(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,dt(Wf,n._currentValue),n._currentValue=a,i!==null)if(zn(i.value,a)){if(i.children===s.children&&!qr.current){e=Ms(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Rs(-1,r&-r),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),hp(i.return,r,e),o.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ce(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),hp(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Or(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,wo(e,r),s=kn(s),n=n(s),e.flags|=1,Or(t,e,n,r),e.child;case 14:return n=e.type,s=Fn(n,e.pendingProps),s=Fn(n.type,s),rx(t,e,n,s,r);case 15:return Qw(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Fn(n,s),xf(t,e),e.tag=1,Xr(n)?(t=!0,zf(e)):t=!1,wo(e,r),qw(e,n,s),pp(e,n,s,r),vp(null,e,n,!0,t,r);case 19:return r2(t,e,r);case 22:return Jw(t,e,r)}throw Error(ce(156,e.tag))};function x2(t,e){return WE(t,e)}function q4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yn(t,e,r,n){return new q4(t,e,r,n)}function ng(t){return t=t.prototype,!(!t||!t.isReactComponent)}function X4(t){if(typeof t=="function")return ng(t)?1:0;if(t!=null){if(t=t.$$typeof,t===wm)return 11;if(t===Tm)return 14}return 2}function Ei(t,e){var r=t.alternate;return r===null?(r=yn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ef(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")ng(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case so:return ua(r.children,s,i,e);case Em:a=8,s|=8;break;case Vd:return t=yn(12,r,e,s|2),t.elementType=Vd,t.lanes=i,t;case Ud:return t=yn(13,r,e,s),t.elementType=Ud,t.lanes=i,t;case Bd:return t=yn(19,r,e,s),t.elementType=Bd,t.lanes=i,t;case CE:return Gh(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SE:a=10;break e;case IE:a=9;break e;case wm:a=11;break e;case Tm:a=14;break e;case Zs:a=16,n=null;break e}throw Error(ce(130,t==null?t:typeof t,""))}return e=yn(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function ua(t,e,r,n){return t=yn(7,t,n,e),t.lanes=r,t}function Gh(t,e,r,n){return t=yn(22,t,n,e),t.elementType=CE,t.lanes=r,t.stateNode={isHidden:!1},t}function od(t,e,r){return t=yn(6,t,null,e),t.lanes=r,t}function cd(t,e,r){return e=yn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Y4(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z0(0),this.expirationTimes=z0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sg(t,e,r,n,s,i,a,o,c){return t=new Y4(t,e,r,o,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=yn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},jm(i),t}function Q4(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function _2(t){if(!t)return Ri;t=t._reactInternals;e:{if(Ra(t)!==t||t.tag!==1)throw Error(ce(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(t.tag===1){var r=t.type;if(Xr(r))return _w(t,r,e)}return e}function y2(t,e,r,n,s,i,a,o,c){return t=sg(r,n,!0,t,s,i,a,o,c),t.context=_2(null),r=t.current,n=Vr(),s=yi(r),i=Rs(n,s),i.callback=e??null,xi(r,i,s),t.current.lanes=s,Kl(t,s,n),Yr(t,n),t}function Kh(t,e,r,n){var s=e.current,i=Vr(),a=yi(s);return r=_2(r),e.context===null?e.context=r:e.pendingContext=r,e=Rs(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=xi(s,e,a),t!==null&&(Bn(t,s,a,i),mf(t,s,a)),a}function th(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function px(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function ig(t,e){px(t,e),(t=t.alternate)&&px(t,e)}function J4(){return null}var E2=typeof reportError=="function"?reportError:function(t){console.error(t)};function ag(t){this._internalRoot=t}qh.prototype.render=ag.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ce(409));Kh(t,e,null,null)};qh.prototype.unmount=ag.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xa(function(){Kh(null,t,null,null)}),e[Ls]=null}};function qh(t){this._internalRoot=t}qh.prototype.unstable_scheduleHydration=function(t){if(t){var e=JE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ri.length&&e!==0&&e<ri[r].priority;r++);ri.splice(r,0,t),r===0&&ew(t)}};function og(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Xh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mx(){}function Z4(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var l=th(a);i.call(l)}}var a=y2(e,n,t,0,null,!1,!1,"",mx);return t._reactRootContainer=a,t[Ls]=a.current,_l(t.nodeType===8?t.parentNode:t),xa(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var l=th(c);o.call(l)}}var c=sg(t,0,!1,null,null,!1,!1,"",mx);return t._reactRootContainer=c,t[Ls]=c.current,_l(t.nodeType===8?t.parentNode:t),xa(function(){Kh(e,c,r,n)}),c}function Yh(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var c=th(a);o.call(c)}}Kh(e,a,t,s)}else a=Z4(r,e,t,s,n);return th(a)}YE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Cc(e.pendingLanes);r!==0&&(Sm(e,r|1),Yr(e,Vt()),!(nt&6)&&(Vo=Vt()+500,ji()))}break;case 13:xa(function(){var n=bs(t,1);if(n!==null){var s=Vr();Bn(n,t,1,s)}}),ig(t,1)}};Im=function(t){if(t.tag===13){var e=bs(t,134217728);if(e!==null){var r=Vr();Bn(e,t,134217728,r)}ig(t,134217728)}};QE=function(t){if(t.tag===13){var e=yi(t),r=bs(t,e);if(r!==null){var n=Vr();Bn(r,t,e,n)}ig(t,e)}};JE=function(){return lt};ZE=function(t,e){var r=lt;try{return lt=t,e()}finally{lt=r}};Yd=function(t,e,r){switch(e){case"input":if(Hd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Bh(n);if(!s)throw Error(ce(90));PE(n),Hd(n,s)}}}break;case"textarea":FE(t,r);break;case"select":e=r.value,e!=null&&xo(t,!!r.multiple,e,!1)}};UE=eg;BE=xa;var eR={usingClientEntryPoint:!1,Events:[Xl,co,Bh,ME,VE,eg]},Ac={findFiberByHostInstance:na,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tR={bundleType:Ac.bundleType,version:Ac.version,rendererPackageName:Ac.rendererPackageName,rendererConfig:Ac.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=HE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ac.findFiberByHostInstance||J4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wu.isDisabled&&Wu.supportsFiber)try{bh=Wu.inject(tR),ss=Wu}catch{}}fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eR;fn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!og(e))throw Error(ce(200));return Q4(t,e,null,r)};fn.createRoot=function(t,e){if(!og(t))throw Error(ce(299));var r=!1,n="",s=E2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=sg(t,1,!1,null,null,r,!1,n,s),t[Ls]=e.current,_l(t.nodeType===8?t.parentNode:t),new ag(e)};fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ce(188)):(t=Object.keys(t).join(","),Error(ce(268,t)));return t=HE(e),t=t===null?null:t.stateNode,t};fn.flushSync=function(t){return xa(t)};fn.hydrate=function(t,e,r){if(!Xh(e))throw Error(ce(200));return Yh(null,t,e,!0,r)};fn.hydrateRoot=function(t,e,r){if(!og(t))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=E2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=y2(e,null,t,1,r??null,s,!1,i,a),t[Ls]=e.current,_l(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new qh(e)};fn.render=function(t,e,r){if(!Xh(e))throw Error(ce(200));return Yh(null,t,e,!1,r)};fn.unmountComponentAtNode=function(t){if(!Xh(t))throw Error(ce(40));return t._reactRootContainer?(xa(function(){Yh(null,null,t,!1,function(){t._reactRootContainer=null,t[Ls]=null})}),!0):!1};fn.unstable_batchedUpdates=eg;fn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Xh(r))throw Error(ce(200));if(t==null||t._reactInternals===void 0)throw Error(ce(38));return Yh(t,e,r,!1,n)};fn.version="18.3.1-next-f1338f8080-20240426";function w2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(w2)}catch(t){console.error(t)}}w2(),wE.exports=fn;var rR=wE.exports,gx=rR;bd.createRoot=gx.createRoot,bd.hydrateRoot=gx.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sR=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),vx=t=>{const e=sR(t);return e.charAt(0).toUpperCase()+e.slice(1)},T2=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),iR=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=Ze.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...o},c)=>Ze.createElement("svg",{ref:c,...aR,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:T2("lucide",s),...!i&&!iR(o)&&{"aria-hidden":"true"},...o},[...a.map(([l,f])=>Ze.createElement(l,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=(t,e)=>{const r=Ze.forwardRef(({className:n,...s},i)=>Ze.createElement(oR,{ref:i,iconNode:e,className:T2(`lucide-${nR(vx(t))}`,`lucide-${t}`,n),...s}));return r.displayName=vx(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],xx=Lt("chart-column",cR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],k2=Lt("circle-alert",lR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fR=Lt("circle-check-big",uR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ld=Lt("clock",hR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pR=Lt("eye-off",dR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gR=Lt("eye",mR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],xR=Lt("file-spreadsheet",vR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],yR=Lt("funnel",_R);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],_x=Lt("lock",ER);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],TR=Lt("log-out",wR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],AR=Lt("mail",kR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ti=Lt("phone",SR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],CR=Lt("save",IR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],PR=Lt("search",RR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],yx=Lt("trash-2",NR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],DR=Lt("trending-down",FR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],LR=Lt("trending-up",OR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ex=Lt("upload",bR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],wx=Lt("user-plus",MR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],A2=Lt("user",VR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ji=Lt("users",UR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],jR=Lt("x",BR);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var S2=1252,zR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],cg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},lg=function(t){zR.indexOf(t)!=-1&&(S2=cg[0]=t)};function HR(){lg(1252)}var bn=function(t){lg(t)};function I2(){bn(1200),HR()}function Tx(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function $R(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function C2(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Pc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?$R(t.slice(2)):e==254&&r==255?C2(t.slice(2)):e==65279?t.slice(1):t},Gu=function(e){return String.fromCharCode(e)},kx=function(e){return String.fromCharCode(e)},Cl,fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ax(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),i=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,s=t.charCodeAt(l++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),e+=fi.charAt(i)+fi.charAt(a)+fi.charAt(o)+fi.charAt(c);return e}function un(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)i=fi.indexOf(t.charAt(l++)),a=fi.indexOf(t.charAt(l++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=fi.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=fi.indexOf(t.charAt(l++)),s=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Pi(t){return Qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Sx(t){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ln=function(e){return Qe?Pa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Na(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ug(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return ug(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var si=Qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Pa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function WR(t){for(var e=[],r=0,n=t.length+250,s=Pi(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Pi(65535),n=65530)}return e.push(s.slice(0,r)),si(e)}var Ur=/\u0000/g,Nc=/[\u0001-\u0006]/g;function ko(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Mn(t,e){var r=""+t;return r.length>=e?r:Dt("0",e-r.length)+r}function fg(t,e){var r=""+t;return r.length>=e?r:Dt(" ",e-r.length)+r}function rh(t,e){var r=""+t;return r.length>=e?r:r+Dt(" ",e-r.length)}function GR(t,e){var r=""+Math.round(t);return r.length>=e?r:Dt("0",e-r.length)+r}function KR(t,e){var r=""+t;return r.length>=e?r:Dt("0",e-r.length)+r}var Ix=Math.pow(2,32);function Qa(t,e){if(t>Ix||t<-Ix)return GR(t,e);var r=Math.round(t);return KR(r,e)}function nh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Cx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ud=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function qR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Rx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},XR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,c=1,l=0,f=0,h=Math.floor(s);l<e&&(h=Math.floor(s),o=h*a+i,f=h*l+c,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,c=l,l=f;if(f>e&&(l>e?(f=c,o=i):(f=l,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function aa(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=t3(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var R2=new Date(1899,11,31,0,0,0),YR=R2.getTime(),QR=new Date(1900,2,1,0,0,0);function P2(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=QR&&(r+=24*60*60*1e3),(r-(YR+(t.getTimezoneOffset()-R2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function hg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZR(t){var e=t<0?12:11,r=hg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function e3(t){var e=hg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Rl(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ZR(t):e===10?r=t.toFixed(10).substr(0,12):r=e3(t),hg(JR(r.toUpperCase()))}function _a(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Rl(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Sn(14,P2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function t3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function r3(t,e,r,n){var s="",i=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return ud[r.m-1][1];case 5:return ud[r.m-1][0];default:return ud[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return Cx[r.q][0];default:return Cx[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Mn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Mn(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?Mn(c,l):"";return f}function hi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var N2=/%/g;function n3(t,e,r){var n=e.replace(N2,""),s=e.length-n.length;return Ps(t,n,r*Math.pow(10,2*s))+Dt("%",s)}function s3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ps(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function F2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+F2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var D2=/# (\?+)( ?)\/( ?)(\d+)/;function i3(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Dt(" ",t[1].length+1+t[4].length):fg(a,t[1].length)+t[2]+"/"+t[3]+Mn(o,t[4].length))}function a3(t,e,r){return r+(e===0?"":""+e)+Dt(" ",t[1].length+2+t[4].length)}var O2=/^#*0*\.([0#]+)/,L2=/\).*[0#]/,b2=/\(###\) ###\\?-####/;function Lr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Px(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Nx(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function o3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function c3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function pn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(L2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pn("n",n,r):"("+pn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return s3(t,e,r);if(e.indexOf("%")!==-1)return n3(t,e,r);if(e.indexOf("E")!==-1)return F2(e,r);if(e.charCodeAt(0)===36)return"$"+pn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Qa(c,e.length);if(e.match(/^[#?]+$/))return s=Qa(r,0),s==="0"&&(s=""),s.length>e.length?s:Lr(e.substr(0,e.length-s.length))+s;if(i=e.match(D2))return i3(i,c,l);if(e.match(/^#+0+$/))return l+Qa(c,e.length-e.indexOf("0"));if(i=e.match(O2))return s=Px(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Lr(i[1])).replace(/\.$/,"."+Lr(i[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+Dt("0",Lr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+Px(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+hi(Qa(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pn(t,e,-r):hi(""+(Math.floor(r)+o3(r,i[1].length)))+"."+Mn(Nx(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return pn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ko(pn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(b2))return s=pn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=sh(c,Math.pow(10,a)-1,!1),s=""+l,f=Ps("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=rh(o[2],a),f.length<i[4].length&&(f=Lr(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=sh(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?fg(o[1],a)+i[2]+"/"+i[3]+rh(o[2],a):Dt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Qa(r,0),e.length<=s.length?s:Lr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Lr(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Nx(r,i[1].length),r<0?"-"+pn(t,e,-r):hi(c3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Mn(0,3-g.length):"")+g})+"."+Mn(a,i[1].length);switch(e){case"###,##0.00":return pn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=hi(Qa(c,0));return m!=="0"?l+m:"";case"###,###.00":return pn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return pn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function l3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ps(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function u3(t,e,r){var n=e.replace(N2,""),s=e.length-n.length;return Ps(t,n,r*Math.pow(10,2*s))+Dt("%",s)}function M2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+M2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(L2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jn("n",n,r):"("+Jn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return l3(t,e,r);if(e.indexOf("%")!==-1)return u3(t,e,r);if(e.indexOf("E")!==-1)return M2(e,r);if(e.charCodeAt(0)===36)return"$"+Jn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Mn(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Lr(e.substr(0,e.length-s.length))+s;if(i=e.match(D2))return a3(i,c,l);if(e.match(/^#+0+$/))return l+Mn(c,e.length-e.indexOf("0"));if(i=e.match(O2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Lr(i[1])).replace(/\.$/,"."+Lr(i[1])),s=s.replace(/\.(\d*)$/,function(g,v){return"."+v+Dt("0",Lr(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return l+hi(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jn(t,e,-r):hi(""+r)+"."+Dt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Jn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ko(Jn(t,e.replace(/[\\-]/g,""),r)),a=0,ko(ko(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(b2))return s=Jn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=sh(c,Math.pow(10,a)-1,!1),s=""+l,f=Ps("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=rh(o[2],a),f.length<i[4].length&&(f=Lr(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=sh(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?fg(o[1],a)+i[2]+"/"+i[3]+rh(o[2],a):Dt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Lr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Lr(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jn(t,e,-r):hi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Mn(0,3-g.length):"")+g})+"."+Mn(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=hi(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return Jn(t,e.slice(0,e.lastIndexOf(".")),r)+Lr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ps(t,e,r){return(r|0)===r?Jn(t,e,r):pn(t,e,r)}function f3(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var V2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qo(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":nh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(V2))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function h3(t,e,r,n){for(var s=[],i="",a=0,o="",c="t",l,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!nh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=t.charAt(++a),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=aa(e,r,t.charAt(a+1)==="2"),l==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=aa(e,r),l==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(l==null&&(l=aa(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(v.v=l.H>=12?"P":"A"),v.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(v.v=l.H>=12?"PM":"AM"),v.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(l!=null&&(v.v=l.H>=12?"":""),v.t="T",a+=5,d="h"):(v.t="t",++a),l==null&&v.t==="T")return"";s[s.length]=v,c=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(V2)){if(l==null&&(l=aa(e,r),l==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qo(t)||(s[s.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var E=0,T=0,w;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=d,c="h",E<1&&(E=1);break;case"s":(w=s[a].v.match(/\.0+$/))&&(T=Math.max(T,w[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[a].v.match(/[Hh]/)&&(E=1),E<2&&s[a].v.match(/[Mm]/)&&(E=2),E<3&&s[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var x="",O;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=r3(s[a].t.charCodeAt(0),s[a].v,l,T),s[a].t="t";break;case"n":case"?":for(O=a+1;s[O]!=null&&((o=s[O].t)==="?"||o==="D"||(o===" "||o==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[a].v+=s[O].v,s[O]={v:"",t:";"},++O;x+=s[a].v,a=O-1;break;case"G":s[a].t="t",s[a].v=_a(e,r);break}var z="",B,_;if(x.length>0){x.charCodeAt(0)==40?(B=e<0&&x.charCodeAt(0)===45?-e:e,_=Ps("n",x,B)):(B=e<0&&n>1?-e:e,_=Ps("n",x,B),B<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),O=_.length-1;var k=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){k=a;break}var A=s.length;if(k===s.length&&_.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(O>=s[a].v.length-1?(O-=s[a].v.length,s[a].v=_.substr(O+1,s[a].v.length)):O<0?s[a].v="":(s[a].v=_.substr(0,O+1),O=-1),s[a].t="t",A=a);O>=0&&A<s.length&&(s[A].v=_.substr(0,O+1)+s[A].v)}else if(k!==s.length&&_.indexOf("E")===-1){for(O=_.indexOf(".")-1,a=k;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")-1:s[a].v.length-1,z=s[a].v.substr(f+1);f>=0;--f)O>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(z=_.charAt(O--)+z);s[a].v=z,s[a].t="t",A=a}for(O>=0&&A<s.length&&(s[A].v=_.substr(0,O+1)+s[A].v),O=_.indexOf(".")+1,a=k;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==k)){for(f=s[a].v.indexOf(".")>-1&&a===k?s[a].v.indexOf(".")+1:0,z=s[a].v.substr(0,f);f<s[a].v.length;++f)O<_.length&&(z+=_.charAt(O++));s[a].v=z,s[a].t="t",A=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(B=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Ps(s[a].t,s[a].v,B),s[a].t="t");var I="";for(a=0;a!==s.length;++a)s[a]!=null&&(I+=s[a].v);return I}var Fx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dx(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function d3(t,e){var r=f3(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Fx),o=r[1].match(Fx);return Dx(e,a)?[n,r[0]]:Dx(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Sn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Rx[t]]||ze[Rx[t]]),n==null&&(n=XR[t]||"General");break}if(nh(n,0))return _a(e,r);e instanceof Date&&(e=P2(e,r.date1904));var s=d3(n,e);if(nh(s[1]))return _a(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return h3(s[1],e,r,s[0])}function fa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function U2(){ze=qR()}var p3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},B2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function m3(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(B2,"(\\d+)"),new RegExp("^"+e+"$")}function g3(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(e.match(B2)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&s==-1&&i==-1?f:l+"T"+f}var v3=function(){var t={};t.version="1.2.0";function e(){for(var _=0,k=new Array(256),A=0;A!=256;++A)_=A,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,k[A]=_;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(_){var k=0,A=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=_[I];for(I=0;I!=256;++I)for(A=_[I],k=256+I;k<4096;k+=256)A=R[k]=A>>>8^_[A&255];var C=[];for(I=1;I!=16;++I)C[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return C}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],l=s[4],f=s[5],h=s[6],d=s[7],m=s[8],g=s[9],v=s[10],E=s[11],T=s[12],w=s[13],x=s[14];function O(_,k){for(var A=k^-1,I=0,R=_.length;I<R;)A=A>>>8^r[(A^_.charCodeAt(I++))&255];return~A}function z(_,k){for(var A=k^-1,I=_.length-15,R=0;R<I;)A=x[_[R++]^A&255]^w[_[R++]^A>>8&255]^T[_[R++]^A>>16&255]^E[_[R++]^A>>>24]^v[_[R++]]^g[_[R++]]^m[_[R++]]^d[_[R++]]^h[_[R++]]^f[_[R++]]^l[_[R++]]^c[_[R++]]^o[_[R++]]^a[_[R++]]^i[_[R++]]^r[_[R++]];for(I+=15;R<I;)A=A>>>8^r[(A^_[R++])&255];return~A}function B(_,k){for(var A=k^-1,I=0,R=_.length,C=0,N=0;I<R;)C=_.charCodeAt(I++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,N=_.charCodeAt(I++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|N>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|N&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return t.table=r,t.bstr=O,t.buf=z,t.str=B,t}(),et=function(){var e={};e.version="1.2.1";function r(S,b){for(var D=S.split("/"),L=b.split("/"),V=0,U=0,X=Math.min(D.length,L.length);V<X;++V){if(U=D[V].length-L[V].length)return U;if(D[V]!=L[V])return D[V]<L[V]?-1:1}return D.length-L.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var b=S.lastIndexOf("/");return b===-1?S:S.slice(0,b+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var b=S.lastIndexOf("/");return b===-1?S:S.slice(b+1)}function i(S,b){typeof b=="string"&&(b=new Date(b));var D=b.getHours();D=D<<6|b.getMinutes(),D=D<<5|b.getSeconds()>>>1,S.write_shift(2,D);var L=b.getFullYear()-1980;L=L<<4|b.getMonth()+1,L=L<<5|b.getDate(),S.write_shift(2,L)}function a(S){var b=S.read_shift(2)&65535,D=S.read_shift(2)&65535,L=new Date,V=D&31;D>>>=5;var U=D&15;D>>>=4,L.setMilliseconds(0),L.setFullYear(D+1980),L.setMonth(U-1),L.setDate(V);var X=b&31;b>>>=5;var ee=b&63;return b>>>=6,L.setHours(b),L.setMinutes(ee),L.setSeconds(X<<1),L}function o(S){ur(S,0);for(var b={},D=0;S.l<=S.length-4;){var L=S.read_shift(2),V=S.read_shift(2),U=S.l+V,X={};switch(L){case 21589:D=S.read_shift(1),D&1&&(X.mtime=S.read_shift(4)),V>5&&(D&2&&(X.atime=S.read_shift(4)),D&4&&(X.ctime=S.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}S.l=U,b[L]=X}return b}var c;function l(){return c||(c={})}function f(S,b){if(S[0]==80&&S[1]==75)return lc(S,b);if((S[0]|32)==109&&(S[1]|32)==105)return gu(S,b);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var D=3,L=512,V=0,U=0,X=0,ee=0,Y=0,Q=[],J=S.slice(0,512);ur(J,0);var oe=h(J);switch(D=oe[0],D){case 3:L=512;break;case 4:L=4096;break;case 0:if(oe[1]==0)return lc(S,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}L!==512&&(J=S.slice(0,L),ur(J,28));var pe=S.slice(0,L);d(J,D);var Ae=J.read_shift(4,"i");if(D===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);J.l+=4,X=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ee=J.read_shift(4,"i"),V=J.read_shift(4,"i"),Y=J.read_shift(4,"i"),U=J.read_shift(4,"i");for(var fe=-1,xe=0;xe<109&&(fe=J.read_shift(4,"i"),!(fe<0));++xe)Q[xe]=fe;var be=m(S,L);E(Y,U,be,L,Q);var ut=w(be,X,Q,L);ut[X].name="!Directory",V>0&&ee!==N&&(ut[ee].name="!MiniFAT"),ut[Q[0]].name="!FAT",ut.fat_addrs=Q,ut.ssz=L;var ct={},Et=[],_s=[],Xi=[];x(X,ut,be,Et,V,ct,_s,ee),g(_s,Xi,Et),Et.shift();var Ks={FileIndex:_s,FullPaths:Xi};return b&&b.raw&&(Ks.raw={header:pe,sectors:be}),Ks}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(ye,"Header Signature: "),S.l+=16;var b=S.read_shift(2,"u");return[S.read_shift(2,"u"),b]}function d(S,b){var D=9;switch(S.l+=2,D=S.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,b){for(var D=Math.ceil(S.length/b)-1,L=[],V=1;V<D;++V)L[V-1]=S.slice(V*b,(V+1)*b);return L[D-1]=S.slice(D*b),L}function g(S,b,D){for(var L=0,V=0,U=0,X=0,ee=0,Y=D.length,Q=[],J=[];L<Y;++L)Q[L]=J[L]=L,b[L]=D[L];for(;ee<J.length;++ee)L=J[ee],V=S[L].L,U=S[L].R,X=S[L].C,Q[L]===L&&(V!==-1&&Q[V]!==V&&(Q[L]=Q[V]),U!==-1&&Q[U]!==U&&(Q[L]=Q[U])),X!==-1&&(Q[X]=L),V!==-1&&L!=Q[L]&&(Q[V]=Q[L],J.lastIndexOf(V)<ee&&J.push(V)),U!==-1&&L!=Q[L]&&(Q[U]=Q[L],J.lastIndexOf(U)<ee&&J.push(U));for(L=1;L<Y;++L)Q[L]===L&&(U!==-1&&Q[U]!==U?Q[L]=Q[U]:V!==-1&&Q[V]!==V&&(Q[L]=Q[V]));for(L=1;L<Y;++L)if(S[L].type!==0){if(ee=L,ee!=Q[ee])do ee=Q[ee],b[L]=b[ee]+"/"+b[L];while(ee!==0&&Q[ee]!==-1&&ee!=Q[ee]);Q[L]=-1}for(b[0]+="/",L=1;L<Y;++L)S[L].type!==2&&(b[L]+="/")}function v(S,b,D){for(var L=S.start,V=S.size,U=[],X=L;D&&V>0&&X>=0;)U.push(b.slice(X*C,X*C+C)),V-=C,X=ra(D,X*4);return U.length===0?qt(0):si(U).slice(0,S.size)}function E(S,b,D,L,V){var U=N;if(S===N){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var X=D[S],ee=(L>>>2)-1;if(!X)return;for(var Y=0;Y<ee&&(U=ra(X,Y*4))!==N;++Y)V.push(U);E(ra(X,L-4),b-1,D,L,V)}}function T(S,b,D,L,V){var U=[],X=[];V||(V=[]);var ee=L-1,Y=0,Q=0;for(Y=b;Y>=0;){V[Y]=!0,U[U.length]=Y,X.push(S[Y]);var J=D[Math.floor(Y*4/L)];if(Q=Y*4&ee,L<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+L);if(!S[J])break;Y=ra(S[J],Q)}return{nodes:U,data:Hx([X])}}function w(S,b,D,L){var V=S.length,U=[],X=[],ee=[],Y=[],Q=L-1,J=0,oe=0,pe=0,Ae=0;for(J=0;J<V;++J)if(ee=[],pe=J+b,pe>=V&&(pe-=V),!X[pe]){Y=[];var fe=[];for(oe=pe;oe>=0;){fe[oe]=!0,X[oe]=!0,ee[ee.length]=oe,Y.push(S[oe]);var xe=D[Math.floor(oe*4/L)];if(Ae=oe*4&Q,L<4+Ae)throw new Error("FAT boundary crossed: "+oe+" 4 "+L);if(!S[xe]||(oe=ra(S[xe],Ae),fe[oe]))break}U[pe]={nodes:ee,data:Hx([Y])}}return U}function x(S,b,D,L,V,U,X,ee){for(var Y=0,Q=L.length?2:0,J=b[S].data,oe=0,pe=0,Ae;oe<J.length;oe+=128){var fe=J.slice(oe,oe+128);ur(fe,64),pe=fe.read_shift(2),Ae=vg(fe,0,pe-Q),L.push(Ae);var xe={name:Ae,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},be=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);be!==0&&(xe.ct=O(fe,fe.l-8));var ut=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);ut!==0&&(xe.mt=O(fe,fe.l-8)),xe.start=fe.read_shift(4,"i"),xe.size=fe.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=N,xe.name=""),xe.type===5?(Y=xe.start,V>0&&Y!==N&&(b[Y].name="!StreamData")):xe.size>=4096?(xe.storage="fat",b[xe.start]===void 0&&(b[xe.start]=T(D,xe.start,b.fat_addrs,b.ssz)),b[xe.start].name=xe.name,xe.content=b[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:Y!==N&&xe.start!==N&&b[Y]&&(xe.content=v(xe,b[Y].data,(b[ee]||{}).data))),xe.content&&ur(xe.content,0),U[Ae]=xe,X.push(xe)}}function O(S,b){return new Date((rn(S,b+4)/1e7*Math.pow(2,32)+rn(S,b)/1e7-11644473600)*1e3)}function z(S,b){return l(),f(c.readFileSync(S),b)}function B(S,b){var D=b&&b.type;switch(D||Qe&&Buffer.isBuffer(S)&&(D="buffer"),D||"base64"){case"file":return z(S,b);case"base64":return f(Ln(un(S)),b);case"binary":return f(Ln(S),b)}return f(S,b)}function _(S,b){var D=b||{},L=D.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=L+"/",S.FileIndex[0]={name:L,type:5}),D.CLSID&&(S.FileIndex[0].clsid=D.CLSID),k(S)}function k(S){var b="Sh33tJ5";if(!et.find(S,"/"+b)){var D=qt(4);D[0]=55,D[1]=D[3]=50,D[2]=54,S.FileIndex.push({name:b,type:2,content:D,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+b),A(S)}}function A(S,b){_(S);for(var D=!1,L=!1,V=S.FullPaths.length-1;V>=0;--V){var U=S.FileIndex[V];switch(U.type){case 0:L?D=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(U.R*U.L*U.C)&&(D=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!b)){var X=new Date(1987,1,19),ee=0,Y=Object.create?Object.create(null):{},Q=[];for(V=0;V<S.FullPaths.length;++V)Y[S.FullPaths[V]]=!0,S.FileIndex[V].type!==0&&Q.push([S.FullPaths[V],S.FileIndex[V]]);for(V=0;V<Q.length;++V){var J=n(Q[V][0]);L=Y[J],L||(Q.push([J,{name:s(J).replace("/",""),type:1,clsid:we,ct:X,mt:X,content:null}]),Y[J]=!0)}for(Q.sort(function(Ae,fe){return r(Ae[0],fe[0])}),S.FullPaths=[],S.FileIndex=[],V=0;V<Q.length;++V)S.FullPaths[V]=Q[V][0],S.FileIndex[V]=Q[V][1];for(V=0;V<Q.length;++V){var oe=S.FileIndex[V],pe=S.FullPaths[V];if(oe.name=s(pe).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||we,V===0)oe.C=Q.length>1?1:-1,oe.size=0,oe.type=5;else if(pe.slice(-1)=="/"){for(ee=V+1;ee<Q.length&&n(S.FullPaths[ee])!=pe;++ee);for(oe.C=ee>=Q.length?-1:ee,ee=V+1;ee<Q.length&&n(S.FullPaths[ee])!=n(pe);++ee);oe.R=ee>=Q.length?-1:ee,oe.type=1}else n(S.FullPaths[V+1]||"")==n(pe)&&(oe.R=V+1),oe.type=2}}}function I(S,b){var D=b||{};if(D.fileType=="mad")return ar(S,D);switch(A(S),D.fileType){case"zip":return uc(S,D)}var L=function(Ae){for(var fe=0,xe=0,be=0;be<Ae.FileIndex.length;++be){var ut=Ae.FileIndex[be];if(ut.content){var ct=ut.content.length;ct>0&&(ct<4096?fe+=ct+63>>6:xe+=ct+511>>9)}}for(var Et=Ae.FullPaths.length+3>>2,_s=fe+7>>3,Xi=fe+127>>7,Ks=_s+xe+Et+Xi,Xn=Ks+127>>7,Ga=Xn<=109?0:Math.ceil((Xn-109)/127);Ks+Xn+Ga+127>>7>Xn;)Ga=++Xn<=109?0:Math.ceil((Xn-109)/127);var Zr=[1,Ga,Xn,Xi,Et,xe,fe,0];return Ae.FileIndex[0].size=fe<<6,Zr[7]=(Ae.FileIndex[0].start=Zr[0]+Zr[1]+Zr[2]+Zr[3]+Zr[4]+Zr[5])+(Zr[6]+7>>3),Zr}(S),V=qt(L[7]<<9),U=0,X=0;{for(U=0;U<8;++U)V.write_shift(1,he[U]);for(U=0;U<8;++U)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),U=0;U<3;++U)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,L[2]),V.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:N),V.write_shift(4,L[3]),V.write_shift(-4,L[1]?L[0]-1:N),V.write_shift(4,L[1]),U=0;U<109;++U)V.write_shift(-4,U<L[2]?L[1]+U:-1)}if(L[1])for(X=0;X<L[1];++X){for(;U<236+X*127;++U)V.write_shift(-4,U<L[2]?L[1]+U:-1);V.write_shift(-4,X===L[1]-1?N:X+1)}var ee=function(Ae){for(X+=Ae;U<X-1;++U)V.write_shift(-4,U+1);Ae&&(++U,V.write_shift(-4,N))};for(X=U=0,X+=L[1];U<X;++U)V.write_shift(-4,ge.DIFSECT);for(X+=L[2];U<X;++U)V.write_shift(-4,ge.FATSECT);ee(L[3]),ee(L[4]);for(var Y=0,Q=0,J=S.FileIndex[0];Y<S.FileIndex.length;++Y)J=S.FileIndex[Y],J.content&&(Q=J.content.length,!(Q<4096)&&(J.start=X,ee(Q+511>>9)));for(ee(L[6]+7>>3);V.l&511;)V.write_shift(-4,ge.ENDOFCHAIN);for(X=U=0,Y=0;Y<S.FileIndex.length;++Y)J=S.FileIndex[Y],J.content&&(Q=J.content.length,!(!Q||Q>=4096)&&(J.start=X,ee(Q+63>>6)));for(;V.l&511;)V.write_shift(-4,ge.ENDOFCHAIN);for(U=0;U<L[4]<<2;++U){var oe=S.FullPaths[U];if(!oe||oe.length===0){for(Y=0;Y<17;++Y)V.write_shift(4,0);for(Y=0;Y<3;++Y)V.write_shift(4,-1);for(Y=0;Y<12;++Y)V.write_shift(4,0);continue}J=S.FileIndex[U],U===0&&(J.start=J.size?J.start-1:N);var pe=U===0&&D.root||J.name;if(Q=2*(pe.length+1),V.write_shift(64,pe,"utf16le"),V.write_shift(2,Q),V.write_shift(1,J.type),V.write_shift(1,J.color),V.write_shift(-4,J.L),V.write_shift(-4,J.R),V.write_shift(-4,J.C),J.clsid)V.write_shift(16,J.clsid,"hex");else for(Y=0;Y<4;++Y)V.write_shift(4,0);V.write_shift(4,J.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,J.start),V.write_shift(4,J.size),V.write_shift(4,0)}for(U=1;U<S.FileIndex.length;++U)if(J=S.FileIndex[U],J.size>=4096)if(V.l=J.start+1<<9,Qe&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+511&-512;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&511;++Y)V.write_shift(1,0)}for(U=1;U<S.FileIndex.length;++U)if(J=S.FileIndex[U],J.size>0&&J.size<4096)if(Qe&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+63&-64;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&63;++Y)V.write_shift(1,0)}if(Qe)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function R(S,b){var D=S.FullPaths.map(function(Y){return Y.toUpperCase()}),L=D.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),V=!1;b.charCodeAt(0)===47?(V=!0,b=D[0].slice(0,-1)+b):V=b.indexOf("/")!==-1;var U=b.toUpperCase(),X=V===!0?D.indexOf(U):L.indexOf(U);if(X!==-1)return S.FileIndex[X];var ee=!U.match(Nc);for(U=U.replace(Ur,""),ee&&(U=U.replace(Nc,"!")),X=0;X<D.length;++X)if((ee?D[X].replace(Nc,"!"):D[X]).replace(Ur,"")==U||(ee?L[X].replace(Nc,"!"):L[X]).replace(Ur,"")==U)return S.FileIndex[X];return null}var C=64,N=-2,ye="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(S,b,D){l();var L=I(S,D);c.writeFileSync(b,L)}function W(S){for(var b=new Array(S.length),D=0;D<S.length;++D)b[D]=String.fromCharCode(S[D]);return b.join("")}function le(S,b){var D=I(S,b);switch(b&&b.type||"buffer"){case"file":return l(),c.writeFileSync(b.filename,D),D;case"binary":return typeof D=="string"?D:W(D);case"base64":return Ax(typeof D=="string"?D:W(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:Pa(D);case"array":return typeof D=="string"?Ln(D):D}return D}var Te;function M(S){try{var b=S.InflateRaw,D=new b;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)Te=S;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function K(S,b){if(!Te)return $a(S,b);var D=Te.InflateRaw,L=new D,V=L._processChunk(S.slice(S.l),L._finishFlushFlag);return S.l+=L.bytesRead,V}function G(S){return Te?Te.deflateRawSync(S):He(S)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(S){var b=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(b>>16|b>>8|b)&255}for(var de=typeof Uint8Array<"u",ae=de?new Uint8Array(256):[],Le=0;Le<256;++Le)ae[Le]=ke(Le);function j(S,b){var D=ae[S&255];return b<=8?D>>>8-b:(D=D<<8|ae[S>>8&255],b<=16?D>>>16-b:(D=D<<8|ae[S>>16&255],D>>>24-b))}function at(S,b){var D=b&7,L=b>>>3;return(S[L]|(D<=6?0:S[L+1]<<8))>>>D&3}function $e(S,b){var D=b&7,L=b>>>3;return(S[L]|(D<=5?0:S[L+1]<<8))>>>D&7}function Xe(S,b){var D=b&7,L=b>>>3;return(S[L]|(D<=4?0:S[L+1]<<8))>>>D&15}function je(S,b){var D=b&7,L=b>>>3;return(S[L]|(D<=3?0:S[L+1]<<8))>>>D&31}function ve(S,b){var D=b&7,L=b>>>3;return(S[L]|(D<=1?0:S[L+1]<<8))>>>D&127}function mt(S,b,D){var L=b&7,V=b>>>3,U=(1<<D)-1,X=S[V]>>>L;return D<8-L||(X|=S[V+1]<<8-L,D<16-L)||(X|=S[V+2]<<16-L,D<24-L)||(X|=S[V+3]<<24-L),X&U}function re(S,b,D){var L=b&7,V=b>>>3;return L<=5?S[V]|=(D&7)<<L:(S[V]|=D<<L&255,S[V+1]=(D&7)>>8-L),b+3}function _e(S,b,D){var L=b&7,V=b>>>3;return D=(D&1)<<L,S[V]|=D,b+1}function Ce(S,b,D){var L=b&7,V=b>>>3;return D<<=L,S[V]|=D&255,D>>>=8,S[V+1]=D,b+8}function Re(S,b,D){var L=b&7,V=b>>>3;return D<<=L,S[V]|=D&255,D>>>=8,S[V+1]=D&255,S[V+2]=D>>>8,b+16}function De(S,b){var D=S.length,L=2*D>b?2*D:b+5,V=0;if(D>=b)return S;if(Qe){var U=Sx(L);if(S.copy)S.copy(U);else for(;V<S.length;++V)U[V]=S[V];return U}else if(de){var X=new Uint8Array(L);if(X.set)X.set(S);else for(;V<D;++V)X[V]=S[V];return X}return S.length=L,S}function Ve(S){for(var b=new Array(S),D=0;D<S;++D)b[D]=0;return b}function rt(S,b,D){var L=1,V=0,U=0,X=0,ee=0,Y=S.length,Q=de?new Uint16Array(32):Ve(32);for(U=0;U<32;++U)Q[U]=0;for(U=Y;U<D;++U)S[U]=0;Y=S.length;var J=de?new Uint16Array(Y):Ve(Y);for(U=0;U<Y;++U)Q[V=S[U]]++,L<V&&(L=V),J[U]=0;for(Q[0]=0,U=1;U<=L;++U)Q[U+16]=ee=ee+Q[U-1]<<1;for(U=0;U<Y;++U)ee=S[U],ee!=0&&(J[U]=Q[ee+16]++);var oe=0;for(U=0;U<Y;++U)if(oe=S[U],oe!=0)for(ee=j(J[U],L)>>L-oe,X=(1<<L+4-oe)-1;X>=0;--X)b[ee|X<<oe]=oe&15|U<<4;return L}var Ye=de?new Uint16Array(512):Ve(512),gt=de?new Uint16Array(32):Ve(32);if(!de){for(var Rt=0;Rt<512;++Rt)Ye[Rt]=0;for(Rt=0;Rt<32;++Rt)gt[Rt]=0}(function(){for(var S=[],b=0;b<32;b++)S.push(5);rt(S,gt,32);var D=[];for(b=0;b<=143;b++)D.push(8);for(;b<=255;b++)D.push(9);for(;b<=279;b++)D.push(7);for(;b<=287;b++)D.push(8);rt(D,Ye,288)})();var Jr=function(){for(var b=de?new Uint8Array(32768):[],D=0,L=0;D<ue.length-1;++D)for(;L<ue[D+1];++L)b[L]=D;for(;L<32768;++L)b[L]=29;var V=de?new Uint8Array(259):[];for(D=0,L=0;D<te.length-1;++D)for(;L<te[D+1];++L)V[L]=D;function U(ee,Y){for(var Q=0;Q<ee.length;){var J=Math.min(65535,ee.length-Q),oe=Q+J==ee.length;for(Y.write_shift(1,+oe),Y.write_shift(2,J),Y.write_shift(2,~J&65535);J-- >0;)Y[Y.l++]=ee[Q++]}return Y.l}function X(ee,Y){for(var Q=0,J=0,oe=de?new Uint16Array(32768):[];J<ee.length;){var pe=Math.min(65535,ee.length-J);if(pe<10){for(Q=re(Y,Q,+(J+pe==ee.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,pe),Y.write_shift(2,~pe&65535);pe-- >0;)Y[Y.l++]=ee[J++];Q=Y.l*8;continue}Q=re(Y,Q,+(J+pe==ee.length)+2);for(var Ae=0;pe-- >0;){var fe=ee[J];Ae=(Ae<<5^fe)&32767;var xe=-1,be=0;if((xe=oe[Ae])&&(xe|=J&-32768,xe>J&&(xe-=32768),xe<J))for(;ee[xe+be]==ee[J+be]&&be<250;)++be;if(be>2){fe=V[be],fe<=22?Q=Ce(Y,Q,ae[fe+1]>>1)-1:(Ce(Y,Q,3),Q+=5,Ce(Y,Q,ae[fe-23]>>5),Q+=3);var ut=fe<8?0:fe-4>>2;ut>0&&(Re(Y,Q,be-te[fe]),Q+=ut),fe=b[J-xe],Q=Ce(Y,Q,ae[fe]>>3),Q-=3;var ct=fe<4?0:fe-2>>1;ct>0&&(Re(Y,Q,J-xe-ue[fe]),Q+=ct);for(var Et=0;Et<be;++Et)oe[Ae]=J&32767,Ae=(Ae<<5^ee[J])&32767,++J;pe-=be-1}else fe<=143?fe=fe+48:Q=_e(Y,Q,1),Q=Ce(Y,Q,ae[fe]),oe[Ae]=J&32767,++J}Q=Ce(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?U(Y,Q):X(Y,Q)}}();function He(S){var b=qt(50+Math.floor(S.length*1.1)),D=Jr(S,b);return b.slice(0,D)}var kt=de?new Uint16Array(32768):Ve(32768),er=de?new Uint16Array(32768):Ve(32768),Pt=de?new Uint16Array(128):Ve(128),qn=1,Ha=1;function I0(S,b){var D=je(S,b)+257;b+=5;var L=je(S,b)+1;b+=5;var V=Xe(S,b)+4;b+=4;for(var U=0,X=de?new Uint8Array(19):Ve(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=de?new Uint8Array(8):Ve(8),J=de?new Uint8Array(8):Ve(8),oe=X.length,pe=0;pe<V;++pe)X[H[pe]]=U=$e(S,b),Y<U&&(Y=U),Q[U]++,b+=3;var Ae=0;for(Q[0]=0,pe=1;pe<=Y;++pe)J[pe]=Ae=Ae+Q[pe-1]<<1;for(pe=0;pe<oe;++pe)(Ae=X[pe])!=0&&(ee[pe]=J[Ae]++);var fe=0;for(pe=0;pe<oe;++pe)if(fe=X[pe],fe!=0){Ae=ae[ee[pe]]>>8-fe;for(var xe=(1<<7-fe)-1;xe>=0;--xe)Pt[Ae|xe<<fe]=fe&7|pe<<3}var be=[];for(Y=1;be.length<D+L;)switch(Ae=Pt[ve(S,b)],b+=Ae&7,Ae>>>=3){case 16:for(U=3+at(S,b),b+=2,Ae=be[be.length-1];U-- >0;)be.push(Ae);break;case 17:for(U=3+$e(S,b),b+=3;U-- >0;)be.push(0);break;case 18:for(U=11+ve(S,b),b+=7;U-- >0;)be.push(0);break;default:be.push(Ae),Y<Ae&&(Y=Ae);break}var ut=be.slice(0,D),ct=be.slice(D);for(pe=D;pe<286;++pe)ut[pe]=0;for(pe=L;pe<30;++pe)ct[pe]=0;return qn=rt(ut,kt,286),Ha=rt(ct,er,30),b}function C0(S,b){if(S[0]==3&&!(S[1]&3))return[Pi(b),2];for(var D=0,L=0,V=Sx(b||1<<18),U=0,X=V.length>>>0,ee=0,Y=0;!(L&1);){if(L=$e(S,D),D+=3,L>>>1)L>>1==1?(ee=9,Y=5):(D=I0(S,D),ee=qn,Y=Ha);else{D&7&&(D+=8-(D&7));var Q=S[D>>>3]|S[(D>>>3)+1]<<8;if(D+=32,Q>0)for(!b&&X<U+Q&&(V=De(V,U+Q),X=V.length);Q-- >0;)V[U++]=S[D>>>3],D+=8;continue}for(;;){!b&&X<U+32767&&(V=De(V,U+32767),X=V.length);var J=mt(S,D,ee),oe=L>>>1==1?Ye[J]:kt[J];if(D+=oe&15,oe>>>=4,!(oe>>>8&255))V[U++]=oe;else{if(oe==256)break;oe-=257;var pe=oe<8?0:oe-4>>2;pe>5&&(pe=0);var Ae=U+te[oe];pe>0&&(Ae+=mt(S,D,pe),D+=pe),J=mt(S,D,Y),oe=L>>>1==1?gt[J]:er[J],D+=oe&15,oe>>>=4;var fe=oe<4?0:oe-2>>1,xe=ue[oe];for(fe>0&&(xe+=mt(S,D,fe),D+=fe),!b&&X<Ae&&(V=De(V,Ae+100),X=V.length);U<Ae;)V[U]=V[U-xe],++U}}}return b?[V,D+7>>>3]:[V.slice(0,U),D+7>>>3]}function $a(S,b){var D=S.slice(S.l||0),L=C0(D,b);return S.l+=L[1],L[0]}function cc(S,b){if(S)typeof console<"u"&&console.error(b);else throw new Error(b)}function lc(S,b){var D=S;ur(D,0);var L=[],V=[],U={FileIndex:L,FullPaths:V};_(U,{root:b.root});for(var X=D.length-4;(D[X]!=80||D[X+1]!=75||D[X+2]!=5||D[X+3]!=6)&&X>=0;)--X;D.l=X+4,D.l+=4;var ee=D.read_shift(2);D.l+=6;var Y=D.read_shift(4);for(D.l=Y,X=0;X<ee;++X){D.l+=20;var Q=D.read_shift(4),J=D.read_shift(4),oe=D.read_shift(2),pe=D.read_shift(2),Ae=D.read_shift(2);D.l+=8;var fe=D.read_shift(4),xe=o(D.slice(D.l+oe,D.l+oe+pe));D.l+=oe+pe+Ae;var be=D.l;D.l=fe+4,Gi(D,Q,J,U,xe),D.l=be}return U}function Gi(S,b,D,L,V){S.l+=2;var U=S.read_shift(2),X=S.read_shift(2),ee=a(S);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Y=S.read_shift(4),Q=S.read_shift(4),J=S.read_shift(4),oe=S.read_shift(2),pe=S.read_shift(2),Ae="",fe=0;fe<oe;++fe)Ae+=String.fromCharCode(S[S.l++]);if(pe){var xe=o(S.slice(S.l,S.l+pe));(xe[21589]||{}).mt&&(ee=xe[21589].mt),((V||{})[21589]||{}).mt&&(ee=V[21589].mt)}S.l+=pe;var be=S.slice(S.l,S.l+Q);switch(X){case 8:be=K(S,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var ut=!1;U&8&&(Y=S.read_shift(4),Y==134695760&&(Y=S.read_shift(4),ut=!0),Q=S.read_shift(4),J=S.read_shift(4)),Q!=b&&cc(ut,"Bad compressed size: "+b+" != "+Q),J!=D&&cc(ut,"Bad uncompressed size: "+D+" != "+J),xs(L,Ae,be,{unsafe:!0,mt:ee})}function uc(S,b){var D=b||{},L=[],V=[],U=qt(1),X=D.compression?8:0,ee=0,Y=0,Q=0,J=0,oe=0,pe=S.FullPaths[0],Ae=pe,fe=S.FileIndex[0],xe=[],be=0;for(Y=1;Y<S.FullPaths.length;++Y)if(Ae=S.FullPaths[Y].slice(pe.length),fe=S.FileIndex[Y],!(!fe.size||!fe.content||Ae=="Sh33tJ5")){var ut=J,ct=qt(Ae.length);for(Q=0;Q<Ae.length;++Q)ct.write_shift(1,Ae.charCodeAt(Q)&127);ct=ct.slice(0,ct.l),xe[oe]=v3.buf(fe.content,0);var Et=fe.content;X==8&&(Et=G(Et)),U=qt(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,X),fe.mt?i(U,fe.mt):U.write_shift(4,0),U.write_shift(-4,xe[oe]),U.write_shift(4,Et.length),U.write_shift(4,fe.content.length),U.write_shift(2,ct.length),U.write_shift(2,0),J+=U.length,L.push(U),J+=ct.length,L.push(ct),J+=Et.length,L.push(Et),U=qt(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,X),U.write_shift(4,0),U.write_shift(-4,xe[oe]),U.write_shift(4,Et.length),U.write_shift(4,fe.content.length),U.write_shift(2,ct.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,ut),be+=U.l,V.push(U),be+=ct.length,V.push(ct),++oe}return U=qt(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,oe),U.write_shift(2,oe),U.write_shift(4,be),U.write_shift(4,J),U.write_shift(2,0),si([si(L),si(V),U])}var Gs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vs(S,b){if(S.ctype)return S.ctype;var D=S.name||"",L=D.match(/\.([^\.]+)$/);return L&&Gs[L[1]]||b&&(L=(D=b).match(/[\.\\]([^\.\\])+$/),L&&Gs[L[1]])?Gs[L[1]]:"application/octet-stream"}function pu(S){for(var b=Ax(S),D=[],L=0;L<b.length;L+=76)D.push(b.slice(L,L+76));return D.join(`\r
`)+`\r
`}function Wa(S){var b=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var J=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],L=b.split(`\r
`),V=0;V<L.length;++V){var U=L[V];if(U.length==0){D.push("");continue}for(var X=0;X<U.length;){var ee=76,Y=U.slice(X,X+ee);Y.charAt(ee-1)=="="?ee--:Y.charAt(ee-2)=="="?ee-=2:Y.charAt(ee-3)=="="&&(ee-=3),Y=U.slice(X,X+ee),X+=ee,X<U.length&&(Y+="="),D.push(Y)}}return D.join(`\r
`)}function mu(S){for(var b=[],D=0;D<S.length;++D){for(var L=S[D];D<=S.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+S[++D];b.push(L)}for(var V=0;V<b.length;++V)b[V]=b[V].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Ln(b.join(`\r
`))}function Ki(S,b,D){for(var L="",V="",U="",X,ee=0;ee<10;++ee){var Y=b[ee];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":L=Q[2].trim();break;case"content-type":U=Q[2].trim();break;case"content-transfer-encoding":V=Q[2].trim();break}}switch(++ee,V.toLowerCase()){case"base64":X=Ln(un(b.slice(ee).join("")));break;case"quoted-printable":X=mu(b.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var J=xs(S,L.slice(D.length),X,{unsafe:!0});U&&(J.ctype=U)}function gu(S,b){if(W(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=b&&b.root||"",L=(Qe&&Buffer.isBuffer(S)?S.toString("binary"):W(S)).split(`\r
`),V=0,U="";for(V=0;V<L.length;++V)if(U=L[V],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),D||(D=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),U.slice(0,D.length)!=D););var X=(L[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var ee="--"+(X[1]||""),Y=[],Q=[],J={FileIndex:Y,FullPaths:Q};_(J);var oe,pe=0;for(V=0;V<L.length;++V){var Ae=L[V];Ae!==ee&&Ae!==ee+"--"||(pe++&&Ki(J,L.slice(oe,V),D),oe=V)}return J}function ar(S,b){var D=b||{},L=D.boundary||"SheetJS";L="------="+L;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],U=S.FullPaths[0],X=U,ee=S.FileIndex[0],Y=1;Y<S.FullPaths.length;++Y)if(X=S.FullPaths[Y].slice(U.length),ee=S.FileIndex[Y],!(!ee.size||!ee.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(be){return"_x"+be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(be){return"_u"+be.charCodeAt(0).toString(16)+"_"});for(var Q=ee.content,J=Qe&&Buffer.isBuffer(Q)?Q.toString("binary"):W(Q),oe=0,pe=Math.min(1024,J.length),Ae=0,fe=0;fe<=pe;++fe)(Ae=J.charCodeAt(fe))>=32&&Ae<128&&++oe;var xe=oe>=pe*4/5;V.push(L),V.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+X),V.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),V.push("Content-Type: "+vs(ee,X)),V.push(""),V.push(xe?Wa(J):pu(J))}return V.push(L+`--\r
`),V.join(`\r
`)}function vu(S){var b={};return _(b,S),b}function xs(S,b,D,L){var V=L&&L.unsafe;V||_(S);var U=!V&&et.find(S,b);if(!U){var X=S.FullPaths[0];b.slice(0,X.length)==X?X=b:(X.slice(-1)!="/"&&(X+="/"),X=(X+b).replace("//","/")),U={name:s(b),type:2},S.FileIndex.push(U),S.FullPaths.push(X),V||et.utils.cfb_gc(S)}return U.content=D,U.size=D?D.length:0,L&&(L.CLSID&&(U.clsid=L.CLSID),L.mt&&(U.mt=L.mt),L.ct&&(U.ct=L.ct)),U}function qi(S,b){_(S);var D=et.find(S,b);if(D){for(var L=0;L<S.FileIndex.length;++L)if(S.FileIndex[L]==D)return S.FileIndex.splice(L,1),S.FullPaths.splice(L,1),!0}return!1}function R0(S,b,D){_(S);var L=et.find(S,b);if(L){for(var V=0;V<S.FileIndex.length;++V)if(S.FileIndex[V]==L)return S.FileIndex[V].name=s(D),S.FullPaths[V]=D,!0}return!1}function P0(S){A(S,!0)}return e.find=R,e.read=B,e.parse=f,e.write=le,e.writeFile=ie,e.utils={cfb_new:vu,cfb_add:xs,cfb_del:qi,cfb_mov:R0,cfb_gc:P0,ReadShift:Xc,CheckField:cT,prep_blob:ur,bconcat:si,use_zlib:M,_deflateRaw:He,_inflateRaw:$a,consts:ge},e}();function x3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function hs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function dg(t){for(var e=[],r=hs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var ih=new Date(1899,11,30,0,0,0);function Br(t,e){var r=t.getTime(),n=ih.getTime()+(t.getTimezoneOffset()-ih.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var j2=new Date,_3=ih.getTime()+(j2.getTimezoneOffset()-ih.getTimezoneOffset())*6e4,Ox=j2.getTimezoneOffset();function Qh(t){var e=new Date;return e.setTime(t*24*60*60*1e3+_3),e.getTimezoneOffset()!==Ox&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Ox)*6e4),e}function y3(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var Lx=new Date("2017-02-19T19:06:09.000Z"),z2=isNaN(Lx.getFullYear())?new Date("2/19/17"):Lx,E3=z2.getFullYear()==2017;function ir(t,e){var r=new Date(t);if(E3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(z2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ya(t,e){if(Qe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Dc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Dc(C2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Dc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Dc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function dr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=dr(t[r]));return e}function Dt(t,e){for(var r="";r.length<e;)r+=t;return r}function jn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var w3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&w3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var T3=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function H2(t){return t?t.content&&t.type?ya(t.content,!0):t.data?Pc(t.data):t.asNodeBuffer&&Qe?Pc(t.asNodeBuffer().toString("binary")):t.asBinary?Pc(t.asBinary()):t._data&&t._data.getContent?Pc(ya(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function $2(t){if(!t)return null;if(t.data)return Tx(t.data);if(t.asNodeBuffer&&Qe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Tx(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function k3(t){return t&&t.name.slice(-4)===".bin"?$2(t):H2(t)}function mn(t,e){for(var r=t.FullPaths||hs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function pg(t,e){var r=mn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ht(t,e,r){if(!r)return k3(pg(t,e));if(!e)return null;try{return Ht(t,e)}catch{return null}}function nn(t,e,r){if(!r)return H2(pg(t,e));if(!e)return null;try{return nn(t,e)}catch{return null}}function A3(t,e,r){return $2(pg(t,e))}function bx(t){for(var e=t.FullPaths||hs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function S3(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qe?n=Pa(r):n=WR(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function W2(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Fc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var G2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,I3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Mx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,C3=/<[^>]*>/g,Dr=G2.match(Mx)?Mx:C3,R3=/<\w*:/,P3=/<(\/?)\w+:/;function Oe(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(I3),o=0,c="",l=0,f="",h="",d=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(d=(s=h.charCodeAt(i+1))==34||s==39?1:0,c=h.slice(i+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function ms(t){return t.replace(P3,"<$1")}var K2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},N3=dg(K2),st=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,c){return K2[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),F3=/[&<>'"]/g,D3=/[\u0000-\u001f]/g;function mg(t){var e=t+"";return e.replace(F3,function(r){return N3[r]}).replace(/\n/g,"<br/>").replace(D3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Vx=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function wt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function fd(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Ux(t){var e=Pi(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Bx(t){return Pa(t,"binary").toString("utf8")}var Ku="foo bar baz",pt=Qe&&(Bx(Ku)==fd(Ku)&&Bx||Ux(Ku)==fd(Ku)&&Ux)||fd,Dc=Qe?function(t){return Pa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Pl=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),q2=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),O3=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),L3=/<\/?(?:vt:)?variant>/g,b3=/<(?:vt:)([^>]*)>([\s\S]*)</;function jx(t,e){var r=Oe(t),n=t.match(O3(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(L3,"").match(b3);a&&s.push({v:pt(a[2]),t:a[1]})}),s}var M3=/(^\s|\s$|\n)/;function V3(t){return hs(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function U3(t,e,r){return"<"+t+(r!=null?V3(r):"")+(e!=null?(e.match(M3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function gg(t){if(Qe&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return pt(Na(ug(t)));throw new Error("Bad input format: expected Buffer or string")}var Nl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,B3={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},j3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function z3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function H3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var zx=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Hx=Qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Pa(e)})):zx(t)}:zx,$x=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Ss(t,s)));return n.join("").replace(Ur,"")},vg=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ur,""):$x(t,e,r)}:$x,Wx=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},X2=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Wx(t,e,r)}:Wx,Gx=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Ja(t,s)));return n.join("")},Ql=Qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Gx(e,r,n)}:Gx,Y2=function(t,e){var r=rn(t,e);return r>0?Ql(t,e+4,e+4+r-1):""},Q2=Y2,J2=function(t,e){var r=rn(t,e);return r>0?Ql(t,e+4,e+4+r-1):""},Z2=J2,eT=function(t,e){var r=2*rn(t,e);return r>0?Ql(t,e+4,e+4+r-1):""},tT=eT,rT=function(e,r){var n=rn(e,r);return n>0?vg(e,r+4,r+4+n):""},nT=rT,sT=function(t,e){var r=rn(t,e);return r>0?Ql(t,e+4,e+4+r):""},iT=sT,aT=function(t,e){return z3(t,e)},ah=aT,oT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qe&&(Q2=function(e,r){if(!Buffer.isBuffer(e))return Y2(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Z2=function(e,r){if(!Buffer.isBuffer(e))return J2(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tT=function(e,r){if(!Buffer.isBuffer(e))return eT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},nT=function(e,r){if(!Buffer.isBuffer(e))return rT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},iT=function(e,r){if(!Buffer.isBuffer(e))return sT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ah=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):aT(e,r)},oT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ja=function(t,e){return t[e]},Ss=function(t,e){return t[e+1]*256+t[e]},$3=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},rn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ra=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},W3=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Xc(t,e){var r="",n,s,i=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Ss(this,l)),l+=2;t*=2;break;case"utf8":r=Ql(this,this.l,this.l+t);break;case"utf16le":t*=2,r=vg(this,this.l,this.l+t);break;case"wstr":return Xc.call(this,t,"dbcs");case"lpstr-ansi":r=Q2(this,this.l),t=4+rn(this,this.l);break;case"lpstr-cp":r=Z2(this,this.l),t=4+rn(this,this.l);break;case"lpwstr":r=tT(this,this.l),t=4+2*rn(this,this.l);break;case"lpp4":t=4+rn(this,this.l),r=nT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+rn(this,this.l),r=iT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ja(this,this.l+t++))!==0;)i.push(Gu(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Ss(this,this.l+t))!==0;)i.push(Gu(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Ja(this,l),this.l=l+1,o=Xc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Gu(Ss(this,l))),l+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Ja(this,l),this.l=l+1,o=Xc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Gu(Ja(this,l))),l+=1}r=i.join("");break;default:switch(t){case 1:return n=Ja(this,this.l),this.l++,n;case 2:return n=(e==="i"?$3:Ss)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ra:W3)(this,this.l),this.l+=4,n):(s=rn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=ah(this,this.l):s=ah([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=X2(this,this.l,t);break}}return this.l+=t,r}var G3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},K3=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},q3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function X3(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)q3(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,G3(this,e,this.l);break;case 8:if(n=8,r==="f"){H3(this,e,this.l);break}case 16:break;case-4:n=4,K3(this,e,this.l);break}return this.l+=n,this}function cT(t,e){var r=X2(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ur(t,e){t.l=e,t.read_shift=Xc,t.chk=cT,t.write_shift=X3}function Nr(t,e){t.l+=e}function qt(t){var e=Pi(t);return ur(e,0),e}function $s(t,e,r){if(t){var n,s,i;ur(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=hh[o]||hh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;c=t.l+i;var f=l.f&&l.f(t,i,r);if(t.l=c,e(f,l,o))return}}}function Rp(){var t=[],e=Qe?256:2048,r=function(l){var f=qt(l);return ur(f,0),f},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(l){return n&&l<n.length-n.l?n:(s(),n=r(Math.max(l+1,e)))},a=function(){return s(),si(t)},o=function(l){s(),n=l,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Yc(t,e,r){var n=dr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Kx(t,e,r){var n=dr(t);return n.s=Yc(n.s,e.s,r),n.e=Yc(n.e,e.s,r),n}function Qc(t,e){if(t.cRel&&t.c<0)for(t=dr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=dr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ue(t);return!t.cRel&&t.cRel!=null&&(r=J3(r)),!t.rRel&&t.rRel!=null&&(r=Y3(r)),r}function hd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Qt(t.s.c)+":"+(t.e.cRel?"":"$")+Qt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+pr(t.s.r)+":"+(t.e.rRel?"":"$")+pr(t.e.r):Qc(t.s,e.biff)+":"+Qc(t.e,e.biff)}function xg(t){return parseInt(Q3(t),10)-1}function pr(t){return""+(t+1)}function Y3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Q3(t){return t.replace(/\$(\d+)$/,"$1")}function _g(t){for(var e=Z3(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Qt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function J3(t){return t.replace(/^([A-Z])/,"$$$1")}function Z3(t){return t.replace(/^\$([A-Z])/,"$1")}function eP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ue(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Jo(t){var e=t.indexOf(":");return e==-1?{s:Mr(t),e:Mr(t)}:{s:Mr(t.slice(0,e)),e:Mr(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof e!="string"&&(e=Ue(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function qx(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Sn(t.z,r?Br(e):e)}catch{}try{return t.w=Sn((t.XF||{}).numFmtId||(r?14:0),r?Br(e):e)}catch{return""+e}}function Vs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Oa[t.v]||t.v:e==null?qx(t,t.v):qx(t,e))}function zi(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function lT(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Mr(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Ot(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),a==-1&&(l.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},g=a+h,v=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>v&&(l.s.c=v),l.e.r<g&&(l.e.r=g),l.e.c<v&&(l.e.c=v),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ze[14],n.cellDates?(m.t="d",m.w=Sn(m.z,Br(m.v))):(m.t="n",m.v=Br(m.v),m.w=Sn(m.z,m.v))):m.t="s";if(s)i[g]||(i[g]=[]),i[g][v]&&i[g][v].z&&(m.z=i[g][v].z),i[g][v]=m;else{var E=Ue({c:v,r:g});i[E]&&i[E].z&&(m.z=i[E].z),i[E]=m}}}return l.s.c<1e7&&(i["!ref"]=tt(l)),i}function Zo(t,e){return lT(null,t,e)}function tP(t){return t.read_shift(4,"i")}function Rr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function rP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function yg(t,e){var r=t.l,n=t.read_shift(1),s=Rr(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)i.push(rP(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var nP=yg;function In(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Fa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var sP=Rr;function Eg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var iP=Rr,Pp=Eg;function wg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?ah([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ra(e,0)>>2;return r?s/100:s}function uT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Da=uT;function Ir(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function aP(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var l=ha[s];l&&(e.rgb=Dl(l));break;case 2:e.rgb=Dl([a,o,c]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function oP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function fT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function cP(t){return fT(t,1)}function lP(t){return fT(t,2)}var Tg=2,Hr=3,qu=11,Xx=12,oh=19,Xu=64,uP=65,fP=71,hP=4108,dP=4126,tr=80,hT=81,pP=[tr,hT],mP={1:{n:"CodePage",t:Tg},2:{n:"Category",t:tr},3:{n:"PresentationFormat",t:tr},4:{n:"ByteCount",t:Hr},5:{n:"LineCount",t:Hr},6:{n:"ParagraphCount",t:Hr},7:{n:"SlideCount",t:Hr},8:{n:"NoteCount",t:Hr},9:{n:"HiddenCount",t:Hr},10:{n:"MultimediaClipCount",t:Hr},11:{n:"ScaleCrop",t:qu},12:{n:"HeadingPairs",t:hP},13:{n:"TitlesOfParts",t:dP},14:{n:"Manager",t:tr},15:{n:"Company",t:tr},16:{n:"LinksUpToDate",t:qu},17:{n:"CharacterCount",t:Hr},19:{n:"SharedDoc",t:qu},22:{n:"HyperlinksChanged",t:qu},23:{n:"AppVersion",t:Hr,p:"version"},24:{n:"DigSig",t:uP},26:{n:"ContentType",t:tr},27:{n:"ContentStatus",t:tr},28:{n:"Language",t:tr},29:{n:"Version",t:tr},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},gP={1:{n:"CodePage",t:Tg},2:{n:"Title",t:tr},3:{n:"Subject",t:tr},4:{n:"Author",t:tr},5:{n:"Keywords",t:tr},6:{n:"Comments",t:tr},7:{n:"Template",t:tr},8:{n:"LastAuthor",t:tr},9:{n:"RevNumber",t:tr},10:{n:"EditTime",t:Xu},11:{n:"LastPrinted",t:Xu},12:{n:"CreatedDate",t:Xu},13:{n:"ModifiedDate",t:Xu},14:{n:"PageCount",t:Hr},15:{n:"WordCount",t:Hr},16:{n:"CharCount",t:Hr},17:{n:"Thumbnail",t:fP},18:{n:"Application",t:tr},19:{n:"DocSecurity",t:Hr},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},Yx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},vP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var _P=xP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ha=dr(_P),Oa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function yP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EP(t){var e=yP();if(!t||!t.match)return e;var r={};if((t.match(Dr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(R3,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[Qx[s.ContentType]]!==void 0&&e[Qx[s.ContentType]].push(s.PartName);break}}),e.xmlns!==B3.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var go={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Np(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Jc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Dr)||[]).forEach(function(s){var i=Oe(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Fc(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var wP="application/vnd.oasis.opendocument.spreadsheet";function TP(t,e){for(var r=gg(t),n,s;n=Nl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==wP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Zc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],kP=function(){for(var t=new Array(Zc.length),e=0;e<Zc.length;++e){var r=Zc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function pT(t){var e={};t=pt(t);for(var r=0;r<Zc.length;++r){var n=Zc[r],s=t.match(kP[r]);s!=null&&s.length>0&&(e[n[1]]=st(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ir(e[n[1]]))}return e}var AP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function mT(t,e,r,n){var s=[];if(typeof t=="string")s=jx(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(f){return{v:f}}));var a=typeof e=="string"?jx(e,n).map(function(f){return f.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==s.length;l+=2){switch(c=+s[l+1].v,s[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function SP(t,e,r){var n={};return e||(e={}),t=pt(t),AP.forEach(function(s){var i=(t.match(Pl(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=st(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&mT(n.HeadingPairs,n.TitlesOfParts,e,r),e}var IP=/<[^>]+>[^<]*/g;function CP(t,e){var r={},n="",s=t.match(IP);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Oe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=st(f);break;case"bool":r[n]=wt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=ir(f);break;case"cy":case"error":r[n]=st(f);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var RP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dd;function PP(t,e,r){dd||(dd=dg(RP)),e=dd[e]||e,t[e]=r}function kg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function gT(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function vT(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function xT(t,e,r){return e===31?vT(t):gT(t,e,r)}function Fp(t,e,r){return xT(t,e,r===!1?0:4)}function NP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return xT(t,e,0)}function FP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ur,""),t.l-s&2&&(t.l+=2)}return r}function DP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ur,"");return r}function OP(t){var e=t.l,r=ch(t,hT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ch(t,Hr);return[r,n]}function LP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(OP(t));return r}function Jx(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Ur,"").replace(Nc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function _T(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function bP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ch(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==Xx&&n!==e&&pP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Xx?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return gT(t,n,4).replace(Ur,"");case 31:return vT(t);case 64:return kg(t);case 65:return _T(t);case 71:return bP(t);case 80:return Fp(t,n,!i.raw).replace(Ur,"");case 81:return NP(t,n).replace(Ur,"");case 4108:return LP(t);case 4126:case 4127:return n==4127?FP(t):DP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Zx(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,c=-1,l={};for(a=0;a!=s;++a){var f=t.read_shift(4),h=t.read_shift(4);i[a]=[f,h+r]}i.sort(function(w,x){return w[1]-x[1]});var d={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var m=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(m=!1,t.l=i[a][1]),m)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[i[a][0]];if(d[g.n]=ch(t,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:bn(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(i[a][0]===1){if(o=d.CodePage=ch(t,Tg),bn(o),c!==-1){var v=t.l;t.l=i[c][1],l=Jx(t,o),t.l=v}}else if(i[a][0]===0){if(o===0){c=a,t.l=i[a+1][1];continue}l=Jx(t,o)}else{var E=l[i[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=_T(t);break;case 30:t.l+=4,T=Fp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Fp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=bt(t,4);break;case 64:t.l+=4,T=ir(kg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[E]=T}}return t.l=r+n,d}function e_(t,e,r){var n=t.content;if(!n)return{};ur(n,0);var s,i,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==et.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=Zx(n,e),d={SystemIdentifier:l};for(var m in h)d[m]=h[m];if(d.FMTID=i,s===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=Zx(n,null)}catch{}for(m in g)d[m]=g[m];return d.FMTID=[i,a],d}function Qs(t,e){return t.read_shift(e),null}function MP(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function bt(t,e){return t.read_shift(e)===1}function $t(t){return t.read_shift(2,"u")}function yT(t,e){return MP(t,e,$t)}function VP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Jl(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function UP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,c={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var l=i==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,l);return s&&(t.l+=4*a),n&&(t.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ea(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Zl(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ea(t,n,r)}function La(t,e,r){if(r.biff>5)return Zl(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function BP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function jP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ur,"");return n&&(t.l+=24),s}function zP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Ur,"");return r+a}function HP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return jP(t);case"0303000000000000c000000000000046":return zP(t);default:throw new Error("Unsupported Moniker "+r)}}function Yu(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ur,""):"";return r}function $P(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,c,l="",f,h;s&16&&(i=Yu(t,r-t.l)),s&128&&(a=Yu(t,r-t.l)),(s&257)===257&&(o=Yu(t,r-t.l)),(s&257)===1&&(c=HP(t,r-t.l)),s&8&&(l=Yu(t,r-t.l)),s&32&&(f=t.read_shift(16)),s&64&&(h=kg(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return f&&(m.guid=f),h&&(m.time=h),i&&(m.Tooltip=i),m}function ET(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function wT(t,e){var r=ET(t);return r[3]=0,r}function gs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function WP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function GP(t,e,r){return e===0?"":La(t,e,r)}function KP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function TT(t){var e=t.read_shift(2),r=wg(t);return[e,r]}function qP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Jl(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Jh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function kT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var XP=kT;function AT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function YP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function QP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Er(t){t.l+=2,t.l+=t.read_shift(2)}var JP={0:Er,4:Er,5:Er,6:Er,7:QP,8:Er,9:Er,10:Er,11:Er,12:Er,13:YP,14:Er,15:Er,16:Er,17:Er,18:Er,19:Er,20:Er,21:AT};function ZP(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(JP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Qu(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function eN(t,e){return e===0||t.read_shift(2),1200}function tN(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=La(t,0,r);return t.read_shift(e+n-t.l),s}function rN(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function nN(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=Jl(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function sN(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(UP(t));return i.Count=n,i.Unique=s,i}function iN(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function aN(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function oN(t){var e=WP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function cN(t){return t.read_shift(2),t.read_shift(4)}function t_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function lN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function uN(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function fN(){}function hN(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Jl(t,0,r),n}function dN(t){var e=gs(t);return e.isst=t.read_shift(4),e}function pN(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=gs(t);r.biff==2&&t.l++;var i=Zl(t,n-t.l,r);return s.val=i,s}function mN(t,e,r){var n=t.read_shift(2),s=La(t,0,r);return[n,s]}var gN=La;function r_(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c}}}function vN(t){var e=t.read_shift(2),r=t.read_shift(2),n=TT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function xN(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(TT(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function _N(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function yN(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return s.patternType=vP[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function EN(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=yN(t,e,n.fStyle,r),n}function wN(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function n_(t,e,r){var n=gs(t);(r.biff==2||e==9)&&++t.l;var s=VP(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function TN(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=gs(t),s=Ir(t);return n.val=s,n}var s_=GP;function kN(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ea(t,i),o=[];n>t.l;)o.push(Zl(t));return[i,s,a,o]}function i_(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=qP(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var AN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function a_(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Ea(t,a,r);s&32&&(l=AN[l.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:aO(t,f,r,o);return{chKey:i,Name:l,itab:c,rgce:h}}function ST(t,e,r){if(r.biff<8)return SN(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(KP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function SN(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Jl(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function IN(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Ea(t,n,r),a=Ea(t,s,r);return[i,a]}function CN(t,e,r){var n=kT(t);t.l++;var s=t.read_shift(1);return e-=8,[oO(t,e,r),s,n]}function o_(t,e,r){var n=XP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,sO(t,e,r)]}function RN(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function PN(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=La(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function NN(t,e,r){return PN(t,e,r)}function FN(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Jh(t));return r}function DN(t,e,r){if(r&&r.biff<8)return LN(t,e,r);var n=AT(t),s=ZP(t,e-22,n[1]);return{cmo:n,ft:s}}var ON={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function LN(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((ON[n]||Nr)(t,e,r)),{cmo:[s,n,i],ft:a}}function bN(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=BP(t,6,r);var o=t.read_shift(2);t.read_shift(2),$t(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var f=t[t.l],h=Ea(t,t.lens[l+1]-t.lens[l]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function MN(t,e){var r=Jh(t);t.l+=16;var n=$P(t,e-24);return[r,n]}function VN(t,e){t.read_shift(2);var r=Jh(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ur,""),[r,n]}function UN(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Yx[r]||r,r=t.read_shift(2),e[1]=Yx[r]||r,e}function BN(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(wT(t));return r}function jN(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(wT(t));return r}function zN(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function IT(t,e,r){if(!r.cellStyles)return Nr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function HN(t,e){var r={};return e<32||(t.l+=16,r.header=Ir(t),r.footer=Ir(t),t.l+=2),r}function $N(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var WN=gs,GN=yT,KN=Zl;function qN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function XN(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=gs(t);++t.l;var s=La(t,e-7,r);return n.t="str",n.val=s,n}function YN(t){var e=gs(t);++t.l;var r=Ir(t);return e.t="n",e.val=r,e}function QN(t){var e=gs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function JN(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function ZN(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function eF(t,e,r){var n=t.l+e,s=gs(t),i=t.read_shift(2),a=Ea(t,i,r);return t.l=n,s.t="str",s.val=a,s}var tF=[2,3,48,49,131,139,140,245],c_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=dg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],f=Pi(1);switch(c.type){case"base64":f=Ln(un(o));break;case"binary":f=Ln(o);break;case"buffer":case"array":f=o;break}ur(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,E=521;h==2&&(v=f.read_shift(2)),f.l+=3,h!=2&&(v=f.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(E=f.read_shift(2));var T=f.read_shift(2),w=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=t[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var x=[],O={},z=Math.min(f.length,h==2?521:E-10-(m?264:0)),B=g?32:11;f.l<z&&f[f.l]!=13;)switch(O={},O.name=Cl.utils.decode(w,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,O.type=String.fromCharCode(f.read_shift(1)),h!=2&&!g&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),h==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&x.push(O),h!=2&&(f.l+=g?13:14),O.type){case"B":(!m||O.len!=8)&&c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var _=0,k=0;for(l[0]=[],k=0;k!=x.length;++k)l[0][k]=x[k].name;for(;v-- >0;){if(f[f.l]===42){f.l+=T;continue}for(++f.l,l[++_]=[],k=0,k=0;k!=x.length;++k){var A=f.slice(f.l,f.l+x[k].len);f.l+=x[k].len,ur(A,0);var I=Cl.utils.decode(w,A);switch(x[k].type){case"C":I.trim().length&&(l[_][k]=I.replace(/\s+$/,""));break;case"D":I.length===8?l[_][k]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):l[_][k]=I;break;case"F":l[_][k]=parseFloat(I.trim());break;case"+":case"I":l[_][k]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":l[_][k]=!0;break;case"N":case"F":l[_][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[_][k]="##MEMO##"+(g?parseInt(I.trim(),10):A.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(l[_][k]=+I||0);break;case"@":l[_][k]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":l[_][k]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":l[_][k]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[_][k]=-A.read_shift(-8,"f");break;case"B":if(m&&x[k].len==8){l[_][k]=A.read_shift(8,"f");break}case"G":case"P":A.l+=x[k].len;break;case"0":if(x[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=x,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Zo(r(o,l),l);return f["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,f}function s(o,c){try{return zi(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&bn(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Rp(),h=Vp(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],v=0,E=0,T=0,w=1;for(v=0;v<d.length;++v){if(((g[v]||{}).DBF||{}).name){d[v]=g[v].DBF.name,++T;continue}if(d[v]!=null){if(++T,typeof d[v]=="number"&&(d[v]=d[v].toString(10)),typeof d[v]!="string")throw new Error("DBF Invalid column name "+d[v]+" |"+typeof d[v]+"|");if(d.indexOf(d[v])!==v){for(E=0;E<1024;++E)if(d.indexOf(d[v]+"_"+E)==-1){d[v]+="_"+E;break}}}}var x=Ot(o["!ref"]),O=[],z=[],B=[];for(v=0;v<=x.e.c-x.s.c;++v){var _="",k="",A=0,I=[];for(E=0;E<m.length;++E)m[E][v]!=null&&I.push(m[E][v]);if(I.length==0||d[v]==null){O[v]="?";continue}for(E=0;E<I.length;++E){switch(typeof I[E]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=I[E]instanceof Date?"D":"C";break;default:k="C"}A=Math.max(A,String(I[E]).length),_=_&&_!=k?"C":k}A>250&&(A=250),k=((g[v]||{}).DBF||{}).type,k=="C"&&g[v].DBF.len>A&&(A=g[v].DBF.len),_=="B"&&k=="N"&&(_="N",B[v]=g[v].DBF.dec,A=g[v].DBF.len),z[v]=_=="C"||k=="N"?A:i[_]||0,w+=z[v],O[v]=_}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*T),R.write_shift(2,w),v=0;v<4;++v)R.write_shift(4,0);for(R.write_shift(4,0|(+e[S2]||3)<<8),v=0,E=0;v<d.length;++v)if(d[v]!=null){var C=f.next(32),N=(d[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,N,"sbcs"),C.write_shift(1,O[v]=="?"?"C":O[v],"sbcs"),C.write_shift(4,E),C.write_shift(1,z[v]||i[O[v]]||0),C.write_shift(1,B[v]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),E+=z[v]||i[O[v]]||0}var ye=f.next(264);for(ye.write_shift(4,13),v=0;v<65;++v)ye.write_shift(4,0);for(v=0;v<m.length;++v){var he=f.next(w);for(he.write_shift(1,0),E=0;E<d.length;++E)if(d[E]!=null)switch(O[E]){case"L":he.write_shift(1,m[v][E]==null?63:m[v][E]?84:70);break;case"B":he.write_shift(8,m[v][E]||0,"f");break;case"N":var we="0";for(typeof m[v][E]=="number"&&(we=m[v][E].toFixed(B[E]||0)),T=0;T<z[E]-we.length;++T)he.write_shift(1,32);he.write_shift(1,we,"sbcs");break;case"D":m[v][E]?(he.write_shift(4,("0000"+m[v][E].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(m[v][E].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+m[v][E].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(m[v][E]!=null?m[v][E]:"").slice(0,z[E]);for(he.write_shift(1,ge,"sbcs"),T=0;T<z[E]-ge.length;++T)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),rF=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+hs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var g=t[m];return typeof g=="number"?kx(g):g},n=function(d,m,g){var v=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?d:kx(v)};t["|"]=254;function s(d,m){switch(m.type){case"base64":return i(un(d),m);case"binary":return i(d,m);case"buffer":return i(Qe&&Buffer.isBuffer(d)?d.toString("binary"):Na(d),m);case"array":return i(ya(d),m)}throw new Error("Unrecognized type "+m.type)}function i(d,m){var g=d.split(/[\n\r]+/),v=-1,E=-1,T=0,w=0,x=[],O=[],z=null,B={},_=[],k=[],A=[],I=0,R;for(+m.codepage>=0&&bn(+m.codepage);T!==g.length;++T){I=0;var C=g[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=C.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ye=N[0],he;if(C.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&O.push(C.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,ge=!1,ie=!1,W=!1,le=-1,Te=-1;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"A":break;case"X":E=parseInt(N[w].slice(1))-1,ge=!0;break;case"Y":for(v=parseInt(N[w].slice(1))-1,ge||(E=0),R=x.length;R<=v;++R)x[R]=[];break;case"K":he=N[w].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(jn(he))?isNaN(Uo(he).getDate())||(he=ir(he)):(he=jn(he),z!==null&&Qo(z)&&(he=Qh(he))),we=!0;break;case"E":W=!0;var M=Ao(N[w].slice(1),{r:v,c:E});x[v][E]=[x[v][E],M];break;case"S":ie=!0,x[v][E]=[x[v][E],"S5S"];break;case"G":break;case"R":le=parseInt(N[w].slice(1))-1;break;case"C":Te=parseInt(N[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(we&&(x[v][E]&&x[v][E].length==2?x[v][E][0]=he:x[v][E]=he,z=null),ie){if(W)throw new Error("SYLK shared formula cannot have own formula");var K=le>-1&&x[le][Te];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");x[v][E][1]=MT(K[1],{r:v-le,c:E-Te})}break;case"F":var G=0;for(w=1;w<N.length;++w)switch(N[w].charAt(0)){case"X":E=parseInt(N[w].slice(1))-1,++G;break;case"Y":for(v=parseInt(N[w].slice(1))-1,R=x.length;R<=v;++R)x[R]=[];break;case"M":I=parseInt(N[w].slice(1))/20;break;case"F":break;case"G":break;case"P":z=O[parseInt(N[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=N[w].slice(1).split(" "),R=parseInt(A[0],10);R<=parseInt(A[1],10);++R)I=parseInt(A[2],10),k[R-1]=I===0?{hidden:!0}:{wch:I},Bo(k[R-1]);break;case"C":E=parseInt(N[w].slice(1))-1,k[E]||(k[E]={});break;case"R":v=parseInt(N[w].slice(1))-1,_[v]||(_[v]={}),I>0?(_[v].hpt=I,_[v].hpx=Ol(I)):I===0&&(_[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}G<1&&(z=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return _.length>0&&(B["!rows"]=_),k.length>0&&(B["!cols"]=k),m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),[x,B]}function a(d,m){var g=s(d,m),v=g[0],E=g[1],T=Zo(v,m);return hs(E).forEach(function(w){T[w]=E[w]}),T}function o(d,m){return zi(a(d,m),m)}function c(d,m,g,v){var E="C;Y"+(g+1)+";X"+(v+1)+";K";switch(d.t){case"n":E+=d.v||0,d.f&&!d.F&&(E+=";E"+zD(d.f,{r:g,c:v}));break;case"b":E+=d.v?"TRUE":"FALSE";break;case"e":E+=d.w||d.v;break;case"d":E+='"'+(d.w||d.v)+'"';break;case"s":E+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function l(d,m){m.forEach(function(g,v){var E="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?E+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=uh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=fh(g.wpx)),typeof g.wch=="number"&&(E+=Math.round(g.wch))),E.charAt(E.length-1)!=" "&&d.push(E)})}function f(d,m){m.forEach(function(g,v){var E="F;";g.hidden?E+="M0;":g.hpt?E+="M"+20*g.hpt+";":g.hpx&&(E+="M"+20*OT(g.hpx)+";"),E.length>2&&d.push(E+"R"+(v+1))})}function h(d,m){var g=["ID;PWXL;N;E"],v=[],E=Ot(d["!ref"]),T,w=Array.isArray(d),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var O=E.s.r;O<=E.e.r;++O)for(var z=E.s.c;z<=E.e.c;++z){var B=Ue({r:O,c:z});T=w?(d[O]||[])[z]:d[B],!(!T||T.v==null&&(!T.f||T.F))&&v.push(c(T,d,O,z))}return g.join(x)+x+v.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),nF=function(){function t(i,a){switch(a.type){case"base64":return e(un(i),a);case"binary":return e(i,a);case"buffer":return e(Qe&&Buffer.isBuffer(i)?i.toString("binary"):Na(i),a);case"array":return e(ya(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),c=-1,l=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),m=d[0],g=d[1];++f;for(var v=o[f]||"";(v.match(/["]/g)||[]).length&1&&f<o.length-1;)v+=`
`+o[++f];switch(v=v.trim(),+m){case-1:if(v==="BOT"){h[++c]=[],l=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[c][l]=!0:v==="FALSE"?h[c][l]=!1:isNaN(jn(g))?isNaN(Uo(g).getDate())?h[c][l]=g:h[c][l]=ir(g):h[c][l]=jn(g),++l;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[c][l++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Zo(t(i,a),a)}function n(i,a){return zi(r(i,a),a)}var s=function(){var i=function(c,l,f,h,d){c.push(l),c.push(f+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,f,h){c.push(l+","+f),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],f=Ot(c["!ref"]),h,d=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(l,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var v=Ue({r:m,c:g});if(h=d?(c[m]||[])[g]:c[v],!h){a(l,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,E,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Sn(h.z||ze[14],Br(ir(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,w=l.join(T);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),sF=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),g=-1,v=-1,E=0,T=[];E!==m.length;++E){var w=m[E].trim().split(":");if(w[0]==="cell"){var x=Mr(w[1]);if(T.length<=x.r)for(g=T.length;g<=x.r;++g)T[g]||(T[g]=[]);switch(g=x.r,v=x.c,w[2]){case"t":T[g][v]=t(w[3]);break;case"v":T[g][v]=+w[3];break;case"vtf":var O=w[w.length-1];case"vtc":switch(w[3]){case"nl":T[g][v]=!!+w[4];break;default:T[g][v]=+w[4];break}w[2]=="vtf"&&(T[g][v]=[T[g][v],O])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return Zo(r(h,d),d)}function s(h,d){return zi(n(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,v="",E=Jo(h["!ref"]),T=Array.isArray(h),w=E.s.r;w<=E.e.r;++w)for(var x=E.s.c;x<=E.e.c;++x)if(v=Ue({r:w,c:x}),g=T?(h[w]||[])[x]:h[v],!(!g||g.v==null||g.t==="z")){switch(m=["cell",v,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var O=Br(ir(g.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=g.w||Sn(g.z||ze[14],O);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[i,a,o,a,l(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),Fl=function(){function t(f,h,d,m,g){g.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(jn(f))?isNaN(Uo(f).getDate())?h[d][m]=f:h[d][m]=ir(f):h[d][m]=jn(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var g=f.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var E=10,T=0,w=0;w<=v;++w)T=g[w].indexOf(" "),T==-1?T=g[w].length:T++,E=Math.max(E,T);for(w=0;w<=v;++w){m[w]=[];var x=0;for(t(g[w].slice(0,E).trim(),m,w,x,d),x=1;x<=(g[w].length-E)/10+1;++x)t(g[w].slice(E+(x-1)*10,E+x*10).trim(),m,w,x,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},d=!1,m=0,g=0;m<f.length;++m)(g=f.charCodeAt(m))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(v,E){return v[0]-E[0]||n[v[1]]-n[E[1]]}),r[g.pop()[1]]||44}function i(f,h){var d=h||{},m="",g=d.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):d&&d.FS?m=d.FS:m=s(f.slice(0,1024));var E=0,T=0,w=0,x=0,O=0,z=m.charCodeAt(0),B=!1,_=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=d.dateNF!=null?m3(d.dateNF):null;function I(){var R=f.slice(x,O),C={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)C.t="z";else if(d.raw)C.t="s",C.v=R;else if(R.trim().length===0)C.t="s",C.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(C.t="s",C.v=R.slice(2,-1).replace(/""/g,'"')):$D(R)?(C.t="n",C.f=R.slice(1)):(C.t="s",C.v=R);else if(R=="TRUE")C.t="b",C.v=!0;else if(R=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=jn(R)))C.t="n",d.cellText!==!1&&(C.w=R),C.v=w;else if(!isNaN(Uo(R).getDate())||A&&R.match(A)){C.z=d.dateNF||ze[14];var N=0;A&&R.match(A)&&(R=g3(R,d.dateNF,R.match(A)||[]),N=1),d.cellDates?(C.t="d",C.v=ir(R,N)):(C.t="n",C.v=Br(ir(R,N))),d.cellText!==!1&&(C.w=Sn(C.z,C.v instanceof Date?Br(C.v):C.v)),d.cellNF||delete C.z}else C.t="s",C.v=R;if(C.t=="z"||(d.dense?(g[E]||(g[E]=[]),g[E][T]=C):g[Ue({c:T,r:E})]=C),x=O+1,k=f.charCodeAt(x),v.e.c<T&&(v.e.c=T),v.e.r<E&&(v.e.r=E),_==z)++T;else if(T=0,++E,d.sheetRows&&d.sheetRows<=E)return!0}e:for(;O<f.length;++O)switch(_=f.charCodeAt(O)){case 34:k===34&&(B=!B);break;case z:case 10:case 13:if(!B&&I())break e;break}return O-x>0&&I(),g["!ref"]=tt(v),g}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):Zo(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:Fg(f,h);switch(h.type){case"base64":d=un(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Cl<"u"||(d=Qe&&Buffer.isBuffer(f)?f.toString("binary"):Na(f));break;case"array":d=ya(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=pt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=pt(d):h.type=="binary"&&typeof Cl<"u",d.slice(0,19)=="socialcalc:version:"?sF.to_sheet(h.type=="string"?d:pt(d),h):a(d,h)}function c(f,h){return zi(o(f,h),h)}function l(f){for(var h=[],d=Ot(f["!ref"]),m,g=Array.isArray(f),v=d.s.r;v<=d.e.r;++v){for(var E=[],T=d.s.c;T<=d.e.c;++T){var w=Ue({r:v,c:T});if(m=g?(f[v]||[])[T]:f[w],!m||m.v==null){E.push("          ");continue}for(var x=(m.w||(Vs(m),m.w)||"").slice(0,10);x.length<10;)x+=" ";E.push(x+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function iF(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=rF.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Fl.to_workbook(t,e)}}var el=function(){function t(M,K,G){if(M){ur(M,M.l||0);for(var H=G.Enum||le;M.l<M.length;){var te=M.read_shift(2),ue=H[te]||H[65535],ke=M.read_shift(2),de=M.l+ke,ae=ue.f&&ue.f(M,ke,G);if(M.l=de,K(ae,ue,te))return}}}function e(M,K){switch(K.type){case"base64":return r(Ln(un(M)),K);case"binary":return r(Ln(M),K);case"buffer":case"array":return r(M,K)}throw"Unsupported type "+K.type}function r(M,K){if(!M)return M;var G=K||{},H=G.dense?[]:{},te="Sheet1",ue="",ke=0,de={},ae=[],Le=[],j={s:{r:0,c:0},e:{r:0,c:0}},at=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=le,t(M,function(ve,mt,re){switch(re){case 0:G.vers=ve,ve>=4096&&(G.qpro=!0);break;case 6:j=ve;break;case 204:ve&&(ue=ve);break;case 222:ue=ve;break;case 15:case 51:G.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:re==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=G.dateNF||ze[14],G.cellDates&&(ve[1].t="d",ve[1].v=Qh(ve[1].v))),G.qpro&&ve[3]>ke&&(H["!ref"]=tt(j),de[te]=H,ae.push(te),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ke=ve[3],te=ue||"Sheet"+(ke+1),ue="");var _e=G.dense?(H[ve[0].r]||[])[ve[0].c]:H[Ue(ve[0])];if(_e){_e.t=ve[1].t,_e.v=ve[1].v,ve[1].z!=null&&(_e.z=ve[1].z),ve[1].f!=null&&(_e.f=ve[1].f);break}G.dense?(H[ve[0].r]||(H[ve[0].r]=[]),H[ve[0].r][ve[0].c]=ve[1]):H[Ue(ve[0])]=ve[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=Te,M[2]==14&&(G.qpro=!0,M.l=0),t(M,function(ve,mt,re){switch(re){case 204:te=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>ke&&(H["!ref"]=tt(j),de[te]=H,ae.push(te),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ke=ve[3],te="Sheet"+(ke+1)),at>0&&ve[0].r>=at)break;G.dense?(H[ve[0].r]||(H[ve[0].r]=[]),H[ve[0].r][ve[0].c]=ve[1]):H[Ue(ve[0])]=ve[1],j.e.c<ve[0].c&&(j.e.c=ve[0].c),j.e.r<ve[0].r&&(j.e.r=ve[0].r);break;case 27:ve[14e3]&&(Le[ve[14e3][0]]=ve[14e3][1]);break;case 1537:Le[ve[0]]=ve[1],ve[0]==ke&&(te=ve[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(H["!ref"]=tt(j),de[ue||te]=H,ae.push(ue||te),!Le.length)return{SheetNames:ae,Sheets:de};for(var $e={},Xe=[],je=0;je<Le.length;++je)de[ae[je]]?(Xe.push(Le[je]||ae[je]),$e[Le[je]]=de[Le[je]]||de[ae[je]]):(Xe.push(Le[je]),$e[Le[je]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:$e}}function n(M,K){var G=K||{};if(+G.codepage>=0&&bn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Rp(),te=Ot(M["!ref"]),ue=Array.isArray(M),ke=[];Nn(H,0,i(1030)),Nn(H,6,c(te));for(var de=Math.min(te.e.r,8191),ae=te.s.r;ae<=de;++ae)for(var Le=pr(ae),j=te.s.c;j<=te.e.c;++j){ae===te.s.r&&(ke[j]=Qt(j));var at=ke[j]+Le,$e=ue?(M[ae]||[])[j]:M[at];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Nn(H,13,m(ae,j,$e.v)):Nn(H,14,v(ae,j,$e.v));else{var Xe=Vs($e);Nn(H,15,h(ae,j,Xe.slice(0,239)))}}return Nn(H,1),H.end()}function s(M,K){var G=K||{};if(+G.codepage>=0&&bn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Rp();Nn(H,0,a(M));for(var te=0,ue=0;te<M.SheetNames.length;++te)(M.Sheets[M.SheetNames[te]]||{})["!ref"]&&Nn(H,27,W(M.SheetNames[te],ue++));var ke=0;for(te=0;te<M.SheetNames.length;++te){var de=M.Sheets[M.SheetNames[te]];if(!(!de||!de["!ref"])){for(var ae=Ot(de["!ref"]),Le=Array.isArray(de),j=[],at=Math.min(ae.e.r,8191),$e=ae.s.r;$e<=at;++$e)for(var Xe=pr($e),je=ae.s.c;je<=ae.e.c;++je){$e===ae.s.r&&(j[je]=Qt(je));var ve=j[je]+Xe,mt=Le?(de[$e]||[])[je]:de[ve];if(!(!mt||mt.t=="z"))if(mt.t=="n")Nn(H,23,I($e,je,ke,mt.v));else{var re=Vs(mt);Nn(H,22,_($e,je,ke,re.slice(0,239)))}}++ke}}return Nn(H,1),H.end()}function i(M){var K=qt(2);return K.write_shift(2,M),K}function a(M){var K=qt(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var G=0,H=0,te=0,ue=0;ue<M.SheetNames.length;++ue){var ke=M.SheetNames[ue],de=M.Sheets[ke];if(!(!de||!de["!ref"])){++te;var ae=Jo(de["!ref"]);G<ae.e.r&&(G=ae.e.r),H<ae.e.c&&(H=ae.e.c)}}return G>8191&&(G=8191),K.write_shift(2,G),K.write_shift(1,te),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(M,K,G){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&G.qpro?(H.s.c=M.read_shift(1),M.l++,H.s.r=M.read_shift(2),H.e.c=M.read_shift(1),M.l++,H.e.r=M.read_shift(2),H):(H.s.c=M.read_shift(2),H.s.r=M.read_shift(2),K==12&&G.qpro&&(M.l+=2),H.e.c=M.read_shift(2),H.e.r=M.read_shift(2),K==12&&G.qpro&&(M.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(M){var K=qt(8);return K.write_shift(2,M.s.c),K.write_shift(2,M.s.r),K.write_shift(2,M.e.c),K.write_shift(2,M.e.r),K}function l(M,K,G){var H=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(H[0].c=M.read_shift(1),H[3]=M.read_shift(1),H[0].r=M.read_shift(2),M.l+=2):(H[2]=M.read_shift(1),H[0].c=M.read_shift(2),H[0].r=M.read_shift(2)),H}function f(M,K,G){var H=M.l+K,te=l(M,K,G);if(te[1].t="s",G.vers==20768){M.l++;var ue=M.read_shift(1);return te[1].v=M.read_shift(ue,"utf8"),te}return G.qpro&&M.l++,te[1].v=M.read_shift(H-M.l,"cstr"),te}function h(M,K,G){var H=qt(7+G.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,M),H.write_shift(1,39);for(var te=0;te<H.length;++te){var ue=G.charCodeAt(te);H.write_shift(1,ue>=128?95:ue)}return H.write_shift(1,0),H}function d(M,K,G){var H=l(M,K,G);return H[1].v=M.read_shift(2,"i"),H}function m(M,K,G){var H=qt(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,M),H.write_shift(2,G,"i"),H}function g(M,K,G){var H=l(M,K,G);return H[1].v=M.read_shift(8,"f"),H}function v(M,K,G){var H=qt(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,M),H.write_shift(8,G,"f"),H}function E(M,K,G){var H=M.l+K,te=l(M,K,G);if(te[1].v=M.read_shift(8,"f"),G.qpro)M.l=H;else{var ue=M.read_shift(2);O(M.slice(M.l,M.l+ue),te),M.l+=ue}return te}function T(M,K,G){var H=K&32768;return K&=-32769,K=(H?M:0)+(K>=8192?K-16384:K),(H?"":"$")+(G?Qt(K):pr(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(M,K){ur(M,0);for(var G=[],H=0,te="",ue="",ke="",de="";M.l<M.length;){var ae=M[M.l++];switch(ae){case 0:G.push(M.read_shift(8,"f"));break;case 1:ue=T(K[0].c,M.read_shift(2),!0),te=T(K[0].r,M.read_shift(2),!1),G.push(ue+te);break;case 2:{var Le=T(K[0].c,M.read_shift(2),!0),j=T(K[0].r,M.read_shift(2),!1);ue=T(K[0].c,M.read_shift(2),!0),te=T(K[0].r,M.read_shift(2),!1),G.push(Le+j+":"+ue+te)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var at="";ae=M[M.l++];)at+=String.fromCharCode(ae);G.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:de=G.pop(),ke=G.pop(),G.push(["AND","OR"][ae-20]+"("+ke+","+de+")");break;default:if(ae<32&&x[ae])de=G.pop(),ke=G.pop(),G.push(ke+x[ae]+de);else if(w[ae]){if(H=w[ae][1],H==69&&(H=M[M.l++]),H>G.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+G.join("|")+"|");return}var $e=G.slice(-H);G.length-=H,G.push(w[ae][0]+"("+$e.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}G.length==1?K[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function z(M){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=M.read_shift(2),K[3]=M[M.l++],K[0].c=M[M.l++],K}function B(M,K){var G=z(M);return G[1].t="s",G[1].v=M.read_shift(K-4,"cstr"),G}function _(M,K,G,H){var te=qt(6+H.length);te.write_shift(2,M),te.write_shift(1,G),te.write_shift(1,K),te.write_shift(1,39);for(var ue=0;ue<H.length;++ue){var ke=H.charCodeAt(ue);te.write_shift(1,ke>=128?95:ke)}return te.write_shift(1,0),te}function k(M,K){var G=z(M);G[1].v=M.read_shift(2);var H=G[1].v>>1;if(G[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return G[1].v=H,G}function A(M,K){var G=z(M),H=M.read_shift(4),te=M.read_shift(4),ue=M.read_shift(2);if(ue==65535)return H===0&&te===3221225472?(G[1].t="e",G[1].v=15):H===0&&te===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var ke=ue&32768;return ue=(ue&32767)-16446,G[1].v=(1-ke*2)*(te*Math.pow(2,ue+32)+H*Math.pow(2,ue)),G}function I(M,K,G,H){var te=qt(14);if(te.write_shift(2,M),te.write_shift(1,G),te.write_shift(1,K),H==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ue=0,ke=0,de=0,ae=0;return H<0&&(ue=1,H=-H),ke=Math.log2(H)|0,H/=Math.pow(2,ke-31),ae=H>>>0,ae&2147483648||(H/=2,++ke,ae=H>>>0),H-=ae,ae|=2147483648,ae>>>=0,H*=Math.pow(2,32),de=H>>>0,te.write_shift(4,de),te.write_shift(4,ae),ke+=16383+(ue?32768:0),te.write_shift(2,ke),te}function R(M,K){var G=A(M);return M.l+=K-14,G}function C(M,K){var G=z(M),H=M.read_shift(4);return G[1].v=H>>6,G}function N(M,K){var G=z(M),H=M.read_shift(8,"f");return G[1].v=H,G}function ye(M,K){var G=N(M);return M.l+=K-10,G}function he(M,K){return M[M.l+K-1]==0?M.read_shift(K,"cstr"):""}function we(M,K){var G=M[M.l++];G>K-1&&(G=K-1);for(var H="";H.length<G;)H+=String.fromCharCode(M[M.l++]);return H}function ge(M,K,G){if(!(!G.qpro||K<21)){var H=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var te=M.read_shift(K-21,"cstr");return[H,te]}}function ie(M,K){for(var G={},H=M.l+K;M.l<H;){var te=M.read_shift(2);if(te==14e3){for(G[te]=[0,""],G[te][0]=M.read_shift(2);M[M.l];)G[te][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function W(M,K){var G=qt(5+M.length);G.write_shift(2,14e3),G.write_shift(2,K);for(var H=0;H<M.length;++H){var te=M.charCodeAt(H);G[G.l++]=te>127?95:te}return G[G.l++]=0,G}var le={0:{n:"BOF",f:$t},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function aF(t){var e={},r=t.match(Dr),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Oe(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=cg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var oF=function(){var t=Pl("t"),e=Pl("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:st(a[1])},c=i.match(e);return c&&(o.s=aF(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),cF=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),lF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uF=/<(?:\w+:)?r>/,fF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ag(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(pt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(t),r&&(n.h=mg(n.t))):t.match(uF)&&(n.r=pt(t),n.t=st(pt((t.replace(fF,"").match(lF)||[]).join("").replace(Dr,""))),r&&(n.h=cF(oF(n.r)))),n):{t:""}}var hF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dF=/<(?:\w+:)?(?:si|sstItem)>/g,pF=/<\/(?:\w+:)?(?:si|sstItem)>/;function mF(t,e){var r=[],n="";if(!t)return r;var s=t.match(hF);if(s){n=s[2].replace(dF,"").split(pF);for(var i=0;i!=n.length;++i){var a=Ag(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function gF(t){return[t.read_shift(4),t.read_shift(4)]}function vF(t,e){var r=[],n=!1;return $s(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function CT(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ns(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function xF(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ns(t,4),e.U=Ns(t,4),e.W=Ns(t,4),e}function _F(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(_F(t));return e}function EF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function wF(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ns(t,4),e.U=Ns(t,4),e.W=Ns(t,4),e}function TF(t){var e=wF(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function RT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function PT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function kF(t){var e=Ns(t);switch(e.Minor){case 2:return[e.Minor,AF(t)];case 3:return[e.Minor,SF()];case 4:return[e.Minor,IF(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function AF(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=RT(t,r),s=PT(t,t.length-t.l);return{t:"Std",h:n,v:s}}function SF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function IF(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Dr,function(i){var a=Oe(i);switch(ms(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function CF(t,e){var r={},n=r.EncryptionVersionInfo=Ns(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=RT(t,s),e-=s,r.EncryptionVerifier=PT(t,e),r}function RF(t){var e={},r=e.EncryptionVersionInfo=Ns(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function PF(t){var e=0,r,n=CT(t),s=n.length+1,i,a,o,c,l;for(r=Pi(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var NT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var f=a[l],h=0;h!=7;++h)f&64&&(o^=r[c]),f*=2,--c;return o};return function(a){for(var o=CT(a),c=i(o),l=o.length,f=Pi(16),h=0;h!=16;++h)f[h]=0;var d,m,g;for((l&1)===1&&(d=c>>8,f[l]=s(t[0],d),--l,d=c&255,m=o[o.length-1],f[l]=s(m,d));l>0;)--l,d=c>>8,f[l]=s(o[l],d),--l,d=c&255,f[l]=s(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,f[l]=s(t[g],d),--l,--g,d=c&255,f[l]=s(o[l],d),--l,--g;return f}}(),NF=function(t,e,r,n,s){s||(s=e),n||(n=NT(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},FF=function(t){var e=0,r=NT(t);return function(n){var s=NF("",n,e,r);return e=s[1],s[0]}};function DF(t,e,r,n){var s={key:$t(t),verificationBytes:$t(t)};return r.password&&(s.verifier=PF(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=FF(r.password)),s}function OF(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=RF(t):n.Data=CF(t,e),n}function LF(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?OF(t,e-2,n):DF(t,r.biff>=8?e:e-2,r,n),n}var bF=function(){function t(s,i){switch(i.type){case"base64":return e(un(s),i);case"binary":return e(s,i);case"buffer":return e(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Na(s),i);case"array":return e(ya(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,v=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var E=f.slice(m,d.lastIndex-g[0].length);if(E[0]==" "&&(E=E.slice(1)),++v,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][v]=T:o[Ue({r:h,c:v})]=T}break}m=d.lastIndex}v>l.e.c&&(l.e.c=v)}),o["!ref"]=tt(l),o}function r(s,i){return zi(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Ot(s["!ref"]),o,c=Array.isArray(s),l=a.s.r;l<=a.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Ue({r:l,c:f});o=c?(s[l]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Vs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function MF(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Dl(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function VF(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,c=0,l=s+i;switch(c=a/(l>1?2-l:l),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function UF(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,a[0]+=s,a[1]+=c;break;case 1:c=s*(2-o),a[0]+=c,a[1]+=s;break;case 2:c=s*(o-2),a[1]+=s,a[2]+=c;break;case 3:c=s*(4-o),a[1]+=c,a[2]+=s;break;case 4:c=s*(o-4),a[2]+=s,a[0]+=c;break;case 5:c=s*(6-o),a[2]+=c,a[0]+=s;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function lh(t,e){if(e===0)return t;var r=VF(MF(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Dl(UF(r))}var FT=6,BF=15,jF=1,br=FT;function uh(t){return Math.floor((t+Math.round(128/br)/256)*br)}function fh(t){return Math.floor((t-5)/br*100+.5)/100}function Dp(t){return Math.round((t*br+5)/br*256)/256}function pd(t){return Dp(fh(uh(t)))}function Sg(t){var e=Math.abs(t-pd(t)),r=br;if(e>.005)for(br=jF;br<BF;++br)Math.abs(t-pd(t))<=e&&(e=Math.abs(t-pd(t)),r=br);br=r}function Bo(t){t.width?(t.wpx=uh(t.width),t.wch=fh(t.wpx),t.MDW=br):t.wpx?(t.wch=fh(t.wpx),t.width=Dp(t.wch),t.MDW=br):typeof t.wch=="number"&&(t.width=Dp(t.wch),t.wpx=uh(t.width),t.MDW=br),t.customWidth&&delete t.customWidth}var zF=96,DT=zF;function OT(t){return t*96/DT}function Ol(t){return t*DT/96}var HF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function $F(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Dr)||[]).forEach(function(a){var o=Oe(a);switch(ms(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=wt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=wt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function WF(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Dr)||[]).forEach(function(a){var o=Oe(a);switch(ms(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function GF(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Dr)||[]).forEach(function(a){var o=Oe(a);switch(ms(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?wt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?wt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?wt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?wt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?wt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?wt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?wt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=cg[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=wt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=ha[s.color.index];s.color.index==81&&(c=ha[1]),c||(c=ha[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=lh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function KF(t,e,r){e.NumberFmt=[];for(var n=hs(ze),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ze[n[s]];var i=t[0].match(Dr);if(i)for(s=0;s<i.length;++s){var a=Oe(i[s]);switch(ms(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(pt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}fa(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Ju=["numFmtId","fillId","fontId","borderId","xfId"],Zu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qF(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Dr)||[]).forEach(function(i){var a=Oe(i),o=0;switch(ms(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Ju.length;++o)n[Ju[o]]&&(n[Ju[o]]=parseInt(n[Ju[o]],10));for(o=0;o<Zu.length;++o)n[Zu[o]]&&(n[Zu[o]]=wt(n[Zu[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=wt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var XF=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&KF(h,f,l),(h=o.match(s))&&GF(h,f,c,l),(h=o.match(n))&&WF(h,f,c,l),(h=o.match(i))&&$F(h,f,c,l),(h=o.match(r))&&qF(h,f,l),f}}();function YF(t,e){var r=t.read_shift(2),n=Rr(t);return[r,n]}function QF(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=oP(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=aP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Rr(t),n}var JF=Nr;function ZF(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var eD=Nr;function tD(t,e,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return $s(t,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],fa(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=lh(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(f),a=!0;break;case 38:i.pop(),a=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var rD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nD(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Dr)||[]).forEach(function(s){var i=Oe(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[rD.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function sD(){}function iD(){}var aD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function lD(t,e,r){e.themeElements={};var n;[["clrScheme",aD,nD],["fontScheme",oD,sD],["fmtScheme",cD,iD]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var uD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function LT(t,e){(!t||t.length===0)&&(t=fD());var r,n={};if(!(r=t.match(uD)))throw new Error("themeElements not found in theme");return lD(r[0],n,e),n.raw=t,n}function fD(t,e){var r=[G2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hD(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=W2(i,{type:"array"})}catch{return}var o=nn(a,"theme/theme/theme1.xml",!0);if(o)return LT(o,r)}}function dD(t){return t.read_shift(4)}function pD(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=mD(t,4);break;case 2:e.xclrValue=ET(t);break;case 3:e.xclrValue=dD(t);break;case 4:t.l+=4;break}return t.l+=8,e}function mD(t,e){return Nr(t,e)}function gD(t,e){return Nr(t,e)}function vD(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=pD(t);break;case 6:n[1]=gD(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function xD(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(vD(t,r-t.l));return{ixfe:n,ext:i}}function _D(t,e){e.forEach(function(r){switch(r[0]){}})}function yD(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Rr(t)}}function ED(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function wD(t){return t.l+=4,t.read_shift(4)!=0}function TD(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return $s(t,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!l.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function kD(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Dr,function(o){var c=Oe(o);switch(ms(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function AD(t){var e=[];if(!t)return e;var r=1;return(t.match(Dr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function SD(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ue(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function ID(t,e,r){var n=[];return $s(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function CD(t,e,r,n){if(!t)return t;var s=n||{},i=!1;$s(t,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},s)}function RD(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function l_(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Mr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var c=Ot(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=tt(c);l!==t["!ref"]&&(t["!ref"]=l)}i.c||(i.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}i.c.push(f)})}function PD(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Oe(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Mr(c.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Ag(h[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function ND(t,e){var r=[],n=!1,s={},i=0;return t.replace(Dr,function(o,c){var l=Oe(o);switch(ms(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":s.t=t.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function FD(t,e){var r=[],n=!1;return t.replace(Dr,function(i){var a=Oe(i);switch(ms(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function DD(t){var e={};e.iauthor=t.read_shift(4);var r=Da(t);return e.rfx=r.s,e.ref=Ue(r.s),t.l+=16,e}var OD=Rr;function LD(t,e){var r=[],n=[],s={},i=!1;return $s(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var bD="application/vnd.ms-office.vbaProject";function MD(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,s,t.FileIndex[n].content)}}),et.write(e)}function VD(){return{"!type":"dialog"}}function UD(){return{"!type":"dialog"}}function BD(){return{"!type":"macro"}}function jD(){return{"!type":"macro"}}var Ao=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,c?l+=e.r:--l,s+(o?"":"$")+Qt(f)+(c?"":"$")+pr(l)}return function(s,i){return e=i,s.replace(t,r)}}(),bT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zD=function(){return function(e,r){return e.replace(bT,function(n,s,i,a,o,c){var l=_g(a)-(i?0:r.c),f=xg(c)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return s+"R"+h+"C"+d})}}();function MT(t,e){return t.replace(bT,function(r,n,s,i,a,o){return n+(s=="$"?s+i:Qt(_g(i)+e.c))+(a=="$"?a+o:pr(xg(o)+e.r))})}function HD(t,e,r){var n=Jo(e),s=n.s,i=Mr(r),a={r:i.r-s.r,c:i.c-s.c};return MT(t,a)}function $D(t){return t.length!=1}function u_(t){return t.replace(/_xlfn\./g,"")}function jt(t){t.l+=1}function Ni(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function VT(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return UT(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Ni(t),o=Ni(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function UT(t){var e=Ni(t),r=Ni(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function WD(t,e,r){if(r.biff<8)return UT(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Ni(t),a=Ni(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function BT(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return GD(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Ni(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function GD(t){var e=Ni(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function KD(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function qD(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return XD(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function XD(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function YD(t,e,r){var n=(t[t.l++]&96)>>5,s=VT(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function QD(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=VT(t,i,r);return[n,s,a]}function JD(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ZD(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function e6(t,e,r){var n=(t[t.l++]&96)>>5,s=WD(t,e-1,r);return[n,s]}function t6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function f_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function r6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function n6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function s6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function i6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function a6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function jT(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function o6(t){return t.read_shift(2),jT(t)}function c6(t){return t.read_shift(2),jT(t)}function l6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=BT(t,0,r);return[n,s]}function u6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=qD(t,0,r);return[n,s]}function f6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=BT(t,0,r);return[n,s,i]}function h6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[dO[s],$T[s],n]}function d6(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:p6(t);return[s,(i[0]===0?$T:hO)[i[1]]]}function p6(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function m6(t,e,r){t.l+=r&&r.biff==2?3:4}function g6(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function v6(t){return t.l++,Oa[t.read_shift(1)]}function x6(t){return t.l++,t.read_shift(2)}function _6(t){return t.l++,t.read_shift(1)!==0}function y6(t){return t.l++,Ir(t)}function E6(t,e,r){return t.l++,Jl(t,e-1,r)}function w6(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=bt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Oa[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ir(t);break;case 2:r[1]=La(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function T6(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Da:Jh)(t));return s}function k6(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=w6(t,r.biff);return a}function A6(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function S6(t,e,r){if(r.biff==5)return I6(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function I6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function C6(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function R6(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function P6(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function N6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var F6=Nr,D6=Nr,O6=Nr;function eu(t,e,r){return t.l+=2,[KD(t)]}function Ig(t){return t.l+=6,[]}var L6=eu,b6=Ig,M6=Ig,V6=eu;function zT(t){return t.l+=2,[$t(t),t.read_shift(2)&1]}var U6=eu,B6=zT,j6=Ig,z6=eu,H6=eu,$6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function W6(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=$6[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function G6(t){return t.l+=2,[t.read_shift(4)]}function K6(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function q6(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function X6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Y6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Q6(t){return t.l+=4,[0,0]}var h_={1:{n:"PtgExp",f:g6},2:{n:"PtgTbl",f:O6},3:{n:"PtgAdd",f:jt},4:{n:"PtgSub",f:jt},5:{n:"PtgMul",f:jt},6:{n:"PtgDiv",f:jt},7:{n:"PtgPower",f:jt},8:{n:"PtgConcat",f:jt},9:{n:"PtgLt",f:jt},10:{n:"PtgLe",f:jt},11:{n:"PtgEq",f:jt},12:{n:"PtgGe",f:jt},13:{n:"PtgGt",f:jt},14:{n:"PtgNe",f:jt},15:{n:"PtgIsect",f:jt},16:{n:"PtgUnion",f:jt},17:{n:"PtgRange",f:jt},18:{n:"PtgUplus",f:jt},19:{n:"PtgUminus",f:jt},20:{n:"PtgPercent",f:jt},21:{n:"PtgParen",f:jt},22:{n:"PtgMissArg",f:jt},23:{n:"PtgStr",f:E6},26:{n:"PtgSheet",f:K6},27:{n:"PtgEndSheet",f:q6},28:{n:"PtgErr",f:v6},29:{n:"PtgBool",f:_6},30:{n:"PtgInt",f:x6},31:{n:"PtgNum",f:y6},32:{n:"PtgArray",f:t6},33:{n:"PtgFunc",f:h6},34:{n:"PtgFuncVar",f:d6},35:{n:"PtgName",f:A6},36:{n:"PtgRef",f:l6},37:{n:"PtgArea",f:YD},38:{n:"PtgMemArea",f:C6},39:{n:"PtgMemErr",f:F6},40:{n:"PtgMemNoMem",f:D6},41:{n:"PtgMemFunc",f:R6},42:{n:"PtgRefErr",f:P6},43:{n:"PtgAreaErr",f:JD},44:{n:"PtgRefN",f:u6},45:{n:"PtgAreaN",f:e6},46:{n:"PtgMemAreaN",f:X6},47:{n:"PtgMemNoMemN",f:Y6},57:{n:"PtgNameX",f:S6},58:{n:"PtgRef3d",f:f6},59:{n:"PtgArea3d",f:QD},60:{n:"PtgRefErr3d",f:N6},61:{n:"PtgAreaErr3d",f:ZD},255:{}},J6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Z6={1:{n:"PtgElfLel",f:zT},2:{n:"PtgElfRw",f:z6},3:{n:"PtgElfCol",f:L6},6:{n:"PtgElfRwV",f:H6},7:{n:"PtgElfColV",f:V6},10:{n:"PtgElfRadical",f:U6},11:{n:"PtgElfRadicalS",f:j6},13:{n:"PtgElfColS",f:b6},15:{n:"PtgElfColSV",f:M6},16:{n:"PtgElfRadicalLel",f:B6},25:{n:"PtgList",f:W6},29:{n:"PtgSxName",f:G6},255:{}},eO={0:{n:"PtgAttrNoop",f:Q6},1:{n:"PtgAttrSemi",f:a6},2:{n:"PtgAttrIf",f:s6},4:{n:"PtgAttrChoose",f:r6},8:{n:"PtgAttrGoto",f:n6},16:{n:"PtgAttrSum",f:m6},32:{n:"PtgAttrBaxcel",f:f_},33:{n:"PtgAttrBaxcel",f:f_},64:{n:"PtgAttrSpace",f:o6},65:{n:"PtgAttrSpaceSemi",f:c6},128:{n:"PtgAttrIfError",f:i6},255:{}};function tu(t,e,r,n){if(n.biff<8)return Nr(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=k6(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=T6(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Nr(t,e)),i}function ru(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=h_[i]||h_[J6[i]],(i===24||i===25)&&(s=(i===24?Z6:eO)[t[t.l+1]]),!s||!s.f?Nr(t,e):a.push([s.n,s.f(t,e,r)]);return a}function tO(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var rO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nO(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function HT(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function d_(t,e,r){var n=HT(t,e,r);return n=="#REF"?n:nO(n,r)}function kr(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],c,l,f,h=0,d=0,m,g="";if(!t[0]||!t[0][0])return"";for(var v=-1,E="",T=0,w=t[0].length;T<w;++T){var x=t[0][T];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:E=Dt(" ",t[0][v][1][1]);break;case 1:E=Dt("\r",t[0][v][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}l=l+E,v=-1}o.push(l+rO[x[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Yc(x[1][1],a,s),o.push(Qc(f,i));break;case"PtgRefN":f=r?Yc(x[1][1],r,s):x[1][1],o.push(Qc(f,i));break;case"PtgRef3d":h=x[1][1],f=Yc(x[1][2],a,s),g=d_(n,h,s),o.push(g+"!"+Qc(f,i));break;case"PtgFunc":case"PtgFuncVar":var O=x[1][0],z=x[1][1];O||(O=0),O&=127;var B=O==0?[]:o.slice(-O);o.length-=O,z==="User"&&(z=B.shift()),o.push(z+"("+B.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":m=Kx(x[1][1],r?{s:r}:a,s),o.push(hd(m,s));break;case"PtgArea":m=Kx(x[1][1],a,s),o.push(hd(m,s));break;case"PtgArea3d":h=x[1][1],m=x[1][2],g=d_(n,h,s),o.push(g+"!"+hd(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var _=(n.names||[])[d-1]||(n[0]||[])[d],k=_?_.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!s.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var A=x[1][1];d=x[1][2];var I;if(s.biff<=5)A<0&&(A=-A),n[A]&&(I=n[A][d]);else{var R="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][d]&&n[A][d].itab>0&&(R=n.SheetNames[n[A][d].itab-1]+"!"):R=n.SheetNames[d-1]+"!"),n[A]&&n[A][d])R+=n[A][d].Name;else if(n[0]&&n[0][d])R+=n[0][d].Name;else{var C=(HT(n,A,s)||"").split(";;");C[d-1]?R=C[d-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",ye=")";if(v>=0){switch(E="",t[0][v][1][0]){case 2:N=Dt(" ",t[0][v][1][1])+N;break;case 3:N=Dt("\r",t[0][v][1][1])+N;break;case 4:ye=Dt(" ",t[0][v][1][1])+ye;break;case 5:ye=Dt("\r",t[0][v][1][1])+ye;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(N+o.pop()+ye);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Ue(f)]){var we=n.sharedf[Ue(f)];o.push(kr(we,a,he,n,s))}else{var ge=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(kr(l[1],a,he,n,s)),ge=!0;break}ge||o.push(x[1])}break;case"PtgArray":o.push("{"+tO(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ie.indexOf(t[0][T][0])==-1){x=t[0][v];var W=!0;switch(x[1][0]){case 4:W=!1;case 0:E=Dt(" ",x[1][1]);break;case 5:W=!1;case 1:E=Dt("\r",x[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((W?E:"")+o.pop()+(W?"":E)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function sO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Nr(t,e-2)];var o=ru(t,a,r);return e!==a+s&&(i=tu(t,e-a-s,o,r)),t.l=n,[o,i]}function iO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Nr(t,e-2)];var o=ru(t,a,r);return e!==a+s&&(i=tu(t,e-a-s,o,r)),t.l=n,[o,i]}function aO(t,e,r,n){var s=t.l+e,i=ru(t,n,r),a;return s!==t.l&&(a=tu(t,s-t.l,i,r)),[i,a]}function oO(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=ru(t,i,r);return i==65535?[[],Nr(t,e-2)]:(e!==i+2&&(s=tu(t,n-i-2,a,r)),[a,s])}function cO(t){var e;if(Ss(t,t.l+6)!==65535)return[Ir(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function md(t,e,r){var n=t.l+e,s=gs(t);r.biff==2&&++t.l;var i=cO(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=iO(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function Zh(t,e,r){var n=t.read_shift(4),s=ru(t,n,r),i=t.read_shift(4),a=i>0?tu(t,i,s,r):null;return[s,a]}var lO=Zh,e0=Zh,uO=Zh,fO=Zh,hO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$T={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function p_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function gd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var tl={},So={};function rl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function WT(t,e,r,n,s,i){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ir(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&fa(p3[e]||"General",e),t.t==="e")t.w=t.w||Oa[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Rl(t.v);else if(t.t==="d"){var a=Br(t.v);(a|0)===a?t.w=a.toString(10):t.w=Rl(a)}else{if(t.v===void 0)return"";t.w=_a(t.v,So)}else t.t==="d"?t.w=Sn(e,Br(t.v),So):t.w=Sn(e,t.v,So)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=lh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=lh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function pO(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=tt(r))}var mO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,gO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vO=/<(?:\w:)?hyperlink [^>]*>/mg,xO=/"(\w*:\w*)"/,_O=/<(?:\w:)?col\b[^>]*[\/]?>/g,yO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,EO=/<(?:\w:)?pageMargins[^>]*\/>/g,GT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,TO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kO(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",h=t.match(gO);h?(l=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):l=f=t;var d=l.match(GT);d?Cg(d[0],o,s,r):(d=l.match(wO))&&AO(d[0],d[1]||"",o,s,r);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=l.slice(m,m+50).match(xO);g&&pO(o,g[1])}var v=l.match(TO);v&&v[1]&&NO(v[1],s);var E=[];if(e.cellStyles){var T=l.match(_O);T&&CO(E,T)}h&&FO(h[1],o,e,c,i,a);var w=f.match(yO);w&&(o["!autofilter"]=RO(w[0]));var x=[],O=f.match(mO);if(O)for(m=0;m!=O.length;++m)x[m]=Ot(O[m].slice(O[m].indexOf('"')+1));var z=f.match(vO);z&&SO(o,z,n);var B=f.match(EO);if(B&&(o["!margins"]=IO(Oe(B[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=tt(c)),e.sheetRows>0&&o["!ref"]){var _=Ot(o["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(_))}return E.length>0&&(o["!cols"]=E),x.length>0&&(o["!merges"]=x),o}function Cg(t,e,r,n){var s=Oe(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=st(pt(s.codeName)))}function AO(t,e,r,n,s){Cg(t.slice(0,t.indexOf(">")),r,n,s)}function SO(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Oe(pt(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+st(i.location))):(i.Target="#"+st(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ot(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=Ue({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=i):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=i)}}}function IO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function CO(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Oe(e[n],!0);s.hidden&&(s.hidden=wt(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Sg(s.width)),Bo(s);i<=a;)t[i++]=dr(s)}}function RO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var PO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NO(t,e){e.Views||(e.Views=[{}]),(t.match(PO)||[]).forEach(function(r,n){var s=Oe(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),wt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var FO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Pl("v"),a=Pl("f");return function(c,l,f,h,d,m){for(var g=0,v="",E=[],T=[],w=0,x=0,O=0,z="",B,_,k=0,A=0,I,R,C=0,N=0,ye=Array.isArray(m.CellXf),he,we=[],ge=[],ie=Array.isArray(l),W=[],le={},Te=!1,M=!!f.sheetStubs,K=c.split(e),G=0,H=K.length;G!=H;++G){v=K[G].trim();var te=v.length;if(te!==0){var ue=0;e:for(g=0;g<te;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(_=Oe(v.slice(ue,g),!0),k=_.r!=null?parseInt(_.r,10):k+1,A=-1,f.sheetRows&&f.sheetRows<k)continue;le={},Te=!1,_.ht&&(Te=!0,le.hpt=parseFloat(_.ht),le.hpx=Ol(le.hpt)),_.hidden=="1"&&(Te=!0,le.hidden=!0),_.outlineLevel!=null&&(Te=!0,le.level=+_.outlineLevel),Te&&(W[k-1]=le)}break;case"<":ue=g;break}if(ue>=g)break;if(_=Oe(v.slice(ue,g),!0),k=_.r!=null?parseInt(_.r,10):k+1,A=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(le={},Te=!1,_.ht&&(Te=!0,le.hpt=parseFloat(_.ht),le.hpx=Ol(le.hpt)),_.hidden=="1"&&(Te=!0,le.hidden=!0),_.outlineLevel!=null&&(Te=!0,le.level=+_.outlineLevel),Te&&(W[k-1]=le)),E=v.slice(g).split(t);for(var ke=0;ke!=E.length&&E[ke].trim().charAt(0)=="<";++ke);for(E=E.slice(ke),g=0;g!=E.length;++g)if(v=E[g].trim(),v.length!==0){if(T=v.match(r),w=g,x=0,O=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,T!=null&&T.length===2){for(w=0,z=T[1],x=0;x!=z.length&&!((O=z.charCodeAt(x)-64)<1||O>26);++x)w=26*w+O;--w,A=w}else++A;for(x=0;x!=v.length&&v.charCodeAt(x)!==62;++x);if(++x,_=Oe(v.slice(0,x),!0),_.r||(_.r=Ue({r:k-1,c:A})),z=v.slice(x),B={t:""},(T=z.match(i))!=null&&T[1]!==""&&(B.v=st(T[1])),f.cellFormula){if((T=z.match(a))!=null&&T[1]!==""){if(B.f=st(pt(T[1])).replace(/\r\n/g,`
`),f.xlfn||(B.f=u_(B.f)),T[0].indexOf('t="array"')>-1)B.F=(z.match(s)||[])[1],B.F.indexOf(":")>-1&&we.push([Ot(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){R=Oe(T[0]);var de=st(pt(T[1]));f.xlfn||(de=u_(de)),ge[parseInt(R.si,10)]=[R,de,_.r]}}else(T=z.match(/<f[^>]*\/>/))&&(R=Oe(T[0]),ge[R.si]&&(B.f=HD(ge[R.si][1],ge[R.si][2],_.r)));var ae=Mr(_.r);for(x=0;x<we.length;++x)ae.r>=we[x][0].s.r&&ae.r<=we[x][0].e.r&&ae.c>=we[x][0].s.c&&ae.c<=we[x][0].e.c&&(B.F=we[x][1])}if(_.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(M)B.t="z";else continue;else B.t=_.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),B.t){case"n":if(B.v==""||B.v==null){if(!M)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!M)continue;B.t="z"}else I=tl[parseInt(B.v,10)],B.v=I.t,B.r=I.r,f.cellHTML&&(B.h=I.h);break;case"str":B.t="s",B.v=B.v!=null?pt(B.v):"",f.cellHTML&&(B.h=mg(B.v));break;case"inlineStr":T=z.match(n),B.t="s",T!=null&&(I=Ag(T[1]))?(B.v=I.t,f.cellHTML&&(B.h=I.h)):B.v="";break;case"b":B.v=wt(B.v);break;case"d":f.cellDates?B.v=ir(B.v,1):(B.v=Br(ir(B.v,1)),B.t="n");break;case"e":(!f||f.cellText!==!1)&&(B.w=B.v),B.v=dT[B.v];break}if(C=N=0,he=null,ye&&_.s!==void 0&&(he=m.CellXf[_.s],he!=null&&(he.numFmtId!=null&&(C=he.numFmtId),f.cellStyles&&he.fillId!=null&&(N=he.fillId))),WT(B,C,N,f,d,m),f.cellDates&&ye&&B.t=="n"&&Qo(ze[C])&&(B.t="d",B.v=Qh(B.v)),_.cm&&f.xlmeta){var Le=(f.xlmeta.Cell||[])[+_.cm-1];Le&&Le.type=="XLDAPR"&&(B.D=!0)}if(ie){var j=Mr(_.r);l[j.r]||(l[j.r]=[]),l[j.r][j.c]=B}else l[_.r]=B}}}}W.length>0&&(l["!rows"]=W)}}();function DO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var OO=Da;function LO(){}function bO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=sP(t),r}function MO(t){var e=In(t);return[e]}function VO(t){var e=Fa(t);return[e]}function UO(t){var e=In(t),r=t.read_shift(1);return[e,r,"b"]}function BO(t){var e=Fa(t),r=t.read_shift(1);return[e,r,"b"]}function jO(t){var e=In(t),r=t.read_shift(1);return[e,r,"e"]}function zO(t){var e=Fa(t),r=t.read_shift(1);return[e,r,"e"]}function HO(t){var e=In(t),r=t.read_shift(4);return[e,r,"s"]}function $O(t){var e=Fa(t),r=t.read_shift(4);return[e,r,"s"]}function WO(t){var e=In(t),r=Ir(t);return[e,r,"n"]}function KT(t){var e=Fa(t),r=Ir(t);return[e,r,"n"]}function GO(t){var e=In(t),r=wg(t);return[e,r,"n"]}function KO(t){var e=Fa(t),r=wg(t);return[e,r,"n"]}function qO(t){var e=In(t),r=yg(t);return[e,r,"is"]}function XO(t){var e=In(t),r=Rr(t);return[e,r,"str"]}function YO(t){var e=Fa(t),r=Rr(t);return[e,r,"str"]}function QO(t,e,r){var n=t.l+e,s=In(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=e0(t,n-t.l,r);a[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return a}function JO(t,e,r){var n=t.l+e,s=In(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=e0(t,n-t.l,r);a[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return a}function ZO(t,e,r){var n=t.l+e,s=In(t);s.r=r["!row"];var i=Ir(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=e0(t,n-t.l,r);a[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return a}function e8(t,e,r){var n=t.l+e,s=In(t);s.r=r["!row"];var i=Rr(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=e0(t,n-t.l,r);a[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return a}var t8=Da;function r8(t,e){var r=t.l+e,n=Da(t),s=Eg(t),i=Rr(t),a=Rr(t),o=Rr(t);t.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function n8(){}function s8(t,e,r){var n=t.l+e,s=uT(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=lO(t,n-t.l,r);a[1]=o}else t.l=n;return a}function i8(t,e,r){var n=t.l+e,s=Da(t),i=[s];if(r.cellFormula){var a=fO(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var a8=["left","right","top","bottom","header","footer"];function o8(t){var e={};return a8.forEach(function(r){e[r]=Ir(t)}),e}function c8(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function l8(){}function u8(){}function f8(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,g,v,E,T,w,x,O,z,B=[];o.biff=12,o["!row"]=0;var _=0,k=!1,A=[],I={},R=o.supbooks||s.supbooks||[[]];if(R.sharedf=I,R.arrayf=A,R.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=R,s.Names))for(var C=0;C<s.Names.length;++C)R[0][C+1]=s.Names[C];var N=[],ye=[],he=!1;hh[16]={n:"BrtShortReal",f:KT};var we;if($s(t,function(W,le,Te){if(!d)switch(Te){case 148:l=W;break;case 0:m=W,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),O=pr(E=m.r),o["!row"]=m.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Ol(W.hpt)),ye[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:W[2]},W[2]){case"n":g.v=W[1];break;case"s":x=tl[W[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!W[1];break;case"e":g.v=W[1],o.cellText!==!1&&(g.w=Oa[g.v]);break;case"str":g.t="s",g.v=W[1];break;case"is":g.t="s",g.v=W[1].t;break}if((v=a.CellXf[W[0].iStyleRef])&&WT(g,v.numFmtId,null,o,i,a),T=W[0].c==-1?T+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][T]=g):c[Qt(T)+O]=g,o.cellFormula){for(k=!1,_=0;_<A.length;++_){var M=A[_];m.r>=M[0].s.r&&m.r<=M[0].e.r&&T>=M[0].s.c&&T<=M[0].e.c&&(g.F=tt(M[0]),k=!0)}!k&&W.length>3&&(g.f=W[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),o.cellDates&&v&&g.t=="n"&&Qo(ze[v.numFmtId])){var K=aa(g.v);K&&(g.t="d",g.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}we&&(we.type=="XLDAPR"&&(g.D=!0),we=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},T=W[0].c==-1?T+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][T]=g):c[Qt(T)+O]=g,f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),we&&(we.type=="XLDAPR"&&(g.D=!0),we=void 0);break;case 176:B.push(W);break;case 49:we=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var G=n["!id"][W.relId];for(G?(W.Target=G.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=G):W.relId==""&&(W.Target="#"+W.loc),E=W.rfx.s.r;E<=W.rfx.e.r;++E)for(T=W.rfx.s.c;T<=W.rfx.e.c;++T)o.dense?(c[E]||(c[E]=[]),c[E][T]||(c[E][T]={t:"z",v:void 0}),c[E][T].l=W):(w=Ue({c:T,r:E}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=W);break;case 426:if(!o.cellFormula)break;A.push(W),z=o.dense?c[E][T]:c[Qt(T)+O],z.f=kr(W[1],f,{r:m.r,c:T},R,o),z.F=tt(W[0]);break;case 427:if(!o.cellFormula)break;I[Ue(W[0].s)]=W[1],z=o.dense?c[E][T]:c[Qt(T)+O],z.f=kr(W[1],f,{r:m.r,c:T},R,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)N[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},he||(he=!0,Sg(W.w/256)),Bo(N[W.e+1]);break;case 161:c["!autofilter"]={ref:tt(W)};break;case 476:c["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!le.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=tt(l||f)),o.sheetRows&&c["!ref"]){var ge=Ot(c["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>f.e.r&&(ge.e.r=f.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>f.e.c&&(ge.e.c=f.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),c["!fullref"]=c["!ref"],c["!ref"]=tt(ge))}return B.length>0&&(c["!merges"]=B),N.length>0&&(c["!cols"]=N),ye.length>0&&(c["!rows"]=ye),c}function h8(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=st((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function d8(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=h8(h);f.s.r=f.s.c=0,f.e.c=o,l=Qt(o),d[0].forEach(function(m,g){a[l+pr(g)]={t:"n",v:m,z:d[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(a["!ref"]=tt(f)),a}function p8(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(GT);return o&&Cg(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function m8(t,e){t.l+=10;var r=Rr(t);return{name:r}}function g8(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return $s(t,function(c,l,f){switch(f){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var qT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],v8=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],x8=[],_8=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function m_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=wt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function g_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=wt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XT(t){g_(t.WBProps,qT),g_(t.CalcPr,_8),m_(t.WBView,v8),m_(t.Sheets,x8),So.date1904=wt(t.WBProps.date1904)}var y8="][*?/\\".split("");function E8(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return y8.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var w8=/<\w+:workbook/;function T8(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Dr,function(c,l){var f=Oe(c);switch(ms(f[0])){case"<?xml":break;case"<workbook":c.match(w8)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qT.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=wt(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=pt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=st(pt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=pt(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),wt(f.hidden||"0")&&(i.Hidden=!0),a=l+c.length;break;case"</definedName>":i.Ref=st(pt(t.slice(a,l))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),j3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XT(r),r}function k8(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pp(t),r.name=Rr(t),r}function A8(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Rr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function S8(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function I8(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=iP(t),a=uO(t,0,r),o=Eg(t);t.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function C8(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],hh[16]={n:"BrtFRTArchID$",f:S8},$s(t,function(c,l,f){switch(f){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=kr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,c]):a[0]=[f,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!l.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),XT(r),r.Names=i,r.supbooks=a,r}function R8(t,e,r){return e.slice(-4)===".bin"?C8(t,r):T8(t,r)}function P8(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?f8(t,n,r,s,i,a,o):kO(t,n,r,s,i,a,o)}function N8(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?g8(t,n,r,s,i):p8(t,n,r,s,i)}function F8(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?BD():jD()}function D8(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?VD():UD()}function O8(t,e,r,n){return e.slice(-4)===".bin"?tD(t,r,n):XF(t,r,n)}function L8(t,e,r){return LT(t,r)}function b8(t,e,r){return e.slice(-4)===".bin"?vF(t,r):mF(t,r)}function M8(t,e,r){return e.slice(-4)===".bin"?LD(t,r):PD(t,r)}function V8(t,e,r){return e.slice(-4)===".bin"?ID(t):AD(t)}function U8(t,e,r,n){return r.slice(-4)===".bin"?CD(t,e,r,n):void 0}function B8(t,e,r){return e.slice(-4)===".bin"?TD(t,e,r):kD(t,e,r)}var YT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,QT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(YT),i,a,o,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(QT),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function j8(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(YT),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(QT),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var nl;function z8(t,e){var r=nl[t]||st(t);return r==="General"?_a(e):Sn(r,e)}function H8(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=wt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=ir(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[st(e)]=s}function $8(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Oa[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Rl(t.v):t.w=_a(t.v):t.w=z8(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=nl[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Qo(n)){var s=aa(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function W8(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=HF[n.Pattern]||n.Pattern)}t[e.ID]=e}function G8(t,e,r,n,s,i,a,o,c,l){var f="General",h=n.StyleID,d={};l=l||{};var m=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&m.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wt(t);break;case"String":n.t="s",n.r=Vx(st(t)),n.v=t.indexOf("<")>-1?st(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ir(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dT[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Vx(e||t));break}if($8(n,f,l),l.cellFormula!==!1)if(n.Formula){var v=st(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Ao(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ao("RC:RC",s):n.ArrayRange&&(n.F=Ao(n.ArrayRange,s),c.push([Ot(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(m.forEach(function(E){!d.patternType&&E.patternType&&(d.patternType=E.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function K8(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vd(t,e){var r=e||{};U2();var n=Pc(gg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=dr(r);return a.type="string",Fl.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(mt){s.indexOf("<"+mt)>=0&&(i=!0)}),i)return rL(n,r);nl={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},h=[],d=r.dense?[]:{},m="",g={},v={},E=Pn('<Data ss:Type="String">'),T=0,w=0,x=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},B={},_="",k=0,A=[],I={},R={},C=0,N=[],ye=[],he={},we=[],ge,ie=!1,W=[],le=[],Te={},M=0,K=0,G={Sheets:[],WBProps:{date1904:!1}},H={};Nl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=Nl.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?G8(n.slice(T,o.index),_,E,c[c.length-1][0]=="comment"?he:g,{c:w,r:x},z,we[w],v,W,r):(_="",E=Pn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ye.length>0&&(g.c=ye),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(d[x]||(d[x]=[]),d[x][w]=g):d[Qt(w)+pr(x)]=g),g.HRef&&(g.l={Target:st(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(M=w+(parseInt(g.MergeAcross,10)|0),K=x+(parseInt(g.MergeDown,10)|0),A.push({s:{c:w,r:x},e:{c:M,r:K}})),!r.sheetStubs)g.MergeAcross?w=M+1:++w;else if(g.MergeAcross||g.MergeDown){for(var ue=w;ue<=M;++ue)for(var ke=x;ke<=K;++ke)(ue>w||ke>x)&&(r.dense?(d[ke]||(d[ke]=[]),d[ke][ue]={t:"z"}):d[Qt(ue)+pr(ke)]={t:"z"});w=M+1}else++w;else g=j8(o[0]),g.Index&&(w=+g.Index-1),w<O.s.c&&(O.s.c=w),w>O.e.c&&(O.e.c=w),o[0].slice(-2)==="/>"&&++w,ye=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<O.s.r&&(O.s.r=x),x>O.e.r&&(O.e.r=x),o[0].slice(-2)==="/>"&&(v=Pn(o[0]),v.Index&&(x=+v.Index-1)),w=0,++x):(v=Pn(o[0]),v.Index&&(x=+v.Index-1),Te={},(v.AutoFitHeight=="0"||v.Height)&&(Te.hpx=parseInt(v.Height,10),Te.hpt=OT(Te.hpx),le[x]=Te),v.Hidden=="1"&&(Te.hidden=!0,le[x]=Te));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(d["!ref"]=tt(O),r.sheetRows&&r.sheetRows<=O.e.r&&(d["!fullref"]=d["!ref"],O.e.r=r.sheetRows-1,d["!ref"]=tt(O))),A.length&&(d["!merges"]=A),we.length>0&&(d["!cols"]=we),le.length>0&&(d["!rows"]=le),f[m]=d}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,c.push([o[3],!1]),l=Pn(o[0]),m=st(l.Name),d=r.dense?[]:{},A=[],W=[],le=[],H={name:m,Hidden:0},G.Sheets.push(H);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),we=[],ie=!1}break;case"style":o[1]==="/"?W8(z,B,r):B=Pn(o[0]);break;case"numberformat":B.nf=st(Pn(o[0]).Format||"General"),nl[B.nf]&&(B.nf=nl[B.nf]);for(var de=0;de!=392&&ze[de]!=B.nf;++de);if(de==392){for(de=57;de!=392;++de)if(ze[de]==null){fa(B.nf,de);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ge=Pn(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!ie&&ge.wpx>10){ie=!0,br=FT;for(var ae=0;ae<we.length;++ae)we[ae]&&Bo(we[ae])}ie&&Bo(ge),we[ge.Index-1||we.length]=ge;for(var Le=0;Le<+ge.Span;++Le)we[we.length]=dr(ge);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var j=Oe(o[0]),at={Name:j.Name,Ref:Ao(j.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(at.Sheet=G.Sheets.length-1),G.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Pn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?PP(I,te,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));K8(he),ye.push(he)}else c.push([o[3],!1]),l=Pn(o[0]),he={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=Pn(o[0]);d["!autofilter"]={ref:Ao($e.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return w_(n,r);var Xe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else C=o.index+o[0].length;break;case"header":d["!margins"]||rl(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].header=+Oe(o[0]).Margin);break;case"footer":d["!margins"]||rl(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var je=Oe(o[0]);d["!margins"]||rl(d["!margins"]={},"xlml"),isNaN(+je.Top)||(d["!margins"].top=+je.Top),isNaN(+je.Left)||(d["!margins"].left=+je.Left),isNaN(+je.Right)||(d["!margins"].right=+je.Right),isNaN(+je.Bottom)||(d["!margins"].bottom=+je.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?H8(R,te,N,n.slice(C,o.index)):(N=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ve={};return!r.bookSheets&&!r.bookProps&&(ve.Sheets=f),ve.SheetNames=h,ve.Workbook=G,ve.SSF=dr(ze),ve.Props=I,ve.Custprops=R,ve}function Op(t,e){switch(Ng(e=e||{}),e.type||"base64"){case"base64":return vd(un(t),e);case"binary":case"buffer":case"file":return vd(t,e);case"array":return vd(Na(t),e)}}function q8(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=cP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=lP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var X8=[60,1084,2066,2165,2175];function Y8(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var c=Ss(r,r.l),l=Lp[c],f=0;l!=null&&X8.indexOf(c)>-1;)i=Ss(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),a.push(o),r.l+=4+i,l=Lp[c=Ss(r,r.l)];var h=si(a);ur(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function Qn(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Oa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Rl(t.v):t.w=_a(t.v):t.w=Sn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Qo(ze[n]||String(n))){var s=aa(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function ef(t,e,r){return{v:t,ixfe:e,t:r}}function Q8(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,c=[],l="",f={},h,d="",m,g,v,E,T={},w=[],x,O,z=[],B=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},A=function(He){return He<8?ha[He]:He<64&&B[He-8]||ha[He]},I=function(He,kt,er){var Pt=kt.XF.data;if(!(!Pt||!Pt.patternType||!er||!er.cellStyles)){kt.s={},kt.s.patternType=Pt.patternType;var qn;(qn=Dl(A(Pt.icvFore)))&&(kt.s.fgColor={rgb:qn}),(qn=Dl(A(Pt.icvBack)))&&(kt.s.bgColor={rgb:qn})}},R=function(He,kt,er){if(!(Te>1)&&!(er.sheetRows&&He.r>=er.sheetRows)){if(er.cellStyles&&kt.XF&&kt.XF.data&&I(He,kt,er),delete kt.ixfe,delete kt.XF,h=He,d=Ue(He),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),He.r<a.s.r&&(a.s.r=He.r),He.c<a.s.c&&(a.s.c=He.c),He.r+1>a.e.r&&(a.e.r=He.r+1),He.c+1>a.e.c&&(a.e.c=He.c+1),er.cellFormula&&kt.f){for(var Pt=0;Pt<w.length;++Pt)if(!(w[Pt][0].s.c>He.c||w[Pt][0].s.r>He.r)&&!(w[Pt][0].e.c<He.c||w[Pt][0].e.r<He.r)){kt.F=tt(w[Pt][0]),(w[Pt][0].s.c!=He.c||w[Pt][0].s.r!=He.r)&&delete kt.f,kt.f&&(kt.f=""+kr(w[Pt][1],a,He,W,C));break}}er.dense?(s[He.r]||(s[He.r]=[]),s[He.r][He.c]=kt):s[d]=kt}},C={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var N,ye=[],he=[],we=[],ge=[],ie=!1,W=[];W.SheetNames=C.snames,W.sharedf=C.sharedf,W.arrayf=C.arrayf,W.names=[],W.XTI=[];var le=0,Te=0,M=0,K=[],G=[],H;C.codepage=1200,bn(1200);for(var te=!1;t.l<t.length-1;){var ue=t.l,ke=t.read_shift(2);if(ke===0&&le===10)break;var de=t.l===t.length?0:t.read_shift(2),ae=Lp[ke];if(ae&&ae.f){if(e.bookSheets&&le===133&&ke!==133)break;if(le=ke,ae.r===2||ae.r==12){var Le=t.read_shift(2);if(de-=2,!C.enc&&Le!==ke&&((Le&255)<<8|Le>>8)!==ke)throw new Error("rt mismatch: "+Le+"!="+ke);ae.r==12&&(t.l+=10,de-=10)}var j={};if(ke===10?j=ae.f(t,de,C):j=Y8(ke,ae,t,de,C),Te==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(ke){case 34:r.opts.Date1904=_.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=j;break;case 66:var at=Number(j);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}bn(C.codepage=at),te=!0;break;case 317:C.rrtabid=j;break;case 25:C.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:C.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:z.push(j);break;case 430:W.push([j]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(j);break;case 24:case 536:H={Name:j.Name,Ref:kr(j.rgce,a,null,W,C)},j.itab>0&&(H.Sheet=j.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(G[j.itab-1]={ref:tt(j.rgce[0][0][1][2])});break;case 22:C.ExternCount=j;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(j),W.XTI=W.XTI.concat(j);break;case 2196:if(C.biff<8)break;H!=null&&(H.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&C.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,C.snames.push(j.name);break;case 10:{if(--Te)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var $e=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=tt(a),a.e.r=$e}a.e.r++,a.e.c++}ye.length>0&&(s["!merges"]=ye),he.length>0&&(s["!objects"]=he),we.length>0&&(s["!cols"]=we),ge.length>0&&(s["!rows"]=ge),_.Sheets.push(k)}l===""?f=s:n[l]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),C.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(C.biff=5,te=!0,bn(C.codepage=28591)),C.biff==8&&j.BIFFVer==0&&j.dt==16&&(C.biff=2),Te++)break;if(s=e.dense?[]:{},C.biff<8&&!te&&(te=!0,bn(C.codepage=e.codepage||1252)),C.biff<5||j.BIFFVer==0&&j.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:t.l-de,name:l};i[Xe.pos]=Xe,C.snames.push(l)}else l=(i[ue]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),ye=[],he=[],C.arrayf=w=[],we=[],ge=[],ie=!1,k={Hidden:(i[ue]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[j.r]||[])[j.c]:s[Ue({c:j.c,r:j.r})])&&++j.c,x={ixfe:j.ixfe,XF:z[j.ixfe]||{},v:j.val,t:"n"},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e);break;case 5:case 517:x={ixfe:j.ixfe,XF:z[j.ixfe],v:j.val,t:j.t},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e);break;case 638:x={ixfe:j.ixfe,XF:z[j.ixfe],v:j.rknum,t:"n"},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e);break;case 189:for(var je=j.c;je<=j.C;++je){var ve=j.rkrec[je-j.c][0];x={ixfe:ve,XF:z[ve],v:j.rkrec[je-j.c][1],t:"n"},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:je,r:j.r},x,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(x=ef(j.val,j.cell.ixfe,j.tt),x.XF=z[x.ixfe],e.cellFormula){var mt=j.formula;if(mt&&mt[0]&&mt[0][0]&&mt[0][0][0]=="PtgExp"){var re=mt[0][0][1][0],_e=mt[0][0][1][1],Ce=Ue({r:re,c:_e});T[Ce]?x.f=""+kr(j.formula,a,j.cell,W,C):x.F=((e.dense?(s[re]||[])[_e]:s[Ce])||{}).F}else x.f=""+kr(j.formula,a,j.cell,W,C)}M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R(j.cell,x,e),o=j}break;case 7:case 519:if(o)o.val=j,x=ef(j,o.cell.ixfe,"s"),x.XF=z[x.ixfe],e.cellFormula&&(x.f=""+kr(o.formula,a,o.cell,W,C)),M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R(o.cell,x,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(j);var Re=Ue(j[0].s);if(m=e.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[Re],e.cellFormula&&m){if(!o||!Re||!m)break;m.f=""+kr(j[1],a,j[0],W,C),m.F=tt(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Ue(o.cell)]=j[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(m||{}).f=""+kr(j[0],a,h,W,C)}}break;case 253:x=ef(c[j.isst].t,j.ixfe,"s"),c[j.isst].h&&(x.h=c[j.isst].h),x.XF=z[x.ixfe],M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:j.ixfe,XF:z[j.ixfe],t:"z"},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e));break;case 190:if(e.sheetStubs)for(var De=j.c;De<=j.C;++De){var Ve=j.ixfe[De-j.c];x={ixfe:Ve,XF:z[Ve],t:"z"},M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:De,r:j.r},x,e)}break;case 214:case 516:case 4:x=ef(j.val,j.ixfe,"s"),x.XF=z[x.ixfe],M>0&&(x.z=K[x.ixfe>>8&63]),Qn(x,e,r.opts.Date1904),R({c:j.c,r:j.r},x,e);break;case 0:case 512:Te===1&&(a=j);break;case 252:c=j;break;case 1054:if(C.biff==4){K[M++]=j[1];for(var rt=0;rt<M+163&&ze[rt]!=j[1];++rt);rt>=163&&fa(j[1],M+163)}else fa(j[1],j[0]);break;case 30:{K[M++]=j;for(var Ye=0;Ye<M+163&&ze[Ye]!=j;++Ye);Ye>=163&&fa(j,M+163)}break;case 229:ye=ye.concat(j);break;case 93:he[j.cmo[0]]=C.lastobj=j;break;case 438:C.lastobj.TxO=j;break;case 127:C.lastobj.ImData=j;break;case 440:for(E=j[0].s.r;E<=j[0].e.r;++E)for(v=j[0].s.c;v<=j[0].e.c;++v)m=e.dense?(s[E]||[])[v]:s[Ue({c:v,r:E})],m&&(m.l=j[1]);break;case 2048:for(E=j[0].s.r;E<=j[0].e.r;++E)for(v=j[0].s.c;v<=j[0].e.c;++v)m=e.dense?(s[E]||[])[v]:s[Ue({c:v,r:E})],m&&m.l&&(m.l.Tooltip=j[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;m=e.dense?(s[j[0].r]||[])[j[0].c]:s[Ue(j[0])];var gt=he[j[2]];m||(e.dense?(s[j[0].r]||(s[j[0].r]=[]),m=s[j[0].r][j[0].c]={t:"z"}):m=s[Ue(j[0])]={t:"z"},a.e.r=Math.max(a.e.r,j[0].r),a.s.r=Math.min(a.s.r,j[0].r),a.e.c=Math.max(a.e.c,j[0].c),a.s.c=Math.min(a.s.c,j[0].c)),m.c||(m.c=[]),g={a:j[1],t:gt.TxO.t},m.c.push(g)}break;case 2173:_D(z[j.ixfe],j.ext);break;case 125:{if(!C.cellStyles)break;for(;j.e>=j.s;)we[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ie||(ie=!0,Sg(j.w/256)),Bo(we[j.e+1])}break;case 520:{var Rt={};j.level!=null&&(ge[j.r]=Rt,Rt.level=j.level),j.hidden&&(ge[j.r]=Rt,Rt.hidden=!0),j.hpt&&(ge[j.r]=Rt,Rt.hpt=j.hpt,Rt.hpx=Ol(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||rl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=j;break;case 161:s["!margins"]||rl(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(_.Views[0].RTL=!0);break;case 146:B=j;break;case 2198:N=j;break;case 140:O=j;break;case 442:l?k.CodeName=j||k.name:_.WBProps.CodeName=j||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=de}return r.SheetNames=hs(i).sort(function(Jr,He){return Number(Jr)-Number(He)}).map(function(Jr){return i[Jr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&G.forEach(function(Jr,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=Jr}),r.Strings=c,r.SSF=dr(ze),C.enc&&(r.Encryption=C.enc),N&&(r.Themes=N),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),W.names.length>0&&(_.Names=W.names),r.Workbook=_,r}var v_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function J8(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=e_(n,mP,v_.DSI);for(var i in s)e[i]=s[i]}catch(l){if(r.WTF)throw l}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=e_(a,gP,v_.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(mT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function JT(t,e){e||(e={}),Ng(e),I2(),e.codepage&&lg(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=Ln(un(t));break;case"binary":t=Ln(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ur(t,0),n={content:t}}var s,i;if(r&&q8(r),e.bookProps&&!e.bookSheets)s={};else{var a=Qe?"buffer":"array";if(n&&n.content)s=Q8(n.content,e);else if((i=et.find(t,"PerfectOffice_MAIN"))&&i.content)s=el.to_workbook(i.content,(e.type=a,e));else if((i=et.find(t,"NativeContent_MAIN"))&&i.content)s=el.to_workbook(i.content,(e.type=a,e));else throw(i=et.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=MD(t))}var o={};return t.FullPaths&&J8(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var hh={0:{f:DO},1:{f:MO},2:{f:GO},3:{f:jO},4:{f:UO},5:{f:WO},6:{f:XO},7:{f:HO},8:{f:e8},9:{f:ZO},10:{f:QO},11:{f:JO},12:{f:VO},13:{f:KO},14:{f:zO},15:{f:BO},16:{f:KT},17:{f:YO},18:{f:$O},19:{f:yg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:I8},40:{},42:{},43:{f:QF},44:{f:YF},45:{f:JF},46:{f:eD},47:{f:ZF},48:{},49:{f:tP},50:{},51:{f:ED},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:IT},62:{f:qO},63:{f:SD},64:{f:l8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:c8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bO},148:{f:OO,p:16},151:{f:n8},152:{},153:{f:A8},154:{},155:{},156:{f:k8},157:{},158:{},159:{T:1,f:gF},160:{T:-1},161:{T:1,f:Da},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:t8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yD},336:{T:-1},337:{f:wD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ST},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:s8},427:{f:i8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:o8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:r8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OD},633:{T:1},634:{T:-1},635:{T:1,f:DD},636:{T:-1},637:{f:nP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:m8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:u8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Lp={6:{f:md},10:{f:Qs},12:{f:$t},13:{f:$t},14:{f:bt},15:{f:bt},16:{f:Ir},17:{f:bt},18:{f:bt},19:{f:$t},20:{f:s_},21:{f:s_},23:{f:ST},24:{f:a_},25:{f:bt},26:{},27:{},28:{f:NN},29:{},34:{f:bt},35:{f:i_},38:{f:Ir},39:{f:Ir},40:{f:Ir},41:{f:Ir},42:{f:bt},43:{f:bt},47:{f:LF},49:{f:hN},51:{f:$t},60:{},61:{f:lN},64:{f:bt},65:{f:fN},66:{f:$t},77:{},80:{},81:{},82:{},85:{f:$t},89:{},90:{},91:{},92:{f:tN},93:{f:DN},94:{},95:{f:bt},96:{},97:{},99:{f:bt},125:{f:IT},128:{f:wN},129:{f:rN},130:{f:$t},131:{f:bt},132:{f:bt},133:{f:nN},134:{},140:{f:UN},141:{f:$t},144:{},146:{f:jN},151:{},152:{},153:{},154:{},155:{},156:{f:$t},157:{},158:{},160:{f:GN},161:{f:HN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xN},190:{f:_N},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$t},220:{},221:{f:bt},222:{},224:{f:EN},225:{f:eN},226:{f:Qs},227:{},229:{f:FN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:sN},253:{f:dN},255:{f:iN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bt},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kN},431:{f:bt},432:{},433:{},434:{},437:{},438:{f:bN},439:{f:bt},440:{f:MN},441:{},442:{f:Zl},443:{},444:{f:$t},445:{},446:{},448:{f:Qs},449:{f:cN,r:2},450:{f:Qs},512:{f:r_},513:{f:WN},515:{f:TN},516:{f:pN},517:{f:n_},519:{f:KN},520:{f:aN},523:{},545:{f:o_},549:{f:t_},566:{},574:{f:uN},638:{f:vN},659:{},1048:{},1054:{f:mN},1084:{},1212:{f:CN},2048:{f:VN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:zN,r:12},2173:{f:xD,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:IN,r:12},2197:{},2198:{f:hD,r:12},2199:{},2200:{},2201:{},2202:{f:RN,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:oN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$t},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:$N},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:BN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:r_},1:{},2:{f:QN},3:{f:YN},4:{f:XN},5:{f:n_},7:{f:JN},8:{},9:{f:Qu},11:{},22:{f:$t},30:{f:gN},31:{},32:{},33:{f:o_},36:{},37:{f:t_},50:{f:ZN},62:{},52:{},67:{},68:{f:$t},69:{},86:{},126:{},127:{f:qN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eF},223:{},234:{},354:{},421:{},518:{f:md},521:{f:Qu},536:{f:a_},547:{f:i_},561:{},579:{},1030:{f:md},1033:{f:Qu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Nn(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&oT(r)&&t.push(r)}}function x_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,c=T3(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var v=c[a].trim(),E=v.slice(0,3).toLowerCase();if(E=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(E!="<td"&&E!="<th")){var T=v.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var w=T[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,O=0;x.charAt(0)=="<"&&(O=x.indexOf(">"))>-1;)x=x.slice(O+1);for(var z=0;z<g.length;++z){var B=g[z];B.s.c==f&&B.s.r<l&&l<=B.e.r&&(f=B.e.c+1,z=-1)}var _=Oe(w.slice(0,w.indexOf(">")));d=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||d>1)&&g.push({s:{r:l,c:f},e:{r:l+(h||1)-1,c:f+d-1}});var k=_.t||_["data-t"]||"";if(!x.length){f+=d;continue}if(x=q2(x),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!x.length){f+=d;continue}var A={t:"s",v:x};r.raw||!x.trim().length||k=="s"||(x==="TRUE"?A={t:"b",v:!0}:x==="FALSE"?A={t:"b",v:!1}:isNaN(jn(x))?isNaN(Uo(x).getDate())||(A={t:"d",v:ir(x)},r.cellDates||(A={t:"n",v:Br(A.v)}),A.z=r.dateNF||ze[14]):A={t:"n",v:jn(x)}),r.dense?(n[l]||(n[l]=[]),n[l][f]=A):n[Ue({r:l,c:f})]=A,f+=d}}}}return n["!ref"]=tt(m),g.length&&(n["!merges"]=g),n}function Z8(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<s.length;++l)if(!(s[l].s.r>r||s[l].s.c>a)&&!(s[l].e.r<r||s[l].e.c<a)){if(s[l].s.r<r||s[l].s.c<a){o=-1;break}o=s[l].e.r-s[l].s.r+1,c=s[l].e.c-s[l].s.c+1;break}if(!(o<0)){var f=Ue({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||mg(h.w||(Vs(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,i.push(U3("td",d,m))}}var g="<tr>";return g+i.join("")+"</tr>"}var eL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tL="</body></html>";function rL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return zi(x_(r[0],e),e);var n=Dg();return r.forEach(function(s,i){Og(n,x_(s,e),"Sheet"+(i+1))}),n}function nL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sL(t,e){var r=e||{},n=r.header!=null?r.header:eL,s=r.footer!=null?r.footer:tL,i=[n],a=Jo(t["!ref"]);r.dense=Array.isArray(t),i.push(nL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(Z8(t,a,o,r));return i.push("</table>"+s),i.join("")}function ZT(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Mr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var f=Jo(t["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),s==-1&&(l.e.r=s=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),g=0,v=0,E=0,T=0,w=0,x=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&v<c;++g){var O=o[g];if(__(O)){if(n.display)continue;m[v]={hidden:!0}}var z=O.children;for(E=T=0;E<z.length;++E){var B=z[E];if(!(n.display&&__(B))){var _=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):q2(B.innerHTML),k=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<h.length;++d){var A=h[d];A.s.c==T+i&&A.s.r<v+s&&v+s<=A.e.r&&(T=A.e.c+1-i,d=-1)}x=+B.getAttribute("colspan")||1,((w=+B.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:v+s,c:T+i},e:{r:v+s+(w||1)-1,c:T+i+(x||1)-1}});var I={t:"s",v:_},R=B.getAttribute("data-t")||B.getAttribute("t")||"";_!=null&&(_.length==0?I.t=R||"z":n.raw||_.trim().length==0||R=="s"||(_==="TRUE"?I={t:"b",v:!0}:_==="FALSE"?I={t:"b",v:!1}:isNaN(jn(_))?isNaN(Uo(_).getDate())||(I={t:"d",v:ir(_)},n.cellDates||(I={t:"n",v:Br(I.v)}),I.z=n.dateNF||ze[14]):I={t:"n",v:jn(_)})),I.z===void 0&&k!=null&&(I.z=k);var C="",N=B.getElementsByTagName("A");if(N&&N.length)for(var ye=0;ye<N.length&&!(N[ye].hasAttribute("href")&&(C=N[ye].getAttribute("href"),C.charAt(0)!="#"));++ye);C&&C.charAt(0)!="#"&&(I.l={Target:C}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][T+i]=I):t[Ue({c:T+i,r:v+s})]=I,l.e.c<T+i&&(l.e.c=T+i),T+=x}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,v-1+s),t["!ref"]=tt(l),v>=c&&(t["!fullref"]=tt((l.e.r=o.length-g+v-1+s,l))),t}function ek(t,e){var r=e||{},n=r.dense?[]:{};return ZT(n,t,e)}function iL(t,e){return zi(ek(t,e),e)}function __(t){var e="",r=aL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function aL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(e.replace(/<[^>]*>/g,""));return[r]}var y_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tk(t,e){var r=e||{},n=gg(t),s=[],i,a,o={name:""},c="",l=0,f,h,d={},m=[],g=r.dense?[]:{},v,E,T={value:""},w="",x=0,O=[],z=-1,B=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,A={},I=[],R={},C=0,N=0,ye=[],he=1,we=1,ge=[],ie={Names:[]},W={},le=["",""],Te=[],M={},K="",G=0,H=!1,te=!1,ue=0;for(Nl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Nl.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?g["!ref"]=tt(_):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(g["!fullref"]=g["!ref"],_.e.r=r.sheetRows-1,g["!ref"]=tt(_)),I.length&&(g["!merges"]=I),ye.length&&(g["!rows"]=ye),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),d[f.name]=g,te=!1):v[0].charAt(v[0].length-2)!=="/"&&(f=Oe(v[0],!1),z=B=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,g=r.dense?[]:{},I=[],ye=[],te=!0);break;case"table-row-group":v[1]==="/"?--k:++k;break;case"table-row":case"":if(v[1]==="/"){z+=he,he=1;break}if(h=Oe(v[0],!1),h.?z=h.-1:z==-1&&(z=0),he=+h["number-rows-repeated"]||1,he<10)for(ue=0;ue<he;++ue)k>0&&(ye[z+ue]={level:k});B=-1;break;case"covered-table-cell":v[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(g[z]||(g[z]=[]),g[z][B]={t:"z"}):g[Ue({r:z,c:B})]={t:"z"}),w="",O=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++B,T=Oe(v[0],!1),we=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=p_(st(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=st(T["string-value"]||""),r.dense?(g[z]||(g[z]=[]),g[z][B]=E):g[Ue({r:z,c:B})]=E),B+=we-1;else if(v[1]!=="/"){++B,w="",x=0,O=[],we=1;var ke=he?z+he-1:z;if(B>_.e.c&&(_.e.c=B),B<_.s.c&&(_.s.c=B),z<_.s.r&&(_.s.r=z),ke>_.e.r&&(_.e.r=ke),T=Oe(v[0],!1),Te=[],M={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=st(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(C=parseInt(T["number-matrix-rows-spanned"],10)||0,N=parseInt(T["number-matrix-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+C-1,c:B+N-1}},E.F=tt(R),ge.push([R,E.F])),T.formula)E.f=p_(T.formula);else for(ue=0;ue<ge.length;++ue)z>=ge[ue][0].s.r&&z<=ge[ue][0].e.r&&B>=ge[ue][0].s.c&&B<=ge[ue][0].e.c&&(E.F=ge[ue][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(C=parseInt(T["number-rows-spanned"],10)||0,N=parseInt(T["number-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+C-1,c:B+N-1}},I.push(R)),T["number-columns-repeated"]&&(we=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=wt(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=ir(T["date-value"]),r.cellDates||(E.t="n",E.v=Br(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=y3(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Qh(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(w=st(T["string-value"]),O=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=w||"",O.length&&(E.R=O),H=x==0),W.Target&&(E.l=W),Te.length>0&&(E.c=Te,Te=[]),w&&r.cellText!==!1&&(E.w=w),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var de=0;de<he;++de){if(we=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(g[z+de]||(g[z+de]=[]),g[z+de][B]=de==0?E:dr(E);--we>0;)g[z+de][B+we]=dr(E);else for(g[Ue({r:z+de,c:B})]=E;--we>0;)g[Ue({r:z+de,c:B+we})]=dr(E);_.e.c<=B&&(_.e.c=B)}we=parseInt(T["number-columns-repeated"]||"1",10),B+=we-1,we=0,E={},w="",O=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i;M.t=w,O.length&&(M.R=O),M.a=K,Te.push(M)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);K="",G=0,w="",x=0,O=[];break;case"creator":v[1]==="/"?K=n.slice(G,v.index):G=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);w="",x=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(A[o.name]=c,(i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Oe(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Oe(v[0],!1),c+=y_[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Oe(v[0],!1),c+=y_[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,v.index);break}else l=v.index+v[0].length;break;case"named-range":a=Oe(v[0],!1),le=gd(a["cell-range-address"]);var ae={Name:a.name,Ref:le[0]+"!"+le[1]};te&&(ae.Sheet=m.length),ie.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!T||!T["string-value"])){var Le=oL(n.slice(x,v.index));w=(w.length>0?w+`
`:"")+Le[0]}else Oe(v[0],!1),x=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{le=gd(Oe(v[0])["target-range-address"]),d[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(W=Oe(v[0],!1),!W.href)break;W.Target=st(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(le=gd(W.Target.slice(1)),W.Target="#"+le[0]+"!"+le[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var j={Sheets:d,SheetNames:m,Workbook:ie};return r.bookSheets&&delete j.Sheets,j}function E_(t,e){e=e||{},mn(t,"META-INF/manifest.xml")&&TP(Ht(t,"META-INF/manifest.xml"),e);var r=nn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=tk(pt(r),e);return mn(t,"meta.xml")&&(n.Props=pT(Ht(t,"meta.xml"))),n}function w_(t,e){return tk(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Rg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function bp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):pt(Na(t))}function Mp(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function T_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function cL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Ll(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Jt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Cr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Ll(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ll(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var l={data:o,type:i};e[s]==null?e[s]=[l]:e[s].push(l)}return e}function Pg(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function lL(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Ll(t,n),i=Cr(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:Jt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Cr(o.data),l=Jt(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=i[3])!=null&&e[0]&&(a.merge=Jt(i[3][0].data)>>>0>0),r.push(a)}return r}function uL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ll(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(i==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,i==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Mp(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(s.push(s[0].slice(-c)),l-=c;l>=s[s.length-1].length;)s.push(s[s.length-1]),l-=s[s.length-1].length;s.push(s[0].slice(-c,-c+l))}}var f=Mp(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function fL(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(uL(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mp(e)}function hL(t,e,r,n){var s=Rg(t),i=s.getUint32(4,!0),a=(n>1?12:8)+T_(i&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=T_(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(a,!0),a+=4),i&32&&(l=s.getFloat64(a,!0),a+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function dL(t,e,r){var n=Rg(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);s&1&&(c=cL(t,i),i+=16),s&2&&(l=n.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function pL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return hL(t,e,r,t[0]);case 5:return dL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function wi(t){var e=Cr(t);return Ll(e[1][0].data)}function k_(t,e){var r=Cr(e.data),n=Jt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Cr(a.data),c=Jt(o[1][0].data)>>>0;switch(n){case 1:i[c]=bp(o[3][0].data);break;case 8:{var l=t[wi(o[9][0].data)][0],f=Cr(l.data),h=t[wi(f[1][0].data)][0],d=Jt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=Cr(h.data);i[c]=m[3].map(function(g){return bp(g.data)}).join("")}break}}),i}function mL(t,e){var r,n,s,i,a,o,c,l,f,h,d,m,g,v,E=Cr(t),T=Jt(E[1][0].data)>>>0,w=Jt(E[2][0].data)>>>0,x=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Jt(E[8][0].data)>0||!1,O,z;if((i=(s=E[7])==null?void 0:s[0])!=null&&i.data&&e!=0)O=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,z=(l=(c=E[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(f=E[4])==null?void 0:f[0])!=null&&h.data&&e!=1)O=(m=(d=E[4])==null?void 0:d[0])==null?void 0:m.data,z=(v=(g=E[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=x?4:1,_=Rg(O),k=[],A=0;A<O.length/2;++A){var I=_.getUint16(A*2,!0);I<65535&&k.push([A,I])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var R=[];for(A=0;A<k.length-1;++A)R[k[A][0]]=z.subarray(k[A][1]*B,k[A+1][1]*B);return k.length>=1&&(R[k[k.length-1][0]]=z.subarray(k[k.length-1][1]*B)),{R:T,cells:R}}function gL(t,e){var r,n=Cr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Jt(n[7][0].data)>>>0>0?1:0:-1,i=Pg(n[5],function(a){return mL(a,s)});return{nrows:Jt(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function vL(t,e,r){var n,s=Cr(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Jt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Jt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=tt(i);var a=Cr(s[4][0].data),o=k_(t,t[wi(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?k_(t,t[wi(a[17][0].data)][0]):[],l=Cr(a[3][0].data),f=0;l[1].forEach(function(h){var d=Cr(h.data),m=t[wi(d[2][0].data)][0],g=Jt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var v=gL(t,m);v.data.forEach(function(E,T){E.forEach(function(w,x){var O=Ue({r:f+T,c:x}),z=pL(w,o,c);z&&(r[O]=z)})}),f+=v.nrows})}function xL(t,e){var r=Cr(e.data),n={"!ref":"A1"},s=t[wi(r[2][0].data)],i=Jt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return vL(t,s[0],n),n}function _L(t,e){var r,n=Cr(e.data),s={name:(r=n[1])!=null&&r[0]?bp(n[1][0].data):"",sheets:[]},i=Pg(n[2],wi);return i.forEach(function(a){t[a].forEach(function(o){var c=Jt(o.meta[1][0].data);c==6e3&&s.sheets.push(xL(t,o))})}),s}function yL(t,e){var r=Dg(),n=Cr(e.data),s=Pg(n[1],wi);if(s.forEach(function(i){t[i].forEach(function(a){var o=Jt(a.meta[1][0].data);if(o==2){var c=_L(t,a);c.sheets.forEach(function(l,f){Og(r,l,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xd(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=fL(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=lL(l)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Jt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(c){i[c].forEach(function(l){var f=Jt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return yL(i,o)}function EL(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ng(t){EL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function wL(t){return go.WS.indexOf(t)>-1?"sheet":t==go.CS?"chart":t==go.DS?"dialog":t==go.MS?"macro":t&&t.length?t:"sheet"}function TL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,wL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function kL(t,e,r,n,s,i,a,o,c,l,f,h){try{i[n]=Jc(nn(t,r,!0),e);var d=Ht(t,e),m;switch(o){case"sheet":m=P8(d,e,s,c,i[n],l,f,h);break;case"chart":if(m=N8(d,e,s,c,i[n],l,f,h),!m||!m["!drawel"])break;var g=Fc(m["!drawel"].Target,e),v=Np(g),E=RD(nn(t,g,!0),Jc(nn(t,v,!0),g)),T=Fc(E,g),w=Np(T);m=d8(nn(t,T,!0),T,c,Jc(nn(t,w,!0),T),l,m);break;case"macro":m=F8(d,e,s,c,i[n],l,f,h);break;case"dialog":m=D8(d,e,s,c,i[n],l,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var x=[];i&&i[n]&&hs(i[n]).forEach(function(O){var z="";if(i[n][O].Type==go.CMNT){z=Fc(i[n][O].Target,e);var B=M8(Ht(t,z,!0),z,c);if(!B||!B.length)return;l_(m,B,!1)}i[n][O].Type==go.TCMNT&&(z=Fc(i[n][O].Target,e),x=x.concat(ND(Ht(t,z,!0),c)))}),x&&x.length&&l_(m,x,!0,c.people||[])}catch(O){if(c.WTF)throw O}}function dn(t){return t.charAt(0)=="/"?t.slice(1):t}function AL(t,e){if(U2(),e=e||{},Ng(e),mn(t,"META-INF/manifest.xml")||mn(t,"objectdata.xml"))return E_(t,e);if(mn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xd<"u"){if(t.FileIndex)return xd(t);var r=et.utils.cfb_new();return bx(t).forEach(function(ye){S3(r,ye,A3(t,ye))}),xd(r)}throw new Error("Unsupported NUMBERS file")}if(!mn(t,"[Content_Types].xml"))throw mn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=bx(t),s=EP(nn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Ht(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Ht(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(tl=[],s.sst)try{tl=b8(Ht(t,dn(s.sst)),s.sst,e)}catch(ye){if(e.WTF)throw ye}e.cellStyles&&s.themes.length&&(c=L8(nn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(l=O8(Ht(t,dn(s.style)),s.style,c,e))}s.links.map(function(ye){try{var he=Jc(nn(t,Np(dn(ye))),ye);return U8(Ht(t,dn(ye)),he,ye,e)}catch{}});var f=R8(Ht(t,dn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=Ht(t,dn(s.coreprops[0]),!0),d&&(h=pT(d)),s.extprops.length!==0&&(d=Ht(t,dn(s.extprops[0]),!0),d&&SP(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=nn(t,dn(s.custprops[0]),!0),d&&(m=CP(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=m),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var v={};e.bookDeps&&s.calcchain&&(v=V8(Ht(t,dn(s.calcchain)),s.calcchain));var E=0,T={},w,x;{var O=f.Sheets;h.Worksheets=O.length,h.SheetNames=[];for(var z=0;z!=O.length;++z)h.SheetNames[z]=O[z].name}var B=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");mn(t,k)||(k="xl/_rels/workbook."+B+".rels");var A=Jc(nn(t,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=B8(Ht(t,dn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=FD(Ht(t,dn(s.people[0])),e)),A&&(A=TL(A,f.Sheets));var I=Ht(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var R="sheet";if(A&&A[E]?(w="xl/"+A[E][1].replace(/[\/]?xl\//,""),mn(t,w)||(w=A[E][1]),mn(t,w)||(w=k.replace(/_rels\/.*$/,"")+A[E][1]),R=A[E][2]):(w="xl/worksheets/sheet"+(E+1-I)+"."+B,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,N=0;N!=e.sheets.length;++N)typeof e.sheets[N]=="number"&&e.sheets[N]==E&&(C=1),typeof e.sheets[N]=="string"&&e.sheets[N].toLowerCase()==h.SheetNames[E].toLowerCase()&&(C=1);if(!C)continue e}}kL(t,w,x,h.SheetNames[E],E,T,a,R,e,f,c,l)}return g={Directory:s,Workbook:f,Props:h,Custprops:m,Deps:v,Sheets:a,SheetNames:h.SheetNames,Strings:tl,Styles:l,Themes:c,SSF:dr(ze)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(ye,he){ye=ye.replace(/^Root Entry[\/]/,""),g.keys.push(ye),g.files[ye]=t.FileIndex[he]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=Ht(t,dn(s.vba[0]),!0):s.defaults&&s.defaults.bin===bD&&(g.vbaraw=Ht(t,"xl/vbaProject.bin",!0))),g}function SL(t,e){var r=e||{},n="Workbook",s=et.find(t,n);try{if(n="/!DataSpaces/Version",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xF(s.content),n="/!DataSpaces/DataSpaceMap",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=yF(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=EF(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);TF(s.content)}catch{}if(n="/EncryptionInfo",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=kF(s.content);if(n="/EncryptedPackage",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Fg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=un(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function IL(t,e){return et.find(t,"EncryptedPackage")?SL(t,e):JT(t,e)}function CL(t,e){var r,n=t,s=e||{};return s.type||(s.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r=W2(n,s),AL(r,s)}function rk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Op(t.slice(r),e);default:break e}return Fl.to_workbook(t,e)}function RL(t,e){var r="",n=Fg(t,e);switch(e.type){case"base64":r=un(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ya(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pt(r)),e.type="binary",rk(r,e)}function PL(t,e){var r=t;return e.type=="base64"&&(r=un(r)),r=Cl.utils.decode(1200,r.slice(2),"str"),e.type="binary",rk(r,e)}function NL(t){return t.match(/[^\x00-\x7F]/)?Dc(t):t}function _d(t,e,r,n){return n?(r.type="string",Fl.to_workbook(t,r)):Fl.to_workbook(e,r)}function dh(t,e){I2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return dh(new Uint8Array(t),(r=dr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),So={},r.dateNF&&(So.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=x3(t),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=NL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=dr(r),r.type="array",dh(ug(n),r)}switch((s=Fg(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return IL(et.read(n,r),r);break;case 9:if(s[1]<=8)return JT(n,r);break;case 60:return Op(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return iF(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return nF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?CL(n,r):_d(t,n,r,i);case 239:return s[3]===60?Op(n,r):_d(t,n,r,i);case 255:if(s[1]===254)return PL(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return el.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return el.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return c_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return bF.to_workbook(n,r);break;case 10:case 13:case 32:return RL(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tF.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?c_.to_workbook(n,r):_d(t,n,r,i)}function FL(t,e,r,n,s,i,a,o){var c=pr(r),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var g=a?t[r][m]:t[n[m]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;i[m]!=null&&(d[i[m]]=l);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[m]!=null){if(v==null)if(g.t=="e"&&v===null)d[i[m]]=null;else if(l!==void 0)d[i[m]]=l;else if(f&&v===null)d[i[m]]=null;else continue;else d[i[m]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?v:Vs(g,v,o);v!=null&&(h=!1)}}return{row:d,isempty:h}}function Vp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},f=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=Ot(f);break;case"number":c=Ot(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var h=pr(c.s.r),d=[],m=[],g=0,v=0,E=Array.isArray(t),T=c.s.r,w=0,x={};E&&!t[T]&&(t[T]=[]);var O=l.skipHidden&&t["!cols"]||[],z=l.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(O[w]||{}).hidden)switch(d[w]=Qt(w),r=E?t[T][w]:t[d[w]+h],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=d[w];break;case 3:i[w]=l.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Vs(r,null,l),v=x[a]||0,!v)x[a]=1;else{do o=a+"_"+v++;while(x[o]);x[a]=v,x[o]=1}i[w]=o}for(T=c.s.r+s;T<=c.e.r;++T)if(!(z[T]||{}).hidden){var B=FL(t,c,T,d,n,i,E,l);(B.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[g++]=B.row)}return m.length=g,m}var A_=/"/g;function DL(t,e,r,n,s,i,a,o){for(var c=!0,l=[],f="",h=pr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){c=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Vs(m,null,o));for(var g=0,v=0;g!==f.length;++g)if((v=f.charCodeAt(g))===s||v===i||v===34||o.forceQuotes){f='"'+f.replace(A_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(c=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(A_,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(a)}function nk(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Ot(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(d[g]||{}).hidden||(h[g]=Qt(g));for(var v=0,E=s.s.r;E<=s.e.r;++E)(m[E]||{}).hidden||(f=DL(t,s,E,h,a,c,i,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&r.push((v++?o:"")+f)));return delete n.dense,r.join("")}function OL(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=nk(t,e);return r}function LL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Ot(t["!ref"]),i="",a=[],o,c=[],l=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=Qt(o);for(var f=s.s.r;f<=s.e.r;++f)for(i=pr(f),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=l?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function sk(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Mr(n.origin):n.origin;a=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=Ot(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+s)}else a==-1&&(a=0,f.e.r=e.length-1+s);var d=n.header||[],m=0;e.forEach(function(v,E){hs(v).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var w=v[T],x="z",O="",z=Ue({c:o+m,r:a+E+s});l=bl(i,z),w&&typeof w=="object"&&!(w instanceof Date)?i[z]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=Br(w)),O=n.dateNF||ze[14]):w===null&&n.nullError&&(x="e",w=0),l?(l.t=x,l.v=w,delete l.w,delete l.R,O&&(l.z=O)):i[z]=l={t:x,v:w},O&&(l.z=O))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=pr(a);if(s)for(m=0;m<d.length;++m)i[Qt(m+o)+g]={t:"s",v:d[m]};return i["!ref"]=tt(f),i}function bL(t,e){return sk(null,t,e)}function bl(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Mr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?bl(t,Ue(e)):bl(t,Ue({r:e,c:r||0}))}function ML(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Dg(){return{SheetNames:[],Sheets:{}}}function Og(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(E8(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function VL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=ML(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function UL(t,e){return t.z=e,t}function ik(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function BL(t,e,r){return ik(t,"#"+e,r)}function jL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function zL(t,e,r,n){for(var s=typeof e!="string"?e:Ot(e),i=typeof e=="string"?e:tt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=bl(t,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var S_={encode_col:Qt,encode_row:pr,encode_cell:Ue,encode_range:tt,decode_col:_g,decode_row:xg,split_cell:eP,decode_cell:Mr,decode_range:Jo,format_cell:Vs,sheet_add_aoa:lT,sheet_add_json:sk,sheet_add_dom:ZT,aoa_to_sheet:Zo,json_to_sheet:bL,table_to_sheet:ek,table_to_book:iL,sheet_to_csv:nk,sheet_to_txt:OL,sheet_to_json:Vp,sheet_to_html:sL,sheet_to_formulae:LL,sheet_to_row_object_array:Vp,sheet_get_cell:bl,book_new:Dg,book_append_sheet:Og,book_set_sheet_visibility:VL,cell_set_number_format:UL,cell_set_hyperlink:ik,cell_set_internal_link:BL,cell_add_comment:jL,sheet_set_array_formula:zL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const HL=()=>{};var I_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},$L=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},ok={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,f=i>>2,h=(i&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ak(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$L(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const l=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||l==null||h==null)throw new WL;const d=i<<2|o>>4;if(n.push(d),l!==64){const m=o<<4&240|l>>2;if(n.push(m),h!==64){const g=l<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GL=function(t){const e=ak(t);return ok.encodeByteArray(e,!0)},ph=function(t){return GL(t).replace(/\./g,"")},ck=function(t){try{return ok.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=()=>KL().__FIREBASE_DEFAULTS__,XL=()=>{if(typeof process>"u"||typeof I_>"u")return;const t=I_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ck(t[1]);return e&&JSON.parse(e)},t0=()=>{try{return HL()||qL()||XL()||YL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lk=t=>{var e,r;return(r=(e=t0())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},QL=t=>{const e=lk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},uk=()=>{var t;return(t=t0())==null?void 0:t.config},fk=t=>{var e;return(e=t0())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hk(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ph(JSON.stringify(r)),ph(JSON.stringify(a)),""].join(".")}const sl={};function eb(){const t={prod:[],emulator:[]};for(const e of Object.keys(sl))sl[e]?t.emulator.push(e):t.prod.push(e);return t}function tb(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let C_=!1;function dk(t,e){if(typeof window>"u"||typeof document>"u"||!ec(window.location.host)||sl[t]===e||sl[t]||C_)return;sl[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",i=eb().prod.length>0;function a(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function c(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function l(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{C_=!0,a()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=tb(n),m=r("text"),g=document.getElementById(m)||document.createElement("span"),v=r("learnmore"),E=document.getElementById(v)||document.createElement("a"),T=r("preprendIcon"),w=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const x=d.element;o(x),f(E,v);const O=l();c(w,T),x.append(w,g,E,O),document.body.appendChild(x)}i?(g.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fr())}function nb(){var e;const t=(e=t0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ib(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ab(){const t=Fr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ob(){return!nb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mk(){try{return typeof indexedDB=="object"}catch{return!1}}function gk(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}function cb(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb="FirebaseError";class Kn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=lb,Object.setPrototypeOf(this,Kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ba.prototype.create)}}class ba{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?ub(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Kn(s,o,n)}}function ub(t,e){return t.replace(fb,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const fb=/\{\$([^}]+)}/g;function hb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(R_(i)&&R_(a)){if(!Fi(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function R_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Oc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Lc(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function db(t,e){const r=new pb(t,e);return r.subscribe.bind(r)}class pb{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");mb(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=yd),s.error===void 0&&(s.error=yd),s.complete===void 0&&(s.complete=yd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mb(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function yd(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb=1e3,vb=2,xb=4*60*60*1e3,_b=.5;function P_(t,e=gb,r=vb){const n=e*Math.pow(r,t),s=Math.round(_b*n*(Math.random()-.5)*2);return Math.min(xb,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(t){return t&&t._delegate?t._delegate:t}class Hn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new JL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wb(e))try{this.getOrInitializeService({instanceIdentifier:ta})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ta){return this.instances.has(e)}getOptions(e=ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Eb(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ta){return this.component?this.component.multipleInstances?e:ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Eb(t){return t===ta?void 0:t}function wb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new yb(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ge||(Ge={}));const kb={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},Ab=Ge.INFO,Sb={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},Ib=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=Sb[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class r0{constructor(e){this.name=e,this._logLevel=Ab,this._logHandler=Ib,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}const Cb=(t,e)=>e.some(r=>t instanceof r);let N_,F_;function Rb(){return N_||(N_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Pb(){return F_||(F_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vk=new WeakMap,Up=new WeakMap,xk=new WeakMap,Ed=new WeakMap,Lg=new WeakMap;function Nb(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Ti(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&vk.set(r,t)}).catch(()=>{}),Lg.set(e,t),e}function Fb(t){if(Up.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Up.set(t,e)}let Bp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Up.get(t);if(e==="objectStoreNames")return t.objectStoreNames||xk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ti(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Db(t){Bp=t(Bp)}function Ob(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(wd(this),e,...r);return xk.set(n,e.sort?e.sort():[e]),Ti(n)}:Pb().includes(t)?function(...e){return t.apply(wd(this),e),Ti(vk.get(this))}:function(...e){return Ti(t.apply(wd(this),e))}}function Lb(t){return typeof t=="function"?Ob(t):(t instanceof IDBTransaction&&Fb(t),Cb(t,Rb())?new Proxy(t,Bp):t)}function Ti(t){if(t instanceof IDBRequest)return Nb(t);if(Ed.has(t))return Ed.get(t);const e=Lb(t);return e!==t&&(Ed.set(t,e),Lg.set(e,t)),e}const wd=t=>Lg.get(t);function _k(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=Ti(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Ti(a.result),c.oldVersion,c.newVersion,Ti(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const bb=["get","getKey","getAll","getAllKeys","count"],Mb=["put","add","delete","clear"],Td=new Map;function D_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Td.get(e))return Td.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=Mb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||bb.includes(r)))return;const i=async function(a,...o){const c=this.transaction(a,s?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),s&&c.done]))[0]};return Td.set(e,i),i}Db(t=>({...t,get:(e,r,n)=>D_(e,r)||t.get(e,r,n),has:(e,r)=>!!D_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Ub(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Ub(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const jp="@firebase/app",O_="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new r0("@firebase/app"),Bb="@firebase/app-compat",jb="@firebase/analytics-compat",zb="@firebase/analytics",Hb="@firebase/app-check-compat",$b="@firebase/app-check",Wb="@firebase/auth",Gb="@firebase/auth-compat",Kb="@firebase/database",qb="@firebase/data-connect",Xb="@firebase/database-compat",Yb="@firebase/functions",Qb="@firebase/functions-compat",Jb="@firebase/installations",Zb="@firebase/installations-compat",e5="@firebase/messaging",t5="@firebase/messaging-compat",r5="@firebase/performance",n5="@firebase/performance-compat",s5="@firebase/remote-config",i5="@firebase/remote-config-compat",a5="@firebase/storage",o5="@firebase/storage-compat",c5="@firebase/firestore",l5="@firebase/ai",u5="@firebase/firestore-compat",f5="firebase",h5="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="[DEFAULT]",d5={[jp]:"fire-core",[Bb]:"fire-core-compat",[zb]:"fire-analytics",[jb]:"fire-analytics-compat",[$b]:"fire-app-check",[Hb]:"fire-app-check-compat",[Wb]:"fire-auth",[Gb]:"fire-auth-compat",[Kb]:"fire-rtdb",[qb]:"fire-data-connect",[Xb]:"fire-rtdb-compat",[Yb]:"fire-fn",[Qb]:"fire-fn-compat",[Jb]:"fire-iid",[Zb]:"fire-iid-compat",[e5]:"fire-fcm",[t5]:"fire-fcm-compat",[r5]:"fire-perf",[n5]:"fire-perf-compat",[s5]:"fire-rc",[i5]:"fire-rc-compat",[a5]:"fire-gcs",[o5]:"fire-gcs-compat",[c5]:"fire-fst",[u5]:"fire-fst-compat",[l5]:"fire-vertex","fire-js":"fire-js",[f5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new Map,p5=new Map,Hp=new Map;function L_(t,e){try{t.container.addComponent(e)}catch(r){Us.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ds(t){const e=t.name;if(Hp.has(e))return Us.debug(`There were multiple attempts to register component ${e}.`),!1;Hp.set(e,t);for(const r of mh.values())L_(r,t);for(const r of p5.values())L_(r,t);return!0}function Ma(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function xn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ki=new ba("app","Firebase",m5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ki.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=h5;function yk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:zp,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw ki.create("bad-app-name",{appName:String(s)});if(r||(r=uk()),!r)throw ki.create("no-options");const i=mh.get(s);if(i){if(Fi(r,i.options)&&Fi(n,i.config))return i;throw ki.create("duplicate-app",{appName:s})}const a=new Tb(s);for(const c of Hp.values())a.addComponent(c);const o=new g5(r,n,a);return mh.set(s,o),o}function bg(t=zp){const e=mh.get(t);if(!e&&t===zp&&uk())return yk();if(!e)throw ki.create("no-app",{appName:t});return e}function wn(t,e,r){let n=d5[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Us.warn(a.join(" "));return}ds(new Hn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5="firebase-heartbeat-database",x5=1,Ml="firebase-heartbeat-store";let kd=null;function Ek(){return kd||(kd=_k(v5,x5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ml)}catch(r){console.warn(r)}}}}).catch(t=>{throw ki.create("idb-open",{originalErrorMessage:t.message})})),kd}async function _5(t){try{const r=(await Ek()).transaction(Ml),n=await r.objectStore(Ml).get(wk(t));return await r.done,n}catch(e){if(e instanceof Kn)Us.warn(e.message);else{const r=ki.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Us.warn(r.message)}}}async function b_(t,e){try{const n=(await Ek()).transaction(Ml,"readwrite");await n.objectStore(Ml).put(e,wk(t)),await n.done}catch(r){if(r instanceof Kn)Us.warn(r.message);else{const n=ki.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Us.warn(n.message)}}}function wk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y5=1024,E5=30;class w5{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new k5(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=M_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>E5){const a=A5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Us.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=M_(),{heartbeatsToSend:n,unsentEntries:s}=T5(this._heartbeatsCache.heartbeats),i=ph(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Us.warn(r),""}}}function M_(){return new Date().toISOString().substring(0,10)}function T5(t,e=y5){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),V_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),V_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class k5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mk()?gk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await _5(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return b_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return b_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function V_(t){return ph(JSON.stringify({version:2,heartbeats:t})).length}function A5(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S5(t){ds(new Hn("platform-logger",e=>new Vb(e),"PRIVATE")),ds(new Hn("heartbeat",e=>new w5(e),"PRIVATE")),wn(jp,O_,t),wn(jp,O_,"esm2020"),wn("fire-js","")}S5("");function Tk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const I5=Tk,kk=new ba("auth","Firebase",Tk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new r0("@firebase/auth");function C5(t,...e){gh.logLevel<=Ge.WARN&&gh.warn(`Auth (${tc}): ${t}`,...e)}function wf(t,...e){gh.logLevel<=Ge.ERROR&&gh.error(`Auth (${tc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(t,...e){throw Mg(t,...e)}function as(t,...e){return Mg(t,...e)}function Ak(t,e,r){const n={...I5(),[e]:r};return new ba("auth","Firebase",n).create(e,{appName:t.name})}function Fs(t){return Ak(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return kk.create(t,...e)}function Ne(t,e,...r){if(!t)throw Mg(e,...r)}function Is(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wf(e),new Error(e)}function Bs(t,e){t||Is(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function R5(){return U_()==="http:"||U_()==="https:"}function U_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(R5()||pk()||"connection"in navigator)?navigator.onLine:!0}function N5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r){this.shortDelay=e,this.longDelay=r,Bs(r>e,"Short delay should be less than long delay!"),this.isMobile=rb()||ib()}get(){return P5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(t,e){Bs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],O5=new su(3e4,6e4);function Hi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ws(t,e,r,n,s={}){return Ik(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=nu({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...i};return sb()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&ec(t.emulatorConfig.host)&&(l.credentials="include"),Sk.fetch()(await Ck(t,t.config.apiHost,r,o),l)})}async function Ik(t,e,r){t._canInitEmulator=!1;const n={...F5,...e};try{const s=new b5(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw tf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw tf(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw tf(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw tf(t,"user-disabled",a);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Ak(t,f,l);$n(t,f)}}catch(s){if(s instanceof Kn)throw s;$n(t,"network-request-failed",{message:String(s)})}}async function iu(t,e,r,n,s={}){const i=await Ws(t,e,r,n,s);return"mfaPendingCredential"in i&&$n(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Ck(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?Vg(t.config,s):`${t.config.apiScheme}://${s}`;return D5.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function L5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(as(this.auth,"network-request-failed")),O5.get())})}}function tf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=as(t,e,n);return s.customData._tokenResponse=r,s}function B_(t){return t!==void 0&&t.enterprise!==void 0}class M5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return L5(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function V5(t,e){return Ws(t,"GET","/v2/recaptchaConfig",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U5(t,e){return Ws(t,"POST","/v1/accounts:delete",e)}async function vh(t,e){return Ws(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function B5(t,e=!1){const r=Bt(t),n=await r.getIdToken(e),s=Ug(n);Ne(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:il(Ad(s.auth_time)),issuedAtTime:il(Ad(s.iat)),expirationTime:il(Ad(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ad(t){return Number(t)*1e3}function Ug(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return wf("JWT malformed, contained fewer than 3 sections"),null;try{const s=ck(r);return s?JSON.parse(s):(wf("Failed to decode base64 JWT payload"),null)}catch(s){return wf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function j_(t){const e=Ug(t);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Kn&&j5(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function j5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=il(this.lastLoginAt),this.creationTime=il(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xh(t){var h;const e=t.auth,r=await t.getIdToken(),n=await jo(t,vh(e,{idToken:r}));Ne(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?Rk(s.providerUserInfo):[],a=$5(t.providerData,i),o=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),l=o?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Wp(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,f)}async function H5(t){const e=Bt(t);await xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $5(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Rk(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W5(t,e){const r=await Ik(t,{},async()=>{const n=nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await Ck(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&ec(t.emulatorConfig.host)&&(c.credentials="include"),Sk.fetch()(a,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function G5(t,e){return Ws(t,"POST","/v2/accounts:revokeToken",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):j_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const r=j_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await W5(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new Io;return n&&(Ne(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Ne(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Ne(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return Is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(t,e){Ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Vn{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new z5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await jo(this,this.stsTokenManager.getToken(this.auth,e));return Ne(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return B5(this,e)}reload(){return H5(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Vn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await xh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xn(this.auth.app))return Promise.reject(Fs(this.auth));const e=await this.getIdToken();return await jo(this,U5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:m,providerData:g,stsTokenManager:v}=r;Ne(h&&v,e,"internal-error");const E=Io.fromJSON(this.name,v);Ne(typeof h=="string",e,"internal-error"),Js(n,e.name),Js(s,e.name),Ne(typeof d=="boolean",e,"internal-error"),Ne(typeof m=="boolean",e,"internal-error"),Js(i,e.name),Js(a,e.name),Js(o,e.name),Js(c,e.name),Js(l,e.name),Js(f,e.name);const T=new Vn({uid:h,auth:e,email:s,emailVerified:d,displayName:n,isAnonymous:m,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:E,createdAt:l,lastLoginAt:f});return g&&Array.isArray(g)&&(T.providerData=g.map(w=>({...w}))),c&&(T._redirectEventId=c),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new Io;s.updateFromServerResponse(r);const i=new Vn({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await xh(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Ne(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Rk(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new Io;o.updateFromIdToken(n);const c=new Vn({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_=new Map;function Cs(t){Bs(t instanceof Function,"Expected a class definition");let e=z_.get(t);return e?(Bs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,z_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Pk.type="NONE";const H_=Pk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(t,e,r){return`firebase:${t}:${e}:${r}`}class Co{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Tf(this.userKey,s.apiKey,i),this.fullPersistenceKey=Tf("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await vh(this.auth,{idToken:e}).catch(()=>{});return r?Vn._fromGetAccountInfoResponse(this.auth,r,e):null}return Vn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Co(Cs(H_),e,n);const s=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Cs(H_);const a=Tf(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const f=await l._get(a);if(f){let h;if(typeof f=="string"){const d=await vh(e,{idToken:f}).catch(()=>{});if(!d)break;h=await Vn._fromGetAccountInfoResponse(e,d,f)}else h=Vn._fromJSON(e,f);l!==i&&(o=h),i=l;break}}catch{}const c=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Co(i,e,n):(i=c[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==i)try{await l._remove(a)}catch{}})),new Co(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ok(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Nk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bk(e))return"Blackberry";if(Mk(e))return"Webos";if(Fk(e))return"Safari";if((e.includes("chrome/")||Dk(e))&&!e.includes("edge/"))return"Chrome";if(Lk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Nk(t=Fr()){return/firefox\//i.test(t)}function Fk(t=Fr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dk(t=Fr()){return/crios\//i.test(t)}function Ok(t=Fr()){return/iemobile/i.test(t)}function Lk(t=Fr()){return/android/i.test(t)}function bk(t=Fr()){return/blackberry/i.test(t)}function Mk(t=Fr()){return/webos/i.test(t)}function Bg(t=Fr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function K5(t=Fr()){var e;return Bg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function q5(){return ab()&&document.documentMode===10}function Vk(t=Fr()){return Bg(t)||Lk(t)||Mk(t)||bk(t)||/windows phone/i.test(t)||Ok(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t,e=[]){let r;switch(t){case"Browser":r=$_(Fr());break;case"Worker":r=`${$_(Fr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${tc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const c=e(i);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5(t,e={}){return Ws(t,"GET","/v2/passwordPolicy",Hi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=6;class J5{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Q5,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new W_(this),this.idTokenSubscription=new W_(this),this.beforeStateQueue=new X5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Cs(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await vh(this,{idToken:e}),n=await Vn._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(xn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,o=n==null?void 0:n._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await xh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=N5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xn(this.app))return Promise.reject(Fs(this));const r=e?Bt(e):null;return r&&Ne(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xn(this.app)?Promise.reject(Fs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xn(this.app)?Promise.reject(Fs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Cs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Y5(this),r=new J5(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ba("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await G5(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Cs(e)||this._popupRedirectResolver;Ne(r,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[Cs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{a=!0,c()}}else{const c=e.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Uk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&C5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Va(t){return Bt(t)}class W_{constructor(e){this.auth=e,this.observer=null,this.addObserver=db(r=>this.observer=r)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eM(t){n0=t}function Bk(t){return n0.loadJS(t)}function tM(){return n0.recaptchaEnterpriseScript}function rM(){return n0.gapiScript}function nM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class sM{constructor(){this.enterprise=new iM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class iM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const aM="recaptcha-enterprise",jk="NO_RECAPTCHA";class oM{constructor(e){this.type=aM,this.auth=Va(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{V5(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new M5(c);return i.tenantId==null?i._agentRecaptchaConfig=l:i._tenantRecaptchaConfigs[i.tenantId]=l,a(l.siteKey)}}).catch(c=>{o(c)})})}function s(i,a,o){const c=window.grecaptcha;B_(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(l=>{a(l)}).catch(()=>{a(jk)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new sM().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&B_(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=tM();c.length!==0&&(c+=o),Bk(c).then(()=>{s(o,i,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function G_(t,e,r,n=!1,s=!1){const i=new oM(t);let a;if(s)a=jk;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Gp(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await G_(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await G_(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(t,e){const r=Ma(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Fi(i,e??{}))return s;$n(s,"already-initialized")}return r.initialize({options:e})}function lM(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Cs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function uM(t,e,r){const n=Va(t);Ne(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=zk(e),{host:a,port:o}=fM(e),c=o===null?"":`:${o}`,l={url:`${i}//${a}${c}/`},f=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Ne(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ne(Fi(l,n.config.emulator)&&Fi(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ec(a)?(hk(`${i}//${a}${c}`),dk("Auth",!0)):hM()}function zk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function fM(t){const e=zk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:K_(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:K_(a)}}}function K_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function hM(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,r){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}async function dM(t,e){return Ws(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pM(t,e){return iu(t,"POST","/v1/accounts:signInWithPassword",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mM(t,e){return iu(t,"POST","/v1/accounts:signInWithEmailLink",Hi(t,e))}async function gM(t,e){return iu(t,"POST","/v1/accounts:signInWithEmailLink",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl extends jg{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Vl(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Vl(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,r,"signInWithPassword",pM);case"emailLink":return mM(e,{email:this._email,oobCode:this._password});default:$n(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,n,"signUpPassword",dM);case"emailLink":return gM(e,{idToken:r,email:this._email,oobCode:this._password});default:$n(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(t,e){return iu(t,"POST","/v1/accounts:signInWithIdp",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM="http://localhost";class wa extends jg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new wa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):$n("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new wa(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ro(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ro(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ro(e,r)}buildRequest(){const e={requestUri:vM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=nu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _M(t){const e=Oc(Lc(t)).link,r=e?Oc(Lc(e)).deep_link_id:null,n=Oc(Lc(t)).deep_link_id;return(n?Oc(Lc(n)).link:null)||n||r||e||t}class zg{constructor(e){const r=Oc(Lc(e)),n=r.apiKey??null,s=r.oobCode??null,i=xM(r.mode??null);Ne(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=_M(e);try{return new zg(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,r){return Vl._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=zg.parseLink(r);return Ne(n,"argument-error"),Vl._fromEmailAndCode(e,n.code,n.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au extends Hk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii extends au{constructor(){super("facebook.com")}static credential(e){return wa._fromParams({providerId:ii.PROVIDER_ID,signInMethod:ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ii.credentialFromTaggedObject(e)}static credentialFromError(e){return ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ii.credential(e.oauthAccessToken)}catch{return null}}}ii.FACEBOOK_SIGN_IN_METHOD="facebook.com";ii.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return wa._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ai.credential(r,n)}catch{return null}}}ai.GOOGLE_SIGN_IN_METHOD="google.com";ai.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends au{constructor(){super("github.com")}static credential(e){return wa._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.GITHUB_SIGN_IN_METHOD="github.com";oi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci extends au{constructor(){super("twitter.com")}static credential(e,r){return wa._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ci.credential(r,n)}catch{return null}}}ci.TWITTER_SIGN_IN_METHOD="twitter.com";ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yM(t,e){return iu(t,"POST","/v1/accounts:signUp",Hi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Vn._fromIdTokenResponse(e,n,s),a=q_(n);return new Ta({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=q_(n);return new Ta({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function q_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends Kn{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new _h(e,r,n,s)}}function $k(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(t,i,e,n):i})}async function EM(t,e,r=!1){const n=await jo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ta._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wM(t,e,r=!1){const{auth:n}=t;if(xn(n.app))return Promise.reject(Fs(n));const s="reauthenticate";try{const i=await jo(t,$k(n,s,e,t),r);Ne(i.idToken,n,"internal-error");const a=Ug(i.idToken);Ne(a,n,"internal-error");const{sub:o}=a;return Ne(t.uid===o,n,"user-mismatch"),Ta._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&$n(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wk(t,e,r=!1){if(xn(t.app))return Promise.reject(Fs(t));const n="signIn",s=await $k(t,n,e),i=await Ta._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function TM(t,e){return Wk(Va(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(t){const e=Va(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kM(t,e,r){if(xn(t.app))return Promise.reject(Fs(t));const n=Va(t),a=await Gp(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Gk(t),c}),o=await Ta._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function AM(t,e,r){return xn(t.app)?Promise.reject(Fs(t)):TM(Bt(t),rc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Gk(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SM(t,e){return Ws(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IM(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Bt(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await jo(n,SM(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:c})=>c==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function CM(t,e,r,n){return Bt(t).onIdTokenChanged(e,r,n)}function RM(t,e,r){return Bt(t).beforeAuthStateChanged(e,r)}function PM(t,e,r,n){return Bt(t).onAuthStateChanged(e,r,n)}function NM(t){return Bt(t).signOut()}const yh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(yh,"1"),this.storage.removeItem(yh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM=1e3,DM=10;class qk extends Kk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Vk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);q5()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,DM):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},FM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}qk.type="LOCAL";const OM=qk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk extends Kk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Xk.type="SESSION";const Yk=Xk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new s0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async l=>l(r.origin,i)),c=await LM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}s0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,c)=>{const l=Hg("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(d.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(){return window}function MM(t){os().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function VM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function BM(){return Qk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk="firebaseLocalStorageDb",jM=1,Eh="firebaseLocalStorage",Zk="fbase_key";class ou{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function i0(t,e){return t.transaction([Eh],e?"readwrite":"readonly").objectStore(Eh)}function zM(){const t=indexedDB.deleteDatabase(Jk);return new ou(t).toPromise()}function Kp(){const t=indexedDB.open(Jk,jM);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Eh,{keyPath:Zk})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Eh)?e(n):(n.close(),await zM(),e(await Kp()))})})}async function X_(t,e,r){const n=i0(t,!0).put({[Zk]:e,value:r});return new ou(n).toPromise()}async function HM(t,e){const r=i0(t,!1).get(e),n=await new ou(r).toPromise();return n===void 0?null:n.value}function Y_(t,e){const r=i0(t,!0).delete(e);return new ou(r).toPromise()}const $M=800,WM=3;class eA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>WM)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Qk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=s0._getInstance(BM()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await VM(),!this.activeServiceWorker)return;this.sender=new bM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kp();return await X_(e,yh,"1"),await Y_(e,yh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>X_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>HM(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Y_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=i0(s,!1).getAll();return new ou(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$M)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eA.type="LOCAL";const GM=eA;new su(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KM(t,e){return e?Cs(e):(Ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g extends jg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ro(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ro(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ro(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function qM(t){return Wk(t.auth,new $g(t),t.bypassAuthState)}function XM(t){const{auth:e,user:r}=t;return Ne(r,e,"internal-error"),wM(r,new $g(t),t.bypassAuthState)}async function YM(t){const{auth:e,user:r}=t;return Ne(r,e,"internal-error"),EM(r,new $g(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qM;case"linkViaPopup":case"linkViaRedirect":return YM;case"reauthViaPopup":case"reauthViaRedirect":return XM;default:$n(this.auth,"internal-error")}}resolve(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=new su(2e3,1e4);class vo extends tA{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,vo.currentPopupAction&&vo.currentPopupAction.cancel(),vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Bs(this.filter.length===1,"Popup operations only handle one event");const e=Hg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(as(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(as(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(as(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QM.get())};e()}}vo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM="pendingRedirect",kf=new Map;class ZM extends tA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=kf.get(this.auth._key());if(!e){try{const n=await e9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}kf.set(this.auth._key(),e)}return this.bypassAuthState||kf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e9(t,e){const r=n9(e),n=r9(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function t9(t,e){kf.set(t._key(),e)}function r9(t){return Cs(t._redirectPersistence)}function n9(t){return Tf(JM,t.config.apiKey,t.name)}async function s9(t,e,r=!1){if(xn(t.app))return Promise.reject(Fs(t));const n=Va(t),s=KM(n,e),a=await new ZM(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9=10*60*1e3;class a9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o9(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!rA(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(as(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i9&&this.cachedEventUids.clear(),this.cachedEventUids.has(Q_(e))}saveEventToCache(e){this.cachedEventUids.add(Q_(e)),this.lastProcessedEventTime=Date.now()}}function Q_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function o9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c9(t,e={}){return Ws(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u9=/^https?/;async function f9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await c9(t);for(const r of e)try{if(h9(r))return}catch{}$n(t,"unauthorized-domain")}function h9(t){const e=$p(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!u9.test(r))return!1;if(l9.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d9=new su(3e4,6e4);function J_(){const t=os().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function p9(t){return new Promise((e,r)=>{var s,i,a;function n(){J_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{J_(),r(as(t,"network-request-failed"))},timeout:d9.get()})}if((i=(s=os().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=os().gapi)!=null&&a.load)n();else{const o=nM("iframefcb");return os()[o]=()=>{gapi.load?n():r(as(t,"network-request-failed"))},Bk(`${rM()}?onload=${o}`).catch(c=>r(c))}}).catch(e=>{throw Af=null,e})}let Af=null;function m9(t){return Af=Af||p9(t),Af}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g9=new su(5e3,15e3),v9="__/auth/iframe",x9="emulator/auth/iframe",_9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},y9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E9(t){const e=t.config;Ne(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Vg(e,x9):`https://${t.config.authDomain}/${v9}`,n={apiKey:e.apiKey,appName:t.name,v:tc},s=y9.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${nu(n).slice(1)}`}async function w9(t){const e=await m9(t),r=os().gapi;return Ne(r,t,"internal-error"),e.open({where:document.body,url:E9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_9,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=as(t,"network-request-failed"),o=os().setTimeout(()=>{i(a)},g9.get());function c(){os().clearTimeout(o),s(n)}n.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k9=500,A9=600,S9="_blank",I9="http://localhost";class Z_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function C9(t,e,r,n=k9,s=A9){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...T9,width:n.toString(),height:s.toString(),top:i,left:a},l=Fr().toLowerCase();r&&(o=Dk(l)?S9:r),Nk(l)&&(e=e||I9,c.scrollbars="yes");const f=Object.entries(c).reduce((d,[m,g])=>`${d}${m}=${g},`,"");if(K5(l)&&o!=="_self")return R9(e||"",o),new Z_(null);const h=window.open(e||"",o,f);Ne(h,t,"popup-blocked");try{h.focus()}catch{}return new Z_(h)}function R9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9="__/auth/handler",N9="emulator/auth/handler",F9=encodeURIComponent("fac");async function ey(t,e,r,n,s,i){Ne(t.config.authDomain,t,"auth-domain-config-required"),Ne(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:tc,eventId:s};if(e instanceof Hk){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",hb(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof au){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const c=await t._getAppCheckToken(),l=c?`#${F9}=${encodeURIComponent(c)}`:"";return`${D9(t)}?${nu(o).slice(1)}${l}`}function D9({config:t}){return t.emulator?Vg(t,N9):`https://${t.authDomain}/${P9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd="webStorageSupport";class O9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yk,this._completeRedirectFn=s9,this._overrideRedirectResult=t9}async _openPopup(e,r,n,s){var a;Bs((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await ey(e,r,n,$p(),s);return C9(e,i,Hg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await ey(e,r,n,$p(),s);return MM(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Bs(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await w9(e),n=new a9(e);return r.register("authEvent",s=>(Ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Sd,{type:Sd},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Sd];i!==void 0&&r(!!i),$n(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=f9(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Vk()||Fk()||Bg()}}const L9=O9;var ty="@firebase/auth",ry="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function V9(t){ds(new Hn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Ne(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Uk(t)},l=new Z5(n,s,i,c);return lM(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ds(new Hn("auth-internal",e=>{const r=Va(e.getProvider("auth").getImmediate());return(n=>new b9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),wn(ty,ry,M9(t)),wn(ty,ry,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U9=5*60,B9=fk("authIdTokenMaxAge")||U9;let ny=null;const j9=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>B9)return;const s=r==null?void 0:r.token;ny!==s&&(ny=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function z9(t=bg()){const e=Ma(t,"auth");if(e.isInitialized())return e.getImmediate();const r=cM(t,{popupRedirectResolver:L9,persistence:[GM,OM,Yk]}),n=fk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=j9(i.toString());RM(r,a,()=>a(r.currentUser)),CM(r,o=>a(o))}}const s=lk("auth");return s&&uM(r,`http://${s}`),r}function H9(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}eM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=as("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",H9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});V9("Browser");var $9="firebase",W9="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn($9,W9,"app");var sy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ai,nA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,k){function A(){}A.prototype=k.prototype,_.D=k.prototype,_.prototype=new A,_.prototype.constructor=_,_.C=function(I,R,C){for(var N=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)N[ye-2]=arguments[ye];return k.prototype[R].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,k,A){A||(A=0);var I=Array(16);if(typeof k=="string")for(var R=0;16>R;++R)I[R]=k.charCodeAt(A++)|k.charCodeAt(A++)<<8|k.charCodeAt(A++)<<16|k.charCodeAt(A++)<<24;else for(R=0;16>R;++R)I[R]=k[A++]|k[A++]<<8|k[A++]<<16|k[A++]<<24;k=_.g[0],A=_.g[1],R=_.g[2];var C=_.g[3],N=k+(C^A&(R^C))+I[0]+3614090360&4294967295;k=A+(N<<7&4294967295|N>>>25),N=C+(R^k&(A^R))+I[1]+3905402710&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(A^C&(k^A))+I[2]+606105819&4294967295,R=C+(N<<17&4294967295|N>>>15),N=A+(k^R&(C^k))+I[3]+3250441966&4294967295,A=R+(N<<22&4294967295|N>>>10),N=k+(C^A&(R^C))+I[4]+4118548399&4294967295,k=A+(N<<7&4294967295|N>>>25),N=C+(R^k&(A^R))+I[5]+1200080426&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(A^C&(k^A))+I[6]+2821735955&4294967295,R=C+(N<<17&4294967295|N>>>15),N=A+(k^R&(C^k))+I[7]+4249261313&4294967295,A=R+(N<<22&4294967295|N>>>10),N=k+(C^A&(R^C))+I[8]+1770035416&4294967295,k=A+(N<<7&4294967295|N>>>25),N=C+(R^k&(A^R))+I[9]+2336552879&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(A^C&(k^A))+I[10]+4294925233&4294967295,R=C+(N<<17&4294967295|N>>>15),N=A+(k^R&(C^k))+I[11]+2304563134&4294967295,A=R+(N<<22&4294967295|N>>>10),N=k+(C^A&(R^C))+I[12]+1804603682&4294967295,k=A+(N<<7&4294967295|N>>>25),N=C+(R^k&(A^R))+I[13]+4254626195&4294967295,C=k+(N<<12&4294967295|N>>>20),N=R+(A^C&(k^A))+I[14]+2792965006&4294967295,R=C+(N<<17&4294967295|N>>>15),N=A+(k^R&(C^k))+I[15]+1236535329&4294967295,A=R+(N<<22&4294967295|N>>>10),N=k+(R^C&(A^R))+I[1]+4129170786&4294967295,k=A+(N<<5&4294967295|N>>>27),N=C+(A^R&(k^A))+I[6]+3225465664&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^A&(C^k))+I[11]+643717713&4294967295,R=C+(N<<14&4294967295|N>>>18),N=A+(C^k&(R^C))+I[0]+3921069994&4294967295,A=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(A^R))+I[5]+3593408605&4294967295,k=A+(N<<5&4294967295|N>>>27),N=C+(A^R&(k^A))+I[10]+38016083&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^A&(C^k))+I[15]+3634488961&4294967295,R=C+(N<<14&4294967295|N>>>18),N=A+(C^k&(R^C))+I[4]+3889429448&4294967295,A=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(A^R))+I[9]+568446438&4294967295,k=A+(N<<5&4294967295|N>>>27),N=C+(A^R&(k^A))+I[14]+3275163606&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^A&(C^k))+I[3]+4107603335&4294967295,R=C+(N<<14&4294967295|N>>>18),N=A+(C^k&(R^C))+I[8]+1163531501&4294967295,A=R+(N<<20&4294967295|N>>>12),N=k+(R^C&(A^R))+I[13]+2850285829&4294967295,k=A+(N<<5&4294967295|N>>>27),N=C+(A^R&(k^A))+I[2]+4243563512&4294967295,C=k+(N<<9&4294967295|N>>>23),N=R+(k^A&(C^k))+I[7]+1735328473&4294967295,R=C+(N<<14&4294967295|N>>>18),N=A+(C^k&(R^C))+I[12]+2368359562&4294967295,A=R+(N<<20&4294967295|N>>>12),N=k+(A^R^C)+I[5]+4294588738&4294967295,k=A+(N<<4&4294967295|N>>>28),N=C+(k^A^R)+I[8]+2272392833&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^A)+I[11]+1839030562&4294967295,R=C+(N<<16&4294967295|N>>>16),N=A+(R^C^k)+I[14]+4259657740&4294967295,A=R+(N<<23&4294967295|N>>>9),N=k+(A^R^C)+I[1]+2763975236&4294967295,k=A+(N<<4&4294967295|N>>>28),N=C+(k^A^R)+I[4]+1272893353&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^A)+I[7]+4139469664&4294967295,R=C+(N<<16&4294967295|N>>>16),N=A+(R^C^k)+I[10]+3200236656&4294967295,A=R+(N<<23&4294967295|N>>>9),N=k+(A^R^C)+I[13]+681279174&4294967295,k=A+(N<<4&4294967295|N>>>28),N=C+(k^A^R)+I[0]+3936430074&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^A)+I[3]+3572445317&4294967295,R=C+(N<<16&4294967295|N>>>16),N=A+(R^C^k)+I[6]+76029189&4294967295,A=R+(N<<23&4294967295|N>>>9),N=k+(A^R^C)+I[9]+3654602809&4294967295,k=A+(N<<4&4294967295|N>>>28),N=C+(k^A^R)+I[12]+3873151461&4294967295,C=k+(N<<11&4294967295|N>>>21),N=R+(C^k^A)+I[15]+530742520&4294967295,R=C+(N<<16&4294967295|N>>>16),N=A+(R^C^k)+I[2]+3299628645&4294967295,A=R+(N<<23&4294967295|N>>>9),N=k+(R^(A|~C))+I[0]+4096336452&4294967295,k=A+(N<<6&4294967295|N>>>26),N=C+(A^(k|~R))+I[7]+1126891415&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~A))+I[14]+2878612391&4294967295,R=C+(N<<15&4294967295|N>>>17),N=A+(C^(R|~k))+I[5]+4237533241&4294967295,A=R+(N<<21&4294967295|N>>>11),N=k+(R^(A|~C))+I[12]+1700485571&4294967295,k=A+(N<<6&4294967295|N>>>26),N=C+(A^(k|~R))+I[3]+2399980690&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~A))+I[10]+4293915773&4294967295,R=C+(N<<15&4294967295|N>>>17),N=A+(C^(R|~k))+I[1]+2240044497&4294967295,A=R+(N<<21&4294967295|N>>>11),N=k+(R^(A|~C))+I[8]+1873313359&4294967295,k=A+(N<<6&4294967295|N>>>26),N=C+(A^(k|~R))+I[15]+4264355552&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~A))+I[6]+2734768916&4294967295,R=C+(N<<15&4294967295|N>>>17),N=A+(C^(R|~k))+I[13]+1309151649&4294967295,A=R+(N<<21&4294967295|N>>>11),N=k+(R^(A|~C))+I[4]+4149444226&4294967295,k=A+(N<<6&4294967295|N>>>26),N=C+(A^(k|~R))+I[11]+3174756917&4294967295,C=k+(N<<10&4294967295|N>>>22),N=R+(k^(C|~A))+I[2]+718787259&4294967295,R=C+(N<<15&4294967295|N>>>17),N=A+(C^(R|~k))+I[9]+3951481745&4294967295,_.g[0]=_.g[0]+k&4294967295,_.g[1]=_.g[1]+(R+(N<<21&4294967295|N>>>11))&4294967295,_.g[2]=_.g[2]+R&4294967295,_.g[3]=_.g[3]+C&4294967295}n.prototype.u=function(_,k){k===void 0&&(k=_.length);for(var A=k-this.blockSize,I=this.B,R=this.h,C=0;C<k;){if(R==0)for(;C<=A;)s(this,_,C),C+=this.blockSize;if(typeof _=="string"){for(;C<k;)if(I[R++]=_.charCodeAt(C++),R==this.blockSize){s(this,I),R=0;break}}else for(;C<k;)if(I[R++]=_[C++],R==this.blockSize){s(this,I),R=0;break}}this.h=R,this.o+=k},n.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var k=1;k<_.length-8;++k)_[k]=0;var A=8*this.o;for(k=_.length-8;k<_.length;++k)_[k]=A&255,A/=256;for(this.u(_),_=Array(16),k=A=0;4>k;++k)for(var I=0;32>I;I+=8)_[A++]=this.g[k]>>>I&255;return _};function i(_,k){var A=o;return Object.prototype.hasOwnProperty.call(A,_)?A[_]:A[_]=k(_)}function a(_,k){this.h=k;for(var A=[],I=!0,R=_.length-1;0<=R;R--){var C=_[R]|0;I&&C==k||(A[R]=C,I=!1)}this.g=A}var o={};function c(_){return-128<=_&&128>_?i(_,function(k){return new a([k|0],0>k?-1:0)}):new a([_|0],0>_?-1:0)}function l(_){if(isNaN(_)||!isFinite(_))return h;if(0>_)return E(l(-_));for(var k=[],A=1,I=0;_>=A;I++)k[I]=_/A|0,A*=4294967296;return new a(k,0)}function f(_,k){if(_.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(_.charAt(0)=="-")return E(f(_.substring(1),k));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=l(Math.pow(k,8)),I=h,R=0;R<_.length;R+=8){var C=Math.min(8,_.length-R),N=parseInt(_.substring(R,R+C),k);8>C?(C=l(Math.pow(k,C)),I=I.j(C).add(l(N))):(I=I.j(A),I=I.add(l(N)))}return I}var h=c(0),d=c(1),m=c(16777216);t=a.prototype,t.m=function(){if(v(this))return-E(this).m();for(var _=0,k=1,A=0;A<this.g.length;A++){var I=this.i(A);_+=(0<=I?I:4294967296+I)*k,k*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(g(this))return"0";if(v(this))return"-"+E(this).toString(_);for(var k=l(Math.pow(_,6)),A=this,I="";;){var R=O(A,k).g;A=T(A,R.j(k));var C=((0<A.g.length?A.g[0]:A.h)>>>0).toString(_);if(A=R,g(A))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function g(_){if(_.h!=0)return!1;for(var k=0;k<_.g.length;k++)if(_.g[k]!=0)return!1;return!0}function v(_){return _.h==-1}t.l=function(_){return _=T(this,_),v(_)?-1:g(_)?0:1};function E(_){for(var k=_.g.length,A=[],I=0;I<k;I++)A[I]=~_.g[I];return new a(A,~_.h).add(d)}t.abs=function(){return v(this)?E(this):this},t.add=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0,R=0;R<=k;R++){var C=I+(this.i(R)&65535)+(_.i(R)&65535),N=(C>>>16)+(this.i(R)>>>16)+(_.i(R)>>>16);I=N>>>16,C&=65535,N&=65535,A[R]=N<<16|C}return new a(A,A[A.length-1]&-2147483648?-1:0)};function T(_,k){return _.add(E(k))}t.j=function(_){if(g(this)||g(_))return h;if(v(this))return v(_)?E(this).j(E(_)):E(E(this).j(_));if(v(_))return E(this.j(E(_)));if(0>this.l(m)&&0>_.l(m))return l(this.m()*_.m());for(var k=this.g.length+_.g.length,A=[],I=0;I<2*k;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<_.g.length;R++){var C=this.i(I)>>>16,N=this.i(I)&65535,ye=_.i(R)>>>16,he=_.i(R)&65535;A[2*I+2*R]+=N*he,w(A,2*I+2*R),A[2*I+2*R+1]+=C*he,w(A,2*I+2*R+1),A[2*I+2*R+1]+=N*ye,w(A,2*I+2*R+1),A[2*I+2*R+2]+=C*ye,w(A,2*I+2*R+2)}for(I=0;I<k;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=k;I<2*k;I++)A[I]=0;return new a(A,0)};function w(_,k){for(;(_[k]&65535)!=_[k];)_[k+1]+=_[k]>>>16,_[k]&=65535,k++}function x(_,k){this.g=_,this.h=k}function O(_,k){if(g(k))throw Error("division by zero");if(g(_))return new x(h,h);if(v(_))return k=O(E(_),k),new x(E(k.g),E(k.h));if(v(k))return k=O(_,E(k)),new x(E(k.g),k.h);if(30<_.g.length){if(v(_)||v(k))throw Error("slowDivide_ only works with positive integers.");for(var A=d,I=k;0>=I.l(_);)A=z(A),I=z(I);var R=B(A,1),C=B(I,1);for(I=B(I,2),A=B(A,2);!g(I);){var N=C.add(I);0>=N.l(_)&&(R=R.add(A),C=N),I=B(I,1),A=B(A,1)}return k=T(_,R.j(k)),new x(R,k)}for(R=h;0<=_.l(k);){for(A=Math.max(1,Math.floor(_.m()/k.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=l(A),N=C.j(k);v(N)||0<N.l(_);)A-=I,C=l(A),N=C.j(k);g(C)&&(C=d),R=R.add(C),_=T(_,N)}return new x(R,_)}t.A=function(_){return O(this,_).h},t.and=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)&_.i(I);return new a(A,this.h&_.h)},t.or=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)|_.i(I);return new a(A,this.h|_.h)},t.xor=function(_){for(var k=Math.max(this.g.length,_.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)^_.i(I);return new a(A,this.h^_.h)};function z(_){for(var k=_.g.length+1,A=[],I=0;I<k;I++)A[I]=_.i(I)<<1|_.i(I-1)>>>31;return new a(A,_.h)}function B(_,k){var A=k>>5;k%=32;for(var I=_.g.length-A,R=[],C=0;C<I;C++)R[C]=0<k?_.i(C+A)>>>k|_.i(C+A+1)<<32-k:_.i(C+A);return new a(R,_.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,nA=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=f,Ai=a}).apply(typeof sy<"u"?sy:typeof self<"u"?self:typeof window<"u"?window:{});var rf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sA,bc,iA,Sf,qp,aA,oA,cA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,y){return u==Array.prototype||u==Object.prototype||(u[p]=y.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof rf=="object"&&rf];for(var p=0;p<u.length;++p){var y=u[p];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=r(this);function s(u,p){if(p)e:{var y=n;u=u.split(".");for(var P=0;P<u.length-1;P++){var q=u[P];if(!(q in y))break e;y=y[q]}u=u[u.length-1],P=y[u],p=p(P),p!=P&&p!=null&&e(y,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var y=0,P=!1,q={next:function(){if(!P&&y<u.length){var Z=y++;return{value:p(Z,u[Z]),done:!1}}return P=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function l(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function f(u,p,y){return u.call.apply(u.bind,arguments)}function h(u,p,y){if(!u)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,P),u.apply(p,q)}}return function(){return u.apply(p,arguments)}}function d(u,p,y){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,p){var y=Array.prototype.slice.call(arguments,1);return function(){var P=y.slice();return P.push.apply(P,arguments),u.apply(this,P)}}function g(u,p){function y(){}y.prototype=p.prototype,u.aa=p.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(P,q,Z){for(var me=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)me[ft-2]=arguments[ft];return p.prototype[q].apply(P,me)}}function v(u){const p=u.length;if(0<p){const y=Array(p);for(let P=0;P<p;P++)y[P]=u[P];return y}return[]}function E(u,p){for(let y=1;y<arguments.length;y++){const P=arguments[y];if(c(P)){const q=u.length||0,Z=P.length||0;u.length=q+Z;for(let me=0;me<Z;me++)u[q+me]=P[me]}else u.push(P)}}class T{constructor(p,y){this.i=p,this.j=y,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(u){return/^[\s\xa0]*$/.test(u)}function x(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var z=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function B(u,p,y){for(const P in u)p.call(y,u[P],P,u)}function _(u,p){for(const y in u)p.call(void 0,u[y],y,u)}function k(u){const p={};for(const y in u)p[y]=u[y];return p}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,p){let y,P;for(let q=1;q<arguments.length;q++){P=arguments[q];for(y in P)u[y]=P[y];for(let Z=0;Z<A.length;Z++)y=A[Z],Object.prototype.hasOwnProperty.call(P,y)&&(u[y]=P[y])}}function R(u){var p=1;u=u.split(":");const y=[];for(;0<p&&u.length;)y.push(u.shift()),p--;return u.length&&y.push(u.join(":")),y}function C(u){o.setTimeout(()=>{throw u},0)}function N(){var u=W;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class ye{constructor(){this.h=this.g=null}add(p,y){const P=he.get();P.set(p,y),this.h?this.h.next=P:this.g=P,this.h=P}}var he=new T(()=>new we,u=>u.reset());class we{constructor(){this.next=this.g=this.h=null}set(p,y){this.h=p,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,ie=!1,W=new ye,le=()=>{const u=o.Promise.resolve(void 0);ge=()=>{u.then(Te)}};var Te=()=>{for(var u;u=N();){try{u.h.call(u.g)}catch(y){C(y)}var p=he;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ie=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const y=()=>{};o.addEventListener("test",y,p),o.removeEventListener("test",y,p)}catch{}return u}();function H(u,p){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,P=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(z){e:{try{O(p.nodeName);var q=!0;break e}catch{}q=!1}q||(p=null)}}else y=="mouseover"?p=u.fromElement:y=="mouseout"&&(p=u.toElement);this.relatedTarget=p,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:te[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}g(H,K);var te={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),ke=0;function de(u,p,y,P,q){this.listener=u,this.proxy=null,this.src=p,this.type=y,this.capture=!!P,this.ha=q,this.key=++ke,this.da=this.fa=!1}function ae(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Le(u){this.src=u,this.g={},this.h=0}Le.prototype.add=function(u,p,y,P,q){var Z=u.toString();u=this.g[Z],u||(u=this.g[Z]=[],this.h++);var me=at(u,p,P,q);return-1<me?(p=u[me],y||(p.fa=!1)):(p=new de(p,this.src,Z,!!P,q),p.fa=y,u.push(p)),p};function j(u,p){var y=p.type;if(y in u.g){var P=u.g[y],q=Array.prototype.indexOf.call(P,p,void 0),Z;(Z=0<=q)&&Array.prototype.splice.call(P,q,1),Z&&(ae(p),u.g[y].length==0&&(delete u.g[y],u.h--))}}function at(u,p,y,P){for(var q=0;q<u.length;++q){var Z=u[q];if(!Z.da&&Z.listener==p&&Z.capture==!!y&&Z.ha==P)return q}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),Xe={};function je(u,p,y,P,q){if(Array.isArray(p)){for(var Z=0;Z<p.length;Z++)je(u,p[Z],y,P,q);return null}return y=rt(y),u&&u[ue]?u.K(p,y,l(P)?!!P.capture:!1,q):ve(u,p,y,!1,P,q)}function ve(u,p,y,P,q,Z){if(!p)throw Error("Invalid event type");var me=l(q)?!!q.capture:!!q,ft=De(u);if(ft||(u[$e]=ft=new Le(u)),y=ft.add(p,y,P,me,Z),y.proxy)return y;if(P=mt(),y.proxy=P,P.src=u,P.listener=y,u.addEventListener)G||(q=me),q===void 0&&(q=!1),u.addEventListener(p.toString(),P,q);else if(u.attachEvent)u.attachEvent(Ce(p.toString()),P);else if(u.addListener&&u.removeListener)u.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return y}function mt(){function u(y){return p.call(u.src,u.listener,y)}const p=Re;return u}function re(u,p,y,P,q){if(Array.isArray(p))for(var Z=0;Z<p.length;Z++)re(u,p[Z],y,P,q);else P=l(P)?!!P.capture:!!P,y=rt(y),u&&u[ue]?(u=u.i,p=String(p).toString(),p in u.g&&(Z=u.g[p],y=at(Z,y,P,q),-1<y&&(ae(Z[y]),Array.prototype.splice.call(Z,y,1),Z.length==0&&(delete u.g[p],u.h--)))):u&&(u=De(u))&&(p=u.g[p.toString()],u=-1,p&&(u=at(p,y,P,q)),(y=-1<u?p[u]:null)&&_e(y))}function _e(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[ue])j(p.i,u);else{var y=u.type,P=u.proxy;p.removeEventListener?p.removeEventListener(y,P,u.capture):p.detachEvent?p.detachEvent(Ce(y),P):p.addListener&&p.removeListener&&p.removeListener(P),(y=De(p))?(j(y,u),y.h==0&&(y.src=null,p[$e]=null)):ae(u)}}}function Ce(u){return u in Xe?Xe[u]:Xe[u]="on"+u}function Re(u,p){if(u.da)u=!0;else{p=new H(p,this);var y=u.listener,P=u.ha||u.src;u.fa&&_e(u),u=y.call(P,p)}return u}function De(u){return u=u[$e],u instanceof Le?u:null}var Ve="__closure_events_fn_"+(1e9*Math.random()>>>0);function rt(u){return typeof u=="function"?u:(u[Ve]||(u[Ve]=function(p){return u.handleEvent(p)}),u[Ve])}function Ye(){M.call(this),this.i=new Le(this),this.M=this,this.F=null}g(Ye,M),Ye.prototype[ue]=!0,Ye.prototype.removeEventListener=function(u,p,y,P){re(this,u,p,y,P)};function gt(u,p){var y,P=u.F;if(P)for(y=[];P;P=P.F)y.push(P);if(u=u.M,P=p.type||p,typeof p=="string")p=new K(p,u);else if(p instanceof K)p.target=p.target||u;else{var q=p;p=new K(P,u),I(p,q)}if(q=!0,y)for(var Z=y.length-1;0<=Z;Z--){var me=p.g=y[Z];q=Rt(me,P,!0,p)&&q}if(me=p.g=u,q=Rt(me,P,!0,p)&&q,q=Rt(me,P,!1,p)&&q,y)for(Z=0;Z<y.length;Z++)me=p.g=y[Z],q=Rt(me,P,!1,p)&&q}Ye.prototype.N=function(){if(Ye.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var y=u.g[p],P=0;P<y.length;P++)ae(y[P]);delete u.g[p],u.h--}}this.F=null},Ye.prototype.K=function(u,p,y,P){return this.i.add(String(u),p,!1,y,P)},Ye.prototype.L=function(u,p,y,P){return this.i.add(String(u),p,!0,y,P)};function Rt(u,p,y,P){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var q=!0,Z=0;Z<p.length;++Z){var me=p[Z];if(me&&!me.da&&me.capture==y){var ft=me.listener,or=me.ha||me.src;me.fa&&j(u.i,me),q=ft.call(or,P)!==!1&&q}}return q&&!P.defaultPrevented}function Jr(u,p,y){if(typeof u=="function")y&&(u=d(u,y));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function He(u){u.g=Jr(()=>{u.g=null,u.i&&(u.i=!1,He(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class kt extends M{constructor(p,y){super(),this.m=p,this.l=y,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function er(u){M.call(this),this.h=u,this.g={}}g(er,M);var Pt=[];function qn(u){B(u.g,function(p,y){this.g.hasOwnProperty(y)&&_e(p)},u),u.g={}}er.prototype.N=function(){er.aa.N.call(this),qn(this)},er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ha=o.JSON.stringify,I0=o.JSON.parse,C0=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function $a(){}$a.prototype.h=null;function cc(u){return u.h||(u.h=u.i())}function lc(){}var Gi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function uc(){K.call(this,"d")}g(uc,K);function Gs(){K.call(this,"c")}g(Gs,K);var vs={},pu=null;function Wa(){return pu=pu||new Ye}vs.La="serverreachability";function mu(u){K.call(this,vs.La,u)}g(mu,K);function Ki(u){const p=Wa();gt(p,new mu(p))}vs.STAT_EVENT="statevent";function gu(u,p){K.call(this,vs.STAT_EVENT,u),this.stat=p}g(gu,K);function ar(u){const p=Wa();gt(p,new gu(p,u))}vs.Ma="timingevent";function vu(u,p){K.call(this,vs.Ma,u),this.size=p}g(vu,K);function xs(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function qi(){this.g=!0}qi.prototype.xa=function(){this.g=!1};function R0(u,p,y,P,q,Z){u.info(function(){if(u.g)if(Z)for(var me="",ft=Z.split("&"),or=0;or<ft.length;or++){var it=ft[or].split("=");if(1<it.length){var vr=it[0];it=it[1];var xr=vr.split("_");me=2<=xr.length&&xr[1]=="type"?me+(vr+"="+it+"&"):me+(vr+"=redacted&")}}else me=null;else me=Z;return"XMLHTTP REQ ("+P+") [attempt "+q+"]: "+p+`
`+y+`
`+me})}function P0(u,p,y,P,q,Z,me){u.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+q+"]: "+p+`
`+y+`
`+Z+" "+me})}function S(u,p,y,P){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+D(u,y)+(P?" "+P:"")})}function b(u,p){u.info(function(){return"TIMEOUT: "+p})}qi.prototype.info=function(){};function D(u,p){if(!u.g)return p;if(!p)return null;try{var y=JSON.parse(p);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var P=y[u];if(!(2>P.length)){var q=P[1];if(Array.isArray(q)&&!(1>q.length)){var Z=q[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(var me=1;me<q.length;me++)q[me]=""}}}}return Ha(y)}catch{return p}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function X(){}g(X,$a),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},U=new X;function ee(u,p,y,P){this.j=u,this.i=p,this.l=y,this.R=P||1,this.U=new er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},J={};function oe(u,p,y){u.L=1,u.v=yu(ys(p)),u.m=y,u.P=!0,pe(u,null)}function pe(u,p){u.F=Date.now(),xe(u),u.A=ys(u.v);var y=u.A,P=u.R;Array.isArray(P)||(P=[String(P)]),B1(y.i,"t",P),u.C=0,y=u.j.J,u.h=new Y,u.g=sv(u.j,y?p:null,!u.m),0<u.O&&(u.M=new kt(d(u.Y,u,u.g),u.O)),p=u.U,y=u.g,P=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(Pt[0]=q.toString()),q=Pt);for(var Z=0;Z<q.length;Z++){var me=je(y,q[Z],P||p.handleEvent,!1,p.h||p);if(!me)break;p.g[me.key]=me}p=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Ki(),R0(u.i,u.u,u.A,u.l,u.R,u.m)}ee.prototype.ca=function(u){u=u.target;const p=this.M;p&&Es(u)==3?p.j():this.Y(u)},ee.prototype.Y=function(u){try{if(u==this.g)e:{const xr=Es(this.g);var p=this.g.Ba();const Xa=this.g.Z();if(!(3>xr)&&(xr!=3||this.g&&(this.h.h||this.g.oa()||K1(this.g)))){this.J||xr!=4||p==7||(p==8||0>=Xa?Ki(3):Ki(2)),ut(this);var y=this.g.Z();this.X=y;t:if(Ae(this)){var P=K1(this.g);u="";var q=P.length,Z=Es(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Et(this),ct(this);var me="";break t}this.h.i=new o.TextDecoder}for(p=0;p<q;p++)this.h.h=!0,u+=this.h.i.decode(P[p],{stream:!(Z&&p==q-1)});P.length=0,this.h.g+=u,this.C=0,me=this.h.g}else me=this.g.oa();if(this.o=y==200,P0(this.i,this.u,this.A,this.l,this.R,xr,y),this.o){if(this.T&&!this.K){t:{if(this.g){var ft,or=this.g;if((ft=or.g?or.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(ft)){var it=ft;break t}}it=null}if(y=it)S(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_s(this,y);else{this.o=!1,this.s=3,ar(12),Et(this),ct(this);break e}}if(this.P){y=!0;let Cn;for(;!this.J&&this.C<me.length;)if(Cn=fe(this,me),Cn==J){xr==4&&(this.s=4,ar(14),y=!1),S(this.i,this.l,null,"[Incomplete Response]");break}else if(Cn==Q){this.s=4,ar(15),S(this.i,this.l,me,"[Invalid Chunk]"),y=!1;break}else S(this.i,this.l,Cn,null),_s(this,Cn);if(Ae(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xr!=4||me.length!=0||this.h.h||(this.s=1,ar(16),y=!1),this.o=this.o&&y,!y)S(this.i,this.l,me,"[Invalid Chunked Response]"),Et(this),ct(this);else if(0<me.length&&!this.W){this.W=!0;var vr=this.j;vr.g==this&&vr.ba&&!vr.M&&(vr.j.info("Great, no buffering proxy detected. Bytes received: "+me.length),L0(vr),vr.M=!0,ar(11))}}else S(this.i,this.l,me,null),_s(this,me);xr==4&&Et(this),this.o&&!this.J&&(xr==4?ev(this.j,this):(this.o=!1,xe(this)))}else II(this.g),y==400&&0<me.indexOf("Unknown SID")?(this.s=3,ar(12)):(this.s=0,ar(13)),Et(this),ct(this)}}}catch{}finally{}};function Ae(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function fe(u,p){var y=u.C,P=p.indexOf(`
`,y);return P==-1?J:(y=Number(p.substring(y,P)),isNaN(y)?Q:(P+=1,P+y>p.length?J:(p=p.slice(P,P+y),u.C=P+y,p)))}ee.prototype.cancel=function(){this.J=!0,Et(this)};function xe(u){u.S=Date.now()+u.I,be(u,u.I)}function be(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=xs(d(u.ba,u),p)}function ut(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ee.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(b(this.i,this.A),this.L!=2&&(Ki(),ar(17)),Et(this),this.s=2,ct(this)):be(this,this.S-u)};function ct(u){u.j.G==0||u.J||ev(u.j,u)}function Et(u){ut(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,qn(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function _s(u,p){try{var y=u.j;if(y.G!=0&&(y.g==u||Zr(y.h,u))){if(!u.K&&Zr(y.h,u)&&y.G==3){try{var P=y.Da.g.parse(p)}catch{P=null}if(Array.isArray(P)&&P.length==3){var q=P;if(q[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)Su(y),ku(y);else break e;O0(y),ar(18)}}else y.za=q[1],0<y.za-y.T&&37500>q[2]&&y.F&&y.v==0&&!y.C&&(y.C=xs(d(y.Za,y),6e3));if(1>=Ga(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Qi(y,11)}else if((u.K||y.g==u)&&Su(y),!w(p))for(q=y.Da.g.parse(p),p=0;p<q.length;p++){let it=q[p];if(y.T=it[0],it=it[1],y.G==2)if(it[0]=="c"){y.K=it[1],y.ia=it[2];const vr=it[3];vr!=null&&(y.la=vr,y.j.info("VER="+y.la));const xr=it[4];xr!=null&&(y.Aa=xr,y.j.info("SVER="+y.Aa));const Xa=it[5];Xa!=null&&typeof Xa=="number"&&0<Xa&&(P=1.5*Xa,y.L=P,y.j.info("backChannelRequestTimeoutMs_="+P)),P=y;const Cn=u.g;if(Cn){const Cu=Cn.g?Cn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cu){var Z=P.h;Z.g||Cu.indexOf("spdy")==-1&&Cu.indexOf("quic")==-1&&Cu.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(N0(Z,Z.h),Z.h=null))}if(P.D){const b0=Cn.g?Cn.g.getResponseHeader("X-HTTP-Session-Id"):null;b0&&(P.ya=b0,vt(P.I,P.D,b0))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),P=y;var me=u;if(P.qa=nv(P,P.J?P.ia:null,P.W),me.K){F1(P.h,me);var ft=me,or=P.L;or&&(ft.I=or),ft.B&&(ut(ft),xe(ft)),P.g=me}else J1(P);0<y.i.length&&Au(y)}else it[0]!="stop"&&it[0]!="close"||Qi(y,7);else y.G==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?Qi(y,7):D0(y):it[0]!="noop"&&y.l&&y.l.ta(it),y.v=0)}}Ki(4)}catch{}}var Xi=class{constructor(u,p){this.g=u,this.map=p}};function Ks(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ga(u){return u.h?1:u.g?u.g.size:0}function Zr(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function N0(u,p){u.g?u.g.add(p):u.h=p}function F1(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Ks.prototype.cancel=function(){if(this.i=D1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function D1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const y of u.g.values())p=p.concat(y.D);return p}return v(u.i)}function hI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],y=u.length,P=0;P<y;P++)p.push(u[P]);return p}p=[],y=0;for(P in u)p[y++]=u[P];return p}function dI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var y=0;y<u;y++)p.push(y);return p}p=[],y=0;for(const P in u)p[y++]=P;return p}}}function O1(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var y=dI(u),P=hI(u),q=P.length,Z=0;Z<q;Z++)p.call(void 0,P[Z],y&&y[Z],u)}var L1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pI(u,p){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var P=u[y].indexOf("="),q=null;if(0<=P){var Z=u[y].substring(0,P);q=u[y].substring(P+1)}else Z=u[y];p(Z,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Yi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Yi){this.h=u.h,xu(this,u.j),this.o=u.o,this.g=u.g,_u(this,u.s),this.l=u.l;var p=u.i,y=new dc;y.i=p.i,p.g&&(y.g=new Map(p.g),y.h=p.h),b1(this,y),this.m=u.m}else u&&(p=String(u).match(L1))?(this.h=!1,xu(this,p[1]||"",!0),this.o=fc(p[2]||""),this.g=fc(p[3]||"",!0),_u(this,p[4]),this.l=fc(p[5]||"",!0),b1(this,p[6]||"",!0),this.m=fc(p[7]||"")):(this.h=!1,this.i=new dc(null,this.h))}Yi.prototype.toString=function(){var u=[],p=this.j;p&&u.push(hc(p,M1,!0),":");var y=this.g;return(y||p=="file")&&(u.push("//"),(p=this.o)&&u.push(hc(p,M1,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(hc(y,y.charAt(0)=="/"?vI:gI,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",hc(y,_I)),u.join("")};function ys(u){return new Yi(u)}function xu(u,p,y){u.j=y?fc(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function _u(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function b1(u,p,y){p instanceof dc?(u.i=p,yI(u.i,u.h)):(y||(p=hc(p,xI)),u.i=new dc(p,u.h))}function vt(u,p,y){u.i.set(p,y)}function yu(u){return vt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function fc(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function hc(u,p,y){return typeof u=="string"?(u=encodeURI(u).replace(p,mI),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function mI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var M1=/[#\/\?@]/g,gI=/[#\?:]/g,vI=/[#\?]/g,xI=/[#\?@]/g,_I=/#/g;function dc(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function qs(u){u.g||(u.g=new Map,u.h=0,u.i&&pI(u.i,function(p,y){u.add(decodeURIComponent(p.replace(/\+/g," ")),y)}))}t=dc.prototype,t.add=function(u,p){qs(this),this.i=null,u=Ka(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(p),this.h+=1,this};function V1(u,p){qs(u),p=Ka(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function U1(u,p){return qs(u),p=Ka(u,p),u.g.has(p)}t.forEach=function(u,p){qs(this),this.g.forEach(function(y,P){y.forEach(function(q){u.call(p,q,P,this)},this)},this)},t.na=function(){qs(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),y=[];for(let P=0;P<p.length;P++){const q=u[P];for(let Z=0;Z<q.length;Z++)y.push(p[P])}return y},t.V=function(u){qs(this);let p=[];if(typeof u=="string")U1(this,u)&&(p=p.concat(this.g.get(Ka(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)p=p.concat(u[y])}return p},t.set=function(u,p){return qs(this),this.i=null,u=Ka(this,u),U1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function B1(u,p,y){V1(u,p),0<y.length&&(u.i=null,u.g.set(Ka(u,p),v(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var y=0;y<p.length;y++){var P=p[y];const Z=encodeURIComponent(String(P)),me=this.V(P);for(P=0;P<me.length;P++){var q=Z;me[P]!==""&&(q+="="+encodeURIComponent(String(me[P]))),u.push(q)}}return this.i=u.join("&")};function Ka(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function yI(u,p){p&&!u.j&&(qs(u),u.i=null,u.g.forEach(function(y,P){var q=P.toLowerCase();P!=q&&(V1(this,P),B1(this,q,y))},u)),u.j=p}function EI(u,p){const y=new qi;if(o.Image){const P=new Image;P.onload=m(Xs,y,"TestLoadImage: loaded",!0,p,P),P.onerror=m(Xs,y,"TestLoadImage: error",!1,p,P),P.onabort=m(Xs,y,"TestLoadImage: abort",!1,p,P),P.ontimeout=m(Xs,y,"TestLoadImage: timeout",!1,p,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=u}else p(!1)}function wI(u,p){const y=new qi,P=new AbortController,q=setTimeout(()=>{P.abort(),Xs(y,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:P.signal}).then(Z=>{clearTimeout(q),Z.ok?Xs(y,"TestPingServer: ok",!0,p):Xs(y,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(q),Xs(y,"TestPingServer: error",!1,p)})}function Xs(u,p,y,P,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),P(y)}catch{}}function TI(){this.g=new C0}function kI(u,p,y){const P=y||"";try{O1(u,function(q,Z){let me=q;l(q)&&(me=Ha(q)),p.push(P+Z+"="+encodeURIComponent(me))})}catch(q){throw p.push(P+"type="+encodeURIComponent("_badmap")),q}}function Eu(u){this.l=u.Ub||null,this.j=u.eb||!1}g(Eu,$a),Eu.prototype.g=function(){return new wu(this.l,this.j)},Eu.prototype.i=function(u){return function(){return u}}({});function wu(u,p){Ye.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(wu,Ye),t=wu.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,mc(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pc(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,mc(this)),this.g&&(this.readyState=3,mc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;j1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function j1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?pc(this):mc(this),this.readyState==3&&j1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,pc(this))},t.Qa=function(u){this.g&&(this.response=u,pc(this))},t.ga=function(){this.g&&pc(this)};function pc(u){u.readyState=4,u.l=null,u.j=null,u.v=null,mc(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var y=p.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=p.next();return u.join(`\r
`)};function mc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(wu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function z1(u){let p="";return B(u,function(y,P){p+=P,p+=":",p+=y,p+=`\r
`}),p}function F0(u,p,y){e:{for(P in y){var P=!1;break e}P=!0}P||(y=z1(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):vt(u,p,y))}function Nt(u){Ye.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Nt,Ye);var AI=/^https?$/i,SI=["POST","PUT"];t=Nt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,y,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?cc(this.o):cc(U),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(Z){H1(this,Z);return}if(u=y||"",y=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var q in P)y.set(q,P[q]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const Z of P.keys())y.set(Z,P.get(Z));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(y.keys()).find(Z=>Z.toLowerCase()=="content-type"),q=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(SI,p,void 0))||P||q||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,me]of y)this.g.setRequestHeader(Z,me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{G1(this),this.u=!0,this.g.send(u),this.u=!1}catch(Z){H1(this,Z)}};function H1(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,$1(u),Tu(u)}function $1(u){u.A||(u.A=!0,gt(u,"complete"),gt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,gt(this,"complete"),gt(this,"abort"),Tu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Tu(this,!0)),Nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?W1(this):this.bb())},t.bb=function(){W1(this)};function W1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Es(u)!=4||u.Z()!=2)){if(u.u&&Es(u)==4)Jr(u.Ea,0,u);else if(gt(u,"readystatechange"),Es(u)==4){u.h=!1;try{const me=u.Z();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var y;if(!(y=p)){var P;if(P=me===0){var q=String(u.D).match(L1)[1]||null;!q&&o.self&&o.self.location&&(q=o.self.location.protocol.slice(0,-1)),P=!AI.test(q?q.toLowerCase():"")}y=P}if(y)gt(u,"complete"),gt(u,"success");else{u.m=6;try{var Z=2<Es(u)?u.g.statusText:""}catch{Z=""}u.l=Z+" ["+u.Z()+"]",$1(u)}}finally{Tu(u)}}}}function Tu(u,p){if(u.g){G1(u);const y=u.g,P=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||gt(u,"ready");try{y.onreadystatechange=P}catch{}}}function G1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Es(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Es(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),I0(p)}};function K1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function II(u){const p={};u=(u.g&&2<=Es(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<u.length;P++){if(w(u[P]))continue;var y=R(u[P]);const q=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const Z=p[q]||[];p[q]=Z,Z.push(y)}_(p,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function gc(u,p,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||p}function q1(u){this.Aa=0,this.i=[],this.j=new qi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=gc("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=gc("baseRetryDelayMs",5e3,u),this.cb=gc("retryDelaySeedMs",1e4,u),this.Wa=gc("forwardChannelMaxRetries",2,u),this.wa=gc("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ks(u&&u.concurrentRequestLimit),this.Da=new TI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=q1.prototype,t.la=8,t.G=1,t.connect=function(u,p,y,P){ar(0),this.W=u,this.H=p||{},y&&P!==void 0&&(this.H.OSID=y,this.H.OAID=P),this.F=this.X,this.I=nv(this,null,this.W),Au(this)};function D0(u){if(X1(u),u.G==3){var p=u.U++,y=ys(u.I);if(vt(y,"SID",u.K),vt(y,"RID",p),vt(y,"TYPE","terminate"),vc(u,y),p=new ee(u,u.j,p),p.L=2,p.v=yu(ys(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!y&&o.Image&&(new Image().src=p.v,y=!0),y||(p.g=sv(p.j,null),p.g.ea(p.v)),p.F=Date.now(),xe(p)}rv(u)}function ku(u){u.g&&(L0(u),u.g.cancel(),u.g=null)}function X1(u){ku(u),u.u&&(o.clearTimeout(u.u),u.u=null),Su(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Au(u){if(!Xn(u.h)&&!u.s){u.s=!0;var p=u.Ga;ge||le(),ie||(ge(),ie=!0),W.add(p,u),u.B=0}}function CI(u,p){return Ga(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=xs(d(u.Ga,u,p),tv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new ee(this,this.j,u);let Z=this.o;if(this.S&&(Z?(Z=k(Z),I(Z,this.S)):Z=this.S),this.m!==null||this.O||(q.H=Z,Z=null),this.P)e:{for(var p=0,y=0;y<this.i.length;y++){t:{var P=this.i[y];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(p+=P,4096<p){p=y;break e}if(p===4096||y===this.i.length-1){p=y+1;break e}}p=1e3}else p=1e3;p=Q1(this,q,p),y=ys(this.I),vt(y,"RID",u),vt(y,"CVER",22),this.D&&vt(y,"X-HTTP-Session-Id",this.D),vc(this,y),Z&&(this.O?p="headers="+encodeURIComponent(String(z1(Z)))+"&"+p:this.m&&F0(y,this.m,Z)),N0(this.h,q),this.Ua&&vt(y,"TYPE","init"),this.P?(vt(y,"$req",p),vt(y,"SID","null"),q.T=!0,oe(q,y,null)):oe(q,y,p),this.G=2}}else this.G==3&&(u?Y1(this,u):this.i.length==0||Xn(this.h)||Y1(this))};function Y1(u,p){var y;p?y=p.l:y=u.U++;const P=ys(u.I);vt(P,"SID",u.K),vt(P,"RID",y),vt(P,"AID",u.T),vc(u,P),u.m&&u.o&&F0(P,u.m,u.o),y=new ee(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Q1(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),N0(u.h,y),oe(y,P,p)}function vc(u,p){u.H&&B(u.H,function(y,P){vt(p,P,y)}),u.l&&O1({},function(y,P){vt(p,P,y)})}function Q1(u,p,y){y=Math.min(u.i.length,y);var P=u.l?d(u.l.Na,u.l,u):null;e:{var q=u.i;let Z=-1;for(;;){const me=["count="+y];Z==-1?0<y?(Z=q[0].g,me.push("ofs="+Z)):Z=0:me.push("ofs="+Z);let ft=!0;for(let or=0;or<y;or++){let it=q[or].g;const vr=q[or].map;if(it-=Z,0>it)Z=Math.max(0,q[or].g-100),ft=!1;else try{kI(vr,me,"req"+it+"_")}catch{P&&P(vr)}}if(ft){P=me.join("&");break e}}}return u=u.i.splice(0,y),p.D=u,P}function J1(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;ge||le(),ie||(ge(),ie=!0),W.add(p,u),u.v=0}}function O0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=xs(d(u.Fa,u),tv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Z1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=xs(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ar(10),ku(this),Z1(this))};function L0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function Z1(u){u.g=new ee(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=ys(u.qa);vt(p,"RID","rpc"),vt(p,"SID",u.K),vt(p,"AID",u.T),vt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&vt(p,"TO",u.ja),vt(p,"TYPE","xmlhttp"),vc(u,p),u.m&&u.o&&F0(p,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=yu(ys(p)),y.m=null,y.P=!0,pe(y,u)}t.Za=function(){this.C!=null&&(this.C=null,ku(this),O0(this),ar(19))};function Su(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function ev(u,p){var y=null;if(u.g==p){Su(u),L0(u),u.g=null;var P=2}else if(Zr(u.h,p))y=p.D,F1(u.h,p),P=1;else return;if(u.G!=0){if(p.o)if(P==1){y=p.m?p.m.length:0,p=Date.now()-p.F;var q=u.B;P=Wa(),gt(P,new vu(P,y)),Au(u)}else J1(u);else if(q=p.s,q==3||q==0&&0<p.X||!(P==1&&CI(u,p)||P==2&&O0(u)))switch(y&&0<y.length&&(p=u.h,p.i=p.i.concat(y)),q){case 1:Qi(u,5);break;case 4:Qi(u,10);break;case 3:Qi(u,6);break;default:Qi(u,2)}}}function tv(u,p){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*p}function Qi(u,p){if(u.j.info("Error code "+p),p==2){var y=d(u.fb,u),P=u.Xa;const q=!P;P=new Yi(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||xu(P,"https"),yu(P),q?EI(P.toString(),y):wI(P.toString(),y)}else ar(2);u.G=0,u.l&&u.l.sa(p),rv(u),X1(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ar(2)):(this.j.info("Failed to ping google.com"),ar(1))};function rv(u){if(u.G=0,u.ka=[],u.l){const p=D1(u.h);(p.length!=0||u.i.length!=0)&&(E(u.ka,p),E(u.ka,u.i),u.h.i.length=0,v(u.i),u.i.length=0),u.l.ra()}}function nv(u,p,y){var P=y instanceof Yi?ys(y):new Yi(y);if(P.g!="")p&&(P.g=p+"."+P.g),_u(P,P.s);else{var q=o.location;P=q.protocol,p=p?p+"."+q.hostname:q.hostname,q=+q.port;var Z=new Yi(null);P&&xu(Z,P),p&&(Z.g=p),q&&_u(Z,q),y&&(Z.l=y),P=Z}return y=u.D,p=u.ya,y&&p&&vt(P,y,p),vt(P,"VER",u.la),vc(u,P),P}function sv(u,p,y){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Nt(new Eu({eb:y})):new Nt(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function iv(){}t=iv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Iu(){}Iu.prototype.g=function(u,p){return new en(u,p)};function en(u,p){Ye.call(this),this.g=new q1(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!w(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!w(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new qa(this)}g(en,Ye),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){D0(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=Ha(u),u=y);p.i.push(new Xi(p.Ya++,u)),p.G==3&&Au(p)},en.prototype.N=function(){this.g.l=null,delete this.j,D0(this.g),delete this.g,en.aa.N.call(this)};function av(u){uc.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const y in p){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}g(av,uc);function ov(){Gs.call(this),this.status=1}g(ov,Gs);function qa(u){this.g=u}g(qa,iv),qa.prototype.ua=function(){gt(this.g,"a")},qa.prototype.ta=function(u){gt(this.g,new av(u))},qa.prototype.sa=function(u){gt(this.g,new ov)},qa.prototype.ra=function(){gt(this.g,"b")},Iu.prototype.createWebChannel=Iu.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,cA=function(){return new Iu},oA=function(){return Wa()},aA=vs,qp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,Sf=L,V.COMPLETE="complete",iA=V,lc.EventType=Gi,Gi.OPEN="a",Gi.CLOSE="b",Gi.ERROR="c",Gi.MESSAGE="d",Ye.prototype.listen=Ye.prototype.K,bc=lc,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,sA=Nt}).apply(typeof rf<"u"?rf:typeof self<"u"?self:typeof window<"u"?window:{});const iy="@firebase/firestore",ay="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=new r0("@firebase/firestore");function Za(){return ka.logLevel}function Se(t,...e){if(ka.logLevel<=Ge.DEBUG){const r=e.map(Wg);ka.debug(`Firestore (${nc}): ${t}`,...r)}}function js(t,...e){if(ka.logLevel<=Ge.ERROR){const r=e.map(Wg);ka.error(`Firestore (${nc}): ${t}`,...r)}}function zo(t,...e){if(ka.logLevel<=Ge.WARN){const r=e.map(Wg);ka.warn(`Firestore (${nc}): ${t}`,...r)}}function Wg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,lA(t,n,r)}function lA(t,e,r){let n=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw js(n),new Error(n)}function ot(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||lA(e,s,n)}function Be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends Kn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Tr.UNAUTHENTICATED))}shutdown(){}}class K9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class q9{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ot(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new Ds;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ds,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},o=c=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ds)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ot(typeof n.accessToken=="string",31837,{l:n}),new uA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class X9{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y9{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new X9(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Q9{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){ot(this.o===void 0,3512);const n=i=>{i.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new oy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ot(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new oy(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=J9(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function Ke(t,e){return t<e?-1:t>e?1:0}function Xp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Id(s)===Id(i)?Ke(s,i):Id(s)?1:-1}return Ke(t.length,e.length)}const Z9=55296,eV=57343;function Id(t){const e=t.charCodeAt(0);return e>=Z9&&e<=eV}function Ho(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="__name__";class es{constructor(e,r,n){r===void 0?r=0:r>e.length&&Fe(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Fe(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return es.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof es?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=es.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return Ke(e.length,r.length)}static compareSegments(e,r){const n=es.isNumericId(e),s=es.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?es.extractNumericId(e).compare(es.extractNumericId(r)):Xp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ai.fromString(e.substring(4,e.length-2))}}class ht extends es{construct(e,r,n){return new ht(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ee(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new ht(r)}static emptyPath(){return new ht([])}}const tV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends es{construct(e,r,n){return new fr(e,r,n)}static isValidIdentifier(e){return tV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cy}static keyField(){return new fr([cy])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Ee(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ee(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ee(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Ee(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(r)}static emptyPath(){return new fr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(ht.fromString(e))}static fromName(e){return new Pe(ht.fromString(e).popFirst(5))}static empty(){return new Pe(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ht.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new ht(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(t,e,r){if(!r)throw new Ee(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function rV(t,e,r,n){if(e===!0&&n===!0)throw new Ee(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function ly(t){if(!Pe.isDocumentKey(t))throw new Ee(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uy(t){if(Pe.isDocumentKey(t))throw new Ee(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hA(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function a0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Fe(12329,{type:typeof t})}function Wn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ee(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=a0(t);throw new Ee(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(t,e){const r={typeString:t};return e&&(r.value=e),r}function cu(t,e){if(!hA(t))throw new Ee(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Ee(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy=-62135596800,hy=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*hy);return new _t(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ee(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ee(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<fy)throw new Ee(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hy}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cu(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Kt("string",_t._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{static fromTimestamp(e){return new Me(e)}static min(){return new Me(new _t(0,0))}static max(){return new Me(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul=-1;function nV(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Me.fromTimestamp(n===1e9?new _t(r+1,0):new _t(r,n));return new Di(s,Pe.empty(),e)}function sV(t){return new Di(t.readTime,t.key,Ul)}class Di{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Di(Me.min(),Pe.empty(),Ul)}static max(){return new Di(Me.max(),Pe.empty(),Ul)}}function iV(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Pe.comparator(t.documentKey,e.documentKey),r!==0?r:Ke(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sc(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==aV)throw t;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new se((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof se?r:se.resolve(r)}catch(r){return se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):se.reject(r)}static resolve(e){return new se((r,n)=>{r(e)})}static reject(e){return new se((r,n)=>{n(e)})}static waitFor(e){return new se((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},c=>n(c))}),a=!0,i===s&&r()})}static or(e){let r=se.resolve(!1);for(const n of e)r=r.next(s=>s?se.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new se((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let c=0;c<i;c++){const l=c;r(e[l]).next(f=>{a[l]=f,++o,o===i&&n(a)},f=>s(f))}})}static doWhile(e,r){return new se((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function cV(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function ic(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}o0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg=-1;function c0(t){return t==null}function wh(t){return t===0&&1/t==-1/0}function lV(t){return typeof t=="number"&&Number.isInteger(t)&&!wh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="";function uV(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=dy(e)),e=fV(t.get(r),e);return dy(e)}function fV(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case dA:r+="";break;default:r+=i}}return r}function dy(t){return t+dA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function $i(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,r){this.comparator=e,this.root=r||lr.EMPTY}insert(e,r){return new Ct(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,lr.BLACK,null,null))}remove(e){return new Ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nf(this.root,e,this.comparator,!1)}getReverseIterator(){return new nf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nf(this.root,e,this.comparator,!0)}}class nf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??lr.RED,this.left=s??lr.EMPTY,this.right=i??lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new lr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return lr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Fe(27949);return e+(this.isRed()?0:1)}}lr.EMPTY=null,lr.RED=!0,lr.BLACK=!1;lr.EMPTY=new class{constructor(){this.size=0}get key(){throw Fe(57766)}get value(){throw Fe(16141)}get color(){throw Fe(16727)}get left(){throw Fe(29726)}get right(){throw Fe(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new lr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new my(this.data.getIterator())}getIteratorFrom(e){return new my(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Zt(this.comparator);return r.data=e,r}}class my{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new an([])}unionWith(e){let r=new Zt(fr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new an(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mA("Invalid base64 string: "+i):i}}(e);return new gr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new gr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gr.EMPTY_BYTE_STRING=new gr("");const hV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oi(t){if(ot(!!t,39018),typeof t=="string"){let e=0;const r=hV.exec(t);if(ot(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Mt(t.seconds),nanos:Mt(t.nanos)}}function Mt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Li(t){return typeof t=="string"?gr.fromBase64String(t):gr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA="server_timestamp",vA="__type__",xA="__previous_value__",_A="__local_write_time__";function qg(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[vA])==null?void 0:n.stringValue)===gA}function l0(t){const e=t.mapValue.fields[xA];return qg(e)?l0(e):e}function Bl(t){const e=Oi(t.mapValue.fields[_A].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,r,n,s,i,a,o,c,l,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=f}}const Th="(default)";class jl{constructor(e,r){this.projectId=e,this.database=r||Th}static empty(){return new jl("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof jl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="__type__",pV="__max__",sf={mapValue:{}},EA="__vector__",kh="value";function bi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qg(t)?4:gV(t)?9007199254740991:mV(t)?10:11:Fe(28295,{value:t})}function ps(t,e){if(t===e)return!0;const r=bi(t);if(r!==bi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Bl(t).isEqual(Bl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Oi(s.timestampValue),o=Oi(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Li(s.bytesValue).isEqual(Li(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Mt(s.geoPointValue.latitude)===Mt(i.geoPointValue.latitude)&&Mt(s.geoPointValue.longitude)===Mt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Mt(s.integerValue)===Mt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Mt(s.doubleValue),o=Mt(i.doubleValue);return a===o?wh(a)===wh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Ho(t.arrayValue.values||[],e.arrayValue.values||[],ps);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(py(a)!==py(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!ps(a[c],o[c])))return!1;return!0}(t,e);default:return Fe(52216,{left:t})}}function zl(t,e){return(t.values||[]).find(r=>ps(r,e))!==void 0}function $o(t,e){if(t===e)return 0;const r=bi(t),n=bi(e);if(r!==n)return Ke(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ke(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Mt(i.integerValue||i.doubleValue),c=Mt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return gy(t.timestampValue,e.timestampValue);case 4:return gy(Bl(t),Bl(e));case 5:return Xp(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Li(i),c=Li(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const f=Ke(o[l],c[l]);if(f!==0)return f}return Ke(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=Ke(Mt(i.latitude),Mt(a.latitude));return o!==0?o:Ke(Mt(i.longitude),Mt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vy(t.arrayValue,e.arrayValue);case 10:return function(i,a){var d,m,g,v;const o=i.fields||{},c=a.fields||{},l=(d=o[kh])==null?void 0:d.arrayValue,f=(m=c[kh])==null?void 0:m.arrayValue,h=Ke(((g=l==null?void 0:l.values)==null?void 0:g.length)||0,((v=f==null?void 0:f.values)==null?void 0:v.length)||0);return h!==0?h:vy(l,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===sf.mapValue&&a===sf.mapValue)return 0;if(i===sf.mapValue)return 1;if(a===sf.mapValue)return-1;const o=i.fields||{},c=Object.keys(o),l=a.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let h=0;h<c.length&&h<f.length;++h){const d=Xp(c[h],f[h]);if(d!==0)return d;const m=$o(o[c[h]],l[f[h]]);if(m!==0)return m}return Ke(c.length,f.length)}(t.mapValue,e.mapValue);default:throw Fe(23264,{he:r})}}function gy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ke(t,e);const r=Oi(t),n=Oi(e),s=Ke(r.seconds,n.seconds);return s!==0?s:Ke(r.nanos,n.nanos)}function vy(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=$o(r[s],n[s]);if(i)return i}return Ke(r.length,n.length)}function Wo(t){return Yp(t)}function Yp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Oi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Li(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Pe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Yp(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${Yp(r.fields[a])}`;return s+"}"}(t.mapValue):Fe(61005,{value:t})}function If(t){switch(bi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=l0(t);return e?16+If(e):16;case 5:return 2*t.stringValue.length;case 6:return Li(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+If(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return $i(n.fields,(i,a)=>{s+=i.length+If(a)}),s}(t.mapValue);default:throw Fe(13486,{value:t})}}function xy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qp(t){return!!t&&"integerValue"in t}function Xg(t){return!!t&&"arrayValue"in t}function _y(t){return!!t&&"nullValue"in t}function yy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Cf(t){return!!t&&"mapValue"in t}function mV(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[yA])==null?void 0:n.stringValue)===EA}function al(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return $i(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=al(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=al(t.arrayValue.values[r]);return e}return{...t}}function gV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.value=e}static empty(){return new Gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Cf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=al(r)}setAll(e){let r=fr.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=al(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Cf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ps(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Cf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){$i(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Gr(al(this.value))}}function wA(t){const e=[];return $i(t.fields,(r,n)=>{const s=new fr([r]);if(Cf(n)){const i=wA(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new an(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Sr(e,0,Me.min(),Me.min(),Me.min(),Gr.empty(),0)}static newFoundDocument(e,r,n,s){return new Sr(e,1,r,Me.min(),n,s,0)}static newNoDocument(e,r){return new Sr(e,2,r,Me.min(),Me.min(),Gr.empty(),0)}static newUnknownDocument(e,r){return new Sr(e,3,r,Me.min(),Me.min(),Gr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,r){this.position=e,this.inclusive=r}}function Ey(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Pe.comparator(Pe.fromName(a.referenceValue),r.key):n=$o(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function wy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ps(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,r="asc"){this.field=e,this.dir=r}}function vV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{}class Gt extends TA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new _V(e,r,n):r==="array-contains"?new wV(e,n):r==="in"?new TV(e,n):r==="not-in"?new kV(e,n):r==="array-contains-any"?new AV(e,n):new Gt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new yV(e,n):new EV(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison($o(r,this.value)):r!==null&&bi(this.value)===bi(r)&&this.matchesComparison($o(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gn extends TA{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Gn(e,r)}matches(e){return kA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kA(t){return t.op==="and"}function AA(t){return xV(t)&&kA(t)}function xV(t){for(const e of t.filters)if(e instanceof Gn)return!1;return!0}function Jp(t){if(t instanceof Gt)return t.field.canonicalString()+t.op.toString()+Wo(t.value);if(AA(t))return t.filters.map(e=>Jp(e)).join(",");{const e=t.filters.map(r=>Jp(r)).join(",");return`${t.op}(${e})`}}function SA(t,e){return t instanceof Gt?function(n,s){return s instanceof Gt&&n.op===s.op&&n.field.isEqual(s.field)&&ps(n.value,s.value)}(t,e):t instanceof Gn?function(n,s){return s instanceof Gn&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&SA(a,s.filters[o]),!0):!1}(t,e):void Fe(19439)}function IA(t){return t instanceof Gt?function(r){return`${r.field.canonicalString()} ${r.op} ${Wo(r.value)}`}(t):t instanceof Gn?function(r){return r.op.toString()+" {"+r.getFilters().map(IA).join(" ,")+"}"}(t):"Filter"}class _V extends Gt{constructor(e,r,n){super(e,r,n),this.key=Pe.fromName(n.referenceValue)}matches(e){const r=Pe.comparator(e.key,this.key);return this.matchesComparison(r)}}class yV extends Gt{constructor(e,r){super(e,"in",r),this.keys=CA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class EV extends Gt{constructor(e,r){super(e,"not-in",r),this.keys=CA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function CA(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Pe.fromName(n.referenceValue))}class wV extends Gt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Xg(r)&&zl(r.arrayValue,this.value)}}class TV extends Gt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&zl(this.value.arrayValue,r)}}class kV extends Gt{constructor(e,r){super(e,"not-in",r)}matches(e){if(zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!zl(this.value.arrayValue,r)}}class AV extends Gt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Xg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>zl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function Ty(t,e=null,r=[],n=[],s=null,i=null,a=null){return new SV(t,e,r,n,s,i,a)}function Yg(t){const e=Be(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Jp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),c0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Wo(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Wo(n)).join(",")),e.Te=r}return e.Te}function Qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!vV(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!SA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wy(t.startAt,e.startAt)&&wy(t.endAt,e.endAt)}function Zp(t){return Pe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function IV(t,e,r,n,s,i,a,o){return new ac(t,e,r,n,s,i,a,o)}function Jg(t){return new ac(t)}function ky(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RA(t){return t.collectionGroup!==null}function ol(t){const e=Be(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zt(fr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Hl(i,n))}),r.has(fr.keyField().canonicalString())||e.Ie.push(new Hl(fr.keyField(),n))}return e.Ie}function cs(t){const e=Be(t);return e.Ee||(e.Ee=CV(e,ol(t))),e.Ee}function CV(t,e){if(t.limitType==="F")return Ty(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Hl(s.field,i)});const r=t.endAt?new Ah(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ah(t.startAt.position,t.startAt.inclusive):null;return Ty(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function em(t,e){const r=t.filters.concat([e]);return new ac(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function tm(t,e,r){return new ac(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function u0(t,e){return Qg(cs(t),cs(e))&&t.limitType===e.limitType}function PA(t){return`${Yg(cs(t))}|lt:${t.limitType}`}function eo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>IA(s)).join(", ")}]`),c0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Wo(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Wo(s)).join(",")),`Target(${n})`}(cs(t))}; limitType=${t.limitType})`}function f0(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Pe.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of ol(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,c){const l=Ey(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,ol(n),s)||n.endAt&&!function(a,o,c){const l=Ey(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,ol(n),s))}(t,e)}function RV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NA(t){return(e,r)=>{let n=!1;for(const s of ol(t)){const i=PV(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function PV(t,e,r){const n=t.field.isKeyField()?Pe.comparator(e.key,r.key):function(i,a,o){const c=a.data.field(i),l=o.data.field(i);return c!==null&&l!==null?$o(c,l):Fe(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Fe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$i(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return pA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV=new Ct(Pe.comparator);function zs(){return NV}const FA=new Ct(Pe.comparator);function Mc(...t){let e=FA;for(const r of t)e=e.insert(r.key,r);return e}function DA(t){let e=FA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function oa(){return cl()}function OA(){return cl()}function cl(){return new Ua(t=>t.toString(),(t,e)=>t.isEqual(e))}const FV=new Ct(Pe.comparator),DV=new Zt(Pe.comparator);function qe(...t){let e=DV;for(const r of t)e=e.add(r);return e}const OV=new Zt(Ke);function LV(){return OV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wh(e)?"-0":e}}function LA(t){return{integerValue:""+t}}function bV(t,e){return lV(e)?LA(e):Zg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(){this._=void 0}}function MV(t,e,r){return t instanceof Sh?function(s,i){const a={fields:{[vA]:{stringValue:gA},[_A]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&qg(i)&&(i=l0(i)),i&&(a.fields[xA]=i),{mapValue:a}}(r,e):t instanceof $l?MA(t,e):t instanceof Wl?VA(t,e):function(s,i){const a=bA(s,i),o=Ay(a)+Ay(s.Ae);return Qp(a)&&Qp(s.Ae)?LA(o):Zg(s.serializer,o)}(t,e)}function VV(t,e,r){return t instanceof $l?MA(t,e):t instanceof Wl?VA(t,e):r}function bA(t,e){return t instanceof Ih?function(n){return Qp(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Sh extends h0{}class $l extends h0{constructor(e){super(),this.elements=e}}function MA(t,e){const r=UA(e);for(const n of t.elements)r.some(s=>ps(s,n))||r.push(n);return{arrayValue:{values:r}}}class Wl extends h0{constructor(e){super(),this.elements=e}}function VA(t,e){let r=UA(e);for(const n of t.elements)r=r.filter(s=>!ps(s,n));return{arrayValue:{values:r}}}class Ih extends h0{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Ay(t){return Mt(t.integerValue||t.doubleValue)}function UA(t){return Xg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function UV(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof $l&&s instanceof $l||n instanceof Wl&&s instanceof Wl?Ho(n.elements,s.elements,ps):n instanceof Ih&&s instanceof Ih?ps(n.Ae,s.Ae):n instanceof Sh&&s instanceof Sh}(t.transform,e.transform)}class BV{constructor(e,r){this.version=e,this.transformResults=r}}class Tn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Tn}static exists(e){return new Tn(void 0,e)}static updateTime(e){return new Tn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class d0{}function BA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new e1(t.key,Tn.none()):new lu(t.key,t.data,Tn.none());{const r=t.data,n=Gr.empty();let s=new Zt(fr.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new Wi(t.key,n,new an(s.toArray()),Tn.none())}}function jV(t,e,r){t instanceof lu?function(s,i,a){const o=s.value.clone(),c=Iy(s.fieldTransforms,i,a.transformResults);o.setAll(c),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Wi?function(s,i,a){if(!Rf(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Iy(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(jA(s)),c.setAll(o),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function ll(t,e,r,n){return t instanceof lu?function(i,a,o,c){if(!Rf(i.precondition,a))return o;const l=i.value.clone(),f=Cy(i.fieldTransforms,c,a);return l.setAll(f),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof Wi?function(i,a,o,c){if(!Rf(i.precondition,a))return o;const l=Cy(i.fieldTransforms,c,a),f=a.data;return f.setAll(jA(i)),f.setAll(l),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return Rf(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function zV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=bA(n.transform,s||null);i!=null&&(r===null&&(r=Gr.empty()),r.set(n.field,i))}return r||null}function Sy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ho(n,s,(i,a)=>UV(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class lu extends d0{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Wi extends d0{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function jA(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Iy(t,e,r){const n=new Map;ot(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,VV(a,o,r[s]))}return n}function Cy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,MV(i,a,e))}return n}class e1 extends d0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HV extends d0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&jV(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ll(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ll(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=OA();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const c=BA(a,o);c!==null&&n.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(Me.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qe())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,(r,n)=>Sy(r,n))&&Ho(this.baseMutations,e.baseMutations,(r,n)=>Sy(r,n))}}class t1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){ot(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return FV}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new t1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt,Je;function KV(t){switch(t){case ne.OK:return Fe(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Fe(15467,{code:t})}}function zA(t){if(t===void 0)return js("GRPC error has no .code"),ne.UNKNOWN;switch(t){case zt.OK:return ne.OK;case zt.CANCELLED:return ne.CANCELLED;case zt.UNKNOWN:return ne.UNKNOWN;case zt.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case zt.INTERNAL:return ne.INTERNAL;case zt.UNAVAILABLE:return ne.UNAVAILABLE;case zt.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case zt.NOT_FOUND:return ne.NOT_FOUND;case zt.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case zt.ABORTED:return ne.ABORTED;case zt.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case zt.DATA_LOSS:return ne.DATA_LOSS;default:return Fe(39323,{code:t})}}(Je=zt||(zt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=new Ai([4294967295,4294967295],0);function Ry(t){const e=qV().encode(t),r=new nA;return r.update(e),new Uint8Array(r.digest())}function Py(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ai([r,n],0),new Ai([s,i],0)]}class r1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Vc(`Invalid padding: ${r}`);if(n<0)throw new Vc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Vc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Vc(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ai.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Ai.fromNumber(n)));return s.compare(XV)===1&&(s=new Ai([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ry(e),[n,s]=Py(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new r1(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=Ry(e),[n,s]=Py(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Vc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,uu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new p0(Me.min(),s,new Ct(Ke),zs(),qe())}}class uu{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new uu(n,r,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class HA{constructor(e,r){this.targetId=e,this.Ce=r}}class $A{constructor(e,r,n=gr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Ny{constructor(){this.ve=0,this.Fe=Fy(),this.Me=gr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=qe(),r=qe(),n=qe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Fe(38017,{changeType:i})}}),new uu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Fy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class YV{constructor(e){this.Ge=e,this.ze=new Map,this.je=zs(),this.Je=af(),this.He=af(),this.Ye=new Ct(Ke)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Fe(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(Zp(i))if(n===0){const a=new Pe(i.path);this.et(r,a,Sr.newNoDocument(a,Me.min()))}else ot(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),c=o?this.ct(o,e,a):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Li(n).toUint8Array()}catch(c){if(c instanceof mA)return zo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new r1(a,s,i)}catch(c){return zo(c instanceof Vc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const o=this.ot(a);if(o){if(i.current&&Zp(o.target)){const c=new Pe(o.target.path);this.It(c).has(a)||this.Et(a,c)||this.et(a,c,Sr.newNoDocument(c,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=qe();this.He.forEach((i,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new p0(e,r,this.Ye,this.je,n);return this.je=zs(),this.Je=af(),this.He=af(),this.Ye=new Ct(Ke),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Ny,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Zt(Ke),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Zt(Ke),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Se("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ny),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function af(){return new Ct(Pe.comparator)}function Fy(){return new Ct(Pe.comparator)}const QV={asc:"ASCENDING",desc:"DESCENDING"},JV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZV={and:"AND",or:"OR"};class e7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function rm(t,e){return t.useProto3Json||c0(e)?e:{value:e}}function Ch(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function WA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function t7(t,e){return Ch(t,e.toTimestamp())}function ls(t){return ot(!!t,49232),Me.fromTimestamp(function(r){const n=Oi(r);return new _t(n.seconds,n.nanos)}(t))}function n1(t,e){return nm(t,e).canonicalString()}function nm(t,e){const r=function(s){return new ht(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function GA(t){const e=ht.fromString(t);return ot(QA(e),10190,{key:e.toString()}),e}function sm(t,e){return n1(t.databaseId,e.path)}function Cd(t,e){const r=GA(e);if(r.get(1)!==t.databaseId.projectId)throw new Ee(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ee(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Pe(qA(r))}function KA(t,e){return n1(t.databaseId,e)}function r7(t){const e=GA(t);return e.length===4?ht.emptyPath():qA(e)}function im(t){return new ht(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qA(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dy(t,e,r){return{name:sm(t,e),fields:r.value.mapValue.fields}}function n7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Fe(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,f){return l.useProto3Json?(ot(f===void 0||typeof f=="string",58123),gr.fromBase64String(f||"")):(ot(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),gr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const f=l.code===void 0?ne.UNKNOWN:zA(l.code);return new Ee(f,l.message||"")}(a);r=new $A(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Cd(t,n.document.name),i=ls(n.document.updateTime),a=n.document.createTime?ls(n.document.createTime):Me.min(),o=new Gr({mapValue:{fields:n.document.fields}}),c=Sr.newFoundDocument(s,i,a,o),l=n.targetIds||[],f=n.removedTargetIds||[];r=new Pf(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Cd(t,n.document),i=n.readTime?ls(n.readTime):Me.min(),a=Sr.newNoDocument(s,i),o=n.removedTargetIds||[];r=new Pf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Cd(t,n.document),i=n.removedTargetIds||[];r=new Pf([],i,s,null)}else{if(!("filter"in e))return Fe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new GV(s,i),o=n.targetId;r=new HA(o,a)}}return r}function s7(t,e){let r;if(e instanceof lu)r={update:Dy(t,e.key,e.value)};else if(e instanceof e1)r={delete:sm(t,e.key)};else if(e instanceof Wi)r={update:Dy(t,e.key,e.data),updateMask:d7(e.fieldMask)};else{if(!(e instanceof HV))return Fe(16599,{Vt:e.type});r={verify:sm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof Sh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof $l)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Wl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ih)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Fe(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:t7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Fe(27497)}(t,e.precondition)),r}function i7(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?ls(s.updateTime):ls(i);return a.isEqual(Me.min())&&(a=ls(i)),new BV(a,s.transformResults||[])}(r,e))):[]}function a7(t,e){return{documents:[KA(t,e.path)]}}function o7(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=KA(t,s);const i=function(l){if(l.length!==0)return YA(Gn.create(l,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(l){if(l.length!==0)return l.map(f=>function(d){return{field:to(d.field),direction:u7(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=rm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:r,parent:s}}function c7(t){let e=r7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){ot(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(h){const d=XA(h);return d instanceof Gn&&AA(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(g){return new Hl(ro(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,c0(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(h){const d=!!h.before,m=h.values||[];return new Ah(m,d)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new Ah(m,d)}(r.endAt)),IV(e,s,a,i,o,"F",c,l)}function l7(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fe(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function XA(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ro(r.unaryFilter.field);return Gt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ro(r.unaryFilter.field);return Gt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ro(r.unaryFilter.field);return Gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ro(r.unaryFilter.field);return Gt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Fe(61313);default:return Fe(60726)}}(t):t.fieldFilter!==void 0?function(r){return Gt.create(ro(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Fe(58110);default:return Fe(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Gn.create(r.compositeFilter.filters.map(n=>XA(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Fe(1026)}}(r.compositeFilter.op))}(t):Fe(30097,{filter:t})}function u7(t){return QV[t]}function f7(t){return JV[t]}function h7(t){return ZV[t]}function to(t){return{fieldPath:t.canonicalString()}}function ro(t){return fr.fromServerFormat(t.fieldPath)}function YA(t){return t instanceof Gt?function(r){if(r.op==="=="){if(yy(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NAN"}};if(_y(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(yy(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NAN"}};if(_y(r.value))return{unaryFilter:{field:to(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:to(r.field),op:f7(r.op),value:r.value}}}(t):t instanceof Gn?function(r){const n=r.getFilters().map(s=>YA(s));return n.length===1?n[0]:{compositeFilter:{op:h7(r.op),filters:n}}}(t):Fe(54877,{filter:t})}function d7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function QA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,r,n,s,i=Me.min(),a=Me.min(),o=gr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e){this.yt=e}}function m7(t){const e=c7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(){this.Cn=new v7}addToCollectionParentIndex(e,r){return this.Cn.add(r),se.resolve()}getCollectionParents(e,r){return se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return se.resolve()}deleteFieldIndex(e,r){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,r){return se.resolve()}getDocumentsMatchingTarget(e,r){return se.resolve(null)}getIndexType(e,r){return se.resolve(0)}getFieldIndexes(e,r){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,r){return se.resolve(Di.min())}getMinOffsetFromCollectionGroup(e,r){return se.resolve(Di.min())}updateCollectionGroup(e,r,n){return se.resolve()}updateIndexEntries(e,r){return se.resolve()}}class v7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Zt(ht.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Zt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JA=41943040;class $r{static withCacheSize(e){return new $r(e,$r.DEFAULT_COLLECTION_PERCENTILE,$r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$r.DEFAULT_COLLECTION_PERCENTILE=10,$r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$r.DEFAULT=new $r(JA,$r.DEFAULT_COLLECTION_PERCENTILE,$r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$r.DISABLED=new $r(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Go(0)}static cr(){return new Go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly="LruGarbageCollector",x7=1048576;function by([t,e],[r,n]){const s=Ke(t,r);return s===0?Ke(e,n):s}class _7{constructor(e){this.Ir=e,this.buffer=new Zt(by),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();by(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class y7{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Se(Ly,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ic(r)?Se(Ly,"Ignoring IndexedDB error during garbage collection: ",r):await sc(r)}await this.Vr(3e5)})}}class E7{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return se.resolve(o0.ce);const n=new _7(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(Oy)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Oy):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,o,c,l;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,a=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),Za()<=Ge.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-f}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function w7(t,e){return new E7(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T7{constructor(){this.changes=new Ua(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Sr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&ll(n.mutation,s,an.empty(),_t.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qe()){const s=oa();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Mc();return i.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=oa();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=zs();const a=cl(),o=function(){return cl()}();return r.forEach((c,l)=>{const f=n.get(l.key);s.has(l.key)&&(f===void 0||f.mutation instanceof Wi)?i=i.insert(l.key,l):f!==void 0?(a.set(l.key,f.mutation.getFieldMask()),ll(f.mutation,l,f.mutation.getFieldMask(),_t.now())):a.set(l.key,an.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,f)=>a.set(l,f)),r.forEach((l,f)=>o.set(l,new k7(f,a.get(l)??null))),o))}recalculateAndSaveOverlays(e,r){const n=cl();let s=new Ct((a,o)=>a-o),i=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let f=n.get(c)||an.empty();f=o.applyToLocalView(l,f),n.set(c,f);const h=(s.get(o.batchId)||qe()).add(c);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,f=c.value,h=OA();f.forEach(d=>{if(!i.has(d)){const m=BA(r.get(d),n.get(d));m!==null&&h.set(d,m),i=i.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return se.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Pe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):RA(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):se.resolve(oa());let o=Ul,c=i;return a.next(l=>se.forEach(l,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(f)?se.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{c=c.insert(f,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,qe())).next(f=>({batchId:o,changes:DA(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Pe(r)).next(n=>{let s=Mc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Mc();return this.indexManager.getCollectionParents(e,i).next(o=>se.forEach(o,c=>{const l=function(h,d){return new ac(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,n,s).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((c,l)=>{const f=l.getKey();a.get(f)===null&&(a=a.insert(f,Sr.newInvalidDocument(f)))});let o=Mc();return a.forEach((c,l)=>{const f=i.get(c);f!==void 0&&ll(f.mutation,l,an.empty(),_t.now()),f0(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return se.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ls(s.createTime)}}(r)),se.resolve()}getNamedQuery(e,r){return se.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:m7(s.bundledQuery),readTime:ls(s.readTime)}}(r)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(){this.overlays=new Ct(Pe.comparator),this.qr=new Map}getOverlay(e,r){return se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=oa();return se.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),se.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),se.resolve()}getOverlaysForCollection(e,r,n){const s=oa(),i=r.length+1,a=new Pe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return se.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Ct((l,f)=>l-f);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let f=i.get(l.largestBatchId);f===null&&(f=oa(),i=i.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const o=oa(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>o.set(l,f)),!(o.size()>=s)););return se.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new WV(r,n));let i=this.qr.get(r);i===void 0&&(i=qe(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(){this.sessionToken=gr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.Qr=new Zt(rr.$r),this.Ur=new Zt(rr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new rr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new rr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Pe(new ht([])),n=new rr(r,e),s=new rr(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Pe(new ht([])),n=new rr(r,e),s=new rr(r,e+1);let i=qe();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new rr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class rr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Pe.comparator(e.key,r.key)||Ke(e.Yr,r.Yr)}static Kr(e,r){return Ke(e.Yr,r.Yr)||Pe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Zt(rr.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new $V(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new rr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(a)}lookupMutationBatch(e,r){return se.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?Kg:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new rr(r,0),s=new rr(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const o=this.Xr(a.Yr);i.push(o)}),se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Zt(Ke);return r.forEach(s=>{const i=new rr(s,0),a=new rr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],o=>{n=n.add(o.Yr)})}),se.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Pe.isDocumentKey(i)||(i=i.child(""));const a=new rr(new Pe(i),0);let o=new Zt(Ke);return this.Zr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===s&&(o=o.add(c.Yr)),!0)},a),se.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){ot(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return se.forEach(r.mutations,s=>{const i=new rr(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new rr(r,0),s=this.Zr.firstAfterOrEqual(n);return se.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e){this.ri=e,this.docs=function(){return new Ct(Pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return se.resolve(n?n.document.mutableCopy():Sr.newInvalidDocument(r))}getEntries(e,r){let n=zs();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Sr.newInvalidDocument(s))}),se.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=zs();const a=r.path,o=new Pe(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||iV(sV(f),n)<=0||(s.has(f.key)||f0(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return se.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Fe(9500)}ii(e,r){return se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new N7(this)}getSize(e){return se.resolve(this.size)}}class N7 extends T7{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),se.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e){this.persistence=e,this.si=new Ua(r=>Yg(r),Qg),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.oi=0,this._i=new s1,this.targetCount=0,this.ai=Go.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),se.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Go(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,se.resolve()}updateTargetData(e,r){return this.Pr(r),se.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(i).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return se.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),se.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),se.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),se.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return se.resolve(n)}containsKey(e,r){return se.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e,r){this.ui={},this.overlays={},this.ci=new o0(0),this.li=!1,this.li=!0,this.hi=new C7,this.referenceDelegate=e(this),this.Pi=new F7(this),this.indexManager=new g7,this.remoteDocumentCache=function(s){return new P7(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new p7(r),this.Ii=new S7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new I7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new R7(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Se("MemoryPersistence","Starting transaction:",e);const s=new D7(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return se.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class D7 extends oV{constructor(e){super(),this.currentSequenceNumber=e}}class i1{constructor(e){this.persistence=e,this.Ri=new s1,this.Vi=null}static mi(e){return new i1(e)}get fi(){if(this.Vi)return this.Vi;throw Fe(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),se.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),se.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,n=>{const s=Pe.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,Me.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return se.or([()=>se.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Rh{constructor(e,r){this.persistence=e,this.pi=new Ua(n=>uV(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=w7(this,r)}static mi(e,r){return new Rh(e,r)}Ei(){}di(e){return se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return se.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?se.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,i.removeEntry(a,Me.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=If(e.data.value)),r}br(e,r,n){return se.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return se.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=qe(),s=qe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new a1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return ob()?8:cV(Fr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new O7;return this.Ss(e,r,a).next(o=>{if(i.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(Za()<=Ge.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",eo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(Za()<=Ge.DEBUG&&Se("QueryEngine","Query:",eo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Za()<=Ge.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",eo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,cs(r))):se.resolve())}ys(e,r){if(ky(r))return se.resolve(null);let n=cs(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=tm(r,null,"F"),n=cs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=qe(...i);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Ds(r,o);return this.Cs(r,l,a,c.readTime)?this.ys(e,tm(r,null,"F")):this.vs(e,l,r,c)}))})))}ws(e,r,n,s){return ky(r)||s.isEqual(Me.min())?se.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?se.resolve(null):(Za()<=Ge.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),eo(r)),this.vs(e,a,r,nV(s,Ul)).next(o=>o))})}Ds(e,r){let n=new Zt(NA(e));return r.forEach((s,i)=>{f0(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return Za()<=Ge.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",eo(r)),this.ps.getDocumentsMatchingQuery(e,r,Di.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="LocalStore",b7=3e8;class M7{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Ct(Ke),this.xs=new Ua(i=>Yg(i),Qg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new A7(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function V7(t,e,r,n){return new M7(t,e,r,n)}async function eS(t,e){const r=Be(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let c=qe();for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(l=>({Ls:l,removedBatchIds:a,addedBatchIds:o}))})})}function U7(t,e){const r=Be(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,l,f){const h=l.batch,d=h.keys();let m=se.resolve();return d.forEach(g=>{m=m.next(()=>f.getEntry(c,g)).next(v=>{const E=l.docVersions.get(g);ot(E!==null,48541),v.version.compareTo(E)<0&&(h.applyToRemoteDocument(v,l),v.isValidDocument()&&(v.setReadTime(l.commitVersion),f.addEntry(v)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=qe();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function tS(t){const e=Be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function B7(t,e){const r=Be(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=s.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(i,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(i,f.addedDocuments,h)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(gr.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),s=s.insert(h,m),function(v,E,T){return v.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=b7?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,f)&&o.push(r.Pi.updateTargetData(i,m))});let c=zs(),l=qe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),o.push(j7(i,a,e.documentUpdates).next(f=>{c=f.ks,l=f.qs})),!n.isEqual(Me.min())){const f=r.Pi.getLastRemoteSnapshotVersion(i).next(h=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(f)}return se.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(r.Ms=s,i))}function j7(t,e,r){let n=qe(),s=qe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=zs();return r.forEach((o,c)=>{const l=i.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(o)),c.isNoDocument()&&c.version.isEqual(Me.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):Se(o1,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{ks:a,qs:s}})}function z7(t,e){const r=Be(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Kg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function H7(t,e){const r=Be(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,se.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new di(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function am(t,e,r){const n=Be(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!ic(a))throw a;Se(o1,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function My(t,e,r){const n=Be(t);let s=Me.min(),i=qe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,f){const h=Be(c),d=h.xs.get(f);return d!==void 0?se.resolve(h.Ms.get(d)):h.Pi.getTargetData(l,f)}(n,a,cs(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(c=>{i=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:Me.min(),r?i:qe())).next(o=>($7(n,RV(e),o),{documents:o,Qs:i})))}function $7(t,e,r){let n=t.Os.get(e)||Me.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class Vy{constructor(){this.activeTargetIds=LV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class W7{constructor(){this.Mo=new Vy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Vy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy="ConnectivityMonitor";class By{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Se(Uy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Se(Uy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let of=null;function om(){return of===null?of=function(){return 268435456+Math.round(2147483648*Math.random())}():of++,"0x"+of.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd="RestConnection",K7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class q7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Th?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=om(),o=this.zo(e,r.toUriEncodedString());Se(Rd,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:l}=new URL(o),f=ec(l);return this.Jo(e,o,c,n,f).then(h=>(Se(Rd,`Received RPC '${e}' ${a}: `,h),h),h=>{throw zo(Rd,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=K7[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr="WebChannelConnection";class Y7 extends q7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=om();return new Promise((o,c)=>{const l=new sA;l.setWithCredentials(!0),l.listenOnce(iA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Sf.NO_ERROR:const h=l.getResponseJson();Se(wr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case Sf.TIMEOUT:Se(wr,`RPC '${e}' ${a} timed out`),c(new Ee(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Sf.HTTP_ERROR:const d=l.getStatus();if(Se(wr,`RPC '${e}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const v=function(T){const w=T.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(w)>=0?w:ne.UNKNOWN}(g.status);c(new Ee(v,g.message))}else c(new Ee(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Ee(ne.UNAVAILABLE,"Connection failed."));break;default:Fe(9055,{l_:e,streamId:a,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{Se(wr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(s);Se(wr,`RPC '${e}' ${a} sending request:`,s),l.send(r,"POST",f,n,15)})}T_(e,r,n){const s=om(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=cA(),o=oA(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=i.join("");Se(wr,`Creating RPC '${e}' stream ${s}: ${f}`,c);const h=a.createWebChannel(f,c);this.I_(h);let d=!1,m=!1;const g=new X7({Yo:E=>{m?Se(wr,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(d||(Se(wr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Se(wr,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Zo:()=>h.close()}),v=(E,T,w)=>{E.listen(T,x=>{try{w(x)}catch(O){setTimeout(()=>{throw O},0)}})};return v(h,bc.EventType.OPEN,()=>{m||(Se(wr,`RPC '${e}' stream ${s} transport opened.`),g.o_())}),v(h,bc.EventType.CLOSE,()=>{m||(m=!0,Se(wr,`RPC '${e}' stream ${s} transport closed`),g.a_(),this.E_(h))}),v(h,bc.EventType.ERROR,E=>{m||(m=!0,zo(wr,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),g.a_(new Ee(ne.UNAVAILABLE,"The operation could not be completed")))}),v(h,bc.EventType.MESSAGE,E=>{var T;if(!m){const w=E.data[0];ot(!!w,16349);const x=w,O=(x==null?void 0:x.error)||((T=x[0])==null?void 0:T.error);if(O){Se(wr,`RPC '${e}' stream ${s} received error:`,O);const z=O.status;let B=function(A){const I=zt[A];if(I!==void 0)return zA(I)}(z),_=O.message;B===void 0&&(B=ne.INTERNAL,_="Unknown error status: "+z+" with message "+O.message),m=!0,g.a_(new Ee(B,_)),h.close()}else Se(wr,`RPC '${e}' stream ${s} received:`,w),g.u_(w)}}),v(o,aA.STAT_EVENT,E=>{E.stat===qp.PROXY?Se(wr,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===qp.NOPROXY&&Se(wr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Pd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t){return new e7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy="PersistentStream";class nS{constructor(e,r,n,s,i,a,o,c){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rS(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(js(r.toString()),js("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Ee(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Se(jy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Se(jy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Q7 extends nS{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=n7(this.serializer,e),n=function(i){if(!("targetChange"in i))return Me.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Me.min():a.readTime?ls(a.readTime):Me.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=im(this.serializer),r.addTarget=function(i,a){let o;const c=a.target;if(o=Zp(c)?{documents:a7(i,c)}:{query:o7(i,c).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=WA(i,a.resumeToken);const l=rm(i,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(Me.min())>0){o.readTime=Ch(i,a.snapshotVersion.toTimestamp());const l=rm(i,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=l7(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=im(this.serializer),r.removeTarget=e,this.q_(r)}}class J7 extends nS{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=i7(e.writeResults,e.commitTime),n=ls(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=im(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>s7(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{}class eU extends Z7{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ee(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,nm(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ee(ne.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,nm(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ee(ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class tU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(js(r),this.aa=!1):Se("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa="RemoteStore";class rU{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Ba(this)&&(Se(Aa,"Restarting streams for network reachability change."),await async function(c){const l=Be(c);l.Ea.add(4),await fu(l),l.Ra.set("Unknown"),l.Ea.delete(4),await g0(l)}(this))})}),this.Ra=new tU(n,s)}}async function g0(t){if(Ba(t))for(const e of t.da)await e(!0)}async function fu(t){for(const e of t.da)await e(!1)}function sS(t,e){const r=Be(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),f1(r)?u1(r):oc(r).O_()&&l1(r,e))}function c1(t,e){const r=Be(t),n=oc(r);r.Ia.delete(e),n.O_()&&iS(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ba(r)&&r.Ra.set("Unknown"))}function l1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}oc(t).Y_(e)}function iS(t,e){t.Va.Ue(e),oc(t).Z_(e)}function u1(t){t.Va=new YV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),oc(t).start(),t.Ra.ua()}function f1(t){return Ba(t)&&!oc(t).x_()&&t.Ia.size>0}function Ba(t){return Be(t).Ea.size===0}function aS(t){t.Va=void 0}async function nU(t){t.Ra.set("Online")}async function sU(t){t.Ia.forEach((e,r)=>{l1(t,e)})}async function iU(t,e){aS(t),f1(t)?(t.Ra.ha(e),u1(t)):t.Ra.set("Unknown")}async function aU(t,e,r){if(t.Ra.set("Online"),e instanceof $A&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Se(Aa,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ph(t,n)}else if(e instanceof Pf?t.Va.Ze(e):e instanceof HA?t.Va.st(e):t.Va.tt(e),!r.isEqual(Me.min()))try{const n=await tS(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(l);f&&i.Ia.set(l,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(gr.EMPTY_BYTE_STRING,f.snapshotVersion)),iS(i,c);const h=new di(f.target,c,l,f.sequenceNumber);l1(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Se(Aa,"Failed to raise snapshot:",n),await Ph(t,n)}}async function Ph(t,e,r){if(!ic(e))throw e;t.Ea.add(1),await fu(t),t.Ra.set("Offline"),r||(r=()=>tS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Se(Aa,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await g0(t)})}function oS(t,e){return e().catch(r=>Ph(t,r,e))}async function v0(t){const e=Be(t),r=Mi(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Kg;for(;oU(e);)try{const s=await z7(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,cU(e,s)}catch(s){await Ph(e,s)}cS(e)&&lS(e)}function oU(t){return Ba(t)&&t.Ta.length<10}function cU(t,e){t.Ta.push(e);const r=Mi(t);r.O_()&&r.X_&&r.ea(e.mutations)}function cS(t){return Ba(t)&&!Mi(t).x_()&&t.Ta.length>0}function lS(t){Mi(t).start()}async function lU(t){Mi(t).ra()}async function uU(t){const e=Mi(t);for(const r of t.Ta)e.ea(r.mutations)}async function fU(t,e,r){const n=t.Ta.shift(),s=t1.from(n,e,r);await oS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await v0(t)}async function hU(t,e){e&&Mi(t).X_&&await async function(n,s){if(function(a){return KV(a)&&a!==ne.ABORTED}(s.code)){const i=n.Ta.shift();Mi(n).B_(),await oS(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await v0(n)}}(t,e),cS(t)&&lS(t)}async function zy(t,e){const r=Be(t);r.asyncQueue.verifyOperationInProgress(),Se(Aa,"RemoteStore received new credentials");const n=Ba(r);r.Ea.add(3),await fu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await g0(r)}async function dU(t,e){const r=Be(t);e?(r.Ea.delete(2),await g0(r)):e||(r.Ea.add(2),await fu(r),r.Ra.set("Unknown"))}function oc(t){return t.ma||(t.ma=function(r,n,s){const i=Be(r);return i.sa(),new Q7(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:nU.bind(null,t),t_:sU.bind(null,t),r_:iU.bind(null,t),H_:aU.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),f1(t)?u1(t):t.Ra.set("Unknown")):(await t.ma.stop(),aS(t))})),t.ma}function Mi(t){return t.fa||(t.fa=function(r,n,s){const i=Be(r);return i.sa(),new J7(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:lU.bind(null,t),r_:hU.bind(null,t),ta:uU.bind(null,t),na:fU.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await v0(t)):(await t.fa.stop(),t.Ta.length>0&&(Se(Aa,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new h1(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function d1(t,e){if(js("AsyncQueue",`${e}: ${t}`),ic(t))return new Ee(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{static emptySet(e){return new Po(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Pe.comparator(r.key,n.key):(r,n)=>Pe.comparator(r.key,n.key),this.keyedMap=Mc(),this.sortedSet=new Ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Po)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Po;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(){this.ga=new Ct(Pe.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Fe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ko{constructor(e,r,n,s,i,a,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Ko(e,r,Po.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&u0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mU{constructor(){this.queries=$y(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Be(r),i=s.queries;s.queries=$y(),i.forEach((a,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new Ee(ne.ABORTED,"Firestore shutting down"))}}function $y(){return new Ua(t=>PA(t),u0)}async function uS(t,e){const r=Be(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new pU,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=d1(a,`Initialization of query '${eo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&p1(r)}async function fS(t,e){const r=Be(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function gU(t,e){const r=Be(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&p1(r)}function vU(t,e,r){const n=Be(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function p1(t){t.Ca.forEach(e=>{e.next()})}var cm,Wy;(Wy=cm||(cm={})).Ma="default",Wy.Cache="cache";class hS{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Ko(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.key=e}}class pS{constructor(e){this.key=e}}class xU{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=qe(),this.mutatedKeys=qe(),this.eu=NA(e),this.tu=new Po(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Hy,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,h)=>{const d=s.get(f),m=f0(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;d&&m?d.data.isEqual(m.data)?g!==v&&(n.track({type:3,doc:m}),E=!0):this.su(d,m)||(n.track({type:2,doc:m}),E=!0,(c&&this.eu(m,c)>0||l&&this.eu(m,l)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),E=!0):d&&!m&&(n.track({type:1,doc:d}),E=!0,(c||l)&&(o=!0)),E&&(m?(a=a.add(m),i=v?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,h)=>function(m,g){const v=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fe(20277,{Rt:E})}};return v(m)-v(g)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,l=c!==this.Za;return this.Za=c,a.length!==0||l?{snapshot:new Ko(this.query,e.tu,i,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Hy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=qe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new pS(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new dS(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=qe();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ko.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const m1="SyncEngine";class _U{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class yU{constructor(e){this.key=e,this.hu=!1}}class EU{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ua(o=>PA(o),u0),this.Iu=new Map,this.Eu=new Set,this.du=new Ct(Pe.comparator),this.Au=new Map,this.Ru=new s1,this.Vu={},this.mu=new Map,this.fu=Go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wU(t,e,r=!0){const n=yS(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await mS(n,e,r,!0),s}async function TU(t,e){const r=yS(t);await mS(r,e,!0,!1)}async function mS(t,e,r,n){const s=await H7(t.localStore,cs(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await kU(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&sS(t.remoteStore,s),o}async function kU(t,e,r,n,s){t.pu=(h,d,m)=>async function(v,E,T,w){let x=E.view.ru(T);x.Cs&&(x=await My(v.localStore,E.query,!1).then(({documents:_})=>E.view.ru(_,x)));const O=w&&w.targetChanges.get(E.targetId),z=w&&w.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(x,v.isPrimaryClient,O,z);return Ky(v,E.targetId,B.au),B.snapshot}(t,h,d,m);const i=await My(t.localStore,e,!0),a=new xU(e,i.Qs),o=a.ru(i.documents),c=uu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),l=a.applyChanges(o,t.isPrimaryClient,c);Ky(t,r,l.au);const f=new _U(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function AU(t,e,r){const n=Be(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!u0(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await am(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&c1(n.remoteStore,s.targetId),lm(n,s.targetId)}).catch(sc)):(lm(n,s.targetId),await am(n.localStore,s.targetId,!0))}async function SU(t,e){const r=Be(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),c1(r.remoteStore,n.targetId))}async function IU(t,e,r){const n=OU(t);try{const s=await function(a,o){const c=Be(a),l=_t.now(),f=o.reduce((m,g)=>m.add(g.key),qe());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=zs(),v=qe();return c.Ns.getEntries(m,f).next(E=>{g=E,g.forEach((T,w)=>{w.isValidDocument()||(v=v.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(E=>{h=E;const T=[];for(const w of o){const x=zV(w,h.get(w.key).overlayedDocument);x!=null&&T.push(new Wi(w.key,x,wA(x.value.mapValue),Tn.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,T,o)}).next(E=>{d=E;const T=E.applyToLocalDocumentSet(h,v);return c.documentOverlayCache.saveOverlays(m,E.batchId,T)})}).then(()=>({batchId:d.batchId,changes:DA(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,c){let l=a.Vu[a.currentUser.toKey()];l||(l=new Ct(Ke)),l=l.insert(o,c),a.Vu[a.currentUser.toKey()]=l}(n,s.batchId,r),await hu(n,s.changes),await v0(n.remoteStore)}catch(s){const i=d1(s,"Failed to persist write");r.reject(i)}}async function gS(t,e){const r=Be(t);try{const n=await B7(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(ot(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ot(a.hu,14607):s.removedDocuments.size>0&&(ot(a.hu,42227),a.hu=!1))}),await hu(r,n,e)}catch(n){await sc(n)}}function Gy(t,e,r){const n=Be(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const c=Be(a);c.onlineState=o;let l=!1;c.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(l=!0)}),l&&p1(c)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function CU(t,e,r){const n=Be(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new Ct(Pe.comparator);a=a.insert(i,Sr.newNoDocument(i,Me.min()));const o=qe().add(i),c=new p0(Me.min(),new Map,new Ct(Ke),a,o);await gS(n,c),n.du=n.du.remove(i),n.Au.delete(e),g1(n)}else await am(n.localStore,e,!1).then(()=>lm(n,e,r)).catch(sc)}async function RU(t,e){const r=Be(t),n=e.batch.batchId;try{const s=await U7(r.localStore,e);xS(r,n,null),vS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await hu(r,s)}catch(s){await sc(s)}}async function PU(t,e,r){const n=Be(t);try{const s=await function(a,o){const c=Be(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(ot(h!==null,37113),f=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(n.localStore,e);xS(n,e,r),vS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await hu(n,s)}catch(s){await sc(s)}}function vS(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function xS(t,e,r){const n=Be(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function lm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||_S(t,n)})}function _S(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(c1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),g1(t))}function Ky(t,e,r){for(const n of r)n instanceof dS?(t.Ru.addReference(n.key,e),NU(t,n)):n instanceof pS?(Se(m1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||_S(t,n.key)):Fe(19791,{wu:n})}function NU(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Se(m1,"New document in limbo: "+r),t.Eu.add(n),g1(t))}function g1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Pe(ht.fromString(e)),n=t.fu.next();t.Au.set(n,new yU(r)),t.du=t.du.insert(r,n),sS(t.remoteStore,new di(cs(Jg(r.path)),n,"TargetPurposeLimboResolution",o0.ce))}}async function hu(t,e,r){const n=Be(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{a.push(n.pu(c,e,r).then(l=>{var f;if((l||r)&&n.isPrimaryClient){const h=l?!l.fromCache:(f=r==null?void 0:r.targetChanges.get(c.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){s.push(l);const h=a1.As(c.targetId,l);i.push(h)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(c,l){const f=Be(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>se.forEach(l,d=>se.forEach(d.Es,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>se.forEach(d.ds,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!ic(h))throw h;Se(o1,"Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=f.Ms.get(d),g=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(g);f.Ms=f.Ms.insert(d,v)}}}(n.localStore,i))}async function FU(t,e){const r=Be(t);if(!r.currentUser.isEqual(e)){Se(m1,"User change. New user:",e.toKey());const n=await eS(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(o=>{o.forEach(c=>{c.reject(new Ee(ne.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await hu(r,n.Ls)}}function DU(t,e){const r=Be(t),n=r.Au.get(e);if(n&&n.hu)return qe().add(n.key);{let s=qe();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const o=r.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function yS(t){const e=Be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CU.bind(null,e),e.Pu.H_=gU.bind(null,e.eventManager),e.Pu.yu=vU.bind(null,e.eventManager),e}function OU(t){const e=Be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PU.bind(null,e),e}class Nh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=m0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return V7(this.persistence,new L7,e.initialUser,this.serializer)}Cu(e){return new ZA(i1.mi,this.serializer)}Du(e){return new W7}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nh.provider={build:()=>new Nh};class LU extends Nh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){ot(this.persistence.referenceDelegate instanceof Rh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new y7(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?$r.withCacheSize(this.cacheSizeBytes):$r.DEFAULT;return new ZA(n=>Rh.mi(n,r),this.serializer)}}class um{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Gy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=FU.bind(null,this.syncEngine),await dU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mU}()}createDatastore(e){const r=m0(e.databaseInfo.databaseId),n=function(i){return new Y7(i)}(e.databaseInfo);return function(i,a,o,c){return new eU(i,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new rU(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Gy(this.syncEngine,r,0),function(){return By.v()?new By:new G7}())}createSyncEngine(e,r){return function(s,i,a,o,c,l,f){const h=new EU(s,i,a,o,c,l);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Be(s);Se(Aa,"RemoteStore shutting down."),i.Ea.add(5),await fu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}um.provider={build:()=>new um};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):js("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="FirestoreClient";class bU{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Tr.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Se(Vi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Se(Vi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=d1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Nd(t,e){t.asyncQueue.verifyOperationInProgress(),Se(Vi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await eS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await MU(t);Se(Vi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>zy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>zy(e.remoteStore,s)),t._onlineComponents=e}async function MU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Se(Vi,"Using user provided OfflineComponentProvider");try{await Nd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ne.FAILED_PRECONDITION||s.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;zo("Error using user provided cache. Falling back to memory cache: "+r),await Nd(t,new Nh)}}else Se(Vi,"Using default OfflineComponentProvider"),await Nd(t,new LU(void 0));return t._offlineComponents}async function wS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Se(Vi,"Using user provided OnlineComponentProvider"),await qy(t,t._uninitializedComponentsProvider._online)):(Se(Vi,"Using default OnlineComponentProvider"),await qy(t,new um))),t._onlineComponents}function VU(t){return wS(t).then(e=>e.syncEngine)}async function TS(t){const e=await wS(t),r=e.eventManager;return r.onListen=wU.bind(null,e.syncEngine),r.onUnlisten=AU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=TU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=SU.bind(null,e.syncEngine),r}function UU(t,e,r={}){const n=new Ds;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,c,l){const f=new ES({next:d=>{f.Nu(),a.enqueueAndForget(()=>fS(i,h));const m=d.docs.has(o);!m&&d.fromCache?l.reject(new Ee(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&c&&c.source==="server"?l.reject(new Ee(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new hS(Jg(o.path),f,{includeMetadataChanges:!0,qa:!0});return uS(i,h)}(await TS(t),t.asyncQueue,e,r,n)),n.promise}function BU(t,e,r={}){const n=new Ds;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,c,l){const f=new ES({next:d=>{f.Nu(),a.enqueueAndForget(()=>fS(i,h)),d.fromCache&&c.source==="server"?l.reject(new Ee(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new hS(o,f,{includeMetadataChanges:!0,qa:!0});return uS(i,h)}(await TS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="firestore.googleapis.com",Yy=!0;class Qy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AS,this.ssl=Yy}else this.host=e.host,this.ssl=e.ssl??Yy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<x7)throw new Ee(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kS(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ee(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ee(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ee(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class x0{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new G9;switch(n.type){case"firstParty":return new Y9(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ee(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Xy.get(r);n&&(Se("ComponentProvider","Removing Datastore"),Xy.delete(r),n.terminate())}(this),Promise.resolve()}}function jU(t,e,r,n={}){var l;t=Wn(t,x0);const s=ec(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(hk(`https://${o}`),dk("Firestore",!0)),i.host!==AS&&i.host!==o&&zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:o,ssl:s,emulatorOptions:n};if(!Fi(c,a)&&(t._setSettings(c),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=Tr.MOCK_USER;else{f=ZL(n.mockUserToken,(l=t._app)==null?void 0:l.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Ee(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Tr(d)}t._authCredentials=new K9(new uA(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ja(this.firestore,e,this._query)}}class Ut{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}toJSON(){return{type:Ut._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(cu(r,Ut._jsonSchema))return new Ut(e,n||null,new Pe(ht.fromString(r.referencePath)))}}Ut._jsonSchemaVersion="firestore/documentReference/1.0",Ut._jsonSchema={type:Kt("string",Ut._jsonSchemaVersion),referencePath:Kt("string")};class Si extends ja{constructor(e,r,n){super(e,r,Jg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new Pe(e))}withConverter(e){return new Si(this.firestore,e,this._path)}}function fm(t,e,...r){if(t=Bt(t),fA("collection","path",e),t instanceof x0){const n=ht.fromString(e,...r);return uy(n),new Si(t,null,n)}{if(!(t instanceof Ut||t instanceof Si))throw new Ee(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ht.fromString(e,...r));return uy(n),new Si(t.firestore,null,n)}}function Ii(t,e,...r){if(t=Bt(t),arguments.length===1&&(e=Gg.newId()),fA("doc","path",e),t instanceof x0){const n=ht.fromString(e,...r);return ly(n),new Ut(t,null,new Pe(n))}{if(!(t instanceof Ut||t instanceof Si))throw new Ee(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ht.fromString(e,...r));return ly(n),new Ut(t.firestore,t instanceof Si?t.converter:null,new Pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jy="AsyncQueue";class Zy{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rS(this,"async_queue_retry"),this._c=()=>{const n=Pd();n&&Se(Jy,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Pd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Pd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ds;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ic(e))throw e;Se(Jy,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,js("INTERNAL UNHANDLED ERROR: ",eE(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=h1.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Fe(47125,{Pc:eE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function eE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class za extends x0{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Zy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zy(e),this._firestoreClient=void 0,await e}}}function zU(t,e){const r=typeof t=="object"?t:bg(),n=typeof t=="string"?t:Th,s=Ma(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=QL("firestore");i&&jU(s,...i)}return s}function v1(t){if(t._terminated)throw new Ee(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HU(t),t._firestoreClient}function HU(t){var n,s,i;const e=t._freezeSettings(),r=function(o,c,l,f){return new dV(o,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,kS(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new bU(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _n(gr.fromBase64String(e))}catch(r){throw new Ee(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new _n(gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cu(e,_n._jsonSchema))return _n.fromBase64String(e.bytes)}}_n._jsonSchemaVersion="firestore/bytes/1.0",_n._jsonSchema={type:Kt("string",_n._jsonSchemaVersion),bytes:Kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ee(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ee(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ee(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:us._jsonSchemaVersion}}static fromJSON(e){if(cu(e,us._jsonSchema))return new us(e.latitude,e.longitude)}}us._jsonSchemaVersion="firestore/geoPoint/1.0",us._jsonSchema={type:Kt("string",us._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cu(e,fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new fs(e.vectorValues);throw new Ee(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fs._jsonSchemaVersion="firestore/vectorValue/1.0",fs._jsonSchema={type:Kt("string",fs._jsonSchemaVersion),vectorValues:Kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U=/^__.*__$/;class WU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Wi(e,this.data,this.fieldMask,r,this.fieldTransforms):new lu(e,this.data,r,this.fieldTransforms)}}class SS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Wi(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function IS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fe(40011,{Ac:t})}}class _1{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new _1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(IS(this.Ac)&&$U.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||m0(e)}Cc(e,r,n,s=!1){return new _1({Ac:e,methodName:r,Dc:n,path:fr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function y0(t){const e=t._freezeSettings(),r=m0(t._databaseId);return new GU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function CS(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);y1("Data must be an object, but it was:",a,n);const o=RS(n,a);let c,l;if(i.merge)c=new an(a.fieldMask),l=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const h of i.mergeFields){const d=hm(e,h,r);if(!a.contains(d))throw new Ee(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);NS(f,d)||f.push(d)}c=new an(f),l=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=a.fieldTransforms;return new WU(new Gr(o),c,l)}class E0 extends x1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof E0}}function KU(t,e,r,n){const s=t.Cc(1,e,r);y1("Data must be an object, but it was:",s,n);const i=[],a=Gr.empty();$i(n,(c,l)=>{const f=E1(e,c,r);l=Bt(l);const h=s.yc(f);if(l instanceof E0)i.push(f);else{const d=du(l,h);d!=null&&(i.push(f),a.set(f,d))}});const o=new an(i);return new SS(a,o,s.fieldTransforms)}function qU(t,e,r,n,s,i){const a=t.Cc(1,e,r),o=[hm(e,n,r)],c=[s];if(i.length%2!=0)throw new Ee(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(hm(e,i[d])),c.push(i[d+1]);const l=[],f=Gr.empty();for(let d=o.length-1;d>=0;--d)if(!NS(l,o[d])){const m=o[d];let g=c[d];g=Bt(g);const v=a.yc(m);if(g instanceof E0)l.push(m);else{const E=du(g,v);E!=null&&(l.push(m),f.set(m,E))}}const h=new an(l);return new SS(f,h,a.fieldTransforms)}function XU(t,e,r,n=!1){return du(r,t.Cc(n?4:3,e))}function du(t,e){if(PS(t=Bt(t)))return y1("Unsupported field value:",e,t),RS(t,e);if(t instanceof x1)return function(n,s){if(!IS(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let c=du(o,s.wc(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Bt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return bV(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=_t.fromDate(n);return{timestampValue:Ch(s.serializer,i)}}if(n instanceof _t){const i=new _t(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ch(s.serializer,i)}}if(n instanceof us)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof _n)return{bytesValue:WA(s.serializer,n._byteString)};if(n instanceof Ut){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:n1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof fs)return function(a,o){return{mapValue:{fields:{[yA]:{stringValue:EA},[kh]:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return Zg(o.serializer,l)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${a0(n)}`)}(t,e)}function RS(t,e){const r={};return pA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$i(t,(n,s)=>{const i=du(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function PS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _t||t instanceof us||t instanceof _n||t instanceof Ut||t instanceof x1||t instanceof fs)}function y1(t,e,r){if(!PS(r)||!hA(r)){const n=a0(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function hm(t,e,r){if((e=Bt(e))instanceof _0)return e._internalPath;if(typeof e=="string")return E1(t,e);throw Fh("Field path arguments must be of type string or ",t,!1,void 0,r)}const YU=new RegExp("[~\\*/\\[\\]]");function E1(t,e,r){if(e.search(YU)>=0)throw Fh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new _0(...e.split("."))._internalPath}catch{throw Fh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Fh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${n}`),a&&(c+=` in document ${s}`),c+=")"),new Ee(ne.INVALID_ARGUMENT,o+t+c)}function NS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(w0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class QU extends FS{data(){return super.data()}}function w0(t,e){return typeof e=="string"?E1(t,e):e instanceof _0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ee(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class w1{}class DS extends w1{}function OS(t,e,...r){let n=[];e instanceof w1&&n.push(e),n=n.concat(r),function(i){const a=i.filter(c=>c instanceof T1).length,o=i.filter(c=>c instanceof T0).length;if(a>1||a>0&&o>0)throw new Ee(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class T0 extends DS{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new T0(e,r,n)}_apply(e){const r=this._parse(e);return bS(e._query,r),new ja(e.firestore,e.converter,em(e._query,r))}_parse(e){const r=y0(e.firestore);return function(i,a,o,c,l,f,h){let d;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ee(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){rE(h,f);const g=[];for(const v of h)g.push(tE(c,i,v));d={arrayValue:{values:g}}}else d=tE(c,i,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||rE(h,f),d=XU(o,a,h,f==="in"||f==="not-in");return Gt.create(l,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function LS(t,e,r){const n=e,s=w0("where",t);return T0._create(s,n,r)}class T1 extends w1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new T1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Gn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const c of o)bS(a,c),a=em(a,c)}(e._query,r),new ja(e.firestore,e.converter,em(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class k1 extends DS{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new k1(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new Ee(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ee(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hl(i,a)}(e._query,this._field,this._direction);return new ja(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new ac(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function ZU(t,e="asc"){const r=e,n=w0("orderBy",t);return k1._create(n,r)}function tE(t,e,r){if(typeof(r=Bt(r))=="string"){if(r==="")throw new Ee(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RA(e)&&r.indexOf("/")!==-1)throw new Ee(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ht.fromString(r));if(!Pe.isDocumentKey(n))throw new Ee(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return xy(t,new Pe(n))}if(r instanceof Ut)return xy(t,r._key);throw new Ee(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${a0(r)}.`)}function rE(t,e){if(!Array.isArray(t)||t.length===0)throw new Ee(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bS(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ee(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ee(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class eB{convertValue(e,r="none"){switch(bi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Fe(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return $i(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[kh].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>Mt(a.doubleValue));return new fs(r)}convertGeoPoint(e){return new us(Mt(e.latitude),Mt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=l0(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Bl(e));default:return null}}convertTimestamp(e){const r=Oi(e);return new _t(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ht.fromString(e);ot(QA(n),9688,{name:e});const s=new jl(n.get(1),n.get(3)),i=new Pe(n.popFirst(5));return s.isEqual(r)||js(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Uc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class da extends FS{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Nf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(w0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=da._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}da._jsonSchemaVersion="firestore/documentSnapshot/1.0",da._jsonSchema={type:Kt("string",da._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class Nf extends da{data(e={}){return super.data(e)}}class No{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Uc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Nf(this._firestore,this._userDataWriter,n.key,n,new Uc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ee(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const c=new Nf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Uc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const c=new Nf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Uc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,f=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:tB(o.type),doc:c,oldIndex:l,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=No._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function tB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t){t=Wn(t,Ut);const e=Wn(t.firestore,za);return UU(v1(e),t._key).then(r=>sB(e,t,r))}No._jsonSchemaVersion="firestore/querySnapshot/1.0",No._jsonSchema={type:Kt("string",No._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class US extends eB{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,r)}}function BS(t){t=Wn(t,ja);const e=Wn(t.firestore,za),r=v1(e),n=new US(e);return JU(t._query),BU(r,t._query).then(s=>new No(e,n,t,s))}function jS(t,e,r){t=Wn(t,Ut);const n=Wn(t.firestore,za),s=MS(t.converter,e);return k0(n,[CS(y0(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Tn.none())])}function rB(t,e,r,...n){t=Wn(t,Ut);const s=Wn(t.firestore,za),i=y0(s);let a;return a=typeof(e=Bt(e))=="string"||e instanceof _0?qU(i,"updateDoc",t._key,e,r,n):KU(i,"updateDoc",t._key,e),k0(s,[a.toMutation(t._key,Tn.exists(!0))])}function zS(t){return k0(Wn(t.firestore,za),[new e1(t._key,Tn.none())])}function nB(t,e){const r=Wn(t.firestore,za),n=Ii(t),s=MS(t.converter,e);return k0(r,[CS(y0(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Tn.exists(!1))]).then(()=>n)}function k0(t,e){return function(n,s){const i=new Ds;return n.asyncQueue.enqueueAndForget(async()=>IU(await VU(n),s,i)),i.promise}(v1(t),e)}function sB(t,e,r){const n=r.docs.get(e._key),s=new US(t);return new da(t,s,e._key,n,new Uc(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){nc=s})(tc),ds(new Hn("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new za(new q9(n.getProvider("auth-internal")),new Q9(a,n.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ee(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jl(l.options.projectId,f)}(a,s),a);return i={useFetchStreams:r,...i},o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),wn(iy,ay,e),wn(iy,ay,"esm2020")})();const HS="@firebase/installations",A1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=1e4,WS=`w:${A1}`,GS="FIS_v2",iB="https://firebaseinstallations.googleapis.com/v1",aB=60*60*1e3,oB="installations",cB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Sa=new ba(oB,cB,lB);function KS(t){return t instanceof Kn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS({projectId:t}){return`${iB}/projects/${t}/installations`}function XS(t){return{token:t.token,requestStatus:2,expiresIn:fB(t.expiresIn),creationTime:Date.now()}}async function YS(t,e){const n=(await e.json()).error;return Sa.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function QS({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function uB(t,{refreshToken:e}){const r=QS(t);return r.append("Authorization",hB(e)),r}async function JS(t){const e=await t();return e.status>=500&&e.status<600?t():e}function fB(t){return Number(t.replace("s","000"))}function hB(t){return`${GS} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dB({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=qS(t),s=QS(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const a={fid:r,authVersion:GS,appId:t.appId,sdkVersion:WS},o={method:"POST",headers:s,body:JSON.stringify(a)},c=await JS(()=>fetch(n,o));if(c.ok){const l=await c.json();return{fid:l.fid||r,registrationStatus:2,refreshToken:l.refreshToken,authToken:XS(l.authToken)}}else throw await YS("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB=/^[cdef][\w-]{21}$/,dm="";function gB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=vB(t);return mB.test(r)?r:dm}catch{return dm}}function vB(t){return pB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=new Map;function tI(t,e){const r=A0(t);rI(r,e),xB(r,e)}function rI(t,e){const r=eI.get(t);if(r)for(const n of r)n(e)}function xB(t,e){const r=_B();r&&r.postMessage({key:t,fid:e}),yB()}let ca=null;function _B(){return!ca&&"BroadcastChannel"in self&&(ca=new BroadcastChannel("[Firebase] FID Change"),ca.onmessage=t=>{rI(t.data.key,t.data.fid)}),ca}function yB(){eI.size===0&&ca&&(ca.close(),ca=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EB="firebase-installations-database",wB=1,Ia="firebase-installations-store";let Fd=null;function S1(){return Fd||(Fd=_k(EB,wB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ia)}}})),Fd}async function Dh(t,e){const r=A0(t),s=(await S1()).transaction(Ia,"readwrite"),i=s.objectStore(Ia),a=await i.get(r);return await i.put(e,r),await s.done,(!a||a.fid!==e.fid)&&tI(t,e.fid),e}async function nI(t){const e=A0(t),n=(await S1()).transaction(Ia,"readwrite");await n.objectStore(Ia).delete(e),await n.done}async function S0(t,e){const r=A0(t),s=(await S1()).transaction(Ia,"readwrite"),i=s.objectStore(Ia),a=await i.get(r),o=e(a);return o===void 0?await i.delete(r):await i.put(o,r),await s.done,o&&(!a||a.fid!==o.fid)&&tI(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I1(t){let e;const r=await S0(t.appConfig,n=>{const s=TB(n),i=kB(t,s);return e=i.registrationPromise,i.installationEntry});return r.fid===dm?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function TB(t){const e=t||{fid:gB(),registrationStatus:0};return sI(e)}function kB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Sa.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=AB(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:SB(t)}:{installationEntry:e}}async function AB(t,e){try{const r=await dB(t,e);return Dh(t.appConfig,r)}catch(r){throw KS(r)&&r.customData.serverCode===409?await nI(t.appConfig):await Dh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function SB(t){let e=await nE(t.appConfig);for(;e.registrationStatus===1;)await ZS(100),e=await nE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await I1(t);return n||r}return e}function nE(t){return S0(t,e=>{if(!e)throw Sa.create("installation-not-found");return sI(e)})}function sI(t){return IB(t)?{fid:t.fid,registrationStatus:0}:t}function IB(t){return t.registrationStatus===1&&t.registrationTime+$S<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB({appConfig:t,heartbeatServiceProvider:e},r){const n=RB(t,r),s=uB(t,r),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const a={installation:{sdkVersion:WS,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(a)},c=await JS(()=>fetch(n,o));if(c.ok){const l=await c.json();return XS(l)}else throw await YS("Generate Auth Token",c)}function RB(t,{fid:e}){return`${qS(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1(t,e=!1){let r;const n=await S0(t.appConfig,i=>{if(!iI(i))throw Sa.create("not-registered");const a=i.authToken;if(!e&&FB(a))return i;if(a.requestStatus===1)return r=PB(t,e),i;{if(!navigator.onLine)throw Sa.create("app-offline");const o=OB(i);return r=NB(t,o),o}});return r?await r:n.authToken}async function PB(t,e){let r=await sE(t.appConfig);for(;r.authToken.requestStatus===1;)await ZS(100),r=await sE(t.appConfig);const n=r.authToken;return n.requestStatus===0?C1(t,e):n}function sE(t){return S0(t,e=>{if(!iI(e))throw Sa.create("not-registered");const r=e.authToken;return LB(r)?{...e,authToken:{requestStatus:0}}:e})}async function NB(t,e){try{const r=await CB(t,e),n={...e,authToken:r};return await Dh(t.appConfig,n),r}catch(r){if(KS(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await nI(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Dh(t.appConfig,n)}throw r}}function iI(t){return t!==void 0&&t.registrationStatus===2}function FB(t){return t.requestStatus===2&&!DB(t)}function DB(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+aB}function OB(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function LB(t){return t.requestStatus===1&&t.requestTime+$S<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bB(t){const e=t,{installationEntry:r,registrationPromise:n}=await I1(e);return n?n.catch(console.error):C1(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MB(t,e=!1){const r=t;return await VB(r),(await C1(r,e)).token}async function VB(t){const{registrationPromise:e}=await I1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UB(t){if(!t||!t.options)throw Dd("App Configuration");if(!t.name)throw Dd("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw Dd(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Dd(t){return Sa.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="installations",BB="installations-internal",jB=t=>{const e=t.getProvider("app").getImmediate(),r=UB(e),n=Ma(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},zB=t=>{const e=t.getProvider("app").getImmediate(),r=Ma(e,aI).getImmediate();return{getId:()=>bB(r),getToken:s=>MB(r,s)}};function HB(){ds(new Hn(aI,jB,"PUBLIC")),ds(new Hn(BB,zB,"PRIVATE"))}HB();wn(HS,A1);wn(HS,A1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="analytics",$B="firebase_id",WB="origin",GB=60*1e3,KB="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",R1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new r0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qB={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},cn=new ba("analytics","Analytics",qB);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(t){if(!t.startsWith(R1)){const e=cn.create("invalid-gtag-resource",{gtagURL:t});return Qr.warn(e.message),""}return t}function oI(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function YB(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function QB(t,e){const r=YB("firebase-js-sdk-policy",{createScriptURL:XB}),n=document.createElement("script"),s=`${R1}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function JB(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function ZB(t,e,r,n,s,i){const a=n[s];try{if(a)await e[a];else{const c=(await oI(r)).find(l=>l.measurementId===s);c&&await e[c.appId]}}catch(o){Qr.error(o)}t("config",s,i)}async function ej(t,e,r,n,s){try{let i=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const o=await oI(r);for(const c of a){const l=o.find(h=>h.measurementId===c),f=l&&e[l.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",n,s||{})}catch(i){Qr.error(i)}}function tj(t,e,r,n){async function s(i,...a){try{if(i==="event"){const[o,c]=a;await ej(t,e,r,o,c)}else if(i==="config"){const[o,c]=a;await ZB(t,e,r,n,o,c)}else if(i==="consent"){const[o,c]=a;t("consent",o,c)}else if(i==="get"){const[o,c,l]=a;t("get",o,c,l)}else if(i==="set"){const[o]=a;t("set",o)}else t(i,...a)}catch(o){Qr.error(o)}}return s}function rj(t,e,r,n,s){let i=function(...a){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=tj(i,t,e,r),{gtagCore:i,wrappedGtag:window[s]}}function nj(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(R1)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj=30,ij=1e3;class aj{constructor(e={},r=ij){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const cI=new aj;function oj(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function cj(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:oj(r)},s=KB.replace("{app-id}",e),i=await fetch(s,n);if(i.status!==200&&i.status!==304){let o="";try{const c=await i.json();(a=c.error)!=null&&a.message&&(o=c.error.message)}catch{}throw cn.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function lj(t,e=cI,r){const{appId:n,apiKey:s,measurementId:i}=t.options;if(!n)throw cn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw cn.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new hj;return setTimeout(async()=>{o.abort()},GB),lI({appId:n,apiKey:s,measurementId:i},a,o,e)}async function lI(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=cI){var o;const{appId:i,measurementId:a}=t;try{await uj(n,e)}catch(c){if(a)return Qr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:a};throw c}try{const c=await cj(t);return s.deleteThrottleMetadata(i),c}catch(c){const l=c;if(!fj(l)){if(s.deleteThrottleMetadata(i),a)return Qr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:a};throw c}const f=Number((o=l==null?void 0:l.customData)==null?void 0:o.httpStatus)===503?P_(r,s.intervalMillis,sj):P_(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return s.setThrottleMetadata(i,h),Qr.debug(`Calling attemptFetch again in ${f} millis`),lI(t,h,n,s)}}function uj(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(i),n(cn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function fj(t){if(!(t instanceof Kn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class hj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function dj(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const i=await e,a={...n,send_to:i};t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pj(){if(mk())try{await gk()}catch(t){return Qr.warn(cn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Qr.warn(cn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function mj(t,e,r,n,s,i,a){const o=lj(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&Qr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>Qr.error(d)),e.push(o);const c=pj().then(d=>{if(d)return n.getId()}),[l,f]=await Promise.all([o,c]);nj(i)||QB(i,l.measurementId),s("js",new Date);const h=(a==null?void 0:a.config)??{};return h[WB]="firebase",h.update=!0,f!=null&&(h[$B]=f),s("config",l.measurementId,h),l.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e){this.app=e}_delete(){return delete ul[this.app.options.appId],Promise.resolve()}}let ul={},iE=[];const aE={};let Od="dataLayer",vj="gtag",oE,uI,cE=!1;function xj(){const t=[];if(pk()&&t.push("This is a browser extension environment."),cb()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=cn.create("invalid-analytics-context",{errorInfo:e});Qr.warn(r.message)}}function _j(t,e,r){xj();const n=t.options.appId;if(!n)throw cn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Qr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw cn.create("no-api-key");if(ul[n]!=null)throw cn.create("already-exists",{id:n});if(!cE){JB(Od);const{wrappedGtag:i,gtagCore:a}=rj(ul,iE,aE,Od,vj);uI=i,oE=a,cE=!0}return ul[n]=mj(t,iE,aE,e,oE,Od,r),new gj(t)}function yj(t=bg()){t=Bt(t);const e=Ma(t,Oh);return e.isInitialized()?e.getImmediate():Ej(t)}function Ej(t,e={}){const r=Ma(t,Oh);if(r.isInitialized()){const s=r.getImmediate();if(Fi(e,r.getOptions()))return s;throw cn.create("already-initialized")}return r.initialize({options:e})}function wj(t,e,r,n){t=Bt(t),dj(uI,ul[t.app.options.appId],e,r,n).catch(s=>Qr.error(s))}const lE="@firebase/analytics",uE="0.10.18";function Tj(){ds(new Hn(Oh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return _j(n,s,r)},"PUBLIC")),ds(new Hn("analytics-internal",t,"PRIVATE")),wn(lE,uE),wn(lE,uE,"esm2020");function t(e){try{const r=e.getProvider(Oh).getImmediate();return{logEvent:(n,s,i)=>wj(r,n,s,i)}}catch(r){throw cn.create("interop-component-reg-failed",{reason:r})}}}Tj();const kj={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},P1=yk(kj),cf=z9(P1),rs=zU(P1);typeof window<"u"&&yj(P1);const fI=Ze.createContext(),N1=()=>{const t=Ze.useContext(fI);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},Aj=({children:t})=>{const[e,r]=Ze.useState(null),[n,s]=Ze.useState(!0),[i,a]=Ze.useState(null),o=async(h,d,m)=>{try{a(null);const g=await kM(cf,h,d);return m&&await IM(g.user,{displayName:m}),g.user}catch(g){throw a(g.message),g}},c=async(h,d)=>{try{return a(null),(await AM(cf,h,d)).user}catch(m){throw a(m.message),m}},l=async()=>{try{a(null),await NM(cf)}catch(h){throw a(h.message),h}};Ze.useEffect(()=>PM(cf,d=>{r(d),s(!1)}),[]);const f={user:e,loading:n,error:i,register:o,login:c,logout:l,clearError:()=>a(null)};return F.jsx(fI.Provider,{value:f,children:t})},ns={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData"},Ld={async create(t,e){try{return{id:(await nB(fm(rs,ns.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){throw console.error("Error creating operator:",r),r}},async getByUser(t){try{const e=OS(fm(rs,ns.OPERATORS),LS("userId","==",t),ZU("createdAt","desc"));return(await BS(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){throw console.error("Error getting operators:",e),e}},async update(t,e){try{const r=Ii(rs,ns.OPERATORS,t);await rB(r,{...e,updatedAt:new Date})}catch(r){throw console.error("Error updating operator:",r),r}},async delete(t){try{await zS(Ii(rs,ns.OPERATORS,t))}catch(e){throw console.error("Error deleting operator:",e),e}}},lf={async saveOperatorAssignments(t,e,r){try{const n=Ii(rs,ns.ASSIGNMENTS,`${t}_${e}`);await jS(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date})}catch(n){throw console.error("Error saving assignments:",n),n}},async getOperatorAssignments(t,e){try{const r=Ii(rs,ns.ASSIGNMENTS,`${t}_${e}`),n=await VS(r);return n.exists()?n.data().assignments||[]:[]}catch(r){throw console.error("Error getting assignments:",r),r}},async getAllUserAssignments(t){try{const e=OS(fm(rs,ns.ASSIGNMENTS),LS("userId","==",t)),r=await BS(e),n={};return r.docs.forEach(s=>{const i=s.data();n[i.operatorId]=i.assignments||[]}),n}catch(e){throw console.error("Error getting all assignments:",e),e}},async deleteOperatorAssignments(t,e){try{await zS(Ii(rs,ns.ASSIGNMENTS,`${t}_${e}`))}catch(r){throw console.error("Error deleting assignments:",r),r}}},Sj={async saveCallData(t,e){try{const r=Ii(rs,ns.CALL_DATA,t);await jS(r,{userId:t,callData:e,updatedAt:new Date})}catch(r){throw console.error("Error saving call data:",r),r}},async getCallData(t){try{const e=Ii(rs,ns.CALL_DATA,t),r=await VS(e);return r.exists()?r.data().callData||[]:[]}catch(e){throw console.error("Error getting call data:",e),e}}},Ij=()=>{const{user:t,logout:e}=N1(),[r,n]=Ze.useState("dashboard"),[s,i]=Ze.useState([]),[a,o]=Ze.useState([]),[c,l]=Ze.useState([]),[f,h]=Ze.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[d,m]=Ze.useState([]),[g,v]=Ze.useState([]),[E,T]=Ze.useState("all"),[w,x]=Ze.useState(""),[O,z]=Ze.useState([]),[B,_]=Ze.useState(!1),[k,A]=Ze.useState(null),[I,R]=Ze.useState({name:"",email:"",phone:""}),[C,N]=Ze.useState({}),[ye,he]=Ze.useState(null),we=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}];Ze.useEffect(()=>{t&&ge()},[t]);const ge=async()=>{try{const re=await Ld.getByUser(t.uid);z(re);const _e=await lf.getAllUserAssignments(t.uid);N(_e);const Ce=await Sj.getCallData(t.uid);i(Ce),ie(_e,re),te()}catch(re){console.error("Error loading user data:",re),W()}},ie=(re,_e)=>{const Ce=[];Object.entries(re).forEach(([Re,De])=>{const Ve=_e.find(rt=>rt.id===Re);Ve&&De&&De.forEach(rt=>{Ce.push({id:rt.id,operator:Ve.name,beneficiary:rt.beneficiary,phone:rt.primaryPhone,commune:rt.commune})})}),o(Ce)},W=()=>{o(we),le(),te()},le=()=>{z([{id:1,name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321"},{id:2,name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322"},{id:3,name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323"},{id:4,name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324"},{id:5,name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325"}])},Te=async()=>{if(I.name.trim()!=="")try{const re=await Ld.create(t.uid,I);z([...O,re]),R({name:"",email:"",phone:""}),_(!1)}catch(re){console.error("Error creating operator:",re),alert("Error al crear teleoperador. Intenta nuevamente.")}},M=async re=>{try{await Ld.delete(re),await lf.deleteOperatorAssignments(t.uid,re),z(O.filter(Re=>Re.id!==re));const _e={...C};delete _e[re],N(_e);const Ce=a.filter(Re=>!Re.id.toString().startsWith(`${re}-`));o(Ce)}catch(_e){console.error("Error deleting operator:",_e),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},K=(re,_e)=>{const Ce=re.target.files[0];if(Ce){const Re=new FileReader;Re.onload=De=>{const Ve=new Uint8Array(De.target.result),rt=dh(Ve,{type:"array"}),Ye=rt.SheetNames[0],gt=rt.Sheets[Ye],Rt=S_.sheet_to_json(gt,{header:1});G(Rt,_e)},Re.readAsArrayBuffer(Ce)}re.target.value=""},G=async(re,_e)=>{if(re.length<2)return;const Ce=O.find(De=>De.id===_e);if(!Ce)return;const Re=re.slice(1).map((De,Ve)=>{const rt=De[1]?String(De[1]).split(/[\|\-\s]+/).filter(Ye=>Ye.trim().length===9):[];return{id:`${_e}-${Ve}`,operatorId:_e,operatorName:Ce.name,beneficiary:De[0]||"",phones:rt,primaryPhone:rt[0]||"",commune:De[2]||""}}).filter(De=>De.beneficiary&&De.primaryPhone);try{await lf.saveOperatorAssignments(t.uid,_e,Re),N(Ve=>({...Ve,[_e]:Re}));const De=Re.map(Ve=>({id:Ve.id,operator:Ve.operatorName,beneficiary:Ve.beneficiary,phone:Ve.primaryPhone,commune:Ve.commune}));o(Ve=>[...Ve.filter(Ye=>!Ye.id.toString().startsWith(`${_e}-`)),...De]),he(null)}catch(De){console.error("Error saving assignments:",De),alert("Error al guardar asignaciones. Intenta nuevamente.")}},H=async re=>{try{await lf.deleteOperatorAssignments(t.uid,re);const _e={...C};delete _e[re],N(_e),o(Ce=>Ce.filter(Re=>!Re.id.toString().startsWith(`${re}-`)))}catch(_e){console.error("Error clearing assignments:",_e),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},te=()=>{const _e=["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"].map(rt=>({operator:rt,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),Ce=Array.from({length:24},(rt,Ye)=>({hour:Ye,calls:Math.floor(Math.random()*20)+1}));m(_e),v(Ce),h({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:5,operators:5,protocolCompliance:85,pendingFollowUps:12});const Re=["al-dia","pendiente","urgente"],De={"al-dia":"bg-green-100 text-green-800",pendiente:"bg-yellow-100 text-yellow-800",urgente:"bg-red-100 text-red-800"},Ve=we.map(rt=>({...rt,status:Re[Math.floor(Math.random()*Re.length)],lastCall:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString(),callCount:Math.floor(Math.random()*10)+1,colorClass:De[Re[Math.floor(Math.random()*Re.length)]]}));l(Ve)},ue=re=>{const _e=re.target.files[0];if(_e){const Ce=new FileReader;Ce.onload=Re=>{const De=new Uint8Array(Re.target.result),Ve=dh(De,{type:"array"}),rt=Ve.SheetNames[0],Ye=Ve.Sheets[rt],gt=S_.sheet_to_json(Ye,{header:1});ke(gt)},Ce.readAsArrayBuffer(_e)}},ke=re=>{if(re.length<2)return;const _e=re.slice(1).map(Ce=>({id:Ce[0],date:Ce[1],beneficiary:Ce[2],commune:Ce[3],event:Ce[4],phone:Ce[5],startTime:Ce[6],endTime:Ce[7],duration:Ce[8],result:Ce[9],observation:Ce[10],apiId:Ce[11]}));i(_e),de(_e)},de=re=>{const _e=re.filter(Re=>Re.result==="Llamado exitoso");_e.filter(Re=>Re.event==="Entrante"),_e.filter(Re=>Re.event==="Saliente"),h(Re=>({...Re,totalCalls:re.length,successfulCalls:_e.length,failedCalls:re.length-_e.length}));const Ce={};_e.forEach(Re=>{const De=a.find(Ve=>Ve.beneficiary===Re.beneficiary);De&&(Ce[De.operator]||(Ce[De.operator]={operator:De.operator,totalCalls:0,totalMinutes:0,avgDuration:0}),Ce[De.operator].totalCalls++,Ce[De.operator].totalMinutes+=parseInt(Re.duration)/60||0)}),Object.values(Ce).forEach(Re=>{Re.avgDuration=Re.totalCalls>0?Re.totalMinutes/Re.totalCalls:0}),m(Object.values(Ce))},ae=c.filter(re=>{const _e=E==="all"||re.status===E,Ce=re.beneficiary.toLowerCase().includes(w.toLowerCase())||re.operator.toLowerCase().includes(w.toLowerCase());return _e&&Ce}),Le=({title:re,value:_e,subtitle:Ce,icon:Re,trend:De,color:Ve="blue"})=>F.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsx("p",{className:"text-sm text-gray-600 mb-1",children:re}),F.jsx("p",{className:`text-2xl font-bold text-${Ve}-600 mb-1`,children:_e}),F.jsx("p",{className:"text-xs text-gray-500",children:Ce})]}),F.jsxs("div",{className:"flex items-center",children:[F.jsx(Re,{className:`w-8 h-8 text-${Ve}-500 mr-2`}),De&&F.jsx("div",{className:`flex items-center ${De>0?"text-green-500":"text-red-500"}`,children:De>0?F.jsx(LR,{className:"w-4 h-4"}):F.jsx(DR,{className:"w-4 h-4"})})]})]})}),j=()=>F.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[F.jsxs("div",{className:"p-6 flex-1",children:[F.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"WebApp de Seguimiento de Llamadas"}),F.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),F.jsxs("nav",{className:"space-y-2",children:[F.jsx(at,{icon:xx,label:"Panel principal",active:r==="dashboard",onClick:()=>n("dashboard")}),F.jsx(at,{icon:ti,label:"Registro de Llamadas",active:r==="calls",onClick:()=>n("calls")}),F.jsx(at,{icon:Ji,label:"Asignaciones",active:r==="assignments",onClick:()=>n("assignments")}),F.jsx(at,{icon:ld,label:"Historial de Seguimientos",active:r==="history",onClick:()=>n("history")})]})]}),F.jsxs("div",{className:"p-6 border-t border-gray-200",children:[F.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[F.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:F.jsx(A2,{className:"w-5 h-5 text-blue-600"})}),F.jsxs("div",{className:"flex-1 min-w-0",children:[F.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||"Usuario"}),F.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),F.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[F.jsx(TR,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]}),at=({icon:re,label:_e,active:Ce,onClick:Re})=>F.jsxs("button",{onClick:Re,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${Ce?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[F.jsx(re,{className:"w-5 h-5 mr-3"}),F.jsx("span",{className:"text-sm",children:_e})]}),$e=()=>F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[F.jsx(Le,{title:"Llamadas totales",value:f.totalCalls,subtitle:"Cantidad total de llamadas registradas",icon:ti,color:"blue"}),F.jsx(Le,{title:"Llamadas exitosas",value:f.successfulCalls,subtitle:"Llamadas con resultado exitoso",icon:ti,trend:1,color:"green"}),F.jsx(Le,{title:"Llamadas no exitosas",value:f.failedCalls,subtitle:"No contestadas, fallidas u otro",icon:ti,trend:-1,color:"red"}),F.jsx(Le,{title:"Beneficiarios",value:f.beneficiaries,subtitle:"Personas beneficiarias en la base de datos",icon:Ji,color:"purple"})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[F.jsx(Le,{title:"Asignaciones activas",value:f.activeAssignments,subtitle:"Relaciones vigentes beneficiario-teleoperadora",icon:Ji,color:"blue"}),F.jsx(Le,{title:"Teleoperadoras",value:f.operators,subtitle:"Cantidad de teleoperadoras registradas",icon:Ji,color:"blue"}),F.jsx(Le,{title:"Cumplimiento protocolo",value:`${f.protocolCompliance}%`,subtitle:"Promedio de cumplimiento en llamadas",icon:xx,color:"blue"}),F.jsx(Le,{title:"Seguimientos pendientes",value:f.pendingFollowUps,subtitle:"Seguimientos an no realizados",icon:ld,trend:-1,color:"red"})]}),F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Mdulos principales"}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[F.jsx(Xe,{title:"Registro de Llamadas",description:"Sube historiales, analiza resultados y clasifica por beneficiario y teleoperadora.",icon:ti,color:"green",onClick:()=>n("calls")}),F.jsx(Xe,{title:"Asignaciones",description:"Gestiona relaciones entre beneficiarios y teleoperadoras.",icon:Ji,color:"blue",onClick:()=>n("assignments")}),F.jsx(Xe,{title:"Historial de Seguimientos",description:"Clasifica beneficiarios por frecuencia y estado de contacto.",icon:ld,color:"orange",onClick:()=>n("history")})]})]}),F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Detalle por Teleoperadora"}),F.jsx("div",{className:"overflow-x-auto",children:F.jsxs("table",{className:"w-full",children:[F.jsx("thead",{children:F.jsxs("tr",{className:"bg-gray-50",children:[F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Teleoperadora"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Cantidad de llamados"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Minutos totales"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tiempo promedio"})]})}),F.jsx("tbody",{children:d.map((re,_e)=>F.jsxs("tr",{className:"border-b",children:[F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.operator}),F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.totalCalls}),F.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(re.totalMinutes)," min"]}),F.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(re.avgDuration)," min"]})]},_e))})]})})]})]}),Xe=({title:re,description:_e,icon:Ce,color:Re,onClick:De})=>F.jsxs("div",{className:`bg-${Re}-50 rounded-lg p-6 border border-${Re}-200`,children:[F.jsx("div",{className:"flex items-center justify-center mb-4",children:F.jsx("div",{className:`w-16 h-16 bg-${Re}-500 rounded-lg flex items-center justify-center`,children:F.jsx(Ce,{className:"w-8 h-8 text-white"})})}),F.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:re}),F.jsx("p",{className:"text-sm text-gray-600 mb-4",children:_e}),F.jsx("button",{onClick:De,className:`w-full bg-${Re}-500 text-white py-2 px-4 rounded-lg hover:bg-${Re}-600 transition-colors`,children:"Entrar"})]}),je=()=>F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),F.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),F.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[F.jsx(Ex,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),F.jsxs("label",{className:"cursor-pointer",children:[F.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),F.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ue,className:"hidden"})]}),F.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]})]}),s.length>0&&F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),F.jsx("div",{className:"overflow-x-auto",children:F.jsxs("table",{className:"w-full",children:[F.jsx("thead",{children:F.jsxs("tr",{className:"bg-gray-50",children:[F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Evento"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),F.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),F.jsx("tbody",{children:s.slice(0,10).map((re,_e)=>F.jsxs("tr",{className:"border-b",children:[F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.id}),F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.date}),F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.beneficiary}),F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:re.event}),F.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:F.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${re.result==="Llamado exitoso"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:re.result})}),F.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[re.duration,"s"]})]},_e))})]})})]})]}),ve=()=>F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsxs("div",{className:"flex justify-between items-center mb-4",children:[F.jsxs("div",{children:[F.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),F.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),F.jsxs("button",{onClick:()=>_(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[F.jsx(wx,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[F.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),F.jsx("p",{className:"text-2xl font-bold text-blue-600",children:O.length})]}),F.jsx(Ji,{className:"w-8 h-8 text-blue-500"})]})}),F.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),F.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(C).reduce((re,_e)=>re+_e.length,0)})]}),F.jsx(ti,{className:"w-8 h-8 text-green-500"})]})}),F.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{children:[F.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),F.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(C).length})]}),F.jsx(xR,{className:"w-8 h-8 text-purple-500"})]})})]})]}),B&&F.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:F.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[F.jsxs("div",{className:"flex justify-between items-center mb-4",children:[F.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),F.jsx("button",{onClick:()=>_(!1),className:"text-gray-500 hover:text-gray-700",children:F.jsx(jR,{className:"w-5 h-5"})})]}),F.jsxs("div",{className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),F.jsx("input",{type:"text",value:I.name,onChange:re=>R({...I,name:re.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),F.jsx("input",{type:"email",value:I.email,onChange:re=>R({...I,email:re.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),F.jsx("input",{type:"tel",value:I.phone,onChange:re=>R({...I,phone:re.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),F.jsxs("div",{className:"flex gap-3 mt-6",children:[F.jsxs("button",{onClick:Te,disabled:!I.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[F.jsx(CR,{className:"w-4 h-4"}),"Crear Teleoperador"]}),F.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),F.jsxs("div",{className:"space-y-4",children:[O.map(re=>F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsxs("div",{className:"flex justify-between items-start mb-4",children:[F.jsxs("div",{className:"flex-1",children:[F.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[F.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:re.name}),C[re.id]&&F.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[C[re.id].length," beneficiarios"]})]}),F.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[re.email&&F.jsxs("p",{children:[" ",re.email]}),re.phone&&F.jsxs("p",{children:[" ",re.phone]})]})]}),F.jsxs("div",{className:"flex gap-2",children:[F.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[F.jsx(Ex,{className:"w-4 h-4"}),"Subir Excel",F.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:_e=>K(_e,re.id),className:"hidden"})]}),C[re.id]&&F.jsxs("button",{onClick:()=>H(re.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[F.jsx(yx,{className:"w-4 h-4"}),"Limpiar"]}),F.jsxs("button",{onClick:()=>M(re.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[F.jsx(yx,{className:"w-4 h-4"}),"Eliminar"]})]})]}),F.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[F.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),F.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),C[re.id]&&C[re.id].length>0&&F.jsxs("div",{className:"border-t pt-4",children:[F.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",C[re.id].length,")"]}),F.jsx("div",{className:"overflow-x-auto",children:F.jsxs("table",{className:"w-full text-sm",children:[F.jsx("thead",{children:F.jsxs("tr",{className:"bg-gray-50",children:[F.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),F.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),F.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),F.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),F.jsxs("tbody",{children:[C[re.id].slice(0,5).map(_e=>F.jsxs("tr",{className:"border-b",children:[F.jsx("td",{className:"px-3 py-2 text-gray-900",children:_e.beneficiary}),F.jsx("td",{className:"px-3 py-2 text-gray-900",children:_e.primaryPhone}),F.jsx("td",{className:"px-3 py-2 text-gray-600",children:_e.phones.length>1?_e.phones.slice(1).join(", "):"-"}),F.jsx("td",{className:"px-3 py-2 text-gray-900",children:_e.commune})]},_e.id)),C[re.id].length>5&&F.jsx("tr",{children:F.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",C[re.id].length-5," beneficiarios ms"]})})]})]})})]})]},re.id)),O.length===0&&F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[F.jsx(Ji,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),F.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),F.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),F.jsxs("button",{onClick:()=>_(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[F.jsx(wx,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),mt=()=>F.jsx("div",{className:"space-y-6",children:F.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[F.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),F.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),F.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx(yR,{className:"w-4 h-4 text-gray-400"}),F.jsxs("select",{value:E,onChange:re=>T(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[F.jsx("option",{value:"all",children:"Todos los estados"}),F.jsx("option",{value:"al-dia",children:"Al da"}),F.jsx("option",{value:"pendiente",children:"Pendiente"}),F.jsx("option",{value:"urgente",children:"Urgente"})]})]}),F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx(PR,{className:"w-4 h-4 text-gray-400"}),F.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:w,onChange:re=>x(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),F.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ae.map(re=>F.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[F.jsxs("div",{className:"flex items-start justify-between mb-2",children:[F.jsx("h4",{className:"font-medium text-gray-900",children:re.beneficiary}),F.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${re.status==="al-dia"?"bg-green-100 text-green-800":re.status==="pendiente"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:re.status==="al-dia"?"Al da":re.status==="pendiente"?"Pendiente":"Urgente"})]}),F.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Teleoperadora: ",re.operator]}),F.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["ltima llamada: ",re.lastCall]}),F.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total llamadas: ",re.callCount]}),F.jsxs("p",{className:"text-sm text-gray-600",children:["Telfono: ",re.phone]}),re.status==="urgente"&&F.jsxs("div",{className:"mt-2 flex items-center text-red-600 text-sm",children:[F.jsx(k2,{className:"w-4 h-4 mr-1"}),"Requiere atencin inmediata"]})]},re.id))})]})});return F.jsxs("div",{className:"flex h-screen bg-gray-100",children:[F.jsx(j,{}),F.jsx("div",{className:"flex-1 overflow-auto",children:F.jsxs("div",{className:"p-6",children:[F.jsx("div",{className:"mb-6",children:F.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r==="dashboard"&&"Panel principal",r==="calls"&&"Registro de Llamadas",r==="assignments"&&"Asignaciones",r==="history"&&"Historial de Seguimientos"]})}),r==="dashboard"&&F.jsx($e,{}),r==="calls"&&F.jsx(je,{}),r==="assignments"&&F.jsx(ve,{}),r==="history"&&F.jsx(mt,{})]})})]})},Cj=()=>{const[t,e]=Ze.useState(!0),[r,n]=Ze.useState(!1),[s,i]=Ze.useState({email:"",password:"",confirmPassword:"",displayName:""}),[a,o]=Ze.useState(!1),{login:c,register:l,error:f,clearError:h}=N1(),d=E=>{const{name:T,value:w}=E.target;i(x=>({...x,[T]:w})),h()},m=async E=>{E.preventDefault(),o(!0);try{if(t)await c(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await l(s.email,s.password,s.displayName)}}catch(T){console.error("Error en autenticacin:",T)}finally{o(!1)}},g=()=>{e(!t),i({email:"",password:"",confirmPassword:"",displayName:""}),h()},v=E=>E?E.includes("user-not-found")?"Usuario no encontrado":E.includes("wrong-password")?"Contrasea incorrecta":E.includes("email-already-in-use")?"Este email ya est registrado":E.includes("weak-password")?"La contrasea es muy dbil":E.includes("invalid-email")?"Email invlido":E.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":E:"";return F.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:F.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[F.jsxs("div",{className:"text-center mb-8",children:[F.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:F.jsx(ti,{className:"w-8 h-8 text-blue-600"})}),F.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Central de Teleoperadores"}),F.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),f&&F.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[F.jsx(k2,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),F.jsxs("div",{children:[F.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),F.jsx("p",{className:"text-red-600 text-sm mt-1",children:v(f)})]})]}),F.jsxs("form",{onSubmit:m,className:"space-y-6",children:[!t&&F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),F.jsxs("div",{className:"relative",children:[F.jsx(A2,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),F.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),F.jsxs("div",{className:"relative",children:[F.jsx(AR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),F.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),F.jsxs("div",{className:"relative",children:[F.jsx(_x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),F.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:d,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),F.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?F.jsx(pR,{className:"w-5 h-5"}):F.jsx(gR,{className:"w-5 h-5"})})]})]}),!t&&F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),F.jsxs("div",{className:"relative",children:[F.jsx(_x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),F.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),F.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:a?F.jsxs(F.Fragment,{children:[F.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):F.jsx(F.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),F.jsxs("div",{className:"mt-8 text-center",children:[F.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),F.jsx("button",{onClick:g,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),F.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:F.jsxs("div",{className:"flex items-start gap-3",children:[F.jsx(fR,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),F.jsxs("div",{children:[F.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),F.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},Rj=()=>F.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:F.jsxs("div",{className:"text-center",children:[F.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:F.jsx(ti,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),F.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Central de Teleoperadores"}),F.jsxs("div",{className:"flex items-center justify-center gap-2",children:[F.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),F.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),F.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),F.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),Pj=()=>{const{user:t,loading:e}=N1();return e?F.jsx(Rj,{}):t?F.jsx(Ij,{}):F.jsx(Cj,{})};bd.createRoot(document.getElementById("root")).render(F.jsx(WI.StrictMode,{children:F.jsx(Aj,{children:F.jsx(Pj,{})})}));
