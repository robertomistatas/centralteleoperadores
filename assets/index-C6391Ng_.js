(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function hF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lk={exports:{}},zm={},Mk={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rh=Symbol.for("react.element"),dF=Symbol.for("react.portal"),mF=Symbol.for("react.fragment"),pF=Symbol.for("react.strict_mode"),gF=Symbol.for("react.profiler"),xF=Symbol.for("react.provider"),yF=Symbol.for("react.context"),vF=Symbol.for("react.forward_ref"),wF=Symbol.for("react.suspense"),_F=Symbol.for("react.memo"),EF=Symbol.for("react.lazy"),h2=Symbol.iterator;function TF(t){return t===null||typeof t!="object"?null:(t=h2&&t[h2]||t["@@iterator"],typeof t=="function"?t:null)}var jk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vk=Object.assign,Bk={};function eu(t,e,r){this.props=t,this.context=e,this.refs=Bk,this.updater=r||jk}eu.prototype.isReactComponent={};eu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Uk(){}Uk.prototype=eu.prototype;function Ty(t,e,r){this.props=t,this.context=e,this.refs=Bk,this.updater=r||jk}var Sy=Ty.prototype=new Uk;Sy.constructor=Ty;Vk(Sy,eu.prototype);Sy.isPureReactComponent=!0;var d2=Array.isArray,$k=Object.prototype.hasOwnProperty,Ay={current:null},zk={key:!0,ref:!0,__self:!0,__source:!0};function Hk(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)$k.call(e,n)&&!zk.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Rh,type:t,key:i,ref:a,props:s,_owner:Ay.current}}function SF(t,e){return{$$typeof:Rh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ky(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rh}function AF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var m2=/\/+/g;function Jp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?AF(""+t.key):e.toString(36)}function a0(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Rh:case dF:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+Jp(a,0):n,d2(s)?(r="",t!=null&&(r=t.replace(m2,"$&/")+"/"),a0(s,e,r,"",function(c){return c})):s!=null&&(ky(s)&&(s=SF(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(m2,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",d2(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+Jp(i,o);a+=a0(i,e,r,l,s)}else if(l=TF(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+Jp(i,o++),a+=a0(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function _d(t,e,r){if(t==null)return t;var n=[],s=0;return a0(t,n,"","",function(i){return e.call(r,i,s++)}),n}function kF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kn={current:null},o0={transition:null},bF={ReactCurrentDispatcher:kn,ReactCurrentBatchConfig:o0,ReactCurrentOwner:Ay};function Wk(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:_d,forEach:function(t,e,r){_d(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return _d(t,function(){e++}),e},toArray:function(t){return _d(t,function(e){return e})||[]},only:function(t){if(!ky(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};st.Component=eu;st.Fragment=mF;st.Profiler=gF;st.PureComponent=Ty;st.StrictMode=pF;st.Suspense=wF;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bF;st.act=Wk;st.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Vk({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Ay.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)$k.call(e,l)&&!zk.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Rh,type:t.type,key:s,ref:i,props:n,_owner:a}};st.createContext=function(t){return t={$$typeof:yF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xF,_context:t},t.Consumer=t};st.createElement=Hk;st.createFactory=function(t){var e=Hk.bind(null,t);return e.type=t,e};st.createRef=function(){return{current:null}};st.forwardRef=function(t){return{$$typeof:vF,render:t}};st.isValidElement=ky;st.lazy=function(t){return{$$typeof:EF,_payload:{_status:-1,_result:t},_init:kF}};st.memo=function(t,e){return{$$typeof:_F,type:t,compare:e===void 0?null:e}};st.startTransition=function(t){var e=o0.transition;o0.transition={};try{t()}finally{o0.transition=e}};st.unstable_act=Wk;st.useCallback=function(t,e){return kn.current.useCallback(t,e)};st.useContext=function(t){return kn.current.useContext(t)};st.useDebugValue=function(){};st.useDeferredValue=function(t){return kn.current.useDeferredValue(t)};st.useEffect=function(t,e){return kn.current.useEffect(t,e)};st.useId=function(){return kn.current.useId()};st.useImperativeHandle=function(t,e,r){return kn.current.useImperativeHandle(t,e,r)};st.useInsertionEffect=function(t,e){return kn.current.useInsertionEffect(t,e)};st.useLayoutEffect=function(t,e){return kn.current.useLayoutEffect(t,e)};st.useMemo=function(t,e){return kn.current.useMemo(t,e)};st.useReducer=function(t,e,r){return kn.current.useReducer(t,e,r)};st.useRef=function(t){return kn.current.useRef(t)};st.useState=function(t){return kn.current.useState(t)};st.useSyncExternalStore=function(t,e,r){return kn.current.useSyncExternalStore(t,e,r)};st.useTransition=function(){return kn.current.useTransition()};st.version="18.3.1";Mk.exports=st;var te=Mk.exports;const Pf=hF(te);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CF=te,IF=Symbol.for("react.element"),NF=Symbol.for("react.fragment"),RF=Object.prototype.hasOwnProperty,PF=CF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DF={key:!0,ref:!0,__self:!0,__source:!0};function Gk(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)RF.call(e,n)&&!DF.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:IF,type:t,key:i,ref:a,props:s,_owner:PF.current}}zm.Fragment=NF;zm.jsx=Gk;zm.jsxs=Gk;Lk.exports=zm;var f=Lk.exports,xx={},qk={exports:{}},ss={},Kk={exports:{}},Xk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,W){var ie=Z.length;Z.push(W);e:for(;0<ie;){var ue=ie-1>>>1,L=Z[ue];if(0<s(L,W))Z[ue]=W,Z[ie]=L,ie=ue;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var W=Z[0],ie=Z.pop();if(ie!==W){Z[0]=ie;e:for(var ue=0,L=Z.length,K=L>>>1;ue<K;){var X=2*(ue+1)-1,H=Z[X],re=X+1,ee=Z[re];if(0>s(H,ie))re<L&&0>s(ee,H)?(Z[ue]=ee,Z[re]=ie,ue=re):(Z[ue]=H,Z[X]=ie,ue=X);else if(re<L&&0>s(ee,ie))Z[ue]=ee,Z[re]=ie,ue=re;else break e}}return W}function s(Z,W){var ie=Z.sortIndex-W.sortIndex;return ie!==0?ie:Z.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,m=3,p=!1,x=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var W=r(c);W!==null;){if(W.callback===null)n(c);else if(W.startTime<=Z)n(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=r(c)}}function I(Z){if(g=!1,y(Z),!x)if(r(l)!==null)x=!0,ve(O);else{var W=r(c);W!==null&&he(I,W.startTime-Z)}}function O(Z,W){x=!1,g&&(g=!1,_(E),E=-1),p=!0;var ie=m;try{for(y(W),h=r(l);h!==null&&(!(h.expirationTime>W)||Z&&!C());){var ue=h.callback;if(typeof ue=="function"){h.callback=null,m=h.priorityLevel;var L=ue(h.expirationTime<=W);W=t.unstable_now(),typeof L=="function"?h.callback=L:h===r(l)&&n(l),y(W)}else n(l);h=r(l)}if(h!==null)var K=!0;else{var X=r(c);X!==null&&he(I,X.startTime-W),K=!1}return K}finally{h=null,m=ie,p=!1}}var P=!1,S=null,E=-1,A=5,N=-1;function C(){return!(t.unstable_now()-N<A)}function R(){if(S!==null){var Z=t.unstable_now();N=Z;var W=!0;try{W=S(!0,Z)}finally{W?F():(P=!1,S=null)}}else P=!1}var F;if(typeof w=="function")F=function(){w(R)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ae=oe.port2;oe.port1.onmessage=R,F=function(){ae.postMessage(null)}}else F=function(){v(R,0)};function ve(Z){S=Z,P||(P=!0,F())}function he(Z,W){E=v(function(){Z(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,ve(O))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ie=m;m=W;try{return Z()}finally{m=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,W){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ie=m;m=Z;try{return W()}finally{m=ie}},t.unstable_scheduleCallback=function(Z,W,ie){var ue=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ue+ie:ue):ie=ue,Z){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=ie+L,Z={id:u++,callback:W,priorityLevel:Z,startTime:ie,expirationTime:L,sortIndex:-1},ie>ue?(Z.sortIndex=ie,e(c,Z),r(l)===null&&Z===r(c)&&(g?(_(E),E=-1):g=!0,he(I,ie-ue))):(Z.sortIndex=L,e(l,Z),x||p||(x=!0,ve(O))),Z},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(Z){var W=m;return function(){var ie=m;m=W;try{return Z.apply(this,arguments)}finally{m=ie}}}})(Xk);Kk.exports=Xk;var FF=Kk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OF=te,rs=FF;function Te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yk=new Set,Df={};function gl(t,e){Rc(t,e),Rc(t+"Capture",e)}function Rc(t,e){for(Df[t]=e,t=0;t<e.length;t++)Yk.add(e[t])}var Ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yx=Object.prototype.hasOwnProperty,LF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p2={},g2={};function MF(t){return yx.call(g2,t)?!0:yx.call(p2,t)?!1:LF.test(t)?g2[t]=!0:(p2[t]=!0,!1)}function jF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VF(t,e,r,n){if(e===null||typeof e>"u"||jF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bn(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Yr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yr[t]=new bn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yr[e]=new bn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yr[t]=new bn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yr[t]=new bn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yr[t]=new bn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yr[t]=new bn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yr[t]=new bn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yr[t]=new bn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yr[t]=new bn(t,5,!1,t.toLowerCase(),null,!1,!1)});var by=/[\-:]([a-z])/g;function Cy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(by,Cy);Yr[e]=new bn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(by,Cy);Yr[e]=new bn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(by,Cy);Yr[e]=new bn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yr[t]=new bn(t,1,!1,t.toLowerCase(),null,!1,!1)});Yr.xlinkHref=new bn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yr[t]=new bn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Iy(t,e,r,n){var s=Yr.hasOwnProperty(e)?Yr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VF(e,r,s,n)&&(r=null),n||s===null?MF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ia=OF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ed=Symbol.for("react.element"),ql=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),Ny=Symbol.for("react.strict_mode"),vx=Symbol.for("react.profiler"),Qk=Symbol.for("react.provider"),Jk=Symbol.for("react.context"),Ry=Symbol.for("react.forward_ref"),wx=Symbol.for("react.suspense"),_x=Symbol.for("react.suspense_list"),Py=Symbol.for("react.memo"),_a=Symbol.for("react.lazy"),Zk=Symbol.for("react.offscreen"),x2=Symbol.iterator;function Iu(t){return t===null||typeof t!="object"?null:(t=x2&&t[x2]||t["@@iterator"],typeof t=="function"?t:null)}var Gt=Object.assign,Zp;function Bu(t){if(Zp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Zp=e&&e[1]||""}return`
`+Zp+t}var eg=!1;function tg(t,e){if(!t||eg)return"";eg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{eg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Bu(t):""}function BF(t){switch(t.tag){case 5:return Bu(t.type);case 16:return Bu("Lazy");case 13:return Bu("Suspense");case 19:return Bu("SuspenseList");case 0:case 2:case 15:return t=tg(t.type,!1),t;case 11:return t=tg(t.type.render,!1),t;case 1:return t=tg(t.type,!0),t;default:return""}}function Ex(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Kl:return"Fragment";case ql:return"Portal";case vx:return"Profiler";case Ny:return"StrictMode";case wx:return"Suspense";case _x:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Jk:return(t.displayName||"Context")+".Consumer";case Qk:return(t._context.displayName||"Context")+".Provider";case Ry:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Py:return e=t.displayName||null,e!==null?e:Ex(t.type)||"Memo";case _a:e=t._payload,t=t._init;try{return Ex(t(e))}catch{}}return null}function UF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ex(e);case 8:return e===Ny?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ga(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function eb(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $F(t){var e=eb(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Td(t){t._valueTracker||(t._valueTracker=$F(t))}function tb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=eb(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function F0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tx(t,e){var r=e.checked;return Gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function y2(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ga(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rb(t,e){e=e.checked,e!=null&&Iy(t,"checked",e,!1)}function Sx(t,e){rb(t,e);var r=Ga(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ax(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ax(t,e.type,Ga(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function v2(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ax(t,e,r){(e!=="number"||F0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Uu=Array.isArray;function dc(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ga(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function kx(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function w2(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Te(92));if(Uu(r)){if(1<r.length)throw Error(Te(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ga(r)}}function nb(t,e){var r=Ga(e.value),n=Ga(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function _2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function sb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bx(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?sb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sd,ib=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sd=Sd||document.createElement("div"),Sd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ff(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ef={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zF=["Webkit","ms","Moz","O"];Object.keys(ef).forEach(function(t){zF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ef[e]=ef[t]})});function ab(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ef.hasOwnProperty(t)&&ef[t]?(""+e).trim():e+"px"}function ob(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=ab(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var HF=Gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cx(t,e){if(e){if(HF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Te(62))}}function Ix(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nx=null;function Dy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rx=null,mc=null,pc=null;function E2(t){if(t=Fh(t)){if(typeof Rx!="function")throw Error(Te(280));var e=t.stateNode;e&&(e=Km(e),Rx(t.stateNode,t.type,e))}}function lb(t){mc?pc?pc.push(t):pc=[t]:mc=t}function cb(){if(mc){var t=mc,e=pc;if(pc=mc=null,E2(t),e)for(t=0;t<e.length;t++)E2(e[t])}}function ub(t,e){return t(e)}function fb(){}var rg=!1;function hb(t,e,r){if(rg)return t(e,r);rg=!0;try{return ub(t,e,r)}finally{rg=!1,(mc!==null||pc!==null)&&(fb(),cb())}}function Of(t,e){var r=t.stateNode;if(r===null)return null;var n=Km(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Te(231,e,typeof r));return r}var Px=!1;if(Ki)try{var Nu={};Object.defineProperty(Nu,"passive",{get:function(){Px=!0}}),window.addEventListener("test",Nu,Nu),window.removeEventListener("test",Nu,Nu)}catch{Px=!1}function WF(t,e,r,n,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var tf=!1,O0=null,L0=!1,Dx=null,GF={onError:function(t){tf=!0,O0=t}};function qF(t,e,r,n,s,i,a,o,l){tf=!1,O0=null,WF.apply(GF,arguments)}function KF(t,e,r,n,s,i,a,o,l){if(qF.apply(this,arguments),tf){if(tf){var c=O0;tf=!1,O0=null}else throw Error(Te(198));L0||(L0=!0,Dx=c)}}function xl(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function db(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function T2(t){if(xl(t)!==t)throw Error(Te(188))}function XF(t){var e=t.alternate;if(!e){if(e=xl(t),e===null)throw Error(Te(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return T2(s),t;if(i===n)return T2(s),e;i=i.sibling}throw Error(Te(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?t:e}function mb(t){return t=XF(t),t!==null?pb(t):null}function pb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pb(t);if(e!==null)return e;t=t.sibling}return null}var gb=rs.unstable_scheduleCallback,S2=rs.unstable_cancelCallback,YF=rs.unstable_shouldYield,QF=rs.unstable_requestPaint,ir=rs.unstable_now,JF=rs.unstable_getCurrentPriorityLevel,Fy=rs.unstable_ImmediatePriority,xb=rs.unstable_UserBlockingPriority,M0=rs.unstable_NormalPriority,ZF=rs.unstable_LowPriority,yb=rs.unstable_IdlePriority,Hm=null,hi=null;function e6(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(Hm,t,void 0,(t.current.flags&128)===128)}catch{}}var Ws=Math.clz32?Math.clz32:n6,t6=Math.log,r6=Math.LN2;function n6(t){return t>>>=0,t===0?32:31-(t6(t)/r6|0)|0}var Ad=64,kd=4194304;function $u(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function j0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=$u(o):(i&=a,i!==0&&(n=$u(i)))}else a=r&~s,a!==0?n=$u(a):i!==0&&(n=$u(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ws(e),s=1<<r,n|=t[r],e&=~s;return n}function s6(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function i6(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Ws(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=s6(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function Fx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vb(){var t=Ad;return Ad<<=1,!(Ad&4194240)&&(Ad=64),t}function ng(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ph(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ws(e),t[e]=r}function a6(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ws(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Oy(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ws(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var _t=0;function wb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _b,Ly,Eb,Tb,Sb,Ox=!1,bd=[],Fa=null,Oa=null,La=null,Lf=new Map,Mf=new Map,Ta=[],o6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A2(t,e){switch(t){case"focusin":case"focusout":Fa=null;break;case"dragenter":case"dragleave":Oa=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Lf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mf.delete(e.pointerId)}}function Ru(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Fh(e),e!==null&&Ly(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function l6(t,e,r,n,s){switch(e){case"focusin":return Fa=Ru(Fa,t,e,r,n,s),!0;case"dragenter":return Oa=Ru(Oa,t,e,r,n,s),!0;case"mouseover":return La=Ru(La,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Lf.set(i,Ru(Lf.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Mf.set(i,Ru(Mf.get(i)||null,t,e,r,n,s)),!0}return!1}function Ab(t){var e=Po(t.target);if(e!==null){var r=xl(e);if(r!==null){if(e=r.tag,e===13){if(e=db(r),e!==null){t.blockedOn=e,Sb(t.priority,function(){Eb(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function l0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Lx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Nx=n,r.target.dispatchEvent(n),Nx=null}else return e=Fh(r),e!==null&&Ly(e),t.blockedOn=r,!1;e.shift()}return!0}function k2(t,e,r){l0(t)&&r.delete(e)}function c6(){Ox=!1,Fa!==null&&l0(Fa)&&(Fa=null),Oa!==null&&l0(Oa)&&(Oa=null),La!==null&&l0(La)&&(La=null),Lf.forEach(k2),Mf.forEach(k2)}function Pu(t,e){t.blockedOn===e&&(t.blockedOn=null,Ox||(Ox=!0,rs.unstable_scheduleCallback(rs.unstable_NormalPriority,c6)))}function jf(t){function e(s){return Pu(s,t)}if(0<bd.length){Pu(bd[0],t);for(var r=1;r<bd.length;r++){var n=bd[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Fa!==null&&Pu(Fa,t),Oa!==null&&Pu(Oa,t),La!==null&&Pu(La,t),Lf.forEach(e),Mf.forEach(e),r=0;r<Ta.length;r++)n=Ta[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ta.length&&(r=Ta[0],r.blockedOn===null);)Ab(r),r.blockedOn===null&&Ta.shift()}var gc=ia.ReactCurrentBatchConfig,V0=!0;function u6(t,e,r,n){var s=_t,i=gc.transition;gc.transition=null;try{_t=1,My(t,e,r,n)}finally{_t=s,gc.transition=i}}function f6(t,e,r,n){var s=_t,i=gc.transition;gc.transition=null;try{_t=4,My(t,e,r,n)}finally{_t=s,gc.transition=i}}function My(t,e,r,n){if(V0){var s=Lx(t,e,r,n);if(s===null)dg(t,e,n,B0,r),A2(t,n);else if(l6(s,t,e,r,n))n.stopPropagation();else if(A2(t,n),e&4&&-1<o6.indexOf(t)){for(;s!==null;){var i=Fh(s);if(i!==null&&_b(i),i=Lx(t,e,r,n),i===null&&dg(t,e,n,B0,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else dg(t,e,n,null,r)}}var B0=null;function Lx(t,e,r,n){if(B0=null,t=Dy(n),t=Po(t),t!==null)if(e=xl(t),e===null)t=null;else if(r=e.tag,r===13){if(t=db(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return B0=t,null}function kb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JF()){case Fy:return 1;case xb:return 4;case M0:case ZF:return 16;case yb:return 536870912;default:return 16}default:return 16}}var Ia=null,jy=null,c0=null;function bb(){if(c0)return c0;var t,e=jy,r=e.length,n,s="value"in Ia?Ia.value:Ia.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return c0=s.slice(t,1<n?1-n:void 0)}function u0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Cd(){return!0}function b2(){return!1}function is(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cd:b2,this.isPropagationStopped=b2,this}return Gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cd)},persist:function(){},isPersistent:Cd}),e}var tu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vy=is(tu),Dh=Gt({},tu,{view:0,detail:0}),h6=is(Dh),sg,ig,Du,Wm=Gt({},Dh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:By,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Du&&(Du&&t.type==="mousemove"?(sg=t.screenX-Du.screenX,ig=t.screenY-Du.screenY):ig=sg=0,Du=t),sg)},movementY:function(t){return"movementY"in t?t.movementY:ig}}),C2=is(Wm),d6=Gt({},Wm,{dataTransfer:0}),m6=is(d6),p6=Gt({},Dh,{relatedTarget:0}),ag=is(p6),g6=Gt({},tu,{animationName:0,elapsedTime:0,pseudoElement:0}),x6=is(g6),y6=Gt({},tu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),v6=is(y6),w6=Gt({},tu,{data:0}),I2=is(w6),_6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},T6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S6(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=T6[t])?!!e[t]:!1}function By(){return S6}var A6=Gt({},Dh,{key:function(t){if(t.key){var e=_6[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=u0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?E6[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:By,charCode:function(t){return t.type==="keypress"?u0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?u0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),k6=is(A6),b6=Gt({},Wm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N2=is(b6),C6=Gt({},Dh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:By}),I6=is(C6),N6=Gt({},tu,{propertyName:0,elapsedTime:0,pseudoElement:0}),R6=is(N6),P6=Gt({},Wm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),D6=is(P6),F6=[9,13,27,32],Uy=Ki&&"CompositionEvent"in window,rf=null;Ki&&"documentMode"in document&&(rf=document.documentMode);var O6=Ki&&"TextEvent"in window&&!rf,Cb=Ki&&(!Uy||rf&&8<rf&&11>=rf),R2=" ",P2=!1;function Ib(t,e){switch(t){case"keyup":return F6.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xl=!1;function L6(t,e){switch(t){case"compositionend":return Nb(e);case"keypress":return e.which!==32?null:(P2=!0,R2);case"textInput":return t=e.data,t===R2&&P2?null:t;default:return null}}function M6(t,e){if(Xl)return t==="compositionend"||!Uy&&Ib(t,e)?(t=bb(),c0=jy=Ia=null,Xl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cb&&e.locale!=="ko"?null:e.data;default:return null}}var j6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function D2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!j6[t.type]:e==="textarea"}function Rb(t,e,r,n){lb(n),e=U0(e,"onChange"),0<e.length&&(r=new Vy("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var nf=null,Vf=null;function V6(t){$b(t,0)}function Gm(t){var e=Jl(t);if(tb(e))return t}function B6(t,e){if(t==="change")return e}var Pb=!1;if(Ki){var og;if(Ki){var lg="oninput"in document;if(!lg){var F2=document.createElement("div");F2.setAttribute("oninput","return;"),lg=typeof F2.oninput=="function"}og=lg}else og=!1;Pb=og&&(!document.documentMode||9<document.documentMode)}function O2(){nf&&(nf.detachEvent("onpropertychange",Db),Vf=nf=null)}function Db(t){if(t.propertyName==="value"&&Gm(Vf)){var e=[];Rb(e,Vf,t,Dy(t)),hb(V6,e)}}function U6(t,e,r){t==="focusin"?(O2(),nf=e,Vf=r,nf.attachEvent("onpropertychange",Db)):t==="focusout"&&O2()}function $6(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gm(Vf)}function z6(t,e){if(t==="click")return Gm(e)}function H6(t,e){if(t==="input"||t==="change")return Gm(e)}function W6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Xs=typeof Object.is=="function"?Object.is:W6;function Bf(t,e){if(Xs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!yx.call(e,s)||!Xs(t[s],e[s]))return!1}return!0}function L2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function M2(t,e){var r=L2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=L2(r)}}function Fb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Fb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ob(){for(var t=window,e=F0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=F0(t.document)}return e}function $y(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function G6(t){var e=Ob(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Fb(r.ownerDocument.documentElement,r)){if(n!==null&&$y(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=M2(r,i);var a=M2(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var q6=Ki&&"documentMode"in document&&11>=document.documentMode,Yl=null,Mx=null,sf=null,jx=!1;function j2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;jx||Yl==null||Yl!==F0(n)||(n=Yl,"selectionStart"in n&&$y(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),sf&&Bf(sf,n)||(sf=n,n=U0(Mx,"onSelect"),0<n.length&&(e=new Vy("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Yl)))}function Id(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ql={animationend:Id("Animation","AnimationEnd"),animationiteration:Id("Animation","AnimationIteration"),animationstart:Id("Animation","AnimationStart"),transitionend:Id("Transition","TransitionEnd")},cg={},Lb={};Ki&&(Lb=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function qm(t){if(cg[t])return cg[t];if(!Ql[t])return t;var e=Ql[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Lb)return cg[t]=e[r];return t}var Mb=qm("animationend"),jb=qm("animationiteration"),Vb=qm("animationstart"),Bb=qm("transitionend"),Ub=new Map,V2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function co(t,e){Ub.set(t,e),gl(e,[t])}for(var ug=0;ug<V2.length;ug++){var fg=V2[ug],K6=fg.toLowerCase(),X6=fg[0].toUpperCase()+fg.slice(1);co(K6,"on"+X6)}co(Mb,"onAnimationEnd");co(jb,"onAnimationIteration");co(Vb,"onAnimationStart");co("dblclick","onDoubleClick");co("focusin","onFocus");co("focusout","onBlur");co(Bb,"onTransitionEnd");Rc("onMouseEnter",["mouseout","mouseover"]);Rc("onMouseLeave",["mouseout","mouseover"]);Rc("onPointerEnter",["pointerout","pointerover"]);Rc("onPointerLeave",["pointerout","pointerover"]);gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y6=new Set("cancel close invalid load scroll toggle".split(" ").concat(zu));function B2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,KF(n,e,void 0,t),t.currentTarget=null}function $b(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;B2(s,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;B2(s,o,c),i=l}}}if(L0)throw t=Dx,L0=!1,Dx=null,t}function Nt(t,e){var r=e[zx];r===void 0&&(r=e[zx]=new Set);var n=t+"__bubble";r.has(n)||(zb(e,t,2,!1),r.add(n))}function hg(t,e,r){var n=0;e&&(n|=4),zb(r,t,n,e)}var Nd="_reactListening"+Math.random().toString(36).slice(2);function Uf(t){if(!t[Nd]){t[Nd]=!0,Yk.forEach(function(r){r!=="selectionchange"&&(Y6.has(r)||hg(r,!1,t),hg(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nd]||(e[Nd]=!0,hg("selectionchange",!1,e))}}function zb(t,e,r,n){switch(kb(e)){case 1:var s=u6;break;case 4:s=f6;break;default:s=My}r=s.bind(null,e,r,t),s=void 0,!Px||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function dg(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Po(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}hb(function(){var c=i,u=Dy(r),h=[];e:{var m=Ub.get(t);if(m!==void 0){var p=Vy,x=t;switch(t){case"keypress":if(u0(r)===0)break e;case"keydown":case"keyup":p=k6;break;case"focusin":x="focus",p=ag;break;case"focusout":x="blur",p=ag;break;case"beforeblur":case"afterblur":p=ag;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=C2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=m6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=I6;break;case Mb:case jb:case Vb:p=x6;break;case Bb:p=R6;break;case"scroll":p=h6;break;case"wheel":p=D6;break;case"copy":case"cut":case"paste":p=v6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=N2}var g=(e&4)!==0,v=!g&&t==="scroll",_=g?m!==null?m+"Capture":null:m;g=[];for(var w=c,y;w!==null;){y=w;var I=y.stateNode;if(y.tag===5&&I!==null&&(y=I,_!==null&&(I=Of(w,_),I!=null&&g.push($f(w,I,y)))),v)break;w=w.return}0<g.length&&(m=new p(m,x,null,r,u),h.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&r!==Nx&&(x=r.relatedTarget||r.fromElement)&&(Po(x)||x[Xi]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Po(x):null,x!==null&&(v=xl(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(g=C2,I="onMouseLeave",_="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=N2,I="onPointerLeave",_="onPointerEnter",w="pointer"),v=p==null?m:Jl(p),y=x==null?m:Jl(x),m=new g(I,w+"leave",p,r,u),m.target=v,m.relatedTarget=y,I=null,Po(u)===c&&(g=new g(_,w+"enter",x,r,u),g.target=y,g.relatedTarget=v,I=g),v=I,p&&x)t:{for(g=p,_=x,w=0,y=g;y;y=Ml(y))w++;for(y=0,I=_;I;I=Ml(I))y++;for(;0<w-y;)g=Ml(g),w--;for(;0<y-w;)_=Ml(_),y--;for(;w--;){if(g===_||_!==null&&g===_.alternate)break t;g=Ml(g),_=Ml(_)}g=null}else g=null;p!==null&&U2(h,m,p,g,!1),x!==null&&v!==null&&U2(h,v,x,g,!0)}}e:{if(m=c?Jl(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var O=B6;else if(D2(m))if(Pb)O=H6;else{O=$6;var P=U6}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=z6);if(O&&(O=O(t,c))){Rb(h,O,r,u);break e}P&&P(t,m,c),t==="focusout"&&(P=m._wrapperState)&&P.controlled&&m.type==="number"&&Ax(m,"number",m.value)}switch(P=c?Jl(c):window,t){case"focusin":(D2(P)||P.contentEditable==="true")&&(Yl=P,Mx=c,sf=null);break;case"focusout":sf=Mx=Yl=null;break;case"mousedown":jx=!0;break;case"contextmenu":case"mouseup":case"dragend":jx=!1,j2(h,r,u);break;case"selectionchange":if(q6)break;case"keydown":case"keyup":j2(h,r,u)}var S;if(Uy)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Xl?Ib(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Cb&&r.locale!=="ko"&&(Xl||E!=="onCompositionStart"?E==="onCompositionEnd"&&Xl&&(S=bb()):(Ia=u,jy="value"in Ia?Ia.value:Ia.textContent,Xl=!0)),P=U0(c,E),0<P.length&&(E=new I2(E,t,null,r,u),h.push({event:E,listeners:P}),S?E.data=S:(S=Nb(r),S!==null&&(E.data=S)))),(S=O6?L6(t,r):M6(t,r))&&(c=U0(c,"onBeforeInput"),0<c.length&&(u=new I2("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=S))}$b(h,e)})}function $f(t,e,r){return{instance:t,listener:e,currentTarget:r}}function U0(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Of(t,r),i!=null&&n.unshift($f(t,i,s)),i=Of(t,e),i!=null&&n.push($f(t,i,s))),t=t.return}return n}function Ml(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function U2(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Of(r,i),l!=null&&a.unshift($f(r,l,o))):s||(l=Of(r,i),l!=null&&a.push($f(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var Q6=/\r\n?/g,J6=/\u0000|\uFFFD/g;function $2(t){return(typeof t=="string"?t:""+t).replace(Q6,`
`).replace(J6,"")}function Rd(t,e,r){if(e=$2(e),$2(t)!==e&&r)throw Error(Te(425))}function $0(){}var Vx=null,Bx=null;function Ux(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $x=typeof setTimeout=="function"?setTimeout:void 0,Z6=typeof clearTimeout=="function"?clearTimeout:void 0,z2=typeof Promise=="function"?Promise:void 0,eO=typeof queueMicrotask=="function"?queueMicrotask:typeof z2<"u"?function(t){return z2.resolve(null).then(t).catch(tO)}:$x;function tO(t){setTimeout(function(){throw t})}function mg(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),jf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);jf(e)}function Ma(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function H2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ru=Math.random().toString(36).slice(2),ci="__reactFiber$"+ru,zf="__reactProps$"+ru,Xi="__reactContainer$"+ru,zx="__reactEvents$"+ru,rO="__reactListeners$"+ru,nO="__reactHandles$"+ru;function Po(t){var e=t[ci];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xi]||r[ci]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=H2(t);t!==null;){if(r=t[ci])return r;t=H2(t)}return e}t=r,r=t.parentNode}return null}function Fh(t){return t=t[ci]||t[Xi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Te(33))}function Km(t){return t[zf]||null}var Hx=[],Zl=-1;function uo(t){return{current:t}}function Ft(t){0>Zl||(t.current=Hx[Zl],Hx[Zl]=null,Zl--)}function bt(t,e){Zl++,Hx[Zl]=t.current,t.current=e}var qa={},mn=uo(qa),jn=uo(!1),Qo=qa;function Pc(t,e){var r=t.type.contextTypes;if(!r)return qa;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Vn(t){return t=t.childContextTypes,t!=null}function z0(){Ft(jn),Ft(mn)}function W2(t,e,r){if(mn.current!==qa)throw Error(Te(168));bt(mn,e),bt(jn,r)}function Hb(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Te(108,UF(t)||"Unknown",s));return Gt({},r,n)}function H0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qa,Qo=mn.current,bt(mn,t),bt(jn,jn.current),!0}function G2(t,e,r){var n=t.stateNode;if(!n)throw Error(Te(169));r?(t=Hb(t,e,Qo),n.__reactInternalMemoizedMergedChildContext=t,Ft(jn),Ft(mn),bt(mn,t)):Ft(jn),bt(jn,r)}var Oi=null,Xm=!1,pg=!1;function Wb(t){Oi===null?Oi=[t]:Oi.push(t)}function sO(t){Xm=!0,Wb(t)}function fo(){if(!pg&&Oi!==null){pg=!0;var t=0,e=_t;try{var r=Oi;for(_t=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Oi=null,Xm=!1}catch(s){throw Oi!==null&&(Oi=Oi.slice(t+1)),gb(Fy,fo),s}finally{_t=e,pg=!1}}return null}var ec=[],tc=0,W0=null,G0=0,ms=[],ps=0,Jo=null,Mi=1,ji="";function bo(t,e){ec[tc++]=G0,ec[tc++]=W0,W0=t,G0=e}function Gb(t,e,r){ms[ps++]=Mi,ms[ps++]=ji,ms[ps++]=Jo,Jo=t;var n=Mi;t=ji;var s=32-Ws(n)-1;n&=~(1<<s),r+=1;var i=32-Ws(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Mi=1<<32-Ws(e)+s|r<<s|n,ji=i+t}else Mi=1<<i|r<<s|n,ji=t}function zy(t){t.return!==null&&(bo(t,1),Gb(t,1,0))}function Hy(t){for(;t===W0;)W0=ec[--tc],ec[tc]=null,G0=ec[--tc],ec[tc]=null;for(;t===Jo;)Jo=ms[--ps],ms[ps]=null,ji=ms[--ps],ms[ps]=null,Mi=ms[--ps],ms[ps]=null}var es=null,Jn=null,jt=!1,Us=null;function qb(t,e){var r=ws(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function q2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,es=t,Jn=Ma(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,es=t,Jn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Jo!==null?{id:Mi,overflow:ji}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ws(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,es=t,Jn=null,!0):!1;default:return!1}}function Wx(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gx(t){if(jt){var e=Jn;if(e){var r=e;if(!q2(t,e)){if(Wx(t))throw Error(Te(418));e=Ma(r.nextSibling);var n=es;e&&q2(t,e)?qb(n,r):(t.flags=t.flags&-4097|2,jt=!1,es=t)}}else{if(Wx(t))throw Error(Te(418));t.flags=t.flags&-4097|2,jt=!1,es=t}}}function K2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;es=t}function Pd(t){if(t!==es)return!1;if(!jt)return K2(t),jt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ux(t.type,t.memoizedProps)),e&&(e=Jn)){if(Wx(t))throw Kb(),Error(Te(418));for(;e;)qb(t,e),e=Ma(e.nextSibling)}if(K2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Jn=Ma(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Jn=null}}else Jn=es?Ma(t.stateNode.nextSibling):null;return!0}function Kb(){for(var t=Jn;t;)t=Ma(t.nextSibling)}function Dc(){Jn=es=null,jt=!1}function Wy(t){Us===null?Us=[t]:Us.push(t)}var iO=ia.ReactCurrentBatchConfig;function Fu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,t))}return t}function Dd(t,e){throw t=Object.prototype.toString.call(e),Error(Te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function X2(t){var e=t._init;return e(t._payload)}function Xb(t){function e(_,w){if(t){var y=_.deletions;y===null?(_.deletions=[w],_.flags|=16):y.push(w)}}function r(_,w){if(!t)return null;for(;w!==null;)e(_,w),w=w.sibling;return null}function n(_,w){for(_=new Map;w!==null;)w.key!==null?_.set(w.key,w):_.set(w.index,w),w=w.sibling;return _}function s(_,w){return _=Ua(_,w),_.index=0,_.sibling=null,_}function i(_,w,y){return _.index=y,t?(y=_.alternate,y!==null?(y=y.index,y<w?(_.flags|=2,w):y):(_.flags|=2,w)):(_.flags|=1048576,w)}function a(_){return t&&_.alternate===null&&(_.flags|=2),_}function o(_,w,y,I){return w===null||w.tag!==6?(w=Eg(y,_.mode,I),w.return=_,w):(w=s(w,y),w.return=_,w)}function l(_,w,y,I){var O=y.type;return O===Kl?u(_,w,y.props.children,I,y.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===_a&&X2(O)===w.type)?(I=s(w,y.props),I.ref=Fu(_,w,y),I.return=_,I):(I=x0(y.type,y.key,y.props,null,_.mode,I),I.ref=Fu(_,w,y),I.return=_,I)}function c(_,w,y,I){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=Tg(y,_.mode,I),w.return=_,w):(w=s(w,y.children||[]),w.return=_,w)}function u(_,w,y,I,O){return w===null||w.tag!==7?(w=$o(y,_.mode,I,O),w.return=_,w):(w=s(w,y),w.return=_,w)}function h(_,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Eg(""+w,_.mode,y),w.return=_,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ed:return y=x0(w.type,w.key,w.props,null,_.mode,y),y.ref=Fu(_,null,w),y.return=_,y;case ql:return w=Tg(w,_.mode,y),w.return=_,w;case _a:var I=w._init;return h(_,I(w._payload),y)}if(Uu(w)||Iu(w))return w=$o(w,_.mode,y,null),w.return=_,w;Dd(_,w)}return null}function m(_,w,y,I){var O=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return O!==null?null:o(_,w,""+y,I);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ed:return y.key===O?l(_,w,y,I):null;case ql:return y.key===O?c(_,w,y,I):null;case _a:return O=y._init,m(_,w,O(y._payload),I)}if(Uu(y)||Iu(y))return O!==null?null:u(_,w,y,I,null);Dd(_,y)}return null}function p(_,w,y,I,O){if(typeof I=="string"&&I!==""||typeof I=="number")return _=_.get(y)||null,o(w,_,""+I,O);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ed:return _=_.get(I.key===null?y:I.key)||null,l(w,_,I,O);case ql:return _=_.get(I.key===null?y:I.key)||null,c(w,_,I,O);case _a:var P=I._init;return p(_,w,y,P(I._payload),O)}if(Uu(I)||Iu(I))return _=_.get(y)||null,u(w,_,I,O,null);Dd(w,I)}return null}function x(_,w,y,I){for(var O=null,P=null,S=w,E=w=0,A=null;S!==null&&E<y.length;E++){S.index>E?(A=S,S=null):A=S.sibling;var N=m(_,S,y[E],I);if(N===null){S===null&&(S=A);break}t&&S&&N.alternate===null&&e(_,S),w=i(N,w,E),P===null?O=N:P.sibling=N,P=N,S=A}if(E===y.length)return r(_,S),jt&&bo(_,E),O;if(S===null){for(;E<y.length;E++)S=h(_,y[E],I),S!==null&&(w=i(S,w,E),P===null?O=S:P.sibling=S,P=S);return jt&&bo(_,E),O}for(S=n(_,S);E<y.length;E++)A=p(S,_,E,y[E],I),A!==null&&(t&&A.alternate!==null&&S.delete(A.key===null?E:A.key),w=i(A,w,E),P===null?O=A:P.sibling=A,P=A);return t&&S.forEach(function(C){return e(_,C)}),jt&&bo(_,E),O}function g(_,w,y,I){var O=Iu(y);if(typeof O!="function")throw Error(Te(150));if(y=O.call(y),y==null)throw Error(Te(151));for(var P=O=null,S=w,E=w=0,A=null,N=y.next();S!==null&&!N.done;E++,N=y.next()){S.index>E?(A=S,S=null):A=S.sibling;var C=m(_,S,N.value,I);if(C===null){S===null&&(S=A);break}t&&S&&C.alternate===null&&e(_,S),w=i(C,w,E),P===null?O=C:P.sibling=C,P=C,S=A}if(N.done)return r(_,S),jt&&bo(_,E),O;if(S===null){for(;!N.done;E++,N=y.next())N=h(_,N.value,I),N!==null&&(w=i(N,w,E),P===null?O=N:P.sibling=N,P=N);return jt&&bo(_,E),O}for(S=n(_,S);!N.done;E++,N=y.next())N=p(S,_,E,N.value,I),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?E:N.key),w=i(N,w,E),P===null?O=N:P.sibling=N,P=N);return t&&S.forEach(function(R){return e(_,R)}),jt&&bo(_,E),O}function v(_,w,y,I){if(typeof y=="object"&&y!==null&&y.type===Kl&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ed:e:{for(var O=y.key,P=w;P!==null;){if(P.key===O){if(O=y.type,O===Kl){if(P.tag===7){r(_,P.sibling),w=s(P,y.props.children),w.return=_,_=w;break e}}else if(P.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===_a&&X2(O)===P.type){r(_,P.sibling),w=s(P,y.props),w.ref=Fu(_,P,y),w.return=_,_=w;break e}r(_,P);break}else e(_,P);P=P.sibling}y.type===Kl?(w=$o(y.props.children,_.mode,I,y.key),w.return=_,_=w):(I=x0(y.type,y.key,y.props,null,_.mode,I),I.ref=Fu(_,w,y),I.return=_,_=I)}return a(_);case ql:e:{for(P=y.key;w!==null;){if(w.key===P)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(_,w.sibling),w=s(w,y.children||[]),w.return=_,_=w;break e}else{r(_,w);break}else e(_,w);w=w.sibling}w=Tg(y,_.mode,I),w.return=_,_=w}return a(_);case _a:return P=y._init,v(_,w,P(y._payload),I)}if(Uu(y))return x(_,w,y,I);if(Iu(y))return g(_,w,y,I);Dd(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(_,w.sibling),w=s(w,y),w.return=_,_=w):(r(_,w),w=Eg(y,_.mode,I),w.return=_,_=w),a(_)):r(_,w)}return v}var Fc=Xb(!0),Yb=Xb(!1),q0=uo(null),K0=null,rc=null,Gy=null;function qy(){Gy=rc=K0=null}function Ky(t){var e=q0.current;Ft(q0),t._currentValue=e}function qx(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function xc(t,e){K0=t,Gy=rc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ln=!0),t.firstContext=null)}function ks(t){var e=t._currentValue;if(Gy!==t)if(t={context:t,memoizedValue:e,next:null},rc===null){if(K0===null)throw Error(Te(308));rc=t,K0.dependencies={lanes:0,firstContext:t}}else rc=rc.next=t;return e}var Do=null;function Xy(t){Do===null?Do=[t]:Do.push(t)}function Qb(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Xy(e)):(r.next=s.next,s.next=r),e.interleaved=r,Yi(t,n)}function Yi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ea=!1;function Yy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $i(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ja(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ut&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Yi(t,r)}return s=n.interleaved,s===null?(e.next=e,Xy(n)):(e.next=s.next,s.next=e),n.interleaved=e,Yi(t,r)}function f0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Oy(t,r)}}function Y2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function X0(t,e,r,n){var s=t.updateQueue;Ea=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;a=0,u=c=l=null,o=i;do{var m=o.lane,p=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,g=o;switch(m=e,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(p,h,m);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,h,m):x,m==null)break e;h=Gt({},h,m);break e;case 2:Ea=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);el|=a,t.lanes=a,t.memoizedState=h}}function Q2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Te(191,s));s.call(n)}}}var Oh={},di=uo(Oh),Hf=uo(Oh),Wf=uo(Oh);function Fo(t){if(t===Oh)throw Error(Te(174));return t}function Qy(t,e){switch(bt(Wf,e),bt(Hf,t),bt(di,Oh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bx(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bx(e,t)}Ft(di),bt(di,e)}function Oc(){Ft(di),Ft(Hf),Ft(Wf)}function Zb(t){Fo(Wf.current);var e=Fo(di.current),r=bx(e,t.type);e!==r&&(bt(Hf,t),bt(di,r))}function Jy(t){Hf.current===t&&(Ft(di),Ft(Hf))}var Ut=uo(0);function Y0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gg=[];function Zy(){for(var t=0;t<gg.length;t++)gg[t]._workInProgressVersionPrimary=null;gg.length=0}var h0=ia.ReactCurrentDispatcher,xg=ia.ReactCurrentBatchConfig,Zo=0,Wt=null,Er=null,Pr=null,Q0=!1,af=!1,Gf=0,aO=0;function en(){throw Error(Te(321))}function ev(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Xs(t[r],e[r]))return!1;return!0}function tv(t,e,r,n,s,i){if(Zo=i,Wt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,h0.current=t===null||t.memoizedState===null?uO:fO,t=r(n,s),af){i=0;do{if(af=!1,Gf=0,25<=i)throw Error(Te(301));i+=1,Pr=Er=null,e.updateQueue=null,h0.current=hO,t=r(n,s)}while(af)}if(h0.current=J0,e=Er!==null&&Er.next!==null,Zo=0,Pr=Er=Wt=null,Q0=!1,e)throw Error(Te(300));return t}function rv(){var t=Gf!==0;return Gf=0,t}function oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?Wt.memoizedState=Pr=t:Pr=Pr.next=t,Pr}function bs(){if(Er===null){var t=Wt.alternate;t=t!==null?t.memoizedState:null}else t=Er.next;var e=Pr===null?Wt.memoizedState:Pr.next;if(e!==null)Pr=e,Er=t;else{if(t===null)throw Error(Te(310));Er=t,t={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Pr===null?Wt.memoizedState=Pr=t:Pr=Pr.next=t}return Pr}function qf(t,e){return typeof e=="function"?e(t):e}function yg(t){var e=bs(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=Er,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,c=i;do{var u=c.lane;if((Zo&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Wt.lanes|=u,el|=u}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,Xs(n,e.memoizedState)||(Ln=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Wt.lanes|=i,el|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function vg(t){var e=bs(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Xs(i,e.memoizedState)||(Ln=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function eC(){}function tC(t,e){var r=Wt,n=bs(),s=e(),i=!Xs(n.memoizedState,s);if(i&&(n.memoizedState=s,Ln=!0),n=n.queue,nv(sC.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Pr!==null&&Pr.memoizedState.tag&1){if(r.flags|=2048,Kf(9,nC.bind(null,r,n,s,e),void 0,null),Lr===null)throw Error(Te(349));Zo&30||rC(r,e,s)}return s}function rC(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Wt.updateQueue,e===null?(e={lastEffect:null,stores:null},Wt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function nC(t,e,r,n){e.value=r,e.getSnapshot=n,iC(e)&&aC(t)}function sC(t,e,r){return r(function(){iC(e)&&aC(t)})}function iC(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Xs(t,r)}catch{return!0}}function aC(t){var e=Yi(t,1);e!==null&&Gs(e,t,1,-1)}function J2(t){var e=oi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qf,lastRenderedState:t},e.queue=t,t=t.dispatch=cO.bind(null,Wt,t),[e.memoizedState,t]}function Kf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Wt.updateQueue,e===null?(e={lastEffect:null,stores:null},Wt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function oC(){return bs().memoizedState}function d0(t,e,r,n){var s=oi();Wt.flags|=t,s.memoizedState=Kf(1|e,r,void 0,n===void 0?null:n)}function Ym(t,e,r,n){var s=bs();n=n===void 0?null:n;var i=void 0;if(Er!==null){var a=Er.memoizedState;if(i=a.destroy,n!==null&&ev(n,a.deps)){s.memoizedState=Kf(e,r,i,n);return}}Wt.flags|=t,s.memoizedState=Kf(1|e,r,i,n)}function Z2(t,e){return d0(8390656,8,t,e)}function nv(t,e){return Ym(2048,8,t,e)}function lC(t,e){return Ym(4,2,t,e)}function cC(t,e){return Ym(4,4,t,e)}function uC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fC(t,e,r){return r=r!=null?r.concat([t]):null,Ym(4,4,uC.bind(null,e,t),r)}function sv(){}function hC(t,e){var r=bs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&ev(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function dC(t,e){var r=bs();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&ev(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function mC(t,e,r){return Zo&21?(Xs(r,e)||(r=vb(),Wt.lanes|=r,el|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ln=!0),t.memoizedState=r)}function oO(t,e){var r=_t;_t=r!==0&&4>r?r:4,t(!0);var n=xg.transition;xg.transition={};try{t(!1),e()}finally{_t=r,xg.transition=n}}function pC(){return bs().memoizedState}function lO(t,e,r){var n=Ba(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},gC(t))xC(e,r);else if(r=Qb(t,e,r,n),r!==null){var s=Tn();Gs(r,t,n,s),yC(r,e,n)}}function cO(t,e,r){var n=Ba(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(gC(t))xC(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,Xs(o,a)){var l=e.interleaved;l===null?(s.next=s,Xy(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=Qb(t,e,s,n),r!==null&&(s=Tn(),Gs(r,t,n,s),yC(r,e,n))}}function gC(t){var e=t.alternate;return t===Wt||e!==null&&e===Wt}function xC(t,e){af=Q0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function yC(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Oy(t,r)}}var J0={readContext:ks,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},uO={readContext:ks,useCallback:function(t,e){return oi().memoizedState=[t,e===void 0?null:e],t},useContext:ks,useEffect:Z2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,d0(4194308,4,uC.bind(null,e,t),r)},useLayoutEffect:function(t,e){return d0(4194308,4,t,e)},useInsertionEffect:function(t,e){return d0(4,2,t,e)},useMemo:function(t,e){var r=oi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=oi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=lO.bind(null,Wt,t),[n.memoizedState,t]},useRef:function(t){var e=oi();return t={current:t},e.memoizedState=t},useState:J2,useDebugValue:sv,useDeferredValue:function(t){return oi().memoizedState=t},useTransition:function(){var t=J2(!1),e=t[0];return t=oO.bind(null,t[1]),oi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Wt,s=oi();if(jt){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=e(),Lr===null)throw Error(Te(349));Zo&30||rC(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Z2(sC.bind(null,n,i,t),[t]),n.flags|=2048,Kf(9,nC.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=oi(),e=Lr.identifierPrefix;if(jt){var r=ji,n=Mi;r=(n&~(1<<32-Ws(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Gf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=aO++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fO={readContext:ks,useCallback:hC,useContext:ks,useEffect:nv,useImperativeHandle:fC,useInsertionEffect:lC,useLayoutEffect:cC,useMemo:dC,useReducer:yg,useRef:oC,useState:function(){return yg(qf)},useDebugValue:sv,useDeferredValue:function(t){var e=bs();return mC(e,Er.memoizedState,t)},useTransition:function(){var t=yg(qf)[0],e=bs().memoizedState;return[t,e]},useMutableSource:eC,useSyncExternalStore:tC,useId:pC,unstable_isNewReconciler:!1},hO={readContext:ks,useCallback:hC,useContext:ks,useEffect:nv,useImperativeHandle:fC,useInsertionEffect:lC,useLayoutEffect:cC,useMemo:dC,useReducer:vg,useRef:oC,useState:function(){return vg(qf)},useDebugValue:sv,useDeferredValue:function(t){var e=bs();return Er===null?e.memoizedState=t:mC(e,Er.memoizedState,t)},useTransition:function(){var t=vg(qf)[0],e=bs().memoizedState;return[t,e]},useMutableSource:eC,useSyncExternalStore:tC,useId:pC,unstable_isNewReconciler:!1};function Vs(t,e){if(t&&t.defaultProps){e=Gt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Kx(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Gt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Qm={isMounted:function(t){return(t=t._reactInternals)?xl(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Tn(),s=Ba(t),i=$i(n,s);i.payload=e,r!=null&&(i.callback=r),e=ja(t,i,s),e!==null&&(Gs(e,t,s,n),f0(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Tn(),s=Ba(t),i=$i(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=ja(t,i,s),e!==null&&(Gs(e,t,s,n),f0(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Tn(),n=Ba(t),s=$i(r,n);s.tag=2,e!=null&&(s.callback=e),e=ja(t,s,n),e!==null&&(Gs(e,t,n,r),f0(e,t,n))}};function eE(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!Bf(r,n)||!Bf(s,i):!0}function vC(t,e,r){var n=!1,s=qa,i=e.contextType;return typeof i=="object"&&i!==null?i=ks(i):(s=Vn(e)?Qo:mn.current,n=e.contextTypes,i=(n=n!=null)?Pc(t,s):qa),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qm,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function tE(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Qm.enqueueReplaceState(e,e.state,null)}function Xx(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Yy(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ks(i):(i=Vn(e)?Qo:mn.current,s.context=Pc(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Kx(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qm.enqueueReplaceState(s,s.state,null),X0(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Lc(t,e){try{var r="",n=e;do r+=BF(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function wg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Yx(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var dO=typeof WeakMap=="function"?WeakMap:Map;function wC(t,e,r){r=$i(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){em||(em=!0,a1=n),Yx(t,e)},r}function _C(t,e,r){r=$i(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Yx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Yx(t,e),typeof n!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function rE(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new dO;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=bO.bind(null,t,e,r),e.then(t,t))}function nE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sE(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=$i(-1,1),e.tag=2,ja(r,e,1))),r.lanes|=1),t)}var mO=ia.ReactCurrentOwner,Ln=!1;function vn(t,e,r,n){e.child=t===null?Yb(e,null,r,n):Fc(e,t.child,r,n)}function iE(t,e,r,n,s){r=r.render;var i=e.ref;return xc(e,s),n=tv(t,e,r,n,i,s),r=rv(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qi(t,e,s)):(jt&&r&&zy(e),e.flags|=1,vn(t,e,n,s),e.child)}function aE(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!hv(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,EC(t,e,i,n,s)):(t=x0(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bf,r(a,n)&&t.ref===e.ref)return Qi(t,e,s)}return e.flags|=1,t=Ua(i,n),t.ref=e.ref,t.return=e,e.child=t}function EC(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Bf(i,n)&&t.ref===e.ref)if(Ln=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Ln=!0);else return e.lanes=t.lanes,Qi(t,e,s)}return Qx(t,e,r,n,s)}function TC(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(sc,qn),qn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bt(sc,qn),qn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,bt(sc,qn),qn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,bt(sc,qn),qn|=n;return vn(t,e,s,r),e.child}function SC(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Qx(t,e,r,n,s){var i=Vn(r)?Qo:mn.current;return i=Pc(e,i),xc(e,s),r=tv(t,e,r,n,i,s),n=rv(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qi(t,e,s)):(jt&&n&&zy(e),e.flags|=1,vn(t,e,r,s),e.child)}function oE(t,e,r,n,s){if(Vn(r)){var i=!0;H0(e)}else i=!1;if(xc(e,s),e.stateNode===null)m0(t,e),vC(e,r,n),Xx(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=ks(c):(c=Vn(r)?Qo:mn.current,c=Pc(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&tE(e,a,n,c),Ea=!1;var m=e.memoizedState;a.state=m,X0(e,n,a,s),l=e.memoizedState,o!==n||m!==l||jn.current||Ea?(typeof u=="function"&&(Kx(e,r,u,n),l=e.memoizedState),(o=Ea||eE(e,r,o,n,m,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Jb(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Vs(e.type,o),a.props=c,h=e.pendingProps,m=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=ks(l):(l=Vn(r)?Qo:mn.current,l=Pc(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||m!==l)&&tE(e,a,n,l),Ea=!1,m=e.memoizedState,a.state=m,X0(e,n,a,s);var x=e.memoizedState;o!==h||m!==x||jn.current||Ea?(typeof p=="function"&&(Kx(e,r,p,n),x=e.memoizedState),(c=Ea||eE(e,r,c,n,m,x,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return Jx(t,e,r,n,i,s)}function Jx(t,e,r,n,s,i){SC(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&G2(e,r,!1),Qi(t,e,i);n=e.stateNode,mO.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Fc(e,t.child,null,i),e.child=Fc(e,null,o,i)):vn(t,e,o,i),e.memoizedState=n.state,s&&G2(e,r,!0),e.child}function AC(t){var e=t.stateNode;e.pendingContext?W2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&W2(t,e.context,!1),Qy(t,e.containerInfo)}function lE(t,e,r,n,s){return Dc(),Wy(s),e.flags|=256,vn(t,e,r,n),e.child}var Zx={dehydrated:null,treeContext:null,retryLane:0};function e1(t){return{baseLanes:t,cachePool:null,transitions:null}}function kC(t,e,r){var n=e.pendingProps,s=Ut.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),bt(Ut,s&1),t===null)return Gx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=ep(a,n,0,null),t=$o(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=e1(r),e.memoizedState=Zx,t):iv(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return pO(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ua(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Ua(o,i):(i=$o(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?e1(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Zx,n}return i=t.child,t=i.sibling,n=Ua(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function iv(t,e){return e=ep({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fd(t,e,r,n){return n!==null&&Wy(n),Fc(e,t.child,null,r),t=iv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pO(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=wg(Error(Te(422))),Fd(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=ep({mode:"visible",children:n.children},s,0,null),i=$o(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Fc(e,t.child,null,a),e.child.memoizedState=e1(a),e.memoizedState=Zx,i);if(!(e.mode&1))return Fd(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Te(419)),n=wg(i,n,void 0),Fd(t,e,a,n)}if(o=(a&t.childLanes)!==0,Ln||o){if(n=Lr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Yi(t,s),Gs(n,t,s,-1))}return fv(),n=wg(Error(Te(421))),Fd(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=CO.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Jn=Ma(s.nextSibling),es=e,jt=!0,Us=null,t!==null&&(ms[ps++]=Mi,ms[ps++]=ji,ms[ps++]=Jo,Mi=t.id,ji=t.overflow,Jo=e),e=iv(e,n.children),e.flags|=4096,e)}function cE(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),qx(t.return,e,r)}function _g(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function bC(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(vn(t,e,n.children,r),n=Ut.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cE(t,r,e);else if(t.tag===19)cE(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(bt(Ut,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Y0(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),_g(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Y0(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}_g(e,!0,r,null,i);break;case"together":_g(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function m0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),el|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Te(153));if(e.child!==null){for(t=e.child,r=Ua(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ua(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function gO(t,e,r){switch(e.tag){case 3:AC(e),Dc();break;case 5:Zb(e);break;case 1:Vn(e.type)&&H0(e);break;case 4:Qy(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;bt(q0,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(bt(Ut,Ut.current&1),e.flags|=128,null):r&e.child.childLanes?kC(t,e,r):(bt(Ut,Ut.current&1),t=Qi(t,e,r),t!==null?t.sibling:null);bt(Ut,Ut.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return bC(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),bt(Ut,Ut.current),n)break;return null;case 22:case 23:return e.lanes=0,TC(t,e,r)}return Qi(t,e,r)}var CC,t1,IC,NC;CC=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};t1=function(){};IC=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Fo(di.current);var i=null;switch(r){case"input":s=Tx(t,s),n=Tx(t,n),i=[];break;case"select":s=Gt({},s,{value:void 0}),n=Gt({},n,{value:void 0}),i=[];break;case"textarea":s=kx(t,s),n=kx(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=$0)}Cx(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Df.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Df.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nt("scroll",t),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};NC=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ou(t,e){if(!jt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function xO(t,e,r){var n=e.pendingProps;switch(Hy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return Vn(e.type)&&z0(),tn(e),null;case 3:return n=e.stateNode,Oc(),Ft(jn),Ft(mn),Zy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Pd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Us!==null&&(c1(Us),Us=null))),t1(t,e),tn(e),null;case 5:Jy(e);var s=Fo(Wf.current);if(r=e.type,t!==null&&e.stateNode!=null)IC(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Te(166));return tn(e),null}if(t=Fo(di.current),Pd(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[ci]=e,n[zf]=i,t=(e.mode&1)!==0,r){case"dialog":Nt("cancel",n),Nt("close",n);break;case"iframe":case"object":case"embed":Nt("load",n);break;case"video":case"audio":for(s=0;s<zu.length;s++)Nt(zu[s],n);break;case"source":Nt("error",n);break;case"img":case"image":case"link":Nt("error",n),Nt("load",n);break;case"details":Nt("toggle",n);break;case"input":y2(n,i),Nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Nt("invalid",n);break;case"textarea":w2(n,i),Nt("invalid",n)}Cx(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Rd(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Rd(n.textContent,o,t),s=["children",""+o]):Df.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Nt("scroll",n)}switch(r){case"input":Td(n),v2(n,i,!0);break;case"textarea":Td(n),_2(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=$0)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=sb(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ci]=e,t[zf]=n,CC(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ix(r,n),r){case"dialog":Nt("cancel",t),Nt("close",t),s=n;break;case"iframe":case"object":case"embed":Nt("load",t),s=n;break;case"video":case"audio":for(s=0;s<zu.length;s++)Nt(zu[s],t);s=n;break;case"source":Nt("error",t),s=n;break;case"img":case"image":case"link":Nt("error",t),Nt("load",t),s=n;break;case"details":Nt("toggle",t),s=n;break;case"input":y2(t,n),s=Tx(t,n),Nt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Gt({},n,{value:void 0}),Nt("invalid",t);break;case"textarea":w2(t,n),s=kx(t,n),Nt("invalid",t);break;default:s=n}Cx(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?ob(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ib(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ff(t,l):typeof l=="number"&&Ff(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Df.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Nt("scroll",t):l!=null&&Iy(t,i,l,a))}switch(r){case"input":Td(t),v2(t,n,!1);break;case"textarea":Td(t),_2(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ga(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?dc(t,!!n.multiple,i,!1):n.defaultValue!=null&&dc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)NC(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Te(166));if(r=Fo(Wf.current),Fo(di.current),Pd(e)){if(n=e.stateNode,r=e.memoizedProps,n[ci]=e,(i=n.nodeValue!==r)&&(t=es,t!==null))switch(t.tag){case 3:Rd(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Rd(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ci]=e,e.stateNode=n}return tn(e),null;case 13:if(Ft(Ut),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(jt&&Jn!==null&&e.mode&1&&!(e.flags&128))Kb(),Dc(),e.flags|=98560,i=!1;else if(i=Pd(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[ci]=e}else Dc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),i=!1}else Us!==null&&(c1(Us),Us=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ut.current&1?Sr===0&&(Sr=3):fv())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return Oc(),t1(t,e),t===null&&Uf(e.stateNode.containerInfo),tn(e),null;case 10:return Ky(e.type._context),tn(e),null;case 17:return Vn(e.type)&&z0(),tn(e),null;case 19:if(Ft(Ut),i=e.memoizedState,i===null)return tn(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Ou(i,!1);else{if(Sr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Y0(t),a!==null){for(e.flags|=128,Ou(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return bt(Ut,Ut.current&1|2),e.child}t=t.sibling}i.tail!==null&&ir()>Mc&&(e.flags|=128,n=!0,Ou(i,!1),e.lanes=4194304)}else{if(!n)if(t=Y0(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ou(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!jt)return tn(e),null}else 2*ir()-i.renderingStartTime>Mc&&r!==1073741824&&(e.flags|=128,n=!0,Ou(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ir(),e.sibling=null,r=Ut.current,bt(Ut,n?r&1|2:r&1),e):(tn(e),null);case 22:case 23:return uv(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?qn&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(Te(156,e.tag))}function yO(t,e){switch(Hy(e),e.tag){case 1:return Vn(e.type)&&z0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oc(),Ft(jn),Ft(mn),Zy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Jy(e),null;case 13:if(Ft(Ut),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Te(340));Dc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ft(Ut),null;case 4:return Oc(),null;case 10:return Ky(e.type._context),null;case 22:case 23:return uv(),null;case 24:return null;default:return null}}var Od=!1,ln=!1,vO=typeof WeakSet=="function"?WeakSet:Set,Re=null;function nc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Jt(t,e,n)}else r.current=null}function r1(t,e,r){try{r()}catch(n){Jt(t,e,n)}}var uE=!1;function wO(t,e){if(Vx=V0,t=Ob(),$y(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=t,m=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===r&&++c===s&&(o=a),m===i&&++u===n&&(l=a),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Bx={focusedElem:t,selectionRange:r},V0=!1,Re=e;Re!==null;)if(e=Re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Re=t;else for(;Re!==null;){e=Re;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,v=x.memoizedState,_=e.stateNode,w=_.getSnapshotBeforeUpdate(e.elementType===e.type?g:Vs(e.type,g),v);_.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(I){Jt(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,Re=t;break}Re=e.return}return x=uE,uE=!1,x}function of(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&r1(e,r,i)}s=s.next}while(s!==n)}}function Jm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function n1(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function RC(t){var e=t.alternate;e!==null&&(t.alternate=null,RC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ci],delete e[zf],delete e[zx],delete e[rO],delete e[nO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function PC(t){return t.tag===5||t.tag===3||t.tag===4}function fE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||PC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function s1(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=$0));else if(n!==4&&(t=t.child,t!==null))for(s1(t,e,r),t=t.sibling;t!==null;)s1(t,e,r),t=t.sibling}function i1(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(i1(t,e,r),t=t.sibling;t!==null;)i1(t,e,r),t=t.sibling}var Ur=null,Bs=!1;function xa(t,e,r){for(r=r.child;r!==null;)DC(t,e,r),r=r.sibling}function DC(t,e,r){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(Hm,r)}catch{}switch(r.tag){case 5:ln||nc(r,e);case 6:var n=Ur,s=Bs;Ur=null,xa(t,e,r),Ur=n,Bs=s,Ur!==null&&(Bs?(t=Ur,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Ur.removeChild(r.stateNode));break;case 18:Ur!==null&&(Bs?(t=Ur,r=r.stateNode,t.nodeType===8?mg(t.parentNode,r):t.nodeType===1&&mg(t,r),jf(t)):mg(Ur,r.stateNode));break;case 4:n=Ur,s=Bs,Ur=r.stateNode.containerInfo,Bs=!0,xa(t,e,r),Ur=n,Bs=s;break;case 0:case 11:case 14:case 15:if(!ln&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&r1(r,e,a),s=s.next}while(s!==n)}xa(t,e,r);break;case 1:if(!ln&&(nc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Jt(r,e,o)}xa(t,e,r);break;case 21:xa(t,e,r);break;case 22:r.mode&1?(ln=(n=ln)||r.memoizedState!==null,xa(t,e,r),ln=n):xa(t,e,r);break;default:xa(t,e,r)}}function hE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new vO),e.forEach(function(n){var s=IO.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Os(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Ur=o.stateNode,Bs=!1;break e;case 3:Ur=o.stateNode.containerInfo,Bs=!0;break e;case 4:Ur=o.stateNode.containerInfo,Bs=!0;break e}o=o.return}if(Ur===null)throw Error(Te(160));DC(i,a,s),Ur=null,Bs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Jt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)FC(e,t),e=e.sibling}function FC(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Os(e,t),ni(t),n&4){try{of(3,t,t.return),Jm(3,t)}catch(g){Jt(t,t.return,g)}try{of(5,t,t.return)}catch(g){Jt(t,t.return,g)}}break;case 1:Os(e,t),ni(t),n&512&&r!==null&&nc(r,r.return);break;case 5:if(Os(e,t),ni(t),n&512&&r!==null&&nc(r,r.return),t.flags&32){var s=t.stateNode;try{Ff(s,"")}catch(g){Jt(t,t.return,g)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&rb(s,i),Ix(o,a);var c=Ix(o,i);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?ob(s,h):u==="dangerouslySetInnerHTML"?ib(s,h):u==="children"?Ff(s,h):Iy(s,u,h,c)}switch(o){case"input":Sx(s,i);break;case"textarea":nb(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?dc(s,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?dc(s,!!i.multiple,i.defaultValue,!0):dc(s,!!i.multiple,i.multiple?[]:"",!1))}s[zf]=i}catch(g){Jt(t,t.return,g)}}break;case 6:if(Os(e,t),ni(t),n&4){if(t.stateNode===null)throw Error(Te(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){Jt(t,t.return,g)}}break;case 3:if(Os(e,t),ni(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jf(e.containerInfo)}catch(g){Jt(t,t.return,g)}break;case 4:Os(e,t),ni(t);break;case 13:Os(e,t),ni(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lv=ir())),n&4&&hE(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(ln=(c=ln)||u,Os(e,t),ln=c):Os(e,t),ni(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Re=t,u=t.child;u!==null;){for(h=Re=u;Re!==null;){switch(m=Re,p=m.child,m.tag){case 0:case 11:case 14:case 15:of(4,m,m.return);break;case 1:nc(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(g){Jt(n,r,g)}}break;case 5:nc(m,m.return);break;case 22:if(m.memoizedState!==null){mE(h);continue}}p!==null?(p.return=m,Re=p):mE(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ab("display",a))}catch(g){Jt(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Jt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Os(e,t),ni(t),n&4&&hE(t);break;case 21:break;default:Os(e,t),ni(t)}}function ni(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(PC(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ff(s,""),n.flags&=-33);var i=fE(t);i1(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=fE(t);s1(t,o,a);break;default:throw Error(Te(161))}}catch(l){Jt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _O(t,e,r){Re=t,OC(t)}function OC(t,e,r){for(var n=(t.mode&1)!==0;Re!==null;){var s=Re,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Od;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||ln;o=Od;var c=ln;if(Od=a,(ln=l)&&!c)for(Re=s;Re!==null;)a=Re,l=a.child,a.tag===22&&a.memoizedState!==null?pE(s):l!==null?(l.return=a,Re=l):pE(s);for(;i!==null;)Re=i,OC(i),i=i.sibling;Re=s,Od=o,ln=c}dE(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Re=i):dE(t)}}function dE(t){for(;Re!==null;){var e=Re;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ln||Jm(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ln)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Vs(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Q2(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Q2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&jf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}ln||e.flags&512&&n1(e)}catch(m){Jt(e,e.return,m)}}if(e===t){Re=null;break}if(r=e.sibling,r!==null){r.return=e.return,Re=r;break}Re=e.return}}function mE(t){for(;Re!==null;){var e=Re;if(e===t){Re=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Re=r;break}Re=e.return}}function pE(t){for(;Re!==null;){var e=Re;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Jm(4,e)}catch(l){Jt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Jt(e,s,l)}}var i=e.return;try{n1(e)}catch(l){Jt(e,i,l)}break;case 5:var a=e.return;try{n1(e)}catch(l){Jt(e,a,l)}}}catch(l){Jt(e,e.return,l)}if(e===t){Re=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Re=o;break}Re=e.return}}var EO=Math.ceil,Z0=ia.ReactCurrentDispatcher,av=ia.ReactCurrentOwner,Es=ia.ReactCurrentBatchConfig,ut=0,Lr=null,vr=null,Xr=0,qn=0,sc=uo(0),Sr=0,Xf=null,el=0,Zm=0,ov=0,lf=null,Fn=null,lv=0,Mc=1/0,Di=null,em=!1,a1=null,Va=null,Ld=!1,Na=null,tm=0,cf=0,o1=null,p0=-1,g0=0;function Tn(){return ut&6?ir():p0!==-1?p0:p0=ir()}function Ba(t){return t.mode&1?ut&2&&Xr!==0?Xr&-Xr:iO.transition!==null?(g0===0&&(g0=vb()),g0):(t=_t,t!==0||(t=window.event,t=t===void 0?16:kb(t.type)),t):1}function Gs(t,e,r,n){if(50<cf)throw cf=0,o1=null,Error(Te(185));Ph(t,r,n),(!(ut&2)||t!==Lr)&&(t===Lr&&(!(ut&2)&&(Zm|=r),Sr===4&&Sa(t,Xr)),Bn(t,n),r===1&&ut===0&&!(e.mode&1)&&(Mc=ir()+500,Xm&&fo()))}function Bn(t,e){var r=t.callbackNode;i6(t,e);var n=j0(t,t===Lr?Xr:0);if(n===0)r!==null&&S2(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&S2(r),e===1)t.tag===0?sO(gE.bind(null,t)):Wb(gE.bind(null,t)),eO(function(){!(ut&6)&&fo()}),r=null;else{switch(wb(n)){case 1:r=Fy;break;case 4:r=xb;break;case 16:r=M0;break;case 536870912:r=yb;break;default:r=M0}r=zC(r,LC.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function LC(t,e){if(p0=-1,g0=0,ut&6)throw Error(Te(327));var r=t.callbackNode;if(yc()&&t.callbackNode!==r)return null;var n=j0(t,t===Lr?Xr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=rm(t,n);else{e=n;var s=ut;ut|=2;var i=jC();(Lr!==t||Xr!==e)&&(Di=null,Mc=ir()+500,Uo(t,e));do try{AO();break}catch(o){MC(t,o)}while(!0);qy(),Z0.current=i,ut=s,vr!==null?e=0:(Lr=null,Xr=0,e=Sr)}if(e!==0){if(e===2&&(s=Fx(t),s!==0&&(n=s,e=l1(t,s))),e===1)throw r=Xf,Uo(t,0),Sa(t,n),Bn(t,ir()),r;if(e===6)Sa(t,n);else{if(s=t.current.alternate,!(n&30)&&!TO(s)&&(e=rm(t,n),e===2&&(i=Fx(t),i!==0&&(n=i,e=l1(t,i))),e===1))throw r=Xf,Uo(t,0),Sa(t,n),Bn(t,ir()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Te(345));case 2:Co(t,Fn,Di);break;case 3:if(Sa(t,n),(n&130023424)===n&&(e=lv+500-ir(),10<e)){if(j0(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Tn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=$x(Co.bind(null,t,Fn,Di),e);break}Co(t,Fn,Di);break;case 4:if(Sa(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-Ws(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=ir()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*EO(n/1960))-n,10<n){t.timeoutHandle=$x(Co.bind(null,t,Fn,Di),n);break}Co(t,Fn,Di);break;case 5:Co(t,Fn,Di);break;default:throw Error(Te(329))}}}return Bn(t,ir()),t.callbackNode===r?LC.bind(null,t):null}function l1(t,e){var r=lf;return t.current.memoizedState.isDehydrated&&(Uo(t,e).flags|=256),t=rm(t,e),t!==2&&(e=Fn,Fn=r,e!==null&&c1(e)),t}function c1(t){Fn===null?Fn=t:Fn.push.apply(Fn,t)}function TO(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Xs(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sa(t,e){for(e&=~ov,e&=~Zm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ws(e),n=1<<r;t[r]=-1,e&=~n}}function gE(t){if(ut&6)throw Error(Te(327));yc();var e=j0(t,0);if(!(e&1))return Bn(t,ir()),null;var r=rm(t,e);if(t.tag!==0&&r===2){var n=Fx(t);n!==0&&(e=n,r=l1(t,n))}if(r===1)throw r=Xf,Uo(t,0),Sa(t,e),Bn(t,ir()),r;if(r===6)throw Error(Te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Co(t,Fn,Di),Bn(t,ir()),null}function cv(t,e){var r=ut;ut|=1;try{return t(e)}finally{ut=r,ut===0&&(Mc=ir()+500,Xm&&fo())}}function tl(t){Na!==null&&Na.tag===0&&!(ut&6)&&yc();var e=ut;ut|=1;var r=Es.transition,n=_t;try{if(Es.transition=null,_t=1,t)return t()}finally{_t=n,Es.transition=r,ut=e,!(ut&6)&&fo()}}function uv(){qn=sc.current,Ft(sc)}function Uo(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Z6(r)),vr!==null)for(r=vr.return;r!==null;){var n=r;switch(Hy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&z0();break;case 3:Oc(),Ft(jn),Ft(mn),Zy();break;case 5:Jy(n);break;case 4:Oc();break;case 13:Ft(Ut);break;case 19:Ft(Ut);break;case 10:Ky(n.type._context);break;case 22:case 23:uv()}r=r.return}if(Lr=t,vr=t=Ua(t.current,null),Xr=qn=e,Sr=0,Xf=null,ov=Zm=el=0,Fn=lf=null,Do!==null){for(e=0;e<Do.length;e++)if(r=Do[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Do=null}return t}function MC(t,e){do{var r=vr;try{if(qy(),h0.current=J0,Q0){for(var n=Wt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Q0=!1}if(Zo=0,Pr=Er=Wt=null,af=!1,Gf=0,av.current=null,r===null||r.return===null){Sr=1,Xf=e,vr=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=Xr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=nE(a);if(p!==null){p.flags&=-257,sE(p,a,o,i,e),p.mode&1&&rE(i,c,e),e=p,l=c;var x=e.updateQueue;if(x===null){var g=new Set;g.add(l),e.updateQueue=g}else x.add(l);break e}else{if(!(e&1)){rE(i,c,e),fv();break e}l=Error(Te(426))}}else if(jt&&o.mode&1){var v=nE(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),sE(v,a,o,i,e),Wy(Lc(l,o));break e}}i=l=Lc(l,o),Sr!==4&&(Sr=2),lf===null?lf=[i]:lf.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=wC(i,l,e);Y2(i,_);break e;case 1:o=l;var w=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Va===null||!Va.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=_C(i,o,e);Y2(i,I);break e}}i=i.return}while(i!==null)}BC(r)}catch(O){e=O,vr===r&&r!==null&&(vr=r=r.return);continue}break}while(!0)}function jC(){var t=Z0.current;return Z0.current=J0,t===null?J0:t}function fv(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Lr===null||!(el&268435455)&&!(Zm&268435455)||Sa(Lr,Xr)}function rm(t,e){var r=ut;ut|=2;var n=jC();(Lr!==t||Xr!==e)&&(Di=null,Uo(t,e));do try{SO();break}catch(s){MC(t,s)}while(!0);if(qy(),ut=r,Z0.current=n,vr!==null)throw Error(Te(261));return Lr=null,Xr=0,Sr}function SO(){for(;vr!==null;)VC(vr)}function AO(){for(;vr!==null&&!YF();)VC(vr)}function VC(t){var e=$C(t.alternate,t,qn);t.memoizedProps=t.pendingProps,e===null?BC(t):vr=e,av.current=null}function BC(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=yO(r,e),r!==null){r.flags&=32767,vr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Sr=6,vr=null;return}}else if(r=xO(r,e,qn),r!==null){vr=r;return}if(e=e.sibling,e!==null){vr=e;return}vr=e=t}while(e!==null);Sr===0&&(Sr=5)}function Co(t,e,r){var n=_t,s=Es.transition;try{Es.transition=null,_t=1,kO(t,e,r,n)}finally{Es.transition=s,_t=n}return null}function kO(t,e,r,n){do yc();while(Na!==null);if(ut&6)throw Error(Te(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Te(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(a6(t,i),t===Lr&&(vr=Lr=null,Xr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ld||(Ld=!0,zC(M0,function(){return yc(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Es.transition,Es.transition=null;var a=_t;_t=1;var o=ut;ut|=4,av.current=null,wO(t,r),FC(r,t),G6(Bx),V0=!!Vx,Bx=Vx=null,t.current=r,_O(r),QF(),ut=o,_t=a,Es.transition=i}else t.current=r;if(Ld&&(Ld=!1,Na=t,tm=s),i=t.pendingLanes,i===0&&(Va=null),e6(r.stateNode),Bn(t,ir()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(em)throw em=!1,t=a1,a1=null,t;return tm&1&&t.tag!==0&&yc(),i=t.pendingLanes,i&1?t===o1?cf++:(cf=0,o1=t):cf=0,fo(),null}function yc(){if(Na!==null){var t=wb(tm),e=Es.transition,r=_t;try{if(Es.transition=null,_t=16>t?16:t,Na===null)var n=!1;else{if(t=Na,Na=null,tm=0,ut&6)throw Error(Te(331));var s=ut;for(ut|=4,Re=t.current;Re!==null;){var i=Re,a=i.child;if(Re.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Re=c;Re!==null;){var u=Re;switch(u.tag){case 0:case 11:case 15:of(8,u,i)}var h=u.child;if(h!==null)h.return=u,Re=h;else for(;Re!==null;){u=Re;var m=u.sibling,p=u.return;if(RC(u),u===c){Re=null;break}if(m!==null){m.return=p,Re=m;break}Re=p}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}Re=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Re=a;else e:for(;Re!==null;){if(i=Re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:of(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Re=_;break e}Re=i.return}}var w=t.current;for(Re=w;Re!==null;){a=Re;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Re=y;else e:for(a=w;Re!==null;){if(o=Re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Jm(9,o)}}catch(O){Jt(o,o.return,O)}if(o===a){Re=null;break e}var I=o.sibling;if(I!==null){I.return=o.return,Re=I;break e}Re=o.return}}if(ut=s,fo(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(Hm,t)}catch{}n=!0}return n}finally{_t=r,Es.transition=e}}return!1}function xE(t,e,r){e=Lc(r,e),e=wC(t,e,1),t=ja(t,e,1),e=Tn(),t!==null&&(Ph(t,1,e),Bn(t,e))}function Jt(t,e,r){if(t.tag===3)xE(t,t,r);else for(;e!==null;){if(e.tag===3){xE(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Va===null||!Va.has(n))){t=Lc(r,t),t=_C(e,t,1),e=ja(e,t,1),t=Tn(),e!==null&&(Ph(e,1,t),Bn(e,t));break}}e=e.return}}function bO(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Tn(),t.pingedLanes|=t.suspendedLanes&r,Lr===t&&(Xr&r)===r&&(Sr===4||Sr===3&&(Xr&130023424)===Xr&&500>ir()-lv?Uo(t,0):ov|=r),Bn(t,e)}function UC(t,e){e===0&&(t.mode&1?(e=kd,kd<<=1,!(kd&130023424)&&(kd=4194304)):e=1);var r=Tn();t=Yi(t,e),t!==null&&(Ph(t,e,r),Bn(t,r))}function CO(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),UC(t,r)}function IO(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(e),UC(t,r)}var $C;$C=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||jn.current)Ln=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ln=!1,gO(t,e,r);Ln=!!(t.flags&131072)}else Ln=!1,jt&&e.flags&1048576&&Gb(e,G0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;m0(t,e),t=e.pendingProps;var s=Pc(e,mn.current);xc(e,r),s=tv(null,e,n,t,s,r);var i=rv();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vn(n)?(i=!0,H0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Yy(e),s.updater=Qm,e.stateNode=s,s._reactInternals=e,Xx(e,n,t,r),e=Jx(null,e,n,!0,i,r)):(e.tag=0,jt&&i&&zy(e),vn(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(m0(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=RO(n),t=Vs(n,t),s){case 0:e=Qx(null,e,n,t,r);break e;case 1:e=oE(null,e,n,t,r);break e;case 11:e=iE(null,e,n,t,r);break e;case 14:e=aE(null,e,n,Vs(n.type,t),r);break e}throw Error(Te(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Vs(n,s),Qx(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Vs(n,s),oE(t,e,n,s,r);case 3:e:{if(AC(e),t===null)throw Error(Te(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Jb(t,e),X0(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Lc(Error(Te(423)),e),e=lE(t,e,n,r,s);break e}else if(n!==s){s=Lc(Error(Te(424)),e),e=lE(t,e,n,r,s);break e}else for(Jn=Ma(e.stateNode.containerInfo.firstChild),es=e,jt=!0,Us=null,r=Yb(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Dc(),n===s){e=Qi(t,e,r);break e}vn(t,e,n,r)}e=e.child}return e;case 5:return Zb(e),t===null&&Gx(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Ux(n,s)?a=null:i!==null&&Ux(n,i)&&(e.flags|=32),SC(t,e),vn(t,e,a,r),e.child;case 6:return t===null&&Gx(e),null;case 13:return kC(t,e,r);case 4:return Qy(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Fc(e,null,n,r):vn(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Vs(n,s),iE(t,e,n,s,r);case 7:return vn(t,e,e.pendingProps,r),e.child;case 8:return vn(t,e,e.pendingProps.children,r),e.child;case 12:return vn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,bt(q0,n._currentValue),n._currentValue=a,i!==null)if(Xs(i.value,a)){if(i.children===s.children&&!jn.current){e=Qi(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=$i(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),qx(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Te(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),qx(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}vn(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,xc(e,r),s=ks(s),n=n(s),e.flags|=1,vn(t,e,n,r),e.child;case 14:return n=e.type,s=Vs(n,e.pendingProps),s=Vs(n.type,s),aE(t,e,n,s,r);case 15:return EC(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Vs(n,s),m0(t,e),e.tag=1,Vn(n)?(t=!0,H0(e)):t=!1,xc(e,r),vC(e,n,s),Xx(e,n,s,r),Jx(null,e,n,!0,t,r);case 19:return bC(t,e,r);case 22:return TC(t,e,r)}throw Error(Te(156,e.tag))};function zC(t,e){return gb(t,e)}function NO(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ws(t,e,r,n){return new NO(t,e,r,n)}function hv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function RO(t){if(typeof t=="function")return hv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ry)return 11;if(t===Py)return 14}return 2}function Ua(t,e){var r=t.alternate;return r===null?(r=ws(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function x0(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")hv(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Kl:return $o(r.children,s,i,e);case Ny:a=8,s|=8;break;case vx:return t=ws(12,r,e,s|2),t.elementType=vx,t.lanes=i,t;case wx:return t=ws(13,r,e,s),t.elementType=wx,t.lanes=i,t;case _x:return t=ws(19,r,e,s),t.elementType=_x,t.lanes=i,t;case Zk:return ep(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Qk:a=10;break e;case Jk:a=9;break e;case Ry:a=11;break e;case Py:a=14;break e;case _a:a=16,n=null;break e}throw Error(Te(130,t==null?t:typeof t,""))}return e=ws(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function $o(t,e,r,n){return t=ws(7,t,n,e),t.lanes=r,t}function ep(t,e,r,n){return t=ws(22,t,n,e),t.elementType=Zk,t.lanes=r,t.stateNode={isHidden:!1},t}function Eg(t,e,r){return t=ws(6,t,null,e),t.lanes=r,t}function Tg(t,e,r){return e=ws(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PO(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ng(0),this.expirationTimes=ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ng(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function dv(t,e,r,n,s,i,a,o,l){return t=new PO(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ws(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yy(i),t}function DO(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ql,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function HC(t){if(!t)return qa;t=t._reactInternals;e:{if(xl(t)!==t||t.tag!==1)throw Error(Te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Te(171))}if(t.tag===1){var r=t.type;if(Vn(r))return Hb(t,r,e)}return e}function WC(t,e,r,n,s,i,a,o,l){return t=dv(r,n,!0,t,s,i,a,o,l),t.context=HC(null),r=t.current,n=Tn(),s=Ba(r),i=$i(n,s),i.callback=e??null,ja(r,i,s),t.current.lanes=s,Ph(t,s,n),Bn(t,n),t}function tp(t,e,r,n){var s=e.current,i=Tn(),a=Ba(s);return r=HC(r),e.context===null?e.context=r:e.pendingContext=r,e=$i(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ja(s,e,a),t!==null&&(Gs(t,s,a,i),f0(t,s,a)),a}function nm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function mv(t,e){yE(t,e),(t=t.alternate)&&yE(t,e)}function FO(){return null}var GC=typeof reportError=="function"?reportError:function(t){console.error(t)};function pv(t){this._internalRoot=t}rp.prototype.render=pv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Te(409));tp(t,e,null,null)};rp.prototype.unmount=pv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;tl(function(){tp(null,t,null,null)}),e[Xi]=null}};function rp(t){this._internalRoot=t}rp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tb();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ta.length&&e!==0&&e<Ta[r].priority;r++);Ta.splice(r,0,t),r===0&&Ab(t)}};function gv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function np(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vE(){}function OO(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=nm(a);i.call(c)}}var a=WC(e,n,t,0,null,!1,!1,"",vE);return t._reactRootContainer=a,t[Xi]=a.current,Uf(t.nodeType===8?t.parentNode:t),tl(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=nm(l);o.call(c)}}var l=dv(t,0,!1,null,null,!1,!1,"",vE);return t._reactRootContainer=l,t[Xi]=l.current,Uf(t.nodeType===8?t.parentNode:t),tl(function(){tp(e,l,r,n)}),l}function sp(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=nm(a);o.call(l)}}tp(e,a,t,s)}else a=OO(r,e,t,s,n);return nm(a)}_b=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=$u(e.pendingLanes);r!==0&&(Oy(e,r|1),Bn(e,ir()),!(ut&6)&&(Mc=ir()+500,fo()))}break;case 13:tl(function(){var n=Yi(t,1);if(n!==null){var s=Tn();Gs(n,t,1,s)}}),mv(t,1)}};Ly=function(t){if(t.tag===13){var e=Yi(t,134217728);if(e!==null){var r=Tn();Gs(e,t,134217728,r)}mv(t,134217728)}};Eb=function(t){if(t.tag===13){var e=Ba(t),r=Yi(t,e);if(r!==null){var n=Tn();Gs(r,t,e,n)}mv(t,e)}};Tb=function(){return _t};Sb=function(t,e){var r=_t;try{return _t=t,e()}finally{_t=r}};Rx=function(t,e,r){switch(e){case"input":if(Sx(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Km(n);if(!s)throw Error(Te(90));tb(n),Sx(n,s)}}}break;case"textarea":nb(t,r);break;case"select":e=r.value,e!=null&&dc(t,!!r.multiple,e,!1)}};ub=cv;fb=tl;var LO={usingClientEntryPoint:!1,Events:[Fh,Jl,Km,lb,cb,cv]},Lu={findFiberByHostInstance:Po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MO={bundleType:Lu.bundleType,version:Lu.version,rendererPackageName:Lu.rendererPackageName,rendererConfig:Lu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ia.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=mb(t),t===null?null:t.stateNode},findFiberByHostInstance:Lu.findFiberByHostInstance||FO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Md.isDisabled&&Md.supportsFiber)try{Hm=Md.inject(MO),hi=Md}catch{}}ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LO;ss.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gv(e))throw Error(Te(200));return DO(t,e,null,r)};ss.createRoot=function(t,e){if(!gv(t))throw Error(Te(299));var r=!1,n="",s=GC;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=dv(t,1,!1,null,null,r,!1,n,s),t[Xi]=e.current,Uf(t.nodeType===8?t.parentNode:t),new pv(e)};ss.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Te(188)):(t=Object.keys(t).join(","),Error(Te(268,t)));return t=mb(e),t=t===null?null:t.stateNode,t};ss.flushSync=function(t){return tl(t)};ss.hydrate=function(t,e,r){if(!np(e))throw Error(Te(200));return sp(null,t,e,!0,r)};ss.hydrateRoot=function(t,e,r){if(!gv(t))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=GC;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=WC(e,null,t,1,r??null,s,!1,i,a),t[Xi]=e.current,Uf(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new rp(e)};ss.render=function(t,e,r){if(!np(e))throw Error(Te(200));return sp(null,t,e,!1,r)};ss.unmountComponentAtNode=function(t){if(!np(t))throw Error(Te(40));return t._reactRootContainer?(tl(function(){sp(null,null,t,!1,function(){t._reactRootContainer=null,t[Xi]=null})}),!0):!1};ss.unstable_batchedUpdates=cv;ss.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!np(r))throw Error(Te(200));if(t==null||t._reactInternals===void 0)throw Error(Te(38));return sp(t,e,r,!1,n)};ss.version="18.3.1-next-f1338f8080-20240426";function qC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qC)}catch(t){console.error(t)}}qC(),qk.exports=ss;var jO=qk.exports,wE=jO;xx.createRoot=wE.createRoot,xx.hydrateRoot=wE.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BO=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),_E=t=>{const e=BO(t);return e.charAt(0).toUpperCase()+e.slice(1)},KC=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),UO=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $O={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=te.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...o},l)=>te.createElement("svg",{ref:l,...$O,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:KC("lucide",s),...!i&&!UO(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,u])=>te.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=(t,e)=>{const r=te.forwardRef(({className:n,...s},i)=>te.createElement(zO,{ref:i,iconNode:e,className:KC(`lucide-${VO(_E(t))}`,`lucide-${t}`,n),...s}));return r.displayName=_E(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],XC=Xe("activity",HO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],GO=Xe("bug",WO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],YC=Xe("calendar",qO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ul=Xe("chart-column",KO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],YO=Xe("chart-pie",XO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],QC=Xe("chevron-down",QO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],JC=Xe("chevron-up",JO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],jc=Xe("circle-alert",ZO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ka=Xe("circle-check-big",e5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],EE=Xe("circle-x",t5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Li=Xe("clock",r5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],s5=Xe("crown",n5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],u1=Xe("database",i5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],TE=Xe("download",a5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ZC=Xe("eye-off",o5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],e4=Xe("eye",l5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],vc=Xe("file-spreadsheet",c5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],f5=Xe("file",u5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],t4=Xe("funnel",h5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],m5=Xe("loader-circle",d5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],SE=Xe("lock",p5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],x5=Xe("log-out",g5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],r4=Xe("mail",y5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],n4=Xe("map-pin",v5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],s4=Xe("message-square",w5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],zr=Xe("phone",_5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xv=Xe("plus",E5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],S5=Xe("refresh-cw",T5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],yv=Xe("save",A5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_s=Xe("search",k5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],C5=Xe("settings",b5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],f1=Xe("shield",I5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],i4=Xe("square-pen",N5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],P5=Xe("timer",R5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D5=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Yf=Xe("trash-2",D5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],O5=Xe("trending-down",F5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L5=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],h1=Xe("trending-up",L5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],mi=Xe("triangle-alert",M5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Qf=Xe("upload",j5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Vc=Xe("user-plus",V5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],U5=Xe("user-x",B5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Xa=Xe("user",$5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Dr=Xe("users",z5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Bc=Xe("x",H5);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var sm={};sm.version="0.18.5";var a4=1252,W5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wv=function(t){W5.indexOf(t)!=-1&&(a4=vv[0]=t)};function G5(){wv(1252)}var $s=function(t){wv(t)};function _v(){$s(1200),G5()}function AE(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function q5(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function o4(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Hu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?q5(t.slice(2)):e==254&&r==255?o4(t.slice(2)):e==65279?t.slice(1):t},jd=function(e){return String.fromCharCode(e)},kE=function(e){return String.fromCharCode(e)},Jf,Ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zf(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ra.charAt(i)+Ra.charAt(a)+Ra.charAt(o)+Ra.charAt(l);return e}function ns(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=Ra.indexOf(t.charAt(c++)),a=Ra.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Ra.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ra.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),aa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ya(t){return rt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function bE(t){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Yn=function(e){return rt?aa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function ip(t){if(typeof ArrayBuffer>"u")return Yn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ho(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function K5(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Ev(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ev(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Fr=rt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:aa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function X5(t){for(var e=[],r=0,n=t.length+250,s=Ya(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Ya(65535),n=65530)}return e.push(s.slice(0,r)),Fr(e)}var Sn=/\u0000/g,Wu=/[\u0001-\u0006]/g;function wc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function zs(t,e){var r=""+t;return r.length>=e?r:Zt("0",e-r.length)+r}function Tv(t,e){var r=""+t;return r.length>=e?r:Zt(" ",e-r.length)+r}function im(t,e){var r=""+t;return r.length>=e?r:r+Zt(" ",e-r.length)}function Y5(t,e){var r=""+Math.round(t);return r.length>=e?r:Zt("0",e-r.length)+r}function Q5(t,e){var r=""+t;return r.length>=e?r:Zt("0",e-r.length)+r}var CE=Math.pow(2,32);function jl(t,e){if(t>CE||t<-CE)return Y5(t,e);var r=Math.round(t);return Q5(r,e)}function am(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var IE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function J5(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},NE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function om(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*a+i,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function Oo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=iL(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var l4=new Date(1899,11,31,0,0,0),eL=l4.getTime(),tL=new Date(1900,2,1,0,0,0);function c4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=tL&&(r+=24*60*60*1e3),(r-(eL+(t.getTimezoneOffset()-l4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Sv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function nL(t){var e=t<0?12:11,r=Sv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function sL(t){var e=Sv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function eh(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=nL(t):e===10?r=t.toFixed(10).substr(0,12):r=sL(t),Sv(rL(r.toUpperCase()))}function rl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):eh(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Cs(14,c4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function iL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function aL(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Sg[r.m-1][1];case 5:return Sg[r.m-1][0];default:return Sg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return IE[r.q][0];default:return IE[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?zs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=zs(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?zs(l,c):"";return u}function Pa(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var u4=/%/g;function oL(t,e,r){var n=e.replace(u4,""),s=e.length-n.length;return zi(t,n,r*Math.pow(10,2*s))+Zt("%",s)}function lL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return zi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function f4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+f4(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var h4=/# (\?+)( ?)\/( ?)(\d+)/;function cL(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Zt(" ",t[1].length+1+t[4].length):Tv(a,t[1].length)+t[2]+"/"+t[3]+zs(o,t[4].length))}function uL(t,e,r){return r+(e===0?"":""+e)+Zt(" ",t[1].length+2+t[4].length)}var d4=/^#*0*\.([0#]+)/,m4=/\).*[0#]/,p4=/\(###\) ###\\?-####/;function wn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function RE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function PE(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function fL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function hL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ls(t,e,r){if(t.charCodeAt(0)===40&&!e.match(m4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ls("n",n,r):"("+ls("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return lL(t,e,r);if(e.indexOf("%")!==-1)return oL(t,e,r);if(e.indexOf("E")!==-1)return f4(e,r);if(e.charCodeAt(0)===36)return"$"+ls(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+jl(l,e.length);if(e.match(/^[#?]+$/))return s=jl(r,0),s==="0"&&(s=""),s.length>e.length?s:wn(e.substr(0,e.length-s.length))+s;if(i=e.match(h4))return cL(i,l,c);if(e.match(/^#+0+$/))return c+jl(l,e.length-e.indexOf("0"));if(i=e.match(d4))return s=RE(r,i[1].length).replace(/^([^\.]+)$/,"$1."+wn(i[1])).replace(/\.$/,"."+wn(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Zt("0",wn(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+RE(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Pa(jl(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ls(t,e,-r):Pa(""+(Math.floor(r)+fL(r,i[1].length)))+"."+zs(PE(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return ls(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wc(ls(t,e.replace(/[\\-]/g,""),r)),a=0,wc(wc(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(p4))return s=ls(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=om(l,Math.pow(10,a)-1,!1),s=""+c,u=zi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=im(o[2],a),u.length<i[4].length&&(u=wn(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=om(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tv(o[1],a)+i[2]+"/"+i[3]+im(o[2],a):Zt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=jl(r,0),e.length<=s.length?s:wn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,m=e.length-s.length-h;return wn(e.substr(0,h)+s+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=PE(r,i[1].length),r<0?"-"+ls(t,e,-r):Pa(hL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zs(0,3-x.length):"")+x})+"."+zs(a,i[1].length);switch(e){case"###,##0.00":return ls(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Pa(jl(l,0));return p!=="0"?c+p:"";case"###,###.00":return ls(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ls(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function dL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return zi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function mL(t,e,r){var n=e.replace(u4,""),s=e.length-n.length;return zi(t,n,r*Math.pow(10,2*s))+Zt("%",s)}function g4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+g4(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ii(t,e,r){if(t.charCodeAt(0)===40&&!e.match(m4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ii("n",n,r):"("+ii("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return dL(t,e,r);if(e.indexOf("%")!==-1)return mL(t,e,r);if(e.indexOf("E")!==-1)return g4(e,r);if(e.charCodeAt(0)===36)return"$"+ii(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+zs(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:wn(e.substr(0,e.length-s.length))+s;if(i=e.match(h4))return uL(i,l,c);if(e.match(/^#+0+$/))return c+zs(l,e.length-e.indexOf("0"));if(i=e.match(d4))return s=(""+r).replace(/^([^\.]+)$/,"$1."+wn(i[1])).replace(/\.$/,"."+wn(i[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+Zt("0",wn(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Pa(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ii(t,e,-r):Pa(""+r)+"."+Zt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return ii(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wc(ii(t,e.replace(/[\\-]/g,""),r)),a=0,wc(wc(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(p4))return s=ii(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=om(l,Math.pow(10,a)-1,!1),s=""+c,u=zi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=im(o[2],a),u.length<i[4].length&&(u=wn(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=om(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tv(o[1],a)+i[2]+"/"+i[3]+im(o[2],a):Zt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:wn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,m=e.length-s.length-h;return wn(e.substr(0,h)+s+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ii(t,e,-r):Pa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zs(0,3-x.length):"")+x})+"."+zs(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Pa(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return ii(t,e.slice(0,e.lastIndexOf(".")),r)+wn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function zi(t,e,r){return(r|0)===r?ii(t,e,r):ls(t,e,r)}function pL(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var x4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":am(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(x4))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function gL(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,h,m="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!am(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Oo(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Oo(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=Oo(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",m="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",a+=5,m="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",a+=5,m="h"):(g.t="t",++a),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(x4)){if(c==null&&(c=Oo(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",nu(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var v=0,_=0,w;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=m,l="h",v<1&&(v=1);break;case"s":(w=s[a].v.match(/\.0+$/))&&(_=Math.max(_,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[a].v.match(/[Hh]/)&&(v=1),v<2&&s[a].v.match(/[Mm]/)&&(v=2),v<3&&s[a].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",I;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=aL(s[a].t.charCodeAt(0),s[a].v,c,_),s[a].t="t";break;case"n":case"?":for(I=a+1;s[I]!=null&&((o=s[I].t)==="?"||o==="D"||(o===" "||o==="t")&&s[I+1]!=null&&(s[I+1].t==="?"||s[I+1].t==="t"&&s[I+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[I].v==="/"||s[I].v===" "&&s[I+1]!=null&&s[I+1].t=="?"));)s[a].v+=s[I].v,s[I]={v:"",t:";"},++I;y+=s[a].v,a=I-1;break;case"G":s[a].t="t",s[a].v=rl(e,r);break}var O="",P,S;if(y.length>0){y.charCodeAt(0)==40?(P=e<0&&y.charCodeAt(0)===45?-e:e,S=zi("n",y,P)):(P=e<0&&n>1?-e:e,S=zi("n",y,P),P<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),I=S.length-1;var E=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){E=a;break}var A=s.length;if(E===s.length&&S.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(I>=s[a].v.length-1?(I-=s[a].v.length,s[a].v=S.substr(I+1,s[a].v.length)):I<0?s[a].v="":(s[a].v=S.substr(0,I+1),I=-1),s[a].t="t",A=a);I>=0&&A<s.length&&(s[A].v=S.substr(0,I+1)+s[A].v)}else if(E!==s.length&&S.indexOf("E")===-1){for(I=S.indexOf(".")-1,a=E;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")-1:s[a].v.length-1,O=s[a].v.substr(u+1);u>=0;--u)I>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(O=S.charAt(I--)+O);s[a].v=O,s[a].t="t",A=a}for(I>=0&&A<s.length&&(s[A].v=S.substr(0,I+1)+s[A].v),I=S.indexOf(".")+1,a=E;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==E)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")+1:0,O=s[a].v.substr(0,u);u<s[a].v.length;++u)I<S.length&&(O+=S.charAt(I++));s[a].v=O,s[a].t="t",A=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(P=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=zi(s[a].t,s[a].v,P),s[a].t="t");var N="";for(a=0;a!==s.length;++a)s[a]!=null&&(N+=s[a].v);return N}var DE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function FE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function xL(t,e){var r=pL(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(DE),o=r[1].match(DE);return FE(e,a)?[n,r[0]]:FE(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Cs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Me)[t],n==null&&(n=r.table&&r.table[NE[t]]||Me[NE[t]]),n==null&&(n=Z5[t]||"General");break}if(am(n,0))return rl(e,r);e instanceof Date&&(e=c4(e,r.date1904));var s=xL(n,e);if(am(s[1]))return rl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return gL(s[1],e,r,s[0])}function Hi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Me[r]==null){e<0&&(e=r);continue}if(Me[r]==t){e=r;break}}e<0&&(e=391)}return Me[e]=t,e}function ap(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Hi(t[e],e)}function su(){Me=J5()}var yL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},y4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vL(t){var e=typeof t=="number"?Me[t]:t;return e=e.replace(y4,"(\\d+)"),new RegExp("^"+e+"$")}function wL(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(y4)||[]).forEach(function(h,m){var p=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var _L=function(){var t={};t.version="1.2.0";function e(){for(var S=0,E=new Array(256),A=0;A!=256;++A)S=A,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[A]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=e();function n(S){var E=0,A=0,N=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)C[N]=S[N];for(N=0;N!=256;++N)for(A=S[N],E=256+N;E<4096;E+=256)A=C[E]=A>>>8^S[A&255];var R=[];for(N=1;N!=16;++N)R[N-1]=typeof Int32Array<"u"?C.subarray(N*256,N*256+256):C.slice(N*256,N*256+256);return R}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],m=s[7],p=s[8],x=s[9],g=s[10],v=s[11],_=s[12],w=s[13],y=s[14];function I(S,E){for(var A=E^-1,N=0,C=S.length;N<C;)A=A>>>8^r[(A^S.charCodeAt(N++))&255];return~A}function O(S,E){for(var A=E^-1,N=S.length-15,C=0;C<N;)A=y[S[C++]^A&255]^w[S[C++]^A>>8&255]^_[S[C++]^A>>16&255]^v[S[C++]^A>>>24]^g[S[C++]]^x[S[C++]]^p[S[C++]]^m[S[C++]]^h[S[C++]]^u[S[C++]]^c[S[C++]]^l[S[C++]]^o[S[C++]]^a[S[C++]]^i[S[C++]]^r[S[C++]];for(N+=15;C<N;)A=A>>>8^r[(A^S[C++])&255];return~A}function P(S,E){for(var A=E^-1,N=0,C=S.length,R=0,F=0;N<C;)R=S.charCodeAt(N++),R<128?A=A>>>8^r[(A^R)&255]:R<2048?(A=A>>>8^r[(A^(192|R>>6&31))&255],A=A>>>8^r[(A^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,F=S.charCodeAt(N++)&1023,A=A>>>8^r[(A^(240|R>>8&7))&255],A=A>>>8^r[(A^(128|R>>2&63))&255],A=A>>>8^r[(A^(128|F>>6&15|(R&3)<<4))&255],A=A>>>8^r[(A^(128|F&63))&255]):(A=A>>>8^r[(A^(224|R>>12&15))&255],A=A>>>8^r[(A^(128|R>>6&63))&255],A=A>>>8^r[(A^(128|R&63))&255]);return~A}return t.table=r,t.bstr=I,t.buf=O,t.str=P,t}(),De=function(){var e={};e.version="1.2.1";function r(D,U){for(var j=D.split("/"),V=U.split("/"),z=0,b=0,G=Math.min(j.length,V.length);z<G;++z){if(b=j[z].length-V[z].length)return b;if(j[z]!=V[z])return j[z]<V[z]?-1:1}return j.length-V.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var U=D.lastIndexOf("/");return U===-1?D:D.slice(0,U+1)}function s(D){if(D.charAt(D.length-1)=="/")return s(D.slice(0,-1));var U=D.lastIndexOf("/");return U===-1?D:D.slice(U+1)}function i(D,U){typeof U=="string"&&(U=new Date(U));var j=U.getHours();j=j<<6|U.getMinutes(),j=j<<5|U.getSeconds()>>>1,D.write_shift(2,j);var V=U.getFullYear()-1980;V=V<<4|U.getMonth()+1,V=V<<5|U.getDate(),D.write_shift(2,V)}function a(D){var U=D.read_shift(2)&65535,j=D.read_shift(2)&65535,V=new Date,z=j&31;j>>>=5;var b=j&15;j>>>=4,V.setMilliseconds(0),V.setFullYear(j+1980),V.setMonth(b-1),V.setDate(z);var G=U&31;U>>>=5;var J=U&63;return U>>>=6,V.setHours(U),V.setMinutes(J),V.setSeconds(G<<1),V}function o(D){Wr(D,0);for(var U={},j=0;D.l<=D.length-4;){var V=D.read_shift(2),z=D.read_shift(2),b=D.l+z,G={};switch(V){case 21589:j=D.read_shift(1),j&1&&(G.mtime=D.read_shift(4)),z>5&&(j&2&&(G.atime=D.read_shift(4)),j&4&&(G.ctime=D.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}D.l=b,U[V]=G}return U}var l;function c(){return l||(l={})}function u(D,U){if(D[0]==80&&D[1]==75)return Eo(D,U);if((D[0]|32)==109&&(D[1]|32)==105)return Pl(D,U);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var j=3,V=512,z=0,b=0,G=0,J=0,Y=0,q=[],Q=D.slice(0,512);Wr(Q,0);var se=h(Q);switch(j=se[0],j){case 3:V=512;break;case 4:V=4096;break;case 0:if(se[1]==0)return Eo(D,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}V!==512&&(Q=D.slice(0,V),Wr(Q,28));var ye=D.slice(0,V);m(Q,j);var me=Q.read_shift(4,"i");if(j===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);Q.l+=4,G=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),J=Q.read_shift(4,"i"),z=Q.read_shift(4,"i"),Y=Q.read_shift(4,"i"),b=Q.read_shift(4,"i");for(var xe=-1,pe=0;pe<109&&(xe=Q.read_shift(4,"i"),!(xe<0));++pe)q[pe]=xe;var Ce=p(D,V);v(Y,b,Ce,V,q);var Oe=w(Ce,G,q,V);Oe[G].name="!Directory",z>0&&J!==F&&(Oe[J].name="!MiniFAT"),Oe[q[0]].name="!FAT",Oe.fat_addrs=q,Oe.ssz=V;var qe={},pt=[],jr=[],Ds=[];y(G,Oe,Ce,pt,z,qe,jr,J),x(jr,Ds,pt),pt.shift();var ma={FileIndex:jr,FullPaths:Ds};return U&&U.raw&&(ma.raw={header:ye,sectors:Ce}),ma}function h(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(oe,"Header Signature: "),D.l+=16;var U=D.read_shift(2,"u");return[D.read_shift(2,"u"),U]}function m(D,U){var j=9;switch(D.l+=2,j=D.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function p(D,U){for(var j=Math.ceil(D.length/U)-1,V=[],z=1;z<j;++z)V[z-1]=D.slice(z*U,(z+1)*U);return V[j-1]=D.slice(j*U),V}function x(D,U,j){for(var V=0,z=0,b=0,G=0,J=0,Y=j.length,q=[],Q=[];V<Y;++V)q[V]=Q[V]=V,U[V]=j[V];for(;J<Q.length;++J)V=Q[J],z=D[V].L,b=D[V].R,G=D[V].C,q[V]===V&&(z!==-1&&q[z]!==z&&(q[V]=q[z]),b!==-1&&q[b]!==b&&(q[V]=q[b])),G!==-1&&(q[G]=V),z!==-1&&V!=q[V]&&(q[z]=q[V],Q.lastIndexOf(z)<J&&Q.push(z)),b!==-1&&V!=q[V]&&(q[b]=q[V],Q.lastIndexOf(b)<J&&Q.push(b));for(V=1;V<Y;++V)q[V]===V&&(b!==-1&&q[b]!==b?q[V]=q[b]:z!==-1&&q[z]!==z&&(q[V]=q[z]));for(V=1;V<Y;++V)if(D[V].type!==0){if(J=V,J!=q[J])do J=q[J],U[V]=U[J]+"/"+U[V];while(J!==0&&q[J]!==-1&&J!=q[J]);q[V]=-1}for(U[0]+="/",V=1;V<Y;++V)D[V].type!==2&&(U[V]+="/")}function g(D,U,j){for(var V=D.start,z=D.size,b=[],G=V;j&&z>0&&G>=0;)b.push(U.slice(G*R,G*R+R)),z-=R,G=Ro(j,G*4);return b.length===0?fe(0):Fr(b).slice(0,D.size)}function v(D,U,j,V,z){var b=F;if(D===F){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var G=j[D],J=(V>>>2)-1;if(!G)return;for(var Y=0;Y<J&&(b=Ro(G,Y*4))!==F;++Y)z.push(b);v(Ro(G,V-4),U-1,j,V,z)}}function _(D,U,j,V,z){var b=[],G=[];z||(z=[]);var J=V-1,Y=0,q=0;for(Y=U;Y>=0;){z[Y]=!0,b[b.length]=Y,G.push(D[Y]);var Q=j[Math.floor(Y*4/V)];if(q=Y*4&J,V<4+q)throw new Error("FAT boundary crossed: "+Y+" 4 "+V);if(!D[Q])break;Y=Ro(D[Q],q)}return{nodes:b,data:GE([G])}}function w(D,U,j,V){var z=D.length,b=[],G=[],J=[],Y=[],q=V-1,Q=0,se=0,ye=0,me=0;for(Q=0;Q<z;++Q)if(J=[],ye=Q+U,ye>=z&&(ye-=z),!G[ye]){Y=[];var xe=[];for(se=ye;se>=0;){xe[se]=!0,G[se]=!0,J[J.length]=se,Y.push(D[se]);var pe=j[Math.floor(se*4/V)];if(me=se*4&q,V<4+me)throw new Error("FAT boundary crossed: "+se+" 4 "+V);if(!D[pe]||(se=Ro(D[pe],me),xe[se]))break}b[ye]={nodes:J,data:GE([Y])}}return b}function y(D,U,j,V,z,b,G,J){for(var Y=0,q=V.length?2:0,Q=U[D].data,se=0,ye=0,me;se<Q.length;se+=128){var xe=Q.slice(se,se+128);Wr(xe,64),ye=xe.read_shift(2),me=Rv(xe,0,ye-q),V.push(me);var pe={name:me,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Ce=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Ce!==0&&(pe.ct=I(xe,xe.l-8));var Oe=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Oe!==0&&(pe.mt=I(xe,xe.l-8)),pe.start=xe.read_shift(4,"i"),pe.size=xe.read_shift(4,"i"),pe.size<0&&pe.start<0&&(pe.size=pe.type=0,pe.start=F,pe.name=""),pe.type===5?(Y=pe.start,z>0&&Y!==F&&(U[Y].name="!StreamData")):pe.size>=4096?(pe.storage="fat",U[pe.start]===void 0&&(U[pe.start]=_(j,pe.start,U.fat_addrs,U.ssz)),U[pe.start].name=pe.name,pe.content=U[pe.start].data.slice(0,pe.size)):(pe.storage="minifat",pe.size<0?pe.size=0:Y!==F&&pe.start!==F&&U[Y]&&(pe.content=g(pe,U[Y].data,(U[J]||{}).data))),pe.content&&Wr(pe.content,0),b[me]=pe,G.push(pe)}}function I(D,U){return new Date((Xn(D,U+4)/1e7*Math.pow(2,32)+Xn(D,U)/1e7-11644473600)*1e3)}function O(D,U){return c(),u(l.readFileSync(D),U)}function P(D,U){var j=U&&U.type;switch(j||rt&&Buffer.isBuffer(D)&&(j="buffer"),j||"base64"){case"file":return O(D,U);case"base64":return u(Yn(ns(D)),U);case"binary":return u(Yn(D),U)}return u(D,U)}function S(D,U){var j=U||{},V=j.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=V+"/",D.FileIndex[0]={name:V,type:5}),j.CLSID&&(D.FileIndex[0].clsid=j.CLSID),E(D)}function E(D){var U="Sh33tJ5";if(!De.find(D,"/"+U)){var j=fe(4);j[0]=55,j[1]=j[3]=50,j[2]=54,D.FileIndex.push({name:U,type:2,content:j,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+U),A(D)}}function A(D,U){S(D);for(var j=!1,V=!1,z=D.FullPaths.length-1;z>=0;--z){var b=D.FileIndex[z];switch(b.type){case 0:V?j=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(b.R*b.L*b.C)&&(j=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!U)){var G=new Date(1987,1,19),J=0,Y=Object.create?Object.create(null):{},q=[];for(z=0;z<D.FullPaths.length;++z)Y[D.FullPaths[z]]=!0,D.FileIndex[z].type!==0&&q.push([D.FullPaths[z],D.FileIndex[z]]);for(z=0;z<q.length;++z){var Q=n(q[z][0]);V=Y[Q],V||(q.push([Q,{name:s(Q).replace("/",""),type:1,clsid:ve,ct:G,mt:G,content:null}]),Y[Q]=!0)}for(q.sort(function(me,xe){return r(me[0],xe[0])}),D.FullPaths=[],D.FileIndex=[],z=0;z<q.length;++z)D.FullPaths[z]=q[z][0],D.FileIndex[z]=q[z][1];for(z=0;z<q.length;++z){var se=D.FileIndex[z],ye=D.FullPaths[z];if(se.name=s(ye).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||ve,z===0)se.C=q.length>1?1:-1,se.size=0,se.type=5;else if(ye.slice(-1)=="/"){for(J=z+1;J<q.length&&n(D.FullPaths[J])!=ye;++J);for(se.C=J>=q.length?-1:J,J=z+1;J<q.length&&n(D.FullPaths[J])!=n(ye);++J);se.R=J>=q.length?-1:J,se.type=1}else n(D.FullPaths[z+1]||"")==n(ye)&&(se.R=z+1),se.type=2}}}function N(D,U){var j=U||{};if(j.fileType=="mad")return Cr(D,j);switch(A(D),j.fileType){case"zip":return To(D,j)}var V=function(me){for(var xe=0,pe=0,Ce=0;Ce<me.FileIndex.length;++Ce){var Oe=me.FileIndex[Ce];if(Oe.content){var qe=Oe.content.length;qe>0&&(qe<4096?xe+=qe+63>>6:pe+=qe+511>>9)}}for(var pt=me.FullPaths.length+3>>2,jr=xe+7>>3,Ds=xe+127>>7,ma=jr+pe+pt+Ds,ri=ma+127>>7,Dl=ri<=109?0:Math.ceil((ri-109)/127);ma+ri+Dl+127>>7>ri;)Dl=++ri<=109?0:Math.ceil((ri-109)/127);var Wn=[1,Dl,ri,Ds,pt,pe,xe,0];return me.FileIndex[0].size=xe<<6,Wn[7]=(me.FileIndex[0].start=Wn[0]+Wn[1]+Wn[2]+Wn[3]+Wn[4]+Wn[5])+(Wn[6]+7>>3),Wn}(D),z=fe(V[7]<<9),b=0,G=0;{for(b=0;b<8;++b)z.write_shift(1,ae[b]);for(b=0;b<8;++b)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),b=0;b<3;++b)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,V[2]),z.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:F),z.write_shift(4,V[3]),z.write_shift(-4,V[1]?V[0]-1:F),z.write_shift(4,V[1]),b=0;b<109;++b)z.write_shift(-4,b<V[2]?V[1]+b:-1)}if(V[1])for(G=0;G<V[1];++G){for(;b<236+G*127;++b)z.write_shift(-4,b<V[2]?V[1]+b:-1);z.write_shift(-4,G===V[1]-1?F:G+1)}var J=function(me){for(G+=me;b<G-1;++b)z.write_shift(-4,b+1);me&&(++b,z.write_shift(-4,F))};for(G=b=0,G+=V[1];b<G;++b)z.write_shift(-4,he.DIFSECT);for(G+=V[2];b<G;++b)z.write_shift(-4,he.FATSECT);J(V[3]),J(V[4]);for(var Y=0,q=0,Q=D.FileIndex[0];Y<D.FileIndex.length;++Y)Q=D.FileIndex[Y],Q.content&&(q=Q.content.length,!(q<4096)&&(Q.start=G,J(q+511>>9)));for(J(V[6]+7>>3);z.l&511;)z.write_shift(-4,he.ENDOFCHAIN);for(G=b=0,Y=0;Y<D.FileIndex.length;++Y)Q=D.FileIndex[Y],Q.content&&(q=Q.content.length,!(!q||q>=4096)&&(Q.start=G,J(q+63>>6)));for(;z.l&511;)z.write_shift(-4,he.ENDOFCHAIN);for(b=0;b<V[4]<<2;++b){var se=D.FullPaths[b];if(!se||se.length===0){for(Y=0;Y<17;++Y)z.write_shift(4,0);for(Y=0;Y<3;++Y)z.write_shift(4,-1);for(Y=0;Y<12;++Y)z.write_shift(4,0);continue}Q=D.FileIndex[b],b===0&&(Q.start=Q.size?Q.start-1:F);var ye=b===0&&j.root||Q.name;if(q=2*(ye.length+1),z.write_shift(64,ye,"utf16le"),z.write_shift(2,q),z.write_shift(1,Q.type),z.write_shift(1,Q.color),z.write_shift(-4,Q.L),z.write_shift(-4,Q.R),z.write_shift(-4,Q.C),Q.clsid)z.write_shift(16,Q.clsid,"hex");else for(Y=0;Y<4;++Y)z.write_shift(4,0);z.write_shift(4,Q.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,Q.start),z.write_shift(4,Q.size),z.write_shift(4,0)}for(b=1;b<D.FileIndex.length;++b)if(Q=D.FileIndex[b],Q.size>=4096)if(z.l=Q.start+1<<9,rt&&Buffer.isBuffer(Q.content))Q.content.copy(z,z.l,0,Q.size),z.l+=Q.size+511&-512;else{for(Y=0;Y<Q.size;++Y)z.write_shift(1,Q.content[Y]);for(;Y&511;++Y)z.write_shift(1,0)}for(b=1;b<D.FileIndex.length;++b)if(Q=D.FileIndex[b],Q.size>0&&Q.size<4096)if(rt&&Buffer.isBuffer(Q.content))Q.content.copy(z,z.l,0,Q.size),z.l+=Q.size+63&-64;else{for(Y=0;Y<Q.size;++Y)z.write_shift(1,Q.content[Y]);for(;Y&63;++Y)z.write_shift(1,0)}if(rt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function C(D,U){var j=D.FullPaths.map(function(Y){return Y.toUpperCase()}),V=j.map(function(Y){var q=Y.split("/");return q[q.length-(Y.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=j[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var b=U.toUpperCase(),G=z===!0?j.indexOf(b):V.indexOf(b);if(G!==-1)return D.FileIndex[G];var J=!b.match(Wu);for(b=b.replace(Sn,""),J&&(b=b.replace(Wu,"!")),G=0;G<j.length;++G)if((J?j[G].replace(Wu,"!"):j[G]).replace(Sn,"")==b||(J?V[G].replace(Wu,"!"):V[G]).replace(Sn,"")==b)return D.FileIndex[G];return null}var R=64,F=-2,oe="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],ve="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(D,U,j){c();var V=N(D,j);l.writeFileSync(U,V)}function W(D){for(var U=new Array(D.length),j=0;j<D.length;++j)U[j]=String.fromCharCode(D[j]);return U.join("")}function ie(D,U){var j=N(D,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,j),j;case"binary":return typeof j=="string"?j:W(j);case"base64":return Zf(typeof j=="string"?j:W(j));case"buffer":if(rt)return Buffer.isBuffer(j)?j:aa(j);case"array":return typeof j=="string"?Yn(j):j}return j}var ue;function L(D){try{var U=D.InflateRaw,j=new U;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)ue=D;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function K(D,U){if(!ue)return ha(D,U);var j=ue.InflateRaw,V=new j,z=V._processChunk(D.slice(D.l),V._finishFlushFlag);return D.l+=V.bytesRead,z}function X(D){return ue?ue.deflateRawSync(D):ze(D)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(D){var U=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(U>>16|U>>8|U)&255}for(var we=typeof Uint8Array<"u",de=we?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)de[Pe]=le(Pe);function B(D,U){var j=de[D&255];return U<=8?j>>>8-U:(j=j<<8|de[D>>8&255],U<=16?j>>>16-U:(j=j<<8|de[D>>16&255],j>>>24-U))}function et(D,U){var j=U&7,V=U>>>3;return(D[V]|(j<=6?0:D[V+1]<<8))>>>j&3}function Ye(D,U){var j=U&7,V=U>>>3;return(D[V]|(j<=5?0:D[V+1]<<8))>>>j&7}function tt(D,U){var j=U&7,V=U>>>3;return(D[V]|(j<=4?0:D[V+1]<<8))>>>j&15}function He(D,U){var j=U&7,V=U>>>3;return(D[V]|(j<=3?0:D[V+1]<<8))>>>j&31}function be(D,U){var j=U&7,V=U>>>3;return(D[V]|(j<=1?0:D[V+1]<<8))>>>j&127}function ct(D,U,j){var V=U&7,z=U>>>3,b=(1<<j)-1,G=D[z]>>>V;return j<8-V||(G|=D[z+1]<<8-V,j<16-V)||(G|=D[z+2]<<16-V,j<24-V)||(G|=D[z+3]<<24-V),G&b}function ur(D,U,j){var V=U&7,z=U>>>3;return V<=5?D[z]|=(j&7)<<V:(D[z]|=j<<V&255,D[z+1]=(j&7)>>8-V),U+3}function Je(D,U,j){var V=U&7,z=U>>>3;return j=(j&1)<<V,D[z]|=j,U+1}function Mr(D,U,j){var V=U&7,z=U>>>3;return j<<=V,D[z]|=j&255,j>>>=8,D[z+1]=j,U+8}function ua(D,U,j){var V=U&7,z=U>>>3;return j<<=V,D[z]|=j&255,j>>>=8,D[z+1]=j&255,D[z+2]=j>>>8,U+16}function Cn(D,U){var j=D.length,V=2*j>U?2*j:U+5,z=0;if(j>=U)return D;if(rt){var b=bE(V);if(D.copy)D.copy(b);else for(;z<D.length;++z)b[z]=D[z];return b}else if(we){var G=new Uint8Array(V);if(G.set)G.set(D);else for(;z<j;++z)G[z]=D[z];return G}return D.length=V,D}function Xt(D){for(var U=new Array(D),j=0;j<D;++j)U[j]=0;return U}function In(D,U,j){var V=1,z=0,b=0,G=0,J=0,Y=D.length,q=we?new Uint16Array(32):Xt(32);for(b=0;b<32;++b)q[b]=0;for(b=Y;b<j;++b)D[b]=0;Y=D.length;var Q=we?new Uint16Array(Y):Xt(Y);for(b=0;b<Y;++b)q[z=D[b]]++,V<z&&(V=z),Q[b]=0;for(q[0]=0,b=1;b<=V;++b)q[b+16]=J=J+q[b-1]<<1;for(b=0;b<Y;++b)J=D[b],J!=0&&(Q[b]=q[J+16]++);var se=0;for(b=0;b<Y;++b)if(se=D[b],se!=0)for(J=B(Q[b],V)>>V-se,G=(1<<V+4-se)-1;G>=0;--G)U[J|G<<se]=se&15|b<<4;return V}var gt=we?new Uint16Array(512):Xt(512),Mt=we?new Uint16Array(32):Xt(32);if(!we){for(var Ct=0;Ct<512;++Ct)gt[Ct]=0;for(Ct=0;Ct<32;++Ct)Mt[Ct]=0}(function(){for(var D=[],U=0;U<32;U++)D.push(5);In(D,Mt,32);var j=[];for(U=0;U<=143;U++)j.push(8);for(;U<=255;U++)j.push(9);for(;U<=279;U++)j.push(7);for(;U<=287;U++)j.push(8);In(j,gt,288)})();var br=function(){for(var U=we?new Uint8Array(32768):[],j=0,V=0;j<ee.length-1;++j)for(;V<ee[j+1];++V)U[V]=j;for(;V<32768;++V)U[V]=29;var z=we?new Uint8Array(259):[];for(j=0,V=0;j<re.length-1;++j)for(;V<re[j+1];++V)z[V]=j;function b(J,Y){for(var q=0;q<J.length;){var Q=Math.min(65535,J.length-q),se=q+Q==J.length;for(Y.write_shift(1,+se),Y.write_shift(2,Q),Y.write_shift(2,~Q&65535);Q-- >0;)Y[Y.l++]=J[q++]}return Y.l}function G(J,Y){for(var q=0,Q=0,se=we?new Uint16Array(32768):[];Q<J.length;){var ye=Math.min(65535,J.length-Q);if(ye<10){for(q=ur(Y,q,+(Q+ye==J.length)),q&7&&(q+=8-(q&7)),Y.l=q/8|0,Y.write_shift(2,ye),Y.write_shift(2,~ye&65535);ye-- >0;)Y[Y.l++]=J[Q++];q=Y.l*8;continue}q=ur(Y,q,+(Q+ye==J.length)+2);for(var me=0;ye-- >0;){var xe=J[Q];me=(me<<5^xe)&32767;var pe=-1,Ce=0;if((pe=se[me])&&(pe|=Q&-32768,pe>Q&&(pe-=32768),pe<Q))for(;J[pe+Ce]==J[Q+Ce]&&Ce<250;)++Ce;if(Ce>2){xe=z[Ce],xe<=22?q=Mr(Y,q,de[xe+1]>>1)-1:(Mr(Y,q,3),q+=5,Mr(Y,q,de[xe-23]>>5),q+=3);var Oe=xe<8?0:xe-4>>2;Oe>0&&(ua(Y,q,Ce-re[xe]),q+=Oe),xe=U[Q-pe],q=Mr(Y,q,de[xe]>>3),q-=3;var qe=xe<4?0:xe-2>>1;qe>0&&(ua(Y,q,Q-pe-ee[xe]),q+=qe);for(var pt=0;pt<Ce;++pt)se[me]=Q&32767,me=(me<<5^J[Q])&32767,++Q;ye-=Ce-1}else xe<=143?xe=xe+48:q=Je(Y,q,1),q=Mr(Y,q,de[xe]),se[me]=Q&32767,++Q}q=Mr(Y,q,0)-1}return Y.l=(q+7)/8|0,Y.l}return function(Y,q){return Y.length<8?b(Y,q):G(Y,q)}}();function ze(D){var U=fe(50+Math.floor(D.length*1.1)),j=br(D,U);return U.slice(0,j)}var Et=we?new Uint16Array(32768):Xt(32768),Bt=we?new Uint16Array(32768):Xt(32768),At=we?new Uint16Array(128):Xt(128),Hn=1,fa=1;function yu(D,U){var j=He(D,U)+257;U+=5;var V=He(D,U)+1;U+=5;var z=tt(D,U)+4;U+=4;for(var b=0,G=we?new Uint8Array(19):Xt(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,q=we?new Uint8Array(8):Xt(8),Q=we?new Uint8Array(8):Xt(8),se=G.length,ye=0;ye<z;++ye)G[H[ye]]=b=Ye(D,U),Y<b&&(Y=b),q[b]++,U+=3;var me=0;for(q[0]=0,ye=1;ye<=Y;++ye)Q[ye]=me=me+q[ye-1]<<1;for(ye=0;ye<se;++ye)(me=G[ye])!=0&&(J[ye]=Q[me]++);var xe=0;for(ye=0;ye<se;++ye)if(xe=G[ye],xe!=0){me=de[J[ye]]>>8-xe;for(var pe=(1<<7-xe)-1;pe>=0;--pe)At[me|pe<<xe]=xe&7|ye<<3}var Ce=[];for(Y=1;Ce.length<j+V;)switch(me=At[be(D,U)],U+=me&7,me>>>=3){case 16:for(b=3+et(D,U),U+=2,me=Ce[Ce.length-1];b-- >0;)Ce.push(me);break;case 17:for(b=3+Ye(D,U),U+=3;b-- >0;)Ce.push(0);break;case 18:for(b=11+be(D,U),U+=7;b-- >0;)Ce.push(0);break;default:Ce.push(me),Y<me&&(Y=me);break}var Oe=Ce.slice(0,j),qe=Ce.slice(j);for(ye=j;ye<286;++ye)Oe[ye]=0;for(ye=V;ye<30;++ye)qe[ye]=0;return Hn=In(Oe,Et,286),fa=In(qe,Bt,30),U}function vu(D,U){if(D[0]==3&&!(D[1]&3))return[Ya(U),2];for(var j=0,V=0,z=bE(U||1<<18),b=0,G=z.length>>>0,J=0,Y=0;!(V&1);){if(V=Ye(D,j),j+=3,V>>>1)V>>1==1?(J=9,Y=5):(j=yu(D,j),J=Hn,Y=fa);else{j&7&&(j+=8-(j&7));var q=D[j>>>3]|D[(j>>>3)+1]<<8;if(j+=32,q>0)for(!U&&G<b+q&&(z=Cn(z,b+q),G=z.length);q-- >0;)z[b++]=D[j>>>3],j+=8;continue}for(;;){!U&&G<b+32767&&(z=Cn(z,b+32767),G=z.length);var Q=ct(D,j,J),se=V>>>1==1?gt[Q]:Et[Q];if(j+=se&15,se>>>=4,!(se>>>8&255))z[b++]=se;else{if(se==256)break;se-=257;var ye=se<8?0:se-4>>2;ye>5&&(ye=0);var me=b+re[se];ye>0&&(me+=ct(D,j,ye),j+=ye),Q=ct(D,j,Y),se=V>>>1==1?Mt[Q]:Bt[Q],j+=se&15,se>>>=4;var xe=se<4?0:se-2>>1,pe=ee[se];for(xe>0&&(pe+=ct(D,j,xe),j+=xe),!U&&G<me&&(z=Cn(z,me+100),G=z.length);b<me;)z[b]=z[b-pe],++b}}}return U?[z,j+7>>>3]:[z.slice(0,b),j+7>>>3]}function ha(D,U){var j=D.slice(D.l||0),V=vu(j,U);return D.l+=V[1],V[0]}function _o(D,U){if(D)typeof console<"u"&&console.error(U);else throw new Error(U)}function Eo(D,U){var j=D;Wr(j,0);var V=[],z=[],b={FileIndex:V,FullPaths:z};S(b,{root:U.root});for(var G=j.length-4;(j[G]!=80||j[G+1]!=75||j[G+2]!=5||j[G+3]!=6)&&G>=0;)--G;j.l=G+4,j.l+=4;var J=j.read_shift(2);j.l+=6;var Y=j.read_shift(4);for(j.l=Y,G=0;G<J;++G){j.l+=20;var q=j.read_shift(4),Q=j.read_shift(4),se=j.read_shift(2),ye=j.read_shift(2),me=j.read_shift(2);j.l+=8;var xe=j.read_shift(4),pe=o(j.slice(j.l+se,j.l+se+ye));j.l+=se+ye+me;var Ce=j.l;j.l=xe+4,Ci(j,q,Q,b,pe),j.l=Ce}return b}function Ci(D,U,j,V,z){D.l+=2;var b=D.read_shift(2),G=D.read_shift(2),J=a(D);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var Y=D.read_shift(4),q=D.read_shift(4),Q=D.read_shift(4),se=D.read_shift(2),ye=D.read_shift(2),me="",xe=0;xe<se;++xe)me+=String.fromCharCode(D[D.l++]);if(ye){var pe=o(D.slice(D.l,D.l+ye));(pe[21589]||{}).mt&&(J=pe[21589].mt),((z||{})[21589]||{}).mt&&(J=z[21589].mt)}D.l+=ye;var Ce=D.slice(D.l,D.l+q);switch(G){case 8:Ce=K(D,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Oe=!1;b&8&&(Y=D.read_shift(4),Y==134695760&&(Y=D.read_shift(4),Oe=!0),q=D.read_shift(4),Q=D.read_shift(4)),q!=U&&_o(Oe,"Bad compressed size: "+U+" != "+q),Q!=j&&_o(Oe,"Bad uncompressed size: "+j+" != "+Q),yn(V,me,Ce,{unsafe:!0,mt:J})}function To(D,U){var j=U||{},V=[],z=[],b=fe(1),G=j.compression?8:0,J=0,Y=0,q=0,Q=0,se=0,ye=D.FullPaths[0],me=ye,xe=D.FileIndex[0],pe=[],Ce=0;for(Y=1;Y<D.FullPaths.length;++Y)if(me=D.FullPaths[Y].slice(ye.length),xe=D.FileIndex[Y],!(!xe.size||!xe.content||me=="Sh33tJ5")){var Oe=Q,qe=fe(me.length);for(q=0;q<me.length;++q)qe.write_shift(1,me.charCodeAt(q)&127);qe=qe.slice(0,qe.l),pe[se]=_L.buf(xe.content,0);var pt=xe.content;G==8&&(pt=X(pt)),b=fe(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,J),b.write_shift(2,G),xe.mt?i(b,xe.mt):b.write_shift(4,0),b.write_shift(-4,pe[se]),b.write_shift(4,pt.length),b.write_shift(4,xe.content.length),b.write_shift(2,qe.length),b.write_shift(2,0),Q+=b.length,V.push(b),Q+=qe.length,V.push(qe),Q+=pt.length,V.push(pt),b=fe(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,J),b.write_shift(2,G),b.write_shift(4,0),b.write_shift(-4,pe[se]),b.write_shift(4,pt.length),b.write_shift(4,xe.content.length),b.write_shift(2,qe.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,Oe),Ce+=b.l,z.push(b),Ce+=qe.length,z.push(qe),++se}return b=fe(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,se),b.write_shift(2,se),b.write_shift(4,Ce),b.write_shift(4,Q),b.write_shift(2,0),Fr([Fr(V),Fr(z),b])}var Rs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ps(D,U){if(D.ctype)return D.ctype;var j=D.name||"",V=j.match(/\.([^\.]+)$/);return V&&Rs[V[1]]||U&&(V=(j=U).match(/[\.\\]([^\.\\])+$/),V&&Rs[V[1]])?Rs[V[1]]:"application/octet-stream"}function ei(D){for(var U=Zf(D),j=[],V=0;V<U.length;V+=76)j.push(U.slice(V,V+76));return j.join(`\r
`)+`\r
`}function da(D){var U=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var Q=q.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],V=U.split(`\r
`),z=0;z<V.length;++z){var b=V[z];if(b.length==0){j.push("");continue}for(var G=0;G<b.length;){var J=76,Y=b.slice(G,G+J);Y.charAt(J-1)=="="?J--:Y.charAt(J-2)=="="?J-=2:Y.charAt(J-3)=="="&&(J-=3),Y=b.slice(G,G+J),G+=J,G<b.length&&(Y+="="),j.push(Y)}}return j.join(`\r
`)}function Rl(D){for(var U=[],j=0;j<D.length;++j){for(var V=D[j];j<=D.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+D[++j];U.push(V)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return Yn(U.join(`\r
`))}function Ii(D,U,j){for(var V="",z="",b="",G,J=0;J<10;++J){var Y=U[J];if(!Y||Y.match(/^\s*$/))break;var q=Y.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":V=q[2].trim();break;case"content-type":b=q[2].trim();break;case"content-transfer-encoding":z=q[2].trim();break}}switch(++J,z.toLowerCase()){case"base64":G=Yn(ns(U.slice(J).join("")));break;case"quoted-printable":G=Rl(U.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var Q=yn(D,V.slice(j.length),G,{unsafe:!0});b&&(Q.ctype=b)}function Pl(D,U){if(W(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=U&&U.root||"",V=(rt&&Buffer.isBuffer(D)?D.toString("binary"):W(D)).split(`\r
`),z=0,b="";for(z=0;z<V.length;++z)if(b=V[z],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),j||(j=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),b.slice(0,j.length)!=j););var G=(V[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var J="--"+(G[1]||""),Y=[],q=[],Q={FileIndex:Y,FullPaths:q};S(Q);var se,ye=0;for(z=0;z<V.length;++z){var me=V[z];me!==J&&me!==J+"--"||(ye++&&Ii(Q,V.slice(se,z),j),se=z)}return Q}function Cr(D,U){var j=U||{},V=j.boundary||"SheetJS";V="------="+V;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],b=D.FullPaths[0],G=b,J=D.FileIndex[0],Y=1;Y<D.FullPaths.length;++Y)if(G=D.FullPaths[Y].slice(b.length),J=D.FileIndex[Y],!(!J.size||!J.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var q=J.content,Q=rt&&Buffer.isBuffer(q)?q.toString("binary"):W(q),se=0,ye=Math.min(1024,Q.length),me=0,xe=0;xe<=ye;++xe)(me=Q.charCodeAt(xe))>=32&&me<128&&++se;var pe=se>=ye*4/5;z.push(V),z.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+G),z.push("Content-Transfer-Encoding: "+(pe?"quoted-printable":"base64")),z.push("Content-Type: "+Ps(J,G)),z.push(""),z.push(pe?da(Q):ei(Q))}return z.push(V+`--\r
`),z.join(`\r
`)}function Ni(D){var U={};return S(U,D),U}function yn(D,U,j,V){var z=V&&V.unsafe;z||S(D);var b=!z&&De.find(D,U);if(!b){var G=D.FullPaths[0];U.slice(0,G.length)==G?G=U:(G.slice(-1)!="/"&&(G+="/"),G=(G+U).replace("//","/")),b={name:s(U),type:2},D.FileIndex.push(b),D.FullPaths.push(G),z||De.utils.cfb_gc(D)}return b.content=j,b.size=j?j.length:0,V&&(V.CLSID&&(b.clsid=V.CLSID),V.mt&&(b.mt=V.mt),V.ct&&(b.ct=V.ct)),b}function ti(D,U){S(D);var j=De.find(D,U);if(j){for(var V=0;V<D.FileIndex.length;++V)if(D.FileIndex[V]==j)return D.FileIndex.splice(V,1),D.FullPaths.splice(V,1),!0}return!1}function wu(D,U,j){S(D);var V=De.find(D,U);if(V){for(var z=0;z<D.FileIndex.length;++z)if(D.FileIndex[z]==V)return D.FileIndex[z].name=s(j),D.FullPaths[z]=j,!0}return!1}function _u(D){A(D,!0)}return e.find=C,e.read=P,e.parse=u,e.write=ie,e.writeFile=Z,e.utils={cfb_new:Ni,cfb_add:yn,cfb_del:ti,cfb_mov:wu,cfb_gc:_u,ReadShift:uf,CheckField:B4,prep_blob:Wr,bconcat:Fr,use_zlib:L,_deflateRaw:ze,_inflateRaw:ha,consts:he},e}();function EL(t){return typeof t=="string"?ip(t):Array.isArray(t)?K5(t):t}function Lh(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=ip(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ui(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([EL(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ho(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function TL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function tr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function OE(t,e){for(var r=[],n=tr(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function op(t){for(var e=[],r=tr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function lp(t){for(var e=[],r=tr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function SL(t){for(var e=[],r=tr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var lm=new Date(1899,11,30,0,0,0);function kr(t,e){var r=t.getTime(),n=lm.getTime()+(t.getTimezoneOffset()-lm.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var v4=new Date,AL=lm.getTime()+(v4.getTimezoneOffset()-lm.getTimezoneOffset())*6e4,LE=v4.getTimezoneOffset();function cp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+AL),e.getTimezoneOffset()!==LE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-LE)*6e4),e}function kL(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var ME=new Date("2017-02-19T19:06:09.000Z"),w4=isNaN(ME.getFullYear())?new Date("2/19/17"):ME,bL=w4.getFullYear()==2017;function Ot(t,e){var r=new Date(t);if(bL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(w4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function nl(t,e){if(rt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ui(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ui(o4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ui(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ui(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Lt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Lt(t[r]));return e}function Zt(t,e){for(var r="";r.length<e;)r+=t;return r}function qs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var CL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&CL.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var IL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function _4(t){return t?t.content&&t.type?nl(t.content,!0):t.data?Hu(t.data):t.asNodeBuffer&&rt?Hu(t.asNodeBuffer().toString("binary")):t.asBinary?Hu(t.asBinary()):t._data&&t._data.getContent?Hu(nl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function E4(t){if(!t)return null;if(t.data)return AE(t.data);if(t.asNodeBuffer&&rt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?AE(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function NL(t){return t&&t.name.slice(-4)===".bin"?E4(t):_4(t)}function hs(t,e){for(var r=t.FullPaths||tr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Av(t,e){var r=hs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function dr(t,e,r){if(!r)return NL(Av(t,e));if(!e)return null;try{return dr(t,e)}catch{return null}}function Qn(t,e,r){if(!r)return _4(Av(t,e));if(!e)return null;try{return Qn(t,e)}catch{return null}}function RL(t,e,r){return E4(Av(t,e))}function jE(t){for(var e=t.FullPaths||tr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ze(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return rt?n=aa(r):n=X5(r),De.utils.cfb_add(t,e,n)}De.utils.cfb_add(t,e,r)}else t.file(e,r)}function kv(){return De.utils.cfb_new()}function T4(t,e){switch(e.type){case"base64":return De.read(t,{type:"base64"});case"binary":return De.read(t,{type:"binary"});case"buffer":case"array":return De.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Gu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var cr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,PL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,VE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,DL=/<[^>]*>/g,xn=cr.match(VE)?VE:DL,FL=/<\w*:/,OL=/<(\/?)\w+:/;function $e(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(PL),o=0,l="",c=0,u="",h="",m=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(m=(s=h.charCodeAt(i+1))==34||s==39?1:0,l=h.slice(i+1+m,h.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function ki(t){return t.replace(OL,"<$1")}var S4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bv=op(S4),ft=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return S4[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),Cv=/[&<>'"]/g,LL=/[\u0000-\u0008\u000b-\u001f]/g;function wt(t){var e=t+"";return e.replace(Cv,function(r){return bv[r]}).replace(LL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function BE(t){return wt(t).replace(/ /g,"_x0020_")}var A4=/[\u0000-\u001f]/g;function Iv(t){var e=t+"";return e.replace(Cv,function(r){return bv[r]}).replace(/\n/g,"<br/>").replace(A4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ML(t){var e=t+"";return e.replace(Cv,function(r){return bv[r]}).replace(A4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var UE=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function jL(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Rt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ag(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function $E(t){var e=Ya(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function zE(t){return aa(t,"binary").toString("utf8")}var Vd="foo bar baz",Tt=rt&&(zE(Vd)==Ag(Vd)&&zE||$E(Vd)==Ag(Vd)&&$E)||Ag,ui=rt?function(t){return aa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},th=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),k4=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),VL=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),BL=/<\/?(?:vt:)?variant>/g,UL=/<(?:vt:)([^>]*)>([\s\S]*)</;function HE(t,e){var r=$e(t),n=t.match(VL(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(BL,"").match(UL);a&&s.push({v:Tt(a[2]),t:a[1]})}),s}var b4=/(^\s|\s$|\n)/;function Gr(t,e){return"<"+t+(e.match(b4)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function rh(t){return tr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Se(t,e,r){return"<"+t+(r!=null?rh(r):"")+(e!=null?(e.match(b4)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function d1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function $L(t,e){switch(typeof t){case"string":var r=Se("vt:lpwstr",wt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Se((t|0)==t?"vt:i4":"vt:r8",wt(String(t)));case"boolean":return Se("vt:bool",t?"true":"false")}if(t instanceof Date)return Se("vt:filetime",d1(t));throw new Error("Unable to serialize "+t)}function Nv(t){if(rt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Tt(ho(Ev(t)));throw new Error("Bad input format: expected Buffer or string")}var nh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Tr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function zL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function HL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var WE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},GE=rt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:aa(e)})):WE(t)}:WE,qE=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Vi(t,s)));return n.join("").replace(Sn,"")},Rv=rt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Sn,""):qE(t,e,r)}:qE,KE=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},C4=rt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):KE(t,e,r)}:KE,XE=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode($l(t,s)));return n.join("")},Mh=rt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):XE(e,r,n)}:XE,I4=function(t,e){var r=Xn(t,e);return r>0?Mh(t,e+4,e+4+r-1):""},N4=I4,R4=function(t,e){var r=Xn(t,e);return r>0?Mh(t,e+4,e+4+r-1):""},P4=R4,D4=function(t,e){var r=2*Xn(t,e);return r>0?Mh(t,e+4,e+4+r-1):""},F4=D4,O4=function(e,r){var n=Xn(e,r);return n>0?Rv(e,r+4,r+4+n):""},L4=O4,M4=function(t,e){var r=Xn(t,e);return r>0?Mh(t,e+4,e+4+r):""},j4=M4,V4=function(t,e){return zL(t,e)},cm=V4,Pv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};rt&&(N4=function(e,r){if(!Buffer.isBuffer(e))return I4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},P4=function(e,r){if(!Buffer.isBuffer(e))return R4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},F4=function(e,r){if(!Buffer.isBuffer(e))return D4(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},L4=function(e,r){if(!Buffer.isBuffer(e))return O4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},j4=function(e,r){if(!Buffer.isBuffer(e))return M4(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},cm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):V4(e,r)},Pv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var $l=function(t,e){return t[e]},Vi=function(t,e){return t[e+1]*256+t[e]},WL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Xn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ro=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},GL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function uf(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Vi(this,c)),c+=2;t*=2;break;case"utf8":r=Mh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Rv(this,this.l,this.l+t);break;case"wstr":return uf.call(this,t,"dbcs");case"lpstr-ansi":r=N4(this,this.l),t=4+Xn(this,this.l);break;case"lpstr-cp":r=P4(this,this.l),t=4+Xn(this,this.l);break;case"lpwstr":r=F4(this,this.l),t=4+2*Xn(this,this.l);break;case"lpp4":t=4+Xn(this,this.l),r=L4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Xn(this,this.l),r=j4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=$l(this,this.l+t++))!==0;)i.push(jd(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Vi(this,this.l+t))!==0;)i.push(jd(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=$l(this,c),this.l=c+1,o=uf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(jd(Vi(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=$l(this,c),this.l=c+1,o=uf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(jd($l(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=$l(this,this.l),this.l++,n;case 2:return n=(e==="i"?WL:Vi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Ro:GL)(this,this.l),this.l+=4,n):(s=Xn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=cm(this,this.l):s=cm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=C4(this,this.l,t);break}}return this.l+=t,r}var qL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},KL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},XL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function YL(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)XL(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,qL(this,e,this.l);break;case 8:if(n=8,r==="f"){HL(this,e,this.l);break}case 16:break;case-4:n=4,KL(this,e,this.l);break}return this.l+=n,this}function B4(t,e){var r=C4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Wr(t,e){t.l=e,t.read_shift=uf,t.chk=B4,t.write_shift=YL}function pn(t,e){t.l+=e}function fe(t){var e=Ya(t);return Wr(e,0),e}function oa(t,e,r){if(t){var n,s,i;Wr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=ch[o]||ch[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function Un(){var t=[],e=rt?256:2048,r=function(c){var u=fe(c);return Wr(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Fr(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Ee(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=ch[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=t.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Pv(r)&&t.push(r)}}function ff(t,e,r){var n=Lt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function YE(t,e,r){var n=Lt(t);return n.s=ff(n.s,e.s,r),n.e=ff(n.e,e.s,r),n}function hf(t,e){if(t.cRel&&t.c<0)for(t=Lt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Lt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=je(t);return!t.cRel&&t.cRel!=null&&(r=ZL(r)),!t.rRel&&t.rRel!=null&&(r=QL(r)),r}function kg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+zt(t.s.c)+":"+(t.e.cRel?"":"$")+zt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+lr(t.s.r)+":"+(t.e.rRel?"":"$")+lr(t.e.r):hf(t.s,e.biff)+":"+hf(t.e,e.biff)}function Dv(t){return parseInt(JL(t),10)-1}function lr(t){return""+(t+1)}function QL(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function JL(t){return t.replace(/\$(\d+)$/,"$1")}function Fv(t){for(var e=eM(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function zt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function ZL(t){return t.replace(/^([A-Z])/,"$$$1")}function eM(t){return t.replace(/^\$([A-Z])/,"$1")}function tM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function je(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function zn(t){var e=t.indexOf(":");return e==-1?{s:Ht(t),e:Ht(t)}:{s:Ht(t.slice(0,e)),e:Ht(t.slice(e+1))}}function Qe(t,e){return typeof e>"u"||typeof e=="number"?Qe(t.s,t.e):(typeof t!="string"&&(t=je(t)),typeof e!="string"&&(e=je(e)),t==e?t:t+":"+e)}function ht(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function QE(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Cs(t.z,r?kr(e):e)}catch{}try{return t.w=Cs((t.XF||{}).numFmtId||(r?14:0),r?kr(e):e)}catch{return""+e}}function Ji(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?la[t.v]||t.v:e==null?QE(t,t.v):QE(t,e))}function mo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function U4(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Ht(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=ht(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[h].length;++m)if(!(typeof e[h][m]>"u")){var p={v:e[h][m]},x=a+h,g=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),e[h][m]&&typeof e[h][m]=="object"&&!Array.isArray(e[h][m])&&!(e[h][m]instanceof Date))p=e[h][m];else if(Array.isArray(p.v)&&(p.f=e[h][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Me[14],n.cellDates?(p.t="d",p.w=Cs(p.z,kr(p.v))):(p.t="n",p.v=kr(p.v),p.w=Cs(p.z,p.v))):p.t="s";if(s)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(p.z=i[x][g].z),i[x][g]=p;else{var v=je({c:g,r:x});i[v]&&i[v].z&&(p.z=i[v].z),i[v]=p}}}return c.s.c<1e7&&(i["!ref"]=Qe(c)),i}function iu(t,e){return U4(null,t,e)}function rM(t){return t.read_shift(4,"i")}function Ks(t,e){return e||(e=fe(4)),e.write_shift(4,t),e}function dn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Or(t,e){var r=!1;return e==null&&(r=!0,e=fe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function nM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function sM(t,e){return e||(e=fe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Ov(t,e){var r=t.l,n=t.read_shift(1),s=dn(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(nM(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function iM(t,e){var r=!1;return e==null&&(r=!0,e=fe(15+4*t.t.length)),e.write_shift(1,0),Or(t.t,e),r?e.slice(0,e.l):e}var aM=Ov;function oM(t,e){var r=!1;return e==null&&(r=!0,e=fe(23+4*t.t.length)),e.write_shift(1,1),Or(t.t,e),e.write_shift(4,1),sM({},e),r?e.slice(0,e.l):e}function Ns(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function vl(t,e){return e==null&&(e=fe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function wl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function _l(t,e){return e==null&&(e=fe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var lM=dn,$4=Or;function Lv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function um(t,e){var r=!1;return e==null&&(r=!0,e=fe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var cM=dn,m1=Lv,Mv=um;function jv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?cm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ro(e,0)>>2;return r?s/100:s}function z4(t,e){e==null&&(e=fe(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function H4(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function uM(t,e){return e||(e=fe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var El=H4,au=uM;function fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function sl(t,e){return(e||fe(8)).write_shift(8,t,"f")}function fM(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=zo[s];c&&(e.rgb=ih(c));break;case 2:e.rgb=ih([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function fm(t,e){if(e||(e=fe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function hM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function dM(t,e){e||(e=fe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function W4(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function mM(t){return W4(t,1)}function pM(t){return W4(t,2)}var Vv=2,Rn=3,Bd=11,JE=12,hm=19,Ud=64,gM=65,xM=71,yM=4108,vM=4126,Ir=80,G4=81,wM=[Ir,G4],p1={1:{n:"CodePage",t:Vv},2:{n:"Category",t:Ir},3:{n:"PresentationFormat",t:Ir},4:{n:"ByteCount",t:Rn},5:{n:"LineCount",t:Rn},6:{n:"ParagraphCount",t:Rn},7:{n:"SlideCount",t:Rn},8:{n:"NoteCount",t:Rn},9:{n:"HiddenCount",t:Rn},10:{n:"MultimediaClipCount",t:Rn},11:{n:"ScaleCrop",t:Bd},12:{n:"HeadingPairs",t:yM},13:{n:"TitlesOfParts",t:vM},14:{n:"Manager",t:Ir},15:{n:"Company",t:Ir},16:{n:"LinksUpToDate",t:Bd},17:{n:"CharacterCount",t:Rn},19:{n:"SharedDoc",t:Bd},22:{n:"HyperlinksChanged",t:Bd},23:{n:"AppVersion",t:Rn,p:"version"},24:{n:"DigSig",t:gM},26:{n:"ContentType",t:Ir},27:{n:"ContentStatus",t:Ir},28:{n:"Language",t:Ir},29:{n:"Version",t:Ir},255:{},2147483648:{n:"Locale",t:hm},2147483651:{n:"Behavior",t:hm},1919054434:{}},g1={1:{n:"CodePage",t:Vv},2:{n:"Title",t:Ir},3:{n:"Subject",t:Ir},4:{n:"Author",t:Ir},5:{n:"Keywords",t:Ir},6:{n:"Comments",t:Ir},7:{n:"Template",t:Ir},8:{n:"LastAuthor",t:Ir},9:{n:"RevNumber",t:Ir},10:{n:"EditTime",t:Ud},11:{n:"LastPrinted",t:Ud},12:{n:"CreatedDate",t:Ud},13:{n:"ModifiedDate",t:Ud},14:{n:"PageCount",t:Rn},15:{n:"WordCount",t:Rn},16:{n:"CharCount",t:Rn},17:{n:"Thumbnail",t:xM},18:{n:"Application",t:Ir},19:{n:"DocSecurity",t:Rn},255:{},2147483648:{n:"Locale",t:hm},2147483651:{n:"Behavior",t:hm},1919054434:{}},ZE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_M=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function EM(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var TM=EM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zo=Lt(TM),la={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},q4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},x1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$d={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Bv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function SM(t){var e=Bv();if(!t||!t.match)return e;var r={};if((t.match(xn)||[]).forEach(function(n){var s=$e(n);switch(s[0].replace(FL,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[x1[s.ContentType]]!==void 0&&e[x1[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Tr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function K4(t,e){var r=SL(x1),n=[],s;n[n.length]=cr,n[n.length]=Se("Types",null,{xmlns:Tr.CT,"xmlns:xsd":Tr.xsd,"xmlns:xsi":Tr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Se("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=Se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:$d[l][e.bookType]||$d[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:$d[l][e.bookType]||$d[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sh(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function df(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(xn)||[]).forEach(function(s){var i=$e(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Gu(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}function _c(t){var e=[cr,Se("Relationships",null,{xmlns:Tr.RELS})];return tr(t["!id"]).forEach(function(r){e[e.length]=Se("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function vt(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var AM="application/vnd.oasis.opendocument.spreadsheet";function kM(t,e){for(var r=Nv(t),n,s;n=nh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=$e(n[0],!1),s.path=="/"&&s.type!==AM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function bM(t){var e=[cr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function eT(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function CM(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function IM(t){var e=[cr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(eT(t[r][0],t[r][1])),e.push(CM("",t[r][0]));return e.push(eT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function X4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+sm.version+"</meta:generator></office:meta></office:document-meta>"}var Ts=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],NM=function(){for(var t=new Array(Ts.length),e=0;e<Ts.length;++e){var r=Ts[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Y4(t){var e={};t=Tt(t);for(var r=0;r<Ts.length;++r){var n=Ts[r],s=t.match(NM[r]);s!=null&&s.length>0&&(e[n[1]]=ft(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Ot(e[n[1]]))}return e}function bg(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=wt(e),n[n.length]=r?Se(t,e,r):Gr(t,e))}function Q4(t,e){var r=e||{},n=[cr,Se("cp:coreProperties",null,{"xmlns:cp":Tr.CORE_PROPS,"xmlns:dc":Tr.dc,"xmlns:dcterms":Tr.dcterms,"xmlns:dcmitype":Tr.dcmitype,"xmlns:xsi":Tr.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&bg("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:d1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&bg("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:d1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Ts.length;++i){var a=Ts[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&bg(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ho=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],J4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Z4(t,e,r,n){var s=[];if(typeof t=="string")s=HE(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?HE(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function RM(t,e,r){var n={};return e||(e={}),t=Tt(t),Ho.forEach(function(s){var i=(t.match(th(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=ft(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Z4(n.HeadingPairs,n.TitlesOfParts,e,r),e}function eI(t){var e=[],r=Se;return t||(t={}),t.Application="SheetJS",e[e.length]=cr,e[e.length]=Se("Properties",null,{xmlns:Tr.EXT_PROPS,"xmlns:vt":Tr.vt}),Ho.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=wt(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+wt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var PM=/<[^>]+>[^<]*/g;function DM(t,e){var r={},n="",s=t.match(PM);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=$e(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ft(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ft(u);break;case"bool":r[n]=Rt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ot(u);break;case"cy":case"error":r[n]=ft(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function tI(t){var e=[cr,Se("Properties",null,{xmlns:Tr.CUST_PROPS,"xmlns:vt":Tr.vt})];if(!t)return e.join("");var r=1;return tr(t).forEach(function(s){++r,e[e.length]=Se("property",$L(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var y1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Cg;function FM(t,e,r){Cg||(Cg=op(y1)),e=Cg[e]||e,t[e]=r}function OM(t,e){var r=[];return tr(y1).map(function(n){for(var s=0;s<Ts.length;++s)if(Ts[s][1]==n)return Ts[s];for(s=0;s<Ho.length;++s)if(Ho[s][1]==n)return Ho[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Gr(y1[n[1]]||n[1],s))}}),Se("DocumentProperties",r.join(""),{xmlns:Kn.o})}function LM(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&tr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var a=0;a<Ts.length;++a)if(i==Ts[a][1])return;for(a=0;a<Ho.length;++a)if(i==Ho[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(Se(BE(i),o,{"dt:dt":l}))}}),e&&tr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var a=e[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(Se(BE(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Kn.o+'">'+s.join("")+"</"+n+">"}function Uv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function MM(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=fe(8);return a.write_shift(4,n),a.write_shift(4,s),a}function rI(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function nI(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function sI(t,e,r){return e===31?nI(t):rI(t,e,r)}function v1(t,e,r){return sI(t,e,r===!1?0:4)}function jM(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return sI(t,e,0)}function VM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Sn,""),t.l-s&2&&(t.l+=2)}return r}function BM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Sn,"");return r}function UM(t){var e=t.l,r=dm(t,G4);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=dm(t,Rn);return[r,n]}function $M(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(UM(t));return r}function tT(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Sn,"").replace(Wu,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function iI(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function zM(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function dm(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==JE&&n!==e&&wM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===JE?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return rI(t,n,4).replace(Sn,"");case 31:return nI(t);case 64:return Uv(t);case 65:return iI(t);case 71:return zM(t);case 80:return v1(t,n,!i.raw).replace(Sn,"");case 81:return jM(t,n).replace(Sn,"");case 4108:return $M(t);case 4126:case 4127:return n==4127?VM(t):BM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function rT(t,e){var r=fe(4),n=fe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=fe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=MM(e);break;case 31:case 80:for(n=fe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Fr([r,n])}function nT(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),h=t.read_shift(4);i[a]=[u,h+r]}i.sort(function(w,y){return w[1]-y[1]});var m={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var x=e[i[a][0]];if(m[x.n]=dm(t,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$s(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(i[a][0]===1){if(o=m.CodePage=dm(t,Vv),$s(o),l!==-1){var g=t.l;t.l=i[l][1],c=tT(t,o),t.l=g}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=tT(t,o)}else{var v=c[i[a][0]],_;switch(t[t.l]){case 65:t.l+=4,_=iI(t);break;case 30:t.l+=4,_=v1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,_=v1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,_=t.read_shift(4,"i");break;case 19:t.l+=4,_=t.read_shift(4);break;case 5:t.l+=4,_=t.read_shift(8,"f");break;case 11:t.l+=4,_=rr(t,4);break;case 64:t.l+=4,_=Ot(Uv(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[v]=_}}return t.l=r+n,m}var aI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function HM(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function sT(t,e,r){var n=fe(8),s=[],i=[],a=8,o=0,l=fe(8),c=fe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),s.push(c),a+=8+l.length,!e){c=fe(8),c.write_shift(4,0),s.unshift(c);var u=[fe(4)];for(u[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=fe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Fr(u),i.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(aI.indexOf(t[o][0])>-1||J4.indexOf(t[o][0])>-1)&&t[o][1]!=null){var m=t[o][1],p=0;if(e){p=+e[t[o][0]];var x=r[p];if(x.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}l=rT(x.t,m)}else{var v=HM(m);v==-1&&(v=31,m=String(m)),l=rT(v,m)}i.push(l),c=fe(8),c.write_shift(4,e?p:2+o),s.push(c),a+=8+l.length}var _=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,_),_+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),Fr([n].concat(s).concat(i))}function iT(t,e,r){var n=t.content;if(!n)return{};Wr(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==De.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=nT(n,e),m={SystemIdentifier:c};for(var p in h)m[p]=h[p];if(m.FMTID=i,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=nT(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[i,a],m}function aT(t,e,r,n,s,i){var a=fe(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,De.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,s?68:48);var l=sT(t,r,n);if(o.push(l),s){var c=sT(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Fr(o)}function ya(t,e){return t.read_shift(e),null}function WM(t,e){e||(e=fe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function GM(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function rr(t,e){return t.read_shift(e)===1}function _n(t,e){return e||(e=fe(2)),e.write_shift(2,+!!t),e}function mr(t){return t.read_shift(2,"u")}function ds(t,e){return e||(e=fe(2)),e.write_shift(2,t),e}function oI(t,e){return GM(t,e,mr)}function qM(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function lI(t,e,r){return r||(r=fe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function jh(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function KM(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function XM(t){var e=t.t||"",r=fe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=fe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return Fr(s)}function il(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Vh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):il(t,n,r)}function Tl(t,e,r){if(r.biff>5)return Vh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function cI(t,e,r){return r||(r=fe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function YM(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function QM(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(t.l+=24),s}function JM(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Sn,"");return r+a}function ZM(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return QM(t);case"0303000000000000c000000000000046":return JM(t);default:throw new Error("Unsupported Moniker "+r)}}function zd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Sn,""):"";return r}function oT(t,e){e||(e=fe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function e8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,h;s&16&&(i=zd(t,r-t.l)),s&128&&(a=zd(t,r-t.l)),(s&257)===257&&(o=zd(t,r-t.l)),(s&257)===1&&(l=ZM(t,r-t.l)),s&8&&(c=zd(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(h=Uv(t)),t.l=r;var m=a||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return u&&(p.guid=u),h&&(p.time=h),i&&(p.Tooltip=i),p}function t8(t){var e=fe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(i==28)n=n.slice(1),oT(n,e);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),i&8&&oT(s>-1?n.slice(s+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function uI(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function fI(t,e){var r=uI(t);return r[3]=0,r}function bi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function al(t,e,r,n){return n||(n=fe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function r8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function n8(t,e,r){return e===0?"":Tl(t,e,r)}function s8(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function hI(t){var e=t.read_shift(2),r=jv(t);return[e,r]}function i8(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=jh(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function up(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function dI(t,e){return e||(e=fe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function mI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var a8=mI;function pI(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function o8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function l8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function rn(t){t.l+=2,t.l+=t.read_shift(2)}var c8={0:rn,4:rn,5:rn,6:rn,7:l8,8:rn,9:rn,10:rn,11:rn,12:rn,13:o8,14:rn,15:rn,16:rn,17:rn,18:rn,19:rn,20:rn,21:pI};function u8(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(c8[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Hd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function $v(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=fe(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function f8(t,e){return e===0||t.read_shift(2),1200}function h8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Tl(t,0,r);return t.read_shift(e+n-t.l),s}function d8(t,e){var r=!e||e.biff==8,n=fe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function m8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function p8(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=jh(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function g8(t,e){var r=!e||e.biff>=8?2:1,n=fe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function x8(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(KM(t));return i.Count=n,i.Unique=s,i}function y8(t,e){var r=fe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=XM(t[s]);var i=Fr([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function v8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function w8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function _8(t){var e=r8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function E8(t){return t.read_shift(2),t.read_shift(4)}function lT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function T8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function S8(){var t=fe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function A8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function k8(t){var e=fe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function b8(){}function C8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=jh(t,0,r),n}function I8(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=fe(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function N8(t){var e=bi(t);return e.isst=t.read_shift(4),e}function R8(t,e,r,n){var s=fe(10);return al(t,e,n,s),s.write_shift(4,r),s}function P8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=bi(t);r.biff==2&&t.l++;var i=Vh(t,n-t.l,r);return s.val=i,s}function D8(t,e,r,n,s){var i=!s||s.biff==8,a=fe(8+ +i+(1+i)*r.length);return al(t,e,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function F8(t,e,r){var n=t.read_shift(2),s=Tl(t,0,r);return[n,s]}function O8(t,e,r,n){var s=r&&r.biff==5;n||(n=fe(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var L8=Tl;function cT(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function M8(t,e){var r=e.biff==8||!e.biff?4:2,n=fe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function j8(t){var e=t.read_shift(2),r=t.read_shift(2),n=hI(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function V8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(hI(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function B8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function U8(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=_M[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function $8(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=U8(t,e,n.fStyle,r),n}function uT(t,e,r,n){var s=r&&r.biff==5;n||(n=fe(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function z8(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function H8(t){var e=fe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function fT(t,e,r){var n=bi(t);(r.biff==2||e==9)&&++t.l;var s=qM(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function W8(t,e,r,n,s,i){var a=fe(8);return al(t,e,n,a),lI(r,i,a),a}function G8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=bi(t),s=fn(t);return n.val=s,n}function q8(t,e,r,n){var s=fe(14);return al(t,e,n,s),sl(r,s),s}var hT=n8;function K8(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=il(t,i),o=[];n>t.l;)o.push(Vh(t));return[i,s,a,o]}function dT(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=i8(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var X8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mT(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=il(t,a,r);s&32&&(c=X8[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:u7(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function gI(t,e,r){if(r.biff<8)return Y8(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(s8(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Y8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=jh(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Q8(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=il(t,n,r),a=il(t,s,r);return[i,a]}function J8(t,e,r){var n=mI(t);t.l++;var s=t.read_shift(1);return e-=8,[f7(t,e,r),s,n]}function pT(t,e,r){var n=a8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,l7(t,e,r)]}function Z8(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function ej(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function tj(t,e,r){return ej(t,e,r)}function rj(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(up(t));return r}function nj(t){var e=fe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)dI(t[r],e);return e}function sj(t,e,r){if(r&&r.biff<8)return aj(t,e,r);var n=pI(t),s=u8(t,e-22,n[1]);return{cmo:n,ft:s}}var ij={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function aj(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((ij[n]||pn)(t,e,r)),{cmo:[s,n,i],ft:a}}function oj(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=YM(t,6,r);var o=t.read_shift(2);t.read_shift(2),mr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=il(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function lj(t,e){var r=up(t);t.l+=16;var n=e8(t,e-24);return[r,n]}function cj(t){var e=fe(24),r=Ht(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return Fr([e,t8(t[1])])}function uj(t,e){t.read_shift(2);var r=up(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[r,n]}function fj(t){var e=t[1].Tooltip,r=fe(10+2*(e.length+1));r.write_shift(2,2048);var n=Ht(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function hj(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ZE[r]||r,r=t.read_shift(2),e[1]=ZE[r]||r,e}function dj(t){return t||(t=fe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function mj(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fI(t));return r}function pj(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(fI(t));return r}function gj(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function xI(t,e,r){if(!r.cellStyles)return pn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function xj(t,e){var r=fe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function yj(t,e){var r={};return e<32||(t.l+=16,r.header=fn(t),r.footer=fn(t),t.l+=2),r}function vj(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function wj(t){for(var e=fe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var _j=bi,Ej=oI,Tj=Vh;function Sj(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function Aj(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=bi(t);++t.l;var s=Tl(t,e-7,r);return n.t="str",n.val=s,n}function kj(t){var e=bi(t);++t.l;var r=fn(t);return e.t="n",e.val=r,e}function bj(t,e,r){var n=fe(15);return zh(n,t,e),n.write_shift(8,r,"f"),n}function Cj(t){var e=bi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Ij(t,e,r){var n=fe(9);return zh(n,t,e),n.write_shift(2,r),n}function Nj(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Rj(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Pj(t,e,r){var n=t.l+e,s=bi(t),i=t.read_shift(2),a=il(t,i,r);return t.l=n,s.t="str",s.val=a,s}var Dj=[2,3,48,49,131,139,140,245],w1=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=op({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Ya(1);switch(l.type){case"base64":u=Yn(ns(o));break;case"binary":u=Yn(o);break;case"buffer":case"array":u=o;break}Wr(u,0);var h=u.read_shift(1),m=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,v=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(v=u.read_shift(2));var _=u.read_shift(2),w=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=t[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var y=[],I={},O=Math.min(u.length,h==2?521:v-10-(p?264:0)),P=x?32:11;u.l<O&&u[u.l]!=13;)switch(I={},I.name=Jf.utils.decode(w,u.slice(u.l,u.l+P)).replace(/[\u0000\r\n].*$/g,""),u.l+=P,I.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(I.offset=u.read_shift(4)),I.len=u.read_shift(1),h==2&&(I.offset=u.read_shift(2)),I.dec=u.read_shift(1),I.name.length&&y.push(I),h!=2&&(u.l+=x?13:14),I.type){case"B":(!p||I.len!=8)&&l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var S=0,E=0;for(c[0]=[],E=0;E!=y.length;++E)c[0][E]=y[E].name;for(;g-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,c[++S]=[],E=0,E=0;E!=y.length;++E){var A=u.slice(u.l,u.l+y[E].len);u.l+=y[E].len,Wr(A,0);var N=Jf.utils.decode(w,A);switch(y[E].type){case"C":N.trim().length&&(c[S][E]=N.replace(/\s+$/,""));break;case"D":N.length===8?c[S][E]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):c[S][E]=N;break;case"F":c[S][E]=parseFloat(N.trim());break;case"+":case"I":c[S][E]=x?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":c[S][E]=!0;break;case"N":case"F":c[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[S][E]="##MEMO##"+(x?parseInt(N.trim(),10):A.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(c[S][E]=+N||0);break;case"@":c[S][E]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[S][E]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[S][E]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][E]=-A.read_shift(-8,"f");break;case"B":if(p&&y[E].len==8){c[S][E]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=iu(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return mo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&$s(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Un(),h=gm(o,{header:1,raw:!0,cellDates:!0}),m=h[0],p=h.slice(1),x=o["!cols"]||[],g=0,v=0,_=0,w=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++_;continue}if(m[g]!=null){if(++_,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(v=0;v<1024;++v)if(m.indexOf(m[g]+"_"+v)==-1){m[g]+="_"+v;break}}}}var y=ht(o["!ref"]),I=[],O=[],P=[];for(g=0;g<=y.e.c-y.s.c;++g){var S="",E="",A=0,N=[];for(v=0;v<p.length;++v)p[v][g]!=null&&N.push(p[v][g]);if(N.length==0||m[g]==null){I[g]="?";continue}for(v=0;v<N.length;++v){switch(typeof N[v]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=N[v]instanceof Date?"D":"C";break;default:E="C"}A=Math.max(A,String(N[v]).length),S=S&&S!=E?"C":E}A>250&&(A=250),E=((x[g]||{}).DBF||{}).type,E=="C"&&x[g].DBF.len>A&&(A=x[g].DBF.len),S=="B"&&E=="N"&&(S="N",P[g]=x[g].DBF.dec,A=x[g].DBF.len),O[g]=S=="C"||E=="N"?A:i[S]||0,w+=O[g],I[g]=S}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*_),C.write_shift(2,w),g=0;g<4;++g)C.write_shift(4,0);for(C.write_shift(4,0|(+e[a4]||3)<<8),g=0,v=0;g<m.length;++g)if(m[g]!=null){var R=u.next(32),F=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,F,"sbcs"),R.write_shift(1,I[g]=="?"?"C":I[g],"sbcs"),R.write_shift(4,v),R.write_shift(1,O[g]||i[I[g]]||0),R.write_shift(1,P[g]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),v+=O[g]||i[I[g]]||0}var oe=u.next(264);for(oe.write_shift(4,13),g=0;g<65;++g)oe.write_shift(4,0);for(g=0;g<p.length;++g){var ae=u.next(w);for(ae.write_shift(1,0),v=0;v<m.length;++v)if(m[v]!=null)switch(I[v]){case"L":ae.write_shift(1,p[g][v]==null?63:p[g][v]?84:70);break;case"B":ae.write_shift(8,p[g][v]||0,"f");break;case"N":var ve="0";for(typeof p[g][v]=="number"&&(ve=p[g][v].toFixed(P[v]||0)),_=0;_<O[v]-ve.length;++_)ae.write_shift(1,32);ae.write_shift(1,ve,"sbcs");break;case"D":p[g][v]?(ae.write_shift(4,("0000"+p[g][v].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(p[g][v].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+p[g][v].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var he=String(p[g][v]!=null?p[g][v]:"").slice(0,O[v]);for(ae.write_shift(1,he,"sbcs"),_=0;_<O[v]-he.length;++_)ae.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),yI=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+tr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=t[p];return typeof x=="number"?kE(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:kE(g)};t["|"]=254;function s(m,p){switch(p.type){case"base64":return i(ns(m),p);case"binary":return i(m,p);case"buffer":return i(rt&&Buffer.isBuffer(m)?m.toString("binary"):ho(m),p);case"array":return i(nl(m),p)}throw new Error("Unrecognized type "+p.type)}function i(m,p){var x=m.split(/[\n\r]+/),g=-1,v=-1,_=0,w=0,y=[],I=[],O=null,P={},S=[],E=[],A=[],N=0,C;for(+p.codepage>=0&&$s(+p.codepage);_!==x.length;++_){N=0;var R=x[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=R.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),oe=F[0],ae;if(R.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&I.push(R.slice(3).replace(/;;/g,";"));break;case"C":var ve=!1,he=!1,Z=!1,W=!1,ie=-1,ue=-1;for(w=1;w<F.length;++w)switch(F[w].charAt(0)){case"A":break;case"X":v=parseInt(F[w].slice(1))-1,he=!0;break;case"Y":for(g=parseInt(F[w].slice(1))-1,he||(v=0),C=y.length;C<=g;++C)y[C]=[];break;case"K":ae=F[w].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(qs(ae))?isNaN(Uc(ae).getDate())||(ae=Ot(ae)):(ae=qs(ae),O!==null&&nu(O)&&(ae=cp(ae))),ve=!0;break;case"E":W=!0;var L=Ec(F[w].slice(1),{r:g,c:v});y[g][v]=[y[g][v],L];break;case"S":Z=!0,y[g][v]=[y[g][v],"S5S"];break;case"G":break;case"R":ie=parseInt(F[w].slice(1))-1;break;case"C":ue=parseInt(F[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(ve&&(y[g][v]&&y[g][v].length==2?y[g][v][0]=ae:y[g][v]=ae,O=null),Z){if(W)throw new Error("SYLK shared formula cannot have own formula");var K=ie>-1&&y[ie][ue];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");y[g][v][1]=LI(K[1],{r:g-ie,c:v-ue})}break;case"F":var X=0;for(w=1;w<F.length;++w)switch(F[w].charAt(0)){case"X":v=parseInt(F[w].slice(1))-1,++X;break;case"Y":for(g=parseInt(F[w].slice(1))-1,C=y.length;C<=g;++C)y[C]=[];break;case"M":N=parseInt(F[w].slice(1))/20;break;case"F":break;case"G":break;case"P":O=I[parseInt(F[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=F[w].slice(1).split(" "),C=parseInt(A[0],10);C<=parseInt(A[1],10);++C)N=parseInt(A[2],10),E[C-1]=N===0?{hidden:!0}:{wch:N},Qa(E[C-1]);break;case"C":v=parseInt(F[w].slice(1))-1,E[v]||(E[v]={});break;case"R":g=parseInt(F[w].slice(1))-1,S[g]||(S[g]={}),N>0?(S[g].hpt=N,S[g].hpx=zc(N)):N===0&&(S[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}X<1&&(O=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return S.length>0&&(P["!rows"]=S),E.length>0&&(P["!cols"]=E),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,P]}function a(m,p){var x=s(m,p),g=x[0],v=x[1],_=iu(g,p);return tr(v).forEach(function(w){_[w]=v[w]}),_}function o(m,p){return mo(a(m,p),p)}function l(m,p,x,g){var v="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":v+=m.v||0,m.f&&!m.F&&(v+=";E"+Kv(m.f,{r:x,c:g}));break;case"b":v+=m.v?"TRUE":"FALSE";break;case"e":v+=m.w||m.v;break;case"d":v+='"'+(m.w||m.v)+'"';break;case"s":v+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(m,p){p.forEach(function(x,g){var v="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=ah(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=oh(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&m.push(v)})}function u(m,p){p.forEach(function(x,g){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*lh(x.hpx)+";"),v.length>2&&m.push(v+"R"+(g+1))})}function h(m,p){var x=["ID;PWXL;N;E"],g=[],v=ht(m["!ref"]),_,w=Array.isArray(m),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&u(x,m["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var I=v.s.r;I<=v.e.r;++I)for(var O=v.s.c;O<=v.e.c;++O){var P=je({r:I,c:O});_=w?(m[I]||[])[O]:m[P],!(!_||_.v==null&&(!_.f||_.F))&&g.push(l(_,m,I,O))}return x.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),vI=function(){function t(i,a){switch(a.type){case"base64":return e(ns(i),a);case"binary":return e(i,a);case"buffer":return e(rt&&Buffer.isBuffer(i)?i.toString("binary"):ho(i),a);case"array":return e(nl(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),p=m[0],x=m[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+p){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(qs(x))?isNaN(Uc(x).getDate())?h[l][c]=x:h[l][c]=Ot(x):h[l][c]=qs(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return iu(t(i,a),a)}function n(i,a){return mo(r(i,a),a)}var s=function(){var i=function(l,c,u,h,m){l.push(c),l.push(u+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=ht(l["!ref"]),h,m=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var g=je({r:p,c:x});if(h=m?(l[p]||[])[x]:l[g],!h){a(c,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,v,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Cs(h.z||Me[14],kr(Ot(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var _=`\r
`,w=c.join(_);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),wI=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var p=h.split(`
`),x=-1,g=-1,v=0,_=[];v!==p.length;++v){var w=p[v].trim().split(":");if(w[0]==="cell"){var y=Ht(w[1]);if(_.length<=y.r)for(x=_.length;x<=y.r;++x)_[x]||(_[x]=[]);switch(x=y.r,g=y.c,w[2]){case"t":_[x][g]=t(w[3]);break;case"v":_[x][g]=+w[3];break;case"vtf":var I=w[w.length-1];case"vtc":switch(w[3]){case"nl":_[x][g]=!!+w[4];break;default:_[x][g]=+w[4];break}w[2]=="vtf"&&(_[x][g]=[_[x][g],I])}}}return m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),_}function n(h,m){return iu(r(h,m),m)}function s(h,m){return mo(n(h,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],p=[],x,g="",v=zn(h["!ref"]),_=Array.isArray(h),w=v.s.r;w<=v.e.r;++w)for(var y=v.s.c;y<=v.e.c;++y)if(g=je({r:w,c:y}),x=_?(h[w]||[])[y]:h[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var I=kr(Ot(x.v));p[2]="vtc",p[3]="nd",p[4]=""+I,p[5]=x.w||Cs(x.z||Me[14],I);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[i,a,o,a,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),$c=function(){function t(u,h,m,p,x){x.raw?h[m][p]=u:u===""||(u==="TRUE"?h[m][p]=!0:u==="FALSE"?h[m][p]=!1:isNaN(qs(u))?isNaN(Uc(u).getDate())?h[m][p]=u:h[m][p]=Ot(u):h[m][p]=qs(u))}function e(u,h){var m=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var v=10,_=0,w=0;w<=g;++w)_=x[w].indexOf(" "),_==-1?_=x[w].length:_++,v=Math.max(v,_);for(w=0;w<=g;++w){p[w]=[];var y=0;for(t(x[w].slice(0,v).trim(),p,w,y,m),y=1;y<=(x[w].length-v)/10+1;++y)t(x[w].slice(v+(y-1)*10,v+y*10).trim(),p,w,y,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},m=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?m=!m:!m&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[x.pop()[1]]||44}function i(u,h){var m=h||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):m&&m.FS?p=m.FS:p=s(u.slice(0,1024));var v=0,_=0,w=0,y=0,I=0,O=p.charCodeAt(0),P=!1,S=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=m.dateNF!=null?vL(m.dateNF):null;function N(){var C=u.slice(y,I),R={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)R.t="z";else if(m.raw)R.t="s",R.v=C;else if(C.trim().length===0)R.t="s",R.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(R.t="s",R.v=C.slice(2,-1).replace(/""/g,'"')):KV(C)?(R.t="n",R.f=C.slice(1)):(R.t="s",R.v=C);else if(C=="TRUE")R.t="b",R.v=!0;else if(C=="FALSE")R.t="b",R.v=!1;else if(!isNaN(w=qs(C)))R.t="n",m.cellText!==!1&&(R.w=C),R.v=w;else if(!isNaN(Uc(C).getDate())||A&&C.match(A)){R.z=m.dateNF||Me[14];var F=0;A&&C.match(A)&&(C=wL(C,m.dateNF,C.match(A)||[]),F=1),m.cellDates?(R.t="d",R.v=Ot(C,F)):(R.t="n",R.v=kr(Ot(C,F))),m.cellText!==!1&&(R.w=Cs(R.z,R.v instanceof Date?kr(R.v):R.v)),m.cellNF||delete R.z}else R.t="s",R.v=C;if(R.t=="z"||(m.dense?(x[v]||(x[v]=[]),x[v][_]=R):x[je({c:_,r:v})]=R),y=I+1,E=u.charCodeAt(y),g.e.c<_&&(g.e.c=_),g.e.r<v&&(g.e.r=v),S==O)++_;else if(_=0,++v,m.sheetRows&&m.sheetRows<=v)return!0}e:for(;I<u.length;++I)switch(S=u.charCodeAt(I)){case 34:E===34&&(P=!P);break;case O:case 10:case 13:if(!P&&N())break e;break}return I-y>0&&N(),x["!ref"]=Qe(g),x}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):iu(e(u,h),h)}function o(u,h){var m="",p=h.type=="string"?[0,0,0,0]:rw(u,h);switch(h.type){case"base64":m=ns(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof Jf<"u"||(m=rt&&Buffer.isBuffer(u)?u.toString("binary"):ho(u));break;case"array":m=nl(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Tt(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=Tt(m):h.type=="binary"&&typeof Jf<"u",m.slice(0,19)=="socialcalc:version:"?wI.to_sheet(h.type=="string"?m:Tt(m),h):a(m,h)}function l(u,h){return mo(o(u,h),h)}function c(u){for(var h=[],m=ht(u["!ref"]),p,x=Array.isArray(u),g=m.s.r;g<=m.e.r;++g){for(var v=[],_=m.s.c;_<=m.e.c;++_){var w=je({r:g,c:_});if(p=x?(u[g]||[])[_]:u[w],!p||p.v==null){v.push("          ");continue}for(var y=(p.w||(Ji(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(_===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function Fj(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=yI.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return $c.to_workbook(t,e)}}var Wo=function(){function t(L,K,X){if(L){Wr(L,L.l||0);for(var H=X.Enum||ie;L.l<L.length;){var re=L.read_shift(2),ee=H[re]||H[65535],le=L.read_shift(2),we=L.l+le,de=ee.f&&ee.f(L,le,X);if(L.l=we,K(de,ee,re))return}}}function e(L,K){switch(K.type){case"base64":return r(Yn(ns(L)),K);case"binary":return r(Yn(L),K);case"buffer":case"array":return r(L,K)}throw"Unsupported type "+K.type}function r(L,K){if(!L)return L;var X=K||{},H=X.dense?[]:{},re="Sheet1",ee="",le=0,we={},de=[],Pe=[],B={s:{r:0,c:0},e:{r:0,c:0}},et=X.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)X.Enum=ie,t(L,function(be,ct,ur){switch(ur){case 0:X.vers=be,be>=4096&&(X.qpro=!0);break;case 6:B=be;break;case 204:be&&(ee=be);break;case 222:ee=be;break;case 15:case 51:X.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:ur==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=X.dateNF||Me[14],X.cellDates&&(be[1].t="d",be[1].v=cp(be[1].v))),X.qpro&&be[3]>le&&(H["!ref"]=Qe(B),we[re]=H,de.push(re),H=X.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},le=be[3],re=ee||"Sheet"+(le+1),ee="");var Je=X.dense?(H[be[0].r]||[])[be[0].c]:H[je(be[0])];if(Je){Je.t=be[1].t,Je.v=be[1].v,be[1].z!=null&&(Je.z=be[1].z),be[1].f!=null&&(Je.f=be[1].f);break}X.dense?(H[be[0].r]||(H[be[0].r]=[]),H[be[0].r][be[0].c]=be[1]):H[je(be[0])]=be[1];break}},X);else if(L[2]==26||L[2]==14)X.Enum=ue,L[2]==14&&(X.qpro=!0,L.l=0),t(L,function(be,ct,ur){switch(ur){case 204:re=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>le&&(H["!ref"]=Qe(B),we[re]=H,de.push(re),H=X.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},le=be[3],re="Sheet"+(le+1)),et>0&&be[0].r>=et)break;X.dense?(H[be[0].r]||(H[be[0].r]=[]),H[be[0].r][be[0].c]=be[1]):H[je(be[0])]=be[1],B.e.c<be[0].c&&(B.e.c=be[0].c),B.e.r<be[0].r&&(B.e.r=be[0].r);break;case 27:be[14e3]&&(Pe[be[14e3][0]]=be[14e3][1]);break;case 1537:Pe[be[0]]=be[1],be[0]==le&&(re=be[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(H["!ref"]=Qe(B),we[ee||re]=H,de.push(ee||re),!Pe.length)return{SheetNames:de,Sheets:we};for(var Ye={},tt=[],He=0;He<Pe.length;++He)we[de[He]]?(tt.push(Pe[He]||de[He]),Ye[Pe[He]]=we[Pe[He]]||we[de[He]]):(tt.push(Pe[He]),Ye[Pe[He]]={"!ref":"A1"});return{SheetNames:tt,Sheets:Ye}}function n(L,K){var X=K||{};if(+X.codepage>=0&&$s(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Un(),re=ht(L["!ref"]),ee=Array.isArray(L),le=[];Ae(H,0,i(1030)),Ae(H,6,l(re));for(var we=Math.min(re.e.r,8191),de=re.s.r;de<=we;++de)for(var Pe=lr(de),B=re.s.c;B<=re.e.c;++B){de===re.s.r&&(le[B]=zt(B));var et=le[B]+Pe,Ye=ee?(L[de]||[])[B]:L[et];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Ae(H,13,p(de,B,Ye.v)):Ae(H,14,g(de,B,Ye.v));else{var tt=Ji(Ye);Ae(H,15,h(de,B,tt.slice(0,239)))}}return Ae(H,1),H.end()}function s(L,K){var X=K||{};if(+X.codepage>=0&&$s(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Un();Ae(H,0,a(L));for(var re=0,ee=0;re<L.SheetNames.length;++re)(L.Sheets[L.SheetNames[re]]||{})["!ref"]&&Ae(H,27,W(L.SheetNames[re],ee++));var le=0;for(re=0;re<L.SheetNames.length;++re){var we=L.Sheets[L.SheetNames[re]];if(!(!we||!we["!ref"])){for(var de=ht(we["!ref"]),Pe=Array.isArray(we),B=[],et=Math.min(de.e.r,8191),Ye=de.s.r;Ye<=et;++Ye)for(var tt=lr(Ye),He=de.s.c;He<=de.e.c;++He){Ye===de.s.r&&(B[He]=zt(He));var be=B[He]+tt,ct=Pe?(we[Ye]||[])[He]:we[be];if(!(!ct||ct.t=="z"))if(ct.t=="n")Ae(H,23,N(Ye,He,le,ct.v));else{var ur=Ji(ct);Ae(H,22,S(Ye,He,le,ur.slice(0,239)))}}++le}}return Ae(H,1),H.end()}function i(L){var K=fe(2);return K.write_shift(2,L),K}function a(L){var K=fe(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var X=0,H=0,re=0,ee=0;ee<L.SheetNames.length;++ee){var le=L.SheetNames[ee],we=L.Sheets[le];if(!(!we||!we["!ref"])){++re;var de=zn(we["!ref"]);X<de.e.r&&(X=de.e.r),H<de.e.c&&(H=de.e.c)}}return X>8191&&(X=8191),K.write_shift(2,X),K.write_shift(1,re),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(L,K,X){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&X.qpro?(H.s.c=L.read_shift(1),L.l++,H.s.r=L.read_shift(2),H.e.c=L.read_shift(1),L.l++,H.e.r=L.read_shift(2),H):(H.s.c=L.read_shift(2),H.s.r=L.read_shift(2),K==12&&X.qpro&&(L.l+=2),H.e.c=L.read_shift(2),H.e.r=L.read_shift(2),K==12&&X.qpro&&(L.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(L){var K=fe(8);return K.write_shift(2,L.s.c),K.write_shift(2,L.s.r),K.write_shift(2,L.e.c),K.write_shift(2,L.e.r),K}function c(L,K,X){var H=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(H[0].c=L.read_shift(1),H[3]=L.read_shift(1),H[0].r=L.read_shift(2),L.l+=2):(H[2]=L.read_shift(1),H[0].c=L.read_shift(2),H[0].r=L.read_shift(2)),H}function u(L,K,X){var H=L.l+K,re=c(L,K,X);if(re[1].t="s",X.vers==20768){L.l++;var ee=L.read_shift(1);return re[1].v=L.read_shift(ee,"utf8"),re}return X.qpro&&L.l++,re[1].v=L.read_shift(H-L.l,"cstr"),re}function h(L,K,X){var H=fe(7+X.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(1,39);for(var re=0;re<H.length;++re){var ee=X.charCodeAt(re);H.write_shift(1,ee>=128?95:ee)}return H.write_shift(1,0),H}function m(L,K,X){var H=c(L,K,X);return H[1].v=L.read_shift(2,"i"),H}function p(L,K,X){var H=fe(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(2,X,"i"),H}function x(L,K,X){var H=c(L,K,X);return H[1].v=L.read_shift(8,"f"),H}function g(L,K,X){var H=fe(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(8,X,"f"),H}function v(L,K,X){var H=L.l+K,re=c(L,K,X);if(re[1].v=L.read_shift(8,"f"),X.qpro)L.l=H;else{var ee=L.read_shift(2);I(L.slice(L.l,L.l+ee),re),L.l+=ee}return re}function _(L,K,X){var H=K&32768;return K&=-32769,K=(H?L:0)+(K>=8192?K-16384:K),(H?"":"$")+(X?zt(K):lr(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(L,K){Wr(L,0);for(var X=[],H=0,re="",ee="",le="",we="";L.l<L.length;){var de=L[L.l++];switch(de){case 0:X.push(L.read_shift(8,"f"));break;case 1:ee=_(K[0].c,L.read_shift(2),!0),re=_(K[0].r,L.read_shift(2),!1),X.push(ee+re);break;case 2:{var Pe=_(K[0].c,L.read_shift(2),!0),B=_(K[0].r,L.read_shift(2),!1);ee=_(K[0].c,L.read_shift(2),!0),re=_(K[0].r,L.read_shift(2),!1),X.push(Pe+B+":"+ee+re)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(L.read_shift(2));break;case 6:{for(var et="";de=L[L.l++];)et+=String.fromCharCode(de);X.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:we=X.pop(),le=X.pop(),X.push(["AND","OR"][de-20]+"("+le+","+we+")");break;default:if(de<32&&y[de])we=X.pop(),le=X.pop(),X.push(le+y[de]+we);else if(w[de]){if(H=w[de][1],H==69&&(H=L[L.l++]),H>X.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+X.join("|")+"|");return}var Ye=X.slice(-H);X.length-=H,X.push(w[de][0]+"("+Ye.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}X.length==1?K[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function O(L){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=L.read_shift(2),K[3]=L[L.l++],K[0].c=L[L.l++],K}function P(L,K){var X=O(L);return X[1].t="s",X[1].v=L.read_shift(K-4,"cstr"),X}function S(L,K,X,H){var re=fe(6+H.length);re.write_shift(2,L),re.write_shift(1,X),re.write_shift(1,K),re.write_shift(1,39);for(var ee=0;ee<H.length;++ee){var le=H.charCodeAt(ee);re.write_shift(1,le>=128?95:le)}return re.write_shift(1,0),re}function E(L,K){var X=O(L);X[1].v=L.read_shift(2);var H=X[1].v>>1;if(X[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return X[1].v=H,X}function A(L,K){var X=O(L),H=L.read_shift(4),re=L.read_shift(4),ee=L.read_shift(2);if(ee==65535)return H===0&&re===3221225472?(X[1].t="e",X[1].v=15):H===0&&re===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var le=ee&32768;return ee=(ee&32767)-16446,X[1].v=(1-le*2)*(re*Math.pow(2,ee+32)+H*Math.pow(2,ee)),X}function N(L,K,X,H){var re=fe(14);if(re.write_shift(2,L),re.write_shift(1,X),re.write_shift(1,K),H==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ee=0,le=0,we=0,de=0;return H<0&&(ee=1,H=-H),le=Math.log2(H)|0,H/=Math.pow(2,le-31),de=H>>>0,de&2147483648||(H/=2,++le,de=H>>>0),H-=de,de|=2147483648,de>>>=0,H*=Math.pow(2,32),we=H>>>0,re.write_shift(4,we),re.write_shift(4,de),le+=16383+(ee?32768:0),re.write_shift(2,le),re}function C(L,K){var X=A(L);return L.l+=K-14,X}function R(L,K){var X=O(L),H=L.read_shift(4);return X[1].v=H>>6,X}function F(L,K){var X=O(L),H=L.read_shift(8,"f");return X[1].v=H,X}function oe(L,K){var X=F(L);return L.l+=K-10,X}function ae(L,K){return L[L.l+K-1]==0?L.read_shift(K,"cstr"):""}function ve(L,K){var X=L[L.l++];X>K-1&&(X=K-1);for(var H="";H.length<X;)H+=String.fromCharCode(L[L.l++]);return H}function he(L,K,X){if(!(!X.qpro||K<21)){var H=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var re=L.read_shift(K-21,"cstr");return[H,re]}}function Z(L,K){for(var X={},H=L.l+K;L.l<H;){var re=L.read_shift(2);if(re==14e3){for(X[re]=[0,""],X[re][0]=L.read_shift(2);L[L.l];)X[re][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return X}function W(L,K){var X=fe(5+L.length);X.write_shift(2,14e3),X.write_shift(2,K);for(var H=0;H<L.length;++H){var re=L.charCodeAt(H);X[X.l++]=re>127?95:re}return X[X.l++]=0,X}var ie={0:{n:"BOF",f:mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:ve},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Oj(t){var e={},r=t.match(xn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=$e(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=vv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var Lj=function(){var t=th("t"),e=th("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:ft(a[1])},l=i.match(e);return l&&(o.s=Oj(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),Mj=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),jj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Vj=/<(?:\w+:)?r>/,Bj=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ft(Tt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tt(t),r&&(n.h=Iv(n.t))):t.match(Vj)&&(n.r=Tt(t),n.t=ft(Tt((t.replace(Bj,"").match(jj)||[]).join("").replace(xn,""))),r&&(n.h=Mj(Lj(n.r)))),n):{t:""}}var Uj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$j=/<(?:\w+:)?(?:si|sstItem)>/g,zj=/<\/(?:\w+:)?(?:si|sstItem)>/;function Hj(t,e){var r=[],n="";if(!t)return r;var s=t.match(Uj);if(s){n=s[2].replace($j,"").split(zj);for(var i=0;i!=n.length;++i){var a=zv(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=$e(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Wj=/^\s|\s$|[\t\n\r]/;function _I(t,e){if(!e.bookSST)return"";var r=[cr];r[r.length]=Se("sst",null,{xmlns:yl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(Wj)&&(i+=' xml:space="preserve"'),i+=">"+wt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Gj(t){return[t.read_shift(4),t.read_shift(4)]}function qj(t,e){var r=[],n=!1;return oa(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Kj(t,e){return e||(e=fe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Xj=iM;function Yj(t){var e=Un();Ee(e,159,Kj(t));for(var r=0;r<t.length;++r)Ee(e,19,Xj(t[r]));return Ee(e,160),e.end()}function EI(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Wi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Qj(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wi(t,4),e.U=Wi(t,4),e.W=Wi(t,4),e}function Jj(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Zj(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Jj(t));return e}function e9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function t9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wi(t,4),e.U=Wi(t,4),e.W=Wi(t,4),e}function r9(t){var e=t9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function TI(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function SI(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function n9(t){var e=Wi(t);switch(e.Minor){case 2:return[e.Minor,s9(t)];case 3:return[e.Minor,i9()];case 4:return[e.Minor,a9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function s9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=TI(t,r),s=SI(t,t.length-t.l);return{t:"Std",h:n,v:s}}function i9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function a9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(xn,function(i){var a=$e(i);switch(ki(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function o9(t,e){var r={},n=r.EncryptionVersionInfo=Wi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=TI(t,s),e-=s,r.EncryptionVerifier=SI(t,e),r}function l9(t){var e={},r=e.EncryptionVersionInfo=Wi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Hv(t){var e=0,r,n=EI(t),s=n.length+1,i,a,o,l,c;for(r=Ya(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var AI=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=EI(a),l=i(o),c=o.length,u=Ya(16),h=0;h!=16;++h)u[h]=0;var m,p,x;for((c&1)===1&&(m=l>>8,u[c]=s(t[0],m),--c,m=l&255,p=o[o.length-1],u[c]=s(p,m));c>0;)--c,m=l>>8,u[c]=s(o[c],m),--c,m=l&255,u[c]=s(o[c],m);for(c=15,x=15-o.length;x>0;)m=l>>8,u[c]=s(t[x],m),--c,--x,m=l&255,u[c]=s(o[c],m),--c,--x;return u}}(),c9=function(t,e,r,n,s){s||(s=e),n||(n=AI(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},u9=function(t){var e=0,r=AI(t);return function(n){var s=c9("",n,e,r);return e=s[1],s[0]}};function f9(t,e,r,n){var s={key:mr(t),verificationBytes:mr(t)};return r.password&&(s.verifier=Hv(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=u9(r.password)),s}function h9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=l9(t):n.Data=o9(t,e),n}function d9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?h9(t,e-2,n):f9(t,r.biff>=8?e:e-2,r,n),n}var kI=function(){function t(s,i){switch(i.type){case"base64":return e(ns(s),i);case"binary":return e(s,i);case"buffer":return e(rt&&Buffer.isBuffer(s)?s.toString("binary"):ho(s),i);case"array":return e(nl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(u);){switch(x[0]){case"\\cell":var v=u.slice(p,m.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++g,v.length){var _={v,t:"s"};Array.isArray(o)?o[h][g]=_:o[je({r:h,c:g})]=_}break}p=m.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=Qe(c),o}function r(s,i){return mo(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=ht(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=je({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ji(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function m9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ih(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function p9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function g9(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function mm(t,e){if(e===0)return t;var r=p9(m9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ih(g9(r))}var bI=6,x9=15,y9=1,cn=bI;function ah(t){return Math.floor((t+Math.round(128/cn)/256)*cn)}function oh(t){return Math.floor((t-5)/cn*100+.5)/100}function pm(t){return Math.round((t*cn+5)/cn*256)/256}function Ig(t){return pm(oh(ah(t)))}function Wv(t){var e=Math.abs(t-Ig(t)),r=cn;if(e>.005)for(cn=y9;cn<x9;++cn)Math.abs(t-Ig(t))<=e&&(e=Math.abs(t-Ig(t)),r=cn);cn=r}function Qa(t){t.width?(t.wpx=ah(t.width),t.wch=oh(t.wpx),t.MDW=cn):t.wpx?(t.wch=oh(t.wpx),t.width=pm(t.wch),t.MDW=cn):typeof t.wch=="number"&&(t.width=pm(t.wch),t.wpx=ah(t.width),t.MDW=cn),t.customWidth&&delete t.customWidth}var v9=96,CI=v9;function lh(t){return t*96/CI}function zc(t){return t*CI/96}var w9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _9(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(xn)||[]).forEach(function(a){var o=$e(a);switch(ki(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Rt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Rt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function E9(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(xn)||[]).forEach(function(a){var o=$e(a);switch(ki(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function T9(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(xn)||[]).forEach(function(a){var o=$e(a);switch(ki(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Tt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Rt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Rt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Rt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Rt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Rt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Rt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Rt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=vv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Rt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=zo[s.color.index];s.color.index==81&&(l=zo[1]),l||(l=zo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=mm(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function S9(t,e,r){e.NumberFmt=[];for(var n=tr(Me),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Me[n[s]];var i=t[0].match(xn);if(i)for(s=0;s<i.length;++s){var a=$e(i[s]);switch(ki(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ft(Tt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Hi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function A9(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Se("numFmt",null,{numFmtId:n,formatCode:wt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Se("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Wd=["numFmtId","fillId","fontId","borderId","xfId"],Gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function k9(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(xn)||[]).forEach(function(i){var a=$e(i),o=0;switch(ki(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Wd.length;++o)n[Wd[o]]&&(n[Wd[o]]=parseInt(n[Wd[o]],10));for(o=0;o<Gd.length;++o)n[Gd[o]]&&(n[Gd[o]]=Rt(n[Gd[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Rt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function b9(t){var e=[];return e[e.length]=Se("cellXfs",null),t.forEach(function(r){e[e.length]=Se("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Se("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var C9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&S9(h,u,c),(h=o.match(s))&&T9(h,u,l,c),(h=o.match(n))&&E9(h,u,l,c),(h=o.match(i))&&_9(h,u,l,c),(h=o.match(r))&&k9(h,u,c),u}}();function II(t,e){var r=[cr,Se("styleSheet",null,{xmlns:yl[0],"xmlns:vt":Tr.vt})],n;return t.SSF&&(n=A9(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=b9(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function I9(t,e){var r=t.read_shift(2),n=dn(t);return[r,n]}function N9(t,e,r){r||(r=fe(6+4*e.length)),r.write_shift(2,t),Or(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function R9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=hM(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=fM(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dn(t),n}function P9(t,e){e||(e=fe(25+4*32)),e.write_shift(2,t.sz*20),dM(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),fm(t.color,e);var n=0;return n=2,e.write_shift(1,n),Or(t.name,e),e.length>e.l?e.slice(0,e.l):e}var D9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ng,F9=pn;function gT(t,e){e||(e=fe(4*3+8*7+16*1)),Ng||(Ng=op(D9));var r=Ng[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(fm({auto:1},e),fm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function O9(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function NI(t,e,r){r||(r=fe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Mu(t,e){return e||(e=fe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var L9=pn;function M9(t,e){return e||(e=fe(51)),e.write_shift(1,0),Mu(null,e),Mu(null,e),Mu(null,e),Mu(null,e),Mu(null,e),e.length>e.l?e.slice(0,e.l):e}function j9(t,e){return e||(e=fe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),um(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function V9(t,e,r){var n=fe(2052);return n.write_shift(4,t),um(e,n),um(r,n),n.length>n.l?n.slice(0,n.l):n}function B9(t,e,r){var n={};n.NumberFmt=[];for(var s in Me)n.NumberFmt[s]=Me[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return oa(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Hi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=mm(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function U9(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Ee(t,615,Ks(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ee(t,44,N9(s,e[s]))}),Ee(t,616))}}function $9(t){var e=1;Ee(t,611,Ks(e)),Ee(t,43,P9({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(t,612)}function z9(t){var e=2;Ee(t,603,Ks(e)),Ee(t,45,gT({patternType:"none"})),Ee(t,45,gT({patternType:"gray125"})),Ee(t,604)}function H9(t){var e=1;Ee(t,613,Ks(e)),Ee(t,46,M9()),Ee(t,614)}function W9(t){var e=1;Ee(t,626,Ks(e)),Ee(t,47,NI({numFmtId:0},65535)),Ee(t,627)}function G9(t,e){Ee(t,617,Ks(e.length)),e.forEach(function(r){Ee(t,47,NI(r,0))}),Ee(t,618)}function q9(t){var e=1;Ee(t,619,Ks(e)),Ee(t,48,j9({xfId:0,name:"Normal"})),Ee(t,620)}function K9(t){var e=0;Ee(t,505,Ks(e)),Ee(t,506)}function X9(t){var e=0;Ee(t,508,V9(e,"TableStyleMedium9","PivotStyleMedium4")),Ee(t,509)}function Y9(t,e){var r=Un();return Ee(r,278),U9(r,t.SSF),$9(r),z9(r),H9(r),W9(r),G9(r,e.cellXfs),q9(r),K9(r),X9(r),Ee(r,279),r.end()}var Q9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function J9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(xn)||[]).forEach(function(s){var i=$e(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[Q9.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Z9(){}function eV(){}var tV=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,rV=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,nV=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sV(t,e,r){e.themeElements={};var n;[["clrScheme",tV,J9],["fontScheme",rV,Z9],["fmtScheme",nV,eV]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var iV=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function RI(t,e){(!t||t.length===0)&&(t=Gv());var r,n={};if(!(r=t.match(iV)))throw new Error("themeElements not found in theme");return sV(r[0],n,e),n.raw=t,n}function Gv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[cr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aV(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=T4(i,{type:"array"})}catch{return}var o=Qn(a,"theme/theme/theme1.xml",!0);if(o)return RI(o,r)}}function oV(t){return t.read_shift(4)}function lV(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=cV(t,4);break;case 2:e.xclrValue=uI(t);break;case 3:e.xclrValue=oV(t);break;case 4:t.l+=4;break}return t.l+=8,e}function cV(t,e){return pn(t,e)}function uV(t,e){return pn(t,e)}function fV(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=lV(t);break;case 6:n[1]=uV(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function hV(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(fV(t,r-t.l));return{ixfe:n,ext:i}}function dV(t,e){e.forEach(function(r){switch(r[0]){}})}function mV(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:dn(t)}}function pV(t){var e=fe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Or(t.name,e),e.slice(0,e.l)}function gV(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function xV(t){var e=fe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function yV(t,e){var r=fe(8+2*e.length);return r.write_shift(4,t),Or(e,r),r.slice(0,r.l)}function vV(t){return t.l+=4,t.read_shift(4)!=0}function wV(t,e){var r=fe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function _V(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return oa(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function EV(){var t=Un();return Ee(t,332),Ee(t,334,Ks(1)),Ee(t,335,pV({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(t,336),Ee(t,339,yV(1,"XLDAPR")),Ee(t,52),Ee(t,35,Ks(514)),Ee(t,4096,Ks(0)),Ee(t,4097,ds(1)),Ee(t,36),Ee(t,53),Ee(t,340),Ee(t,337,wV(1)),Ee(t,51,xV([[1,0]])),Ee(t,338),Ee(t,333),t.end()}function TV(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(xn,function(o){var l=$e(o);switch(ki(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function PI(){var t=[cr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function SV(t){var e=[];if(!t)return e;var r=1;return(t.match(xn)||[]).forEach(function(n){var s=$e(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function AV(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=je(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function kV(t,e,r){var n=[];return oa(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function bV(t,e,r,n){if(!t)return t;var s=n||{},i=!1;oa(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function CV(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var ic=1024;function DI(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Se("xml",null,{"xmlns:v":Kn.v,"xmlns:o":Kn.o,"xmlns:x":Kn.x,"xmlns:mv":Kn.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ic<t*1e3;)ic+=1e3;return e.forEach(function(i){var a=Ht(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Se("v:fill",l,o),u={on:"t",obscured:"t"};++ic,s=s.concat(["<v:shape"+rh({id:"_x0000_s"+ic,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Se("v:shadow",null,u),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Gr("x:AutoFill","False"),Gr("x:Row",String(a.r)),Gr("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function xT(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Ht(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=ht(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Qe(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function IV(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=$e(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Ht(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&zv(h[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function FI(t){var e=[cr,Se("comments",null,{xmlns:yl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=wt(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(wt(l.a))),i.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(Gr("t",wt(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;e.push(Gr("t",wt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function NV(t,e){var r=[],n=!1,s={},i=0;return t.replace(xn,function(o,l){var c=$e(o);switch(ki(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function RV(t,e,r){var n=[cr,Se("ThreadedComments",null,{xmlns:Tr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Se("threadedComment",Gr("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function PV(t,e){var r=[],n=!1;return t.replace(xn,function(i){var a=$e(i);switch(ki(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function DV(t){var e=[cr,Se("personList",null,{xmlns:Tr.TCMNT,"xmlns:x":yl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function FV(t){var e={};e.iauthor=t.read_shift(4);var r=El(t);return e.rfx=r.s,e.ref=je(r.s),t.l+=16,e}function OV(t,e){return e==null&&(e=fe(36)),e.write_shift(4,t[1].iauthor),au(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var LV=dn;function MV(t){return Or(t.slice(0,54))}function jV(t,e){var r=[],n=[],s={},i=!1;return oa(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function VV(t){var e=Un(),r=[];return Ee(e,628),Ee(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ee(e,632,MV(s.a)))})}),Ee(e,631),Ee(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Ht(n[0]),e:Ht(n[0])};Ee(e,635,OV([i,s])),s.t&&s.t.length>0&&Ee(e,637,oM(s)),Ee(e,636),delete s.iauthor})}),Ee(e,634),Ee(e,629),e.end()}var BV="application/vnd.ms-office.vbaProject";function UV(t){var e=De.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");De.utils.cfb_add(e,s,t.FileIndex[n].content)}}),De.write(e)}function $V(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&De.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var OI=["xlsb","xlsm","xlam","biff8","xla"];function zV(){return{"!type":"dialog"}}function HV(){return{"!type":"dialog"}}function WV(){return{"!type":"macro"}}function GV(){return{"!type":"macro"}}var Ec=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+zt(u)+(l?"":"$")+lr(c)}return function(s,i){return e=i,s.replace(t,r)}}(),qv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Kv=function(){return function(e,r){return e.replace(qv,function(n,s,i,a,o,l){var c=Fv(a)-(i?0:r.c),u=Dv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=c==0?"":i?c+1:"["+c+"]";return s+"R"+h+"C"+m})}}();function LI(t,e){return t.replace(qv,function(r,n,s,i,a,o){return n+(s=="$"?s+i:zt(Fv(i)+e.c))+(a=="$"?a+o:lr(Dv(o)+e.r))})}function qV(t,e,r){var n=zn(e),s=n.s,i=Ht(r),a={r:i.r-s.r,c:i.c-s.c};return LI(t,a)}function KV(t){return t.length!=1}function yT(t){return t.replace(/_xlfn\./g,"")}function fr(t){t.l+=1}function Ja(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function MI(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jI(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Ja(t),o=Ja(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jI(t){var e=Ja(t),r=Ja(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function XV(t,e,r){if(r.biff<8)return jI(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Ja(t),a=Ja(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function VI(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return YV(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Ja(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function YV(t){var e=Ja(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function QV(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZV(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function ZV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function eB(t,e,r){var n=(t[t.l++]&96)>>5,s=MI(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function tB(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=MI(t,i,r);return[n,s,a]}function rB(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function nB(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function sB(t,e,r){var n=(t[t.l++]&96)>>5,s=XV(t,e-1,r);return[n,s]}function iB(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function vT(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function aB(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function oB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function lB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function cB(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function uB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function BI(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function fB(t){return t.read_shift(2),BI(t)}function hB(t){return t.read_shift(2),BI(t)}function dB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=VI(t,0,r);return[n,s]}function mB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=JV(t,0,r);return[n,s]}function pB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=VI(t,0,r);return[n,s,i]}function gB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[v7[s],zI[s],n]}function xB(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:yB(t);return[s,(i[0]===0?zI:y7)[i[1]]]}function yB(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function vB(t,e,r){t.l+=r&&r.biff==2?3:4}function wB(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function _B(t){return t.l++,la[t.read_shift(1)]}function EB(t){return t.l++,t.read_shift(2)}function TB(t){return t.l++,t.read_shift(1)!==0}function SB(t){return t.l++,fn(t)}function AB(t,e,r){return t.l++,jh(t,e-1,r)}function kB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=rr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=la[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fn(t);break;case 2:r[1]=Tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bB(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?El:up)(t));return s}function CB(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=kB(t,r.biff);return a}function IB(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function NB(t,e,r){if(r.biff==5)return RB(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function RB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function PB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function DB(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function FB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function OB(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var LB=pn,MB=pn,jB=pn;function Bh(t,e,r){return t.l+=2,[QV(t)]}function Xv(t){return t.l+=6,[]}var VB=Bh,BB=Xv,UB=Xv,$B=Bh;function UI(t){return t.l+=2,[mr(t),t.read_shift(2)&1]}var zB=Bh,HB=UI,WB=Xv,GB=Bh,qB=Bh,KB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function XB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=KB[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function YB(t){return t.l+=2,[t.read_shift(4)]}function QB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function JB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function e7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function t7(t){return t.l+=4,[0,0]}var wT={1:{n:"PtgExp",f:wB},2:{n:"PtgTbl",f:jB},3:{n:"PtgAdd",f:fr},4:{n:"PtgSub",f:fr},5:{n:"PtgMul",f:fr},6:{n:"PtgDiv",f:fr},7:{n:"PtgPower",f:fr},8:{n:"PtgConcat",f:fr},9:{n:"PtgLt",f:fr},10:{n:"PtgLe",f:fr},11:{n:"PtgEq",f:fr},12:{n:"PtgGe",f:fr},13:{n:"PtgGt",f:fr},14:{n:"PtgNe",f:fr},15:{n:"PtgIsect",f:fr},16:{n:"PtgUnion",f:fr},17:{n:"PtgRange",f:fr},18:{n:"PtgUplus",f:fr},19:{n:"PtgUminus",f:fr},20:{n:"PtgPercent",f:fr},21:{n:"PtgParen",f:fr},22:{n:"PtgMissArg",f:fr},23:{n:"PtgStr",f:AB},26:{n:"PtgSheet",f:QB},27:{n:"PtgEndSheet",f:JB},28:{n:"PtgErr",f:_B},29:{n:"PtgBool",f:TB},30:{n:"PtgInt",f:EB},31:{n:"PtgNum",f:SB},32:{n:"PtgArray",f:iB},33:{n:"PtgFunc",f:gB},34:{n:"PtgFuncVar",f:xB},35:{n:"PtgName",f:IB},36:{n:"PtgRef",f:dB},37:{n:"PtgArea",f:eB},38:{n:"PtgMemArea",f:PB},39:{n:"PtgMemErr",f:LB},40:{n:"PtgMemNoMem",f:MB},41:{n:"PtgMemFunc",f:DB},42:{n:"PtgRefErr",f:FB},43:{n:"PtgAreaErr",f:rB},44:{n:"PtgRefN",f:mB},45:{n:"PtgAreaN",f:sB},46:{n:"PtgMemAreaN",f:ZB},47:{n:"PtgMemNoMemN",f:e7},57:{n:"PtgNameX",f:NB},58:{n:"PtgRef3d",f:pB},59:{n:"PtgArea3d",f:tB},60:{n:"PtgRefErr3d",f:OB},61:{n:"PtgAreaErr3d",f:nB},255:{}},r7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},n7={1:{n:"PtgElfLel",f:UI},2:{n:"PtgElfRw",f:GB},3:{n:"PtgElfCol",f:VB},6:{n:"PtgElfRwV",f:qB},7:{n:"PtgElfColV",f:$B},10:{n:"PtgElfRadical",f:zB},11:{n:"PtgElfRadicalS",f:WB},13:{n:"PtgElfColS",f:BB},15:{n:"PtgElfColSV",f:UB},16:{n:"PtgElfRadicalLel",f:HB},25:{n:"PtgList",f:XB},29:{n:"PtgSxName",f:YB},255:{}},s7={0:{n:"PtgAttrNoop",f:t7},1:{n:"PtgAttrSemi",f:uB},2:{n:"PtgAttrIf",f:lB},4:{n:"PtgAttrChoose",f:aB},8:{n:"PtgAttrGoto",f:oB},16:{n:"PtgAttrSum",f:vB},32:{n:"PtgAttrBaxcel",f:vT},33:{n:"PtgAttrBaxcel",f:vT},64:{n:"PtgAttrSpace",f:fB},65:{n:"PtgAttrSpaceSemi",f:hB},128:{n:"PtgAttrIfError",f:cB},255:{}};function Uh(t,e,r,n){if(n.biff<8)return pn(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=CB(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=bB(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(pn(t,e)),i}function $h(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=wT[i]||wT[r7[i]],(i===24||i===25)&&(s=(i===24?n7:s7)[t[t.l+1]]),!s||!s.f?pn(t,e):a.push([s.n,s.f(t,e,r)]);return a}function i7(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var a7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function o7(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function $I(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _T(t,e,r){var n=$I(t,e,r);return n=="#REF"?n:o7(n,r)}function on(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,h=0,m=0,p,x="";if(!t[0]||!t[0][0])return"";for(var g=-1,v="",_=0,w=t[0].length;_<w;++_){var y=t[0][_];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:v=Zt(" ",t[0][g][1][1]);break;case 1:v=Zt("\r",t[0][g][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+v,g=-1}o.push(c+a7[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ff(y[1][1],a,s),o.push(hf(u,i));break;case"PtgRefN":u=r?ff(y[1][1],r,s):y[1][1],o.push(hf(u,i));break;case"PtgRef3d":h=y[1][1],u=ff(y[1][2],a,s),x=_T(n,h,s),o.push(x+"!"+hf(u,i));break;case"PtgFunc":case"PtgFuncVar":var I=y[1][0],O=y[1][1];I||(I=0),I&=127;var P=I==0?[]:o.slice(-I);o.length-=I,O==="User"&&(O=P.shift()),o.push(O+"("+P.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=YE(y[1][1],r?{s:r}:a,s),o.push(kg(p,s));break;case"PtgArea":p=YE(y[1][1],a,s),o.push(kg(p,s));break;case"PtgArea3d":h=y[1][1],p=y[1][2],x=_T(n,h,s),o.push(x+"!"+kg(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var S=(n.names||[])[m-1]||(n[0]||[])[m],E=S?S.Name:"SH33TJSNAME"+String(m);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var A=y[1][1];m=y[1][2];var N;if(s.biff<=5)A<0&&(A=-A),n[A]&&(N=n[A][m]);else{var C="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][m]&&n[A][m].itab>0&&(C=n.SheetNames[n[A][m].itab-1]+"!"):C=n.SheetNames[m-1]+"!"),n[A]&&n[A][m])C+=n[A][m].Name;else if(n[0]&&n[0][m])C+=n[0][m].Name;else{var R=($I(n,A,s)||"").split(";;");R[m-1]?C=R[m-1]:C+="SH33TJSERRX"}o.push(C);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var F="(",oe=")";if(g>=0){switch(v="",t[0][g][1][0]){case 2:F=Zt(" ",t[0][g][1][1])+F;break;case 3:F=Zt("\r",t[0][g][1][1])+F;break;case 4:oe=Zt(" ",t[0][g][1][1])+oe;break;case 5:oe=Zt("\r",t[0][g][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(F+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[je(u)]){var ve=n.sharedf[je(u)];o.push(on(ve,a,ae,n,s))}else{var he=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(on(c[1],a,ae,n,s)),he=!0;break}he||o.push(y[1])}break;case"PtgArray":o.push("{"+i7(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Z.indexOf(t[0][_][0])==-1){y=t[0][g];var W=!0;switch(y[1][0]){case 4:W=!1;case 0:v=Zt(" ",y[1][1]);break;case 5:W=!1;case 1:v=Zt("\r",y[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((W?v:"")+o.pop()+(W?"":v)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function l7(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],pn(t,e-2)];var o=$h(t,a,r);return e!==a+s&&(i=Uh(t,e-a-s,o,r)),t.l=n,[o,i]}function c7(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],pn(t,e-2)];var o=$h(t,a,r);return e!==a+s&&(i=Uh(t,e-a-s,o,r)),t.l=n,[o,i]}function u7(t,e,r,n){var s=t.l+e,i=$h(t,n,r),a;return s!==t.l&&(a=Uh(t,s-t.l,i,r)),[i,a]}function f7(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=$h(t,i,r);return i==65535?[[],pn(t,e-2)]:(e!==i+2&&(s=Uh(t,n-i-2,a,r)),[a,s])}function h7(t){var e;if(Vi(t,t.l+6)!==65535)return[fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function d7(t){if(t==null){var e=fe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return sl(t);return sl(0)}function Rg(t,e,r){var n=t.l+e,s=bi(t);r.biff==2&&++t.l;var i=h7(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=c7(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function m7(t,e,r,n,s){var i=al(e,r,s),a=d7(t.v),o=fe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=fe(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=Fr([i,a,o,c]);return h}function fp(t,e,r){var n=t.read_shift(4),s=$h(t,n,r),i=t.read_shift(4),a=i>0?Uh(t,i,s,r):null;return[s,a]}var p7=fp,hp=fp,g7=fp,x7=fp,y7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},v7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ET(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function w7(t){var e="of:="+t.replace(qv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Pg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function _7(t){return t.replace(/\./,"!")}var mf={},Tc={},pf=typeof Map<"u";function Yv(t,e,r){var n=0,s=t.length;if(r){if(pf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=pf?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(pf?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function dp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(cn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=oh(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=pm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Go(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function po(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Hi(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function HI(t,e,r,n,s,i){try{n.cellNF&&(t.z=Me[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ot(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Me[e]==null&&Hi(yL[e]||"General",e),t.t==="e")t.w=t.w||la[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=eh(t.v);else if(t.t==="d"){var a=kr(t.v);(a|0)===a?t.w=a.toString(10):t.w=eh(a)}else{if(t.v===void 0)return"";t.w=rl(t.v,Tc)}else t.t==="d"?t.w=Cs(e,kr(t.v),Tc):t.w=Cs(e,t.v,Tc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=mm(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=mm(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function E7(t,e,r){if(t&&t["!ref"]){var n=ht(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function T7(t,e){var r=ht(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Qe(r))}var S7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,A7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,k7=/<(?:\w:)?hyperlink [^>]*>/mg,b7=/"(\w*:\w*)"/,C7=/<(?:\w:)?col\b[^>]*[\/]?>/g,I7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N7=/<(?:\w:)?pageMargins[^>]*\/>/g,WI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,R7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,P7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function D7(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(A7);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var m=c.match(WI);m?Qv(m[0],o,s,r):(m=c.match(R7))&&O7(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(b7);x&&T7(o,x[1])}var g=c.match(P7);g&&g[1]&&K7(g[1],s);var v=[];if(e.cellStyles){var _=c.match(C7);_&&z7(v,_)}h&&Q7(h[1],o,e,l,i,a);var w=u.match(I7);w&&(o["!autofilter"]=W7(w[0]));var y=[],I=u.match(S7);if(I)for(p=0;p!=I.length;++p)y[p]=ht(I[p].slice(I[p].indexOf('"')+1));var O=u.match(k7);O&&B7(o,O,n);var P=u.match(N7);if(P&&(o["!margins"]=U7($e(P[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Qe(l)),e.sheetRows>0&&o["!ref"]){var S=ht(o["!ref"]);e.sheetRows<=+S.e.r&&(S.e.r=e.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Qe(S))}return v.length>0&&(o["!cols"]=v),y.length>0&&(o["!merges"]=y),o}function F7(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Qe(t[r])+'"/>';return e+"</mergeCells>"}function Qv(t,e,r,n){var s=$e(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ft(Tt(s.codeName)))}function O7(t,e,r,n,s){Qv(t.slice(0,t.indexOf(">")),r,n,s)}function L7(t,e,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,a.codeName=ui(wt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+Se("outlinePr",null,c)}!i&&!o||(s[s.length]=Se("sheetPr",o,a))}var M7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],j7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function V7(t){var e={sheet:1};return M7.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),j7.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Hv(t.password).toString(16).toUpperCase()),Se("sheetProtection",null,e)}function B7(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=$e(Tt(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+ft(i.location))):(i.Target="#"+ft(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=ht(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=je({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function U7(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function $7(t){return Go(t),Se("pageMargins",null,t)}function z7(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=$e(e[n],!0);s.hidden&&(s.hidden=Rt(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Wv(s.width)),Qa(s);i<=a;)t[i++]=Lt(s)}}function H7(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Se("col",null,dp(s,n)));return r[r.length]="</cols>",r.join("")}function W7(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function G7(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Qe(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=zn(s);a.s.r==a.e.r&&(a.e.r=zn(e["!ref"]).e.r,s=Qe(a));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Se("autoFilter",null,{ref:s})}var q7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function K7(t,e){e.Views||(e.Views=[{}]),(t.match(q7)||[]).forEach(function(r,n){var s=$e(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Rt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function X7(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,s),{})}function Y7(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=la[t.v];break;case"d":n&&n.cellDates?s=Ot(t.v,-1).toISOString():(t=Lt(t),t.t="n",s=""+(t.v=kr(Ot(t.v)))),typeof t.z>"u"&&(t.z=Me[14]);break;default:s=t.v;break}var o=Gr("v",wt(s)),l={r:e},c=po(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Gr("v",""+Yv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=i&&(t.t=i,t.v=a),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Se("f",wt(t.f),u)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Se("c",o,l)}var Q7=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=th("v"),a=th("f");return function(l,c,u,h,m,p){for(var x=0,g="",v=[],_=[],w=0,y=0,I=0,O="",P,S,E=0,A=0,N,C,R=0,F=0,oe=Array.isArray(p.CellXf),ae,ve=[],he=[],Z=Array.isArray(c),W=[],ie={},ue=!1,L=!!u.sheetStubs,K=l.split(e),X=0,H=K.length;X!=H;++X){g=K[X].trim();var re=g.length;if(re!==0){var ee=0;e:for(x=0;x<re;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(S=$e(g.slice(ee,x),!0),E=S.r!=null?parseInt(S.r,10):E+1,A=-1,u.sheetRows&&u.sheetRows<E)continue;ie={},ue=!1,S.ht&&(ue=!0,ie.hpt=parseFloat(S.ht),ie.hpx=zc(ie.hpt)),S.hidden=="1"&&(ue=!0,ie.hidden=!0),S.outlineLevel!=null&&(ue=!0,ie.level=+S.outlineLevel),ue&&(W[E-1]=ie)}break;case"<":ee=x;break}if(ee>=x)break;if(S=$e(g.slice(ee,x),!0),E=S.r!=null?parseInt(S.r,10):E+1,A=-1,!(u.sheetRows&&u.sheetRows<E)){h.s.r>E-1&&(h.s.r=E-1),h.e.r<E-1&&(h.e.r=E-1),u&&u.cellStyles&&(ie={},ue=!1,S.ht&&(ue=!0,ie.hpt=parseFloat(S.ht),ie.hpx=zc(ie.hpt)),S.hidden=="1"&&(ue=!0,ie.hidden=!0),S.outlineLevel!=null&&(ue=!0,ie.level=+S.outlineLevel),ue&&(W[E-1]=ie)),v=g.slice(x).split(t);for(var le=0;le!=v.length&&v[le].trim().charAt(0)=="<";++le);for(v=v.slice(le),x=0;x!=v.length;++x)if(g=v[x].trim(),g.length!==0){if(_=g.match(r),w=x,y=0,I=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,_!=null&&_.length===2){for(w=0,O=_[1],y=0;y!=O.length&&!((I=O.charCodeAt(y)-64)<1||I>26);++y)w=26*w+I;--w,A=w}else++A;for(y=0;y!=g.length&&g.charCodeAt(y)!==62;++y);if(++y,S=$e(g.slice(0,y),!0),S.r||(S.r=je({r:E-1,c:A})),O=g.slice(y),P={t:""},(_=O.match(i))!=null&&_[1]!==""&&(P.v=ft(_[1])),u.cellFormula){if((_=O.match(a))!=null&&_[1]!==""){if(P.f=ft(Tt(_[1])).replace(/\r\n/g,`
`),u.xlfn||(P.f=yT(P.f)),_[0].indexOf('t="array"')>-1)P.F=(O.match(s)||[])[1],P.F.indexOf(":")>-1&&ve.push([ht(P.F),P.F]);else if(_[0].indexOf('t="shared"')>-1){C=$e(_[0]);var we=ft(Tt(_[1]));u.xlfn||(we=yT(we)),he[parseInt(C.si,10)]=[C,we,S.r]}}else(_=O.match(/<f[^>]*\/>/))&&(C=$e(_[0]),he[C.si]&&(P.f=qV(he[C.si][1],he[C.si][2],S.r)));var de=Ht(S.r);for(y=0;y<ve.length;++y)de.r>=ve[y][0].s.r&&de.r<=ve[y][0].e.r&&de.c>=ve[y][0].s.c&&de.c<=ve[y][0].e.c&&(P.F=ve[y][1])}if(S.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(L)P.t="z";else continue;else P.t=S.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),P.t){case"n":if(P.v==""||P.v==null){if(!L)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!L)continue;P.t="z"}else N=mf[parseInt(P.v,10)],P.v=N.t,P.r=N.r,u.cellHTML&&(P.h=N.h);break;case"str":P.t="s",P.v=P.v!=null?Tt(P.v):"",u.cellHTML&&(P.h=Iv(P.v));break;case"inlineStr":_=O.match(n),P.t="s",_!=null&&(N=zv(_[1]))?(P.v=N.t,u.cellHTML&&(P.h=N.h)):P.v="";break;case"b":P.v=Rt(P.v);break;case"d":u.cellDates?P.v=Ot(P.v,1):(P.v=kr(Ot(P.v,1)),P.t="n");break;case"e":(!u||u.cellText!==!1)&&(P.w=P.v),P.v=q4[P.v];break}if(R=F=0,ae=null,oe&&S.s!==void 0&&(ae=p.CellXf[S.s],ae!=null&&(ae.numFmtId!=null&&(R=ae.numFmtId),u.cellStyles&&ae.fillId!=null&&(F=ae.fillId))),HI(P,R,F,u,m,p),u.cellDates&&oe&&P.t=="n"&&nu(Me[R])&&(P.t="d",P.v=cp(P.v)),S.cm&&u.xlmeta){var Pe=(u.xlmeta.Cell||[])[+S.cm-1];Pe&&Pe.type=="XLDAPR"&&(P.D=!0)}if(Z){var B=Ht(S.r);c[B.r]||(c[B.r]=[]),c[B.r][B.c]=P}else c[S.r]=P}}}}W.length>0&&(c["!rows"]=W)}}();function J7(t,e,r,n){var s=[],i=[],a=ht(t["!ref"]),o="",l,c="",u=[],h=0,m=0,p=t["!rows"],x=Array.isArray(t),g={r:c},v,_=-1;for(m=a.s.c;m<=a.e.c;++m)u[m]=zt(m);for(h=a.s.r;h<=a.e.r;++h){for(i=[],c=lr(h),m=a.s.c;m<=a.e.c;++m){l=u[m]+c;var w=x?(t[h]||[])[m]:t[l];w!==void 0&&(o=Y7(w,l,t,e))!=null&&i.push(o)}(i.length>0||p&&p[h])&&(g={r:c},p&&p[h]&&(v=p[h],v.hidden&&(g.hidden=1),_=-1,v.hpx?_=lh(v.hpx):v.hpt&&(_=v.hpt),_>-1&&(g.ht=_,g.customHeight=1),v.level&&(g.outlineLevel=v.level)),s[s.length]=Se("row",i.join(""),g))}if(p)for(;h<p.length;++h)p&&p[h]&&(g={r:h+1},v=p[h],v.hidden&&(g.hidden=1),_=-1,v.hpx?_=lh(v.hpx):v.hpt&&(_=v.hpt),_>-1&&(g.ht=_,g.customHeight=1),v.level&&(g.outlineLevel=v.level),s[s.length]=Se("row","",g));return s.join("")}function GI(t,e,r,n){var s=[cr,Se("worksheet",null,{xmlns:yl[0],"xmlns:r":Tr.r})],i=r.SheetNames[t],a=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=ht(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Qe(u)}n||(n={}),l["!comments"]=[];var h=[];L7(l,r,t,e,s),s[s.length]=Se("dimension",null,{ref:c}),s[s.length]=X7(l,e,t,r),e.sheetFormat&&(s[s.length]=Se("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=H7(l,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=J7(l,e),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=V7(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=G7(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=F7(l["!merges"]));var m=-1,p,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=vt(n,-1,wt(g[1].Target).replace(/#.*$/,""),nt.HLINK),p["r:id"]="rId"+x),(m=g[1].Target.indexOf("#"))>-1&&(p.location=wt(g[1].Target.slice(m+1))),g[1].Tooltip&&(p.tooltip=wt(g[1].Tooltip)),s[s.length]=Se("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=$7(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Gr("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(x=vt(n,-1,"../drawings/drawing"+(t+1)+".xml",nt.DRAW),s[s.length]=Se("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=h),l["!comments"].length>0&&(x=vt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",nt.VML),s[s.length]=Se("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Z7(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function eU(t,e,r){var n=fe(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=lh(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,m=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var x=Array.isArray(r)?(r[c.r]||[])[c.c]:r[je(c)];x&&(h<0&&(h=p),m=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,m))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function tU(t,e,r,n){var s=eU(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Ee(t,0,s)}var rU=El,nU=au;function sU(){}function iU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=lM(t),r}function aU(t,e,r){r==null&&(r=fe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return fm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$4(t,r),r.slice(0,r.l)}function oU(t){var e=Ns(t);return[e]}function lU(t,e,r){return r==null&&(r=fe(8)),vl(e,r)}function cU(t){var e=wl(t);return[e]}function uU(t,e,r){return r==null&&(r=fe(4)),_l(e,r)}function fU(t){var e=Ns(t),r=t.read_shift(1);return[e,r,"b"]}function hU(t,e,r){return r==null&&(r=fe(9)),vl(e,r),r.write_shift(1,t.v?1:0),r}function dU(t){var e=wl(t),r=t.read_shift(1);return[e,r,"b"]}function mU(t,e,r){return r==null&&(r=fe(5)),_l(e,r),r.write_shift(1,t.v?1:0),r}function pU(t){var e=Ns(t),r=t.read_shift(1);return[e,r,"e"]}function gU(t,e,r){return r==null&&(r=fe(9)),vl(e,r),r.write_shift(1,t.v),r}function xU(t){var e=wl(t),r=t.read_shift(1);return[e,r,"e"]}function yU(t,e,r){return r==null&&(r=fe(8)),_l(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function vU(t){var e=Ns(t),r=t.read_shift(4);return[e,r,"s"]}function wU(t,e,r){return r==null&&(r=fe(12)),vl(e,r),r.write_shift(4,e.v),r}function _U(t){var e=wl(t),r=t.read_shift(4);return[e,r,"s"]}function EU(t,e,r){return r==null&&(r=fe(8)),_l(e,r),r.write_shift(4,e.v),r}function TU(t){var e=Ns(t),r=fn(t);return[e,r,"n"]}function SU(t,e,r){return r==null&&(r=fe(16)),vl(e,r),sl(t.v,r),r}function qI(t){var e=wl(t),r=fn(t);return[e,r,"n"]}function AU(t,e,r){return r==null&&(r=fe(12)),_l(e,r),sl(t.v,r),r}function kU(t){var e=Ns(t),r=jv(t);return[e,r,"n"]}function bU(t,e,r){return r==null&&(r=fe(12)),vl(e,r),z4(t.v,r),r}function CU(t){var e=wl(t),r=jv(t);return[e,r,"n"]}function IU(t,e,r){return r==null&&(r=fe(8)),_l(e,r),z4(t.v,r),r}function NU(t){var e=Ns(t),r=Ov(t);return[e,r,"is"]}function RU(t){var e=Ns(t),r=dn(t);return[e,r,"str"]}function PU(t,e,r){return r==null&&(r=fe(12+4*t.v.length)),vl(e,r),Or(t.v,r),r.length>r.l?r.slice(0,r.l):r}function DU(t){var e=wl(t),r=dn(t);return[e,r,"str"]}function FU(t,e,r){return r==null&&(r=fe(8+4*t.v.length)),_l(e,r),Or(t.v,r),r.length>r.l?r.slice(0,r.l):r}function OU(t,e,r){var n=t.l+e,s=Ns(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=hp(t,n-t.l,r);a[3]=on(o,null,s,r.supbooks,r)}else t.l=n;return a}function LU(t,e,r){var n=t.l+e,s=Ns(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=hp(t,n-t.l,r);a[3]=on(o,null,s,r.supbooks,r)}else t.l=n;return a}function MU(t,e,r){var n=t.l+e,s=Ns(t);s.r=r["!row"];var i=fn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=hp(t,n-t.l,r);a[3]=on(o,null,s,r.supbooks,r)}else t.l=n;return a}function jU(t,e,r){var n=t.l+e,s=Ns(t);s.r=r["!row"];var i=dn(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=hp(t,n-t.l,r);a[3]=on(o,null,s,r.supbooks,r)}else t.l=n;return a}var VU=El,BU=au;function UU(t,e){return e==null&&(e=fe(4)),e.write_shift(4,t),e}function $U(t,e){var r=t.l+e,n=El(t),s=Lv(t),i=dn(t),a=dn(t),o=dn(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function zU(t,e){var r=fe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));au({s:Ht(t[0]),e:Ht(t[0])},r),Mv("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Or(s||"",r),Or(t[1].Tooltip||"",r),Or("",r),r.slice(0,r.l)}function HU(){}function WU(t,e,r){var n=t.l+e,s=H4(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=p7(t,n-t.l,r);a[1]=o}else t.l=n;return a}function GU(t,e,r){var n=t.l+e,s=El(t),i=[s];if(r.cellFormula){var a=x7(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}function qU(t,e,r){r==null&&(r=fe(18));var n=dp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var KI=["left","right","top","bottom","header","footer"];function KU(t){var e={};return KI.forEach(function(r){e[r]=fn(t)}),e}function XU(t,e){return e==null&&(e=fe(6*8)),Go(t),KI.forEach(function(r){sl(t[r],e)}),e}function YU(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function QU(t,e,r){r==null&&(r=fe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function JU(t){var e=fe(24);return e.write_shift(4,4),e.write_shift(4,1),au(t,e),e}function ZU(t,e){return e==null&&(e=fe(16*4+2)),e.write_shift(2,t.password?Hv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function e$(){}function t$(){}function r$(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,p,x,g,v,_,w,y,I,O,P=[];o.biff=12,o["!row"]=0;var S=0,E=!1,A=[],N={},C=o.supbooks||s.supbooks||[[]];if(C.sharedf=N,C.arrayf=A,C.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=C,s.Names))for(var R=0;R<s.Names.length;++R)C[0][R+1]=s.Names[R];var F=[],oe=[],ae=!1;ch[16]={n:"BrtShortReal",f:qI};var ve;if(oa(t,function(W,ie,ue){if(!m)switch(ue){case 148:c=W;break;case 0:p=W,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),I=lr(v=p.r),o["!row"]=p.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=zc(W.hpt)),oe[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:W[2]},W[2]){case"n":x.v=W[1];break;case"s":y=mf[W[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!W[1];break;case"e":x.v=W[1],o.cellText!==!1&&(x.w=la[x.v]);break;case"str":x.t="s",x.v=W[1];break;case"is":x.t="s",x.v=W[1].t;break}if((g=a.CellXf[W[0].iStyleRef])&&HI(x,g.numFmtId,null,o,i,a),_=W[0].c==-1?_+1:W[0].c,o.dense?(l[v]||(l[v]=[]),l[v][_]=x):l[zt(_)+I]=x,o.cellFormula){for(E=!1,S=0;S<A.length;++S){var L=A[S];p.r>=L[0].s.r&&p.r<=L[0].e.r&&_>=L[0].s.c&&_<=L[0].e.c&&(x.F=Qe(L[0]),E=!0)}!E&&W.length>3&&(x.f=W[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>_&&(u.s.c=_),u.e.r<p.r&&(u.e.r=p.r),u.e.c<_&&(u.e.c=_),o.cellDates&&g&&x.t=="n"&&nu(Me[g.numFmtId])){var K=Oo(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}ve&&(ve.type=="XLDAPR"&&(x.D=!0),ve=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},_=W[0].c==-1?_+1:W[0].c,o.dense?(l[v]||(l[v]=[]),l[v][_]=x):l[zt(_)+I]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>_&&(u.s.c=_),u.e.r<p.r&&(u.e.r=p.r),u.e.c<_&&(u.e.c=_),ve&&(ve.type=="XLDAPR"&&(x.D=!0),ve=void 0);break;case 176:P.push(W);break;case 49:ve=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var X=n["!id"][W.relId];for(X?(W.Target=X.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=X):W.relId==""&&(W.Target="#"+W.loc),v=W.rfx.s.r;v<=W.rfx.e.r;++v)for(_=W.rfx.s.c;_<=W.rfx.e.c;++_)o.dense?(l[v]||(l[v]=[]),l[v][_]||(l[v][_]={t:"z",v:void 0}),l[v][_].l=W):(w=je({c:_,r:v}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=W);break;case 426:if(!o.cellFormula)break;A.push(W),O=o.dense?l[v][_]:l[zt(_)+I],O.f=on(W[1],u,{r:p.r,c:_},C,o),O.F=Qe(W[0]);break;case 427:if(!o.cellFormula)break;N[je(W[0].s)]=W[1],O=o.dense?l[v][_]:l[zt(_)+I],O.f=on(W[1],u,{r:p.r,c:_},C,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)F[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},ae||(ae=!0,Wv(W.w/256)),Qa(F[W.e+1]);break;case 161:l["!autofilter"]={ref:Qe(W)};break;case 476:l["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(l["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ie.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Qe(c||u)),o.sheetRows&&l["!ref"]){var he=ht(l["!ref"]);o.sheetRows<=+he.e.r&&(he.e.r=o.sheetRows-1,he.e.r>u.e.r&&(he.e.r=u.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>u.e.c&&(he.e.c=u.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Qe(he))}return P.length>0&&(l["!merges"]=P),F.length>0&&(l["!cols"]=F),oe.length>0&&(l["!rows"]=oe),l}function n$(t,e,r,n,s,i,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Lt(e),e.z=e.z||Me[14],e.v=kr(Ot(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=po(s.cellXfs,e,s),e.l&&i["!links"].push([je(l),e.l]),e.c&&i["!comments"].push([je(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=Yv(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,a?Ee(t,18,EU(e,l)):Ee(t,7,wU(e,l))):(l.t="str",a?Ee(t,17,FU(e,l)):Ee(t,6,PU(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ee(t,13,IU(e,l)):Ee(t,2,bU(e,l)):a?Ee(t,16,AU(e,l)):Ee(t,5,SU(e,l)),!0;case"b":return l.t="b",a?Ee(t,15,mU(e,l)):Ee(t,4,hU(e,l)),!0;case"e":return l.t="e",a?Ee(t,14,yU(e,l)):Ee(t,3,gU(e,l)),!0}return a?Ee(t,12,uU(e,l)):Ee(t,1,lU(e,l)),!0}function s$(t,e,r,n){var s=ht(e["!ref"]||"A1"),i,a="",o=[];Ee(t,145);var l=Array.isArray(e),c=s.e.r;e["!rows"]&&(c=Math.max(s.e.r,e["!rows"].length-1));for(var u=s.s.r;u<=c;++u){a=lr(u),tU(t,e,s,u);var h=!1;if(u<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){u===s.s.r&&(o[m]=zt(m)),i=o[m]+a;var p=l?(e[u]||[])[m]:e[i];if(!p){h=!1;continue}h=n$(t,p,u,m,n,e,h)}}Ee(t,146)}function i$(t,e){!e||!e["!merges"]||(Ee(t,177,UU(e["!merges"].length)),e["!merges"].forEach(function(r){Ee(t,176,BU(r))}),Ee(t,178))}function a$(t,e){!e||!e["!cols"]||(Ee(t,390),e["!cols"].forEach(function(r,n){r&&Ee(t,60,qU(n,r))}),Ee(t,391))}function o$(t,e){!e||!e["!ref"]||(Ee(t,648),Ee(t,649,JU(ht(e["!ref"]))),Ee(t,650))}function l$(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=vt(r,-1,n[1].Target.replace(/#.*$/,""),nt.HLINK);Ee(t,494,zU(n,s))}}),delete e["!links"]}function c$(t,e,r,n){if(e["!comments"].length>0){var s=vt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);Ee(t,551,Mv("rId"+s)),e["!legacy"]=s}}function u$(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:Qe(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=zn(i);o.s.r==o.e.r&&(o.e.r=zn(e["!ref"]).e.r,i=Qe(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ee(t,161,au(ht(i))),Ee(t,162)}}function f$(t,e,r){Ee(t,133),Ee(t,137,QU(e,r)),Ee(t,138),Ee(t,134)}function h$(t,e){e["!protect"]&&Ee(t,535,ZU(e["!protect"]))}function d$(t,e,r,n){var s=Un(),i=r.SheetNames[t],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=ht(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ee(s,129),(r.vbaraw||a["!outline"])&&Ee(s,147,aU(o,a["!outline"])),Ee(s,148,nU(l)),f$(s,a,r.Workbook),a$(s,a),s$(s,a,t,e),h$(s,a),u$(s,a,r,t),i$(s,a),l$(s,a,n),a["!margins"]&&Ee(s,476,XU(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&o$(s,a),c$(s,a,t,n),Ee(s,130),s.end()}function m$(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=ft((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function p$(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=m$(h);u.s.r=u.s.c=0,u.e.c=o,c=zt(o),m[0].forEach(function(p,x){a[c+lr(x)]={t:"n",v:p,z:m[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Qe(u)),a}function g$(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(WI);return o&&Qv(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function x$(t,e){t.l+=10;var r=dn(t);return{name:r}}function y$(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return oa(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Jv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],v$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],w$=[],_$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function TT(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Rt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function ST(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Rt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XI(t){ST(t.WBProps,Jv),ST(t.CalcPr,_$),TT(t.WBView,v$),TT(t.Sheets,w$),Tc.date1904=Rt(t.WBProps.date1904)}function E$(t){return!t.Workbook||!t.Workbook.WBProps?"false":Rt(t.Workbook.WBProps.date1904)?"true":"false"}var T$="][*?/\\".split("");function YI(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return T$.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function S$(t,e,r){t.forEach(function(n,s){YI(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[s]&&e[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function A$(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];S$(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)E7(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var k$=/<\w+:workbook/;function b$(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(xn,function(l,c){var u=$e(l);switch(ki(u[0])){case"<?xml":break;case"<workbook":l.match(k$)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jv.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Rt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Tt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ft(Tt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Tt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Rt(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=ft(Tt(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),yl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XI(r),r}function QI(t){var e=[cr];e[e.length]=Se("workbook",null,{xmlns:yl[0],"xmlns:r":Tr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Jv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Se("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var a={name:wt(t.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Se("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Se("definedName",wt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function C$(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=m1(t),r.name=dn(t),r}function I$(t,e){return e||(e=fe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Mv(t.strRelID,e),Or(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function N$(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?dn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function R$(t,e){e||(e=fe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),$4(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function P$(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function D$(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=cM(t),a=g7(t,0,r),o=Lv(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function F$(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],ch[16]={n:"BrtFRTArchID$",f:P$},oa(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=on(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),XI(r),r.Names=i,r.supbooks=a,r}function O$(t,e){Ee(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ee(t,156,I$(s))}Ee(t,144)}function L$(t,e){e||(e=fe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Or("SheetJS",e),Or(sm.version,e),Or(sm.version,e),Or("7262",e),e.length>e.l?e.slice(0,e.l):e}function M$(t,e){e||(e=fe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function j$(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Ee(t,135),Ee(t,158,M$(s)),Ee(t,136))}}function V$(t,e){var r=Un();return Ee(r,131),Ee(r,128,L$()),Ee(r,153,R$(t.Workbook&&t.Workbook.WBProps||null)),j$(r,t),O$(r,t),Ee(r,132),r.end()}function B$(t,e,r){return e.slice(-4)===".bin"?F$(t,r):b$(t,r)}function U$(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?r$(t,n,r,s,i,a,o):D7(t,n,r,s,i,a,o)}function $$(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?y$(t,n,r,s,i):g$(t,n,r,s,i)}function z$(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?WV():GV()}function H$(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?zV():HV()}function W$(t,e,r,n){return e.slice(-4)===".bin"?B9(t,r,n):C9(t,r,n)}function G$(t,e,r){return RI(t,r)}function q$(t,e,r){return e.slice(-4)===".bin"?qj(t,r):Hj(t,r)}function K$(t,e,r){return e.slice(-4)===".bin"?jV(t,r):IV(t,r)}function X$(t,e,r){return e.slice(-4)===".bin"?kV(t):SV(t)}function Y$(t,e,r,n){return r.slice(-4)===".bin"?bV(t,e,r,n):void 0}function Q$(t,e,r){return e.slice(-4)===".bin"?_V(t,e,r):TV(t,e,r)}function J$(t,e,r){return(e.slice(-4)===".bin"?V$:QI)(t)}function Z$(t,e,r,n,s){return(e.slice(-4)===".bin"?d$:GI)(t,r,n,s)}function ez(t,e,r){return(e.slice(-4)===".bin"?Y9:II)(t,r)}function tz(t,e,r){return(e.slice(-4)===".bin"?Yj:_I)(t,r)}function rz(t,e,r){return(e.slice(-4)===".bin"?VV:FI)(t)}function nz(t){return(t.slice(-4)===".bin"?EV:PI)()}var JI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ls(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(JI),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(ZI),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function sz(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(JI),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(ZI),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var gf;function iz(t,e){var r=gf[t]||ft(t);return r==="General"?rl(e):Cs(r,e)}function az(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Rt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Ot(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ft(e)]=s}function oz(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||la[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=eh(t.v):t.w=rl(t.v):t.w=iz(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=gf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&nu(n)){var s=Oo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function lz(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=w9[n.Pattern]||n.Pattern)}t[e.ID]=e}function cz(t,e,r,n,s,i,a,o,l,c){var u="General",h=n.StyleID,m={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&p.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rt(t);break;case"String":n.t="s",n.r=UE(ft(t)),n.v=t.indexOf("<")>-1?ft(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Ot(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ft(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=q4[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=UE(e||t));break}if(oz(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=ft(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Ec(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ec("RC:RC",s):n.ArrayRange&&(n.F=Ec(n.ArrayRange,s),l.push([ht(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(v){!m.patternType&&v.patternType&&(m.patternType=v.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function uz(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Dg(t,e){var r=e||{};su();var n=Hu(Nv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Tt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Lt(r);return a.type="string",$c.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){s.indexOf("<"+ct)>=0&&(i=!0)}),i)return Xz(n,r);gf={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],m=r.dense?[]:{},p="",x={},g={},v=Ls('<Data ss:Type="String">'),_=0,w=0,y=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},P={},S="",E=0,A=[],N={},C={},R=0,F=[],oe=[],ae={},ve=[],he,Z=!1,W=[],ie=[],ue={},L=0,K=0,X={Sheets:[],WBProps:{date1904:!1}},H={};nh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=nh.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?cz(n.slice(_,o.index),S,v,l[l.length-1][0]=="comment"?ae:x,{c:w,r:y},O,ve[w],g,W,r):(S="",v=Ls(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(x.c=oe),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(m[y]||(m[y]=[]),m[y][w]=x):m[zt(w)+lr(y)]=x),x.HRef&&(x.l={Target:ft(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(L=w+(parseInt(x.MergeAcross,10)|0),K=y+(parseInt(x.MergeDown,10)|0),A.push({s:{c:w,r:y},e:{c:L,r:K}})),!r.sheetStubs)x.MergeAcross?w=L+1:++w;else if(x.MergeAcross||x.MergeDown){for(var ee=w;ee<=L;++ee)for(var le=y;le<=K;++le)(ee>w||le>y)&&(r.dense?(m[le]||(m[le]=[]),m[le][ee]={t:"z"}):m[zt(ee)+lr(le)]={t:"z"});w=L+1}else++w;else x=sz(o[0]),x.Index&&(w=+x.Index-1),w<I.s.c&&(I.s.c=w),w>I.e.c&&(I.e.c=w),o[0].slice(-2)==="/>"&&++w,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<I.s.r&&(I.s.r=y),y>I.e.r&&(I.e.r=y),o[0].slice(-2)==="/>"&&(g=Ls(o[0]),g.Index&&(y=+g.Index-1)),w=0,++y):(g=Ls(o[0]),g.Index&&(y=+g.Index-1),ue={},(g.AutoFitHeight=="0"||g.Height)&&(ue.hpx=parseInt(g.Height,10),ue.hpt=lh(ue.hpx),ie[y]=ue),g.Hidden=="1"&&(ue.hidden=!0,ie[y]=ue));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(m["!ref"]=Qe(I),r.sheetRows&&r.sheetRows<=I.e.r&&(m["!fullref"]=m["!ref"],I.e.r=r.sheetRows-1,m["!ref"]=Qe(I))),A.length&&(m["!merges"]=A),ve.length>0&&(m["!cols"]=ve),ie.length>0&&(m["!rows"]=ie),u[p]=m}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),c=Ls(o[0]),p=ft(c.Name),m=r.dense?[]:{},A=[],W=[],ie=[],H={name:p,Hidden:0},X.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ve=[],Z=!1}break;case"style":o[1]==="/"?lz(O,P,r):P=Ls(o[0]);break;case"numberformat":P.nf=ft(Ls(o[0]).Format||"General"),gf[P.nf]&&(P.nf=gf[P.nf]);for(var we=0;we!=392&&Me[we]!=P.nf;++we);if(we==392){for(we=57;we!=392;++we)if(Me[we]==null){Hi(P.nf,we);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(he=Ls(o[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!Z&&he.wpx>10){Z=!0,cn=bI;for(var de=0;de<ve.length;++de)ve[de]&&Qa(ve[de])}Z&&Qa(he),ve[he.Index-1||ve.length]=he;for(var Pe=0;Pe<+he.Span;++Pe)ve[ve.length]=Lt(he);break;case"namedrange":if(o[1]==="/")break;X.Names||(X.Names=[]);var B=$e(o[0]),et={Name:B.Name,Ref:Ec(B.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(et.Sheet=X.Sheets.length-1),X.Names.push(et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Ls(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?FM(N,re,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));uz(ae),oe.push(ae)}else l.push([o[3],!1]),c=Ls(o[0]),ae={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ye=Ls(o[0]);m["!autofilter"]={ref:Ec(Ye.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return IT(n,r);var tt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else R=o.index+o[0].length;break;case"header":m["!margins"]||Go(m["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(m["!margins"].header=+$e(o[0]).Margin);break;case"footer":m["!margins"]||Go(m["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(m["!margins"].footer=+$e(o[0]).Margin);break;case"pagemargins":var He=$e(o[0]);m["!margins"]||Go(m["!margins"]={},"xlml"),isNaN(+He.Top)||(m["!margins"].top=+He.Top),isNaN(+He.Left)||(m["!margins"].left=+He.Left),isNaN(+He.Right)||(m["!margins"].right=+He.Right),isNaN(+He.Bottom)||(m["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?az(C,re,F,n.slice(R,o.index)):(F=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=u),be.SheetNames=h,be.Workbook=X,be.SSF=Lt(Me),be.Props=N,be.Custprops=C,be}function _1(t,e){switch(ew(e=e||{}),e.type||"base64"){case"base64":return Dg(ns(t),e);case"binary":case"buffer":case"file":return Dg(t,e);case"array":return Dg(ho(t),e)}}function fz(t,e){var r=[];return t.Props&&r.push(OM(t.Props,e)),t.Custprops&&r.push(LM(t.Props,t.Custprops)),r.join("")}function hz(){return""}function dz(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(Se("NumberFormat",null,{"ss:Format":wt(Me[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(Se("Style",i.join(""),a))}),Se("Styles",r.join(""))}function eN(t){return Se("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Kv(t.Ref,{r:0,c:0})})}function mz(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(eN(s)))}return Se("Names",r.join(""))}function pz(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(eN(o)))}return i.join("")}function gz(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Se("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Se("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Se("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(Gr("ProtectContents","True")),t["!protect"].objects&&s.push(Gr("ProtectObjects","True")),t["!protect"].scenarios&&s.push(Gr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(Gr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(Gr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":Se("WorksheetOptions",s.join(""),{xmlns:Kn.x})}function xz(t){return t.map(function(e){var r=jL(e.t||""),n=Se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Se("Comment",n,{"ss:Author":e.a})}).join("")}function yz(t,e,r,n,s,i,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+wt(Kv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Ht(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=wt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=wt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(t.v);break;case"b":h="Boolean",m=t.v?"1":"0";break;case"e":h="Error",m=la[t.v];break;case"d":h="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Me[14]);break;case"s":h="String",m=ML(t.v||"");break}var p=po(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var x=t.v!=null?m:"",g=t.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(t.c||[]).length>0&&(g+=xz(t.c)),Se("Cell",g,o)}function vz(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=zc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function wz(t,e,r,n){if(!t["!ref"])return"";var s=ht(t["!ref"]),i=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(v,_){Qa(v);var w=!!v.width,y=dp(_,v),I={"ss:Index":_+1};w&&(I["ss:Width"]=ah(y.width)),v.hidden&&(I["ss:Hidden"]="1"),o.push(Se("Column",null,I))});for(var l=Array.isArray(t),c=s.s.r;c<=s.e.r;++c){for(var u=[vz(c,(t["!rows"]||[])[c])],h=s.s.c;h<=s.e.c;++h){var m=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>h)&&!(i[a].s.r>c)&&!(i[a].e.c<h)&&!(i[a].e.r<c)){(i[a].s.c!=h||i[a].s.r!=c)&&(m=!0);break}if(!m){var p={r:c,c:h},x=je(p),g=l?(t[c]||[])[h]:t[x];u.push(yz(g,x,t,e,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function _z(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],a=i?pz(i,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?wz(i,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(gz(i,e,t,r)),n.join("")}function Ez(t,e){e||(e={}),t.SSF||(t.SSF=Lt(Me)),t.SSF&&(su(),ap(t.SSF),e.revssf=lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],po(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(fz(t,e)),r.push(hz()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Se("Worksheet",_z(n,e,t),{"ss:Name":wt(t.SheetNames[n])}));return r[2]=dz(t,e),r[3]=mz(t),cr+Se("Workbook",r.join(""),{xmlns:Kn.ss,"xmlns:o":Kn.o,"xmlns:x":Kn.x,"xmlns:ss":Kn.ss,"xmlns:dt":Kn.dt,"xmlns:html":Kn.html})}function Tz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=mM(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=pM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Sz=[60,1084,2066,2165,2175];function Az(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=Vi(r,r.l),c=E1[l],u=0;c!=null&&Sz.indexOf(l)>-1;)i=Vi(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=E1[l=Vi(r,r.l)];var h=Fr(a);Wr(h,0);var m=0;h.lens=[];for(var p=0;p<a.length;++p)h.lens.push(m),m+=a[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function si(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Me[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||la[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=eh(t.v):t.w=rl(t.v):t.w=Cs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&nu(Me[n]||String(n))){var s=Oo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function qd(t,e,r){return{v:t,ixfe:e,t:r}}function kz(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},h,m="",p,x,g,v,_={},w=[],y,I,O=[],P=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},A=function(ze){return ze<8?zo[ze]:ze<64&&P[ze-8]||zo[ze]},N=function(ze,Et,Bt){var At=Et.XF.data;if(!(!At||!At.patternType||!Bt||!Bt.cellStyles)){Et.s={},Et.s.patternType=At.patternType;var Hn;(Hn=ih(A(At.icvFore)))&&(Et.s.fgColor={rgb:Hn}),(Hn=ih(A(At.icvBack)))&&(Et.s.bgColor={rgb:Hn})}},C=function(ze,Et,Bt){if(!(ue>1)&&!(Bt.sheetRows&&ze.r>=Bt.sheetRows)){if(Bt.cellStyles&&Et.XF&&Et.XF.data&&N(ze,Et,Bt),delete Et.ixfe,delete Et.XF,h=ze,m=je(ze),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<a.s.r&&(a.s.r=ze.r),ze.c<a.s.c&&(a.s.c=ze.c),ze.r+1>a.e.r&&(a.e.r=ze.r+1),ze.c+1>a.e.c&&(a.e.c=ze.c+1),Bt.cellFormula&&Et.f){for(var At=0;At<w.length;++At)if(!(w[At][0].s.c>ze.c||w[At][0].s.r>ze.r)&&!(w[At][0].e.c<ze.c||w[At][0].e.r<ze.r)){Et.F=Qe(w[At][0]),(w[At][0].s.c!=ze.c||w[At][0].s.r!=ze.r)&&delete Et.f,Et.f&&(Et.f=""+on(w[At][1],a,ze,W,R));break}}Bt.dense?(s[ze.r]||(s[ze.r]=[]),s[ze.r][ze.c]=Et):s[m]=Et}},R={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(R.password=e.password);var F,oe=[],ae=[],ve=[],he=[],Z=!1,W=[];W.SheetNames=R.snames,W.sharedf=R.sharedf,W.arrayf=R.arrayf,W.names=[],W.XTI=[];var ie=0,ue=0,L=0,K=[],X=[],H;R.codepage=1200,$s(1200);for(var re=!1;t.l<t.length-1;){var ee=t.l,le=t.read_shift(2);if(le===0&&ie===10)break;var we=t.l===t.length?0:t.read_shift(2),de=E1[le];if(de&&de.f){if(e.bookSheets&&ie===133&&le!==133)break;if(ie=le,de.r===2||de.r==12){var Pe=t.read_shift(2);if(we-=2,!R.enc&&Pe!==le&&((Pe&255)<<8|Pe>>8)!==le)throw new Error("rt mismatch: "+Pe+"!="+le);de.r==12&&(t.l+=10,we-=10)}var B={};if(le===10?B=de.f(t,we,R):B=Az(le,de,t,we,R),ue==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(le){case 34:r.opts.Date1904=S.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(t.l=0),R.enc=B,!e.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=B;break;case 66:var et=Number(B);switch(et){case 21010:et=1200;break;case 32768:et=1e4;break;case 32769:et=1252;break}$s(R.codepage=et),re=!0;break;case 317:R.rrtabid=B;break;case 25:R.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:R.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(s["!type"]="dialog"),B.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),B.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(B);break;case 430:W.push([B]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(B);break;case 24:case 536:H={Name:B.Name,Ref:on(B.rgce,a,null,W,R)},B.itab>0&&(H.Sheet=B.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(X[B.itab-1]={ref:Qe(B.rgce[0][0][1][2])});break;case 22:R.ExternCount=B;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(B),W.XTI=W.XTI.concat(B);break;case 2196:if(R.biff<8)break;H!=null&&(H.Comment=B[1]);break;case 18:s["!protect"]=B;break;case 19:B!==0&&R.WTF&&console.error("Password verifier: "+B);break;case 133:i[B.pos]=B,R.snames.push(B.name);break;case 10:{if(--ue)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=Qe(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ye=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Qe(a),a.e.r=Ye}a.e.r++,a.e.c++}oe.length>0&&(s["!merges"]=oe),ae.length>0&&(s["!objects"]=ae),ve.length>0&&(s["!cols"]=ve),he.length>0&&(s["!rows"]=he),S.Sheets.push(E)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),R.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(R.biff=5,re=!0,$s(R.codepage=28591)),R.biff==8&&B.BIFFVer==0&&B.dt==16&&(R.biff=2),ue++)break;if(s=e.dense?[]:{},R.biff<8&&!re&&(re=!0,$s(R.codepage=e.codepage||1252)),R.biff<5||B.BIFFVer==0&&B.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:t.l-we,name:c};i[tt.pos]=tt,R.snames.push(c)}else c=(i[ee]||{name:""}).name;B.dt==32&&(s["!type"]="chart"),B.dt==64&&(s["!type"]="macro"),oe=[],ae=[],R.arrayf=w=[],ve=[],he=[],Z=!1,E={Hidden:(i[ee]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[B.r]||[])[B.c]:s[je({c:B.c,r:B.r})])&&++B.c,y={ixfe:B.ixfe,XF:O[B.ixfe]||{},v:B.val,t:"n"},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e);break;case 5:case 517:y={ixfe:B.ixfe,XF:O[B.ixfe],v:B.val,t:B.t},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e);break;case 638:y={ixfe:B.ixfe,XF:O[B.ixfe],v:B.rknum,t:"n"},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e);break;case 189:for(var He=B.c;He<=B.C;++He){var be=B.rkrec[He-B.c][0];y={ixfe:be,XF:O[be],v:B.rkrec[He-B.c][1],t:"n"},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:He,r:B.r},y,e)}break;case 6:case 518:case 1030:{if(B.val=="String"){o=B;break}if(y=qd(B.val,B.cell.ixfe,B.tt),y.XF=O[y.ixfe],e.cellFormula){var ct=B.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var ur=ct[0][0][1][0],Je=ct[0][0][1][1],Mr=je({r:ur,c:Je});_[Mr]?y.f=""+on(B.formula,a,B.cell,W,R):y.F=((e.dense?(s[ur]||[])[Je]:s[Mr])||{}).F}else y.f=""+on(B.formula,a,B.cell,W,R)}L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C(B.cell,y,e),o=B}break;case 7:case 519:if(o)o.val=B,y=qd(B,o.cell.ixfe,"s"),y.XF=O[y.ixfe],e.cellFormula&&(y.f=""+on(o.formula,a,o.cell,W,R)),L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(B);var ua=je(B[0].s);if(p=e.dense?(s[B[0].s.r]||[])[B[0].s.c]:s[ua],e.cellFormula&&p){if(!o||!ua||!p)break;p.f=""+on(B[1],a,B[0],W,R),p.F=Qe(B[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;_[je(o.cell)]=B[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[je(o.cell)],(p||{}).f=""+on(B[0],a,h,W,R)}}break;case 253:y=qd(l[B.isst].t,B.ixfe,"s"),l[B.isst].h&&(y.h=l[B.isst].h),y.XF=O[y.ixfe],L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:B.ixfe,XF:O[B.ixfe],t:"z"},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e));break;case 190:if(e.sheetStubs)for(var Cn=B.c;Cn<=B.C;++Cn){var Xt=B.ixfe[Cn-B.c];y={ixfe:Xt,XF:O[Xt],t:"z"},L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:Cn,r:B.r},y,e)}break;case 214:case 516:case 4:y=qd(B.val,B.ixfe,"s"),y.XF=O[y.ixfe],L>0&&(y.z=K[y.ixfe>>8&63]),si(y,e,r.opts.Date1904),C({c:B.c,r:B.r},y,e);break;case 0:case 512:ue===1&&(a=B);break;case 252:l=B;break;case 1054:if(R.biff==4){K[L++]=B[1];for(var In=0;In<L+163&&Me[In]!=B[1];++In);In>=163&&Hi(B[1],L+163)}else Hi(B[1],B[0]);break;case 30:{K[L++]=B;for(var gt=0;gt<L+163&&Me[gt]!=B;++gt);gt>=163&&Hi(B,L+163)}break;case 229:oe=oe.concat(B);break;case 93:ae[B.cmo[0]]=R.lastobj=B;break;case 438:R.lastobj.TxO=B;break;case 127:R.lastobj.ImData=B;break;case 440:for(v=B[0].s.r;v<=B[0].e.r;++v)for(g=B[0].s.c;g<=B[0].e.c;++g)p=e.dense?(s[v]||[])[g]:s[je({c:g,r:v})],p&&(p.l=B[1]);break;case 2048:for(v=B[0].s.r;v<=B[0].e.r;++v)for(g=B[0].s.c;g<=B[0].e.c;++g)p=e.dense?(s[v]||[])[g]:s[je({c:g,r:v})],p&&p.l&&(p.l.Tooltip=B[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;p=e.dense?(s[B[0].r]||[])[B[0].c]:s[je(B[0])];var Mt=ae[B[2]];p||(e.dense?(s[B[0].r]||(s[B[0].r]=[]),p=s[B[0].r][B[0].c]={t:"z"}):p=s[je(B[0])]={t:"z"},a.e.r=Math.max(a.e.r,B[0].r),a.s.r=Math.min(a.s.r,B[0].r),a.e.c=Math.max(a.e.c,B[0].c),a.s.c=Math.min(a.s.c,B[0].c)),p.c||(p.c=[]),x={a:B[1],t:Mt.TxO.t},p.c.push(x)}break;case 2173:dV(O[B.ixfe],B.ext);break;case 125:{if(!R.cellStyles)break;for(;B.e>=B.s;)ve[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},Z||(Z=!0,Wv(B.w/256)),Qa(ve[B.e+1])}break;case 520:{var Ct={};B.level!=null&&(he[B.r]=Ct,Ct.level=B.level),B.hidden&&(he[B.r]=Ct,Ct.hidden=!0),B.hpt&&(he[B.r]=Ct,Ct.hpt=B.hpt,Ct.hpx=zc(B.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Go(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=B;break;case 161:s["!margins"]||Go(s["!margins"]={}),s["!margins"].header=B.header,s["!margins"].footer=B.footer;break;case 574:B.RTL&&(S.Views[0].RTL=!0);break;case 146:P=B;break;case 2198:F=B;break;case 140:I=B;break;case 442:c?E.CodeName=B||E.name:S.WBProps.CodeName=B||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+le.toString(16)),t.l+=we}return r.SheetNames=tr(i).sort(function(br,ze){return Number(br)-Number(ze)}).map(function(br){return i[br].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&X.forEach(function(br,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=br}),r.Strings=l,r.SSF=Lt(Me),R.enc&&(r.Encryption=R.enc),F&&(r.Themes=F),r.Metadata={},I!==void 0&&(r.Metadata.Country=I),W.names.length>0&&(S.Names=W.names),r.Workbook=S,r}var xf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bz(t,e,r){var n=De.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=iT(n,p1,xf.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=De.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=iT(a,g1,xf.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(Z4(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Cz(t,e){var r=[],n=[],s=[],i=0,a,o=OE(p1,"n"),l=OE(g1,"n");if(t.Props)for(a=tr(t.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Props[a[i]]]);if(t.Custprops)for(a=tr(t.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Custprops[a[i]]]);var c=[];for(i=0;i<s.length;++i)aI.indexOf(s[i][0])>-1||J4.indexOf(s[i][0])>-1||s[i][1]!=null&&c.push(s[i]);n.length&&De.utils.cfb_add(e,"/SummaryInformation",aT(n,xf.SI,l,g1)),(r.length||c.length)&&De.utils.cfb_add(e,"/DocumentSummaryInformation",aT(r,xf.DSI,o,p1,c.length?c:null,xf.UDI))}function tN(t,e){e||(e={}),ew(e),_v(),e.codepage&&wv(e.codepage);var r,n;if(t.FullPaths){if(De.find(t,"/encryption"))throw new Error("File is password-protected");r=De.find(t,"!CompObj"),n=De.find(t,"/Workbook")||De.find(t,"/Book")}else{switch(e.type){case"base64":t=Yn(ns(t));break;case"binary":t=Yn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Wr(t,0),n={content:t}}var s,i;if(r&&Tz(r),e.bookProps&&!e.bookSheets)s={};else{var a=rt?"buffer":"array";if(n&&n.content)s=kz(n.content,e);else if((i=De.find(t,"PerfectOffice_MAIN"))&&i.content)s=Wo.to_workbook(i.content,(e.type=a,e));else if((i=De.find(t,"NativeContent_MAIN"))&&i.content)s=Wo.to_workbook(i.content,(e.type=a,e));else throw(i=De.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&De.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=UV(t))}var o={};return t.FullPaths&&bz(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function Iz(t,e){var r=e||{},n=De.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return De.utils.cfb_add(n,s,rN(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Cz(t,n),r.biff==8&&t.vbaraw&&$V(n,De.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var ch={0:{f:Z7},1:{f:oU},2:{f:kU},3:{f:pU},4:{f:fU},5:{f:TU},6:{f:RU},7:{f:vU},8:{f:jU},9:{f:MU},10:{f:OU},11:{f:LU},12:{f:cU},13:{f:CU},14:{f:xU},15:{f:dU},16:{f:qI},17:{f:DU},18:{f:_U},19:{f:Ov},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:D$},40:{},42:{},43:{f:R9},44:{f:I9},45:{f:F9},46:{f:L9},47:{f:O9},48:{},49:{f:rM},50:{},51:{f:gV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xI},62:{f:NU},63:{f:AV},64:{f:e$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:YU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:iU},148:{f:rU,p:16},151:{f:HU},152:{},153:{f:N$},154:{},155:{},156:{f:C$},157:{},158:{},159:{T:1,f:Gj},160:{T:-1},161:{T:1,f:El},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:mV},336:{T:-1},337:{f:vV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:m1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WU},427:{f:GU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$U},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:m1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LV},633:{T:1},634:{T:-1},635:{T:1,f:FV},636:{T:-1},637:{f:aM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:x$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:t$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},E1={6:{f:Rg},10:{f:ya},12:{f:mr},13:{f:mr},14:{f:rr},15:{f:rr},16:{f:fn},17:{f:rr},18:{f:rr},19:{f:mr},20:{f:hT},21:{f:hT},23:{f:gI},24:{f:mT},25:{f:rr},26:{},27:{},28:{f:tj},29:{},34:{f:rr},35:{f:dT},38:{f:fn},39:{f:fn},40:{f:fn},41:{f:fn},42:{f:rr},43:{f:rr},47:{f:d9},49:{f:C8},51:{f:mr},60:{},61:{f:T8},64:{f:rr},65:{f:b8},66:{f:mr},77:{},80:{},81:{},82:{},85:{f:mr},89:{},90:{},91:{},92:{f:h8},93:{f:sj},94:{},95:{f:rr},96:{},97:{},99:{f:rr},125:{f:xI},128:{f:z8},129:{f:m8},130:{f:mr},131:{f:rr},132:{f:rr},133:{f:p8},134:{},140:{f:hj},141:{f:mr},144:{},146:{f:pj},151:{},152:{},153:{},154:{},155:{},156:{f:mr},157:{},158:{},160:{f:Ej},161:{f:yj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:V8},190:{f:B8},193:{f:ya},197:{},198:{},199:{},200:{},201:{},202:{f:rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mr},220:{},221:{f:rr},222:{},224:{f:$8},225:{f:f8},226:{f:ya},227:{},229:{f:rj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:x8},253:{f:N8},255:{f:v8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:oI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rr},353:{f:ya},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:K8},431:{f:rr},432:{},433:{},434:{},437:{},438:{f:oj},439:{f:rr},440:{f:lj},441:{},442:{f:Vh},443:{},444:{f:mr},445:{},446:{},448:{f:ya},449:{f:E8,r:2},450:{f:ya},512:{f:cT},513:{f:_j},515:{f:G8},516:{f:P8},517:{f:fT},519:{f:Tj},520:{f:w8},523:{},545:{f:pT},549:{f:lT},566:{},574:{f:A8},638:{f:j8},659:{},1048:{},1054:{f:F8},1084:{},1212:{f:J8},2048:{f:uj},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Hd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ya},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gj,r:12},2173:{f:hV,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Q8,r:12},2197:{},2198:{f:aV,r:12},2199:{},2200:{},2201:{},2202:{f:Z8,r:12},2203:{f:ya},2204:{},2205:{},2206:{},2207:{},2211:{f:_8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cT},1:{},2:{f:Cj},3:{f:kj},4:{f:Aj},5:{f:fT},7:{f:Nj},8:{},9:{f:Hd},11:{},22:{f:mr},30:{f:L8},31:{},32:{},33:{f:pT},36:{},37:{f:lT},50:{f:Rj},62:{},52:{},67:{},68:{f:mr},69:{},86:{},126:{},127:{f:Sj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Pj},223:{},234:{},354:{},421:{},518:{f:Rg},521:{f:Hd},536:{f:mT},547:{f:dT},561:{},579:{},1030:{f:Rg},1033:{f:Hd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Pv(r)&&t.push(r)}}function Nz(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Ae(t,e,r,s);var i=e;if(!isNaN(i)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=t.next(4);for(u.write_shift(2,i),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<s;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function zh(t,e,r){return t||(t=fe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Rz(t,e,r,n){var s=fe(9);return zh(s,t,e),lI(r,n||"b",s),s}function Pz(t,e,r){var n=fe(8+2*r.length);return zh(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Dz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?kr(Ot(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Ae(t,2,Ij(r,n,s)):Ae(t,3,bj(r,n,s));return;case"b":case"e":Ae(t,5,Rz(r,n,e.v,e.t));return;case"s":case"str":Ae(t,4,Pz(r,n,(e.v||"").slice(0,255)));return}Ae(t,1,zh(null,r,n))}function Fz(t,e,r,n){var s=Array.isArray(e),i=ht(e["!ref"]||"A1"),a,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=Qe(i)}for(var c=i.s.r;c<=i.e.r;++c){o=lr(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=zt(u)),a=l[u]+o;var h=s?(e[c]||[])[u]:e[a];h&&Dz(t,h,c,u)}}}function Oz(t,e){for(var r=e||{},n=Un(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,$v(t,16,r)),Fz(n,t.Sheets[t.SheetNames[s]],s,r),Ae(n,10),n.end()}function Lz(t,e,r){Ae(t,49,I8({sz:12,name:"Arial"},r))}function Mz(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ae(t,1054,O8(s,e[s],r))})}function jz(t,e){var r=fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(t,2151,r),r=fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),dI(ht(e["!ref"]||"A1"),r),r.write_shift(4,4),Ae(t,2152,r)}function Vz(t,e){for(var r=0;r<16;++r)Ae(t,224,uT({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ae(t,224,uT(n,0,e))})}function Bz(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ae(t,440,cj(n)),n[1].Tooltip&&Ae(t,2048,fj(n))}delete e["!links"]}function Uz(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Ae(t,125,xj(dp(s,n),s))})}}function $z(t,e,r,n,s){var i=16+po(s.cellXfs,e,s);if(e.v==null&&!e.bf){Ae(t,513,al(r,n,i));return}if(e.bf)Ae(t,6,m7(e,r,n,s,i));else switch(e.t){case"d":case"n":var a=e.t=="d"?kr(Ot(e.v)):e.v;Ae(t,515,q8(r,n,a,i));break;case"b":case"e":Ae(t,517,W8(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var o=Yv(s.Strings,e.v,s.revStrings);Ae(t,253,R8(r,n,o,i))}else Ae(t,516,D8(r,n,(e.v||"").slice(0,255),i,s));break;default:Ae(t,513,al(r,n,i))}}function zz(t,e,r){var n=Un(),s=r.SheetNames[t],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(i),c=e.biff==8,u,h="",m=[],p=ht(i["!ref"]||"A1"),x=c?65536:16384;if(p.e.c>255||p.e.r>=x){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Ae(n,2057,$v(r,16,e)),Ae(n,13,ds(1)),Ae(n,12,ds(100)),Ae(n,15,_n(!0)),Ae(n,17,_n(!1)),Ae(n,16,sl(.001)),Ae(n,95,_n(!0)),Ae(n,42,_n(!1)),Ae(n,43,_n(!1)),Ae(n,130,ds(1)),Ae(n,128,H8()),Ae(n,131,_n(!1)),Ae(n,132,_n(!1)),c&&Uz(n,i["!cols"]),Ae(n,512,M8(p,e)),c&&(i["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){h=lr(g);for(var v=p.s.c;v<=p.e.c;++v){g===p.s.r&&(m[v]=zt(v)),u=m[v]+h;var _=l?(i[g]||[])[v]:i[u];_&&($z(n,_,g,v,e),c&&_.l&&i["!links"].push([u,_.l]))}}var w=o.CodeName||o.name||s;return c&&Ae(n,574,k8((a.Views||[])[0])),c&&(i["!merges"]||[]).length&&Ae(n,229,nj(i["!merges"])),c&&Bz(n,i),Ae(n,442,cI(w)),c&&jz(n,i),Ae(n,10),n.end()}function Hz(t,e,r){var n=Un(),s=(t||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ae(n,2057,$v(t,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,o?ds(1200):null),Ae(n,193,WM(2)),l&&Ae(n,191),l&&Ae(n,192),Ae(n,226),Ae(n,92,d8("SheetJS",r)),Ae(n,66,ds(o?1200:1252)),o&&Ae(n,353,ds(0)),o&&Ae(n,448),Ae(n,317,wj(t.SheetNames.length)),o&&t.vbaraw&&Ae(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ae(n,442,cI(c))}Ae(n,156,ds(17)),Ae(n,25,_n(!1)),Ae(n,18,_n(!1)),Ae(n,19,ds(0)),o&&Ae(n,431,_n(!1)),o&&Ae(n,444,ds(0)),Ae(n,61,S8()),Ae(n,64,_n(!1)),Ae(n,141,ds(0)),Ae(n,34,_n(E$(t)=="true")),Ae(n,14,_n(!0)),o&&Ae(n,439,_n(!1)),Ae(n,218,ds(0)),Lz(n,t,r),Mz(n,t.SSF,r),Vz(n,r),o&&Ae(n,352,_n(!1));var u=n.end(),h=Un();o&&Ae(h,140,dj()),o&&r.Strings&&Nz(h,252,y8(r.Strings)),Ae(h,10);var m=h.end(),p=Un(),x=0,g=0;for(g=0;g<t.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*t.SheetNames[g].length;var v=u.length+x+m.length;for(g=0;g<t.SheetNames.length;++g){var _=i[g]||{};Ae(p,133,g8({pos:v,hs:_.Hidden||0,dt:0,name:t.SheetNames[g]},r)),v+=e[g].length}var w=p.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),m.length&&y.push(m),Fr(y)}function Wz(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Lt(Me)),t&&t.SSF&&(su(),ap(t.SSF),r.revssf=lp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,tw(r),r.cellXfs=[],po(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=zz(s,r,t);return n.unshift(Hz(t,n,r)),Fr(n)}function rN(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=zn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return Wz(t,e);case 4:case 3:case 2:return Oz(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function AT(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=IL(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<l.length;++a){var g=l[a].trim(),v=g.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var _=g.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var w=_[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,I=0;y.charAt(0)=="<"&&(I=y.indexOf(">"))>-1;)y=y.slice(I+1);for(var O=0;O<x.length;++O){var P=x[O];P.s.c==u&&P.s.r<c&&c<=P.e.r&&(u=P.e.c+1,O=-1)}var S=$e(w.slice(0,w.indexOf(">")));m=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||m>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+m-1}});var E=S.t||S["data-t"]||"";if(!y.length){u+=m;continue}if(y=k4(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=m;continue}var A={t:"s",v:y};r.raw||!y.trim().length||E=="s"||(y==="TRUE"?A={t:"b",v:!0}:y==="FALSE"?A={t:"b",v:!1}:isNaN(qs(y))?isNaN(Uc(y).getDate())||(A={t:"d",v:Ot(y)},r.cellDates||(A={t:"n",v:kr(A.v)}),A.z=r.dateNF||Me[14]):A={t:"n",v:qs(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=A):n[je({r:c,c:u})]=A,u+=m}}}}return n["!ref"]=Qe(p),x.length&&(n["!merges"]=x),n}function Gz(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=je({r,c:a}),h=n.dense?(t[r]||[])[a]:t[u],m=h&&h.v!=null&&(h.h||Iv(h.w||(Ji(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(Se("td",m,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var qz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Kz="</body></html>";function Xz(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return mo(AT(r[0],e),e);var n=sw();return r.forEach(function(s,i){iw(n,AT(s,e),"Sheet"+(i+1))}),n}function Yz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nN(t,e){var r=e||{},n=r.header!=null?r.header:qz,s=r.footer!=null?r.footer:Kz,i=[n],a=zn(t["!ref"]);r.dense=Array.isArray(t),i.push(Yz(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(Gz(t,a,o,r));return i.push("</table>"+s),i.join("")}function sN(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Ht(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=zn(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],m=0,p=t["!rows"]||(t["!rows"]=[]),x=0,g=0,v=0,_=0,w=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&g<l;++x){var I=o[x];if(kT(I)){if(n.display)continue;p[g]={hidden:!0}}var O=I.children;for(v=_=0;v<O.length;++v){var P=O[v];if(!(n.display&&kT(P))){var S=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):k4(P.innerHTML),E=P.getAttribute("data-z")||P.getAttribute("z");for(m=0;m<h.length;++m){var A=h[m];A.s.c==_+i&&A.s.r<g+s&&g+s<=A.e.r&&(_=A.e.c+1-i,m=-1)}y=+P.getAttribute("colspan")||1,((w=+P.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:g+s,c:_+i},e:{r:g+s+(w||1)-1,c:_+i+(y||1)-1}});var N={t:"s",v:S},C=P.getAttribute("data-t")||P.getAttribute("t")||"";S!=null&&(S.length==0?N.t=C||"z":n.raw||S.trim().length==0||C=="s"||(S==="TRUE"?N={t:"b",v:!0}:S==="FALSE"?N={t:"b",v:!1}:isNaN(qs(S))?isNaN(Uc(S).getDate())||(N={t:"d",v:Ot(S)},n.cellDates||(N={t:"n",v:kr(N.v)}),N.z=n.dateNF||Me[14]):N={t:"n",v:qs(S)})),N.z===void 0&&E!=null&&(N.z=E);var R="",F=P.getElementsByTagName("A");if(F&&F.length)for(var oe=0;oe<F.length&&!(F[oe].hasAttribute("href")&&(R=F[oe].getAttribute("href"),R.charAt(0)!="#"));++oe);R&&R.charAt(0)!="#"&&(N.l={Target:R}),n.dense?(t[g+s]||(t[g+s]=[]),t[g+s][_+i]=N):t[je({c:_+i,r:g+s})]=N,c.e.c<_+i&&(c.e.c=_+i),_+=y}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),t["!ref"]=Qe(c),g>=l&&(t["!fullref"]=Qe((c.e.r=o.length-x+g-1+s,c))),t}function iN(t,e){var r=e||{},n=r.dense?[]:{};return sN(n,t,e)}function Qz(t,e){return mo(iN(t,e),e)}function kT(t){var e="",r=Jz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Jz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Zz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ft(e.replace(/<[^>]*>/g,""));return[r]}var bT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function aN(t,e){var r=e||{},n=Nv(t),s=[],i,a,o={name:""},l="",c=0,u,h,m={},p=[],x=r.dense?[]:{},g,v,_={value:""},w="",y=0,I=[],O=-1,P=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,A={},N=[],C={},R=0,F=0,oe=[],ae=1,ve=1,he=[],Z={Names:[]},W={},ie=["",""],ue=[],L={},K="",X=0,H=!1,re=!1,ee=0;for(nh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=nh.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?x["!ref"]=Qe(S):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(x["!fullref"]=x["!ref"],S.e.r=r.sheetRows-1,x["!ref"]=Qe(S)),N.length&&(x["!merges"]=N),oe.length&&(x["!rows"]=oe),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),m[u.name]=x,re=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=$e(g[0],!1),O=P=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,x=r.dense?[]:{},N=[],oe=[],re=!0);break;case"table-row-group":g[1]==="/"?--E:++E;break;case"table-row":case"":if(g[1]==="/"){O+=ae,ae=1;break}if(h=$e(g[0],!1),h.?O=h.-1:O==-1&&(O=0),ae=+h["number-rows-repeated"]||1,ae<10)for(ee=0;ee<ae;++ee)E>0&&(oe[O+ee]={level:E});P=-1;break;case"covered-table-cell":g[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[O]||(x[O]=[]),x[O][P]={t:"z"}):x[je({r:O,c:P})]={t:"z"}),w="",I=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++P,_=$e(g[0],!1),ve=parseInt(_["number-columns-repeated"]||"1",10),v={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(v.f=ET(ft(_.formula))),(_.||_["value-type"])=="string"&&(v.t="s",v.v=ft(_["string-value"]||""),r.dense?(x[O]||(x[O]=[]),x[O][P]=v):x[je({r:O,c:P})]=v),P+=ve-1;else if(g[1]!=="/"){++P,w="",y=0,I=[],ve=1;var le=ae?O+ae-1:O;if(P>S.e.c&&(S.e.c=P),P<S.s.c&&(S.s.c=P),O<S.s.r&&(S.s.r=O),le>S.e.r&&(S.e.r=le),_=$e(g[0],!1),ue=[],L={},v={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=ft(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(R=parseInt(_["number-matrix-rows-spanned"],10)||0,F=parseInt(_["number-matrix-columns-spanned"],10)||0,C={s:{r:O,c:P},e:{r:O+R-1,c:P+F-1}},v.F=Qe(C),he.push([C,v.F])),_.formula)v.f=ET(_.formula);else for(ee=0;ee<he.length;++ee)O>=he[ee][0].s.r&&O<=he[ee][0].e.r&&P>=he[ee][0].s.c&&P<=he[ee][0].e.c&&(v.F=he[ee][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(R=parseInt(_["number-rows-spanned"],10)||0,F=parseInt(_["number-columns-spanned"],10)||0,C={s:{r:O,c:P},e:{r:O+R-1,c:P+F-1}},N.push(C)),_["number-columns-repeated"]&&(ve=parseInt(_["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Rt(_["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(_.value);break;case"percentage":v.t="n",v.v=parseFloat(_.value);break;case"currency":v.t="n",v.v=parseFloat(_.value);break;case"date":v.t="d",v.v=Ot(_["date-value"]),r.cellDates||(v.t="n",v.v=kr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=kL(_["time-value"])/86400,r.cellDates&&(v.t="d",v.v=cp(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(_.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",_["string-value"]!=null&&(w=ft(_["string-value"]),I=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(H=!1,v.t==="s"&&(v.v=w||"",I.length&&(v.R=I),H=y==0),W.Target&&(v.l=W),ue.length>0&&(v.c=ue,ue=[]),w&&r.cellText!==!1&&(v.w=w),H&&(v.t="z",delete v.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var we=0;we<ae;++we){if(ve=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(x[O+we]||(x[O+we]=[]),x[O+we][P]=we==0?v:Lt(v);--ve>0;)x[O+we][P+ve]=Lt(v);else for(x[je({r:O+we,c:P})]=v;--ve>0;)x[je({r:O+we,c:P+ve})]=Lt(v);S.e.c<=P&&(S.e.c=P)}ve=parseInt(_["number-columns-repeated"]||"1",10),P+=ve-1,ve=0,v={},w="",I=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;L.t=w,I.length&&(L.R=I),L.a=K,ue.push(L)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);K="",X=0,w="",y=0,I=[];break;case"creator":g[1]==="/"?K=n.slice(X,g.index):X=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);w="",y=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(A[o.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=$e(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=$e(g[0],!1),l+=bT[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=$e(g[0],!1),l+=bT[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":a=$e(g[0],!1),ie=Pg(a["cell-range-address"]);var de={Name:a.name,Ref:ie[0]+"!"+ie[1]};re&&(de.Sheet=p.length),Z.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!_||!_["string-value"])){var Pe=Zz(n.slice(y,g.index));w=(w.length>0?w+`
`:"")+Pe[0]}else $e(g[0],!1),y=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ie=Pg($e(g[0])["target-range-address"]),m[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(W=$e(g[0],!1),!W.href)break;W.Target=ft(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(ie=Pg(W.Target.slice(1)),W.Target="#"+ie[0]+"!"+ie[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var B={Sheets:m,SheetNames:p,Workbook:Z};return r.bookSheets&&delete B.Sheets,B}function CT(t,e){e=e||{},hs(t,"META-INF/manifest.xml")&&kM(dr(t,"META-INF/manifest.xml"),e);var r=Qn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=aN(Tt(r),e);return hs(t,"meta.xml")&&(n.Props=Y4(dr(t,"meta.xml"))),n}function IT(t,e){return aN(t,e)}var eH=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+rh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return cr+e}}(),NT=function(){var t=function(i){return wt(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var l=[];l.push('      <table:table table:name="'+wt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=zn(i["!ref"]||"A1"),m=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",v=i["!rows"]||[];for(c=0;c<h.s.r;++c)g=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var _=!1,w={},y="";for(p=0;p!=m.length;++p)if(!(m[p].s.c>u)&&!(m[p].s.r>c)&&!(m[p].e.c<u)&&!(m[p].e.r<c)){(m[p].s.c!=u||m[p].s.r!=c)&&(_=!0),w["table:number-columns-spanned"]=m[p].e.c-m[p].s.c+1,w["table:number-rows-spanned"]=m[p].e.r-m[p].s.r+1;break}if(_){l.push(r);continue}var I=je({r:c,c:u}),O=x?(i[c]||[])[u]:i[I];if(O&&O.f&&(w["table:formula"]=wt(w7(O.f)),O.F&&O.F.slice(0,I.length)==I)){var P=zn(O.F);w["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,w["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":y=O.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=O.v?"true":"false";break;case"n":y=O.w||String(O.v||0),w["office:value-type"]="float",w["office:value"]=O.v||0;break;case"s":case"str":y=O.v==null?"":O.v,w["office:value-type"]="string";break;case"d":y=O.w||Ot(O.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Ot(O.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(e);continue}var S=t(y);if(O.l&&O.l.Target){var E=O.l.Target;E=E.charAt(0)=="#"?"#"+_7(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),S=Se("text:a",S,{"xlink:href":E.replace(/&/g,"&amp;")})}l.push("          "+Se("table:table-cell",Se("text:p",S,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Qa(h),h.ods=o;var m=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var l=[cr],c=rh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=rh({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(X4().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function oN(t,e){if(e.bookType=="fods")return NT(t,e);var r=kv(),n="",s=[],i=[];return n="mimetype",Ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ze(r,n,NT(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ze(r,n,eH(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ze(r,n,cr+X4()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ze(r,n,IM(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ze(r,n,bM(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ol(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function T1(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Tt(ho(t))}function tH(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Yn(ui(t))}function rH(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Za(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function RT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function nH(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function sH(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function uh(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function yt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function er(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function mt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=uh(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=uh(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Br(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(yt(n*8+s.type)),s.type==2&&e.push(yt(s.data.length)),e.push(s.data))})}),Za(e)}function Zv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function cs(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=uh(t,n),i=mt(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:er(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=mt(o.data),c=er(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=er(i[3][0].data)>>>0>0),r.push(a)}return r}function Vl(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:yt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:yt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:yt(a.data.length)}],n[2].push({data:Br(a.meta),type:2})});var i=Br(n);e.push(yt(i.length)),e.push(i),s.forEach(function(a){return e.push(a)})}),Za(e)}function iH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=uh(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Za(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Za(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function us(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(iH(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Za(e)}function Bl(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=yt(n),a=i.length;e.push(i),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Za(e)}function aH(t,e,r,n){var s=ol(t),i=s.getUint32(4,!0),a=(n>1?12:8)+RT(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=RT(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function oH(t,e,r){var n=ol(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=nH(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function Fg(t,e){var r=new Uint8Array(32),n=ol(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,sH(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Og(t,e){var r=new Uint8Array(32),n=ol(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function lH(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return aH(t,e,r,t[0]);case 5:return oH(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function sn(t){var e=mt(t);return uh(e[1][0].data)}function PT(t,e){var r=mt(e.data),n=er(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=mt(a.data),l=er(o[1][0].data)>>>0;switch(n){case 1:i[l]=T1(o[3][0].data);break;case 8:{var c=t[sn(o[9][0].data)][0],u=mt(c.data),h=t[sn(u[1][0].data)][0],m=er(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=mt(h.data);i[l]=p[3].map(function(x){return T1(x.data)}).join("")}break}}),i}function cH(t,e){var r,n,s,i,a,o,l,c,u,h,m,p,x,g,v=mt(t),_=er(v[1][0].data)>>>0,w=er(v[2][0].data)>>>0,y=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&er(v[8][0].data)>0||!1,I,O;if((i=(s=v[7])==null?void 0:s[0])!=null&&i.data&&e!=0)I=(o=(a=v[7])==null?void 0:a[0])==null?void 0:o.data,O=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=v[4])==null?void 0:u[0])!=null&&h.data&&e!=1)I=(p=(m=v[4])==null?void 0:m[0])==null?void 0:p.data,O=(g=(x=v[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var P=y?4:1,S=ol(I),E=[],A=0;A<I.length/2;++A){var N=S.getUint16(A*2,!0);N<65535&&E.push([A,N])}if(E.length!=w)throw"Expected ".concat(w," cells, found ").concat(E.length);var C=[];for(A=0;A<E.length-1;++A)C[E[A][0]]=O.subarray(E[A][1]*P,E[A+1][1]*P);return E.length>=1&&(C[E[E.length-1][0]]=O.subarray(E[E.length-1][1]*P)),{R:_,cells:C}}function uH(t,e){var r,n=mt(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?er(n[7][0].data)>>>0>0?1:0:-1,i=Zv(n[5],function(a){return cH(a,s)});return{nrows:er(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function fH(t,e,r){var n,s=mt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(er(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(er(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Qe(i);var a=mt(s[4][0].data),o=PT(t,t[sn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?PT(t,t[sn(a[17][0].data)][0]):[],c=mt(a[3][0].data),u=0;c[1].forEach(function(h){var m=mt(h.data),p=t[sn(m[2][0].data)][0],x=er(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=uH(t,p);g.data.forEach(function(v,_){v.forEach(function(w,y){var I=je({r:u+_,c:y}),O=lH(w,o,l);O&&(r[I]=O)})}),u+=g.nrows})}function hH(t,e){var r=mt(e.data),n={"!ref":"A1"},s=t[sn(r[2][0].data)],i=er(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return fH(t,s[0],n),n}function dH(t,e){var r,n=mt(e.data),s={name:(r=n[1])!=null&&r[0]?T1(n[1][0].data):"",sheets:[]},i=Zv(n[2],sn);return i.forEach(function(a){t[a].forEach(function(o){var l=er(o.meta[1][0].data);l==6e3&&s.sheets.push(hH(t,o))})}),s}function mH(t,e){var r=sw(),n=mt(e.data),s=Zv(n[1],sn);if(s.forEach(function(i){t[i].forEach(function(a){var o=er(a.meta[1][0].data);if(o==2){var l=dH(t,a);l.sheets.forEach(function(c,u){iw(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Lg(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=us(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=cs(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&er(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=er(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return mH(i,o)}function pH(t,e,r){var n,s,i,a;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=t[8])==null?void 0:i[0])==null?void 0:a.data)&&er(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ol(t[7][0].data),u=0,h=[],m=ol(t[4][0].data),p=0,x=[],g=0;g<e.length;++g){if(e[g]==null){c.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),m.setUint16(g*2,p,!0);var v,_;switch(typeof e[g]){case"string":v=Fg({t:"s",v:e[g]},r),_=Og({t:"s",v:e[g]},r);break;case"number":v=Fg({t:"n",v:e[g]},r),_=Og({t:"n",v:e[g]},r);break;case"boolean":v=Fg({t:"b",v:e[g]},r),_=Og({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}h.push(v),u+=v.length,x.push(_),p+=_.length,++l}for(t[2][0].data=yt(l);g<t[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return t[6][0].data=Za(h),t[3][0].data=Za(x),l}function gH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=zn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Qe(n)));var i=gm(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(K){return K.forEach(function(X){typeof X=="string"&&a.push(X)})});var o={},l=[],c=De.read(e.numbers,{type:"base64"});c.FileIndex.map(function(K,X){return[K,c.FullPaths[X]]}).forEach(function(K){var X=K[0],H=K[1];if(X.type==2&&X.name.match(/\.iwa/)){var re=X.content,ee=us(re),le=cs(ee);le.forEach(function(we){l.push(we.id),o[we.id]={deps:[],location:H,type:er(we.messages[0].meta[1][0].data)}})}}),l.sort(function(K,X){return K-X});var u=l.filter(function(K){return K>1}).map(function(K){return[K,yt(K)]});c.FileIndex.map(function(K,X){return[K,c.FullPaths[X]]}).forEach(function(K){var X=K[0];if(K[1],!!X.name.match(/\.iwa/)){var H=cs(us(X.content));H.forEach(function(re){re.messages.forEach(function(ee){u.forEach(function(le){re.messages.some(function(we){return er(we.meta[1][0].data)!=11006&&rH(we.data,le[1])})&&o[le[0]].deps.push(re.id)})})})}});for(var h=De.find(c,o[1].location),m=cs(us(h.content)),p,x=0;x<m.length;++x){var g=m[x];g.id==1&&(p=g)}var v=sn(mt(p.messages[0].data)[1][0].data);for(h=De.find(c,o[v].location),m=cs(us(h.content)),x=0;x<m.length;++x)g=m[x],g.id==v&&(p=g);for(v=sn(mt(p.messages[0].data)[2][0].data),h=De.find(c,o[v].location),m=cs(us(h.content)),x=0;x<m.length;++x)g=m[x],g.id==v&&(p=g);for(v=sn(mt(p.messages[0].data)[2][0].data),h=De.find(c,o[v].location),m=cs(us(h.content)),x=0;x<m.length;++x)g=m[x],g.id==v&&(p=g);var _=mt(p.messages[0].data);{_[6][0].data=yt(n.e.r+1),_[7][0].data=yt(n.e.c+1);var w=sn(_[46][0].data),y=De.find(c,o[w].location),I=cs(us(y.content));{for(var O=0;O<I.length&&I[O].id!=w;++O);if(I[O].id!=w)throw"Bad ColumnRowUIDMapArchive";var P=mt(I[O].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var S=0;S<=n.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:yt(S+420690)}],P[1].push({type:2,data:Br(E)}),P[2].push({type:0,data:yt(S)}),P[3].push({type:0,data:yt(S)})}P[4]=[],P[5]=[],P[6]=[];for(var A=0;A<=n.e.r;++A)E=[],E[1]=E[2]=[{type:0,data:yt(A+726270)}],P[4].push({type:2,data:Br(E)}),P[5].push({type:0,data:yt(A)}),P[6].push({type:0,data:yt(A)});I[O].messages[0].data=Br(P)}y.content=Bl(Vl(I)),y.size=y.content.length,delete _[46];var N=mt(_[4][0].data);{N[7][0].data=yt(n.e.r+1);var C=mt(N[1][0].data),R=sn(C[2][0].data);y=De.find(c,o[R].location),I=cs(us(y.content));{if(I[0].id!=R)throw"Bad HeaderStorageBucket";var F=mt(I[0].messages[0].data);for(A=0;A<i.length;++A){var oe=mt(F[2][0].data);oe[1][0].data=yt(A),oe[4][0].data=yt(i[A].length),F[2][A]={type:F[2][0].type,data:Br(oe)}}I[0].messages[0].data=Br(F)}y.content=Bl(Vl(I)),y.size=y.content.length;var ae=sn(N[2][0].data);y=De.find(c,o[ae].location),I=cs(us(y.content));{if(I[0].id!=ae)throw"Bad HeaderStorageBucket";for(F=mt(I[0].messages[0].data),S=0;S<=n.e.c;++S)oe=mt(F[2][0].data),oe[1][0].data=yt(S),oe[4][0].data=yt(n.e.r+1),F[2][S]={type:F[2][0].type,data:Br(oe)};I[0].messages[0].data=Br(F)}y.content=Bl(Vl(I)),y.size=y.content.length;var ve=sn(N[4][0].data);(function(){for(var K=De.find(c,o[ve].location),X=cs(us(K.content)),H,re=0;re<X.length;++re){var ee=X[re];ee.id==ve&&(H=ee)}var le=mt(H.messages[0].data);{le[3]=[];var we=[];a.forEach(function(B,et){we[1]=[{type:0,data:yt(et)}],we[2]=[{type:0,data:yt(1)}],we[3]=[{type:2,data:tH(B)}],le[3].push({type:2,data:Br(we)})})}H.messages[0].data=Br(le);var de=Vl(X),Pe=Bl(de);K.content=Pe,K.size=K.content.length})();var he=mt(N[3][0].data);{var Z=he[1][0];delete he[2];var W=mt(Z.data);{var ie=sn(W[2][0].data);(function(){for(var K=De.find(c,o[ie].location),X=cs(us(K.content)),H,re=0;re<X.length;++re){var ee=X[re];ee.id==ie&&(H=ee)}var le=mt(H.messages[0].data);{delete le[6],delete he[7];var we=new Uint8Array(le[5][0].data);le[5]=[];for(var de=0,Pe=0;Pe<=n.e.r;++Pe){var B=mt(we);de+=pH(B,i[Pe],a),B[1][0].data=yt(Pe),le[5].push({data:Br(B),type:2})}le[1]=[{type:0,data:yt(n.e.c+1)}],le[2]=[{type:0,data:yt(n.e.r+1)}],le[3]=[{type:0,data:yt(de)}],le[4]=[{type:0,data:yt(n.e.r+1)}]}H.messages[0].data=Br(le);var et=Vl(X),Ye=Bl(et);K.content=Ye,K.size=K.content.length})()}Z.data=Br(W)}N[3][0].data=Br(he)}_[4][0].data=Br(N)}p.messages[0].data=Br(_);var ue=Vl(m),L=Bl(ue);return h.content=L,h.size=h.content.length,c}function lN(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function ew(t){lN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function tw(t){lN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function xH(t){return nt.WS.indexOf(t)>-1?"sheet":t==nt.CS?"chart":t==nt.DS?"dialog":t==nt.MS?"macro":t&&t.length?t:"sheet"}function yH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,xH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function vH(t,e,r,n,s,i,a,o,l,c,u,h){try{i[n]=df(Qn(t,r,!0),e);var m=dr(t,e),p;switch(o){case"sheet":p=U$(m,e,s,l,i[n],c,u,h);break;case"chart":if(p=$$(m,e,s,l,i[n],c,u,h),!p||!p["!drawel"])break;var x=Gu(p["!drawel"].Target,e),g=sh(x),v=CV(Qn(t,x,!0),df(Qn(t,g,!0),x)),_=Gu(v,x),w=sh(_);p=p$(Qn(t,_,!0),_,l,df(Qn(t,w,!0),_),c,p);break;case"macro":p=z$(m,e,s,l,i[n],c,u,h);break;case"dialog":p=H$(m,e,s,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var y=[];i&&i[n]&&tr(i[n]).forEach(function(I){var O="";if(i[n][I].Type==nt.CMNT){O=Gu(i[n][I].Target,e);var P=K$(dr(t,O,!0),O,l);if(!P||!P.length)return;xT(p,P,!1)}i[n][I].Type==nt.TCMNT&&(O=Gu(i[n][I].Target,e),y=y.concat(NV(dr(t,O,!0),l)))}),y&&y.length&&xT(p,y,!0,l.people||[])}catch(I){if(l.WTF)throw I}}function as(t){return t.charAt(0)=="/"?t.slice(1):t}function wH(t,e){if(su(),e=e||{},ew(e),hs(t,"META-INF/manifest.xml")||hs(t,"objectdata.xml"))return CT(t,e);if(hs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lg<"u"){if(t.FileIndex)return Lg(t);var r=De.utils.cfb_new();return jE(t).forEach(function(oe){Ze(r,oe,RL(t,oe))}),Lg(r)}throw new Error("Unsupported NUMBERS file")}if(!hs(t,"[Content_Types].xml"))throw hs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):hs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=jE(t),s=SM(Qn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",dr(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!dr(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(mf=[],s.sst)try{mf=q$(dr(t,as(s.sst)),s.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&s.themes.length&&(l=G$(Qn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=W$(dr(t,as(s.style)),s.style,l,e))}s.links.map(function(oe){try{var ae=df(Qn(t,sh(as(oe))),oe);return Y$(dr(t,as(oe)),ae,oe,e)}catch{}});var u=B$(dr(t,as(s.workbooks[0])),s.workbooks[0],e),h={},m="";s.coreprops.length&&(m=dr(t,as(s.coreprops[0]),!0),m&&(h=Y4(m)),s.extprops.length!==0&&(m=dr(t,as(s.extprops[0]),!0),m&&RM(m,h,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=Qn(t,as(s.custprops[0]),!0),m&&(p=DM(m,e)));var x={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(ae){return ae.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=p),e.bookSheets&&typeof a<"u"&&(x.SheetNames=a),e.bookSheets?x.SheetNames:e.bookProps))return x;a={};var g={};e.bookDeps&&s.calcchain&&(g=X$(dr(t,as(s.calcchain)),s.calcchain));var v=0,_={},w,y;{var I=u.Sheets;h.Worksheets=I.length,h.SheetNames=[];for(var O=0;O!=I.length;++O)h.SheetNames[O]=I[O].name}var P=i?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");hs(t,E)||(E="xl/_rels/workbook."+P+".rels");var A=df(Qn(t,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Q$(dr(t,as(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=PV(dr(t,as(s.people[0])),e)),A&&(A=yH(A,u.Sheets));var N=dr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var C="sheet";if(A&&A[v]?(w="xl/"+A[v][1].replace(/[\/]?xl\//,""),hs(t,w)||(w=A[v][1]),hs(t,w)||(w=E.replace(/_rels\/.*$/,"")+A[v][1]),C=A[v][2]):(w="xl/worksheets/sheet"+(v+1-N)+"."+P,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(v!=e.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var R=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==v&&(R=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[v].toLowerCase()&&(R=1);if(!R)continue e}}vH(t,w,y,h.SheetNames[v],v,_,a,C,e,u,l,c)}return x={Directory:s,Workbook:u,Props:h,Custprops:p,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:mf,Styles:c,Themes:l,SSF:Lt(Me)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(oe,ae){oe=oe.replace(/^Root Entry[\/]/,""),x.keys.push(oe),x.files[oe]=t.FileIndex[ae]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=dr(t,as(s.vba[0]),!0):s.defaults&&s.defaults.bin===BV&&(x.vbaraw=dr(t,"xl/vbaProject.bin",!0))),x}function _H(t,e){var r=e||{},n="Workbook",s=De.find(t,n);try{if(n="/!DataSpaces/Version",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Qj(s.content),n="/!DataSpaces/DataSpaceMap",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Zj(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=e9(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);r9(s.content)}catch{}if(n="/EncryptionInfo",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=n9(s.content);if(n="/EncryptedPackage",s=De.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function EH(t,e){return e.bookType=="ods"?oN(t,e):e.bookType=="numbers"?gH(t,e):e.bookType=="xlsb"?TH(t,e):SH(t,e)}function TH(t,e){ic=1024,t&&!t.SSF&&(t.SSF=Lt(Me)),t&&t.SSF&&(su(),ap(t.SSF),e.revssf=lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=OI.indexOf(e.bookType)>-1,s=Bv();tw(e=e||{});var i=kv(),a="",o=0;if(e.cellXfs=[],po(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ze(i,a,Q4(t.Props,e)),s.coreprops.push(a),vt(e.rels,2,a,nt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Ze(i,a,eI(t.Props)),s.extprops.push(a),vt(e.rels,3,a,nt.EXT_PROPS),t.Custprops!==t.Props&&tr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ze(i,a,tI(t.Custprops)),s.custprops.push(a),vt(e.rels,4,a,nt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var u={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ze(i,a,Z$(o-1,a,e,t,u)),s.sheets.push(a),vt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(h){var p=h["!comments"],x=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,Ze(i,g,rz(p,g)),s.comments.push(g),vt(u,-1,"../comments"+o+"."+r,nt.CMNT),x=!0),h["!legacy"]&&x&&Ze(i,"xl/drawings/vmlDrawing"+o+".vml",DI(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Ze(i,sh(a),_c(u))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ze(i,a,tz(e.Strings,a,e)),s.strs.push(a),vt(e.wbrels,-1,"sharedStrings."+r,nt.SST)),a="xl/workbook."+r,Ze(i,a,J$(t,a)),s.workbooks.push(a),vt(e.rels,1,a,nt.WB),a="xl/theme/theme1.xml",Ze(i,a,Gv(t.Themes,e)),s.themes.push(a),vt(e.wbrels,-1,"theme/theme1.xml",nt.THEME),a="xl/styles."+r,Ze(i,a,ez(t,a,e)),s.styles.push(a),vt(e.wbrels,-1,"styles."+r,nt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ze(i,a,t.vbaraw),s.vba.push(a),vt(e.wbrels,-1,"vbaProject.bin",nt.VBA)),a="xl/metadata."+r,Ze(i,a,nz(a)),s.metadata.push(a),vt(e.wbrels,-1,"metadata."+r,nt.XLMETA),Ze(i,"[Content_Types].xml",K4(s,e)),Ze(i,"_rels/.rels",_c(e.rels)),Ze(i,"xl/_rels/workbook."+r+".rels",_c(e.wbrels)),delete e.revssf,delete e.ssf,i}function SH(t,e){ic=1024,t&&!t.SSF&&(t.SSF=Lt(Me)),t&&t.SSF&&(su(),ap(t.SSF),e.revssf=lp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=OI.indexOf(e.bookType)>-1,s=Bv();tw(e=e||{});var i=kv(),a="",o=0;if(e.cellXfs=[],po(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ze(i,a,Q4(t.Props,e)),s.coreprops.push(a),vt(e.rels,2,a,nt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Ze(i,a,eI(t.Props)),s.extprops.push(a),vt(e.rels,3,a,nt.EXT_PROPS),t.Custprops!==t.Props&&tr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ze(i,a,tI(t.Custprops)),s.custprops.push(a),vt(e.rels,4,a,nt.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],p=(m||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ze(i,a,GI(o-1,e,t,h)),s.sheets.push(a),vt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(m){var x=m["!comments"],g=!1,v="";if(x&&x.length>0){var _=!1;x.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(_=!0)})}),_&&(v="xl/threadedComments/threadedComment"+o+"."+r,Ze(i,v,RV(x,u,e)),s.threadedcomments.push(v),vt(h,-1,"../threadedComments/threadedComment"+o+"."+r,nt.TCMNT)),v="xl/comments"+o+"."+r,Ze(i,v,FI(x)),s.comments.push(v),vt(h,-1,"../comments"+o+"."+r,nt.CMNT),g=!0}m["!legacy"]&&g&&Ze(i,"xl/drawings/vmlDrawing"+o+".vml",DI(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Ze(i,sh(a),_c(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ze(i,a,_I(e.Strings,e)),s.strs.push(a),vt(e.wbrels,-1,"sharedStrings."+r,nt.SST)),a="xl/workbook."+r,Ze(i,a,QI(t)),s.workbooks.push(a),vt(e.rels,1,a,nt.WB),a="xl/theme/theme1.xml",Ze(i,a,Gv(t.Themes,e)),s.themes.push(a),vt(e.wbrels,-1,"theme/theme1.xml",nt.THEME),a="xl/styles."+r,Ze(i,a,II(t,e)),s.styles.push(a),vt(e.wbrels,-1,"styles."+r,nt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ze(i,a,t.vbaraw),s.vba.push(a),vt(e.wbrels,-1,"vbaProject.bin",nt.VBA)),a="xl/metadata."+r,Ze(i,a,PI()),s.metadata.push(a),vt(e.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ze(i,a,DV(u)),s.people.push(a),vt(e.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Ze(i,"[Content_Types].xml",K4(s,e)),Ze(i,"_rels/.rels",_c(e.rels)),Ze(i,"xl/_rels/workbook."+r+".rels",_c(e.wbrels)),delete e.revssf,delete e.ssf,i}function rw(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ns(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AH(t,e){return De.find(t,"EncryptedPackage")?_H(t,e):tN(t,e)}function kH(t,e){var r,n=t,s=e||{};return s.type||(s.type=rt&&Buffer.isBuffer(t)?"buffer":"base64"),r=T4(n,s),wH(r,s)}function cN(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _1(t.slice(r),e);default:break e}return $c.to_workbook(t,e)}function bH(t,e){var r="",n=rw(t,e);switch(e.type){case"base64":r=ns(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=nl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Tt(r)),e.type="binary",cN(r,e)}function CH(t,e){var r=t;return e.type=="base64"&&(r=ns(r)),r=Jf.utils.decode(1200,r.slice(2),"str"),e.type="binary",cN(r,e)}function IH(t){return t.match(/[^\x00-\x7F]/)?ui(t):t}function Mg(t,e,r,n){return n?(r.type="string",$c.to_workbook(t,r)):$c.to_workbook(e,r)}function fh(t,e){_v();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return fh(new Uint8Array(t),(r=Lt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Tc={},r.dateNF&&(Tc.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",n=TL(t),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=IH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Lt(r),r.type="array",fh(Ev(n),r)}switch((s=rw(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return AH(De.read(n,r),r);break;case 9:if(s[1]<=8)return tN(n,r);break;case 60:return _1(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Fj(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return vI.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?kH(n,r):Mg(t,n,r,i);case 239:return s[3]===60?_1(n,r):Mg(t,n,r,i);case 255:if(s[1]===254)return CH(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Wo.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Wo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return w1.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return kI.to_workbook(n,r);break;case 10:case 13:case 32:return bH(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Dj.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?w1.to_workbook(n,r):Mg(t,n,r,i)}function uN(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Lh(e.file,De.write(t,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return De.write(t,e)}function NH(t,e){var r=Lt(e||{}),n=EH(t,r);return RH(n,r)}function RH(t,e){var r={},n=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?De.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(ip(s))}return e.password&&typeof encrypt_agile<"u"?uN(encrypt_agile(s,e.password),e):e.type==="file"?Lh(e.file,s):e.type=="string"?Tt(s):s}function PH(t,e){var r=e||{},n=Iz(t,r);return uN(n,r)}function ai(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Zf(ui(n));case"binary":return ui(n);case"string":return t;case"file":return Lh(e.file,n,"utf8");case"buffer":return rt?aa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ai(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function DH(t,e){switch(e.type){case"base64":return Zf(t);case"binary":return t;case"string":return t;case"file":return Lh(e.file,t,"binary");case"buffer":return rt?aa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Kd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Zf(r):e.type=="string"?Tt(r):r;case"file":return Lh(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function fN(t,e){_v(),A$(t);var r=Lt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=fN(t,r);return r.type="array",ip(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ai(Ez(t,r),r);case"slk":case"sylk":return ai(yI.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return ai(nN(t.Sheets[t.SheetNames[s]],r),r);case"txt":return DH(hN(t.Sheets[t.SheetNames[s]],r),r);case"csv":return ai(nw(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return ai(vI.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return Kd(w1.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return ai($c.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return ai(kI.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return ai(wI.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return ai(oN(t,r),r);case"wk1":return Kd(Wo.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return Kd(Wo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Kd(rN(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),PH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NH(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function FH(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function OH(t,e,r){var n={};return n.type="file",n.file=e,FH(n),fN(t,n)}function LH(t,e,r,n,s,i,a,o){var l=lr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=a?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;i[p]!=null&&(m[i[p]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[i[p]]=null;else if(c!==void 0)m[i[p]]=c;else if(u&&g===null)m[i[p]]=null;else continue;else m[i[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Ji(x,g,o);g!=null&&(h=!1)}}return{row:m,isempty:h}}function gm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ht(u);break;case"number":l=ht(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=lr(l.s.r),m=[],p=[],x=0,g=0,v=Array.isArray(t),_=l.s.r,w=0,y={};v&&!t[_]&&(t[_]=[]);var I=c.skipHidden&&t["!cols"]||[],O=c.skipHidden&&t["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(I[w]||{}).hidden)switch(m[w]=zt(w),r=v?t[_][w]:t[m[w]+h],n){case 1:i[w]=w-l.s.c;break;case 2:i[w]=m[w];break;case 3:i[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ji(r,null,c),g=y[a]||0,!g)y[a]=1;else{do o=a+"_"+g++;while(y[o]);y[a]=g,y[o]=1}i[w]=o}for(_=l.s.r+s;_<=l.e.r;++_)if(!(O[_]||{}).hidden){var P=LH(t,l,_,m,n,i,v,c);(P.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=P.row)}return p.length=x,p}var DT=/"/g;function MH(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",h=lr(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var p=o.dense?(t[r]||[])[m]:t[n[m]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Ji(p,null,o));for(var x=0,g=0;x!==u.length;++x)if((g=u.charCodeAt(x))===s||g===i||g===34||o.forceQuotes){u='"'+u.replace(DT,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(DT,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function nw(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=ht(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(h[x]=zt(x));for(var g=0,v=s.s.r;v<=s.e.r;++v)(p[v]||{}).hidden||(u=MH(t,s,v,h,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function hN(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=nw(t,e);return r}function jH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=ht(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=zt(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=lr(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function dN(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Ht(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=ht(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var m=n.header||[],p=0;e.forEach(function(g,v){tr(g).forEach(function(_){(p=m.indexOf(_))==-1&&(m[p=m.length]=_);var w=g[_],y="z",I="",O=je({c:o+p,r:a+v+s});c=hh(i,O),w&&typeof w=="object"&&!(w instanceof Date)?i[O]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=kr(w)),I=n.dateNF||Me[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,I&&(c.z=I)):i[O]=c={t:y,v:w},I&&(c.z=I))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var x=lr(a);if(s)for(p=0;p<m.length;++p)i[zt(p+o)+x]={t:"s",v:m[p]};return i["!ref"]=Qe(u),i}function VH(t,e){return dN(null,t,e)}function hh(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ht(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?hh(t,je(e)):hh(t,je({r:e,c:r||0}))}function BH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function sw(){return{SheetNames:[],Sheets:{}}}function iw(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(YI(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function UH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=BH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function $H(t,e){return t.z=e,t}function mN(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function zH(t,e,r){return mN(t,"#"+e,r)}function HH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function WH(t,e,r,n){for(var s=typeof e!="string"?e:ht(e),i=typeof e=="string"?e:Qe(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=hh(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Sc={encode_col:zt,encode_row:lr,encode_cell:je,encode_range:Qe,decode_col:Fv,decode_row:Dv,split_cell:tM,decode_cell:Ht,decode_range:zn,format_cell:Ji,sheet_add_aoa:U4,sheet_add_json:dN,sheet_add_dom:sN,aoa_to_sheet:iu,json_to_sheet:VH,table_to_sheet:iN,table_to_book:Qz,sheet_to_csv:nw,sheet_to_txt:hN,sheet_to_json:gm,sheet_to_html:nN,sheet_to_formulae:jH,sheet_to_row_object_array:gm,sheet_get_cell:hh,book_new:sw,book_append_sheet:iw,book_set_sheet_visibility:UH,cell_set_number_format:$H,cell_set_hyperlink:mN,cell_set_internal_link:zH,cell_add_comment:HH,sheet_set_array_formula:WH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GH=()=>{};var FT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},qH=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},gN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,h=(i&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(pN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qH(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||h==null)throw new KH;const m=i<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class KH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XH=function(t){const e=pN(t);return gN.encodeByteArray(e,!0)},xm=function(t){return XH(t).replace(/\./g,"")},xN=function(t){try{return gN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QH=()=>YH().__FIREBASE_DEFAULTS__,JH=()=>{if(typeof process>"u"||typeof FT>"u")return;const t=FT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&xN(t[1]);return e&&JSON.parse(e)},mp=()=>{try{return GH()||QH()||JH()||ZH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},yN=t=>{var e,r;return(r=(e=mp())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},eW=t=>{const e=yN(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},vN=()=>{var t;return(t=mp())==null?void 0:t.config},wN=t=>{var e;return(e=mp())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tW{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _N(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rW(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[xm(JSON.stringify(r)),xm(JSON.stringify(a)),""].join(".")}const yf={};function nW(){const t={prod:[],emulator:[]};for(const e of Object.keys(yf))yf[e]?t.emulator.push(e):t.prod.push(e);return t}function sW(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let OT=!1;function EN(t,e){if(typeof window>"u"||typeof document>"u"||!ou(window.location.host)||yf[t]===e||yf[t]||OT)return;yf[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",i=nW().prod.length>0;function a(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{OT=!0,a()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=sW(n),p=r("text"),x=document.getElementById(p)||document.createElement("span"),g=r("learnmore"),v=document.getElementById(g)||document.createElement("a"),_=r("preprendIcon"),w=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const y=m.element;o(y),u(v,g);const I=c();l(w,_),y.append(w,x,v,I),document.body.appendChild(y)}i?(x.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iW(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function aW(){var e;const t=(e=mp())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oW(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function lW(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cW(){const t=gn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function uW(){return!aW()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SN(){try{return typeof indexedDB=="object"}catch{return!1}}function AN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}function fW(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hW="FirebaseError";class Zs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=hW,Object.setPrototypeOf(this,Zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sl.prototype.create)}}class Sl{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?dW(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Zs(s,o,n)}}function dW(t,e){return t.replace(mW,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const mW=/\{\$([^}]+)}/g;function pW(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function eo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(LT(i)&&LT(a)){if(!eo(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function LT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function qu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ku(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function gW(t,e){const r=new xW(t,e);return r.subscribe.bind(r)}class xW{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");yW(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=jg),s.error===void 0&&(s.error=jg),s.complete===void 0&&(s.complete=jg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yW(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function jg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW=1e3,wW=2,_W=4*60*60*1e3,EW=.5;function MT(t,e=vW,r=wW){const n=e*Math.pow(r,t),s=Math.round(EW*n*(Math.random()-.5)*2);return Math.min(_W,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(t){return t&&t._delegate?t._delegate:t}class Ys{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TW{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new tW;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AW(e))try{this.getOrInitializeService({instanceIdentifier:Io})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Io){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Io){return this.instances.has(e)}getOptions(e=Io){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:SW(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Io){return this.component?this.component.multipleInstances?e:Io:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SW(t){return t===Io?void 0:t}function AW(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kW{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new TW(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(it||(it={}));const bW={debug:it.DEBUG,verbose:it.VERBOSE,info:it.INFO,warn:it.WARN,error:it.ERROR,silent:it.SILENT},CW=it.INFO,IW={[it.DEBUG]:"log",[it.VERBOSE]:"log",[it.INFO]:"info",[it.WARN]:"warn",[it.ERROR]:"error"},NW=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=IW[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pp{constructor(e){this.name=e,this._logLevel=CW,this._logHandler=NW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in it))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,it.DEBUG,...e),this._logHandler(this,it.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,it.VERBOSE,...e),this._logHandler(this,it.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,it.INFO,...e),this._logHandler(this,it.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,it.WARN,...e),this._logHandler(this,it.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,it.ERROR,...e),this._logHandler(this,it.ERROR,...e)}}const RW=(t,e)=>e.some(r=>t instanceof r);let jT,VT;function PW(){return jT||(jT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DW(){return VT||(VT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kN=new WeakMap,S1=new WeakMap,bN=new WeakMap,Vg=new WeakMap,aw=new WeakMap;function FW(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r($a(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&kN.set(r,t)}).catch(()=>{}),aw.set(e,t),e}function OW(t){if(S1.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});S1.set(t,e)}let A1={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return S1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bN.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return $a(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LW(t){A1=t(A1)}function MW(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Bg(this),e,...r);return bN.set(n,e.sort?e.sort():[e]),$a(n)}:DW().includes(t)?function(...e){return t.apply(Bg(this),e),$a(kN.get(this))}:function(...e){return $a(t.apply(Bg(this),e))}}function jW(t){return typeof t=="function"?MW(t):(t instanceof IDBTransaction&&OW(t),RW(t,PW())?new Proxy(t,A1):t)}function $a(t){if(t instanceof IDBRequest)return FW(t);if(Vg.has(t))return Vg.get(t);const e=jW(t);return e!==t&&(Vg.set(t,e),aw.set(e,t)),e}const Bg=t=>aw.get(t);function CN(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=$a(a);return n&&a.addEventListener("upgradeneeded",l=>{n($a(a.result),l.oldVersion,l.newVersion,$a(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const VW=["get","getKey","getAll","getAllKeys","count"],BW=["put","add","delete","clear"],Ug=new Map;function BT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=BW.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||VW.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return Ug.set(e,i),i}LW(t=>({...t,get:(e,r,n)=>BT(e,r)||t.get(e,r,n),has:(e,r)=>!!BT(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if($W(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function $W(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const k1="@firebase/app",UT="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=new pp("@firebase/app"),zW="@firebase/app-compat",HW="@firebase/analytics-compat",WW="@firebase/analytics",GW="@firebase/app-check-compat",qW="@firebase/app-check",KW="@firebase/auth",XW="@firebase/auth-compat",YW="@firebase/database",QW="@firebase/data-connect",JW="@firebase/database-compat",ZW="@firebase/functions",eG="@firebase/functions-compat",tG="@firebase/installations",rG="@firebase/installations-compat",nG="@firebase/messaging",sG="@firebase/messaging-compat",iG="@firebase/performance",aG="@firebase/performance-compat",oG="@firebase/remote-config",lG="@firebase/remote-config-compat",cG="@firebase/storage",uG="@firebase/storage-compat",fG="@firebase/firestore",hG="@firebase/ai",dG="@firebase/firestore-compat",mG="firebase",pG="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="[DEFAULT]",gG={[k1]:"fire-core",[zW]:"fire-core-compat",[WW]:"fire-analytics",[HW]:"fire-analytics-compat",[qW]:"fire-app-check",[GW]:"fire-app-check-compat",[KW]:"fire-auth",[XW]:"fire-auth-compat",[YW]:"fire-rtdb",[QW]:"fire-data-connect",[JW]:"fire-rtdb-compat",[ZW]:"fire-fn",[eG]:"fire-fn-compat",[tG]:"fire-iid",[rG]:"fire-iid-compat",[nG]:"fire-fcm",[sG]:"fire-fcm-compat",[iG]:"fire-perf",[aG]:"fire-perf-compat",[oG]:"fire-rc",[lG]:"fire-rc-compat",[cG]:"fire-gcs",[uG]:"fire-gcs-compat",[fG]:"fire-fst",[dG]:"fire-fst-compat",[hG]:"fire-vertex","fire-js":"fire-js",[mG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym=new Map,xG=new Map,C1=new Map;function $T(t,e){try{t.container.addComponent(e)}catch(r){Zi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Si(t){const e=t.name;if(C1.has(e))return Zi.debug(`There were multiple attempts to register component ${e}.`),!1;C1.set(e,t);for(const r of ym.values())$T(r,t);for(const r of xG.values())$T(r,t);return!0}function Al(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function gs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},za=new Sl("app","Firebase",yG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vG{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ys("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw za.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=pG;function IN(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:b1,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw za.create("bad-app-name",{appName:String(s)});if(r||(r=vN()),!r)throw za.create("no-options");const i=ym.get(s);if(i){if(eo(r,i.options)&&eo(n,i.config))return i;throw za.create("duplicate-app",{appName:s})}const a=new kW(s);for(const l of C1.values())a.addComponent(l);const o=new vG(r,n,a);return ym.set(s,o),o}function ow(t=b1){const e=ym.get(t);if(!e&&t===b1&&vN())return IN();if(!e)throw za.create("no-app",{appName:t});return e}function Ss(t,e,r){let n=gG[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zi.warn(a.join(" "));return}Si(new Ys(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wG="firebase-heartbeat-database",_G=1,dh="firebase-heartbeat-store";let $g=null;function NN(){return $g||($g=CN(wG,_G,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(dh)}catch(r){console.warn(r)}}}}).catch(t=>{throw za.create("idb-open",{originalErrorMessage:t.message})})),$g}async function EG(t){try{const r=(await NN()).transaction(dh),n=await r.objectStore(dh).get(RN(t));return await r.done,n}catch(e){if(e instanceof Zs)Zi.warn(e.message);else{const r=za.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zi.warn(r.message)}}}async function zT(t,e){try{const n=(await NN()).transaction(dh,"readwrite");await n.objectStore(dh).put(e,RN(t)),await n.done}catch(r){if(r instanceof Zs)Zi.warn(r.message);else{const n=za.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Zi.warn(n.message)}}}function RN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TG=1024,SG=30;class AG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new bG(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=HT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>SG){const a=CG(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Zi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=HT(),{heartbeatsToSend:n,unsentEntries:s}=kG(this._heartbeatsCache.heartbeats),i=xm(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Zi.warn(r),""}}}function HT(){return new Date().toISOString().substring(0,10)}function kG(t,e=TG){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),WT(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),WT(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class bG{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SN()?AN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await EG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return zT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return zT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function WT(t){return xm(JSON.stringify({version:2,heartbeats:t})).length}function CG(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IG(t){Si(new Ys("platform-logger",e=>new UW(e),"PRIVATE")),Si(new Ys("heartbeat",e=>new AG(e),"PRIVATE")),Ss(k1,UT,t),Ss(k1,UT,"esm2020"),Ss("fire-js","")}IG("");function PN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const NG=PN,DN=new Sl("auth","Firebase",PN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm=new pp("@firebase/auth");function RG(t,...e){vm.logLevel<=it.WARN&&vm.warn(`Auth (${lu}): ${t}`,...e)}function y0(t,...e){vm.logLevel<=it.ERROR&&vm.error(`Auth (${lu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(t,...e){throw lw(t,...e)}function pi(t,...e){return lw(t,...e)}function FN(t,e,r){const n={...NG(),[e]:r};return new Sl("auth","Firebase",n).create(e,{appName:t.name})}function Gi(t){return FN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lw(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return DN.create(t,...e)}function Ve(t,e,...r){if(!t)throw lw(e,...r)}function Bi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw y0(e),new Error(e)}function ea(t,e){t||Bi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function PG(){return GT()==="http:"||GT()==="https:"}function GT(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PG()||TN()||"connection"in navigator)?navigator.onLine:!0}function FG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,r){this.shortDelay=e,this.longDelay=r,ea(r>e,"Short delay should be less than long delay!"),this.isMobile=iW()||lW()}get(){return DG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t,e){ea(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LG=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MG=new Wh(3e4,6e4);function go(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ca(t,e,r,n,s={}){return LN(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Hh({key:t.config.apiKey,...a}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...i};return oW()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&ou(t.emulatorConfig.host)&&(c.credentials="include"),ON.fetch()(await MN(t,t.config.apiHost,r,o),c)})}async function LN(t,e,r){t._canInitEmulator=!1;const n={...OG,...e};try{const s=new VG(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Xd(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xd(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Xd(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Xd(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw FN(t,u,c);Qs(t,u)}}catch(s){if(s instanceof Zs)throw s;Qs(t,"network-request-failed",{message:String(s)})}}async function Gh(t,e,r,n,s={}){const i=await ca(t,e,r,n,s);return"mfaPendingCredential"in i&&Qs(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function MN(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?cw(t.config,s):`${t.config.apiScheme}://${s}`;return LG.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function jG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class VG{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(pi(this.auth,"network-request-failed")),MG.get())})}}function Xd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=pi(t,e,n);return s.customData._tokenResponse=r,s}function qT(t){return t!==void 0&&t.enterprise!==void 0}class BG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return jG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function UG(t,e){return ca(t,"GET","/v2/recaptchaConfig",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $G(t,e){return ca(t,"POST","/v1/accounts:delete",e)}async function wm(t,e){return ca(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zG(t,e=!1){const r=qt(t),n=await r.getIdToken(e),s=uw(n);Ve(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:vf(zg(s.auth_time)),issuedAtTime:vf(zg(s.iat)),expirationTime:vf(zg(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function zg(t){return Number(t)*1e3}function uw(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return y0("JWT malformed, contained fewer than 3 sections"),null;try{const s=xN(r);return s?JSON.parse(s):(y0("Failed to decode base64 JWT payload"),null)}catch(s){return y0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function KT(t){const e=uw(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Zs&&HG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function HG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vf(this.lastLoginAt),this.creationTime=vf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _m(t){var h;const e=t.auth,r=await t.getIdToken(),n=await Hc(t,wm(e,{idToken:r}));Ve(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?jN(s.providerUserInfo):[],a=qG(t.providerData,i),o=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),c=o?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new N1(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function GG(t){const e=qt(t);await _m(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qG(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function jN(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KG(t,e){const r=await LN(t,{},async()=>{const n=Hh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await MN(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&ou(t.emulatorConfig.host)&&(l.credentials="include"),ON.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function XG(t,e){return ca(t,"POST","/v2/accounts:revokeToken",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const r=KT(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await KG(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new Ac;return n&&(Ve(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Ve(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Ve(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ac,this.toJSON())}_performRefresh(){return Bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hs{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new WG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new N1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Hc(this,this.stsTokenManager.getToken(this.auth,e));return Ve(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return zG(this,e)}reload(){return GG(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Hs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _m(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gs(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await Hc(this,$G(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:x,stsTokenManager:g}=r;Ve(h&&g,e,"internal-error");const v=Ac.fromJSON(this.name,g);Ve(typeof h=="string",e,"internal-error"),va(n,e.name),va(s,e.name),Ve(typeof m=="boolean",e,"internal-error"),Ve(typeof p=="boolean",e,"internal-error"),va(i,e.name),va(a,e.name),va(o,e.name),va(l,e.name),va(c,e.name),va(u,e.name);const _=new Hs({uid:h,auth:e,email:s,emailVerified:m,displayName:n,isAnonymous:p,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:v,createdAt:c,lastLoginAt:u});return x&&Array.isArray(x)&&(_.providerData=x.map(w=>({...w}))),l&&(_._redirectEventId=l),_}static async _fromIdTokenResponse(e,r,n=!1){const s=new Ac;s.updateFromServerResponse(r);const i=new Hs({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await _m(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Ve(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jN(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new Ac;o.updateFromIdToken(n);const l=new Hs({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new N1(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT=new Map;function Ui(t){ea(t instanceof Function,"Expected a class definition");let e=XT.get(t);return e?(ea(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,XT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}VN.type="NONE";const YT=VN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e,r){return`firebase:${t}:${e}:${r}`}class kc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=v0(this.userKey,s.apiKey,i),this.fullPersistenceKey=v0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await wm(this.auth,{idToken:e}).catch(()=>{});return r?Hs._fromGetAccountInfoResponse(this.auth,r,e):null}return Hs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new kc(Ui(YT),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ui(YT);const a=v0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){let h;if(typeof u=="string"){const m=await wm(e,{idToken:u}).catch(()=>{});if(!m)break;h=await Hs._fromGetAccountInfoResponse(e,m,u)}else h=Hs._fromJSON(e,u);c!==i&&(o=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new kc(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new kc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WN(e))return"Blackberry";if(GN(e))return"Webos";if(UN(e))return"Safari";if((e.includes("chrome/")||$N(e))&&!e.includes("edge/"))return"Chrome";if(HN(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function BN(t=gn()){return/firefox\//i.test(t)}function UN(t=gn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $N(t=gn()){return/crios\//i.test(t)}function zN(t=gn()){return/iemobile/i.test(t)}function HN(t=gn()){return/android/i.test(t)}function WN(t=gn()){return/blackberry/i.test(t)}function GN(t=gn()){return/webos/i.test(t)}function fw(t=gn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function YG(t=gn()){var e;return fw(t)&&!!((e=window.navigator)!=null&&e.standalone)}function QG(){return cW()&&document.documentMode===10}function qN(t=gn()){return fw(t)||HN(t)||GN(t)||WN(t)||/windows phone/i.test(t)||zN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(t,e=[]){let r;switch(t){case"Browser":r=QT(gn());break;case"Worker":r=`${QT(gn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${lu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZG(t,e={}){return ca(t,"GET","/v2/passwordPolicy",go(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eq=6;class tq{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??eq,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JT(this),this.idTokenSubscription=new JT(this),this.beforeStateQueue=new JG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ui(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await kc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await wm(this,{idToken:e}),n=await Hs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(gs(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _m(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gs(this.app))return Promise.reject(Gi(this));const r=e?qt(e):null;return r&&Ve(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gs(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gs(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZG(this),r=new tq(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Sl("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await XG(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ui(e)||this._popupRedirectResolver;Ve(r,this,"argument-error"),this.redirectPersistenceManager=await kc.create(this,[Ui(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=KN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(gs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&RG(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function kl(t){return qt(t)}class JT{constructor(e){this.auth=e,this.observer=null,this.addObserver=gW(r=>this.observer=r)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nq(t){gp=t}function XN(t){return gp.loadJS(t)}function sq(){return gp.recaptchaEnterpriseScript}function iq(){return gp.gapiScript}function aq(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class oq{constructor(){this.enterprise=new lq}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class lq{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const cq="recaptcha-enterprise",YN="NO_RECAPTCHA";class uq{constructor(e){this.type=cq,this.auth=kl(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{UG(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new BG(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;qT(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(YN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oq().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&qT(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=sq();l.length!==0&&(l+=o),XN(l).then(()=>{s(o,i,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function ZT(t,e,r,n=!1,s=!1){const i=new uq(t);let a;if(s)a=YN;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function R1(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await ZT(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ZT(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fq(t,e){const r=Al(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(eo(i,e??{}))return s;Qs(s,"already-initialized")}return r.initialize({options:e})}function hq(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ui);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function dq(t,e,r){const n=kl(t);Ve(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=QN(e),{host:a,port:o}=mq(e),l=o===null?"":`:${o}`,c={url:`${i}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Ve(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ve(eo(c,n.config.emulator)&&eo(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,ou(a)?(_N(`${i}//${a}${l}`),EN("Auth",!0)):pq()}function QN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function mq(t){const e=QN(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:eS(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:eS(a)}}}function eS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pq(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Bi("not implemented")}_getIdTokenResponse(e){return Bi("not implemented")}_linkToIdToken(e,r){return Bi("not implemented")}_getReauthenticationResolver(e){return Bi("not implemented")}}async function gq(t,e){return ca(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xq(t,e){return Gh(t,"POST","/v1/accounts:signInWithPassword",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yq(t,e){return Gh(t,"POST","/v1/accounts:signInWithEmailLink",go(t,e))}async function vq(t,e){return Gh(t,"POST","/v1/accounts:signInWithEmailLink",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends hw{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new mh(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new mh(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R1(e,r,"signInWithPassword",xq);case"emailLink":return yq(e,{email:this._email,oobCode:this._password});default:Qs(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R1(e,n,"signUpPassword",gq);case"emailLink":return vq(e,{idToken:r,email:this._email,oobCode:this._password});default:Qs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bc(t,e){return Gh(t,"POST","/v1/accounts:signInWithIdp",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wq="http://localhost";class ll extends hw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Qs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new ll(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return bc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,bc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,bc(e,r)}buildRequest(){const e={requestUri:wq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Hh(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _q(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Eq(t){const e=qu(Ku(t)).link,r=e?qu(Ku(e)).deep_link_id:null,n=qu(Ku(t)).deep_link_id;return(n?qu(Ku(n)).link:null)||n||r||e||t}class dw{constructor(e){const r=qu(Ku(e)),n=r.apiKey??null,s=r.oobCode??null,i=_q(r.mode??null);Ve(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=Eq(e);try{return new dw(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(){this.providerId=cu.PROVIDER_ID}static credential(e,r){return mh._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=dw.parseLink(r);return Ve(n,"argument-error"),mh._fromEmailAndCode(e,n.code,n.tenantId)}}cu.PROVIDER_ID="password";cu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh extends JN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends qh{constructor(){super("facebook.com")}static credential(e){return ll._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Aa.credential(e.oauthAccessToken)}catch{return null}}}Aa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Aa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends qh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ll._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ka.credential(r,n)}catch{return null}}}ka.GOOGLE_SIGN_IN_METHOD="google.com";ka.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends qh{constructor(){super("github.com")}static credential(e){return ll._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ba.credentialFromTaggedObject(e)}static credentialFromError(e){return ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ba.credential(e.oauthAccessToken)}catch{return null}}}ba.GITHUB_SIGN_IN_METHOD="github.com";ba.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends qh{constructor(){super("twitter.com")}static credential(e,r){return ll._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ca.credential(r,n)}catch{return null}}}Ca.TWITTER_SIGN_IN_METHOD="twitter.com";Ca.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tq(t,e){return Gh(t,"POST","/v1/accounts:signUp",go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Hs._fromIdTokenResponse(e,n,s),a=tS(n);return new cl({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=tS(n);return new cl({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function tS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em extends Zs{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Em.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Em(e,r,n,s)}}function ZN(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Em._fromErrorAndOperation(t,i,e,n):i})}async function Sq(t,e,r=!1){const n=await Hc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return cl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aq(t,e,r=!1){const{auth:n}=t;if(gs(n.app))return Promise.reject(Gi(n));const s="reauthenticate";try{const i=await Hc(t,ZN(n,s,e,t),r);Ve(i.idToken,n,"internal-error");const a=uw(i.idToken);Ve(a,n,"internal-error");const{sub:o}=a;return Ve(t.uid===o,n,"user-mismatch"),cl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Qs(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(t,e,r=!1){if(gs(t.app))return Promise.reject(Gi(t));const n="signIn",s=await ZN(t,n,e),i=await cl._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function kq(t,e){return eR(kl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tR(t){const e=kl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function bq(t,e,r){if(gs(t.app))return Promise.reject(Gi(t));const n=kl(t),a=await R1(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tq).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&tR(t),l}),o=await cl._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function Cq(t,e,r){return gs(t.app)?Promise.reject(Gi(t)):kq(qt(t),cu.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&tR(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iq(t,e){return ca(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nq(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=qt(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Hc(n,Iq(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function Rq(t,e,r,n){return qt(t).onIdTokenChanged(e,r,n)}function Pq(t,e,r){return qt(t).beforeAuthStateChanged(e,r)}function Dq(t,e,r,n){return qt(t).onAuthStateChanged(e,r,n)}function Fq(t){return qt(t).signOut()}const Tm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Tm,"1"),this.storage.removeItem(Tm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oq=1e3,Lq=10;class nR extends rR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);QG()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Lq):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Oq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}nR.type="LOCAL";const Mq=nR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR extends rR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}sR.type="SESSION";const iR=sR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jq(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new xp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await jq(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=mw("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(m.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(){return window}function Bq(t){gi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(){return typeof gi().WorkerGlobalScope<"u"&&typeof gi().importScripts=="function"}async function Uq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $q(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function zq(){return aR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="firebaseLocalStorageDb",Hq=1,Sm="firebaseLocalStorage",lR="fbase_key";class Kh{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function yp(t,e){return t.transaction([Sm],e?"readwrite":"readonly").objectStore(Sm)}function Wq(){const t=indexedDB.deleteDatabase(oR);return new Kh(t).toPromise()}function P1(){const t=indexedDB.open(oR,Hq);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Sm,{keyPath:lR})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Sm)?e(n):(n.close(),await Wq(),e(await P1()))})})}async function rS(t,e,r){const n=yp(t,!0).put({[lR]:e,value:r});return new Kh(n).toPromise()}async function Gq(t,e){const r=yp(t,!1).get(e),n=await new Kh(r).toPromise();return n===void 0?null:n.value}function nS(t,e){const r=yp(t,!0).delete(e);return new Kh(r).toPromise()}const qq=800,Kq=3;class cR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await P1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Kq)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return aR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xp._getInstance(zq()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await Uq(),!this.activeServiceWorker)return;this.sender=new Vq(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$q()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await P1();return await rS(e,Tm,"1"),await nS(e,Tm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>rS(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Gq(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>nS(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=yp(s,!1).getAll();return new Kh(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cR.type="LOCAL";const Xq=cR;new Wh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yq(t,e){return e?Ui(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw extends hw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return bc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return bc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Qq(t){return eR(t.auth,new pw(t),t.bypassAuthState)}function Jq(t){const{auth:e,user:r}=t;return Ve(r,e,"internal-error"),Aq(r,new pw(t),t.bypassAuthState)}async function Zq(t){const{auth:e,user:r}=t;return Ve(r,e,"internal-error"),Sq(r,new pw(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qq;case"linkViaPopup":case"linkViaRedirect":return Zq;case"reauthViaPopup":case"reauthViaRedirect":return Jq;default:Qs(this.auth,"internal-error")}}resolve(e){ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eK=new Wh(2e3,1e4);class ac extends uR{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,ac.currentPopupAction&&ac.currentPopupAction.cancel(),ac.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){ea(this.filter.length===1,"Popup operations only handle one event");const e=mw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(pi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(pi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ac.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eK.get())};e()}}ac.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tK="pendingRedirect",w0=new Map;class rK extends uR{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=w0.get(this.auth._key());if(!e){try{const n=await nK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}w0.set(this.auth._key(),e)}return this.bypassAuthState||w0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nK(t,e){const r=aK(e),n=iK(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function sK(t,e){w0.set(t._key(),e)}function iK(t){return Ui(t._redirectPersistence)}function aK(t){return v0(tK,t.config.apiKey,t.name)}async function oK(t,e,r=!1){if(gs(t.app))return Promise.reject(Gi(t));const n=kl(t),s=Yq(n,e),a=await new rK(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lK=10*60*1e3;class cK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uK(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!fR(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(pi(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lK&&this.cachedEventUids.clear(),this.cachedEventUids.has(sS(e))}saveEventToCache(e){this.cachedEventUids.add(sS(e)),this.lastProcessedEventTime=Date.now()}}function sS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function uK(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fK(t,e={}){return ca(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dK=/^https?/;async function mK(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fK(t);for(const r of e)try{if(pK(r))return}catch{}Qs(t,"unauthorized-domain")}function pK(t){const e=I1(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!dK.test(r))return!1;if(hK.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK=new Wh(3e4,6e4);function iS(){const t=gi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function xK(t){return new Promise((e,r)=>{var s,i,a;function n(){iS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iS(),r(pi(t,"network-request-failed"))},timeout:gK.get()})}if((i=(s=gi().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=gi().gapi)!=null&&a.load)n();else{const o=aq("iframefcb");return gi()[o]=()=>{gapi.load?n():r(pi(t,"network-request-failed"))},XN(`${iq()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw _0=null,e})}let _0=null;function yK(t){return _0=_0||xK(t),_0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vK=new Wh(5e3,15e3),wK="__/auth/iframe",_K="emulator/auth/iframe",EK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},TK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function SK(t){const e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?cw(e,_K):`https://${t.config.authDomain}/${wK}`,n={apiKey:e.apiKey,appName:t.name,v:lu},s=TK.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Hh(n).slice(1)}`}async function AK(t){const e=await yK(t),r=gi().gapi;return Ve(r,t,"internal-error"),e.open({where:document.body,url:SK(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:EK,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=pi(t,"network-request-failed"),o=gi().setTimeout(()=>{i(a)},vK.get());function l(){gi().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bK=500,CK=600,IK="_blank",NK="http://localhost";class aS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RK(t,e,r,n=bK,s=CK){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...kK,width:n.toString(),height:s.toString(),top:i,left:a},c=gn().toLowerCase();r&&(o=$N(c)?IK:r),BN(c)&&(e=e||NK,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(YG(c)&&o!=="_self")return PK(e||"",o),new aS(null);const h=window.open(e||"",o,u);Ve(h,t,"popup-blocked");try{h.focus()}catch{}return new aS(h)}function PK(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DK="__/auth/handler",FK="emulator/auth/handler",OK=encodeURIComponent("fac");async function oS(t,e,r,n,s,i){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:lu,eventId:s};if(e instanceof JN){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",pW(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))a[u]=h}if(e instanceof qh){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${OK}=${encodeURIComponent(l)}`:"";return`${LK(t)}?${Hh(o).slice(1)}${c}`}function LK({config:t}){return t.emulator?cw(t,FK):`https://${t.authDomain}/${DK}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="webStorageSupport";class MK{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iR,this._completeRedirectFn=oK,this._overrideRedirectResult=sK}async _openPopup(e,r,n,s){var a;ea((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await oS(e,r,n,I1(),s);return RK(e,i,mw())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await oS(e,r,n,I1(),s);return Bq(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(ea(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await AK(e),n=new cK(e);return r.register("authEvent",s=>(Ve(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Hg,{type:Hg},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Hg];i!==void 0&&r(!!i),Qs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=mK(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return qN()||UN()||fw()}}const jK=MK;var lS="@firebase/auth",cS="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VK{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BK(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function UK(t){Si(new Ys("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Ve(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KN(t)},c=new rq(n,s,i,l);return hq(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Si(new Ys("auth-internal",e=>{const r=kl(e.getProvider("auth").getImmediate());return(n=>new VK(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ss(lS,cS,BK(t)),Ss(lS,cS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $K=5*60,zK=wN("authIdTokenMaxAge")||$K;let uS=null;const HK=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>zK)return;const s=r==null?void 0:r.token;uS!==s&&(uS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function WK(t=ow()){const e=Al(t,"auth");if(e.isInitialized())return e.getImmediate();const r=fq(t,{popupRedirectResolver:jK,persistence:[Xq,Mq,iR]}),n=wN("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=HK(i.toString());Pq(r,a,()=>a(r.currentUser)),Rq(r,o=>a(o))}}const s=yN("auth");return s&&dq(r,`http://${s}`),r}function GK(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}nq({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=pi("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",GK().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});UK("Browser");var qK="firebase",KK="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ss(qK,KK,"app");var fS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ha,hR;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,E){function A(){}A.prototype=E.prototype,S.D=E.prototype,S.prototype=new A,S.prototype.constructor=S,S.C=function(N,C,R){for(var F=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)F[oe-2]=arguments[oe];return E.prototype[C].apply(N,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,E,A){A||(A=0);var N=Array(16);if(typeof E=="string")for(var C=0;16>C;++C)N[C]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(C=0;16>C;++C)N[C]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=S.g[0],A=S.g[1],C=S.g[2];var R=S.g[3],F=E+(R^A&(C^R))+N[0]+3614090360&4294967295;E=A+(F<<7&4294967295|F>>>25),F=R+(C^E&(A^C))+N[1]+3905402710&4294967295,R=E+(F<<12&4294967295|F>>>20),F=C+(A^R&(E^A))+N[2]+606105819&4294967295,C=R+(F<<17&4294967295|F>>>15),F=A+(E^C&(R^E))+N[3]+3250441966&4294967295,A=C+(F<<22&4294967295|F>>>10),F=E+(R^A&(C^R))+N[4]+4118548399&4294967295,E=A+(F<<7&4294967295|F>>>25),F=R+(C^E&(A^C))+N[5]+1200080426&4294967295,R=E+(F<<12&4294967295|F>>>20),F=C+(A^R&(E^A))+N[6]+2821735955&4294967295,C=R+(F<<17&4294967295|F>>>15),F=A+(E^C&(R^E))+N[7]+4249261313&4294967295,A=C+(F<<22&4294967295|F>>>10),F=E+(R^A&(C^R))+N[8]+1770035416&4294967295,E=A+(F<<7&4294967295|F>>>25),F=R+(C^E&(A^C))+N[9]+2336552879&4294967295,R=E+(F<<12&4294967295|F>>>20),F=C+(A^R&(E^A))+N[10]+4294925233&4294967295,C=R+(F<<17&4294967295|F>>>15),F=A+(E^C&(R^E))+N[11]+2304563134&4294967295,A=C+(F<<22&4294967295|F>>>10),F=E+(R^A&(C^R))+N[12]+1804603682&4294967295,E=A+(F<<7&4294967295|F>>>25),F=R+(C^E&(A^C))+N[13]+4254626195&4294967295,R=E+(F<<12&4294967295|F>>>20),F=C+(A^R&(E^A))+N[14]+2792965006&4294967295,C=R+(F<<17&4294967295|F>>>15),F=A+(E^C&(R^E))+N[15]+1236535329&4294967295,A=C+(F<<22&4294967295|F>>>10),F=E+(C^R&(A^C))+N[1]+4129170786&4294967295,E=A+(F<<5&4294967295|F>>>27),F=R+(A^C&(E^A))+N[6]+3225465664&4294967295,R=E+(F<<9&4294967295|F>>>23),F=C+(E^A&(R^E))+N[11]+643717713&4294967295,C=R+(F<<14&4294967295|F>>>18),F=A+(R^E&(C^R))+N[0]+3921069994&4294967295,A=C+(F<<20&4294967295|F>>>12),F=E+(C^R&(A^C))+N[5]+3593408605&4294967295,E=A+(F<<5&4294967295|F>>>27),F=R+(A^C&(E^A))+N[10]+38016083&4294967295,R=E+(F<<9&4294967295|F>>>23),F=C+(E^A&(R^E))+N[15]+3634488961&4294967295,C=R+(F<<14&4294967295|F>>>18),F=A+(R^E&(C^R))+N[4]+3889429448&4294967295,A=C+(F<<20&4294967295|F>>>12),F=E+(C^R&(A^C))+N[9]+568446438&4294967295,E=A+(F<<5&4294967295|F>>>27),F=R+(A^C&(E^A))+N[14]+3275163606&4294967295,R=E+(F<<9&4294967295|F>>>23),F=C+(E^A&(R^E))+N[3]+4107603335&4294967295,C=R+(F<<14&4294967295|F>>>18),F=A+(R^E&(C^R))+N[8]+1163531501&4294967295,A=C+(F<<20&4294967295|F>>>12),F=E+(C^R&(A^C))+N[13]+2850285829&4294967295,E=A+(F<<5&4294967295|F>>>27),F=R+(A^C&(E^A))+N[2]+4243563512&4294967295,R=E+(F<<9&4294967295|F>>>23),F=C+(E^A&(R^E))+N[7]+1735328473&4294967295,C=R+(F<<14&4294967295|F>>>18),F=A+(R^E&(C^R))+N[12]+2368359562&4294967295,A=C+(F<<20&4294967295|F>>>12),F=E+(A^C^R)+N[5]+4294588738&4294967295,E=A+(F<<4&4294967295|F>>>28),F=R+(E^A^C)+N[8]+2272392833&4294967295,R=E+(F<<11&4294967295|F>>>21),F=C+(R^E^A)+N[11]+1839030562&4294967295,C=R+(F<<16&4294967295|F>>>16),F=A+(C^R^E)+N[14]+4259657740&4294967295,A=C+(F<<23&4294967295|F>>>9),F=E+(A^C^R)+N[1]+2763975236&4294967295,E=A+(F<<4&4294967295|F>>>28),F=R+(E^A^C)+N[4]+1272893353&4294967295,R=E+(F<<11&4294967295|F>>>21),F=C+(R^E^A)+N[7]+4139469664&4294967295,C=R+(F<<16&4294967295|F>>>16),F=A+(C^R^E)+N[10]+3200236656&4294967295,A=C+(F<<23&4294967295|F>>>9),F=E+(A^C^R)+N[13]+681279174&4294967295,E=A+(F<<4&4294967295|F>>>28),F=R+(E^A^C)+N[0]+3936430074&4294967295,R=E+(F<<11&4294967295|F>>>21),F=C+(R^E^A)+N[3]+3572445317&4294967295,C=R+(F<<16&4294967295|F>>>16),F=A+(C^R^E)+N[6]+76029189&4294967295,A=C+(F<<23&4294967295|F>>>9),F=E+(A^C^R)+N[9]+3654602809&4294967295,E=A+(F<<4&4294967295|F>>>28),F=R+(E^A^C)+N[12]+3873151461&4294967295,R=E+(F<<11&4294967295|F>>>21),F=C+(R^E^A)+N[15]+530742520&4294967295,C=R+(F<<16&4294967295|F>>>16),F=A+(C^R^E)+N[2]+3299628645&4294967295,A=C+(F<<23&4294967295|F>>>9),F=E+(C^(A|~R))+N[0]+4096336452&4294967295,E=A+(F<<6&4294967295|F>>>26),F=R+(A^(E|~C))+N[7]+1126891415&4294967295,R=E+(F<<10&4294967295|F>>>22),F=C+(E^(R|~A))+N[14]+2878612391&4294967295,C=R+(F<<15&4294967295|F>>>17),F=A+(R^(C|~E))+N[5]+4237533241&4294967295,A=C+(F<<21&4294967295|F>>>11),F=E+(C^(A|~R))+N[12]+1700485571&4294967295,E=A+(F<<6&4294967295|F>>>26),F=R+(A^(E|~C))+N[3]+2399980690&4294967295,R=E+(F<<10&4294967295|F>>>22),F=C+(E^(R|~A))+N[10]+4293915773&4294967295,C=R+(F<<15&4294967295|F>>>17),F=A+(R^(C|~E))+N[1]+2240044497&4294967295,A=C+(F<<21&4294967295|F>>>11),F=E+(C^(A|~R))+N[8]+1873313359&4294967295,E=A+(F<<6&4294967295|F>>>26),F=R+(A^(E|~C))+N[15]+4264355552&4294967295,R=E+(F<<10&4294967295|F>>>22),F=C+(E^(R|~A))+N[6]+2734768916&4294967295,C=R+(F<<15&4294967295|F>>>17),F=A+(R^(C|~E))+N[13]+1309151649&4294967295,A=C+(F<<21&4294967295|F>>>11),F=E+(C^(A|~R))+N[4]+4149444226&4294967295,E=A+(F<<6&4294967295|F>>>26),F=R+(A^(E|~C))+N[11]+3174756917&4294967295,R=E+(F<<10&4294967295|F>>>22),F=C+(E^(R|~A))+N[2]+718787259&4294967295,C=R+(F<<15&4294967295|F>>>17),F=A+(R^(C|~E))+N[9]+3951481745&4294967295,S.g[0]=S.g[0]+E&4294967295,S.g[1]=S.g[1]+(C+(F<<21&4294967295|F>>>11))&4294967295,S.g[2]=S.g[2]+C&4294967295,S.g[3]=S.g[3]+R&4294967295}n.prototype.u=function(S,E){E===void 0&&(E=S.length);for(var A=E-this.blockSize,N=this.B,C=this.h,R=0;R<E;){if(C==0)for(;R<=A;)s(this,S,R),R+=this.blockSize;if(typeof S=="string"){for(;R<E;)if(N[C++]=S.charCodeAt(R++),C==this.blockSize){s(this,N),C=0;break}}else for(;R<E;)if(N[C++]=S[R++],C==this.blockSize){s(this,N),C=0;break}}this.h=C,this.o+=E},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var E=1;E<S.length-8;++E)S[E]=0;var A=8*this.o;for(E=S.length-8;E<S.length;++E)S[E]=A&255,A/=256;for(this.u(S),S=Array(16),E=A=0;4>E;++E)for(var N=0;32>N;N+=8)S[A++]=this.g[E]>>>N&255;return S};function i(S,E){var A=o;return Object.prototype.hasOwnProperty.call(A,S)?A[S]:A[S]=E(S)}function a(S,E){this.h=E;for(var A=[],N=!0,C=S.length-1;0<=C;C--){var R=S[C]|0;N&&R==E||(A[C]=R,N=!1)}this.g=A}var o={};function l(S){return-128<=S&&128>S?i(S,function(E){return new a([E|0],0>E?-1:0)}):new a([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return v(c(-S));for(var E=[],A=1,N=0;S>=A;N++)E[N]=S/A|0,A*=4294967296;return new a(E,0)}function u(S,E){if(S.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(S.charAt(0)=="-")return v(u(S.substring(1),E));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(E,8)),N=h,C=0;C<S.length;C+=8){var R=Math.min(8,S.length-C),F=parseInt(S.substring(C,C+R),E);8>R?(R=c(Math.pow(E,R)),N=N.j(R).add(c(F))):(N=N.j(A),N=N.add(c(F)))}return N}var h=l(0),m=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-v(this).m();for(var S=0,E=1,A=0;A<this.g.length;A++){var N=this.i(A);S+=(0<=N?N:4294967296+N)*E,E*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(x(this))return"0";if(g(this))return"-"+v(this).toString(S);for(var E=c(Math.pow(S,6)),A=this,N="";;){var C=I(A,E).g;A=_(A,C.j(E));var R=((0<A.g.length?A.g[0]:A.h)>>>0).toString(S);if(A=C,x(A))return R+N;for(;6>R.length;)R="0"+R;N=R+N}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function x(S){if(S.h!=0)return!1;for(var E=0;E<S.g.length;E++)if(S.g[E]!=0)return!1;return!0}function g(S){return S.h==-1}t.l=function(S){return S=_(this,S),g(S)?-1:x(S)?0:1};function v(S){for(var E=S.g.length,A=[],N=0;N<E;N++)A[N]=~S.g[N];return new a(A,~S.h).add(m)}t.abs=function(){return g(this)?v(this):this},t.add=function(S){for(var E=Math.max(this.g.length,S.g.length),A=[],N=0,C=0;C<=E;C++){var R=N+(this.i(C)&65535)+(S.i(C)&65535),F=(R>>>16)+(this.i(C)>>>16)+(S.i(C)>>>16);N=F>>>16,R&=65535,F&=65535,A[C]=F<<16|R}return new a(A,A[A.length-1]&-2147483648?-1:0)};function _(S,E){return S.add(v(E))}t.j=function(S){if(x(this)||x(S))return h;if(g(this))return g(S)?v(this).j(v(S)):v(v(this).j(S));if(g(S))return v(this.j(v(S)));if(0>this.l(p)&&0>S.l(p))return c(this.m()*S.m());for(var E=this.g.length+S.g.length,A=[],N=0;N<2*E;N++)A[N]=0;for(N=0;N<this.g.length;N++)for(var C=0;C<S.g.length;C++){var R=this.i(N)>>>16,F=this.i(N)&65535,oe=S.i(C)>>>16,ae=S.i(C)&65535;A[2*N+2*C]+=F*ae,w(A,2*N+2*C),A[2*N+2*C+1]+=R*ae,w(A,2*N+2*C+1),A[2*N+2*C+1]+=F*oe,w(A,2*N+2*C+1),A[2*N+2*C+2]+=R*oe,w(A,2*N+2*C+2)}for(N=0;N<E;N++)A[N]=A[2*N+1]<<16|A[2*N];for(N=E;N<2*E;N++)A[N]=0;return new a(A,0)};function w(S,E){for(;(S[E]&65535)!=S[E];)S[E+1]+=S[E]>>>16,S[E]&=65535,E++}function y(S,E){this.g=S,this.h=E}function I(S,E){if(x(E))throw Error("division by zero");if(x(S))return new y(h,h);if(g(S))return E=I(v(S),E),new y(v(E.g),v(E.h));if(g(E))return E=I(S,v(E)),new y(v(E.g),E.h);if(30<S.g.length){if(g(S)||g(E))throw Error("slowDivide_ only works with positive integers.");for(var A=m,N=E;0>=N.l(S);)A=O(A),N=O(N);var C=P(A,1),R=P(N,1);for(N=P(N,2),A=P(A,2);!x(N);){var F=R.add(N);0>=F.l(S)&&(C=C.add(A),R=F),N=P(N,1),A=P(A,1)}return E=_(S,C.j(E)),new y(C,E)}for(C=h;0<=S.l(E);){for(A=Math.max(1,Math.floor(S.m()/E.m())),N=Math.ceil(Math.log(A)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),R=c(A),F=R.j(E);g(F)||0<F.l(S);)A-=N,R=c(A),F=R.j(E);x(R)&&(R=m),C=C.add(R),S=_(S,F)}return new y(C,S)}t.A=function(S){return I(this,S).h},t.and=function(S){for(var E=Math.max(this.g.length,S.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)&S.i(N);return new a(A,this.h&S.h)},t.or=function(S){for(var E=Math.max(this.g.length,S.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)|S.i(N);return new a(A,this.h|S.h)},t.xor=function(S){for(var E=Math.max(this.g.length,S.g.length),A=[],N=0;N<E;N++)A[N]=this.i(N)^S.i(N);return new a(A,this.h^S.h)};function O(S){for(var E=S.g.length+1,A=[],N=0;N<E;N++)A[N]=S.i(N)<<1|S.i(N-1)>>>31;return new a(A,S.h)}function P(S,E){var A=E>>5;E%=32;for(var N=S.g.length-A,C=[],R=0;R<N;R++)C[R]=0<E?S.i(R+A)>>>E|S.i(R+A+1)<<32-E:S.i(R+A);return new a(C,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,hR=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Ha=a}).apply(typeof fS<"u"?fS:typeof self<"u"?self:typeof window<"u"?window:{});var Yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dR,Xu,mR,E0,D1,pR,gR,xR;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,T,k){return d==Array.prototype||d==Object.prototype||(d[T]=k.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yd=="object"&&Yd];for(var T=0;T<d.length;++T){var k=d[T];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function s(d,T){if(T)e:{var k=n;d=d.split(".");for(var M=0;M<d.length-1;M++){var ne=d[M];if(!(ne in k))break e;k=k[ne]}d=d[d.length-1],M=k[d],T=T(M),T!=M&&T!=null&&e(k,d,{configurable:!0,writable:!0,value:T})}}function i(d,T){d instanceof String&&(d+="");var k=0,M=!1,ne={next:function(){if(!M&&k<d.length){var ce=k++;return{value:T(ce,d[ce]),done:!1}}return M=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}s("Array.prototype.values",function(d){return d||function(){return i(this,function(T,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var T=typeof d;return T=T!="object"?T:d?Array.isArray(d)?"array":T:"null",T=="array"||T=="object"&&typeof d.length=="number"}function c(d){var T=typeof d;return T=="object"&&d!=null||T=="function"}function u(d,T,k){return d.call.apply(d.bind,arguments)}function h(d,T,k){if(!d)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,M),d.apply(T,ne)}}return function(){return d.apply(T,arguments)}}function m(d,T,k){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(d,T){var k=Array.prototype.slice.call(arguments,1);return function(){var M=k.slice();return M.push.apply(M,arguments),d.apply(this,M)}}function x(d,T){function k(){}k.prototype=T.prototype,d.aa=T.prototype,d.prototype=new k,d.prototype.constructor=d,d.Qb=function(M,ne,ce){for(var ke=Array(arguments.length-2),St=2;St<arguments.length;St++)ke[St-2]=arguments[St];return T.prototype[ne].apply(M,ke)}}function g(d){const T=d.length;if(0<T){const k=Array(T);for(let M=0;M<T;M++)k[M]=d[M];return k}return[]}function v(d,T){for(let k=1;k<arguments.length;k++){const M=arguments[k];if(l(M)){const ne=d.length||0,ce=M.length||0;d.length=ne+ce;for(let ke=0;ke<ce;ke++)d[ne+ke]=M[ke]}else d.push(M)}}class _{constructor(T,k){this.i=T,this.j=k,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function w(d){return/^[\s\xa0]*$/.test(d)}function y(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function I(d){return I[" "](d),d}I[" "]=function(){};var O=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function P(d,T,k){for(const M in d)T.call(k,d[M],M,d)}function S(d,T){for(const k in d)T.call(void 0,d[k],k,d)}function E(d){const T={};for(const k in d)T[k]=d[k];return T}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(d,T){let k,M;for(let ne=1;ne<arguments.length;ne++){M=arguments[ne];for(k in M)d[k]=M[k];for(let ce=0;ce<A.length;ce++)k=A[ce],Object.prototype.hasOwnProperty.call(M,k)&&(d[k]=M[k])}}function C(d){var T=1;d=d.split(":");const k=[];for(;0<T&&d.length;)k.push(d.shift()),T--;return d.length&&k.push(d.join(":")),k}function R(d){o.setTimeout(()=>{throw d},0)}function F(){var d=W;let T=null;return d.g&&(T=d.g,d.g=d.g.next,d.g||(d.h=null),T.next=null),T}class oe{constructor(){this.h=this.g=null}add(T,k){const M=ae.get();M.set(T,k),this.h?this.h.next=M:this.g=M,this.h=M}}var ae=new _(()=>new ve,d=>d.reset());class ve{constructor(){this.next=this.g=this.h=null}set(T,k){this.h=T,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let he,Z=!1,W=new oe,ie=()=>{const d=o.Promise.resolve(void 0);he=()=>{d.then(ue)}};var ue=()=>{for(var d;d=F();){try{d.h.call(d.g)}catch(k){R(k)}var T=ae;T.j(d),100>T.h&&(T.h++,d.next=T.g,T.g=d)}Z=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(d,T){this.type=d,this.g=this.target=T,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,T=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const k=()=>{};o.addEventListener("test",k,T),o.removeEventListener("test",k,T)}catch{}return d}();function H(d,T){if(K.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var k=this.type=d.type,M=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=T,T=d.relatedTarget){if(O){e:{try{I(T.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(T=null)}}else k=="mouseover"?T=d.fromElement:k=="mouseout"&&(T=d.toElement);this.relatedTarget=T,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:re[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&H.aa.h.call(this)}}x(H,K);var re={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var ee="closure_listenable_"+(1e6*Math.random()|0),le=0;function we(d,T,k,M,ne){this.listener=d,this.proxy=null,this.src=T,this.type=k,this.capture=!!M,this.ha=ne,this.key=++le,this.da=this.fa=!1}function de(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Pe(d){this.src=d,this.g={},this.h=0}Pe.prototype.add=function(d,T,k,M,ne){var ce=d.toString();d=this.g[ce],d||(d=this.g[ce]=[],this.h++);var ke=et(d,T,M,ne);return-1<ke?(T=d[ke],k||(T.fa=!1)):(T=new we(T,this.src,ce,!!M,ne),T.fa=k,d.push(T)),T};function B(d,T){var k=T.type;if(k in d.g){var M=d.g[k],ne=Array.prototype.indexOf.call(M,T,void 0),ce;(ce=0<=ne)&&Array.prototype.splice.call(M,ne,1),ce&&(de(T),d.g[k].length==0&&(delete d.g[k],d.h--))}}function et(d,T,k,M){for(var ne=0;ne<d.length;++ne){var ce=d[ne];if(!ce.da&&ce.listener==T&&ce.capture==!!k&&ce.ha==M)return ne}return-1}var Ye="closure_lm_"+(1e6*Math.random()|0),tt={};function He(d,T,k,M,ne){if(Array.isArray(T)){for(var ce=0;ce<T.length;ce++)He(d,T[ce],k,M,ne);return null}return k=In(k),d&&d[ee]?d.K(T,k,c(M)?!!M.capture:!1,ne):be(d,T,k,!1,M,ne)}function be(d,T,k,M,ne,ce){if(!T)throw Error("Invalid event type");var ke=c(ne)?!!ne.capture:!!ne,St=Cn(d);if(St||(d[Ye]=St=new Pe(d)),k=St.add(T,k,M,ke,ce),k.proxy)return k;if(M=ct(),k.proxy=M,M.src=d,M.listener=k,d.addEventListener)X||(ne=ke),ne===void 0&&(ne=!1),d.addEventListener(T.toString(),M,ne);else if(d.attachEvent)d.attachEvent(Mr(T.toString()),M);else if(d.addListener&&d.removeListener)d.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return k}function ct(){function d(k){return T.call(d.src,d.listener,k)}const T=ua;return d}function ur(d,T,k,M,ne){if(Array.isArray(T))for(var ce=0;ce<T.length;ce++)ur(d,T[ce],k,M,ne);else M=c(M)?!!M.capture:!!M,k=In(k),d&&d[ee]?(d=d.i,T=String(T).toString(),T in d.g&&(ce=d.g[T],k=et(ce,k,M,ne),-1<k&&(de(ce[k]),Array.prototype.splice.call(ce,k,1),ce.length==0&&(delete d.g[T],d.h--)))):d&&(d=Cn(d))&&(T=d.g[T.toString()],d=-1,T&&(d=et(T,k,M,ne)),(k=-1<d?T[d]:null)&&Je(k))}function Je(d){if(typeof d!="number"&&d&&!d.da){var T=d.src;if(T&&T[ee])B(T.i,d);else{var k=d.type,M=d.proxy;T.removeEventListener?T.removeEventListener(k,M,d.capture):T.detachEvent?T.detachEvent(Mr(k),M):T.addListener&&T.removeListener&&T.removeListener(M),(k=Cn(T))?(B(k,d),k.h==0&&(k.src=null,T[Ye]=null)):de(d)}}}function Mr(d){return d in tt?tt[d]:tt[d]="on"+d}function ua(d,T){if(d.da)d=!0;else{T=new H(T,this);var k=d.listener,M=d.ha||d.src;d.fa&&Je(d),d=k.call(M,T)}return d}function Cn(d){return d=d[Ye],d instanceof Pe?d:null}var Xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(d){return typeof d=="function"?d:(d[Xt]||(d[Xt]=function(T){return d.handleEvent(T)}),d[Xt])}function gt(){L.call(this),this.i=new Pe(this),this.M=this,this.F=null}x(gt,L),gt.prototype[ee]=!0,gt.prototype.removeEventListener=function(d,T,k,M){ur(this,d,T,k,M)};function Mt(d,T){var k,M=d.F;if(M)for(k=[];M;M=M.F)k.push(M);if(d=d.M,M=T.type||T,typeof T=="string")T=new K(T,d);else if(T instanceof K)T.target=T.target||d;else{var ne=T;T=new K(M,d),N(T,ne)}if(ne=!0,k)for(var ce=k.length-1;0<=ce;ce--){var ke=T.g=k[ce];ne=Ct(ke,M,!0,T)&&ne}if(ke=T.g=d,ne=Ct(ke,M,!0,T)&&ne,ne=Ct(ke,M,!1,T)&&ne,k)for(ce=0;ce<k.length;ce++)ke=T.g=k[ce],ne=Ct(ke,M,!1,T)&&ne}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var d=this.i,T;for(T in d.g){for(var k=d.g[T],M=0;M<k.length;M++)de(k[M]);delete d.g[T],d.h--}}this.F=null},gt.prototype.K=function(d,T,k,M){return this.i.add(String(d),T,!1,k,M)},gt.prototype.L=function(d,T,k,M){return this.i.add(String(d),T,!0,k,M)};function Ct(d,T,k,M){if(T=d.i.g[String(T)],!T)return!0;T=T.concat();for(var ne=!0,ce=0;ce<T.length;++ce){var ke=T[ce];if(ke&&!ke.da&&ke.capture==k){var St=ke.listener,Vr=ke.ha||ke.src;ke.fa&&B(d.i,ke),ne=St.call(Vr,M)!==!1&&ne}}return ne&&!M.defaultPrevented}function br(d,T,k){if(typeof d=="function")k&&(d=m(d,k));else if(d&&typeof d.handleEvent=="function")d=m(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:o.setTimeout(d,T||0)}function ze(d){d.g=br(()=>{d.g=null,d.i&&(d.i=!1,ze(d))},d.l);const T=d.h;d.h=null,d.m.apply(null,T)}class Et extends L{constructor(T,k){super(),this.m=T,this.l=k,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:ze(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(d){L.call(this),this.h=d,this.g={}}x(Bt,L);var At=[];function Hn(d){P(d.g,function(T,k){this.g.hasOwnProperty(k)&&Je(T)},d),d.g={}}Bt.prototype.N=function(){Bt.aa.N.call(this),Hn(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fa=o.JSON.stringify,yu=o.JSON.parse,vu=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function ha(){}ha.prototype.h=null;function _o(d){return d.h||(d.h=d.i())}function Eo(){}var Ci={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function To(){K.call(this,"d")}x(To,K);function Rs(){K.call(this,"c")}x(Rs,K);var Ps={},ei=null;function da(){return ei=ei||new gt}Ps.La="serverreachability";function Rl(d){K.call(this,Ps.La,d)}x(Rl,K);function Ii(d){const T=da();Mt(T,new Rl(T))}Ps.STAT_EVENT="statevent";function Pl(d,T){K.call(this,Ps.STAT_EVENT,d),this.stat=T}x(Pl,K);function Cr(d){const T=da();Mt(T,new Pl(T,d))}Ps.Ma="timingevent";function Ni(d,T){K.call(this,Ps.Ma,d),this.size=T}x(Ni,K);function yn(d,T){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},T)}function ti(){this.g=!0}ti.prototype.xa=function(){this.g=!1};function wu(d,T,k,M,ne,ce){d.info(function(){if(d.g)if(ce)for(var ke="",St=ce.split("&"),Vr=0;Vr<St.length;Vr++){var dt=St[Vr].split("=");if(1<dt.length){var Jr=dt[0];dt=dt[1];var Zr=Jr.split("_");ke=2<=Zr.length&&Zr[1]=="type"?ke+(Jr+"="+dt+"&"):ke+(Jr+"=redacted&")}}else ke=null;else ke=ce;return"XMLHTTP REQ ("+M+") [attempt "+ne+"]: "+T+`
`+k+`
`+ke})}function _u(d,T,k,M,ne,ce,ke){d.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+ne+"]: "+T+`
`+k+`
`+ce+" "+ke})}function D(d,T,k,M){d.info(function(){return"XMLHTTP TEXT ("+T+"): "+j(d,k)+(M?" "+M:"")})}function U(d,T){d.info(function(){return"TIMEOUT: "+T})}ti.prototype.info=function(){};function j(d,T){if(!d.g)return T;if(!T)return null;try{var k=JSON.parse(T);if(k){for(d=0;d<k.length;d++)if(Array.isArray(k[d])){var M=k[d];if(!(2>M.length)){var ne=M[1];if(Array.isArray(ne)&&!(1>ne.length)){var ce=ne[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(var ke=1;ke<ne.length;ke++)ne[ke]=""}}}}return fa(k)}catch{return T}}var V={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},b;function G(){}x(G,ha),G.prototype.g=function(){return new XMLHttpRequest},G.prototype.i=function(){return{}},b=new G;function J(d,T,k,M){this.j=d,this.i=T,this.l=k,this.R=M||1,this.U=new Bt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var q={},Q={};function se(d,T,k){d.L=1,d.v=hd(Ri(T)),d.m=k,d.P=!0,ye(d,null)}function ye(d,T){d.F=Date.now(),pe(d),d.A=Ri(d.v);var k=d.A,M=d.R;Array.isArray(M)||(M=[String(M)]),H_(k.i,"t",M),d.C=0,k=d.j.J,d.h=new Y,d.g=l2(d.j,k?T:null,!d.m),0<d.O&&(d.M=new Et(m(d.Y,d,d.g),d.O)),T=d.U,k=d.g,M=d.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(At[0]=ne.toString()),ne=At);for(var ce=0;ce<ne.length;ce++){var ke=He(k,ne[ce],M||T.handleEvent,!1,T.h||T);if(!ke)break;T.g[ke.key]=ke}T=d.H?E(d.H):{},d.m?(d.u||(d.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,T)):(d.u="GET",d.g.ea(d.A,d.u,null,T)),Ii(),wu(d.i,d.u,d.A,d.l,d.R,d.m)}J.prototype.ca=function(d){d=d.target;const T=this.M;T&&Pi(d)==3?T.j():this.Y(d)},J.prototype.Y=function(d){try{if(d==this.g)e:{const Zr=Pi(this.g);var T=this.g.Ba();const Ll=this.g.Z();if(!(3>Zr)&&(Zr!=3||this.g&&(this.h.h||this.g.oa()||Q_(this.g)))){this.J||Zr!=4||T==7||(T==8||0>=Ll?Ii(3):Ii(2)),Oe(this);var k=this.g.Z();this.X=k;t:if(me(this)){var M=Q_(this.g);d="";var ne=M.length,ce=Pi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pt(this),qe(this);var ke="";break t}this.h.i=new o.TextDecoder}for(T=0;T<ne;T++)this.h.h=!0,d+=this.h.i.decode(M[T],{stream:!(ce&&T==ne-1)});M.length=0,this.h.g+=d,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=k==200,_u(this.i,this.u,this.A,this.l,this.R,Zr,k),this.o){if(this.T&&!this.K){t:{if(this.g){var St,Vr=this.g;if((St=Vr.g?Vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(St)){var dt=St;break t}}dt=null}if(k=dt)D(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,jr(this,k);else{this.o=!1,this.s=3,Cr(12),pt(this),qe(this);break e}}if(this.P){k=!0;let Fs;for(;!this.J&&this.C<ke.length;)if(Fs=xe(this,ke),Fs==Q){Zr==4&&(this.s=4,Cr(14),k=!1),D(this.i,this.l,null,"[Incomplete Response]");break}else if(Fs==q){this.s=4,Cr(15),D(this.i,this.l,ke,"[Invalid Chunk]"),k=!1;break}else D(this.i,this.l,Fs,null),jr(this,Fs);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zr!=4||ke.length!=0||this.h.h||(this.s=1,Cr(16),k=!1),this.o=this.o&&k,!k)D(this.i,this.l,ke,"[Invalid Chunked Response]"),pt(this),qe(this);else if(0<ke.length&&!this.W){this.W=!0;var Jr=this.j;Jr.g==this&&Jr.ba&&!Jr.M&&(Jr.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),Yp(Jr),Jr.M=!0,Cr(11))}}else D(this.i,this.l,ke,null),jr(this,ke);Zr==4&&pt(this),this.o&&!this.J&&(Zr==4?s2(this.j,this):(this.o=!1,pe(this)))}else uF(this.g),k==400&&0<ke.indexOf("Unknown SID")?(this.s=3,Cr(12)):(this.s=0,Cr(13)),pt(this),qe(this)}}}catch{}finally{}};function me(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function xe(d,T){var k=d.C,M=T.indexOf(`
`,k);return M==-1?Q:(k=Number(T.substring(k,M)),isNaN(k)?q:(M+=1,M+k>T.length?Q:(T=T.slice(M,M+k),d.C=M+k,T)))}J.prototype.cancel=function(){this.J=!0,pt(this)};function pe(d){d.S=Date.now()+d.I,Ce(d,d.I)}function Ce(d,T){if(d.B!=null)throw Error("WatchDog timer not null");d.B=yn(m(d.ba,d),T)}function Oe(d){d.B&&(o.clearTimeout(d.B),d.B=null)}J.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(U(this.i,this.A),this.L!=2&&(Ii(),Cr(17)),pt(this),this.s=2,qe(this)):Ce(this,this.S-d)};function qe(d){d.j.G==0||d.J||s2(d.j,d)}function pt(d){Oe(d);var T=d.M;T&&typeof T.ma=="function"&&T.ma(),d.M=null,Hn(d.U),d.g&&(T=d.g,d.g=null,T.abort(),T.ma())}function jr(d,T){try{var k=d.j;if(k.G!=0&&(k.g==d||Wn(k.h,d))){if(!d.K&&Wn(k.h,d)&&k.G==3){try{var M=k.Da.g.parse(T)}catch{M=null}if(Array.isArray(M)&&M.length==3){var ne=M;if(ne[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<d.F)yd(k),gd(k);else break e;Xp(k),Cr(18)}}else k.za=ne[1],0<k.za-k.T&&37500>ne[2]&&k.F&&k.v==0&&!k.C&&(k.C=yn(m(k.Za,k),6e3));if(1>=Dl(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Ao(k,11)}else if((d.K||k.g==d)&&yd(k),!w(T))for(ne=k.Da.g.parse(T),T=0;T<ne.length;T++){let dt=ne[T];if(k.T=dt[0],dt=dt[1],k.G==2)if(dt[0]=="c"){k.K=dt[1],k.ia=dt[2];const Jr=dt[3];Jr!=null&&(k.la=Jr,k.j.info("VER="+k.la));const Zr=dt[4];Zr!=null&&(k.Aa=Zr,k.j.info("SVER="+k.Aa));const Ll=dt[5];Ll!=null&&typeof Ll=="number"&&0<Ll&&(M=1.5*Ll,k.L=M,k.j.info("backChannelRequestTimeoutMs_="+M)),M=k;const Fs=d.g;if(Fs){const wd=Fs.g?Fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wd){var ce=M.h;ce.g||wd.indexOf("spdy")==-1&&wd.indexOf("quic")==-1&&wd.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(Gp(ce,ce.h),ce.h=null))}if(M.D){const Qp=Fs.g?Fs.g.getResponseHeader("X-HTTP-Session-Id"):null;Qp&&(M.ya=Qp,It(M.I,M.D,Qp))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-d.F,k.j.info("Handshake RTT: "+k.R+"ms")),M=k;var ke=d;if(M.qa=o2(M,M.J?M.ia:null,M.W),ke.K){L_(M.h,ke);var St=ke,Vr=M.L;Vr&&(St.I=Vr),St.B&&(Oe(St),pe(St)),M.g=ke}else r2(M);0<k.i.length&&xd(k)}else dt[0]!="stop"&&dt[0]!="close"||Ao(k,7);else k.G==3&&(dt[0]=="stop"||dt[0]=="close"?dt[0]=="stop"?Ao(k,7):Kp(k):dt[0]!="noop"&&k.l&&k.l.ta(dt),k.v=0)}}Ii(4)}catch{}}var Ds=class{constructor(d,T){this.g=d,this.map=T}};function ma(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ri(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Dl(d){return d.h?1:d.g?d.g.size:0}function Wn(d,T){return d.h?d.h==T:d.g?d.g.has(T):!1}function Gp(d,T){d.g?d.g.add(T):d.h=T}function L_(d,T){d.h&&d.h==T?d.h=null:d.g&&d.g.has(T)&&d.g.delete(T)}ma.prototype.cancel=function(){if(this.i=M_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function M_(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let T=d.i;for(const k of d.g.values())T=T.concat(k.D);return T}return g(d.i)}function XD(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var T=[],k=d.length,M=0;M<k;M++)T.push(d[M]);return T}T=[],k=0;for(M in d)T[k++]=d[M];return T}function YD(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var T=[];d=d.length;for(var k=0;k<d;k++)T.push(k);return T}T=[],k=0;for(const M in d)T[k++]=M;return T}}}function j_(d,T){if(d.forEach&&typeof d.forEach=="function")d.forEach(T,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,T,void 0);else for(var k=YD(d),M=XD(d),ne=M.length,ce=0;ce<ne;ce++)T.call(void 0,M[ce],k&&k[ce],d)}var V_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function QD(d,T){if(d){d=d.split("&");for(var k=0;k<d.length;k++){var M=d[k].indexOf("="),ne=null;if(0<=M){var ce=d[k].substring(0,M);ne=d[k].substring(M+1)}else ce=d[k];T(ce,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function So(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof So){this.h=d.h,ud(this,d.j),this.o=d.o,this.g=d.g,fd(this,d.s),this.l=d.l;var T=d.i,k=new Su;k.i=T.i,T.g&&(k.g=new Map(T.g),k.h=T.h),B_(this,k),this.m=d.m}else d&&(T=String(d).match(V_))?(this.h=!1,ud(this,T[1]||"",!0),this.o=Eu(T[2]||""),this.g=Eu(T[3]||"",!0),fd(this,T[4]),this.l=Eu(T[5]||"",!0),B_(this,T[6]||"",!0),this.m=Eu(T[7]||"")):(this.h=!1,this.i=new Su(null,this.h))}So.prototype.toString=function(){var d=[],T=this.j;T&&d.push(Tu(T,U_,!0),":");var k=this.g;return(k||T=="file")&&(d.push("//"),(T=this.o)&&d.push(Tu(T,U_,!0),"@"),d.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&d.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&d.push("/"),d.push(Tu(k,k.charAt(0)=="/"?eF:ZD,!0))),(k=this.i.toString())&&d.push("?",k),(k=this.m)&&d.push("#",Tu(k,rF)),d.join("")};function Ri(d){return new So(d)}function ud(d,T,k){d.j=k?Eu(T,!0):T,d.j&&(d.j=d.j.replace(/:$/,""))}function fd(d,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);d.s=T}else d.s=null}function B_(d,T,k){T instanceof Su?(d.i=T,nF(d.i,d.h)):(k||(T=Tu(T,tF)),d.i=new Su(T,d.h))}function It(d,T,k){d.i.set(T,k)}function hd(d){return It(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Eu(d,T){return d?T?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Tu(d,T,k){return typeof d=="string"?(d=encodeURI(d).replace(T,JD),k&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function JD(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var U_=/[#\/\?@]/g,ZD=/[#\?:]/g,eF=/[#\?]/g,tF=/[#\?@]/g,rF=/#/g;function Su(d,T){this.h=this.g=null,this.i=d||null,this.j=!!T}function pa(d){d.g||(d.g=new Map,d.h=0,d.i&&QD(d.i,function(T,k){d.add(decodeURIComponent(T.replace(/\+/g," ")),k)}))}t=Su.prototype,t.add=function(d,T){pa(this),this.i=null,d=Fl(this,d);var k=this.g.get(d);return k||this.g.set(d,k=[]),k.push(T),this.h+=1,this};function $_(d,T){pa(d),T=Fl(d,T),d.g.has(T)&&(d.i=null,d.h-=d.g.get(T).length,d.g.delete(T))}function z_(d,T){return pa(d),T=Fl(d,T),d.g.has(T)}t.forEach=function(d,T){pa(this),this.g.forEach(function(k,M){k.forEach(function(ne){d.call(T,ne,M,this)},this)},this)},t.na=function(){pa(this);const d=Array.from(this.g.values()),T=Array.from(this.g.keys()),k=[];for(let M=0;M<T.length;M++){const ne=d[M];for(let ce=0;ce<ne.length;ce++)k.push(T[M])}return k},t.V=function(d){pa(this);let T=[];if(typeof d=="string")z_(this,d)&&(T=T.concat(this.g.get(Fl(this,d))));else{d=Array.from(this.g.values());for(let k=0;k<d.length;k++)T=T.concat(d[k])}return T},t.set=function(d,T){return pa(this),this.i=null,d=Fl(this,d),z_(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[T]),this.h+=1,this},t.get=function(d,T){return d?(d=this.V(d),0<d.length?String(d[0]):T):T};function H_(d,T,k){$_(d,T),0<k.length&&(d.i=null,d.g.set(Fl(d,T),g(k)),d.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],T=Array.from(this.g.keys());for(var k=0;k<T.length;k++){var M=T[k];const ce=encodeURIComponent(String(M)),ke=this.V(M);for(M=0;M<ke.length;M++){var ne=ce;ke[M]!==""&&(ne+="="+encodeURIComponent(String(ke[M]))),d.push(ne)}}return this.i=d.join("&")};function Fl(d,T){return T=String(T),d.j&&(T=T.toLowerCase()),T}function nF(d,T){T&&!d.j&&(pa(d),d.i=null,d.g.forEach(function(k,M){var ne=M.toLowerCase();M!=ne&&($_(this,M),H_(this,ne,k))},d)),d.j=T}function sF(d,T){const k=new ti;if(o.Image){const M=new Image;M.onload=p(ga,k,"TestLoadImage: loaded",!0,T,M),M.onerror=p(ga,k,"TestLoadImage: error",!1,T,M),M.onabort=p(ga,k,"TestLoadImage: abort",!1,T,M),M.ontimeout=p(ga,k,"TestLoadImage: timeout",!1,T,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=d}else T(!1)}function iF(d,T){const k=new ti,M=new AbortController,ne=setTimeout(()=>{M.abort(),ga(k,"TestPingServer: timeout",!1,T)},1e4);fetch(d,{signal:M.signal}).then(ce=>{clearTimeout(ne),ce.ok?ga(k,"TestPingServer: ok",!0,T):ga(k,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ne),ga(k,"TestPingServer: error",!1,T)})}function ga(d,T,k,M,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),M(k)}catch{}}function aF(){this.g=new vu}function oF(d,T,k){const M=k||"";try{j_(d,function(ne,ce){let ke=ne;c(ne)&&(ke=fa(ne)),T.push(M+ce+"="+encodeURIComponent(ke))})}catch(ne){throw T.push(M+"type="+encodeURIComponent("_badmap")),ne}}function dd(d){this.l=d.Ub||null,this.j=d.eb||!1}x(dd,ha),dd.prototype.g=function(){return new md(this.l,this.j)},dd.prototype.i=function(d){return function(){return d}}({});function md(d,T){gt.call(this),this.D=d,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(md,gt),t=md.prototype,t.open=function(d,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=T,this.readyState=1,ku(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(T.body=d),(this.D||o).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Au(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,ku(this)),this.g&&(this.readyState=3,ku(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;W_(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function W_(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var T=d.value?d.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!d.done}))&&(this.response=this.responseText+=T)}d.done?Au(this):ku(this),this.readyState==3&&W_(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Au(this))},t.Qa=function(d){this.g&&(this.response=d,Au(this))},t.ga=function(){this.g&&Au(this)};function Au(d){d.readyState=4,d.l=null,d.j=null,d.v=null,ku(d)}t.setRequestHeader=function(d,T){this.u.append(d,T)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],T=this.h.entries();for(var k=T.next();!k.done;)k=k.value,d.push(k[0]+": "+k[1]),k=T.next();return d.join(`\r
`)};function ku(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(md.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function G_(d){let T="";return P(d,function(k,M){T+=M,T+=":",T+=k,T+=`\r
`}),T}function qp(d,T,k){e:{for(M in k){var M=!1;break e}M=!0}M||(k=G_(k),typeof d=="string"?k!=null&&encodeURIComponent(String(k)):It(d,T,k))}function Yt(d){gt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Yt,gt);var lF=/^https?$/i,cF=["POST","PUT"];t=Yt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,T,k,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);T=T?T.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():b.g(),this.v=this.o?_o(this.o):_o(b),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(T,String(d),!0),this.B=!1}catch(ce){q_(this,ce);return}if(d=k||"",k=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var ne in M)k.set(ne,M[ne]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ce of M.keys())k.set(ce,M.get(ce));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(k.keys()).find(ce=>ce.toLowerCase()=="content-type"),ne=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(cF,T,void 0))||M||ne||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,ke]of k)this.g.setRequestHeader(ce,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Y_(this),this.u=!0,this.g.send(d),this.u=!1}catch(ce){q_(this,ce)}};function q_(d,T){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=T,d.m=5,K_(d),pd(d)}function K_(d){d.A||(d.A=!0,Mt(d,"complete"),Mt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Mt(this,"complete"),Mt(this,"abort"),pd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pd(this,!0)),Yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?X_(this):this.bb())},t.bb=function(){X_(this)};function X_(d){if(d.h&&typeof a<"u"&&(!d.v[1]||Pi(d)!=4||d.Z()!=2)){if(d.u&&Pi(d)==4)br(d.Ea,0,d);else if(Mt(d,"readystatechange"),Pi(d)==4){d.h=!1;try{const ke=d.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var k;if(!(k=T)){var M;if(M=ke===0){var ne=String(d.D).match(V_)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),M=!lF.test(ne?ne.toLowerCase():"")}k=M}if(k)Mt(d,"complete"),Mt(d,"success");else{d.m=6;try{var ce=2<Pi(d)?d.g.statusText:""}catch{ce=""}d.l=ce+" ["+d.Z()+"]",K_(d)}}finally{pd(d)}}}}function pd(d,T){if(d.g){Y_(d);const k=d.g,M=d.v[0]?()=>{}:null;d.g=null,d.v=null,T||Mt(d,"ready");try{k.onreadystatechange=M}catch{}}}function Y_(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function Pi(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<Pi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var T=this.g.responseText;return d&&T.indexOf(d)==0&&(T=T.substring(d.length)),yu(T)}};function Q_(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function uF(d){const T={};d=(d.g&&2<=Pi(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<d.length;M++){if(w(d[M]))continue;var k=C(d[M]);const ne=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ce=T[ne]||[];T[ne]=ce,ce.push(k)}S(T,function(M){return M.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bu(d,T,k){return k&&k.internalChannelParams&&k.internalChannelParams[d]||T}function J_(d){this.Aa=0,this.i=[],this.j=new ti,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bu("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bu("baseRetryDelayMs",5e3,d),this.cb=bu("retryDelaySeedMs",1e4,d),this.Wa=bu("forwardChannelMaxRetries",2,d),this.wa=bu("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ma(d&&d.concurrentRequestLimit),this.Da=new aF,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=J_.prototype,t.la=8,t.G=1,t.connect=function(d,T,k,M){Cr(0),this.W=d,this.H=T||{},k&&M!==void 0&&(this.H.OSID=k,this.H.OAID=M),this.F=this.X,this.I=o2(this,null,this.W),xd(this)};function Kp(d){if(Z_(d),d.G==3){var T=d.U++,k=Ri(d.I);if(It(k,"SID",d.K),It(k,"RID",T),It(k,"TYPE","terminate"),Cu(d,k),T=new J(d,d.j,T),T.L=2,T.v=hd(Ri(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(T.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=T.v,k=!0),k||(T.g=l2(T.j,null),T.g.ea(T.v)),T.F=Date.now(),pe(T)}a2(d)}function gd(d){d.g&&(Yp(d),d.g.cancel(),d.g=null)}function Z_(d){gd(d),d.u&&(o.clearTimeout(d.u),d.u=null),yd(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function xd(d){if(!ri(d.h)&&!d.s){d.s=!0;var T=d.Ga;he||ie(),Z||(he(),Z=!0),W.add(T,d),d.B=0}}function fF(d,T){return Dl(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=T.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=yn(m(d.Ga,d,T),i2(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ne=new J(this,this.j,d);let ce=this.o;if(this.S&&(ce?(ce=E(ce),N(ce,this.S)):ce=this.S),this.m!==null||this.O||(ne.H=ce,ce=null),this.P)e:{for(var T=0,k=0;k<this.i.length;k++){t:{var M=this.i[k];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(T+=M,4096<T){T=k;break e}if(T===4096||k===this.i.length-1){T=k+1;break e}}T=1e3}else T=1e3;T=t2(this,ne,T),k=Ri(this.I),It(k,"RID",d),It(k,"CVER",22),this.D&&It(k,"X-HTTP-Session-Id",this.D),Cu(this,k),ce&&(this.O?T="headers="+encodeURIComponent(String(G_(ce)))+"&"+T:this.m&&qp(k,this.m,ce)),Gp(this.h,ne),this.Ua&&It(k,"TYPE","init"),this.P?(It(k,"$req",T),It(k,"SID","null"),ne.T=!0,se(ne,k,null)):se(ne,k,T),this.G=2}}else this.G==3&&(d?e2(this,d):this.i.length==0||ri(this.h)||e2(this))};function e2(d,T){var k;T?k=T.l:k=d.U++;const M=Ri(d.I);It(M,"SID",d.K),It(M,"RID",k),It(M,"AID",d.T),Cu(d,M),d.m&&d.o&&qp(M,d.m,d.o),k=new J(d,d.j,k,d.B+1),d.m===null&&(k.H=d.o),T&&(d.i=T.D.concat(d.i)),T=t2(d,k,1e3),k.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Gp(d.h,k),se(k,M,T)}function Cu(d,T){d.H&&P(d.H,function(k,M){It(T,M,k)}),d.l&&j_({},function(k,M){It(T,M,k)})}function t2(d,T,k){k=Math.min(d.i.length,k);var M=d.l?m(d.l.Na,d.l,d):null;e:{var ne=d.i;let ce=-1;for(;;){const ke=["count="+k];ce==-1?0<k?(ce=ne[0].g,ke.push("ofs="+ce)):ce=0:ke.push("ofs="+ce);let St=!0;for(let Vr=0;Vr<k;Vr++){let dt=ne[Vr].g;const Jr=ne[Vr].map;if(dt-=ce,0>dt)ce=Math.max(0,ne[Vr].g-100),St=!1;else try{oF(Jr,ke,"req"+dt+"_")}catch{M&&M(Jr)}}if(St){M=ke.join("&");break e}}}return d=d.i.splice(0,k),T.D=d,M}function r2(d){if(!d.g&&!d.u){d.Y=1;var T=d.Fa;he||ie(),Z||(he(),Z=!0),W.add(T,d),d.v=0}}function Xp(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=yn(m(d.Fa,d),i2(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,n2(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=yn(m(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Cr(10),gd(this),n2(this))};function Yp(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function n2(d){d.g=new J(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var T=Ri(d.qa);It(T,"RID","rpc"),It(T,"SID",d.K),It(T,"AID",d.T),It(T,"CI",d.F?"0":"1"),!d.F&&d.ja&&It(T,"TO",d.ja),It(T,"TYPE","xmlhttp"),Cu(d,T),d.m&&d.o&&qp(T,d.m,d.o),d.L&&(d.g.I=d.L);var k=d.g;d=d.ia,k.L=1,k.v=hd(Ri(T)),k.m=null,k.P=!0,ye(k,d)}t.Za=function(){this.C!=null&&(this.C=null,gd(this),Xp(this),Cr(19))};function yd(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function s2(d,T){var k=null;if(d.g==T){yd(d),Yp(d),d.g=null;var M=2}else if(Wn(d.h,T))k=T.D,L_(d.h,T),M=1;else return;if(d.G!=0){if(T.o)if(M==1){k=T.m?T.m.length:0,T=Date.now()-T.F;var ne=d.B;M=da(),Mt(M,new Ni(M,k)),xd(d)}else r2(d);else if(ne=T.s,ne==3||ne==0&&0<T.X||!(M==1&&fF(d,T)||M==2&&Xp(d)))switch(k&&0<k.length&&(T=d.h,T.i=T.i.concat(k)),ne){case 1:Ao(d,5);break;case 4:Ao(d,10);break;case 3:Ao(d,6);break;default:Ao(d,2)}}}function i2(d,T){let k=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(k*=2),k*T}function Ao(d,T){if(d.j.info("Error code "+T),T==2){var k=m(d.fb,d),M=d.Xa;const ne=!M;M=new So(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ud(M,"https"),hd(M),ne?sF(M.toString(),k):iF(M.toString(),k)}else Cr(2);d.G=0,d.l&&d.l.sa(T),a2(d),Z_(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Cr(2)):(this.j.info("Failed to ping google.com"),Cr(1))};function a2(d){if(d.G=0,d.ka=[],d.l){const T=M_(d.h);(T.length!=0||d.i.length!=0)&&(v(d.ka,T),v(d.ka,d.i),d.h.i.length=0,g(d.i),d.i.length=0),d.l.ra()}}function o2(d,T,k){var M=k instanceof So?Ri(k):new So(k);if(M.g!="")T&&(M.g=T+"."+M.g),fd(M,M.s);else{var ne=o.location;M=ne.protocol,T=T?T+"."+ne.hostname:ne.hostname,ne=+ne.port;var ce=new So(null);M&&ud(ce,M),T&&(ce.g=T),ne&&fd(ce,ne),k&&(ce.l=k),M=ce}return k=d.D,T=d.ya,k&&T&&It(M,k,T),It(M,"VER",d.la),Cu(d,M),M}function l2(d,T,k){if(T&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=d.Ca&&!d.pa?new Yt(new dd({eb:k})):new Yt(d.pa),T.Ha(d.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function c2(){}t=c2.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function vd(){}vd.prototype.g=function(d,T){return new Gn(d,T)};function Gn(d,T){gt.call(this),this.g=new J_(T),this.l=d,this.h=T&&T.messageUrlParams||null,d=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(d?d["X-WebChannel-Content-Type"]=T.messageContentType:d={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(d?d["X-WebChannel-Client-Profile"]=T.va:d={"X-WebChannel-Client-Profile":T.va}),this.g.S=d,(d=T&&T.Sb)&&!w(d)&&(this.g.m=d),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!w(T)&&(this.g.D=T,d=this.h,d!==null&&T in d&&(d=this.h,T in d&&delete d[T])),this.j=new Ol(this)}x(Gn,gt),Gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){Kp(this.g)},Gn.prototype.o=function(d){var T=this.g;if(typeof d=="string"){var k={};k.__data__=d,d=k}else this.u&&(k={},k.__data__=fa(d),d=k);T.i.push(new Ds(T.Ya++,d)),T.G==3&&xd(T)},Gn.prototype.N=function(){this.g.l=null,delete this.j,Kp(this.g),delete this.g,Gn.aa.N.call(this)};function u2(d){To.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var T=d.__sm__;if(T){e:{for(const k in T){d=k;break e}d=void 0}(this.i=d)&&(d=this.i,T=T!==null&&d in T?T[d]:void 0),this.data=T}else this.data=d}x(u2,To);function f2(){Rs.call(this),this.status=1}x(f2,Rs);function Ol(d){this.g=d}x(Ol,c2),Ol.prototype.ua=function(){Mt(this.g,"a")},Ol.prototype.ta=function(d){Mt(this.g,new u2(d))},Ol.prototype.sa=function(d){Mt(this.g,new f2)},Ol.prototype.ra=function(){Mt(this.g,"b")},vd.prototype.createWebChannel=vd.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,xR=function(){return new vd},gR=function(){return da()},pR=Ps,D1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},V.NO_ERROR=0,V.TIMEOUT=8,V.HTTP_ERROR=6,E0=V,z.COMPLETE="complete",mR=z,Eo.EventType=Ci,Ci.OPEN="a",Ci.CLOSE="b",Ci.ERROR="c",Ci.MESSAGE="d",gt.prototype.listen=gt.prototype.K,Xu=Eo,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,dR=Yt}).apply(typeof Yd<"u"?Yd:typeof self<"u"?self:typeof window<"u"?window:{});const hS="@firebase/firestore",dS="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}an.UNAUTHENTICATED=new an(null),an.GOOGLE_CREDENTIALS=new an("google-credentials-uid"),an.FIRST_PARTY=new an("first-party-uid"),an.MOCK_USER=new an("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uu="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new pp("@firebase/firestore");function zl(){return ul.logLevel}function Ne(t,...e){if(ul.logLevel<=it.DEBUG){const r=e.map(gw);ul.debug(`Firestore (${uu}): ${t}`,...r)}}function ta(t,...e){if(ul.logLevel<=it.ERROR){const r=e.map(gw);ul.error(`Firestore (${uu}): ${t}`,...r)}}function Wc(t,...e){if(ul.logLevel<=it.WARN){const r=e.map(gw);ul.warn(`Firestore (${uu}): ${t}`,...r)}}function gw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,yR(t,n,r)}function yR(t,e,r){let n=`FIRESTORE (${uu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ta(n),new Error(n)}function xt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||yR(e,s,n)}function Ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Zs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XK{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(an.UNAUTHENTICATED))}shutdown(){}}class YK{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class QK{constructor(e){this.t=e,this.currentUser=an.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){xt(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new qi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qi,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(xt(typeof n.accessToken=="string",31837,{l:n}),new vR(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xt(e===null||typeof e=="string",2055,{h:e}),new an(e)}}class JK{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=an.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ZK{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new JK(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(an.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eX{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){xt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ne("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new mS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(xt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new mS(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tX(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=tX(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function at(t,e){return t<e?-1:t>e?1:0}function F1(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Wg(s)===Wg(i)?at(s,i):Wg(s)?1:-1}return at(t.length,e.length)}const rX=55296,nX=57343;function Wg(t){const e=t.charCodeAt(0);return e>=rX&&e<=nX}function Gc(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="__name__";class li{constructor(e,r,n){r===void 0?r=0:r>e.length&&Be(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Be(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return li.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof li?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=li.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return at(e.length,r.length)}static compareSegments(e,r){const n=li.isNumericId(e),s=li.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?li.extractNumericId(e).compare(li.extractNumericId(r)):F1(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ha.fromString(e.substring(4,e.length-2))}}class kt extends li{construct(e,r,n){return new kt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new kt(r)}static emptyPath(){return new kt([])}}const sX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qr extends li{construct(e,r,n){return new qr(e,r,n)}static isValidIdentifier(e){return sX.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pS}static keyField(){return new qr([pS])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ie(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ie(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Ie(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qr(r)}static emptyPath(){return new qr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(kt.fromString(e))}static fromName(e){return new Fe(kt.fromString(e).popFirst(5))}static empty(){return new Fe(kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return kt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new kt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(t,e,r){if(!r)throw new Ie(ge.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iX(t,e,r,n){if(e===!0&&n===!0)throw new Ie(ge.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function gS(t){if(!Fe.isDocumentKey(t))throw new Ie(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xS(t){if(Fe.isDocumentKey(t))throw new Ie(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function _R(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function vp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Be(12329,{type:typeof t})}function Is(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ie(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=vp(t);throw new Ie(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(t,e){const r={typeString:t};return e&&(r.value=e),r}function Xh(t,e){if(!_R(t))throw new Ie(ge.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Ie(ge.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=-62135596800,vS=1e6;class Dt{static now(){return Dt.fromMillis(Date.now())}static fromDate(e){return Dt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*vS);return new Dt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<yS)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vS}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xh(e,Dt._jsonSchema))return new Dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Dt._jsonSchemaVersion="firestore/timestamp/1.0",Dt._jsonSchema={type:_r("string",Dt._jsonSchemaVersion),seconds:_r("number"),nanoseconds:_r("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new Dt(0,0))}static max(){return new Ge(new Dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=-1;function aX(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ge.fromTimestamp(n===1e9?new Dt(r+1,0):new Dt(r,n));return new to(s,Fe.empty(),e)}function oX(t){return new to(t.readTime,t.key,ph)}class to{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new to(Ge.min(),Fe.empty(),ph)}static max(){return new to(Ge.max(),Fe.empty(),ph)}}function lX(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Fe.comparator(t.documentKey,e.documentKey),r!==0?r:at(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uX{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(t){if(t.code!==ge.FAILED_PRECONDITION||t.message!==cX)throw t;Ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new _e((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof _e?r:_e.resolve(r)}catch(r){return _e.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):_e.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):_e.reject(r)}static resolve(e){return new _e((r,n)=>{r(e)})}static reject(e){return new _e((r,n)=>{n(e)})}static waitFor(e){return new _e((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=_e.resolve(!1);for(const n of e)r=r.next(s=>s?_e.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new _e((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new _e((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function fX(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function hu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw=-1;function _p(t){return t==null}function Am(t){return t===0&&1/t==-1/0}function hX(t){return typeof t=="number"&&Number.isInteger(t)&&!Am(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER="";function dX(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=wS(e)),e=mX(t.get(r),e);return wS(e)}function mX(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case ER:r+="";break;default:r+=i}}return r}function wS(t){return t+ER+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function xo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function TR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,r){this.comparator=e,this.root=r||Hr.EMPTY}insert(e,r){return new Kt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Hr.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qd(this.root,e,this.comparator,!0)}}class Qd{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Hr.RED,this.left=s??Hr.EMPTY,this.right=i??Hr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Hr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Hr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Hr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Be(27949);return e+(this.isRed()?0:1)}}Hr.EMPTY=null,Hr.RED=!0,Hr.BLACK=!1;Hr.EMPTY=new class{constructor(){this.size=0}get key(){throw Be(57766)}get value(){throw Be(16141)}get color(){throw Be(16727)}get left(){throw Be(29726)}get right(){throw Be(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new Hr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new ES(this.data.getIterator())}getIteratorFrom(e){return new ES(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ar)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ar(this.comparator);return r.data=e,r}}class ES{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.fields=e,e.sort(qr.comparator)}static empty(){return new Zn([])}unionWith(e){let r=new Ar(qr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Gc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new SR("Invalid base64 string: "+i):i}}(e);return new Qr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Qr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qr.EMPTY_BYTE_STRING=new Qr("");const pX=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){if(xt(!!t,39018),typeof t=="string"){let e=0;const r=pX.exec(t);if(xt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:sr(t.seconds),nanos:sr(t.nanos)}}function sr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function no(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR="server_timestamp",kR="__type__",bR="__previous_value__",CR="__local_write_time__";function vw(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[kR])==null?void 0:n.stringValue)===AR}function Ep(t){const e=t.mapValue.fields[bR];return vw(e)?Ep(e):e}function gh(t){const e=ro(t.mapValue.fields[CR].timestampValue);return new Dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gX{constructor(e,r,n,s,i,a,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const km="(default)";class xh{constructor(e,r){this.projectId=e,this.database=r||km}static empty(){return new xh("","")}get isDefaultDatabase(){return this.database===km}isEqual(e){return e instanceof xh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR="__type__",xX="__max__",Jd={mapValue:{}},NR="__vector__",bm="value";function so(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vw(t)?4:vX(t)?9007199254740991:yX(t)?10:11:Be(28295,{value:t})}function Ai(t,e){if(t===e)return!0;const r=so(t);if(r!==so(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gh(t).isEqual(gh(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=ro(s.timestampValue),o=ro(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return no(s.bytesValue).isEqual(no(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return sr(s.geoPointValue.latitude)===sr(i.geoPointValue.latitude)&&sr(s.geoPointValue.longitude)===sr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return sr(s.integerValue)===sr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=sr(s.doubleValue),o=sr(i.doubleValue);return a===o?Am(a)===Am(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Gc(t.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(_S(a)!==_S(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ai(a[l],o[l])))return!1;return!0}(t,e);default:return Be(52216,{left:t})}}function yh(t,e){return(t.values||[]).find(r=>Ai(r,e))!==void 0}function qc(t,e){if(t===e)return 0;const r=so(t),n=so(e);if(r!==n)return at(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return at(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=sr(i.integerValue||i.doubleValue),l=sr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return TS(t.timestampValue,e.timestampValue);case 4:return TS(gh(t),gh(e));case 5:return F1(t.stringValue,e.stringValue);case 6:return function(i,a){const o=no(i),l=no(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=at(o[c],l[c]);if(u!==0)return u}return at(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=at(sr(i.latitude),sr(a.latitude));return o!==0?o:at(sr(i.longitude),sr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return SS(t.arrayValue,e.arrayValue);case 10:return function(i,a){var m,p,x,g;const o=i.fields||{},l=a.fields||{},c=(m=o[bm])==null?void 0:m.arrayValue,u=(p=l[bm])==null?void 0:p.arrayValue,h=at(((x=c==null?void 0:c.values)==null?void 0:x.length)||0,((g=u==null?void 0:u.values)==null?void 0:g.length)||0);return h!==0?h:SS(c,u)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Jd.mapValue&&a===Jd.mapValue)return 0;if(i===Jd.mapValue)return 1;if(a===Jd.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=F1(l[h],u[h]);if(m!==0)return m;const p=qc(o[l[h]],c[u[h]]);if(p!==0)return p}return at(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Be(23264,{he:r})}}function TS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return at(t,e);const r=ro(t),n=ro(e),s=at(r.seconds,n.seconds);return s!==0?s:at(r.nanos,n.nanos)}function SS(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=qc(r[s],n[s]);if(i)return i}return at(r.length,n.length)}function Kc(t){return O1(t)}function O1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ro(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return no(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Fe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=O1(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${O1(r.fields[a])}`;return s+"}"}(t.mapValue):Be(61005,{value:t})}function T0(t){switch(so(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ep(t);return e?16+T0(e):16;case 5:return 2*t.stringValue.length;case 6:return no(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+T0(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return xo(n.fields,(i,a)=>{s+=i.length+T0(a)}),s}(t.mapValue);default:throw Be(13486,{value:t})}}function AS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function L1(t){return!!t&&"integerValue"in t}function ww(t){return!!t&&"arrayValue"in t}function kS(t){return!!t&&"nullValue"in t}function bS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function S0(t){return!!t&&"mapValue"in t}function yX(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[IR])==null?void 0:n.stringValue)===NR}function wf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return xo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=wf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=wf(t.arrayValue.values[r]);return e}return{...t}}function vX(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===xX}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.value=e}static empty(){return new On({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!S0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=wf(r)}setAll(e){let r=qr.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=wf(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());S0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];S0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){xo(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new On(wf(this.value))}}function RR(t){const e=[];return xo(t.fields,(r,n)=>{const s=new qr([r]);if(S0(n)){const i=RR(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new un(e,0,Ge.min(),Ge.min(),Ge.min(),On.empty(),0)}static newFoundDocument(e,r,n,s){return new un(e,1,r,Ge.min(),n,s,0)}static newNoDocument(e,r){return new un(e,2,r,Ge.min(),Ge.min(),On.empty(),0)}static newUnknownDocument(e,r){return new un(e,3,r,Ge.min(),Ge.min(),On.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,r){this.position=e,this.inclusive=r}}function CS(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),r.key):n=qc(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function IS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ai(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,r="asc"){this.field=e,this.dir=r}}function wX(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{}class wr extends PR{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new EX(e,r,n):r==="array-contains"?new AX(e,n):r==="in"?new kX(e,n):r==="not-in"?new bX(e,n):r==="array-contains-any"?new CX(e,n):new wr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new TX(e,n):new SX(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(qc(r,this.value)):r!==null&&so(this.value)===so(r)&&this.matchesComparison(qc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Js extends PR{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Js(e,r)}matches(e){return DR(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function DR(t){return t.op==="and"}function FR(t){return _X(t)&&DR(t)}function _X(t){for(const e of t.filters)if(e instanceof Js)return!1;return!0}function M1(t){if(t instanceof wr)return t.field.canonicalString()+t.op.toString()+Kc(t.value);if(FR(t))return t.filters.map(e=>M1(e)).join(",");{const e=t.filters.map(r=>M1(r)).join(",");return`${t.op}(${e})`}}function OR(t,e){return t instanceof wr?function(n,s){return s instanceof wr&&n.op===s.op&&n.field.isEqual(s.field)&&Ai(n.value,s.value)}(t,e):t instanceof Js?function(n,s){return s instanceof Js&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&OR(a,s.filters[o]),!0):!1}(t,e):void Be(19439)}function LR(t){return t instanceof wr?function(r){return`${r.field.canonicalString()} ${r.op} ${Kc(r.value)}`}(t):t instanceof Js?function(r){return r.op.toString()+" {"+r.getFilters().map(LR).join(" ,")+"}"}(t):"Filter"}class EX extends wr{constructor(e,r,n){super(e,r,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const r=Fe.comparator(e.key,this.key);return this.matchesComparison(r)}}class TX extends wr{constructor(e,r){super(e,"in",r),this.keys=MR("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class SX extends wr{constructor(e,r){super(e,"not-in",r),this.keys=MR("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function MR(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class AX extends wr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return ww(r)&&yh(r.arrayValue,this.value)}}class kX extends wr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&yh(this.value.arrayValue,r)}}class bX extends wr{constructor(e,r){super(e,"not-in",r)}matches(e){if(yh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!yh(this.value.arrayValue,r)}}class CX extends wr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!ww(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>yh(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IX{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function NS(t,e=null,r=[],n=[],s=null,i=null,a=null){return new IX(t,e,r,n,s,i,a)}function _w(t){const e=Ke(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>M1(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),_p(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Kc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Kc(n)).join(",")),e.Te=r}return e.Te}function Ew(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wX(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!OR(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!IS(t.startAt,e.startAt)&&IS(t.endAt,e.endAt)}function j1(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function NX(t,e,r,n,s,i,a,o){return new du(t,e,r,n,s,i,a,o)}function Tw(t){return new du(t)}function RS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jR(t){return t.collectionGroup!==null}function _f(t){const e=Ke(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ar(qr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new vh(i,n))}),r.has(qr.keyField().canonicalString())||e.Ie.push(new vh(qr.keyField(),n))}return e.Ie}function xi(t){const e=Ke(t);return e.Ee||(e.Ee=RX(e,_f(t))),e.Ee}function RX(t,e){if(t.limitType==="F")return NS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new vh(s.field,i)});const r=t.endAt?new Cm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Cm(t.startAt.position,t.startAt.inclusive):null;return NS(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function V1(t,e){const r=t.filters.concat([e]);return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function B1(t,e,r){return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Tp(t,e){return Ew(xi(t),xi(e))&&t.limitType===e.limitType}function VR(t){return`${_w(xi(t))}|lt:${t.limitType}`}function Hl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>LR(s)).join(", ")}]`),_p(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Kc(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Kc(s)).join(",")),`Target(${n})`}(xi(t))}; limitType=${t.limitType})`}function Sp(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Fe.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of _f(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=CS(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,_f(n),s)||n.endAt&&!function(a,o,l){const c=CS(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,_f(n),s))}(t,e)}function PX(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function BR(t){return(e,r)=>{let n=!1;for(const s of _f(t)){const i=DX(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function DX(t,e,r){const n=t.field.isKeyField()?Fe.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?qc(l,c):Be(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Be(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){xo(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return TR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FX=new Kt(Fe.comparator);function ra(){return FX}const UR=new Kt(Fe.comparator);function Yu(...t){let e=UR;for(const r of t)e=e.insert(r.key,r);return e}function $R(t){let e=UR;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Lo(){return Ef()}function zR(){return Ef()}function Ef(){return new bl(t=>t.toString(),(t,e)=>t.isEqual(e))}const OX=new Kt(Fe.comparator),LX=new Ar(Fe.comparator);function ot(...t){let e=LX;for(const r of t)e=e.add(r);return e}const MX=new Ar(at);function jX(){return MX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Am(e)?"-0":e}}function HR(t){return{integerValue:""+t}}function VX(t,e){return hX(e)?HR(e):Sw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(){this._=void 0}}function BX(t,e,r){return t instanceof wh?function(s,i){const a={fields:{[kR]:{stringValue:AR},[CR]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&vw(i)&&(i=Ep(i)),i&&(a.fields[bR]=i),{mapValue:a}}(r,e):t instanceof _h?GR(t,e):t instanceof Eh?qR(t,e):function(s,i){const a=WR(s,i),o=PS(a)+PS(s.Ae);return L1(a)&&L1(s.Ae)?HR(o):Sw(s.serializer,o)}(t,e)}function UX(t,e,r){return t instanceof _h?GR(t,e):t instanceof Eh?qR(t,e):r}function WR(t,e){return t instanceof Im?function(n){return L1(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class wh extends Ap{}class _h extends Ap{constructor(e){super(),this.elements=e}}function GR(t,e){const r=KR(e);for(const n of t.elements)r.some(s=>Ai(s,n))||r.push(n);return{arrayValue:{values:r}}}class Eh extends Ap{constructor(e){super(),this.elements=e}}function qR(t,e){let r=KR(e);for(const n of t.elements)r=r.filter(s=>!Ai(s,n));return{arrayValue:{values:r}}}class Im extends Ap{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function PS(t){return sr(t.integerValue||t.doubleValue)}function KR(t){return ww(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $X{constructor(e,r){this.field=e,this.transform=r}}function zX(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof _h&&s instanceof _h||n instanceof Eh&&s instanceof Eh?Gc(n.elements,s.elements,Ai):n instanceof Im&&s instanceof Im?Ai(n.Ae,s.Ae):n instanceof wh&&s instanceof wh}(t.transform,e.transform)}class HX{constructor(e,r){this.version=e,this.transformResults=r}}class An{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function A0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kp{}function XR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new bp(t.key,An.none()):new Yh(t.key,t.data,An.none());{const r=t.data,n=On.empty();let s=new Ar(qr.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new yo(t.key,n,new Zn(s.toArray()),An.none())}}function WX(t,e,r){t instanceof Yh?function(s,i,a){const o=s.value.clone(),l=FS(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof yo?function(s,i,a){if(!A0(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=FS(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(YR(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Tf(t,e,r,n){return t instanceof Yh?function(i,a,o,l){if(!A0(i.precondition,a))return o;const c=i.value.clone(),u=OS(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof yo?function(i,a,o,l){if(!A0(i.precondition,a))return o;const c=OS(i.fieldTransforms,l,a),u=a.data;return u.setAll(YR(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return A0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function GX(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=WR(n.transform,s||null);i!=null&&(r===null&&(r=On.empty()),r.set(n.field,i))}return r||null}function DS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Gc(n,s,(i,a)=>zX(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yh extends kp{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yo extends kp{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function YR(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function FS(t,e,r){const n=new Map;xt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,UX(a,o,r[s]))}return n}function OS(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,BX(i,a,e))}return n}class bp extends kp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qX extends kp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KX{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WX(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Tf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Tf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=zR();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=XR(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ge.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ot())}isEqual(e){return this.batchId===e.batchId&&Gc(this.mutations,e.mutations,(r,n)=>DS(r,n))&&Gc(this.baseMutations,e.baseMutations,(r,n)=>DS(r,n))}}class Aw{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){xt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return OX}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new Aw(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XX{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YX{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hr,lt;function QX(t){switch(t){case ge.OK:return Be(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Be(15467,{code:t})}}function QR(t){if(t===void 0)return ta("GRPC error has no .code"),ge.UNKNOWN;switch(t){case hr.OK:return ge.OK;case hr.CANCELLED:return ge.CANCELLED;case hr.UNKNOWN:return ge.UNKNOWN;case hr.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case hr.INTERNAL:return ge.INTERNAL;case hr.UNAVAILABLE:return ge.UNAVAILABLE;case hr.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case hr.NOT_FOUND:return ge.NOT_FOUND;case hr.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case hr.ABORTED:return ge.ABORTED;case hr.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case hr.DATA_LOSS:return ge.DATA_LOSS;default:return Be(39323,{code:t})}}(lt=hr||(hr={}))[lt.OK=0]="OK",lt[lt.CANCELLED=1]="CANCELLED",lt[lt.UNKNOWN=2]="UNKNOWN",lt[lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lt[lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lt[lt.NOT_FOUND=5]="NOT_FOUND",lt[lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",lt[lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",lt[lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",lt[lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lt[lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lt[lt.ABORTED=10]="ABORTED",lt[lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",lt[lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",lt[lt.INTERNAL=13]="INTERNAL",lt[lt.UNAVAILABLE=14]="UNAVAILABLE",lt[lt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZX=new Ha([4294967295,4294967295],0);function LS(t){const e=JX().encode(t),r=new hR;return r.update(e),new Uint8Array(r.digest())}function MS(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ha([r,n],0),new Ha([s,i],0)]}class kw{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Qu(`Invalid padding: ${r}`);if(n<0)throw new Qu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Qu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Qu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ha.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Ha.fromNumber(n)));return s.compare(ZX)===1&&(s=new Ha([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=LS(e),[n,s]=MS(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new kw(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=LS(e),[n,s]=MS(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Qu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Qh.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Cp(Ge.min(),s,new Kt(at),ra(),ot())}}class Qh{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Qh(n,r,ot(),ot(),ot())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class JR{constructor(e,r){this.targetId=e,this.Ce=r}}class ZR{constructor(e,r,n=Qr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class jS{constructor(){this.ve=0,this.Fe=VS(),this.Me=Qr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ot(),r=ot(),n=ot();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Be(38017,{changeType:i})}}),new Qh(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=VS()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,xt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class eY{constructor(e){this.Ge=e,this.ze=new Map,this.je=ra(),this.Je=Zd(),this.He=Zd(),this.Ye=new Kt(at)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Be(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(j1(i))if(n===0){const a=new Fe(i.path);this.et(r,a,un.newNoDocument(a,Ge.min()))}else xt(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=no(n).toUint8Array()}catch(l){if(l instanceof SR)return Wc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new kw(a,s,i)}catch(l){return Wc(l instanceof Qu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const o=this.ot(a);if(o){if(i.current&&j1(o.target)){const l=new Fe(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,un.newNoDocument(l,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=ot();this.He.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new Cp(e,r,this.Ye,this.je,n);return this.je=ra(),this.Je=Zd(),this.He=Zd(),this.Ye=new Kt(at),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new jS,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Ar(at),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Ar(at),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ne("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jS),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Zd(){return new Kt(Fe.comparator)}function VS(){return new Kt(Fe.comparator)}const tY={asc:"ASCENDING",desc:"DESCENDING"},rY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nY={and:"AND",or:"OR"};class sY{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function U1(t,e){return t.useProto3Json||_p(e)?e:{value:e}}function Nm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function iY(t,e){return Nm(t,e.toTimestamp())}function yi(t){return xt(!!t,49232),Ge.fromTimestamp(function(r){const n=ro(r);return new Dt(n.seconds,n.nanos)}(t))}function bw(t,e){return $1(t,e).canonicalString()}function $1(t,e){const r=function(s){return new kt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function tP(t){const e=kt.fromString(t);return xt(aP(e),10190,{key:e.toString()}),e}function z1(t,e){return bw(t.databaseId,e.path)}function Gg(t,e){const r=tP(e);if(r.get(1)!==t.databaseId.projectId)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Fe(nP(r))}function rP(t,e){return bw(t.databaseId,e)}function aY(t){const e=tP(t);return e.length===4?kt.emptyPath():nP(e)}function H1(t){return new kt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nP(t){return xt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function BS(t,e,r){return{name:z1(t,e),fields:r.value.mapValue.fields}}function oY(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Be(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(xt(u===void 0||typeof u=="string",58123),Qr.fromBase64String(u||"")):(xt(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Qr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?ge.UNKNOWN:QR(c.code);return new Ie(u,c.message||"")}(a);r=new ZR(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Gg(t,n.document.name),i=yi(n.document.updateTime),a=n.document.createTime?yi(n.document.createTime):Ge.min(),o=new On({mapValue:{fields:n.document.fields}}),l=un.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new k0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Gg(t,n.document),i=n.readTime?yi(n.readTime):Ge.min(),a=un.newNoDocument(s,i),o=n.removedTargetIds||[];r=new k0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Gg(t,n.document),i=n.removedTargetIds||[];r=new k0([],i,s,null)}else{if(!("filter"in e))return Be(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new YX(s,i),o=n.targetId;r=new JR(o,a)}}return r}function lY(t,e){let r;if(e instanceof Yh)r={update:BS(t,e.key,e.value)};else if(e instanceof bp)r={delete:z1(t,e.key)};else if(e instanceof yo)r={update:BS(t,e.key,e.data),updateMask:xY(e.fieldMask)};else{if(!(e instanceof qX))return Be(16599,{Vt:e.type});r={verify:z1(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof wh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof _h)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Eh)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Im)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Be(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:iY(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Be(27497)}(t,e.precondition)),r}function cY(t,e){return t&&t.length>0?(xt(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?yi(s.updateTime):yi(i);return a.isEqual(Ge.min())&&(a=yi(i)),new HX(a,s.transformResults||[])}(r,e))):[]}function uY(t,e){return{documents:[rP(t,e.path)]}}function fY(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=rP(t,s);const i=function(c){if(c.length!==0)return iP(Js.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:Wl(m.field),direction:mY(m.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=U1(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:s}}function hY(t){let e=aY(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){xt(n===1,65062);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(h){const m=sP(h);return m instanceof Js&&FR(m)?m.getFilters():[m]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(m=>function(x){return new vh(Gl(x.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,_p(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Cm(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new Cm(p,m)}(r.endAt)),NX(e,s,a,i,o,"F",l,c)}function dY(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function sP(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Gl(r.unaryFilter.field);return wr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Gl(r.unaryFilter.field);return wr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gl(r.unaryFilter.field);return wr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Gl(r.unaryFilter.field);return wr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Be(61313);default:return Be(60726)}}(t):t.fieldFilter!==void 0?function(r){return wr.create(Gl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Be(58110);default:return Be(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Js.create(r.compositeFilter.filters.map(n=>sP(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Be(1026)}}(r.compositeFilter.op))}(t):Be(30097,{filter:t})}function mY(t){return tY[t]}function pY(t){return rY[t]}function gY(t){return nY[t]}function Wl(t){return{fieldPath:t.canonicalString()}}function Gl(t){return qr.fromServerFormat(t.fieldPath)}function iP(t){return t instanceof wr?function(r){if(r.op==="=="){if(bS(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NAN"}};if(kS(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(bS(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NOT_NAN"}};if(kS(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wl(r.field),op:pY(r.op),value:r.value}}}(t):t instanceof Js?function(r){const n=r.getFilters().map(s=>iP(s));return n.length===1?n[0]:{compositeFilter:{op:gY(r.op),filters:n}}}(t):Be(54877,{filter:t})}function xY(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function aP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,r,n,s,i=Ge.min(),a=Ge.min(),o=Qr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Da(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yY{constructor(e){this.yt=e}}function vY(t){const e=hY({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?B1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wY{constructor(){this.Cn=new _Y}addToCollectionParentIndex(e,r){return this.Cn.add(r),_e.resolve()}getCollectionParents(e,r){return _e.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return _e.resolve()}deleteFieldIndex(e,r){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,r){return _e.resolve()}getDocumentsMatchingTarget(e,r){return _e.resolve(null)}getIndexType(e,r){return _e.resolve(0)}getFieldIndexes(e,r){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,r){return _e.resolve(to.min())}getMinOffsetFromCollectionGroup(e,r){return _e.resolve(to.min())}updateCollectionGroup(e,r,n){return _e.resolve()}updateIndexEntries(e,r){return _e.resolve()}}class _Y{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Ar(kt.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Ar(kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oP=41943040;class Pn{static withCacheSize(e){return new Pn(e,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pn.DEFAULT_COLLECTION_PERCENTILE=10,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pn.DEFAULT=new Pn(oP,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pn.DISABLED=new Pn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Xc(0)}static cr(){return new Xc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="LruGarbageCollector",EY=1048576;function zS([t,e],[r,n]){const s=at(t,r);return s===0?at(e,n):s}class TY{constructor(e){this.Ir=e,this.buffer=new Ar(zS),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();zS(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class SY{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ne($S,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){hu(r)?Ne($S,"Ignoring IndexedDB error during garbage collection: ",r):await fu(r)}await this.Vr(3e5)})}}class AY{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return _e.resolve(wp.ce);const n=new TY(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ne("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(US)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),US):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,o,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,a=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),zl()<=it.DEBUG&&Ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function kY(t,e){return new AY(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bY{constructor(){this.changes=new bl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?_e.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CY{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IY{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Tf(n.mutation,s,Zn.empty(),Dt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ot()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ot()){const s=Lo();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Yu();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Lo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ot()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=ra();const a=Ef(),o=function(){return Ef()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof yo)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),Tf(u.mutation,c,u.mutation.getFieldMask(),Dt.now())):a.set(c.key,Zn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>o.set(c,new CY(u,a.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Ef();let s=new Kt((a,o)=>a-o),i=ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Zn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(s.get(o.batchId)||ot()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=zR();u.forEach(m=>{if(!i.has(m)){const p=XR(r.get(m),n.get(m));p!==null&&h.set(m,p),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return _e.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):jR(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):_e.resolve(Lo());let o=ph,l=i;return a.next(c=>_e.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(u)?_e.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,ot())).next(u=>({batchId:o,changes:$R(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Fe(r)).next(n=>{let s=Yu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Yu();return this.indexManager.getCollectionParents(e,i).next(o=>_e.forEach(o,l=>{const c=function(h,m){return new du(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((h,m)=>{a=a.insert(h,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,un.newInvalidDocument(u)))});let o=Yu();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Tf(u.mutation,c,Zn.empty(),Dt.now()),Sp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NY{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return _e.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:yi(s.createTime)}}(r)),_e.resolve()}getNamedQuery(e,r){return _e.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:vY(s.bundledQuery),readTime:yi(s.readTime)}}(r)),_e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(){this.overlays=new Kt(Fe.comparator),this.qr=new Map}getOverlay(e,r){return _e.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Lo();return _e.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),_e.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),_e.resolve()}getOverlaysForCollection(e,r,n){const s=Lo(),i=r.length+1,a=new Fe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return _e.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Kt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Lo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Lo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return _e.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new XX(r,n));let i=this.qr.get(r);i===void 0&&(i=ot(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PY{constructor(){this.sessionToken=Qr.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,_e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(){this.Qr=new Ar(Nr.$r),this.Ur=new Ar(Nr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Nr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Nr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Fe(new kt([])),n=new Nr(r,e),s=new Nr(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Fe(new kt([])),n=new Nr(r,e),s=new Nr(r,e+1);let i=ot();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new Nr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Nr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Fe.comparator(e.key,r.key)||at(e.Yr,r.Yr)}static Kr(e,r){return at(e.Yr,r.Yr)||Fe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Ar(Nr.$r)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new KX(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new Nr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return _e.resolve(a)}lookupMutationBatch(e,r){return _e.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return _e.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?yw:this.tr-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Nr(r,0),s=new Nr(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const o=this.Xr(a.Yr);i.push(o)}),_e.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ar(at);return r.forEach(s=>{const i=new Nr(s,0),a=new Nr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],o=>{n=n.add(o.Yr)})}),_e.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Fe.isDocumentKey(i)||(i=i.child(""));const a=new Nr(new Fe(i),0);let o=new Ar(at);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)},a),_e.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){xt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return _e.forEach(r.mutations,s=>{const i=new Nr(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Nr(r,0),s=this.Zr.firstAfterOrEqual(n);return _e.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FY{constructor(e){this.ri=e,this.docs=function(){return new Kt(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return _e.resolve(n?n.document.mutableCopy():un.newInvalidDocument(r))}getEntries(e,r){let n=ra();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():un.newInvalidDocument(s))}),_e.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=ra();const a=r.path,o=new Fe(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||lX(oX(u),n)<=0||(s.has(u.key)||Sp(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return _e.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Be(9500)}ii(e,r){return _e.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new OY(this)}getSize(e){return _e.resolve(this.size)}}class OY extends bY{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),_e.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LY{constructor(e){this.persistence=e,this.si=new bl(r=>_w(r),Ew),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.oi=0,this._i=new Cw,this.targetCount=0,this.ai=Xc.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),_e.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Xc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,_e.resolve()}updateTargetData(e,r){return this.Pr(r),_e.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),_e.waitFor(i).next(()=>s)}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return _e.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),_e.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),_e.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),_e.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return _e.resolve(n)}containsKey(e,r){return _e.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,r){this.ui={},this.overlays={},this.ci=new wp(0),this.li=!1,this.li=!0,this.hi=new PY,this.referenceDelegate=e(this),this.Pi=new LY(this),this.indexManager=new wY,this.remoteDocumentCache=function(s){return new FY(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new yY(r),this.Ii=new NY(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new RY,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new DY(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ne("MemoryPersistence","Starting transaction:",e);const s=new MY(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return _e.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class MY extends uX{constructor(e){super(),this.currentSequenceNumber=e}}class Iw{constructor(e){this.persistence=e,this.Ri=new Cw,this.Vi=null}static mi(e){return new Iw(e)}get fi(){if(this.Vi)return this.Vi;throw Be(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),_e.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),_e.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),_e.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.fi,n=>{const s=Fe.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,Ge.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return _e.or([()=>_e.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Rm{constructor(e,r){this.persistence=e,this.pi=new bl(n=>dX(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=kY(this,r)}static mi(e,r){return new Rm(e,r)}Ei(){}di(e){return _e.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return _e.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?_e.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,i.removeEntry(a,Ge.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),_e.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),_e.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),_e.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=T0(e.data.value)),r}br(e,r,n){return _e.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return _e.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=ot(),s=ot();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Nw(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jY{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VY{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return uW()?8:fX(gn())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new jY;return this.Ss(e,r,a).next(o=>{if(i.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(zl()<=it.DEBUG&&Ne("QueryEngine","SDK will not create cache indexes for query:",Hl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),_e.resolve()):(zl()<=it.DEBUG&&Ne("QueryEngine","Query:",Hl(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(zl()<=it.DEBUG&&Ne("QueryEngine","The SDK decides to create cache indexes for query:",Hl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xi(r))):_e.resolve())}ys(e,r){if(RS(r))return _e.resolve(null);let n=xi(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=B1(r,null,"F"),n=xi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=ot(...i);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,a,l.readTime)?this.ys(e,B1(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,s){return RS(r)||s.isEqual(Ge.min())?_e.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?_e.resolve(null):(zl()<=it.DEBUG&&Ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hl(r)),this.vs(e,a,r,aX(s,ph)).next(o=>o))})}Ds(e,r){let n=new Ar(BR(e));return r.forEach((s,i)=>{Sp(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return zl()<=it.DEBUG&&Ne("QueryEngine","Using full collection scan to execute query:",Hl(r)),this.ps.getDocumentsMatchingQuery(e,r,to.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="LocalStore",BY=3e8;class UY{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Kt(at),this.xs=new bl(i=>_w(i),Ew),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IY(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function $Y(t,e,r,n){return new UY(t,e,r,n)}async function cP(t,e){const r=Ke(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=ot();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:a,addedBatchIds:o}))})})}function zY(t,e){const r=Ke(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,m=h.keys();let p=_e.resolve();return m.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(g=>{const v=c.docVersions.get(x);xt(v!==null,48541),g.version.compareTo(v)<0&&(h.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=ot();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function uP(t){const e=Ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function HY(t,e){const r=Ke(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const m=s.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(i,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(i,u.addedDocuments,h)));let p=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Qr.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(h,p),function(g,v,_){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=BY?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,u)&&o.push(r.Pi.updateTargetData(i,p))});let l=ra(),c=ot();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(WY(i,a,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!n.isEqual(Ge.min())){const u=r.Pi.getLastRemoteSnapshotVersion(i).next(h=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return _e.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.Ms=s,i))}function WY(t,e,r){let n=ot(),s=ot();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=ra();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ge.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ne(Rw,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:a,qs:s}})}function GY(t,e){const r=Ke(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=yw),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function qY(t,e){const r=Ke(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,_e.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new Da(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function W1(t,e,r){const n=Ke(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!hu(a))throw a;Ne(Rw,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function HS(t,e,r){const n=Ke(t);let s=Ge.min(),i=ot();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const h=Ke(l),m=h.xs.get(u);return m!==void 0?_e.resolve(h.Ms.get(m)):h.Pi.getTargetData(c,u)}(n,a,xi(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:Ge.min(),r?i:ot())).next(o=>(KY(n,PX(e),o),{documents:o,Qs:i})))}function KY(t,e,r){let n=t.Os.get(e)||Ge.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class WS{constructor(){this.activeTargetIds=jX()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XY{constructor(){this.Mo=new WS,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new WS,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="ConnectivityMonitor";class qS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ne(GS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ne(GS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e0=null;function G1(){return e0===null?e0=function(){return 268435456+Math.round(2147483648*Math.random())}():e0++,"0x"+e0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg="RestConnection",QY={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JY{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===km?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=G1(),o=this.zo(e,r.toUriEncodedString());Ne(qg,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(o),u=ou(c);return this.Jo(e,o,l,n,u).then(h=>(Ne(qg,`Received RPC '${e}' ${a}: `,h),h),h=>{throw Wc(qg,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+uu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=QY[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZY{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class eQ extends JY{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=G1();return new Promise((o,l)=>{const c=new dR;c.setWithCredentials(!0),c.listenOnce(mR.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case E0.NO_ERROR:const h=c.getResponseJson();Ne(nn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case E0.TIMEOUT:Ne(nn,`RPC '${e}' ${a} timed out`),l(new Ie(ge.DEADLINE_EXCEEDED,"Request time out"));break;case E0.HTTP_ERROR:const m=c.getStatus();if(Ne(nn,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const x=p==null?void 0:p.error;if(x&&x.status&&x.message){const g=function(_){const w=_.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(w)>=0?w:ge.UNKNOWN}(x.status);l(new Ie(g,x.message))}else l(new Ie(ge.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ie(ge.UNAVAILABLE,"Connection failed."));break;default:Be(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Ne(nn,`RPC '${e}' ${a} completed.`)}});const u=JSON.stringify(s);Ne(nn,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",u,n,15)})}T_(e,r,n){const s=G1(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=xR(),o=gR(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");Ne(nn,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=a.createWebChannel(u,l);this.I_(h);let m=!1,p=!1;const x=new ZY({Yo:v=>{p?Ne(nn,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(m||(Ne(nn,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),Ne(nn,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Zo:()=>h.close()}),g=(v,_,w)=>{v.listen(_,y=>{try{w(y)}catch(I){setTimeout(()=>{throw I},0)}})};return g(h,Xu.EventType.OPEN,()=>{p||(Ne(nn,`RPC '${e}' stream ${s} transport opened.`),x.o_())}),g(h,Xu.EventType.CLOSE,()=>{p||(p=!0,Ne(nn,`RPC '${e}' stream ${s} transport closed`),x.a_(),this.E_(h))}),g(h,Xu.EventType.ERROR,v=>{p||(p=!0,Wc(nn,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),x.a_(new Ie(ge.UNAVAILABLE,"The operation could not be completed")))}),g(h,Xu.EventType.MESSAGE,v=>{var _;if(!p){const w=v.data[0];xt(!!w,16349);const y=w,I=(y==null?void 0:y.error)||((_=y[0])==null?void 0:_.error);if(I){Ne(nn,`RPC '${e}' stream ${s} received error:`,I);const O=I.status;let P=function(A){const N=hr[A];if(N!==void 0)return QR(N)}(O),S=I.message;P===void 0&&(P=ge.INTERNAL,S="Unknown error status: "+O+" with message "+I.message),p=!0,x.a_(new Ie(P,S)),h.close()}else Ne(nn,`RPC '${e}' stream ${s} received:`,w),x.u_(w)}}),g(o,pR.STAT_EVENT,v=>{v.stat===D1.PROXY?Ne(nn,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===D1.NOPROXY&&Ne(nn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Kg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(t){return new sY(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="PersistentStream";class hP{constructor(e,r,n,s,i,a,o,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new fP(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ge.RESOURCE_EXHAUSTED?(ta(r.toString()),ta("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Ie(ge.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ne(KS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ne(KS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tQ extends hP{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=oY(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ge.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ge.min():a.readTime?yi(a.readTime):Ge.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=H1(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=j1(l)?{documents:uY(i,l)}:{query:fY(i,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=eP(i,a.resumeToken);const c=U1(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ge.min())>0){o.readTime=Nm(i,a.snapshotVersion.toTimestamp());const c=U1(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=dY(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=H1(this.serializer),r.removeTarget=e,this.q_(r)}}class rQ extends hP{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=cY(e.writeResults,e.commitTime),n=yi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=H1(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>lY(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nQ{}class sQ extends nQ{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,$1(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ie(ge.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,$1(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(ge.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class iQ{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ta(r),this.aa=!1):Ne("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="RemoteStore";class aQ{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Cl(this)&&(Ne(fl,"Restarting streams for network reachability change."),await async function(l){const c=Ke(l);c.Ea.add(4),await Jh(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Np(c)}(this))})}),this.Ra=new iQ(n,s)}}async function Np(t){if(Cl(t))for(const e of t.da)await e(!0)}async function Jh(t){for(const e of t.da)await e(!1)}function dP(t,e){const r=Ke(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Ow(r)?Fw(r):mu(r).O_()&&Dw(r,e))}function Pw(t,e){const r=Ke(t),n=mu(r);r.Ia.delete(e),n.O_()&&mP(r,e),r.Ia.size===0&&(n.O_()?n.L_():Cl(r)&&r.Ra.set("Unknown"))}function Dw(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}mu(t).Y_(e)}function mP(t,e){t.Va.Ue(e),mu(t).Z_(e)}function Fw(t){t.Va=new eY({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),mu(t).start(),t.Ra.ua()}function Ow(t){return Cl(t)&&!mu(t).x_()&&t.Ia.size>0}function Cl(t){return Ke(t).Ea.size===0}function pP(t){t.Va=void 0}async function oQ(t){t.Ra.set("Online")}async function lQ(t){t.Ia.forEach((e,r)=>{Dw(t,e)})}async function cQ(t,e){pP(t),Ow(t)?(t.Ra.ha(e),Fw(t)):t.Ra.set("Unknown")}async function uQ(t,e,r){if(t.Ra.set("Online"),e instanceof ZR&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Ne(fl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Pm(t,n)}else if(e instanceof k0?t.Va.Ze(e):e instanceof JR?t.Va.st(e):t.Va.tt(e),!r.isEqual(Ge.min()))try{const n=await uP(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Qr.EMPTY_BYTE_STRING,u.snapshotVersion)),mP(i,l);const h=new Da(u.target,l,c,u.sequenceNumber);Dw(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ne(fl,"Failed to raise snapshot:",n),await Pm(t,n)}}async function Pm(t,e,r){if(!hu(e))throw e;t.Ea.add(1),await Jh(t),t.Ra.set("Offline"),r||(r=()=>uP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ne(fl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Np(t)})}function gP(t,e){return e().catch(r=>Pm(t,r,e))}async function Rp(t){const e=Ke(t),r=io(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:yw;for(;fQ(e);)try{const s=await GY(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,hQ(e,s)}catch(s){await Pm(e,s)}xP(e)&&yP(e)}function fQ(t){return Cl(t)&&t.Ta.length<10}function hQ(t,e){t.Ta.push(e);const r=io(t);r.O_()&&r.X_&&r.ea(e.mutations)}function xP(t){return Cl(t)&&!io(t).x_()&&t.Ta.length>0}function yP(t){io(t).start()}async function dQ(t){io(t).ra()}async function mQ(t){const e=io(t);for(const r of t.Ta)e.ea(r.mutations)}async function pQ(t,e,r){const n=t.Ta.shift(),s=Aw.from(n,e,r);await gP(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rp(t)}async function gQ(t,e){e&&io(t).X_&&await async function(n,s){if(function(a){return QX(a)&&a!==ge.ABORTED}(s.code)){const i=n.Ta.shift();io(n).B_(),await gP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rp(n)}}(t,e),xP(t)&&yP(t)}async function XS(t,e){const r=Ke(t);r.asyncQueue.verifyOperationInProgress(),Ne(fl,"RemoteStore received new credentials");const n=Cl(r);r.Ea.add(3),await Jh(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Np(r)}async function xQ(t,e){const r=Ke(t);e?(r.Ea.delete(2),await Np(r)):e||(r.Ea.add(2),await Jh(r),r.Ra.set("Unknown"))}function mu(t){return t.ma||(t.ma=function(r,n,s){const i=Ke(r);return i.sa(),new tQ(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:oQ.bind(null,t),t_:lQ.bind(null,t),r_:cQ.bind(null,t),H_:uQ.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Ow(t)?Fw(t):t.Ra.set("Unknown")):(await t.ma.stop(),pP(t))})),t.ma}function io(t){return t.fa||(t.fa=function(r,n,s){const i=Ke(r);return i.sa(),new rQ(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:dQ.bind(null,t),r_:gQ.bind(null,t),ta:mQ.bind(null,t),na:pQ.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Rp(t)):(await t.fa.stop(),t.Ta.length>0&&(Ne(fl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new qi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new Lw(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mw(t,e){if(ta("AsyncQueue",`${e}: ${t}`),hu(t))return new Ie(ge.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{static emptySet(e){return new Cc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=Yu(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Cc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Cc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(){this.ga=new Kt(Fe.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Be(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Yc{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Yc(e,r,Cc.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class vQ{constructor(){this.queries=QS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Ke(r),i=s.queries;s.queries=QS(),i.forEach((a,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new Ie(ge.ABORTED,"Firestore shutting down"))}}function QS(){return new bl(t=>VR(t),Tp)}async function vP(t,e){const r=Ke(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new yQ,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=Mw(a,`Initialization of query '${Hl(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&jw(r)}async function wP(t,e){const r=Ke(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function wQ(t,e){const r=Ke(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&jw(r)}function _Q(t,e,r){const n=Ke(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function jw(t){t.Ca.forEach(e=>{e.next()})}var q1,JS;(JS=q1||(q1={})).Ma="default",JS.Cache="cache";class _P{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Yc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Yc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==q1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.key=e}}class TP{constructor(e){this.key=e}}class EQ{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ot(),this.mutatedKeys=ot(),this.eu=BR(e),this.tu=new Cc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new YS,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const m=s.get(u),p=Sp(this.query,h)?h:null,x=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;m&&p?m.data.isEqual(p.data)?x!==g&&(n.track({type:3,doc:p}),v=!0):this.su(m,p)||(n.track({type:2,doc:p}),v=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),v=!0):m&&!p&&(n.track({type:1,doc:m}),v=!0,(l||c)&&(o=!0)),v&&(p?(a=a.add(p),i=g?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((u,h)=>function(p,x){const g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be(20277,{Rt:v})}};return g(p)-g(x)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new Yc(this.query,e.tu,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new YS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ot(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new TP(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new EP(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=ot();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Yc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Vw="SyncEngine";class TQ{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class SQ{constructor(e){this.key=e,this.hu=!1}}class AQ{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new bl(o=>VR(o),Tp),this.Iu=new Map,this.Eu=new Set,this.du=new Kt(Fe.comparator),this.Au=new Map,this.Ru=new Cw,this.Vu={},this.mu=new Map,this.fu=Xc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function kQ(t,e,r=!0){const n=IP(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await SP(n,e,r,!0),s}async function bQ(t,e){const r=IP(t);await SP(r,e,!0,!1)}async function SP(t,e,r,n){const s=await qY(t.localStore,xi(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await CQ(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&dP(t.remoteStore,s),o}async function CQ(t,e,r,n,s){t.pu=(h,m,p)=>async function(g,v,_,w){let y=v.view.ru(_);y.Cs&&(y=await HS(g.localStore,v.query,!1).then(({documents:S})=>v.view.ru(S,y)));const I=w&&w.targetChanges.get(v.targetId),O=w&&w.targetMismatches.get(v.targetId)!=null,P=v.view.applyChanges(y,g.isPrimaryClient,I,O);return eA(g,v.targetId,P.au),P.snapshot}(t,h,m,p);const i=await HS(t.localStore,e,!0),a=new EQ(e,i.Qs),o=a.ru(i.documents),l=Qh.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);eA(t,r,c.au);const u=new TQ(e,r,a);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function IQ(t,e,r){const n=Ke(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!Tp(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await W1(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Pw(n.remoteStore,s.targetId),K1(n,s.targetId)}).catch(fu)):(K1(n,s.targetId),await W1(n.localStore,s.targetId,!0))}async function NQ(t,e){const r=Ke(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Pw(r.remoteStore,n.targetId))}async function RQ(t,e,r){const n=jQ(t);try{const s=await function(a,o){const l=Ke(a),c=Dt.now(),u=o.reduce((p,x)=>p.add(x.key),ot());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ra(),g=ot();return l.Ns.getEntries(p,u).next(v=>{x=v,x.forEach((_,w)=>{w.isValidDocument()||(g=g.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(v=>{h=v;const _=[];for(const w of o){const y=GX(w,h.get(w.key).overlayedDocument);y!=null&&_.push(new yo(w.key,y,RR(y.value.mapValue),An.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,_,o)}).next(v=>{m=v;const _=v.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(p,v.batchId,_)})}).then(()=>({batchId:m.batchId,changes:$R(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Kt(at)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c}(n,s.batchId,r),await Zh(n,s.changes),await Rp(n.remoteStore)}catch(s){const i=Mw(s,"Failed to persist write");r.reject(i)}}async function AP(t,e){const r=Ke(t);try{const n=await HY(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(xt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?xt(a.hu,14607):s.removedDocuments.size>0&&(xt(a.hu,42227),a.hu=!1))}),await Zh(r,n,e)}catch(n){await fu(n)}}function ZS(t,e,r){const n=Ke(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Ke(a);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(o)&&(c=!0)}),c&&jw(l)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function PQ(t,e,r){const n=Ke(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new Kt(Fe.comparator);a=a.insert(i,un.newNoDocument(i,Ge.min()));const o=ot().add(i),l=new Cp(Ge.min(),new Map,new Kt(at),a,o);await AP(n,l),n.du=n.du.remove(i),n.Au.delete(e),Bw(n)}else await W1(n.localStore,e,!1).then(()=>K1(n,e,r)).catch(fu)}async function DQ(t,e){const r=Ke(t),n=e.batch.batchId;try{const s=await zY(r.localStore,e);bP(r,n,null),kP(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Zh(r,s)}catch(s){await fu(s)}}async function FQ(t,e,r){const n=Ke(t);try{const s=await function(a,o){const l=Ke(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(xt(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);bP(n,e,r),kP(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Zh(n,s)}catch(s){await fu(s)}}function kP(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function bP(t,e,r){const n=Ke(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function K1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||CP(t,n)})}function CP(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Pw(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Bw(t))}function eA(t,e,r){for(const n of r)n instanceof EP?(t.Ru.addReference(n.key,e),OQ(t,n)):n instanceof TP?(Ne(Vw,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||CP(t,n.key)):Be(19791,{wu:n})}function OQ(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ne(Vw,"New document in limbo: "+r),t.Eu.add(n),Bw(t))}function Bw(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Fe(kt.fromString(e)),n=t.fu.next();t.Au.set(n,new SQ(r)),t.du=t.du.insert(r,n),dP(t.remoteStore,new Da(xi(Tw(r.path)),n,"TargetPurposeLimboResolution",wp.ce))}}async function Zh(t,e,r){const n=Ke(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{a.push(n.pu(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=Nw.As(l.targetId,c);i.push(h)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(l,c){const u=Ke(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>_e.forEach(c,m=>_e.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>_e.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!hu(h))throw h;Ne(Rw,"Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),x=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(x);u.Ms=u.Ms.insert(m,g)}}}(n.localStore,i))}async function LQ(t,e){const r=Ke(t);if(!r.currentUser.isEqual(e)){Ne(Vw,"User change. New user:",e.toKey());const n=await cP(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(o=>{o.forEach(l=>{l.reject(new Ie(ge.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Zh(r,n.Ls)}}function MQ(t,e){const r=Ke(t),n=r.Au.get(e);if(n&&n.hu)return ot().add(n.key);{let s=ot();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const o=r.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function IP(t){const e=Ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=AP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PQ.bind(null,e),e.Pu.H_=wQ.bind(null,e.eventManager),e.Pu.yu=_Q.bind(null,e.eventManager),e}function jQ(t){const e=Ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FQ.bind(null,e),e}class Dm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ip(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return $Y(this.persistence,new VY,e.initialUser,this.serializer)}Cu(e){return new lP(Iw.mi,this.serializer)}Du(e){return new XY}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dm.provider={build:()=>new Dm};class VQ extends Dm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){xt(this.persistence.referenceDelegate instanceof Rm,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new SY(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Pn.withCacheSize(this.cacheSizeBytes):Pn.DEFAULT;return new lP(n=>Rm.mi(n,r),this.serializer)}}class X1{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ZS(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=LQ.bind(null,this.syncEngine),await xQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vQ}()}createDatastore(e){const r=Ip(e.databaseInfo.databaseId),n=function(i){return new eQ(i)}(e.databaseInfo);return function(i,a,o,l){return new sQ(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new aQ(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>ZS(this.syncEngine,r,0),function(){return qS.v()?new qS:new YY}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const h=new AQ(s,i,a,o,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ke(s);Ne(fl,"RemoteStore shutting down."),i.Ea.add(5),await Jh(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}X1.provider={build:()=>new X1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ta("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao="FirestoreClient";class BQ{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=an.UNAUTHENTICATED,this.clientId=xw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Ne(ao,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ne(ao,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Mw(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xg(t,e){t.asyncQueue.verifyOperationInProgress(),Ne(ao,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await cP(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function tA(t,e){t.asyncQueue.verifyOperationInProgress();const r=await UQ(t);Ne(ao,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>XS(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>XS(e.remoteStore,s)),t._onlineComponents=e}async function UQ(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ne(ao,"Using user provided OfflineComponentProvider");try{await Xg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ge.FAILED_PRECONDITION||s.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Wc("Error using user provided cache. Falling back to memory cache: "+r),await Xg(t,new Dm)}}else Ne(ao,"Using default OfflineComponentProvider"),await Xg(t,new VQ(void 0));return t._offlineComponents}async function RP(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ne(ao,"Using user provided OnlineComponentProvider"),await tA(t,t._uninitializedComponentsProvider._online)):(Ne(ao,"Using default OnlineComponentProvider"),await tA(t,new X1))),t._onlineComponents}function $Q(t){return RP(t).then(e=>e.syncEngine)}async function PP(t){const e=await RP(t),r=e.eventManager;return r.onListen=kQ.bind(null,e.syncEngine),r.onUnlisten=IQ.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=bQ.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=NQ.bind(null,e.syncEngine),r}function zQ(t,e,r={}){const n=new qi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new NP({next:m=>{u.Nu(),a.enqueueAndForget(()=>wP(i,h));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new Ie(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new Ie(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new _P(Tw(o.path),u,{includeMetadataChanges:!0,qa:!0});return vP(i,h)}(await PP(t),t.asyncQueue,e,r,n)),n.promise}function HQ(t,e,r={}){const n=new qi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new NP({next:m=>{u.Nu(),a.enqueueAndForget(()=>wP(i,h)),m.fromCache&&l.source==="server"?c.reject(new Ie(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new _P(o,u,{includeMetadataChanges:!0,qa:!0});return vP(i,h)}(await PP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP="firestore.googleapis.com",nA=!0;class sA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=FP,this.ssl=nA}else this.host=e.host,this.ssl=e.ssl??nA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=oP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<EY)throw new Ie(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iX("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DP(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pp{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new XK;switch(n.type){case"firstParty":return new ZK(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ie(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=rA.get(r);n&&(Ne("ComponentProvider","Removing Datastore"),rA.delete(r),n.terminate())}(this),Promise.resolve()}}function WQ(t,e,r,n={}){var c;t=Is(t,Pp);const s=ou(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(_N(`https://${o}`),EN("Firestore",!0)),i.host!==FP&&i.host!==o&&Wc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:s,emulatorOptions:n};if(!eo(l,a)&&(t._setSettings(l),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=an.MOCK_USER;else{u=rW(n.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new Ie(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new an(m)}t._authCredentials=new YK(new vR(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Il(this.firestore,e,this._query)}}class or{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new or(this.firestore,e,this._key)}toJSON(){return{type:or._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Xh(r,or._jsonSchema))return new or(e,n||null,new Fe(kt.fromString(r.referencePath)))}}or._jsonSchemaVersion="firestore/documentReference/1.0",or._jsonSchema={type:_r("string",or._jsonSchemaVersion),referencePath:_r("string")};class Wa extends Il{constructor(e,r,n){super(e,r,Tw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new or(this.firestore,null,new Fe(e))}withConverter(e){return new Wa(this.firestore,e,this._path)}}function Pt(t,e,...r){if(t=qt(t),wR("collection","path",e),t instanceof Pp){const n=kt.fromString(e,...r);return xS(n),new Wa(t,null,n)}{if(!(t instanceof or||t instanceof Wa))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(kt.fromString(e,...r));return xS(n),new Wa(t.firestore,null,n)}}function ar(t,e,...r){if(t=qt(t),arguments.length===1&&(e=xw.newId()),wR("doc","path",e),t instanceof Pp){const n=kt.fromString(e,...r);return gS(n),new or(t,null,new Fe(n))}{if(!(t instanceof or||t instanceof Wa))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(kt.fromString(e,...r));return gS(n),new or(t.firestore,t instanceof Wa?t.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="AsyncQueue";class aA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new fP(this,"async_queue_retry"),this._c=()=>{const n=Kg();n&&Ne(iA,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Kg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Kg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new qi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hu(e))throw e;Ne(iA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,ta("INTERNAL UNHANDLED ERROR: ",oA(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Lw.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Be(47125,{Pc:oA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function oA(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class vo extends Pp{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new aA,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aA(e),this._firestoreClient=void 0,await e}}}function GQ(t,e){const r=typeof t=="object"?t:ow(),n=typeof t=="string"?t:km,s=Al(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=eW("firestore");i&&WQ(s,...i)}return s}function Dp(t){if(t._terminated)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qQ(t),t._firestoreClient}function qQ(t){var n,s,i;const e=t._freezeSettings(),r=function(o,l,c,u){return new gX(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,DP(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new BQ(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xs(Qr.fromBase64String(e))}catch(r){throw new Ie(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new xs(Qr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xh(e,xs._jsonSchema))return xs.fromBase64String(e.bytes)}}xs._jsonSchemaVersion="firestore/bytes/1.0",xs._jsonSchema={type:_r("string",xs._jsonSchemaVersion),bytes:_r("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ie(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ie(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ie(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vi._jsonSchemaVersion}}static fromJSON(e){if(Xh(e,vi._jsonSchema))return new vi(e.latitude,e.longitude)}}vi._jsonSchemaVersion="firestore/geoPoint/1.0",vi._jsonSchema={type:_r("string",vi._jsonSchemaVersion),latitude:_r("number"),longitude:_r("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:wi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xh(e,wi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new wi(e.vectorValues);throw new Ie(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wi._jsonSchemaVersion="firestore/vectorValue/1.0",wi._jsonSchema={type:_r("string",wi._jsonSchemaVersion),vectorValues:_r("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KQ=/^__.*__$/;class XQ{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Yh(e,this.data,r,this.fieldTransforms)}}class OP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new yo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function LP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be(40011,{Ac:t})}}class Uw{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Uw({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(LP(this.Ac)&&KQ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class YQ{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ip(e)}Cc(e,r,n,s=!1){return new Uw({Ac:e,methodName:r,Dc:n,path:qr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function td(t){const e=t._freezeSettings(),r=Ip(t._databaseId);return new YQ(t._databaseId,!!e.ignoreUndefinedProperties,r)}function $w(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);Hw("Data must be an object, but it was:",a,n);const o=VP(n,a);let l,c;if(i.merge)l=new Zn(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const m=Y1(e,h,r);if(!a.contains(m))throw new Ie(ge.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);UP(u,m)||u.push(m)}l=new Zn(u),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new XQ(new On(o),l,c)}class Op extends Fp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Op}}class zw extends Fp{_toFieldTransform(e){return new $X(e.path,new wh)}isEqual(e){return e instanceof zw}}function MP(t,e,r,n){const s=t.Cc(1,e,r);Hw("Data must be an object, but it was:",s,n);const i=[],a=On.empty();xo(n,(l,c)=>{const u=Ww(e,l,r);c=qt(c);const h=s.yc(u);if(c instanceof Op)i.push(u);else{const m=rd(c,h);m!=null&&(i.push(u),a.set(u,m))}});const o=new Zn(i);return new OP(a,o,s.fieldTransforms)}function jP(t,e,r,n,s,i){const a=t.Cc(1,e,r),o=[Y1(e,n,r)],l=[s];if(i.length%2!=0)throw new Ie(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)o.push(Y1(e,i[m])),l.push(i[m+1]);const c=[],u=On.empty();for(let m=o.length-1;m>=0;--m)if(!UP(c,o[m])){const p=o[m];let x=l[m];x=qt(x);const g=a.yc(p);if(x instanceof Op)c.push(p);else{const v=rd(x,g);v!=null&&(c.push(p),u.set(p,v))}}const h=new Zn(c);return new OP(u,h,a.fieldTransforms)}function QQ(t,e,r,n=!1){return rd(r,t.Cc(n?4:3,e))}function rd(t,e){if(BP(t=qt(t)))return Hw("Unsupported field value:",e,t),VP(t,e);if(t instanceof Fp)return function(n,s){if(!LP(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=rd(o,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=qt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return VX(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Dt.fromDate(n);return{timestampValue:Nm(s.serializer,i)}}if(n instanceof Dt){const i=new Dt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Nm(s.serializer,i)}}if(n instanceof vi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xs)return{bytesValue:eP(s.serializer,n._byteString)};if(n instanceof or){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bw(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof wi)return function(a,o){return{mapValue:{fields:{[IR]:{stringValue:NR},[bm]:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return Sw(o.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${vp(n)}`)}(t,e)}function VP(t,e){const r={};return TR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xo(t,(n,s)=>{const i=rd(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function BP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Dt||t instanceof vi||t instanceof xs||t instanceof or||t instanceof Fp||t instanceof wi)}function Hw(t,e,r){if(!BP(r)||!_R(r)){const n=vp(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Y1(t,e,r){if((e=qt(e))instanceof ed)return e._internalPath;if(typeof e=="string")return Ww(t,e);throw Fm("Field path arguments must be of type string or ",t,!1,void 0,r)}const JQ=new RegExp("[~\\*/\\[\\]]");function Ww(t,e,r){if(e.search(JQ)>=0)throw Fm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ed(...e.split("."))._internalPath}catch{throw Fm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Fm(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new Ie(ge.INVALID_ARGUMENT,o+t+l)}function UP(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new or(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Lp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class ZQ extends $P{data(){return super.data()}}function Lp(t,e){return typeof e=="string"?Ww(t,e):e instanceof ed?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eJ(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ie(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gw{}class zP extends Gw{}function gr(t,e,...r){let n=[];e instanceof Gw&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof qw).length,o=i.filter(l=>l instanceof Mp).length;if(a>1||a>0&&o>0)throw new Ie(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Mp extends zP{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Mp(e,r,n)}_apply(e){const r=this._parse(e);return HP(e._query,r),new Il(e.firestore,e.converter,V1(e._query,r))}_parse(e){const r=td(e.firestore);return function(i,a,o,l,c,u,h){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){cA(h,u);const x=[];for(const g of h)x.push(lA(l,i,g));m={arrayValue:{values:x}}}else m=lA(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||cA(h,u),m=QQ(o,a,h,u==="in"||u==="not-in");return wr.create(c,u,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function pr(t,e,r){const n=e,s=Lp("where",t);return Mp._create(s,n,r)}class qw extends Gw{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new qw(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Js.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)HP(a,l),a=V1(a,l)}(e._query,r),new Il(e.firestore,e.converter,V1(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kw extends zP{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Kw(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new vh(i,a)}(e._query,this._field,this._direction);return new Il(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new du(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function qo(t,e="asc"){const r=e,n=Lp("orderBy",t);return Kw._create(n,r)}function lA(t,e,r){if(typeof(r=qt(r))=="string"){if(r==="")throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jR(e)&&r.indexOf("/")!==-1)throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(kt.fromString(r));if(!Fe.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return AS(t,new Fe(n))}if(r instanceof or)return AS(t,r._key);throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vp(r)}.`)}function cA(t,e){if(!Array.isArray(t)||t.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function HP(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class tJ{convertValue(e,r="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Be(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return xo(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[bm].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>sr(a.doubleValue));return new wi(r)}convertGeoPoint(e){return new vi(sr(e.latitude),sr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ep(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(gh(e));default:return null}}convertTimestamp(e){const r=ro(e);return new Dt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=kt.fromString(e);xt(aP(n),9688,{name:e});const s=new xh(n.get(1),n.get(3)),i=new Fe(n.popFirst(5));return s.isEqual(r)||ta(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Ju{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ko extends $P{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new b0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Lp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Ko._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ko._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ko._jsonSchema={type:_r("string",Ko._jsonSchemaVersion),bundleSource:_r("string","DocumentSnapshot"),bundleName:_r("string"),bundle:_r("string")};class b0 extends Ko{data(e={}){return super.data(e)}}class Ic{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Ju(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new b0(this._firestore,this._userDataWriter,n.key,n,new Ju(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ie(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new b0(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ju(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new b0(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ju(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:rJ(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ic._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rJ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(t){t=Is(t,or);const e=Is(t.firestore,vo);return zQ(Dp(e),t._key).then(r=>nJ(e,t,r))}Ic._jsonSchemaVersion="firestore/querySnapshot/1.0",Ic._jsonSchema={type:_r("string",Ic._jsonSchemaVersion),bundleSource:_r("string","QuerySnapshot"),bundleName:_r("string"),bundle:_r("string")};class WP extends tJ{constructor(e){super(),this.firestore=e}convertBytes(e){return new xs(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new or(this.firestore,null,r)}}function Kr(t){t=Is(t,Il);const e=Is(t.firestore,vo),r=Dp(e),n=new WP(e);return eJ(t._query),HQ(r,t._query).then(s=>new Ic(e,n,t,s))}function Sf(t,e,r){t=Is(t,or);const n=Is(t.firestore,vo),s=Xw(t.converter,e,r);return nd(n,[$w(td(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,An.none())])}function Th(t,e,r,...n){t=Is(t,or);const s=Is(t.firestore,vo),i=td(s);let a;return a=typeof(e=qt(e))=="string"||e instanceof ed?jP(i,"updateDoc",t._key,e,r,n):MP(i,"updateDoc",t._key,e),nd(s,[a.toMutation(t._key,An.exists(!0))])}function Qc(t){return nd(Is(t.firestore,vo),[new bp(t._key,An.none())])}function Q1(t,e){const r=Is(t.firestore,vo),n=ar(t),s=Xw(t.converter,e);return nd(r,[$w(td(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,An.exists(!1))]).then(()=>n)}function nd(t,e){return function(n,s){const i=new qi;return n.asyncQueue.enqueueAndForget(async()=>RQ(await $Q(n),s,i)),i.promise}(Dp(t),e)}function nJ(t,e,r){const n=r.docs.get(e._key),s=new WP(t);return new Ko(t,s,e._key,n,new Ju(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sJ{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=td(e)}set(e,r,n){this._verifyNotCommitted();const s=Yg(e,this._firestore),i=Xw(s.converter,r,n),a=$w(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,An.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Yg(e,this._firestore);let a;return a=typeof(r=qt(r))=="string"||r instanceof ed?jP(this._dataReader,"WriteBatch.update",i._key,r,n,s):MP(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,An.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Yg(e,this._firestore);return this._mutations=this._mutations.concat(new bp(r._key,An.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(ge.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Yg(t,e){if((t=qt(t)).firestore!==e)throw new Ie(ge.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Rr(){return new zw("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(t){return Dp(t=Is(t,vo)),new sJ(t,e=>nd(t,e))}(function(e,r=!0){(function(s){uu=s})(lu),Si(new Ys("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new vo(new QK(n.getProvider("auth-internal")),new eX(a,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ie(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xh(c.options.projectId,u)}(a,s),a);return i={useFetchStreams:r,...i},o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Ss(hS,dS,e),Ss(hS,dS,"esm2020")})();const GP="@firebase/installations",Yw="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP=1e4,KP=`w:${Yw}`,XP="FIS_v2",iJ="https://firebaseinstallations.googleapis.com/v1",aJ=60*60*1e3,oJ="installations",lJ="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cJ={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},hl=new Sl(oJ,lJ,cJ);function YP(t){return t instanceof Zs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP({projectId:t}){return`${iJ}/projects/${t}/installations`}function JP(t){return{token:t.token,requestStatus:2,expiresIn:fJ(t.expiresIn),creationTime:Date.now()}}async function ZP(t,e){const n=(await e.json()).error;return hl.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function e3({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function uJ(t,{refreshToken:e}){const r=e3(t);return r.append("Authorization",hJ(e)),r}async function t3(t){const e=await t();return e.status>=500&&e.status<600?t():e}function fJ(t){return Number(t.replace("s","000"))}function hJ(t){return`${XP} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dJ({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=QP(t),s=e3(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={fid:r,authVersion:XP,appId:t.appId,sdkVersion:KP},o={method:"POST",headers:s,body:JSON.stringify(a)},l=await t3(()=>fetch(n,o));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:JP(c.authToken)}}else throw await ZP("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r3(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mJ(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pJ=/^[cdef][\w-]{21}$/,J1="";function gJ(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=xJ(t);return pJ.test(r)?r:J1}catch{return J1}}function xJ(t){return mJ(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=new Map;function s3(t,e){const r=Vp(t);i3(r,e),yJ(r,e)}function i3(t,e){const r=n3.get(t);if(r)for(const n of r)n(e)}function yJ(t,e){const r=vJ();r&&r.postMessage({key:t,fid:e}),wJ()}let Mo=null;function vJ(){return!Mo&&"BroadcastChannel"in self&&(Mo=new BroadcastChannel("[Firebase] FID Change"),Mo.onmessage=t=>{i3(t.data.key,t.data.fid)}),Mo}function wJ(){n3.size===0&&Mo&&(Mo.close(),Mo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _J="firebase-installations-database",EJ=1,dl="firebase-installations-store";let Qg=null;function Qw(){return Qg||(Qg=CN(_J,EJ,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(dl)}}})),Qg}async function Om(t,e){const r=Vp(t),s=(await Qw()).transaction(dl,"readwrite"),i=s.objectStore(dl),a=await i.get(r);return await i.put(e,r),await s.done,(!a||a.fid!==e.fid)&&s3(t,e.fid),e}async function a3(t){const e=Vp(t),n=(await Qw()).transaction(dl,"readwrite");await n.objectStore(dl).delete(e),await n.done}async function Bp(t,e){const r=Vp(t),s=(await Qw()).transaction(dl,"readwrite"),i=s.objectStore(dl),a=await i.get(r),o=e(a);return o===void 0?await i.delete(r):await i.put(o,r),await s.done,o&&(!a||a.fid!==o.fid)&&s3(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jw(t){let e;const r=await Bp(t.appConfig,n=>{const s=TJ(n),i=SJ(t,s);return e=i.registrationPromise,i.installationEntry});return r.fid===J1?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function TJ(t){const e=t||{fid:gJ(),registrationStatus:0};return o3(e)}function SJ(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(hl.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=AJ(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:kJ(t)}:{installationEntry:e}}async function AJ(t,e){try{const r=await dJ(t,e);return Om(t.appConfig,r)}catch(r){throw YP(r)&&r.customData.serverCode===409?await a3(t.appConfig):await Om(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function kJ(t){let e=await fA(t.appConfig);for(;e.registrationStatus===1;)await r3(100),e=await fA(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await Jw(t);return n||r}return e}function fA(t){return Bp(t,e=>{if(!e)throw hl.create("installation-not-found");return o3(e)})}function o3(t){return bJ(t)?{fid:t.fid,registrationStatus:0}:t}function bJ(t){return t.registrationStatus===1&&t.registrationTime+qP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CJ({appConfig:t,heartbeatServiceProvider:e},r){const n=IJ(t,r),s=uJ(t,r),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={installation:{sdkVersion:KP,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(a)},l=await t3(()=>fetch(n,o));if(l.ok){const c=await l.json();return JP(c)}else throw await ZP("Generate Auth Token",l)}function IJ(t,{fid:e}){return`${QP(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zw(t,e=!1){let r;const n=await Bp(t.appConfig,i=>{if(!l3(i))throw hl.create("not-registered");const a=i.authToken;if(!e&&PJ(a))return i;if(a.requestStatus===1)return r=NJ(t,e),i;{if(!navigator.onLine)throw hl.create("app-offline");const o=FJ(i);return r=RJ(t,o),o}});return r?await r:n.authToken}async function NJ(t,e){let r=await hA(t.appConfig);for(;r.authToken.requestStatus===1;)await r3(100),r=await hA(t.appConfig);const n=r.authToken;return n.requestStatus===0?Zw(t,e):n}function hA(t){return Bp(t,e=>{if(!l3(e))throw hl.create("not-registered");const r=e.authToken;return OJ(r)?{...e,authToken:{requestStatus:0}}:e})}async function RJ(t,e){try{const r=await CJ(t,e),n={...e,authToken:r};return await Om(t.appConfig,n),r}catch(r){if(YP(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await a3(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Om(t.appConfig,n)}throw r}}function l3(t){return t!==void 0&&t.registrationStatus===2}function PJ(t){return t.requestStatus===2&&!DJ(t)}function DJ(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+aJ}function FJ(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function OJ(t){return t.requestStatus===1&&t.requestTime+qP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LJ(t){const e=t,{installationEntry:r,registrationPromise:n}=await Jw(e);return n?n.catch(console.error):Zw(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MJ(t,e=!1){const r=t;return await jJ(r),(await Zw(r,e)).token}async function jJ(t){const{registrationPromise:e}=await Jw(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VJ(t){if(!t||!t.options)throw Jg("App Configuration");if(!t.name)throw Jg("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw Jg(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Jg(t){return hl.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3="installations",BJ="installations-internal",UJ=t=>{const e=t.getProvider("app").getImmediate(),r=VJ(e),n=Al(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},$J=t=>{const e=t.getProvider("app").getImmediate(),r=Al(e,c3).getImmediate();return{getId:()=>LJ(r),getToken:s=>MJ(r,s)}};function zJ(){Si(new Ys(c3,UJ,"PUBLIC")),Si(new Ys(BJ,$J,"PRIVATE"))}zJ();Ss(GP,Yw);Ss(GP,Yw,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="analytics",HJ="firebase_id",WJ="origin",GJ=60*1e3,qJ="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",e_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n=new pp("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KJ={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ts=new Sl("analytics","Analytics",KJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XJ(t){if(!t.startsWith(e_)){const e=ts.create("invalid-gtag-resource",{gtagURL:t});return $n.warn(e.message),""}return t}function u3(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function YJ(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function QJ(t,e){const r=YJ("firebase-js-sdk-policy",{createScriptURL:XJ}),n=document.createElement("script"),s=`${e_}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function JJ(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function ZJ(t,e,r,n,s,i){const a=n[s];try{if(a)await e[a];else{const l=(await u3(r)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(o){$n.error(o)}t("config",s,i)}async function eZ(t,e,r,n,s){try{let i=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const o=await u3(r);for(const l of a){const c=o.find(h=>h.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",n,s||{})}catch(i){$n.error(i)}}function tZ(t,e,r,n){async function s(i,...a){try{if(i==="event"){const[o,l]=a;await eZ(t,e,r,o,l)}else if(i==="config"){const[o,l]=a;await ZJ(t,e,r,n,o,l)}else if(i==="consent"){const[o,l]=a;t("consent",o,l)}else if(i==="get"){const[o,l,c]=a;t("get",o,l,c)}else if(i==="set"){const[o]=a;t("set",o)}else t(i,...a)}catch(o){$n.error(o)}}return s}function rZ(t,e,r,n,s){let i=function(...a){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=tZ(i,t,e,r),{gtagCore:i,wrappedGtag:window[s]}}function nZ(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(e_)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sZ=30,iZ=1e3;class aZ{constructor(e={},r=iZ){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const f3=new aZ;function oZ(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function lZ(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:oZ(r)},s=qJ.replace("{app-id}",e),i=await fetch(s,n);if(i.status!==200&&i.status!==304){let o="";try{const l=await i.json();(a=l.error)!=null&&a.message&&(o=l.error.message)}catch{}throw ts.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function cZ(t,e=f3,r){const{appId:n,apiKey:s,measurementId:i}=t.options;if(!n)throw ts.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw ts.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new hZ;return setTimeout(async()=>{o.abort()},GJ),h3({appId:n,apiKey:s,measurementId:i},a,o,e)}async function h3(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=f3){var o;const{appId:i,measurementId:a}=t;try{await uZ(n,e)}catch(l){if(a)return $n.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:a};throw l}try{const l=await lZ(t);return s.deleteThrottleMetadata(i),l}catch(l){const c=l;if(!fZ(c)){if(s.deleteThrottleMetadata(i),a)return $n.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:a};throw l}const u=Number((o=c==null?void 0:c.customData)==null?void 0:o.httpStatus)===503?MT(r,s.intervalMillis,sZ):MT(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:r+1};return s.setThrottleMetadata(i,h),$n.debug(`Calling attemptFetch again in ${u} millis`),h3(t,h,n,s)}}function uZ(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(i),n(ts.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function fZ(t){if(!(t instanceof Zs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class hZ{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function dZ(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const i=await e,a={...n,send_to:i};t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mZ(){if(SN())try{await AN()}catch(t){return $n.warn(ts.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return $n.warn(ts.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function pZ(t,e,r,n,s,i,a){const o=cZ(t);o.then(m=>{r[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&$n.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>$n.error(m)),e.push(o);const l=mZ().then(m=>{if(m)return n.getId()}),[c,u]=await Promise.all([o,l]);nZ(i)||QJ(i,c.measurementId),s("js",new Date);const h=(a==null?void 0:a.config)??{};return h[WJ]="firebase",h.update=!0,u!=null&&(h[HJ]=u),s("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gZ{constructor(e){this.app=e}_delete(){return delete Af[this.app.options.appId],Promise.resolve()}}let Af={},dA=[];const mA={};let Zg="dataLayer",xZ="gtag",pA,d3,gA=!1;function yZ(){const t=[];if(TN()&&t.push("This is a browser extension environment."),fW()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=ts.create("invalid-analytics-context",{errorInfo:e});$n.warn(r.message)}}function vZ(t,e,r){yZ();const n=t.options.appId;if(!n)throw ts.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)$n.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ts.create("no-api-key");if(Af[n]!=null)throw ts.create("already-exists",{id:n});if(!gA){JJ(Zg);const{wrappedGtag:i,gtagCore:a}=rZ(Af,dA,mA,Zg,xZ);d3=i,pA=a,gA=!0}return Af[n]=pZ(t,dA,mA,e,pA,Zg,r),new gZ(t)}function wZ(t=ow()){t=qt(t);const e=Al(t,Lm);return e.isInitialized()?e.getImmediate():_Z(t)}function _Z(t,e={}){const r=Al(t,Lm);if(r.isInitialized()){const s=r.getImmediate();if(eo(e,r.getOptions()))return s;throw ts.create("already-initialized")}return r.initialize({options:e})}function EZ(t,e,r,n){t=qt(t),dZ(d3,Af[t.app.options.appId],e,r,n).catch(s=>$n.error(s))}const xA="@firebase/analytics",yA="0.10.18";function TZ(){Si(new Ys(Lm,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return vZ(n,s,r)},"PUBLIC")),Si(new Ys("analytics-internal",t,"PRIVATE")),Ss(xA,yA),Ss(xA,yA,"esm2020");function t(e){try{const r=e.getProvider(Lm).getImmediate();return{logEvent:(n,s,i)=>EZ(r,n,s,i)}}catch(r){throw ts.create("interop-component-reg-failed",{reason:r})}}}TZ();const SZ={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},t_=IN(SZ),Nn=WK(t_),We=GQ(t_);typeof window<"u"&&wZ(t_);const m3=te.createContext(),Nl=()=>{const t=te.useContext(m3);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},AZ=({children:t})=>{const[e,r]=te.useState(null),[n,s]=te.useState(!0),[i,a]=te.useState(null),o=async(h,m,p)=>{try{a(null);const x=await bq(Nn,h,m);return p&&await Nq(x.user,{displayName:p}),x.user}catch(x){throw a(x.message),x}},l=async(h,m)=>{try{return a(null),(await Cq(Nn,h,m)).user}catch(p){throw a(p.message),p}},c=async()=>{try{a(null),await Fq(Nn)}catch(h){throw a(h.message),h}};te.useEffect(()=>Dq(Nn,m=>{r(m),s(!1)}),[]);const u={user:e,loading:n,error:i,register:o,login:l,logout:c,clearError:()=>a(null)};return f.jsx(m3.Provider,{value:u,children:t})},ys={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData",BENEFICIARIES:"beneficiaries",BENEFICIARY_UPLOADS:"beneficiaryUploads"};let ml=!1;const vs=(t,e)=>{if(t.code==="permission-denied")return ml||(console.warn(" Firebase Firestore: Permisos insuficientes. La aplicacin funciona en modo demo."),console.info(" Para habilitar persistencia, configura Firestore siguiendo las instrucciones en FIREBASE_SETUP.md"),ml=!0),null;if(t.code==="failed-precondition"&&t.message.includes("index"))return console.info(" Firebase est creando ndices necesarios. Usando datos locales temporalmente."),console.info(" Estado del ndice: https://console.firebase.google.com/project/centralteleoperadores/firestore/indexes"),null;throw console.error(`Error en ${e}:`,t),t},kf={async create(t,e){try{return{id:(await Q1(Pt(We,ys.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){return vs(r,"crear operador")}},async getByUser(t){if(ml)return[];try{const e=gr(Pt(We,ys.OPERATORS),pr("userId","==",t));return(await Kr(e)).docs.map(s=>({id:s.id,...s.data()})).sort((s,i)=>{var l,c,u,h;const a=((c=(l=s.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(0);return(((h=(u=i.createdAt)==null?void 0:u.toDate)==null?void 0:h.call(u))||new Date(0))-a})}catch(e){return vs(e,"obtener operadores")||[]}},async update(t,e){try{const r=ar(We,ys.OPERATORS,t);return await Th(r,{...e,updatedAt:new Date}),!0}catch(r){return vs(r,"actualizar operador")}},async delete(t){try{return await Qc(ar(We,ys.OPERATORS,t)),!0}catch(e){return vs(e,"eliminar operador")}},async getAll(){if(ml)return[];try{console.log(" Obteniendo todos los operadores desde Firebase...");const e=(await Kr(Pt(We,ys.OPERATORS))).docs.map(r=>({id:r.id,...r.data()}));return console.log(" Operadores obtenidos:",e.length),e.sort((r,n)=>{var a,o,l,c;const s=((o=(a=r.createdAt)==null?void 0:a.toDate)==null?void 0:o.call(a))||new Date(0);return(((c=(l=n.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(0))-s})}catch(t){return console.error(" Error obteniendo todos los operadores:",t),vs(t,"obtener todos los operadores")||[]}}},oc={async saveOperatorAssignments(t,e,r){try{const n=ar(We,ys.ASSIGNMENTS,`${t}_${e}`);return await Sf(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date}),!0}catch(n){return vs(n,"guardar asignaciones")}},async getOperatorAssignments(t,e){try{const r=ar(We,ys.ASSIGNMENTS,`${t}_${e}`),n=await jp(r);return n.exists()?n.data().assignments||[]:[]}catch(r){return vs(r,"obtener asignaciones")||[]}},async getAllUserAssignments(t){if(ml)return{};try{const e=gr(Pt(We,ys.ASSIGNMENTS),pr("userId","==",t)),r=await Kr(e),n={};return r.docs.forEach(s=>{const i=s.data();n[i.operatorId]=i.assignments||[]}),n}catch(e){return vs(e,"obtener todas las asignaciones")||{}}},async deleteOperatorAssignments(t,e){try{return await Qc(ar(We,ys.ASSIGNMENTS,`${t}_${e}`)),!0}catch(r){return vs(r,"eliminar asignaciones")}},async getAll(){if(ml)return[];try{console.log(" Obteniendo todas las asignaciones desde Firebase...");const t=await Kr(Pt(We,ys.ASSIGNMENTS)),e=[];return t.docs.forEach(r=>{const n=r.data();n.assignments&&Array.isArray(n.assignments)&&n.assignments.forEach(s=>{e.push({...s,operatorId:n.operatorId,userId:n.userId})})}),console.log(" Asignaciones obtenidas:",e.length),e}catch(t){return console.error(" Error obteniendo todas las asignaciones:",t),vs(t,"obtener todas las asignaciones")||[]}}},Z1={async saveCallData(t,e){try{const r=ar(We,ys.CALL_DATA,t);return await Sf(r,{userId:t,callData:e,updatedAt:new Date}),!0}catch(r){return vs(r,"guardar datos de llamadas")}},async getCallData(t){if(ml)return[];try{const e=ar(We,ys.CALL_DATA,t),r=await jp(e);return r.exists()?r.data().callData||[]:[]}catch(e){return vs(e,"obtener datos de llamadas")||[]}}},ex=Object.freeze(Object.defineProperty({__proto__:null,assignmentService:oc,callDataService:Z1,operatorService:kf},Symbol.toStringTag,{value:"Module"})),vA=t=>{let e;const r=new Set,n=(c,u)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const m=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},s=()=>e,o={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,s,o);return o},kZ=t=>t?vA(t):vA,bZ=t=>t;function CZ(t,e=bZ){const r=Pf.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Pf.useDebugValue(r),r}const wA=t=>{const e=kZ(t),r=n=>CZ(e,n);return Object.assign(r,e),r},sd=t=>t?wA(t):wA;function Up(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var i;const a=l=>l===null?null:JSON.parse(l,void 0),o=(i=r.getItem(s))!=null?i:null;return o instanceof Promise?o.then(a):a(o)},setItem:(s,i)=>r.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>r.removeItem(s)}}const ey=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return ey(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return ey(n)(r)}}}},IZ=(t,e)=>(r,n,s)=>{let i={storage:Up(()=>localStorage),partialize:g=>g,version:0,merge:(g,v)=>({...v,...g}),...e},a=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,s);const u=()=>{const g=i.partialize({...n()});return c.setItem(i.name,{state:g,version:i.version})},h=s.setState;s.setState=(g,v)=>{h(g,v),u()};const m=t((...g)=>{r(...g),u()},n,s);s.getInitialState=()=>m;let p;const x=()=>{var g,v;if(!c)return;a=!1,o.forEach(w=>{var y;return w((y=n())!=null?y:m)});const _=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(g=n())!=null?g:m))||void 0;return ey(c.getItem.bind(c))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate){const y=i.migrate(w.state,w.version);return y instanceof Promise?y.then(I=>[!0,I]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var y;const[I,O]=w;if(p=i.merge(O,(y=n())!=null?y:m),r(p,!0),I)return u()}).then(()=>{_==null||_(p,void 0),p=n(),a=!0,l.forEach(w=>w(p))}).catch(w=>{_==null||_(void 0,w)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},i.skipHydration||x(),p||m},id=IZ;sd(id((t,e)=>({user:null,isAuthenticated:!1,loading:!1,error:null,setUser:r=>{t({user:r,isAuthenticated:!!r,error:null})},setLoading:r=>{t({loading:r})},setError:r=>{t({error:r})},logout:()=>{t({user:null,isAuthenticated:!1,loading:!1,error:null})},updateUser:r=>{const n=e().user;n&&t({user:{...n,...r}})},getUserDisplayName:()=>{const{user:r}=e();return(r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"Usuario"},getUserEmail:()=>{const{user:r}=e();return(r==null?void 0:r.email)||""},isAdmin:()=>{const{user:r}=e();return(r==null?void 0:r.role)==="admin"||!1}}),{name:"user-storage",storage:Up(()=>localStorage),partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated})}));const Sh=sd(id((t,e)=>({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},isLoading:!1,loadingStage:null,loadingMessage:"",lastUpdated:null,dataSource:null,filters:{dateRange:null,operator:null,status:"all",commune:null},_phoneToOperatorCache:new Map,_beneficiaryCache:new Map,_dateCache:new Map,forceReanalysis:()=>{const{callData:r}=e();r&&r.length>0&&(console.log(" Forzando re-anlisis con lgica corregida..."),e().analyzeCallData())},setCallData:(r,n="excel")=>{const s=new Date().toISOString();t({callData:r,dataSource:n,lastUpdated:s,isLoading:!1,loadingStage:"complete",loadingMessage:`${r.length} llamadas cargadas exitosamente`,_phoneToOperatorCache:new Map,_beneficiaryCache:new Map,_dateCache:new Map}),e().analyzeCallData()},setLoading:(r,n=null,s="")=>{t({isLoading:r,loadingStage:n,loadingMessage:s})},setLoadingStage:(r,n="")=>{t({loadingStage:r,loadingMessage:n||{uploading:"Subiendo archivo Excel...",processing:"Procesando datos del archivo...",analyzing:"Analizando llamadas y generando mtricas...",complete:"Anlisis completado exitosamente",error:"Error durante el procesamiento"}[r]||"",isLoading:r!=="complete"&&r!=="error"})},analyzeCallData:()=>{const{callData:r}=e();if(e().setLoadingStage("analyzing","Analizando datos de llamadas..."),!r||r.length===0){t({processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},loadingStage:"complete",loadingMessage:"No hay datos para analizar",isLoading:!1});return}setTimeout(()=>{const n=r.map(h=>{const m=h.beneficiario||h.beneficiary||h.nombre||"Sin identificar",p=h.operador||h.operator||h.teleoperadora||"No identificado",x=h.telefono||h.phone||h.numero||"N/A",g=h.fecha||h.date||new Date().toISOString().split("T")[0],v=parseInt(h.duracion||h.duration||0),_=h.resultado||h.result||h.estado||"",w=(_==="Llamado exitoso"||_==="exitoso"||_==="Exitoso")&&v>0;return{...h,beneficiary:m,operator:p,phone:x,date:g,duration:v,isSuccessful:w,categoria:w?"exitosa":"fallida"}}),s=n.length,i=n.filter(h=>h.isSuccessful).length,a=s-i,o=n.reduce((h,m)=>h+m.duration,0),l=s>0?Math.round(o/s):0,c=new Set(n.map(h=>h.beneficiary)).size,u={totalCalls:s,successfulCalls:i,failedCalls:a,averageDuration:l,uniqueBeneficiaries:c,protocolCompliance:s>0?Math.round(i/s*100):0};t({processedData:n,callMetrics:u,loadingStage:"complete",loadingMessage:`Anlisis completado: ${s} llamadas procesadas`,isLoading:!1})},100)},getFilteredData:()=>{const{processedData:r,filters:n}=e();if(!r||r.length===0)return[];let s=[...r];if(n.operator&&n.operator!=="all"&&(s=s.filter(i=>i.operator===n.operator)),n.status&&n.status!=="all"&&(n.status==="successful"?s=s.filter(i=>i.isSuccessful):n.status==="failed"&&(s=s.filter(i=>!i.isSuccessful))),n.commune&&n.commune!=="all"&&(s=s.filter(i=>i.commune===n.commune)),n.dateRange){const{start:i,end:a}=n.dateRange,o=new Date(i).getTime(),l=new Date(a).getTime();s=s.filter(c=>{const u=new Date(c.date).getTime();return u>=o&&u<=l})}return s},clearData:()=>{t({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},lastUpdated:null,dataSource:null,isLoading:!1,loadingStage:null,loadingMessage:"",_phoneToOperatorCache:new Map,_beneficiaryCache:new Map,_dateCache:new Map})},getOperatorMetrics:(r=null)=>{try{const{callData:n,_phoneToOperatorCache:s}=e();if(!n||n.length===0)return[];if(!r||!Array.isArray(r)||r.length===0)return[];let i=s;i.size===0&&(r.forEach(u=>{const h=u.operator||u.operatorName||"Sin Asignar",m=[];[u.phone,u.primaryPhone,u.telefono,u.numero_cliente].filter(Boolean).forEach(p=>{p.includes(";")?m.push(...p.split(";").map(x=>x.trim())):m.push(p)}),u.phones&&Array.isArray(u.phones)&&m.push(...u.phones),m.forEach(p=>{if(p&&p!=="N/A"&&p.trim()){const x=p.toString().replace(/[^\d]/g,"");if(x.length>=8){const g=x.slice(-8);i.set(g,h)}}})}),t({_phoneToOperatorCache:i}));const a=[...new Set(Array.from(i.values()))],o={};a.forEach(u=>{o[u]={operatorName:u,totalCalls:0,successfulCalls:0,failedCalls:0,totalDuration:0}});let l=0;return n.forEach(u=>{const h=u.phone||u.telefono||u.numero||u.numero_cliente||u.numero_telefono||"";if(h&&h.trim()){const m=h.toString().replace(/[^\d]/g,"");if(m.length>=8){const p=m.slice(-8),x=i.get(p);if(x&&o[x]){l++;const g=o[x];g.totalCalls++;const v=parseInt(u.duration||u.duracion||0);g.totalDuration+=v;const _=u.result||u.resultado||u.estado||"";(_==="Llamado exitoso"||_==="exitoso"||_==="Exitoso")&&v>0?g.successfulCalls++:g.failedCalls++}}}}),Object.values(o).filter(u=>u.totalCalls>0).map(u=>({operatorName:u.operatorName,totalCalls:u.totalCalls,successfulCalls:u.successfulCalls,failedCalls:u.failedCalls,averageDuration:u.totalCalls>0?Math.round(u.totalDuration/u.totalCalls):0,successRate:u.totalCalls>0?Math.round(u.successfulCalls/u.totalCalls*100):0})).sort((u,h)=>h.totalCalls-u.totalCalls)}catch(n){return console.error("Error en getOperatorMetrics:",n),[]}},getHourlyDistribution:()=>{const{processedData:r}=e(),n=Array.from({length:24},(s,i)=>({hour:i,calls:0}));return Array.isArray(r)&&r.forEach(s=>{try{let i=null;if(s.hora){const o=s.hora.toString().match(/^(\d{1,2})/);o&&(i=parseInt(o[1]))}else s.hour!==void 0&&(i=parseInt(s.hour));i!==null&&i>=0&&i<24&&n[i].calls++}catch{}}),n},getFollowUpData:r=>{const{processedData:n,_beneficiaryCache:s}=e();if(!n||n.length===0)return[];const{_dateCache:i}=e(),a=u=>{if(!u)return"N/A";if(i.has(u))return i.get(u);try{let h;if(typeof u=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(u)){const m=u.split(/[-\/]/),p=parseInt(m[0]),x=parseInt(m[1]),g=parseInt(m[2]);p<=31&&x<=12&&g>=1900?h=`${p.toString().padStart(2,"0")}-${x.toString().padStart(2,"0")}-${g}`:h="Fecha invlida"}else if(typeof u=="number"){const m=new Date((u-25569)*86400*1e3);if(isNaN(m.getTime()))h="Fecha invlida";else{const p=m.getDate().toString().padStart(2,"0"),x=(m.getMonth()+1).toString().padStart(2,"0"),g=m.getFullYear();h=`${p}-${x}-${g}`}}else{const m=new Date(u);if(isNaN(m.getTime()))h=typeof u=="string"?u:"Error en fecha";else{const p=m.getDate().toString().padStart(2,"0"),x=(m.getMonth()+1).toString().padStart(2,"0"),g=m.getFullYear();h=`${p}-${x}-${g}`}}return i.set(u,h),h}catch{return typeof u=="string"?u:"Error en fecha"}};let o=s;o.size===0&&(n.forEach(u=>{const h=u.beneficiario||u.beneficiary,m=u.resultado||u.result||u.estado||"Sin resultado",p=u.fecha||u.date;if(!h)return;o.has(h)||o.set(h,{beneficiary:h,calls:[],lastResult:m,lastDate:p});const x=o.get(h);x.calls.push(u);try{const g=new Date(p).getTime(),v=new Date(x.lastDate).getTime();!isNaN(g)&&(isNaN(v)||g>v)&&(x.lastResult=m,x.lastDate=p)}catch{}}),t({_beneficiaryCache:o}));const l=new Map;return r&&Array.isArray(r)&&r.forEach(u=>{const h=(u.beneficiary||u.beneficiario||"").trim();h&&l.set(h.toLowerCase(),u)}),Array.from(o.values()).map(u=>{const h=l.get(u.beneficiary.toLowerCase());let m="pendiente",p="bg-yellow-100 text-yellow-800";u.lastResult==="Llamado exitoso"||u.lastResult==="exitosa"?(m="al-dia",p="bg-green-100 text-green-800"):u.calls.length>3&&(m="urgente",p="bg-red-100 text-red-800");let x="No Asignado",g="N/A",v="N/A";if(h){const _=h.operator||h.operador||h.operatorName||h.teleoperadora||h.name;_&&_!=="Solo HANGUP"&&_!=="HANGUP"&&_!=="No identificado"&&_!=="Llamado exitoso"&&_!=="Llamado fallido"&&_!=="exitosa"&&_!=="fallida"&&_.trim().length>2&&!/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(_)&&(x=_),g=h.phone||h.telefono||h.primaryPhone||h.numero_cliente||"N/A",v=h.commune||h.comuna||"N/A"}return{id:u.beneficiary,operator:x,beneficiary:u.beneficiary,phone:g,commune:v,status:m,lastCall:a(u.lastDate),callCount:u.calls.length,colorClass:p}})},hasData:()=>{const{callData:r}=e();return r&&r.length>0},getSuccessRate:()=>{const{callMetrics:r}=e();return!r||!r.totalCalls||r.totalCalls===0?0:Math.round(r.successfulCalls/r.totalCalls*100)},getDataSummary:()=>{const{callMetrics:r,lastUpdated:n,dataSource:s}=e();return{...r,lastUpdated:n,dataSource:s,successRate:e().getSuccessRate()}}}),{name:"call-audit-storage-optimized",storage:Up(()=>localStorage),partialize:t=>({callData:t.callData,processedData:t.processedData,callMetrics:t.callMetrics,lastUpdated:t.lastUpdated,dataSource:t.dataSource,filters:t.filters,loadingStage:t.loadingStage,loadingMessage:t.loadingMessage})})),Dn=sd(id((t,e)=>({operators:[],operatorAssignments:{},activeTab:"dashboard",isLoading:!1,settings:{autoRefresh:!1,refreshInterval:3e4,defaultView:"dashboard"},setOperators:r=>{t({operators:r||[]})},addOperator:r=>{t(n=>({operators:[...n.operators,r]}))},updateOperator:(r,n)=>{t(s=>({operators:s.operators.map(i=>i.id===r?{...i,...n}:i)}))},removeOperator:r=>{t(n=>({operators:n.operators.filter(s=>s.id!==r),operatorAssignments:Object.fromEntries(Object.entries(n.operatorAssignments).filter(([s])=>s!==r))}))},setOperatorAssignments:r=>{t({operatorAssignments:r||{}})},updateOperatorAssignments:(r,n)=>{t(s=>({operatorAssignments:{...s.operatorAssignments,[r]:n}}))},clearOperatorAssignments:r=>{t(n=>{const s={...n.operatorAssignments};return delete s[r],{operatorAssignments:s}})},setActiveTab:r=>{t({activeTab:r})},setLoading:r=>{t({isLoading:r})},updateSettings:r=>{t(n=>({settings:{...n.settings,...r}}))},getOperatorById:r=>{const{operators:n}=e();return n.find(s=>s.id===r)||null},getOperatorAssignments:r=>{const{operatorAssignments:n}=e();return n[r]||[]},getAllAssignments:()=>{const{operatorAssignments:r,operators:n}=e(),s=[];return console.log(" getAllAssignments - operatorAssignments:",r),console.log(" getAllAssignments - operators:",n),Object.entries(r).forEach(([i,a])=>{const o=n.find(l=>l.id===i);o&&a&&(console.log(` Procesando asignaciones para ${o.name}:`,a.length),a.forEach(l=>{const c={id:l.id,operator:o.name,operatorName:o.name,operatorEmail:o.email,beneficiary:l.beneficiary,phone:l.primaryPhone,commune:l.commune};s.push(c),console.log(" Asignacin agregada:",c)}))}),console.log(" Total asignaciones devueltas:",s.length),s},getAssignmentsByEmail:r=>{const{operatorAssignments:n,operators:s}=e(),i=r==null?void 0:r.toLowerCase().trim();console.log(" Buscando asignaciones para email:",i),console.log(" Operadores disponibles:",s.map(o=>({id:o.id,name:o.name,email:o.email})));const a=s.find(o=>{var p,x;const l=(p=o.email)==null?void 0:p.toLowerCase().trim(),c=(x=o.name)==null?void 0:x.toLowerCase().trim(),u=l===i,h=i.includes(c==null?void 0:c.split(" ")[0])||i.includes(c==null?void 0:c.split(" ")[1]),m=c==null?void 0:c.includes(i.split("@")[0]);return console.log(` Verificando operador ${o.name}:`,{opEmail:l,exactEmailMatch:u,nameInEmail:h,emailInName:m}),u||h||m});if(a){console.log(" Operador encontrado:",a);const o=n[a.id]||[];return console.log(" Asignaciones encontradas:",o.length),o.map(l=>({id:l.id,operator:a.name,operatorName:a.name,operatorEmail:a.email,beneficiary:l.beneficiary,phone:l.primaryPhone,commune:l.commune}))}else return console.warn(" No se encontr operador para email:",i),[]},getTotalAssignments:()=>{const{operatorAssignments:r}=e();return Object.values(r).reduce((n,s)=>n+((s==null?void 0:s.length)||0),0)},loadOperators:async()=>{try{t({isLoading:!0}),console.log(" Cargando operadores desde Firebase...");const r=await kf.getAll();return console.log(" Operadores cargados:",r.length),t({operators:r||[],isLoading:!1}),r}catch(r){return console.error(" Error cargando operadores:",r),t({isLoading:!1}),[]}},loadAssignments:async()=>{try{t({isLoading:!0}),console.log(" Cargando asignaciones desde Firebase...");const r=await oc.getAll();console.log(" Asignaciones cargadas:",r.length);const n={};return r.forEach(s=>{s.operatorId&&(n[s.operatorId]||(n[s.operatorId]=[]),n[s.operatorId].push(s))}),t({operatorAssignments:n,isLoading:!1}),console.log(" Asignaciones agrupadas por operador:",Object.keys(n).length),r}catch(r){return console.error(" Error cargando asignaciones:",r),t({isLoading:!1}),[]}},clearAllData:()=>{t({operators:[],operatorAssignments:{},activeTab:"dashboard"})}}),{name:"app-storage",storage:Up(()=>localStorage),partialize:t=>({operators:t.operators,operatorAssignments:t.operatorAssignments,settings:t.settings})})),fi=t=>!t||typeof t!="string"?"":t.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").replace(/[^\w\s]/g,""),yr=t=>{if(!t)return"";const e=t.toString();if(/^0+$/.test(e.replace(/\D/g,"")))return"";const r=e.replace(/\D/g,"");return r.length<8?"":r},p3=(t,e,r=.8)=>{if(!t||!e)return!1;const n=fi(t),s=fi(e);if(n===s||n.includes(s)||s.includes(n))return!0;const i=n.split(" "),a=s.split(" "),o=i.filter(u=>a.includes(u)),l=[...new Set([...i,...a])];return o.length/l.length>=r},ty=(t,e)=>{if(!t||!e||!Array.isArray(e))return null;const r=fi(t.nombre),n=[yr(t.fono),yr(t.sim),yr(t.appSim)].filter(Boolean);return e.find(s=>{const i=fi(s.nombre||s.name);if(p3(r,i))return!0;const a=[yr(s.fono||s.telefono||s.phone),yr(s.sim),yr(s.appSim)].filter(Boolean);return n.some(o=>a.some(l=>l===o))})},NZ=t=>{const e=[yr(t.fono),yr(t.sim),yr(t.appSim)].filter(Boolean);return[...new Set(e)]},Ms={BENEFICIARIES:"beneficiaries",BENEFICIARY_UPLOADS:"beneficiaryUploads"},Fi={async deleteAllBeneficiaries(t=null){try{console.log(" Eliminando todos los beneficiarios...");let e;t?(console.log(` Eliminando beneficiarios del usuario: ${t}`),e=gr(Pt(We,Ms.BENEFICIARIES),pr("creadoPor","==",t))):(console.log(" Eliminando TODOS los beneficiarios de la base"),e=Pt(We,Ms.BENEFICIARIES));const r=await Kr(e),n=uA(We);return console.log(` Documentos a eliminar: ${r.size}`),r.docs.forEach(s=>{n.delete(s.ref)}),await n.commit(),console.log(" Eliminacin completada"),{success:!0,deletedCount:r.size,message:`${r.size} beneficiarios eliminados exitosamente`}}catch(e){return console.error(" Error al eliminar beneficiarios:",e),{success:!1,error:e.message,deletedCount:0}}},async uploadBeneficiaries(t,e,r=()=>{},n=!0){try{if(console.log(" Iniciando upload de beneficiarios..."),console.log(` Datos a procesar: ${t.length}`),console.log(` Reemplazar datos existentes: ${n}`),n){console.log(" PASO 1: Eliminando beneficiarios existentes...");const u=await this.deleteAllBeneficiaries(e);if(!u.success)throw new Error(`Error al eliminar datos existentes: ${u.error}`);console.log(` ${u.deletedCount} beneficiarios previos eliminados`),r({phase:"cleanup",completed:u.deletedCount,total:u.deletedCount})}console.log(" PASO 2: Procesando nuevos beneficiarios...");const s=uA(We),i=`upload_${Date.now()}`,a=[],o=[];for(let u=0;u<t.length;u++){const h=t[u];try{const m=this.processBeneficiaryData(h,u+1);if(m.isValid){const p=ar(Pt(We,Ms.BENEFICIARIES)),x={...m.data,uploadId:i,creadoEn:Rr(),actualizadoEn:Rr(),creadoPor:e,rowNumber:u+1};s.set(p,x),a.push({id:p.id,...x})}else o.push({row:u+1,data:h,errors:m.errors})}catch(m){o.push({row:u+1,data:h,errors:[`Error de procesamiento: ${m.message}`]})}r({processed:u+1,total:t.length,successful:a.length,errors:o.length})}const l=ar(Pt(We,Ms.BENEFICIARY_UPLOADS),i);return s.set(l,{id:i,userId:e,totalRecords:t.length,successfulRecords:a.length,errorRecords:o.length,uploadedAt:Rr(),status:"completed"}),await s.commit(),console.log(" UPLOAD COMPLETADO:"),console.log(`   - Registros procesados: ${t.length}`),console.log(`   - Exitosos: ${a.length}`),console.log(`   - Errores: ${o.length}`),{success:!0,uploadId:i,totalProcessed:t.length,successful:a.length,errors:o.length,errorDetails:o,data:a,replacedPrevious:n,message:n?` Base de datos reemplazada: ${a.length} beneficiarios cargados`:` ${a.length} beneficiarios aadidos`}}catch(s){throw console.error(" Error en uploadBeneficiaries:",s),new Error(`Error al cargar beneficiarios: ${s.message}`)}},processBeneficiaryData(t,e){const r=[],n=t.Nombre||t.nombre||t.A||"",s=t.Fono||t.fono||t.B||"",i=t.Sim||t.sim||t.C||"",a=t.Direccion||t.direccion||t.D||"",o=t["App Sim"]||t.appSim||t.E||"";(!n||typeof n!="string"||n.trim().length===0)&&r.push("Nombre es obligatorio"),(!a||typeof a!="string"||a.trim().length===0)&&r.push("Direccin es obligatoria");const l=yr(s),c=yr(i),u=yr(o),h=[l,c,u].filter(Boolean);h.length===0&&r.push("Al menos un telfono vlido es requerido");const m={nombre:n.toString().trim(),fono:l||null,sim:c||null,direccion:a.toString().trim(),appSim:u||null,nombreNormalizado:fi(n),telefonosValidos:h,datosOriginales:{nombre:n,fono:s.toString(),sim:i.toString(),direccion:a,appSim:o.toString()}};return{isValid:r.length===0,errors:r,data:m}},async getAllBeneficiaries(t=null){try{console.log(" getAllBeneficiaries - Iniciando consulta a Firebase..."),console.log(" userId:",t);let e;t?(console.log(" Consultando beneficiarios para usuario especfico..."),e=gr(Pt(We,Ms.BENEFICIARIES),pr("creadoPor","==",t),qo("creadoEn","desc"))):(console.log(" Consultando todos los beneficiarios..."),e=gr(Pt(We,Ms.BENEFICIARIES),qo("creadoEn","desc"))),console.log(" Ejecutando consulta...");const r=await Kr(e);console.log(" Documentos encontrados:",r.size);const n=r.docs.map(s=>({id:s.id,...s.data()}));return console.log(" Beneficiarios procesados:",n.length),n}catch(e){return console.error(" Error al obtener beneficiarios:",e),[]}},async searchBeneficiaries(t){try{const e=await this.getAllBeneficiaries();if(!t||t.trim().length===0)return e;const r=fi(t),n=yr(t);return e.filter(s=>s.nombreNormalizado&&s.nombreNormalizado.includes(r)?!0:n&&s.telefonosValidos?s.telefonosValidos.some(i=>i.includes(n)):!1)}catch(e){return console.error("Error en bsqueda de beneficiarios:",e),[]}},async getBeneficiaryById(t){try{const e=ar(We,Ms.BENEFICIARIES,t),r=await jp(e);return r.exists()?{id:r.id,...r.data()}:null}catch(e){return console.error("Error al obtener beneficiario:",e),null}},async updateBeneficiary(t,e){try{const r=ar(We,Ms.BENEFICIARIES,t),n={...e,actualizadoEn:Rr()};if(e.nombre&&(n.nombreNormalizado=fi(e.nombre)),e.fono!==void 0||e.sim!==void 0||e.appSim!==void 0){const s=await this.getBeneficiaryById(t);if(s){const i={...s,...e};n.telefonosValidos=NZ(i)}}return await Th(r,n),!0}catch(r){return console.error("Error al actualizar beneficiario:",r),!1}},async deleteBeneficiary(t){try{const e=ar(We,Ms.BENEFICIARIES,t);return await Qc(e),!0}catch(e){return console.error("Error al eliminar beneficiario:",e),!1}},async getUploadHistory(t){try{const e=gr(Pt(We,Ms.BENEFICIARY_UPLOADS),pr("userId","==",t),qo("uploadedAt","desc"));return(await Kr(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){return console.error("Error al obtener historial:",e),[]}},async validateBeneficiaryExists(t,e){try{const r=await this.getAllBeneficiaries(),n=fi(t),s=yr(e);return r.find(i=>n&&i.nombreNormalizado===n?!0:s&&i.telefonosValidos?i.telefonosValidos.includes(s):!1)||null}catch(r){return console.error("Error al validar beneficiario:",r),null}},async testFirebaseConnection(){try{console.log(" Iniciando test de conexin Firebase...");const t=performance.now();console.log(" Test 1: Verificando coleccin de beneficiarios...");const e=Pt(We,Ms.BENEFICIARIES);console.log(" Referencia a coleccin creada"),console.log(" Test 2: Ejecutando consulta...");const r=await Kr(e),n=r.size;if(console.log(` Consulta ejecutada. Documentos encontrados: ${n}`),n>0){console.log(" Test 3: Mostrando primeros documentos...");let o=0;r.forEach(l=>{o<3&&(console.log(`   Documento ${l.id}:`,l.data()),o++)})}const s=performance.now(),i=Math.round(s-t),a={success:!0,beneficiariesCount:n,duration:`${i}ms`,timestamp:new Date().toISOString()};return console.log(" Test Firebase completado:",a),a}catch(t){return console.error(" Error en test Firebase:",t),{success:!1,error:t.message,timestamp:new Date().toISOString()}}}};window.testFirebaseConnection=Fi.testFirebaseConnection;const RZ=Object.freeze(Object.defineProperty({__proto__:null,beneficiaryService:Fi},Symbol.toStringTag,{value:"Module"})),Mm=sd(id((t,e)=>({beneficiaries:[],uploadHistory:[],shouldReload:!1,isLoading:!1,isUploading:!1,uploadProgress:0,searchTerm:"",selectedBeneficiary:null,stats:{total:0,withPhones:0,withoutPhones:0,incomplete:0,unassigned:0},settings:{autoValidateAssignments:!0,showUnassignedAlerts:!0,maxUploadSize:10*1024*1024},setBeneficiaries:r=>{const n=e().calculateStats(r);t({beneficiaries:r||[],stats:n})},addBeneficiary:r=>{t(n=>{const s=[...n.beneficiaries,r],i=n.calculateStats(s);return{beneficiaries:s,stats:i}})},updateBeneficiary:(r,n)=>{t(s=>{const i=s.beneficiaries.map(o=>o.id===r?{...o,...n}:o),a=s.calculateStats(i);return{beneficiaries:i,stats:a}})},removeBeneficiary:r=>{t(n=>{const s=n.beneficiaries.filter(a=>a.id!==r),i=n.calculateStats(s);return{beneficiaries:s,stats:i}})},clearAllData:()=>{console.log(" Limpiando todos los datos del store..."),t({beneficiaries:[],uploadHistory:[],searchTerm:"",selectedBeneficiary:null,stats:{total:0,withPhones:0,withoutPhones:0,incomplete:0,unassigned:0},shouldReload:!1});try{localStorage.removeItem("beneficiary-store"),console.log(" localStorage limpiado")}catch(r){console.error("Error al limpiar localStorage:",r)}},setSearchTerm:r=>{t({searchTerm:r})},getFilteredBeneficiaries:()=>{const{beneficiaries:r,searchTerm:n}=e();if(!n||n.trim()==="")return r;const s=n.toLowerCase().trim();return r.filter(i=>i.nombre&&i.nombre.toLowerCase().includes(s)||i.direccion&&i.direccion.toLowerCase().includes(s)||i.fono&&i.fono.includes(s)||i.sim&&i.sim.includes(s)||i.appSim&&i.appSim.includes(s))},setUploadProgress:r=>{t({uploadProgress:r})},setIsUploading:r=>{t({isUploading:r})},addUploadRecord:r=>{t(n=>({uploadHistory:[r,...n.uploadHistory]}))},setIsLoading:r=>{t({isLoading:r})},setSelectedBeneficiary:r=>{t({selectedBeneficiary:r})},updateSettings:r=>{t(n=>({settings:{...n.settings,...r}}))},calculateStats:r=>{const n=r.length,s=r.filter(o=>o.telefonosValidos&&o.telefonosValidos.length>0).length,i=n-s,a=r.filter(o=>!o.nombre||!o.direccion||!o.telefonosValidos||o.telefonosValidos.length===0).length;return{total:n,withPhones:s,withoutPhones:i,incomplete:a,unassigned:0}},loadBeneficiaries:async(r=null)=>{const{beneficiaries:n,shouldReload:s}=e();if(n.length>0&&!s)return console.log(" Usando beneficiarios del cache local:",n.length),n;console.log(" Cargando beneficiarios desde Firebase..."),t({isLoading:!0});try{const i=await Fi.getAllBeneficiaries(r);return console.log(" Beneficiarios cargados:",i.length),e().setBeneficiaries(i),t({shouldReload:!1}),i}catch(i){if(console.error(" Error cargando beneficiarios:",i),n.length>0)return console.log(" Usando datos en cache debido a error de red"),n;throw i}finally{t({isLoading:!1})}},forceReload:async(r=null)=>(t({shouldReload:!0}),await e().loadBeneficiaries(r)),uploadBeneficiaries:async(r,n)=>{t({isUploading:!0,uploadProgress:0});try{const s=await Fi.uploadBeneficiaries(r,n,i=>{const a=Math.round(i.processed/i.total*100);t({uploadProgress:a})});if(s.success&&s.data){const a=[...e().beneficiaries,...s.data];e().setBeneficiaries(a),t({shouldReload:!1})}return e().addUploadRecord({id:s.uploadId,timestamp:new Date,totalRecords:s.totalProcessed,successfulRecords:s.successful,errorRecords:s.errors,fileName:s.fileName||"archivo.xlsx"}),s}catch(s){throw console.error("Error subiendo beneficiarios:",s),s}finally{t({isUploading:!1,uploadProgress:0})}},searchBeneficiaries:async r=>{t({isLoading:!0});try{return await Fi.searchBeneficiaries(r)}catch(n){throw console.error("Error buscando beneficiarios:",n),n}finally{t({isLoading:!1})}},validateBeneficiaryExists:async(r,n)=>{try{return await Fi.validateBeneficiaryExists(r,n)}catch(s){return console.error("Error validando beneficiario:",s),null}},updateBeneficiaryData:async(r,n)=>{t({isLoading:!0});try{const s=await Fi.updateBeneficiary(r,n);return s&&e().updateBeneficiary(r,n),s}catch(s){throw console.error("Error actualizando beneficiario:",s),s}finally{t({isLoading:!1})}},deleteBeneficiaryData:async r=>{t({isLoading:!0});try{const n=await Fi.deleteBeneficiary(r);return n&&e().removeBeneficiary(r),n}catch(n){throw console.error("Error eliminando beneficiario:",n),n}finally{t({isLoading:!1})}},loadUploadHistory:async r=>{try{const n=await Fi.getUploadHistory(r);return t({uploadHistory:n}),n}catch(n){throw console.error("Error cargando historial:",n),n}},findUnassignedBeneficiaries:(r=[])=>{const{beneficiaries:n}=e();if(console.log(" findUnassignedBeneficiaries - beneficiaries:",n.length),console.log(" findUnassignedBeneficiaries - assignments:",r.length),r.length===0)return console.log(" No hay asignaciones para comparar"),n;const s=r.map(a=>({nombre:a.beneficiary||a.nombre||a.beneficiario,telefono:a.phone||a.primaryPhone||a.telefono||a.fono,teleoperadora:a.operator||a.operatorName||a.teleoperadora||a.operador})).filter(a=>a.nombre);console.log(" Asignaciones procesadas:",s.length),console.log(" Primera asignacin:",s[0]);const i=n.filter(a=>!ty(a,s));return console.log(" Beneficiarios sin asignar:",i.length),t(a=>({stats:{...a.stats,unassigned:i.length}})),i},validateAssignmentConsistency:(r=[])=>{const{beneficiaries:n}=e(),s={inAssignmentsNotInBase:[],inBaseNotInAssignments:[],dataConflicts:[]};return r.forEach(i=>{ty(i,n)||s.inAssignmentsNotInBase.push(i)}),s.inBaseNotInAssignments=e().findUnassignedBeneficiaries(r),s},reset:()=>{t({beneficiaries:[],uploadHistory:[],isLoading:!1,isUploading:!1,uploadProgress:0,searchTerm:"",selectedBeneficiary:null,stats:{total:0,withPhones:0,withoutPhones:0,incomplete:0,unassigned:0}})}}),{name:"beneficiary-store",partialize:t=>({beneficiaries:t.beneficiaries,uploadHistory:t.uploadHistory,settings:t.settings,stats:t.stats,shouldReload:t.shouldReload})}));window.zustandStore=Mm;class PZ{constructor(){this.collection="userProfiles",this.rolesCollection="roles"}isSuperAdmin(e){return(e==null?void 0:e.email)==="roberto@mistatas.com"}async diagnoseUserCollection(){var e;try{console.log(" DIAGNSTICO: Iniciando diagnstico de coleccin de usuarios");const r=Nn.currentUser;console.log(" Usuario autenticado:",r==null?void 0:r.email),console.log(" Es super admin:",this.isSuperAdmin(r)),console.log(" Intentando acceso directo a la coleccin...");const n=Pt(We,this.collection),s=await Kr(n);console.log(" Documentos encontrados:",s.size);const i=[];return s.forEach(a=>{var l,c;const o=a.data();i.push({id:a.id,email:o.email,role:o.role,createdAt:((c=(l=o.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||o.createdAt}),console.log(" Doc:",a.id,o)}),{success:!0,authenticated:!!r,userEmail:r==null?void 0:r.email,isSuperAdmin:this.isSuperAdmin(r),collectionExists:!0,documentsCount:s.size,documents:i}}catch(r){return console.error(" Error en diagnstico:",r),{success:!1,error:r.message,errorCode:r.code,authenticated:!!Nn.currentUser,userEmail:(e=Nn.currentUser)==null?void 0:e.email}}}async createTestUsers(){var e;try{console.log(" Creando usuarios de prueba...");const r=[{email:"javiera.reyes@mistatas.com",displayName:"Javiera Reyes Alvarado",role:"teleoperadora",isActive:!0},{email:"admin@mistatas.com",displayName:"Administrador Sistema",role:"admin",isActive:!0}],n=[];for(const s of r)try{const i={uid:`test-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,email:s.email,displayName:s.displayName,role:s.role,isActive:s.isActive,createdAt:Rr(),updatedAt:Rr(),createdBy:(e=Nn.currentUser)==null?void 0:e.uid,lastLogin:null,isTestUser:!0};await Sf(ar(We,this.collection,i.uid),i),console.log(" Usuario de prueba creado:",s.email),n.push({id:i.uid,...i})}catch(i){console.error(" Error creando usuario de prueba:",s.email,i)}return console.log(` Usuarios de prueba creados: ${n.length}`),n}catch(r){throw console.error(" Error en createTestUsers:",r),r}}async cleanTestUsers(){try{console.log(" Limpiando usuarios de prueba...");const e=gr(Pt(We,this.collection),pr("isTestUser","==",!0)),r=await Kr(e),n=[];return r.forEach(s=>{n.push(Qc(s.ref))}),await Promise.all(n),console.log(` ${r.size} usuarios de prueba eliminados`),r.size}catch(e){throw console.error(" Error limpiando usuarios de prueba:",e),e}}async getAllUsers(){var e;try{console.log(" Iniciando carga de usuarios..."),console.log(" Usuario actual:",(e=Nn.currentUser)==null?void 0:e.email),console.log(" Coleccin:",this.collection);const r=gr(Pt(We,this.collection),qo("createdAt","desc"));console.log(" Ejecutando query...");const n=await Kr(r),s=[];return console.log(" Docs encontrados:",n.size),n.forEach(i=>{const a={id:i.id,...i.data()};console.log(" Usuario encontrado:",a),s.push(a)}),console.log(` Total usuarios obtenidos: ${s.length}`),s}catch(r){return console.error(" Error obteniendo usuarios:",r),console.error(" Error code:",r.code),console.error(" Error message:",r.message),[]}}async createUser(e){var r;try{const{email:n,password:s,displayName:i,role:a,isActive:o,...l}=e;if(!this.isSuperAdmin(Nn.currentUser))throw new Error("Sin permisos para esta operacin");if(!n||!i)throw new Error("Email y nombre son requeridos");const c=`profile-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,u={uid:c,email:n.toLowerCase().trim(),displayName:i.trim(),role:a||"teleoperadora",isActive:o!==!1,createdAt:Rr(),updatedAt:Rr(),createdBy:(r=Nn.currentUser)==null?void 0:r.uid,lastLogin:null,authenticationStatus:"pending",profileType:"admin_created",...l};if((await this.getAllUsers()).some(p=>p.email.toLowerCase()===n.toLowerCase()))throw new Error("Ya existe un usuario con este email");return await Sf(ar(We,this.collection,c),u),console.log(" Perfil de usuario creado:",c),console.log(" El usuario deber registrarse en Firebase Auth con el email:",n),{id:c,...u}}catch(n){throw console.error(" Error creando perfil de usuario:",n),new Error(this.getErrorMessage(n))}}async updateUser(e,r){var n;try{const s=ar(We,this.collection,e),i={...r,updatedAt:Rr(),updatedBy:(n=Nn.currentUser)==null?void 0:n.uid};return await Th(s,i),console.log(" Usuario actualizado:",e),i}catch(s){throw console.error(" Error actualizando usuario:",s),new Error("Error al actualizar el usuario")}}async deleteUser(e){var r;try{return await this.updateUser(e,{isActive:!1,deletedAt:Rr(),deletedBy:(r=Nn.currentUser)==null?void 0:r.uid}),console.log(" Usuario eliminado (soft delete):",e),!0}catch(n){throw console.error(" Error eliminando usuario:",n),new Error("Error al eliminar el usuario")}}async getUserProfile(e){try{const r=ar(We,this.collection,e),n=await jp(r);return n.exists()?{id:n.id,...n.data()}:null}catch(r){return console.error(" Error obteniendo perfil:",r),null}}async updateLastLogin(e){try{const r=ar(We,this.collection,e);await Th(r,{lastLogin:Rr()})}catch(r){console.error(" Error actualizando ltimo login:",r)}}async searchUsers(e,r=null){try{let n=Pt(We,this.collection);r&&(n=gr(n,pr("role","==",r)));const s=await Kr(n),i=[];return s.forEach(a=>{var l,c;const o={id:a.id,...a.data()};(!e||(l=o.displayName)!=null&&l.toLowerCase().includes(e.toLowerCase())||(c=o.email)!=null&&c.toLowerCase().includes(e.toLowerCase()))&&i.push(o)}),i}catch(n){return console.error(" Error buscando usuarios:",n),[]}}async getUserStats(){try{const e=await this.getAllUsers(),r={total:e.length,active:e.filter(n=>n.isActive!==!1).length,byRole:{},recentLogins:e.filter(n=>{if(!n.lastLogin)return!1;const s=new Date(n.lastLogin.toDate?n.lastLogin.toDate():n.lastLogin),i=new Date;return i.setDate(i.getDate()-7),s>=i}).length};return e.forEach(n=>{const s=n.role||"sin_rol";r.byRole[s]=(r.byRole[s]||0)+1}),r}catch(e){return console.error(" Error obteniendo estadsticas:",e),{total:0,active:0,byRole:{},recentLogins:0}}}validateUserPermissions(e,r){if(!e)return!1;if(this.isSuperAdmin(e))return!0;const s={super_admin:["all"],admin:["dashboard","calls","assignments","beneficiaries","seguimientos","history","audit","reports"],auditor:["dashboard","history","audit","reports"],teleoperadora:["seguimientos"]}[e.role]||[];return s.includes("all")||s.includes(r)}async createProfileForExistingUser(e,r){var n;try{const s={uid:e.uid,email:e.email,displayName:e.displayName||"",role:r.role||"teleoperadora",isActive:!0,createdAt:Rr(),updatedAt:Rr(),createdBy:(n=Nn.currentUser)==null?void 0:n.uid,lastLogin:null,...r};return await Sf(ar(We,this.collection,e.uid),s),console.log(" Perfil creado para usuario existente:",e.uid),s}catch(s){throw console.error(" Error creando perfil:",s),s}}async migrateExistingUsers(){try{console.log(" Iniciando migracin de usuarios...");const e=[{email:"roberto@mistatas.com",displayName:"Roberto Mistatas",role:"super_admin"}],r=[];for(const n of e)try{(await this.searchUsers(n.email)).length===0&&(console.log("Creando perfil para:",n.email),r.push(n.email))}catch(s){console.error("Error migrando usuario:",n.email,s)}return console.log(` Migracin completada: ${r.length} usuarios migrados`),r}catch(e){throw console.error(" Error en migracin:",e),e}}getErrorMessage(e){return{"auth/email-already-in-use":"El email ya est registrado","auth/invalid-email":"Email invlido","auth/weak-password":"La contrasea es muy dbil","auth/user-not-found":"Usuario no encontrado","permission-denied":"Sin permisos para esta operacin",unavailable:"Servicio no disponible"}[e.code]||e.message||"Error desconocido"}}const jo=new PZ,g3=sd(id((t,e)=>({users:[],roles:[{id:"super_admin",name:"Super Administrador",description:"Acceso completo al sistema",permissions:["all"],level:100,color:"purple"},{id:"admin",name:"Administrador",description:"Gestin completa de teleoperadoras y auditora",permissions:["dashboard","calls","assignments","beneficiaries","seguimientos","history","audit","reports"],level:80,color:"blue"},{id:"auditor",name:"Auditor",description:"Solo auditora y reportes",permissions:["dashboard","history","audit","reports"],level:60,color:"green"},{id:"teleoperadora",name:"Teleoperadora",description:"Solo seguimientos de sus beneficiarios asignados",permissions:["seguimientos"],level:40,color:"orange"}],isLoading:!1,selectedUser:null,searchTerm:"",filterRole:"all",stats:{totalUsers:0,activeUsers:0,usersByRole:{}},setUsers:r=>{const n=e().calculateStats(r);t({users:r||[],stats:n})},loadUsers:async()=>{console.log(" Store: Iniciando carga de usuarios..."),t({isLoading:!0});try{console.log(" Store: Llamando al servicio...");const r=await jo.getAllUsers();console.log(" Store: Usuarios recibidos del servicio:",r.length),e().setUsers(r),console.log(" Store: Usuarios guardados en el estado")}catch(r){console.error(" Store: Error cargando usuarios:",r)}finally{t({isLoading:!1})}},createUser:async r=>{try{const n=await jo.createUser(r);return t(s=>({users:[...s.users,n],stats:e().calculateStats([...s.users,n])})),n}catch(n){throw console.error("Error creando usuario:",n),n}},updateUser:async(r,n)=>{try{const s=await jo.updateUser(r,n);return t(i=>{const a=i.users.map(o=>o.id===r?{...o,...s}:o);return{users:a,stats:e().calculateStats(a)}}),s}catch(s){throw console.error("Error actualizando usuario:",s),s}},deleteUser:async r=>{try{await jo.deleteUser(r),t(n=>{const s=n.users.filter(i=>i.id!==r);return{users:s,stats:e().calculateStats(s)}})}catch(n){throw console.error("Error eliminando usuario:",n),n}},toggleUserStatus:async r=>{const n=e().users.find(s=>s.id===r);if(n)return e().updateUser(r,{isActive:!n.isActive})},setSelectedUser:r=>t({selectedUser:r}),setSearchTerm:r=>t({searchTerm:r}),setFilterRole:r=>t({filterRole:r}),getUsersByRole:r=>e().users.filter(n=>n.role===r),getFilteredUsers:()=>{const{users:r,searchTerm:n,filterRole:s}=e();let i=r;return n&&(i=i.filter(a=>{var o,l;return((o=a.displayName)==null?void 0:o.toLowerCase().includes(n.toLowerCase()))||((l=a.email)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))})),s&&s!=="all"&&(i=i.filter(a=>a.role===s)),i},getRoleById:r=>e().roles.find(n=>n.id===r),getUserPermissions:r=>{const n=e().getRoleById(r==null?void 0:r.role);return(n==null?void 0:n.permissions)||[]},hasPermission:(r,n)=>{const s=e().getUserPermissions(r);return s.includes("all")||s.includes(n)},isSuperAdmin:r=>(r==null?void 0:r.email)==="roberto@mistatas.com"||(r==null?void 0:r.role)==="super_admin",canAccessModule:(r,n)=>e().isSuperAdmin(r)?!0:e().hasPermission(r,n),calculateStats:r=>{const n=r.length,s=r.filter(a=>a.isActive!==!1).length,i={};return r.forEach(a=>{const o=a.role||"sin_rol";i[o]=(i[o]||0)+1}),{totalUsers:n,activeUsers:s,usersByRole:i}},exportUsers:()=>{const r=e().users,n=JSON.stringify(r,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(n),i=`usuarios_${new Date().toISOString().split("T")[0]}.json`,a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",i),a.click()},resetState:()=>{t({users:[],selectedUser:null,searchTerm:"",filterRole:"all",isLoading:!1})}}),{name:"user-management-storage",partialize:t=>({roles:t.roles})})),DZ={ADMIN:"admin"},_A={manualMappings:{ocupado:null,sin_respuesta:null,llamado_exitoso:null,no_identificado:null,busy:null,no_answer:null},excludePatterns:[/^ocupado$/i,/^sin\s+respuesta$/i,/^no\s+identificado$/i,/^llamado\s+exitoso$/i,/^busy$/i,/^no\s+answer$/i,/^\d+$/,/^[A-Z]{2,}$/]};function C0(t){if(!t||typeof t!="string")return"";let e=t;return e=e.toLowerCase(),e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),e=e.replace(/[^\w\s]/g,""),e=e.replace(/\s+/g," ").trim(),e}function FZ(t){if(!t)return!0;const e=C0(t);return _A.manualMappings[e]===null?!0:_A.excludePatterns.some(r=>r.test(t))}function OZ(t,e,r){if(!t||!e||!r)return null;const n=C0(t);for(const[s,i]of Object.entries(e))if(i.find(o=>C0(o)===n)){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"exact"}}for(const[s,i]of Object.entries(e))if(i.find(o=>{const l=C0(o);return l.includes(n)||n.includes(l)})){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"partial"}}return null}function LZ(){const{callData:t,callMetrics:e,processedData:r,isLoading:n,lastUpdated:s,dataSource:i,clearData:a,hasData:o,getSuccessRate:l,getOperatorMetrics:c,getHourlyDistribution:u,getFollowUpData:h}=Sh(),{operators:m,operatorAssignments:p,getAllAssignments:x}=Dn();te.useEffect(()=>{},[r,m,p]);const g=y=>{if(!y||isNaN(y))return"0:00";const I=Math.floor(y/60),O=y%60;return`${I}:${O.toString().padStart(2,"0")}`},v=y=>{if(!y)return"N/A";try{return new Date(y).toLocaleString()}catch{return"N/A"}};c&&c(),u&&u();const w=(()=>{if(console.log(" [AUDIT CRITICAL] === MAPEO INTELIGENTE CON UTILIDADES ==="),console.log(" [AUDIT] Datos disponibles:",(r==null?void 0:r.length)||0),console.log(" [AUDIT] Operadores disponibles:",(m==null?void 0:m.length)||0),console.log(" [AUDIT] Asignaciones disponibles:",p?Object.keys(p).length:0),!r||r.length===0||!m||m.length===0)return console.log(" [AUDIT] Sin datos suficientes para anlisis"),[];const y={};let I=0,O=0,P=0;r.forEach((E,A)=>{const N=E.beneficiario||E.beneficiary||"";A<5&&console.log(` [AUDIT] Llamada ${A}: beneficiario="${N}"`);const C=E.operador||E.operator||E.teleoperadora;C&&FZ(C)&&(P++,A<10&&console.log(` [AUDIT] Excluido estado como operador: "${C}"`));const R=OZ(N,p,m);if(R){I++;const F=R.operatorName;y[F]||(y[F]={operatorInfo:R.operatorInfo,totalCalls:0,successfulCalls:0,totalDuration:0,beneficiaries:new Set,assignedBeneficiaries:0}),y[F].totalCalls++,y[F].beneficiaries.add(N),(E.isSuccessful||E.categoria==="exitosa"||E.resultado==="Llamado exitoso")&&y[F].successfulCalls++,y[F].totalDuration+=E.duracion||0}else O++,A<10&&console.log(` [AUDIT] Llamada sin mapeo: beneficiario="${N}"`)}),console.log(` [AUDIT] Resultado del mapeo: ${I} mapeadas, ${O} sin mapeo, ${P} excluidas`),console.log(" [AUDIT] Operadores con actividad:",Object.keys(y));const S=Object.entries(y).map(([E,A])=>{var F;const N=A.operatorInfo.id,C=((F=p==null?void 0:p[N])==null?void 0:F.length)||0,R=C>0?Math.round(A.totalCalls/C*10)/10:0;return{operatorName:E,operatorInfo:A.operatorInfo,totalCalls:A.totalCalls,assignedBeneficiaries:C,averageCallsPerBeneficiary:R,beneficiariesWithCalls:A.beneficiaries.size,successfulCalls:A.successfulCalls,successRate:A.totalCalls>0?Math.round(A.successfulCalls/A.totalCalls*100):0}});return m&&m.forEach(E=>{var A;if(!y[E.name]){const N=((A=p==null?void 0:p[E.id])==null?void 0:A.length)||0;S.push({operatorName:E.name,operatorInfo:E,totalCalls:0,assignedBeneficiaries:N,averageCallsPerBeneficiary:0,beneficiariesWithCalls:0,successfulCalls:0,successRate:0})}}),console.log(" [AUDIT] Mtricas finales calculadas:",S.length,"operadores"),S.forEach((E,A)=>{console.log(`  ${A+1}. "${E.operatorName}": ${E.totalCalls} llamadas, ${E.assignedBeneficiaries} asignados, ${E.beneficiariesWithCalls} activos`)}),S.sort((E,A)=>A.totalCalls-E.totalCalls)})();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[f.jsx(Ul,{className:"w-6 h-6 text-blue-600"}),"Auditora Avanzada de Llamadas"]}),f.jsxs("p",{className:"text-gray-600",children:["Anlisis detallado y mtricas en tiempo real de todas las llamadas registradas en el sistema. Estado de datos: ",f.jsx("span",{className:"font-semibold",children:o&&o()?"Datos cargados":"Sin datos"}),s&&` | ltima actualizacin: ${v(s)}`]})]}),o&&o()&&f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Total Llamadas"}),f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(e==null?void 0:e.totalCalls)||0})]}),f.jsx(zr,{className:"w-8 h-8 text-blue-500"})]}),f.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Registros procesados"})]}),f.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Tasa de xito"}),f.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l?l():0,"%"]})]}),f.jsx(h1,{className:"w-8 h-8 text-green-500"})]}),f.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Llamadas exitosas"})]}),f.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-purple-800 mb-1",children:"Operadores Activos"}),f.jsx("p",{className:"text-2xl font-bold text-purple-600",children:(w==null?void 0:w.length)||0})]}),f.jsx(Dr,{className:"w-8 h-8 text-purple-500"})]}),f.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Con actividad registrada"})]}),f.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-orange-800 mb-1",children:"Duracin Promedio"}),f.jsx("p",{className:"text-2xl font-bold text-orange-600",children:g((e==null?void 0:e.averageDuration)||0)})]}),f.jsx(Li,{className:"w-8 h-8 text-orange-500"})]}),f.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"Tiempo por llamada"})]})]}),w.length>0&&f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[f.jsx(Dr,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),f.jsx("div",{className:"mb-4",children:!o||!o()?f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),f.jsxs("p",{className:"text-blue-700 text-sm",children:[f.jsx("span",{className:"font-medium",children:"Modo Asignaciones:"})," Mostrando teleoperadoras con sus asignaciones actuales.",f.jsx("span",{className:"font-medium",children:"Carga datos de llamadas"})," para ver mtricas completas."]})]})}):f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),f.jsxs("p",{className:"text-green-700 text-sm",children:[f.jsx("span",{className:"font-medium",children:"Datos Completos:"})," Mostrando mtricas extradas directamente de llamadas."]})]}),!1]})})}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((y,I)=>{var O;return f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow bg-gradient-to-br from-blue-50 to-indigo-50",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:f.jsx(Xa,{className:"w-5 h-5 text-white"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y.operatorName}),f.jsx("p",{className:"text-xs text-gray-500",children:((O=y.operatorInfo)==null?void 0:O.email)||`${y.operatorName.toLowerCase().replace(/\s+/g,".")}@mistatas.com`})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Total Llamadas:"}),f.jsx("span",{className:"font-bold text-lg text-blue-600",children:y.totalCalls})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados:"}),f.jsx("span",{className:"font-medium text-gray-700",children:y.assignedBeneficiaries})]}),y.assignedBeneficiaries>0&&f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Promedio por Beneficiario:"}),f.jsx("span",{className:"font-medium text-gray-700",children:y.averageCallsPerBeneficiary})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Con Actividad:"}),f.jsxs("span",{className:"font-medium text-gray-700",children:[y.beneficiariesWithCalls," / ",y.assignedBeneficiaries]})]}),y.successfulCalls!==void 0&&y.totalCalls>0&&f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Llamadas Exitosas:"}),f.jsxs("span",{className:"font-medium text-green-600",children:[y.successfulCalls," (",y.successRate,"%)"]})]})]}),f.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:o&&o()?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-xs text-gray-500",children:"Rendimiento:"}),f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.totalCalls>=20?"bg-green-100 text-green-800":y.totalCalls>=10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:y.totalCalls>=20?"Alto":y.totalCalls>=10?"Medio":"Bajo"})]}),f.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${y.totalCalls>=20?"bg-green-500":y.totalCalls>=10?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(y.totalCalls/30*100,100)}%`}})})]}):f.jsx("div",{className:"text-center",children:f.jsx("span",{className:"text-xs text-gray-400",children:y.assignedBeneficiaries>0?` ${y.assignedBeneficiaries} beneficiarios asignados`:" Sin asignaciones"})})})]},y.operatorName)})}),f.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[f.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resumen Estadstico"}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Total Teleoperadoras:"}),f.jsx("span",{className:"font-bold text-blue-600 ml-2",children:w.length})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Llamadas Totales:"}),f.jsx("span",{className:"font-bold text-blue-600 ml-2",children:w.reduce((y,I)=>y+I.totalCalls,0)})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Beneficiarios Totales:"}),f.jsx("span",{className:"font-bold text-blue-600 ml-2",children:w.reduce((y,I)=>y+I.assignedBeneficiaries,0)})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-gray-600",children:"Promedio General:"}),f.jsx("span",{className:"font-bold text-blue-600 ml-2",children:w.length>0?Math.round(w.reduce((y,I)=>y+I.totalCalls,0)/w.length*10)/10:0})]})]})]})]}),w.length===0&&f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[f.jsx(Dr,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(vc,{className:"w-5 h-5 text-yellow-500"}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-yellow-800 font-medium",children:"No hay teleoperadoras disponibles"}),f.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Para ver las mtricas por teleoperadora, necesitas:"}),f.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 list-disc list-inside",children:[f.jsx("li",{children:'Crear teleoperadoras en el mdulo "Asignaciones"'}),f.jsx("li",{children:"Asignar beneficiarios a las teleoperadoras"}),f.jsx("li",{children:"Opcionalmente, cargar datos de llamadas para mtricas completas"})]})]})]})})]}),(!o||!o())&&f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[f.jsx(vc,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No hay datos de auditora disponibles"}),f.jsx("p",{className:"text-gray-500 mb-4",children:'Sube un archivo Excel en la seccin "Registro de Llamadas" para comenzar el anlisis de auditora avanzada.'}),f.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:f.jsxs("p",{className:"text-blue-800 text-sm",children:[" ",f.jsx("strong",{children:"Tip:"})," Una vez que subas datos, vers mtricas detalladas, anlisis por operador y distribucin temporal de llamadas."]})})]}),o&&o()&&f.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"text-sm text-gray-600",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Fuente de datos:"})," ",i||"Desconocida"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"ltima actualizacin:"})," ",v(s)]})]}),a&&f.jsx("button",{onClick:a,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:" Limpiar Datos"})]})})]})}class ju extends Pf.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error capturado por ErrorBoundary:",e,r)}render(){return this.state.hasError?f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 m-4",children:[f.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error en la aplicacin"}),f.jsx("p",{className:"text-red-600 mb-4",children:"Ha ocurrido un error inesperado. Por favor, recarga la pgina."}),f.jsxs("details",{className:"text-sm text-red-700",children:[f.jsx("summary",{className:"cursor-pointer",children:"Detalles tcnicos"}),f.jsx("pre",{className:"mt-2 whitespace-pre-wrap",children:this.state.error&&this.state.error.toString()})]}),f.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Recargar pgina"})]}):this.props.children}}const MZ="modulepreload",jZ=function(t){return"/centralteleoperadores/"+t},EA={},I0=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=jZ(l),l in EA)return;EA[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":MZ,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},r_=te.createContext({});function n_(t){const e=te.useRef(null);return e.current===null&&(e.current=t()),e.current}const s_=typeof window<"u",x3=s_?te.useLayoutEffect:te.useEffect,$p=te.createContext(null);function i_(t,e){t.indexOf(e)===-1&&t.push(e)}function a_(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const na=(t,e,r)=>r>e?e:r<t?t:r;let o_=()=>{};const sa={},y3=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function v3(t){return typeof t=="object"&&t!==null}const w3=t=>/^0[^.\s]+$/u.test(t);function l_(t){let e;return()=>(e===void 0&&(e=t()),e)}const As=t=>t,VZ=(t,e)=>r=>e(t(r)),ad=(...t)=>t.reduce(VZ),Ah=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class c_{constructor(){this.subscriptions=[]}add(e){return i_(this.subscriptions,e),()=>a_(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const _i=t=>t*1e3,Ei=t=>t/1e3;function _3(t,e){return e?t*(1e3/e):0}const E3=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,BZ=1e-7,UZ=12;function $Z(t,e,r,n,s){let i,a,o=0;do a=e+(r-e)/2,i=E3(a,n,s)-t,i>0?r=a:e=a;while(Math.abs(i)>BZ&&++o<UZ);return a}function od(t,e,r,n){if(t===e&&r===n)return As;const s=i=>$Z(i,0,1,t,r);return i=>i===0||i===1?i:E3(s(i),e,n)}const T3=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,S3=t=>e=>1-t(1-e),A3=od(.33,1.53,.69,.99),u_=S3(A3),k3=T3(u_),b3=t=>(t*=2)<1?.5*u_(t):.5*(2-Math.pow(2,-10*(t-1))),f_=t=>1-Math.sin(Math.acos(t)),C3=S3(f_),I3=T3(f_),zZ=od(.42,0,1,1),HZ=od(0,0,.58,1),N3=od(.42,0,.58,1),WZ=t=>Array.isArray(t)&&typeof t[0]!="number",R3=t=>Array.isArray(t)&&typeof t[0]=="number",GZ={linear:As,easeIn:zZ,easeInOut:N3,easeOut:HZ,circIn:f_,circInOut:I3,circOut:C3,backIn:u_,backInOut:k3,backOut:A3,anticipate:b3},qZ=t=>typeof t=="string",TA=t=>{if(R3(t)){o_(t.length===4);const[e,r,n,s]=t;return od(e,r,n,s)}else if(qZ(t))return GZ[t];return t},t0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function KZ(t,e){let r=new Set,n=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(u){a.has(u)&&(c.schedule(u),t()),u(o)}const c={schedule:(u,h=!1,m=!1)=>{const x=m&&s?r:n;return h&&a.add(u),x.has(u)||x.add(u),u},cancel:u=>{n.delete(u),a.delete(u)},process:u=>{if(o=u,s){i=!0;return}s=!0,[r,n]=[n,r],r.forEach(l),r.clear(),s=!1,i&&(i=!1,c.process(u))}};return c}const XZ=40;function P3(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,a=t0.reduce((y,I)=>(y[I]=KZ(i),y),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:h,preRender:m,render:p,postRender:x}=a,g=()=>{const y=sa.useManualTiming?s.timestamp:performance.now();r=!1,sa.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(y-s.timestamp,XZ),1)),s.timestamp=y,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),h.process(s),m.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(g))},v=()=>{r=!0,n=!0,s.isProcessing||t(g)};return{schedule:t0.reduce((y,I)=>{const O=a[I];return y[I]=(P,S=!1,E=!1)=>(r||v(),O.schedule(P,S,E)),y},{}),cancel:y=>{for(let I=0;I<t0.length;I++)a[t0[I]].cancel(y)},state:s,steps:a}}const{schedule:Vt,cancel:oo,state:$r,steps:tx}=P3(typeof requestAnimationFrame<"u"?requestAnimationFrame:As,!0);let N0;function YZ(){N0=void 0}const Mn={now:()=>(N0===void 0&&Mn.set($r.isProcessing||sa.useManualTiming?$r.timestamp:performance.now()),N0),set:t=>{N0=t,queueMicrotask(YZ)}},D3=t=>e=>typeof e=="string"&&e.startsWith(t),h_=D3("--"),QZ=D3("var(--"),d_=t=>QZ(t)?JZ.test(t.split("/*")[0].trim()):!1,JZ=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,pu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},kh={...pu,transform:t=>na(0,1,t)},r0={...pu,default:1},bf=t=>Math.round(t*1e5)/1e5,m_=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ZZ(t){return t==null}const eee=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,p_=(t,e)=>r=>!!(typeof r=="string"&&eee.test(r)&&r.startsWith(t)||e&&!ZZ(r)&&Object.prototype.hasOwnProperty.call(r,e)),F3=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,i,a,o]=n.match(m_);return{[t]:parseFloat(s),[e]:parseFloat(i),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},tee=t=>na(0,255,t),rx={...pu,transform:t=>Math.round(tee(t))},Vo={test:p_("rgb","red"),parse:F3("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+rx.transform(t)+", "+rx.transform(e)+", "+rx.transform(r)+", "+bf(kh.transform(n))+")"};function ree(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const ry={test:p_("#"),parse:ree,transform:Vo.transform},ld=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),wa=ld("deg"),Ti=ld("%"),Ue=ld("px"),nee=ld("vh"),see=ld("vw"),SA={...Ti,parse:t=>Ti.parse(t)/100,transform:t=>Ti.transform(t*100)},lc={test:p_("hsl","hue"),parse:F3("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Ti.transform(bf(e))+", "+Ti.transform(bf(r))+", "+bf(kh.transform(n))+")"},xr={test:t=>Vo.test(t)||ry.test(t)||lc.test(t),parse:t=>Vo.test(t)?Vo.parse(t):lc.test(t)?lc.parse(t):ry.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Vo.transform(t):lc.transform(t),getAnimatableNone:t=>{const e=xr.parse(t);return e.alpha=0,xr.transform(e)}},iee=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function aee(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(m_))==null?void 0:e.length)||0)+(((r=t.match(iee))==null?void 0:r.length)||0)>0}const O3="number",L3="color",oee="var",lee="var(",AA="${}",cee=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function bh(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let i=0;const o=e.replace(cee,l=>(xr.test(l)?(n.color.push(i),s.push(L3),r.push(xr.parse(l))):l.startsWith(lee)?(n.var.push(i),s.push(oee),r.push(l)):(n.number.push(i),s.push(O3),r.push(parseFloat(l))),++i,AA)).split(AA);return{values:r,split:o,indexes:n,types:s}}function M3(t){return bh(t).values}function j3(t){const{split:e,types:r}=bh(t),n=e.length;return s=>{let i="";for(let a=0;a<n;a++)if(i+=e[a],s[a]!==void 0){const o=r[a];o===O3?i+=bf(s[a]):o===L3?i+=xr.transform(s[a]):i+=s[a]}return i}}const uee=t=>typeof t=="number"?0:xr.test(t)?xr.getAnimatableNone(t):t;function fee(t){const e=M3(t);return j3(t)(e.map(uee))}const lo={test:aee,parse:M3,createTransformer:j3,getAnimatableNone:fee};function nx(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hee({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,i=0,a=0;if(!e)s=i=a=r;else{const o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;s=nx(l,o,t+1/3),i=nx(l,o,t),a=nx(l,o,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}function jm(t,e){return r=>r>0?e:t}const $t=(t,e,r)=>t+(e-t)*r,sx=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},dee=[ry,Vo,lc],mee=t=>dee.find(e=>e.test(t));function kA(t){const e=mee(t);if(!e)return!1;let r=e.parse(t);return e===lc&&(r=hee(r)),r}const bA=(t,e)=>{const r=kA(t),n=kA(e);if(!r||!n)return jm(t,e);const s={...r};return i=>(s.red=sx(r.red,n.red,i),s.green=sx(r.green,n.green,i),s.blue=sx(r.blue,n.blue,i),s.alpha=$t(r.alpha,n.alpha,i),Vo.transform(s))},ny=new Set(["none","hidden"]);function pee(t,e){return ny.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function gee(t,e){return r=>$t(t,e,r)}function g_(t){return typeof t=="number"?gee:typeof t=="string"?d_(t)?jm:xr.test(t)?bA:vee:Array.isArray(t)?V3:typeof t=="object"?xr.test(t)?bA:xee:jm}function V3(t,e){const r=[...t],n=r.length,s=t.map((i,a)=>g_(i)(i,e[a]));return i=>{for(let a=0;a<n;a++)r[a]=s[a](i);return r}}function xee(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=g_(t[s])(t[s],e[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}}function yee(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],a=t.indexes[i][n[i]],o=t.values[a]??0;r[s]=o,n[i]++}return r}const vee=(t,e)=>{const r=lo.createTransformer(e),n=bh(t),s=bh(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?ny.has(t)&&!s.values.length||ny.has(e)&&!n.values.length?pee(t,e):ad(V3(yee(n,s),s.values),r):jm(t,e)};function B3(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?$t(t,e,r):g_(t)(t,e)}const wee=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>Vt.update(e,r),stop:()=>oo(e),now:()=>$r.isProcessing?$r.timestamp:Mn.now()}},U3=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let i=0;i<s;i++)n+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Vm=2e4;function x_(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<Vm;)e+=r,n=t.next(e);return e>=Vm?1/0:e}function _ee(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(x_(n),Vm);return{type:"keyframes",ease:i=>n.next(s*i).value/e,duration:Ei(s)}}const Eee=5;function $3(t,e,r){const n=Math.max(e-Eee,0);return _3(r-t(n),e-n)}const Qt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ix=.001;function Tee({duration:t=Qt.duration,bounce:e=Qt.bounce,velocity:r=Qt.velocity,mass:n=Qt.mass}){let s,i,a=1-e;a=na(Qt.minDamping,Qt.maxDamping,a),t=na(Qt.minDuration,Qt.maxDuration,Ei(t)),a<1?(s=c=>{const u=c*a,h=u*t,m=u-r,p=sy(c,a),x=Math.exp(-h);return ix-m/p*x},i=c=>{const h=c*a*t,m=h*r+r,p=Math.pow(a,2)*Math.pow(c,2)*t,x=Math.exp(-h),g=sy(Math.pow(c,2),a);return(-s(c)+ix>0?-1:1)*((m-p)*x)/g}):(s=c=>{const u=Math.exp(-c*t),h=(c-r)*t+1;return-ix+u*h},i=c=>{const u=Math.exp(-c*t),h=(r-c)*(t*t);return u*h});const o=5/t,l=Aee(s,i,o);if(t=_i(t),isNaN(l))return{stiffness:Qt.stiffness,damping:Qt.damping,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:a*2*Math.sqrt(n*c),duration:t}}}const See=12;function Aee(t,e,r){let n=r;for(let s=1;s<See;s++)n=n-t(n)/e(n);return n}function sy(t,e){return t*Math.sqrt(1-e*e)}const kee=["duration","bounce"],bee=["stiffness","damping","mass"];function CA(t,e){return e.some(r=>t[r]!==void 0)}function Cee(t){let e={velocity:Qt.velocity,stiffness:Qt.stiffness,damping:Qt.damping,mass:Qt.mass,isResolvedFromDuration:!1,...t};if(!CA(t,bee)&&CA(t,kee))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,i=2*na(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Qt.mass,stiffness:s,damping:i}}else{const r=Tee(t);e={...e,...r,mass:Qt.mass},e.isResolvedFromDuration=!0}return e}function Bm(t=Qt.visualDuration,e=Qt.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const i=r.keyframes[0],a=r.keyframes[r.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:h,velocity:m,isResolvedFromDuration:p}=Cee({...r,velocity:-Ei(r.velocity||0)}),x=m||0,g=c/(2*Math.sqrt(l*u)),v=a-i,_=Ei(Math.sqrt(l/u)),w=Math.abs(v)<5;n||(n=w?Qt.restSpeed.granular:Qt.restSpeed.default),s||(s=w?Qt.restDelta.granular:Qt.restDelta.default);let y;if(g<1){const O=sy(_,g);y=P=>{const S=Math.exp(-g*_*P);return a-S*((x+g*_*v)/O*Math.sin(O*P)+v*Math.cos(O*P))}}else if(g===1)y=O=>a-Math.exp(-_*O)*(v+(x+_*v)*O);else{const O=_*Math.sqrt(g*g-1);y=P=>{const S=Math.exp(-g*_*P),E=Math.min(O*P,300);return a-S*((x+g*_*v)*Math.sinh(E)+O*v*Math.cosh(E))/O}}const I={calculatedDuration:p&&h||null,next:O=>{const P=y(O);if(p)o.done=O>=h;else{let S=O===0?x:0;g<1&&(S=O===0?_i(x):$3(y,O,P));const E=Math.abs(S)<=n,A=Math.abs(a-P)<=s;o.done=E&&A}return o.value=o.done?a:P,o},toString:()=>{const O=Math.min(x_(I),Vm),P=U3(S=>I.next(O*S).value,O,30);return O+"ms "+P},toTransition:()=>{}};return I}Bm.applyToOptions=t=>{const e=_ee(t,100,Bm);return t.ease=e.ease,t.duration=_i(e.duration),t.type="keyframes",t};function iy({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],m={done:!1,value:h},p=E=>o!==void 0&&E<o||l!==void 0&&E>l,x=E=>o===void 0?l:l===void 0||Math.abs(o-E)<Math.abs(l-E)?o:l;let g=r*e;const v=h+g,_=a===void 0?v:a(v);_!==v&&(g=_-h);const w=E=>-g*Math.exp(-E/n),y=E=>_+w(E),I=E=>{const A=w(E),N=y(E);m.done=Math.abs(A)<=c,m.value=m.done?_:N};let O,P;const S=E=>{p(m.value)&&(O=E,P=Bm({keyframes:[m.value,x(m.value)],velocity:$3(y,E,m.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return S(0),{calculatedDuration:null,next:E=>{let A=!1;return!P&&O===void 0&&(A=!0,I(E),S(E)),O!==void 0&&E>=O?P.next(E-O):(!A&&I(E),m)}}}function Iee(t,e,r){const n=[],s=r||sa.mix||B3,i=t.length-1;for(let a=0;a<i;a++){let o=s(t[a],t[a+1]);if(e){const l=Array.isArray(e)?e[a]||As:e;o=ad(l,o)}n.push(o)}return n}function Nee(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const i=t.length;if(o_(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Iee(e,n,s),l=o.length,c=u=>{if(a&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const m=Ah(t[h],t[h+1],u);return o[h](m)};return r?u=>c(na(t[0],t[i-1],u)):c}function Ree(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=Ah(0,e,n);t.push($t(r,1,s))}}function Pee(t){const e=[0];return Ree(e,t.length-1),e}function Dee(t,e){return t.map(r=>r*e)}function Fee(t,e){return t.map(()=>e||N3).splice(0,t.length-1)}function Cf({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=WZ(n)?n.map(TA):TA(n),i={done:!1,value:e[0]},a=Dee(r&&r.length===e.length?r:Pee(e),t),o=Nee(a,e,{ease:Array.isArray(s)?s:Fee(e,s)});return{calculatedDuration:t,next:l=>(i.value=o(l),i.done=l>=t,i)}}const Oee=t=>t!==null;function y_(t,{repeat:e,repeatType:r="loop"},n,s=1){const i=t.filter(Oee),o=s<0||e&&r!=="loop"&&e%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const Lee={decay:iy,inertia:iy,tween:Cf,keyframes:Cf,spring:Bm};function z3(t){typeof t.type=="string"&&(t.type=Lee[t.type])}class v_{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const Mee=t=>t/100;class w_ extends v_{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==Mn.now()&&this.tick(Mn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;z3(e);const{type:r=Cf,repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=e;let{keyframes:o}=e;const l=r||Cf;l!==Cf&&typeof o[0]!="number"&&(this.mixKeyframes=ad(Mee,B3(o[0],o[1])),o=[0,100]);const c=l({...e,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=x_(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=c}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:u,repeat:h,repeatType:m,repeatDelay:p,type:x,onUpdate:g,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const _=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?_<0:_>s;this.currentTime=Math.max(_,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let y=this.currentTime,I=n;if(h){const E=Math.min(this.currentTime,s)/o;let A=Math.floor(E),N=E%1;!N&&E>=1&&(N=1),N===1&&A--,A=Math.min(A,h+1),!!(A%2)&&(m==="reverse"?(N=1-N,p&&(N-=p/o)):m==="mirror"&&(I=a)),y=na(0,1,N)*o}const O=w?{done:!1,value:u[0]}:I.next(y);i&&(O.value=i(O.value));let{done:P}=O;!w&&l!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return S&&x!==iy&&(O.value=y_(u,this.options,v,this.speed)),g&&g(O.value),S&&this.finish(),O}then(e,r){return this.finished.then(e,r)}get duration(){return Ei(this.calculatedDuration)}get time(){return Ei(this.currentTime)}set time(e){var r;e=_i(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Mn.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Ei(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=wee,startTime:r}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(i=(s=this.options).onPlay)==null||i.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Mn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function jee(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Bo=t=>t*180/Math.PI,ay=t=>{const e=Bo(Math.atan2(t[1],t[0]));return oy(e)},Vee={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:ay,rotateZ:ay,skewX:t=>Bo(Math.atan(t[1])),skewY:t=>Bo(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},oy=t=>(t=t%360,t<0&&(t+=360),t),IA=ay,NA=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),RA=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Bee={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:NA,scaleY:RA,scale:t=>(NA(t)+RA(t))/2,rotateX:t=>oy(Bo(Math.atan2(t[6],t[5]))),rotateY:t=>oy(Bo(Math.atan2(-t[2],t[0]))),rotateZ:IA,rotate:IA,skewX:t=>Bo(Math.atan(t[4])),skewY:t=>Bo(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function ly(t){return t.includes("scale")?1:0}function cy(t,e){if(!t||t==="none")return ly(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Bee,s=r;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Vee,s=o}if(!s)return ly(e);const i=n[e],a=s[1].split(",").map($ee);return typeof i=="function"?i(a):a[i]}const Uee=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return cy(r,e)};function $ee(t){return parseFloat(t.trim())}const gu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xu=new Set(gu),PA=t=>t===pu||t===Ue,zee=new Set(["x","y","z"]),Hee=gu.filter(t=>!zee.has(t));function Wee(t){const e=[];return Hee.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Xo={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>cy(e,"x"),y:(t,{transform:e})=>cy(e,"y")};Xo.translateX=Xo.x;Xo.translateY=Xo.y;const Yo=new Set;let uy=!1,fy=!1,hy=!1;function H3(){if(fy){const t=Array.from(Yo).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=Wee(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([i,a])=>{var o;(o=n.getValue(i))==null||o.set(a)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}fy=!1,uy=!1,Yo.forEach(t=>t.complete(hy)),Yo.clear()}function W3(){Yo.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(fy=!0)})}function Gee(){hy=!0,W3(),H3(),hy=!1}class __{constructor(e,r,n,s,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(Yo.add(this),uy||(uy=!0,Vt.read(W3),Vt.resolveKeyframes(H3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(n&&r){const o=n.readValue(r,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}jee(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Yo.delete(this)}cancel(){this.state==="scheduled"&&(Yo.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const qee=t=>t.startsWith("--");function Kee(t,e,r){qee(e)?t.style.setProperty(e,r):t.style[e]=r}const Xee=l_(()=>window.ScrollTimeline!==void 0),Yee={};function Qee(t,e){const r=l_(t);return()=>Yee[e]??r()}const G3=Qee(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Zu=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,DA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Zu([0,.65,.55,1]),circOut:Zu([.55,0,1,.45]),backIn:Zu([.31,.01,.66,-.59]),backOut:Zu([.33,1.53,.69,.99])};function q3(t,e){if(t)return typeof t=="function"?G3()?U3(t,e):"ease-out":R3(t)?Zu(t):Array.isArray(t)?t.map(r=>q3(r,e)||DA.easeOut):DA[t]}function Jee(t,e,r,{delay:n=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[e]:r};l&&(u.offset=l);const h=q3(o,s);Array.isArray(h)&&(u.easing=h);const m={delay:n,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),t.animate(u,m)}function K3(t){return typeof t=="function"&&"applyToOptions"in t}function Zee({type:t,...e}){return K3(t)&&G3()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class ete extends v_{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=e,o_(typeof e.type!="string");const c=Zee(e);this.animation=Jee(r,n,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=y_(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):Kee(r,n,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Ei(Number(e))}get time(){return Ei(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=_i(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&Xee()?(this.animation.timeline=e,As):r(this)}}const X3={anticipate:b3,backInOut:k3,circInOut:I3};function tte(t){return t in X3}function rte(t){typeof t.ease=="string"&&tte(t.ease)&&(t.ease=X3[t.ease])}const FA=10;class nte extends ete{constructor(e){rte(e),z3(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:i,...a}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const o=new w_({...a,autoplay:!1}),l=_i(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-FA).value,o.sample(l).value,FA),o.stop()}}const OA=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(lo.test(t)||t==="0")&&!t.startsWith("url("));function ste(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function ite(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],a=OA(s,e),o=OA(i,e);return!a||!o?!1:ste(t)||(r==="spring"||K3(r))&&n}function dy(t){t.duration=0,t.type}const ate=new Set(["opacity","clipPath","filter","transform"]),ote=l_(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function lte(t){var u;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:i,type:a}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return ote()&&r&&ate.has(r)&&(r!=="transform"||!c)&&!l&&!n&&s!=="mirror"&&i!==0&&a!=="inertia"}const cte=40;class ute extends v_{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...h}){var x;super(),this.stop=()=>{var g,v;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Mn.now();const m={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...h},p=(u==null?void 0:u.KeyframeResolver)||__;this.keyframeResolver=new p(o,(g,v,_)=>this.onKeyframesResolved(g,v,m,!_),l,c,u),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=n;this.resolvedAt=Mn.now(),ite(e,i,a,o)||((sa.instantAnimations||!l)&&(u==null||u(y_(e,n,r))),e[0]=e[e.length-1],dy(n),n.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>cte?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},p=!c&&lte(m)?new nte({...m,element:m.motionValue.owner.current}):new w_(m);p.finished.then(()=>this.notifyFinished()).catch(As),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Gee()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const fte=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function hte(t){const e=fte.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function Y3(t,e,r=1){const[n,s]=hte(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const a=i.trim();return y3(a)?parseFloat(a):a}return d_(s)?Y3(s,e,r+1):s}function E_(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const Q3=new Set(["width","height","top","left","right","bottom",...gu]),dte={test:t=>t==="auto",parse:t=>t},J3=t=>e=>e.test(t),Z3=[pu,Ue,Ti,wa,see,nee,dte],LA=t=>Z3.find(J3(t));function mte(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||w3(t):!0}const pte=new Set(["brightness","contrast","saturate","opacity"]);function gte(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(m_)||[];if(!n)return t;const s=r.replace(n,"");let i=pte.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+s+")"}const xte=/\b([a-z-]*)\(.*?\)/gu,my={...lo,getAnimatableNone:t=>{const e=t.match(xte);return e?e.map(gte).join(" "):t}},MA={...pu,transform:Math.round},yte={rotate:wa,rotateX:wa,rotateY:wa,rotateZ:wa,scale:r0,scaleX:r0,scaleY:r0,scaleZ:r0,skew:wa,skewX:wa,skewY:wa,distance:Ue,translateX:Ue,translateY:Ue,translateZ:Ue,x:Ue,y:Ue,z:Ue,perspective:Ue,transformPerspective:Ue,opacity:kh,originX:SA,originY:SA,originZ:Ue},T_={borderWidth:Ue,borderTopWidth:Ue,borderRightWidth:Ue,borderBottomWidth:Ue,borderLeftWidth:Ue,borderRadius:Ue,radius:Ue,borderTopLeftRadius:Ue,borderTopRightRadius:Ue,borderBottomRightRadius:Ue,borderBottomLeftRadius:Ue,width:Ue,maxWidth:Ue,height:Ue,maxHeight:Ue,top:Ue,right:Ue,bottom:Ue,left:Ue,padding:Ue,paddingTop:Ue,paddingRight:Ue,paddingBottom:Ue,paddingLeft:Ue,margin:Ue,marginTop:Ue,marginRight:Ue,marginBottom:Ue,marginLeft:Ue,backgroundPositionX:Ue,backgroundPositionY:Ue,...yte,zIndex:MA,fillOpacity:kh,strokeOpacity:kh,numOctaves:MA},vte={...T_,color:xr,backgroundColor:xr,outlineColor:xr,fill:xr,stroke:xr,borderColor:xr,borderTopColor:xr,borderRightColor:xr,borderBottomColor:xr,borderLeftColor:xr,filter:my,WebkitFilter:my},eD=t=>vte[t];function tD(t,e){let r=eD(t);return r!==my&&(r=lo),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const wte=new Set(["auto","none","0"]);function _te(t,e,r){let n=0,s;for(;n<t.length&&!s;){const i=t[n];typeof i=="string"&&!wte.has(i)&&bh(i).values.length&&(s=t[n]),n++}if(s&&r)for(const i of e)t[i]=tD(r,s)}class Ete extends __{constructor(e,r,n,s,i){super(e,r,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),d_(c))){const u=Y3(c,r.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Q3.has(n)||e.length!==2)return;const[s,i]=e,a=LA(s),o=LA(i);if(a!==o)if(PA(a)&&PA(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else Xo[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||mte(e[s]))&&n.push(s);n.length&&_te(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Xo[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var o;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const i=n.length-1,a=n[i];n[i]=Xo[r](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function Tte(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=(r==null?void 0:r[t])??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const rD=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function nD(t){return v3(t)&&"offsetHeight"in t}const jA=30,Ste=t=>!isNaN(parseFloat(t));class Ate{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var i;const s=Mn.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Mn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Ste(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new c_);const n=this.events[e].add(r);return e==="change"?()=>{n(),Vt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Mn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>jA)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,jA);return _3(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Jc(t,e){return new Ate(t,e)}const{schedule:S_}=P3(queueMicrotask,!1),js={x:!1,y:!1};function sD(){return js.x||js.y}function kte(t){return t==="x"||t==="y"?js[t]?null:(js[t]=!0,()=>{js[t]=!1}):js.x||js.y?null:(js.x=js.y=!0,()=>{js.x=js.y=!1})}function iD(t,e){const r=Tte(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function VA(t){return!(t.pointerType==="touch"||sD())}function bte(t,e,r={}){const[n,s,i]=iD(t,r),a=o=>{if(!VA(o))return;const{target:l}=o,c=e(l,o);if(typeof c!="function"||!l)return;const u=h=>{VA(h)&&(c(h),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return n.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}const aD=(t,e)=>e?t===e?!0:aD(t,e.parentElement):!1,A_=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Cte=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Ite(t){return Cte.has(t.tagName)||t.tabIndex!==-1}const R0=new WeakSet;function BA(t){return e=>{e.key==="Enter"&&t(e)}}function ax(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Nte=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=BA(()=>{if(R0.has(r))return;ax(r,"down");const s=BA(()=>{ax(r,"up")}),i=()=>ax(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",i,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function UA(t){return A_(t)&&!sD()}function Rte(t,e,r={}){const[n,s,i]=iD(t,r),a=o=>{const l=o.currentTarget;if(!UA(o))return;R0.add(l);const c=e(l,o),u=(p,x)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",m),R0.has(l)&&R0.delete(l),UA(p)&&typeof c=="function"&&c(p,{success:x})},h=p=>{u(p,l===window||l===document||r.useGlobalTarget||aD(l,p.target))},m=p=>{u(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",m,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),nD(o)&&(o.addEventListener("focus",c=>Nte(c,s)),!Ite(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function oD(t){return v3(t)&&"ownerSVGElement"in t}function Pte(t){return oD(t)&&t.tagName==="svg"}const hn=t=>!!(t&&t.getVelocity),Dte=[...Z3,xr,lo],Fte=t=>Dte.find(J3(t)),k_=te.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class Ote extends te.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=nD(n)&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Lte({children:t,isPresent:e,anchorX:r,root:n}){const s=te.useId(),i=te.useRef(null),a=te.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=te.useContext(k_);return te.useInsertionEffect(()=>{const{width:l,height:c,top:u,left:h,right:m}=a.current;if(e||!i.current||!l||!c)return;const p=r==="left"?`left: ${h}`:`right: ${m}`;i.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const g=n??document.head;return g.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${p}px !important;
            top: ${u}px !important;
          }
        `),()=>{g.contains(x)&&g.removeChild(x)}},[e]),f.jsx(Ote,{isPresent:e,childRef:i,sizeRef:a,children:te.cloneElement(t,{ref:i})})}const Mte=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o,root:l})=>{const c=n_(jte),u=te.useId();let h=!0,m=te.useMemo(()=>(h=!1,{id:u,initial:e,isPresent:r,custom:s,onExitComplete:p=>{c.set(p,!0);for(const x of c.values())if(!x)return;n&&n()},register:p=>(c.set(p,!1),()=>c.delete(p))}),[r,c,n]);return i&&h&&(m={...m}),te.useMemo(()=>{c.forEach((p,x)=>c.set(x,!1))},[r]),te.useEffect(()=>{!r&&!c.size&&n&&n()},[r]),a==="popLayout"&&(t=f.jsx(Lte,{isPresent:r,anchorX:o,root:l,children:t})),f.jsx($p.Provider,{value:m,children:t})};function jte(){return new Map}function lD(t=!0){const e=te.useContext($p);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,i=te.useId();te.useEffect(()=>{if(t)return s(i)},[t]);const a=te.useCallback(()=>t&&n&&n(i),[i,n,t]);return!r&&n?[!1,a]:[!0]}const n0=t=>t.key||"";function $A(t){const e=[];return te.Children.forEach(t,r=>{te.isValidElement(r)&&e.push(r)}),e}const pl=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left",root:l})=>{const[c,u]=lD(a),h=te.useMemo(()=>$A(t),[t]),m=a&&!c?[]:h.map(n0),p=te.useRef(!0),x=te.useRef(h),g=n_(()=>new Map),[v,_]=te.useState(h),[w,y]=te.useState(h);x3(()=>{p.current=!1,x.current=h;for(let P=0;P<w.length;P++){const S=n0(w[P]);m.includes(S)?g.delete(S):g.get(S)!==!0&&g.set(S,!1)}},[w,m.length,m.join("-")]);const I=[];if(h!==v){let P=[...h];for(let S=0;S<w.length;S++){const E=w[S],A=n0(E);m.includes(A)||(P.splice(S,0,E),I.push(E))}return i==="wait"&&I.length&&(P=I),y($A(P)),_(h),null}const{forceRender:O}=te.useContext(r_);return f.jsx(f.Fragment,{children:w.map(P=>{const S=n0(P),E=a&&!c?!1:h===w||m.includes(S),A=()=>{if(g.has(S))g.set(S,!0);else return;let N=!0;g.forEach(C=>{C||(N=!1)}),N&&(O==null||O(),y(x.current),a&&(u==null||u()),n&&n())};return f.jsx(Mte,{isPresent:E,initial:!p.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:l,onExitComplete:E?void 0:A,anchorX:o,children:P},S)})})},cD=te.createContext({strict:!1}),zA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Zc={};for(const t in zA)Zc[t]={isEnabled:e=>zA[t].some(r=>!!e[r])};function Vte(t){for(const e in t)Zc[e]={...Zc[e],...t[e]}}const Bte=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Um(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Bte.has(t)}let uD=t=>!Um(t);function Ute(t){typeof t=="function"&&(uD=e=>e.startsWith("on")?!Um(e):t(e))}try{Ute(require("@emotion/is-prop-valid").default)}catch{}function $te(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(uD(s)||r===!0&&Um(s)||!e&&!Um(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const zp=te.createContext({});function Hp(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ch(t){return typeof t=="string"||Array.isArray(t)}const b_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],C_=["initial",...b_];function Wp(t){return Hp(t.animate)||C_.some(e=>Ch(t[e]))}function fD(t){return!!(Wp(t)||t.variants)}function zte(t,e){if(Wp(t)){const{initial:r,animate:n}=t;return{initial:r===!1||Ch(r)?r:void 0,animate:Ch(n)?n:void 0}}return t.inherit!==!1?e:{}}function Hte(t){const{initial:e,animate:r}=zte(t,te.useContext(zp));return te.useMemo(()=>({initial:e,animate:r}),[HA(e),HA(r)])}function HA(t){return Array.isArray(t)?t.join(" "):t}const Ih={};function Wte(t){for(const e in t)Ih[e]=t[e],h_(e)&&(Ih[e].isCSSVariable=!0)}function hD(t,{layout:e,layoutId:r}){return xu.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Ih[t]||t==="opacity")}const Gte={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qte=gu.length;function Kte(t,e,r){let n="",s=!0;for(let i=0;i<qte;i++){const a=gu[i],o=t[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const c=rD(o,T_[a]);if(!l){s=!1;const u=Gte[a]||a;n+=`${u}(${c}) `}r&&(e[a]=c)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function I_(t,e,r){const{style:n,vars:s,transformOrigin:i}=t;let a=!1,o=!1;for(const l in e){const c=e[l];if(xu.has(l)){a=!0;continue}else if(h_(l)){s[l]=c;continue}else{const u=rD(c,T_[l]);l.startsWith("origin")?(o=!0,i[l]=u):n[l]=u}}if(e.transform||(a||r?n.transform=Kte(e,t.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;n.transformOrigin=`${l} ${c} ${u}`}}const N_=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function dD(t,e,r){for(const n in e)!hn(e[n])&&!hD(n,r)&&(t[n]=e[n])}function Xte({transformTemplate:t},e){return te.useMemo(()=>{const r=N_();return I_(r,e,t),Object.assign({},r.vars,r.style)},[e])}function Yte(t,e){const r=t.style||{},n={};return dD(n,r,t),Object.assign(n,Xte(t,e)),n}function Qte(t,e){const r={},n=Yte(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const Jte={offset:"stroke-dashoffset",array:"stroke-dasharray"},Zte={offset:"strokeDashoffset",array:"strokeDasharray"};function ere(t,e,r=1,n=0,s=!0){t.pathLength=1;const i=s?Jte:Zte;t[i.offset]=Ue.transform(-n);const a=Ue.transform(e),o=Ue.transform(r);t[i.array]=`${a} ${o}`}function mD(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(I_(t,o,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:m}=t;h.transform&&(m.transform=h.transform,delete h.transform),(m.transform||h.transformOrigin)&&(m.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),m.transform&&(m.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&ere(h,s,i,a,!1)}const pD=()=>({...N_(),attrs:{}}),gD=t=>typeof t=="string"&&t.toLowerCase()==="svg";function tre(t,e,r,n){const s=te.useMemo(()=>{const i=pD();return mD(i,e,gD(n),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};dD(i,t.style,t),s.style={...i,...s.style}}return s}const rre=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function R_(t){return typeof t!="string"||t.includes("-")?!1:!!(rre.indexOf(t)>-1||/[A-Z]/u.test(t))}function nre(t,e,r,{latestValues:n},s,i=!1){const o=(R_(t)?tre:Qte)(e,n,s,t),l=$te(e,typeof t=="string",i),c=t!==te.Fragment?{...l,...o,ref:r}:{},{children:u}=e,h=te.useMemo(()=>hn(u)?u.get():u,[u]);return te.createElement(t,{...c,children:h})}function WA(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function P_(t,e,r,n){if(typeof e=="function"){const[s,i]=WA(n);e=e(r!==void 0?r:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=WA(n);e=e(r!==void 0?r:t.custom,s,i)}return e}function P0(t){return hn(t)?t.get():t}function sre({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:ire(r,n,s,t),renderState:e()}}function ire(t,e,r,n){const s={},i=n(t,{});for(const m in i)s[m]=P0(i[m]);let{initial:a,animate:o}=t;const l=Wp(t),c=fD(t);e&&c&&!l&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let u=r?r.initial===!1:!1;u=u||a===!1;const h=u?o:a;if(h&&typeof h!="boolean"&&!Hp(h)){const m=Array.isArray(h)?h:[h];for(let p=0;p<m.length;p++){const x=P_(t,m[p]);if(x){const{transitionEnd:g,transition:v,..._}=x;for(const w in _){let y=_[w];if(Array.isArray(y)){const I=u?y.length-1:0;y=y[I]}y!==null&&(s[w]=y)}for(const w in g)s[w]=g[w]}}}return s}const xD=t=>(e,r)=>{const n=te.useContext(zp),s=te.useContext($p),i=()=>sre(t,e,n,s);return r?i():n_(i)};function D_(t,e,r){var i;const{style:n}=t,s={};for(const a in n)(hn(n[a])||e.style&&hn(e.style[a])||hD(a,t)||((i=r==null?void 0:r.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=n[a]);return s}const are=xD({scrapeMotionValuesFromProps:D_,createRenderState:N_});function yD(t,e,r){const n=D_(t,e,r);for(const s in t)if(hn(t[s])||hn(e[s])){const i=gu.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=t[s]}return n}const ore=xD({scrapeMotionValuesFromProps:yD,createRenderState:pD}),lre=Symbol.for("motionComponentSymbol");function cc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function cre(t,e,r){return te.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):cc(r)&&(r.current=n))},[e])}const F_=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ure="framerAppearId",vD="data-"+F_(ure),wD=te.createContext({});function fre(t,e,r,n,s){var g,v;const{visualElement:i}=te.useContext(zp),a=te.useContext(cD),o=te.useContext($p),l=te.useContext(k_).reducedMotion,c=te.useRef(null);n=n||a.renderer,!c.current&&n&&(c.current=n(t,{visualState:e,parent:i,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,h=te.useContext(wD);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&hre(c.current,r,s,h);const m=te.useRef(!1);te.useInsertionEffect(()=>{u&&m.current&&u.update(r,o)});const p=r[vD],x=te.useRef(!!p&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,p))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,p)));return x3(()=>{u&&(m.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),x.current&&u.animationState&&u.animationState.animateChanges())}),te.useEffect(()=>{u&&(!x.current&&u.animationState&&u.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var _;(_=window.MotionHandoffMarkAsComplete)==null||_.call(window,p)}),x.current=!1),u.enteringChildren=void 0)}),u}function hre(t,e,r,n){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:_D(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&cc(o),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,crossfade:u,layoutScroll:l,layoutRoot:c})}function _D(t){if(t)return t.options.allowProjection!==!1?t.projection:_D(t.parent)}function ox(t,{forwardMotionProps:e=!1}={},r,n){r&&Vte(r);const s=R_(t)?ore:are;function i(o,l){let c;const u={...te.useContext(k_),...o,layoutId:dre(o)},{isStatic:h}=u,m=Hte(o),p=s(o,h);if(!h&&s_){mre();const x=pre(u);c=x.MeasureLayout,m.visualElement=fre(t,p,u,n,x.ProjectionNode)}return f.jsxs(zp.Provider,{value:m,children:[c&&m.visualElement?f.jsx(c,{visualElement:m.visualElement,...u}):null,nre(t,o,cre(p,m.visualElement,l),p,h,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=te.forwardRef(i);return a[lre]=t,a}function dre({layoutId:t}){const e=te.useContext(r_).id;return e&&t!==void 0?e+"-"+t:t}function mre(t,e){te.useContext(cD).strict}function pre(t){const{drag:e,layout:r}=Zc;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function gre(t,e){if(typeof Proxy>"u")return ox;const r=new Map,n=(i,a)=>ox(i,a,t,e),s=(i,a)=>n(i,a);return new Proxy(s,{get:(i,a)=>a==="create"?n:(r.has(a)||r.set(a,ox(a,void 0,t,e)),r.get(a))})}function ED({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function xre({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function yre(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function lx(t){return t===void 0||t===1}function py({scale:t,scaleX:e,scaleY:r}){return!lx(t)||!lx(e)||!lx(r)}function No(t){return py(t)||TD(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function TD(t){return GA(t.x)||GA(t.y)}function GA(t){return t&&t!=="0%"}function $m(t,e,r){const n=t-r,s=e*n;return r+s}function qA(t,e,r,n,s){return s!==void 0&&(t=$m(t,s,n)),$m(t,r,n)+e}function gy(t,e=0,r=1,n,s){t.min=qA(t.min,e,r,n,s),t.max=qA(t.max,e,r,n,s)}function SD(t,{x:e,y:r}){gy(t.x,e.translate,e.scale,e.originPoint),gy(t.y,r.translate,r.scale,r.originPoint)}const KA=.999999999999,XA=1.0000000000001;function vre(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let i,a;for(let o=0;o<s;o++){i=r[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&fc(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,SD(t,a)),n&&No(i.latestValues)&&fc(t,i.latestValues))}e.x<XA&&e.x>KA&&(e.x=1),e.y<XA&&e.y>KA&&(e.y=1)}function uc(t,e){t.min=t.min+e,t.max=t.max+e}function YA(t,e,r,n,s=.5){const i=$t(t.min,t.max,s);gy(t,e,r,i,n)}function fc(t,e){YA(t.x,e.x,e.scaleX,e.scale,e.originX),YA(t.y,e.y,e.scaleY,e.scale,e.originY)}function AD(t,e){return ED(yre(t.getBoundingClientRect(),e))}function wre(t,e,r){const n=AD(t,r),{scroll:s}=e;return s&&(uc(n.x,s.offset.x),uc(n.y,s.offset.y)),n}const QA=()=>({translate:0,scale:1,origin:0,originPoint:0}),hc=()=>({x:QA(),y:QA()}),JA=()=>({min:0,max:0}),nr=()=>({x:JA(),y:JA()}),xy={current:null},kD={current:!1};function _re(){if(kD.current=!0,!!s_)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>xy.current=t.matches;t.addEventListener("change",e),e()}else xy.current=!1}const Ere=new WeakMap;function Tre(t,e,r){for(const n in e){const s=e[n],i=r[n];if(hn(s))t.addValue(n,s);else if(hn(i))t.addValue(n,Jc(s,{owner:t}));else if(i!==s)if(t.hasValue(n)){const a=t.getValue(n);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=t.getStaticValue(n);t.addValue(n,Jc(a!==void 0?a:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const ZA=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Sre{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=__,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Mn.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Vt.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=Wp(r),this.isVariantNode=fD(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in h){const p=h[m];l[m]!==void 0&&hn(p)&&p.set(l[m])}}mount(e){var r;this.current=e,Ere.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),kD.current||_re(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:xy.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),oo(this.notifyUpdate),oo(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=xu.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Vt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Zc){const r=Zc[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):nr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<ZA.length;n++){const s=ZA[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=e[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=Tre(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Jc(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(y3(n)||w3(n))?n=parseFloat(n):!Fte(n)&&lo.test(r)&&(n=tD(e,r)),this.setBaseTarget(e,hn(n)?n.get():n)),hn(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var i;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=P_(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);a&&(n=a[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!hn(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new c_),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){S_.render(this.render)}}class bD extends Sre{constructor(){super(...arguments),this.KeyframeResolver=Ete}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hn(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function CD(t,{style:e,vars:r},n,s){const i=t.style;let a;for(a in e)i[a]=e[a];s==null||s.applyProjectionStyles(i,n);for(a in r)i.setProperty(a,r[a])}function Are(t){return window.getComputedStyle(t)}class kre extends bD{constructor(){super(...arguments),this.type="html",this.renderInstance=CD}readValueFromInstance(e,r){var n;if(xu.has(r))return(n=this.projection)!=null&&n.isProjecting?ly(r):Uee(e,r);{const s=Are(e),i=(h_(r)?s.getPropertyValue(r):s[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return AD(e,r)}build(e,r,n){I_(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return D_(e,r,n)}}const ID=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function bre(t,e,r,n){CD(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(ID.has(s)?s:F_(s),e.attrs[s])}class Cre extends bD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=nr}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(xu.has(r)){const n=eD(r);return n&&n.default||0}return r=ID.has(r)?r:F_(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return yD(e,r,n)}build(e,r,n){mD(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){bre(e,r,n,s)}mount(e){this.isSVGTag=gD(e.tagName),super.mount(e)}}const Ire=(t,e)=>R_(t)?new Cre(e):new kre(e,{allowProjection:t!==te.Fragment});function Nc(t,e,r){const n=t.getProps();return P_(n,e,r!==void 0?r:n.custom,t)}const yy=t=>Array.isArray(t);function Nre(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Jc(r))}function Rre(t){return yy(t)?t[t.length-1]||0:t}function Pre(t,e){const r=Nc(t,e);let{transitionEnd:n={},transition:s={},...i}=r||{};i={...i,...n};for(const a in i){const o=Rre(i[a]);Nre(t,a,o)}}function Dre(t){return!!(hn(t)&&t.add)}function vy(t,e){const r=t.getValue("willChange");if(Dre(r))return r.add(e);if(!r&&sa.WillChange){const n=new sa.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function ND(t){return t.props[vD]}const Fre=t=>t!==null;function Ore(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(Fre),i=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[i]}const Lre={type:"spring",stiffness:500,damping:25,restSpeed:10},Mre=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),jre={type:"keyframes",duration:.8},Vre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Bre=(t,{keyframes:e})=>e.length>2?jre:xu.has(t)?t.startsWith("scale")?Mre(e[1]):Lre:Vre;function Ure({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const O_=(t,e,r,n={},s,i)=>a=>{const o=E_(n,t)||{},l=o.delay||n.delay||0;let{elapsed:c=0}=n;c=c-_i(l);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:i?void 0:s};Ure(o)||Object.assign(u,Bre(t,u)),u.duration&&(u.duration=_i(u.duration)),u.repeatDelay&&(u.repeatDelay=_i(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(dy(u),u.delay===0&&(h=!0)),(sa.instantAnimations||sa.skipAnimations)&&(h=!0,dy(u),u.delay=0),u.allowFlatten=!o.type&&!o.ease,h&&!i&&e.get()!==void 0){const m=Ore(u.keyframes,o);if(m!==void 0){Vt.update(()=>{u.onUpdate(m),u.onComplete()});return}}return o.isSync?new w_(u):new ute(u)};function $re({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function RD(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:a,...o}=e;n&&(i=n);const l=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const u in o){const h=t.getValue(u,t.latestValues[u]??null),m=o[u];if(m===void 0||c&&$re(c,u))continue;const p={delay:r,...E_(i||{},u)},x=h.get();if(x!==void 0&&!h.isAnimating&&!Array.isArray(m)&&m===x&&!p.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const _=ND(t);if(_){const w=window.MotionHandoffAnimation(_,u,Vt);w!==null&&(p.startTime=w,g=!0)}}vy(t,u),h.start(O_(u,h,m,t.shouldReduceMotion&&Q3.has(u)?{type:!1}:p,t,g));const v=h.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{Vt.update(()=>{a&&Pre(t,a)})}),l}function PD(t,e,r,n=0,s=1){const i=Array.from(t).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),a=t.size,o=(a-1)*n;return typeof r=="function"?r(i,a):s===1?i*n:o-i*n}function wy(t,e,r={}){var l;const n=Nc(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(RD(t,n,r)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:m}=s;return zre(t,e,c,u,h,m,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(r.delay)])}function zre(t,e,r=0,n=0,s=0,i=1,a){const o=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),o.push(wy(l,e,{...a,delay:r+(typeof n=="function"?0:n)+PD(t.variantChildren,l,n,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function Hre(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>wy(t,i,r));n=Promise.all(s)}else if(typeof e=="string")n=wy(t,e,r);else{const s=typeof e=="function"?Nc(t,e,r.custom):e;n=Promise.all(RD(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function DD(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const Wre=C_.length;function FD(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?FD(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<Wre;r++){const n=C_[r],s=t.props[n];(Ch(s)||s===!1)&&(e[n]=s)}return e}const Gre=[...b_].reverse(),qre=b_.length;function Kre(t){return e=>Promise.all(e.map(({animation:r,options:n})=>Hre(t,r,n)))}function Xre(t){let e=Kre(t),r=ek(),n=!0;const s=l=>(c,u)=>{var m;const h=Nc(t,u,l==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);if(h){const{transition:p,transitionEnd:x,...g}=h;c={...c,...g,...x}}return c};function i(l){e=l(t)}function a(l){const{props:c}=t,u=FD(t.parent)||{},h=[],m=new Set;let p={},x=1/0;for(let v=0;v<qre;v++){const _=Gre[v],w=r[_],y=c[_]!==void 0?c[_]:u[_],I=Ch(y),O=_===l?w.isActive:null;O===!1&&(x=v);let P=y===u[_]&&y!==c[_]&&I;if(P&&n&&t.manuallyAnimateOnMount&&(P=!1),w.protectedKeys={...p},!w.isActive&&O===null||!y&&!w.prevProp||Hp(y)||typeof y=="boolean")continue;const S=Yre(w.prevProp,y);let E=S||_===l&&w.isActive&&!P&&I||v>x&&I,A=!1;const N=Array.isArray(y)?y:[y];let C=N.reduce(s(_),{});O===!1&&(C={});const{prevResolvedValues:R={}}=w,F={...R,...C},oe=he=>{E=!0,m.has(he)&&(A=!0,m.delete(he)),w.needsAnimating[he]=!0;const Z=t.getValue(he);Z&&(Z.liveStyle=!1)};for(const he in F){const Z=C[he],W=R[he];if(p.hasOwnProperty(he))continue;let ie=!1;yy(Z)&&yy(W)?ie=!DD(Z,W):ie=Z!==W,ie?Z!=null?oe(he):m.add(he):Z!==void 0&&m.has(he)?oe(he):w.protectedKeys[he]=!0}w.prevProp=y,w.prevResolvedValues=C,w.isActive&&(p={...p,...C}),n&&t.blockInitialAnimation&&(E=!1);const ae=P&&S;E&&(!ae||A)&&h.push(...N.map(he=>{const Z={type:_};if(typeof he=="string"&&n&&!ae&&t.manuallyAnimateOnMount&&t.parent){const{parent:W}=t,ie=Nc(W,he);if(W.enteringChildren&&ie){const{delayChildren:ue}=ie.transition||{};Z.delay=PD(W.enteringChildren,t,ue)}}return{animation:he,options:Z}}))}if(m.size){const v={};if(typeof c.initial!="boolean"){const _=Nc(t,Array.isArray(c.initial)?c.initial[0]:c.initial);_&&_.transition&&(v.transition=_.transition)}m.forEach(_=>{const w=t.getBaseTarget(_),y=t.getValue(_);y&&(y.liveStyle=!0),v[_]=w??null}),h.push({animation:v})}let g=!!h.length;return n&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),n=!1,g?e(h):Promise.resolve()}function o(l,c){var h;if(r[l].isActive===c)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(m=>{var p;return(p=m.animationState)==null?void 0:p.setActive(l,c)}),r[l].isActive=c;const u=a(l);for(const m in r)r[m].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>r,reset:()=>{r=ek(),n=!0}}}function Yre(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!DD(e,t):!1}function ko(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ek(){return{animate:ko(!0),whileInView:ko(),whileHover:ko(),whileTap:ko(),whileDrag:ko(),whileFocus:ko(),exit:ko()}}class wo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Qre extends wo{constructor(e){super(e),e.animationState||(e.animationState=Xre(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Hp(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Jre=0;class Zre extends wo{constructor(){super(...arguments),this.id=Jre++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const ene={animation:{Feature:Qre},exit:{Feature:Zre}};function Nh(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function cd(t){return{point:{x:t.pageX,y:t.pageY}}}const tne=t=>e=>A_(e)&&t(e,cd(e));function If(t,e,r,n){return Nh(t,e,tne(r),n)}const OD=1e-4,rne=1-OD,nne=1+OD,LD=.01,sne=0-LD,ine=0+LD;function En(t){return t.max-t.min}function ane(t,e,r){return Math.abs(t-e)<=r}function tk(t,e,r,n=.5){t.origin=n,t.originPoint=$t(e.min,e.max,t.origin),t.scale=En(r)/En(e),t.translate=$t(r.min,r.max,t.origin)-t.originPoint,(t.scale>=rne&&t.scale<=nne||isNaN(t.scale))&&(t.scale=1),(t.translate>=sne&&t.translate<=ine||isNaN(t.translate))&&(t.translate=0)}function Nf(t,e,r,n){tk(t.x,e.x,r.x,n?n.originX:void 0),tk(t.y,e.y,r.y,n?n.originY:void 0)}function rk(t,e,r){t.min=r.min+e.min,t.max=t.min+En(e)}function one(t,e,r){rk(t.x,e.x,r.x),rk(t.y,e.y,r.y)}function nk(t,e,r){t.min=e.min-r.min,t.max=t.min+En(e)}function Rf(t,e,r){nk(t.x,e.x,r.x),nk(t.y,e.y,r.y)}function fs(t){return[t("x"),t("y")]}const MD=({current:t})=>t?t.ownerDocument.defaultView:null,sk=(t,e)=>Math.abs(t-e);function lne(t,e){const r=sk(t.x,e.x),n=sk(t.y,e.y);return Math.sqrt(r**2+n**2)}class jD{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=ux(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=lne(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:g}=m,{timestamp:v}=$r;this.history.push({...g,timestamp:v});const{onStart:_,onMove:w}=this.handlers;p||(_&&_(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=cx(p,this.transformPagePoint),Vt.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:x,onSessionEnd:g,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=ux(m.type==="pointercancel"?this.lastMoveEventInfo:cx(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,_),g&&g(m,_)},!A_(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=a,this.contextWindow=s||window;const o=cd(e),l=cx(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=$r;this.history=[{...c,timestamp:u}];const{onSessionStart:h}=r;h&&h(e,ux(l,this.history)),this.removeListeners=ad(If(this.contextWindow,"pointermove",this.handlePointerMove),If(this.contextWindow,"pointerup",this.handlePointerUp),If(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),oo(this.updatePoint)}}function cx(t,e){return e?{point:e(t.point)}:t}function ik(t,e){return{x:t.x-e.x,y:t.y-e.y}}function ux({point:t},e){return{point:t,delta:ik(t,VD(e)),offset:ik(t,cne(e)),velocity:une(e,.1)}}function cne(t){return t[0]}function VD(t){return t[t.length-1]}function une(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=VD(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>_i(e)));)r--;if(!n)return{x:0,y:0};const i=Ei(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function fne(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?$t(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?$t(r,t,n.max):Math.min(t,r)),t}function ak(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function hne(t,{top:e,left:r,bottom:n,right:s}){return{x:ak(t.x,r,s),y:ak(t.y,e,n)}}function ok(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function dne(t,e){return{x:ok(t.x,e.x),y:ok(t.y,e.y)}}function mne(t,e){let r=.5;const n=En(t),s=En(e);return s>n?r=Ah(e.min,e.max-n,t.min):n>s&&(r=Ah(t.min,t.max-s,e.min)),na(0,1,r)}function pne(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const _y=.35;function gne(t=_y){return t===!1?t=0:t===!0&&(t=_y),{x:lk(t,"left","right"),y:lk(t,"top","bottom")}}function lk(t,e,r){return{min:ck(t,e),max:ck(t,r)}}function ck(t,e){return typeof t=="number"?t:t[e]||0}const xne=new WeakMap;class yne{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=nr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(cd(h).point)},a=(h,m)=>{const{drag:p,dragPropagation:x,onDragStart:g}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=kte(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fs(_=>{let w=this.getAxisMotionValue(_).get()||0;if(Ti.test(w)){const{projection:y}=this.visualElement;if(y&&y.layout){const I=y.layout.layoutBox[_];I&&(w=En(I)*(parseFloat(w)/100))}}this.originPoint[_]=w}),g&&Vt.postRender(()=>g(h,m)),vy(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},o=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:g,onDrag:v}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:_}=m;if(x&&this.currentDirection===null){this.currentDirection=vne(_),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",m.point,_),this.updateAxis("y",m.point,_),this.visualElement.render(),v&&v(h,m)},l=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m,this.stop(h,m),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>fs(h=>{var m;return this.getAnimationState(h)==="paused"&&((m=this.getAxisMotionValue(h).animation)==null?void 0:m.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new jD(e,{onSessionStart:i,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:n,contextWindow:MD(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!n)return;const{velocity:a}=s;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&Vt.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!s0(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=fne(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&cc(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=hne(n.layoutBox,e):this.constraints=!1,this.elastic=gne(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&fs(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=pne(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!cc(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=wre(n,s.root,this.visualElement.getTransformPagePoint());let a=dne(s.layout.layoutBox,i);if(r){const o=r(xre(a));this.hasMutatedConstraints=!!o,o&&(a=ED(o))}return a}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=fs(u=>{if(!s0(u,r,this.currentDirection))return;let h=l&&l[u]||{};a&&(h={min:0,max:0});const m=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?e[u]:0,bounceStiffness:m,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,x)});return Promise.all(c).then(o)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return vy(this.visualElement,e),n.start(O_(e,n,0,r,this.visualElement,!1))}stopAnimation(){fs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fs(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){fs(r=>{const{drag:n}=this.getProps();if(!s0(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[r];i.set(e[r]-$t(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!cc(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};fs(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=mne({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),fs(a=>{if(!s0(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set($t(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;xne.set(this.visualElement,this);const e=this.visualElement.current,r=If(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();cc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Vt.read(n);const a=Nh(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(fs(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),r(),i(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=_y,dragMomentum:o=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function s0(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function vne(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class wne extends wo{constructor(e){super(e),this.removeGroupControls=As,this.removeListeners=As,this.controls=new yne(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||As}unmount(){this.removeGroupControls(),this.removeListeners()}}const uk=t=>(e,r)=>{t&&Vt.postRender(()=>t(e,r))};class _ne extends wo{constructor(){super(...arguments),this.removePointerDownListener=As}onPointerDown(e){this.session=new jD(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:MD(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:uk(e),onStart:uk(r),onMove:n,onEnd:(i,a)=>{delete this.session,s&&Vt.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=If(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const D0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function fk(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Vu={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ue.test(t))t=parseFloat(t);else return t;const r=fk(t,e.target.x),n=fk(t,e.target.y);return`${r}% ${n}%`}},Ene={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=lo.parse(t);if(s.length>5)return n;const i=lo.createTransformer(t),a=typeof s[0]!="number"?1:0,o=r.x.scale*e.x,l=r.y.scale*e.y;s[0+a]/=o,s[1+a]/=l;const c=$t(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};let fx=!1;class Tne extends te.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;Wte(Sne),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),fx&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),D0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,{projection:a}=n;return a&&(a.isPresent=i,fx=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==i?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||Vt.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),S_.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;fx=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function BD(t){const[e,r]=lD(),n=te.useContext(r_);return f.jsx(Tne,{...t,layoutGroup:n,switchLayoutGroup:te.useContext(wD),isPresent:e,safeToRemove:r})}const Sne={borderRadius:{...Vu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Vu,borderTopRightRadius:Vu,borderBottomLeftRadius:Vu,borderBottomRightRadius:Vu,boxShadow:Ene};function Ane(t,e,r){const n=hn(t)?t:Jc(t);return n.start(O_("",n,e,r)),n.animation}const kne=(t,e)=>t.depth-e.depth;class bne{constructor(){this.children=[],this.isDirty=!1}add(e){i_(this.children,e),this.isDirty=!0}remove(e){a_(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(kne),this.isDirty=!1,this.children.forEach(e)}}function Cne(t,e){const r=Mn.now(),n=({timestamp:s})=>{const i=s-r;i>=e&&(oo(n),t(i-e))};return Vt.setup(n,!0),()=>oo(n)}const UD=["TopLeft","TopRight","BottomLeft","BottomRight"],Ine=UD.length,hk=t=>typeof t=="string"?parseFloat(t):t,dk=t=>typeof t=="number"||Ue.test(t);function Nne(t,e,r,n,s,i){s?(t.opacity=$t(0,r.opacity??1,Rne(n)),t.opacityExit=$t(e.opacity??1,0,Pne(n))):i&&(t.opacity=$t(e.opacity??1,r.opacity??1,n));for(let a=0;a<Ine;a++){const o=`border${UD[a]}Radius`;let l=mk(e,o),c=mk(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||dk(l)===dk(c)?(t[o]=Math.max($t(hk(l),hk(c),n),0),(Ti.test(c)||Ti.test(l))&&(t[o]+="%")):t[o]=c}(e.rotate||r.rotate)&&(t.rotate=$t(e.rotate||0,r.rotate||0,n))}function mk(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Rne=$D(0,.5,C3),Pne=$D(.5,.95,As);function $D(t,e,r){return n=>n<t?0:n>e?1:r(Ah(t,e,n))}function pk(t,e){t.min=e.min,t.max=e.max}function os(t,e){pk(t.x,e.x),pk(t.y,e.y)}function gk(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function xk(t,e,r,n,s){return t-=e,t=$m(t,1/r,n),s!==void 0&&(t=$m(t,1/s,n)),t}function Dne(t,e=0,r=1,n=.5,s,i=t,a=t){if(Ti.test(e)&&(e=parseFloat(e),e=$t(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=$t(i.min,i.max,n);t===i&&(o-=e),t.min=xk(t.min,e,r,o,s),t.max=xk(t.max,e,r,o,s)}function yk(t,e,[r,n,s],i,a){Dne(t,e[r],e[n],e[s],e.scale,i,a)}const Fne=["x","scaleX","originX"],One=["y","scaleY","originY"];function vk(t,e,r,n){yk(t.x,e,Fne,r?r.x:void 0,n?n.x:void 0),yk(t.y,e,One,r?r.y:void 0,n?n.y:void 0)}function wk(t){return t.translate===0&&t.scale===1}function zD(t){return wk(t.x)&&wk(t.y)}function _k(t,e){return t.min===e.min&&t.max===e.max}function Lne(t,e){return _k(t.x,e.x)&&_k(t.y,e.y)}function Ek(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function HD(t,e){return Ek(t.x,e.x)&&Ek(t.y,e.y)}function Tk(t){return En(t.x)/En(t.y)}function Sk(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Mne{constructor(){this.members=[]}add(e){i_(this.members,e),e.scheduleRender()}remove(e){if(a_(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function jne(t,e,r){let n="";const s=t.x.translate/e.x,i=t.y.translate/e.y,a=(r==null?void 0:r.z)||0;if((s||i||a)&&(n=`translate3d(${s}px, ${i}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:m,skewX:p,skewY:x}=r;c&&(n=`perspective(${c}px) ${n}`),u&&(n+=`rotate(${u}deg) `),h&&(n+=`rotateX(${h}deg) `),m&&(n+=`rotateY(${m}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const hx=["","X","Y","Z"],Vne=1e3;let Bne=0;function dx(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function WD(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=ND(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",Vt,!(s||i))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&WD(n)}function GD({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(a={},o=e==null?void 0:e()){this.id=Bne++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(zne),this.nodes.forEach(qne),this.nodes.forEach(Kne),this.nodes.forEach(Hne)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new bne)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new c_),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=oD(a)&&!Pte(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),t){let u,h=0;const m=()=>this.root.updateBlockedByResize=!1;Vt.read(()=>{h=window.innerWidth}),t(a,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,u&&u(),u=Cne(m,250),D0.hasAnimatedSinceResize&&(D0.hasAnimatedSinceResize=!1,this.nodes.forEach(bk)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:m,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||c.getDefaultTransition()||Zne,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=c.getProps(),_=!this.targetLayout||!HD(this.targetLayout,p),w=!h&&m;if(this.options.layoutRoot||this.resumeFrom||w||h&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...E_(x,"layout"),onPlay:g,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(u,w)}else h||bk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),oo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Xne),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&WD(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ak);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(kk);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Gne),this.nodes.forEach(Une),this.nodes.forEach($ne)):this.nodes.forEach(kk),this.clearAllSnapshots();const o=Mn.now();$r.delta=na(0,1e3/60,o-$r.timestamp),$r.timestamp=o,$r.isProcessing=!0,tx.update.process($r),tx.preRender.process($r),tx.render.process($r),$r.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,S_.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Wne),this.sharedNodes.forEach(Yne)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Vt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Vt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!En(this.snapshot.measuredBox.x)&&!En(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=nr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!zD(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||No(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),ese(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return nr();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(tse))){const{scroll:u}=this.root;u&&(uc(o.x,u.offset.x),uc(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=nr();if(os(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:m}=u;u!==this.root&&h&&m.layoutScroll&&(h.wasRoot&&os(o,a),uc(o.x,h.offset.x),uc(o.y,h.offset.y))}return o}applyTransform(a,o=!1){const l=nr();os(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&fc(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),No(u.latestValues)&&fc(l,u.latestValues)}return No(this.latestValues)&&fc(l,this.latestValues),l}removeTransform(a){const o=nr();os(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!No(c.latestValues))continue;py(c.latestValues)&&c.updateSnapshot();const u=nr(),h=c.measurePageBox();os(u,h),vk(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return No(this.latestValues)&&vk(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==$r.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!(!this.layout||!(u||h))){if(this.resolvedRelativeTargetAt=$r.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=nr(),this.relativeTargetOrigin=nr(),Rf(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=nr(),this.targetWithTransforms=nr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),one(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):os(this.target,this.layout.layoutBox),SD(this.target,this.targetDelta)):os(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=nr(),this.relativeTargetOrigin=nr(),Rf(this.relativeTargetOrigin,this.target,p.target),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||py(this.parent.latestValues)||TD(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===$r.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;os(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;vre(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=nr());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(gk(this.prevProjectionDelta.x,this.projectionDelta.x),gk(this.prevProjectionDelta.y,this.projectionDelta.y)),Nf(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!Sk(this.projectionDelta.x,this.prevProjectionDelta.x)||!Sk(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=hc(),this.projectionDelta=hc(),this.projectionDeltaWithTransform=hc()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=hc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=nr(),p=l?l.source:void 0,x=this.layout?this.layout.source:void 0,g=p!==x,v=this.getStack(),_=!v||v.members.length<=1,w=!!(g&&!_&&this.options.crossfade===!0&&!this.path.some(Jne));this.animationProgress=0;let y;this.mixTargetDelta=I=>{const O=I/1e3;Ck(h.x,a.x,O),Ck(h.y,a.y,O),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Qne(this.relativeTarget,this.relativeTargetOrigin,m,O),y&&Lne(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=nr()),os(y,this.relativeTarget)),g&&(this.animationValues=u,Nne(u,c,this.latestValues,O,w,_)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var o,l,c;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(oo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Vt.update(()=>{D0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Jc(0)),this.currentAnimation=Ane(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),a.onUpdate&&a.onUpdate(u)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Vne),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&qD(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||nr();const h=En(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const m=En(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}os(o,l),fc(o,u),Nf(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Mne),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&dx("z",a,c,this.animationValues);for(let u=0;u<hx.length;u++)dx(`rotate${hx[u]}`,a,c,this.animationValues),dx(`skew${hx[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=P0(o==null?void 0:o.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=P0(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!No(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let h=jne(this.projectionDeltaWithTransform,this.treeScale,u);l&&(h=l(u,h)),a.transform=h;const{x:m,y:p}=this.projectionDelta;a.transformOrigin=`${m.origin*100}% ${p.origin*100}% 0`,c.animationValues?a.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:a.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const x in Ih){if(u[x]===void 0)continue;const{correct:g,applyTo:v,isCSSVariable:_}=Ih[x],w=h==="none"?u[x]:g(u[x],c);if(v){const y=v.length;for(let I=0;I<y;I++)a[v[I]]=w}else _?this.options.visualElement.renderState.vars[x]=w:a[x]=w}this.options.layoutId&&(a.pointerEvents=c===this?P0(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(Ak),this.root.sharedNodes.clear()}}}function Une(t){t.updateLayout()}function $ne(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?fs(h=>{const m=a?e.measuredBox[h]:e.layoutBox[h],p=En(m);m.min=n[h].min,m.max=m.min+p}):qD(i,e.layoutBox,n)&&fs(h=>{const m=a?e.measuredBox[h]:e.layoutBox[h],p=En(n[h]);m.max=m.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+p)});const o=hc();Nf(o,n,e.layoutBox);const l=hc();a?Nf(l,t.applyTransform(s,!0),e.measuredBox):Nf(l,n,e.layoutBox);const c=!zD(o);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:m,layout:p}=h;if(m&&p){const x=nr();Rf(x,e.layoutBox,m.layoutBox);const g=nr();Rf(g,n,p.layoutBox),HD(x,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=x,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function zne(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Hne(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Wne(t){t.clearSnapshot()}function Ak(t){t.clearMeasurements()}function kk(t){t.isLayoutDirty=!1}function Gne(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function bk(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function qne(t){t.resolveTargetDelta()}function Kne(t){t.calcProjection()}function Xne(t){t.resetSkewAndRotation()}function Yne(t){t.removeLeadSnapshot()}function Ck(t,e,r){t.translate=$t(e.translate,0,r),t.scale=$t(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function Ik(t,e,r,n){t.min=$t(e.min,r.min,n),t.max=$t(e.max,r.max,n)}function Qne(t,e,r,n){Ik(t.x,e.x,r.x,n),Ik(t.y,e.y,r.y,n)}function Jne(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Zne={duration:.45,ease:[.4,0,.1,1]},Nk=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Rk=Nk("applewebkit/")&&!Nk("chrome/")?Math.round:As;function Pk(t){t.min=Rk(t.min),t.max=Rk(t.max)}function ese(t){Pk(t.x),Pk(t.y)}function qD(t,e,r){return t==="position"||t==="preserve-aspect"&&!ane(Tk(e),Tk(r),.2)}function tse(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const rse=GD({attachResizeListener:(t,e)=>Nh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),mx={current:void 0},KD=GD({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!mx.current){const t=new rse({});t.mount(window),t.setOptions({layoutScroll:!0}),mx.current=t}return mx.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),nse={pan:{Feature:_ne},drag:{Feature:wne,ProjectionNode:KD,MeasureLayout:BD}};function Dk(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,i=n[s];i&&Vt.postRender(()=>i(e,cd(e)))}class sse extends wo{mount(){const{current:e}=this.node;e&&(this.unmount=bte(e,(r,n)=>(Dk(this.node,n,"Start"),s=>Dk(this.node,s,"End"))))}unmount(){}}class ise extends wo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ad(Nh(this.node.current,"focus",()=>this.onFocus()),Nh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Fk(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),i=n[s];i&&Vt.postRender(()=>i(e,cd(e)))}class ase extends wo{mount(){const{current:e}=this.node;e&&(this.unmount=Rte(e,(r,n)=>(Fk(this.node,n,"Start"),(s,{success:i})=>Fk(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ey=new WeakMap,px=new WeakMap,ose=t=>{const e=Ey.get(t.target);e&&e(t)},lse=t=>{t.forEach(ose)};function cse({root:t,...e}){const r=t||document;px.has(r)||px.set(r,{});const n=px.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(lse,{root:t,...e})),n[s]}function use(t,e,r){const n=cse(e);return Ey.set(t,r),n.observe(t),()=>{Ey.delete(t),n.unobserve(t)}}const fse={some:0,all:1};class hse extends wo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=e,a={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:fse[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),m=c?u:h;m&&m(l)};return use(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(dse(e,r))&&this.startObserver()}unmount(){}}function dse({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const mse={inView:{Feature:hse},tap:{Feature:ase},focus:{Feature:ise},hover:{Feature:sse}},pse={layout:{ProjectionNode:KD,MeasureLayout:BD}},gse={...ene,...mse,...nse,...pse},Le=gre(gse,Ire),xse=["roberto@mistatas.com"],yse=t=>t!=null&&t.email?t.email.includes("admin")||t.role==="admin"||xse.includes(t.email):!1;let gx=!1;const vse=async t=>{var r;if(console.log(" INICIANDO INICIALIZACIN DEL STORE:",{userId:t,initialized:gx}),gx){console.log(" Store ya inicializado, saltando...");return}const e=Mm.getState();console.log(" Estado inicial del store:",{beneficiariesCount:((r=e.beneficiaries)==null?void 0:r.length)||0,shouldReload:e.shouldReload,stats:e.stats});try{const n=e.beneficiaries&&e.beneficiaries.length>0;if(console.log(" Hay datos persistidos?",n),!n)console.log(" Cargando beneficiarios desde Firebase..."),await e.loadBeneficiaries(t);else{console.log(" Usando datos persistidos del store...");const s=e.calculateStats(e.beneficiaries);Mm.setState({stats:s}),console.log(" Estadsticas actualizadas:",s)}gx=!0,console.log(" Store inicializado correctamente")}catch(n){console.error(" Error inicializando store de beneficiarios:",n);try{console.log(" Intentando recarga forzada..."),await e.forceReload(t)}catch(s){console.error(" Error en reintento de carga:",s)}}},wse=(t,e,r)=>{console.log(" === DEBUGGING BENEFICIARY MATCH ==="),console.log(" Buscando beneficiario:",t);const n=e.find(l=>l.nombre&&l.nombre.toLowerCase().includes(t.toLowerCase()));if(!n){console.log(" Beneficiario no encontrado en la lista de beneficiarios");return}console.log(" Beneficiario encontrado:",{nombre:n.nombre,fono:n.fono,sim:n.sim,appSim:n.appSim});const s=fi(n.nombre),i=[yr(n.fono),yr(n.sim),yr(n.appSim)].filter(Boolean);console.log(" Datos normalizados del beneficiario:",{nombre:s,telefonos:i}),console.log(" Buscando en",r.length,"asignaciones...");let a=!1,o=!1;return r.forEach((l,c)=>{const u=fi(l.beneficiary||l.nombre||l.beneficiario||""),h=[yr(l.phone||l.primaryPhone||l.telefono||l.fono||""),yr(l.sim||""),yr(l.appSim||"")].filter(Boolean),m=p3(s,u);m&&(console.log(` COINCIDENCIA POR NOMBRE encontrada en asignacin ${c+1}:`),console.log("   - Beneficiario:",n.nombre,"",s),console.log("   - Asignacin:",l.beneficiary||l.nombre,"",u),a=!0);const p=i.some(x=>h.some(g=>g===x));p&&(console.log(` COINCIDENCIA POR TELFONO encontrada en asignacin ${c+1}:`),console.log("   - Beneficiario telfonos:",i),console.log("   - Asignacin telfonos:",h),o=!0),c<3&&console.log(` Asignacin ${c+1}:`,{original:{beneficiary:l.beneficiary,phone:l.phone},normalizado:{nombre:u,telefonos:h},coincidencia:{nombre:m,telefono:p}})}),console.log(" RESULTADO FINAL:"),console.log("   - Encontrado por nombre:",a),console.log("   - Encontrado por telfono:",o),console.log("   - Debera estar asignado:",a||o),console.log(" === FIN DEBUGGING ==="),{found:a||o,foundByName:a,foundByPhone:o,beneficiary:n,targetName:s,targetPhones:i}},_se=({onUploadComplete:t,onUploadError:e,isUploading:r=!1,className:n=""})=>{const[s,i]=te.useState(!1),[a,o]=te.useState(""),[l,c]=te.useState(0),[u,h]=te.useState(null),[m,p]=te.useState(!1),x=te.useRef(null),g=P=>{P.preventDefault(),P.stopPropagation(),P.type==="dragenter"||P.type==="dragover"?i(!0):P.type==="dragleave"&&i(!1)},v=P=>{P.preventDefault(),P.stopPropagation(),i(!1),P.dataTransfer.files&&P.dataTransfer.files[0]&&w(P.dataTransfer.files[0])},_=P=>{P.preventDefault(),P.target.files&&P.target.files[0]&&w(P.target.files[0])},w=async P=>{if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel",".xlsx",".xls"].some(A=>P.type===A||P.name.toLowerCase().endsWith(A))){e("Por favor selecciona un archivo Excel vlido (.xlsx o .xls)");return}if(P.size>10*1024*1024){e("El archivo es demasiado grande. Mximo 10MB permitido.");return}o(P.name);try{const A=await y(P);h(A),p(!0)}catch(A){e(`Error al procesar el archivo: ${A.message}`)}},y=P=>new Promise((S,E)=>{const A=new FileReader;A.onload=N=>{try{const C=new Uint8Array(N.target.result),R=fh(C,{type:"array"}),F=R.SheetNames[0],oe=R.Sheets[F],ae=Sc.sheet_to_json(oe,{header:1,defval:""});if(ae.length<2){E(new Error("El archivo debe contener al menos una fila de datos adems del encabezado"));return}const ve=ae[0],Z=ae.slice(1).filter(W=>W.some(ie=>ie&&ie.toString().trim()!=="")).map((W,ie)=>({Nombre:W[0]||"",Fono:W[1]||"",Sim:W[2]||"",Direccion:W[3]||"","App Sim":W[4]||"",_rowIndex:ie+2}));if(Z.length===0){E(new Error("No se encontraron datos vlidos en el archivo"));return}S({headers:ve,data:Z,totalRows:Z.length})}catch(C){E(new Error(`Error al leer el archivo Excel: ${C.message}`))}},A.onerror=()=>{E(new Error("Error al leer el archivo"))},A.readAsArrayBuffer(P)}),I=()=>{u&&t&&(t(u.data,{fileName:a,totalRows:u.totalRows,onProgress:c}),p(!1),h(null),o(""),x.current&&(x.current.value=""))},O=()=>{p(!1),h(null),o(""),c(0),x.current&&(x.current.value="")};return f.jsxs("div",{className:`space-y-4 ${n}`,children:[f.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`relative border-2 border-dashed rounded-lg p-6 transition-colors ${s?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"} ${r?"pointer-events-none opacity-50":""}`,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:v,children:[f.jsx("input",{ref:x,type:"file",accept:".xlsx,.xls",onChange:_,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:r}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",children:r?f.jsx(m5,{className:"h-12 w-12 animate-spin"}):f.jsx(Qf,{className:"h-12 w-12"})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:r?"Procesando archivo...":s?"Suelta el archivo aqu":"Arrastra tu archivo Excel aqu"}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r?`Progreso: ${l}%`:"o haz clic para seleccionar un archivo (.xlsx, .xls)"}),a&&!r&&f.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-blue-600 dark:text-blue-400",children:[f.jsx(f5,{className:"h-4 w-4"}),f.jsx("span",{children:a})]})]})]}),r&&l>0&&f.jsx(Le.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},children:f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:f.jsx(Le.div,{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`},initial:{width:0},animate:{width:`${l}%`}})})})]}),f.jsxs(Le.div,{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[f.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Formato esperado del Excel:"}),f.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna B:"})," Fono (telfono principal)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna C:"})," Sim (telfono secundario)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna D:"})," Direccin"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna E:"})," App Sim (otro nmero de contacto)"]})]}),f.jsx("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-300",children:'Nota: Los nmeros "000000000" sern ignorados automticamente'})]}),m&&u&&f.jsx(Le.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},children:f.jsxs(Le.div,{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Vista previa del archivo"}),f.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u.totalRows," beneficiarios encontrados"]})]}),f.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f.jsx(Bc,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:f.jsxs("div",{className:"overflow-x-auto",children:[f.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[f.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nombre"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Fono"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Sim"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Direccin"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"App Sim"})]})}),f.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:u.data.slice(0,10).map((P,S)=>f.jsxs("tr",{className:S%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",children:[f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:P.Nombre||"N/A"}),f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:P.Fono||"N/A"}),f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:P.Sim||"N/A"}),f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100 max-w-xs truncate",children:P.Direccion||"N/A"}),f.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:P["App Sim"]||"N/A"})]},S))})]}),u.data.length>10&&f.jsxs("div",{className:"text-center py-4 text-sm text-gray-500 dark:text-gray-400",children:["... y ",u.data.length-10," filas ms"]})]})}),f.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("button",{onClick:O,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"}),f.jsxs("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center space-x-2",children:[f.jsx(Ka,{className:"h-4 w-4"}),f.jsxs("span",{children:["Confirmar y cargar ",u.totalRows," beneficiarios"]})]})]})]})})]})},Ese=({beneficiaries:t=[],searchTerm:e="",onSearchChange:r,onEdit:n,onDelete:s,isLoading:i=!1,className:a=""})=>{const[o,l]=te.useState("all"),[c,u]=te.useState("name"),[h,m]=te.useState("asc"),p=te.useMemo(()=>{let w=[...t];switch(o){case"with-phone":w=w.filter(y=>y.telefonosValidos&&y.telefonosValidos.length>0);break;case"without-phone":w=w.filter(y=>!y.telefonosValidos||y.telefonosValidos.length===0);break;case"incomplete":w=w.filter(y=>!y.nombre||!y.direccion||!y.telefonosValidos||y.telefonosValidos.length===0);break}if(e&&e.trim()!==""){const y=e.toLowerCase().trim();w=w.filter(I=>I.nombre&&I.nombre.toLowerCase().includes(y)||I.direccion&&I.direccion.toLowerCase().includes(y)||I.fono&&I.fono.includes(y)||I.sim&&I.sim.includes(y)||I.appSim&&I.appSim.includes(y))}return w.sort((y,I)=>{var P,S,E,A,N,C;let O=0;switch(c){case"name":O=(y.nombre||"").localeCompare(I.nombre||"");break;case"date":const R=((S=(P=y.creadoEn)==null?void 0:P.toDate)==null?void 0:S.call(P))||new Date(0),F=((A=(E=I.creadoEn)==null?void 0:E.toDate)==null?void 0:A.call(E))||new Date(0);O=R-F;break;case"phone-count":const oe=((N=y.telefonosValidos)==null?void 0:N.length)||0,ae=((C=I.telefonosValidos)==null?void 0:C.length)||0;O=oe-ae;break}return h==="desc"?-O:O}),w},[t,e,o,c,h]),x=w=>{var y;return((y=w.telefonosValidos)==null?void 0:y.length)||0},g=w=>{if(!w)return"N/A";try{return(w.toDate?w.toDate():new Date(w)).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"N/A"}},v=w=>{const y=x(w);return!w.nombre||!w.direccion?"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20":y===0?"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-900/20":"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20"},_=w=>{const y=x(w);return!w.nombre||!w.direccion?f.jsx(mi,{className:"h-4 w-4 text-red-500"}):y===0?f.jsx(mi,{className:"h-4 w-4 text-yellow-500"}):f.jsx(Xa,{className:"h-4 w-4 text-green-500"})};return f.jsxs("div",{className:`space-y-6 ${a}`,children:[f.jsxs(Le.div,{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"relative",children:[f.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Buscar por nombre, direccin o telfono...",value:e,onChange:w=>r==null?void 0:r(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("select",{value:o,onChange:w=>l(w.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[f.jsx("option",{value:"all",children:"Todos"}),f.jsx("option",{value:"with-phone",children:"Con telfono"}),f.jsx("option",{value:"without-phone",children:"Sin telfono"}),f.jsx("option",{value:"incomplete",children:"Datos incompletos"})]}),f.jsxs("select",{value:`${c}-${h}`,onChange:w=>{const[y,I]=w.target.value.split("-");u(y),m(I)},className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[f.jsx("option",{value:"name-asc",children:"Nombre A-Z"}),f.jsx("option",{value:"name-desc",children:"Nombre Z-A"}),f.jsx("option",{value:"date-desc",children:"Ms reciente"}),f.jsx("option",{value:"date-asc",children:"Ms antiguo"}),f.jsx("option",{value:"phone-count-desc",children:"Ms telfonos"}),f.jsx("option",{value:"phone-count-asc",children:"Menos telfonos"})]})]})]}),f.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400",children:[f.jsxs("span",{children:["Total: ",t.length]}),f.jsxs("span",{children:["Mostrados: ",p.length]}),f.jsxs("span",{children:["Con telfono: ",t.filter(w=>x(w)>0).length]}),f.jsxs("span",{children:["Sin telfono: ",t.filter(w=>x(w)===0).length]})]})]}),f.jsx("div",{className:"space-y-3",children:f.jsx(pl,{children:i?f.jsxs(Le.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),f.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Cargando beneficiarios..."})]}):p.length===0?f.jsxs(Le.div,{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",initial:{opacity:0},animate:{opacity:1},children:[f.jsx(Xa,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No se encontraron beneficiarios"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e?"Intenta con otros trminos de bsqueda o ajusta los filtros":"An no hay beneficiarios cargados"})]}):p.map((w,y)=>f.jsx(Le.div,{className:`bg-white dark:bg-gray-800 rounded-lg shadow-sm border-l-4 p-4 hover:shadow-md transition-shadow ${v(w)}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y*.05},layout:!0,children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[_(w),f.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:w.nombre||"Nombre no disponible"})]}),f.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[f.jsx(n4,{className:"h-4 w-4"}),f.jsx("span",{className:"text-sm",children:w.direccion||"Direccin no disponible"})]}),f.jsxs("div",{className:"space-y-1",children:[w.fono&&f.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[f.jsx(zr,{className:"h-4 w-4"}),f.jsxs("span",{className:"text-sm",children:["Fono: ",w.fono]})]}),w.sim&&f.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[f.jsx(zr,{className:"h-4 w-4"}),f.jsxs("span",{className:"text-sm",children:["Sim: ",w.sim]})]}),w.appSim&&f.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[f.jsx(zr,{className:"h-4 w-4"}),f.jsxs("span",{className:"text-sm",children:["App Sim: ",w.appSim]})]}),x(w)===0&&f.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Sin telfonos vlidos"})]}),f.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Creado: ",g(w.creadoEn),"  Telfonos vlidos: ",x(w)]})]}),f.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[f.jsx("button",{onClick:()=>n==null?void 0:n(w),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Editar beneficiario",children:f.jsx(i4,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>s==null?void 0:s(w),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Eliminar beneficiario",children:f.jsx(Yf,{className:"h-4 w-4"})})]})]})},w.id))})}),p.length>50&&f.jsx(Le.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},children:f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mostrando los primeros 50 resultados. Usa los filtros para refinar la bsqueda."})})]})},Tse=({beneficiaries:t=[],assignments:e=[],onAssignOperator:r,className:n=""})=>{const[s,i]=te.useState([]),[a,o]=te.useState(!1),[l,c]=te.useState(""),[u,h]=te.useState(!0);te.useEffect(()=>{const g=()=>{if(h(!0),console.log(" UnassignedBeneficiaries - Calculando sin asignar:",{beneficiaries:t.length,assignments:e.length}),e.length===0){console.log(" No hay asignaciones, todos los beneficiarios aparecen como sin asignar"),i(t),h(!1);return}const v=e.map(w=>({nombre:w.beneficiary||w.nombre||w.beneficiario,telefono:w.phone||w.primaryPhone||w.telefono||w.fono,teleoperadora:w.operator||w.operatorName||w.teleoperadora||w.operador})).filter(w=>w.nombre&&w.teleoperadora);console.log(" Asignaciones procesadas:",{total:v.length,muestra:v.slice(0,3).map(w=>({nombre:w.nombre,teleoperadora:w.teleoperadora}))});const _=t.filter(w=>!ty(w,v));console.log(" Resultado del clculo:",{totalBeneficiarios:t.length,asignados:v.length,sinAsignar:_.length}),i(_),h(!1)};t.length>0?g():h(!1)},[t,e]);const m=s.filter(g=>{if(!l.trim())return!0;const v=l.toLowerCase();return g.nombre&&g.nombre.toLowerCase().includes(v)||g.direccion&&g.direccion.toLowerCase().includes(v)||g.fono&&g.fono.includes(v)||g.sim&&g.sim.includes(v)||g.appSim&&g.appSim.includes(v)}),p=g=>[g.fono,g.sim,g.appSim].filter(v=>v&&v!=="000000000").join(", ")||"Sin telfonos vlidos",x=()=>{const g=[["BENEFICIARIOS SIN ASIGNAR"],[],[`Generado el: ${new Date().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`],[`Total de beneficiarios sin asignar: ${m.length}`],[],["#","Nombre","Direccin","Telfono Principal","SIM","App SIM","Fecha Registro"],...m.map((P,S)=>[S+1,P.nombre||"Sin nombre",P.direccion||"Sin direccin",P.fono||"",P.sim||"",P.appSim||"",P.creadoEn?new Date(P.creadoEn).toLocaleDateString("es-ES"):"Sin fecha"])],v=Sc.aoa_to_sheet(g),_=Sc.book_new(),w=[{wch:5},{wch:30},{wch:40},{wch:15},{wch:15},{wch:15},{wch:15}];v["!cols"]=w,v["!merges"]||(v["!merges"]=[]),v["!merges"].push({s:{r:0,c:0},e:{r:0,c:6}});const y="A1";v[y]&&(v[y].s={font:{bold:!0,sz:16},alignment:{horizontal:"center"}}),["A7","B7","C7","D7","E7","F7","G7"].forEach(P=>{v[P]&&(v[P].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3B82F6"}}})}),Sc.book_append_sheet(_,v,"Beneficiarios Sin Asignar");const O=`beneficiarios-sin-asignar-${new Date().toISOString().split("T")[0]}.xlsx`;OH(_,O)};return u?f.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 ${n}`,children:f.jsxs("div",{className:"p-6 text-center",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),f.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Analizando asignaciones..."})]})}):f.jsxs(Le.div,{className:`bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden ${n}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",onClick:()=>o(!a),children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${s.length>0?"bg-yellow-100 dark:bg-yellow-900/20":"bg-green-100 dark:bg-green-900/20"}`,children:s.length>0?f.jsx(U5,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}):f.jsx(Dr,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Beneficiarios sin asignar"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.length===0?"Todos los beneficiarios tienen teleoperadora asignada":`${s.length} beneficiarios sin teleoperadora`})]})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[s.length>0&&f.jsxs("button",{onClick:g=>{g.stopPropagation(),x()},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",title:"Exportar listado a Excel",children:[f.jsx(vc,{className:"h-4 w-4 mr-1"}),"Exportar Excel"]}),s.length>0&&f.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",children:s.length}),a?f.jsx(JC,{className:"h-5 w-5 text-gray-400"}):f.jsx(QC,{className:"h-5 w-5 text-gray-400"})]})]})}),f.jsx(pl,{children:a&&f.jsx(Le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:s.length===0?f.jsxs("div",{className:"p-6 text-center",children:[f.jsx(Dr,{className:"mx-auto h-12 w-12 text-green-400 mb-4"}),f.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Excelente!"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Todos los beneficiarios de la base tienen una teleoperadora asignada."})]}):f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Buscar beneficiarios sin asignar...",value:l,onChange:g=>c(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),f.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx(mi,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),f.jsxs("div",{className:"text-sm",children:[f.jsx("p",{className:"text-yellow-800 dark:text-yellow-200 font-medium",children:"Beneficiarios sin teleoperadora asignada"}),f.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Estos beneficiarios estn en la base pero no aparecen en el mdulo de Asignaciones. Es recomendable asignarles una teleoperadora para garantizar el seguimiento."})]})]})}),f.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:m.length===0?f.jsxs("div",{className:"text-center py-6",children:[f.jsx(_s,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No se encontraron beneficiarios con ese criterio de bsqueda"})]}):m.map((g,v)=>{var _;return f.jsx(Le.div,{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 border border-gray-200 dark:border-gray-600",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:v*.05},children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:g.nombre}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[" ",g.direccion]}),f.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[f.jsx(zr,{className:"h-4 w-4"}),f.jsx("span",{children:p(g)})]}),f.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((_=g.telefonosValidos)==null?void 0:_.length)||0," telfonos vlidos"]})]}),f.jsx("button",{onClick:()=>r==null?void 0:r(g),className:"ml-3 px-3 py-1.5 text-xs font-medium text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-200 dark:hover:bg-blue-900/40 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:"Asignar"})]})},g.id)})}),f.jsx("div",{className:"text-center pt-3 border-t border-gray-200 dark:border-gray-700",children:f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[m.length," de ",s.length," beneficiarios mostrados"]})})]})})})]})},Sse=()=>{const{user:t}=Nl(),[e,r]=te.useState("dashboard"),[n,s]=te.useState(!1),[i,a]=te.useState(null),{beneficiaries:o,stats:l,isLoading:c,isUploading:u,uploadProgress:h,searchTerm:m,setSearchTerm:p,setBeneficiaries:x,loadBeneficiaries:g,forceReload:v,uploadBeneficiaries:_,updateBeneficiaryData:w,deleteBeneficiaryData:y,findUnassignedBeneficiaries:I,validateAssignmentConsistency:O,getFilteredBeneficiaries:P}=Mm(),{operatorAssignments:S,getAllAssignments:E}=Dn();te.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{await vse(t.uid)}catch(W){console.error("Error inicializando store:",W),A(" Error cargando beneficiarios","error")}})()},[t]),te.useEffect(()=>{o.length>0&&!c&&console.log(" Beneficiarios Base cargados:",{total:o.length,stats:l})},[o,l,c]),te.useEffect(()=>{if(o.length>0){const Z=E();console.log(" Actualizando estadsticas con asignaciones:",Z.length);const W=I(Z);console.log(" Beneficiarios sin asignar encontrados:",W.length)}},[S,o,I,E]);const A=(Z,W="info")=>{a({message:Z,type:W}),setTimeout(()=>a(null),5e3)},N=async()=>{try{console.log(" Sincronizando con mdulo de asignaciones...");const Z=E();if(console.log(" Asignaciones obtenidas:",Z),Z.length===0){A(" No se encontraron asignaciones para sincronizar","warning");return}const W=I(Z);A(` Sincronizacin completada. ${Z.length} asignaciones procesadas, ${W.length} beneficiarios sin asignar`,"success")}catch(Z){console.error("Error en sincronizacin:",Z),A(" Error al sincronizar con asignaciones","error")}},C=()=>{const Z=prompt('Ingresa el nombre del beneficiario a debuggear (ej: "Mariana Apolonia Gonzalez Gonzalez"):');if(!Z)return;const W=E();console.log(" DEBUG ESPECFICO:",Z),console.log(" Total asignaciones disponibles:",W.length),console.log(" Muestra de asignaciones:",W.slice(0,5));const ie=o.find(K=>{var X;return(X=K.nombre)==null?void 0:X.toLowerCase().includes(Z.toLowerCase())});console.log(" Beneficiario encontrado en base:",ie);const ue=W.find(K=>{var X;return(X=K.beneficiary)==null?void 0:X.toLowerCase().includes(Z.toLowerCase())});console.log(" Asignacin encontrada:",ue);const L=wse(Z,o,W);A(L.found?` ${Z} est asignado a ${L.operator}`:` ${Z} NO est asignado`,L.found?"success":"error")},R=()=>{console.group(" DIAGNSTICO COMPLETO - MDULO BENEFICIARIOS BASE");const Z=E(),W=I(Z);console.log(" RESUMEN GENERAL:"),console.log("- Total beneficiarios:",o.length),console.log("- Total asignaciones:",Z.length),console.log("- Beneficiarios sin asignar:",W.length),console.log("- Diferencia esperada:",o.length-Z.length),console.log(" FORMATO DE ASIGNACIONES (primeras 3):"),Z.slice(0,3).forEach((L,K)=>{console.log(`${K+1}.`,{beneficiary:L.beneficiary,operator:L.operator,operatorName:L.operatorName,phone:L.phone})}),console.log(" FORMATO DE BENEFICIARIOS (primeros 3):"),o.slice(0,3).forEach((L,K)=>{console.log(`${K+1}.`,{nombre:L.nombre,fono:L.fono,sim:L.sim})});const ie=o.find(L=>{var K;return(K=L.nombre)==null?void 0:K.toLowerCase().includes("mariana apolonia")}),ue=Z.find(L=>{var K;return(K=L.beneficiary)==null?void 0:K.toLowerCase().includes("mariana apolonia")});console.log(" CASO ESPECFICO - Mariana Apolonia:"),console.log("- En beneficiarios:",ie?"S":"NO"),console.log("- En asignaciones:",ue?"S":"NO"),ie&&console.log(" Datos de Mariana en beneficiarios:",ie),ue&&console.log(" Datos de Mariana en asignaciones:",ue),console.groupEnd(),A(` Diagnstico completado. Ver consola para detalles. ${Z.length} asignaciones, ${W.length} sin asignar`,"info")},F=async(Z,W)=>{try{console.log(" UPLOAD EXCEL - Iniciando..."),console.log(` Registros en Excel: ${Z.length}`);const{beneficiaryService:ie}=await I0(async()=>{const{beneficiaryService:L}=await Promise.resolve().then(()=>RZ);return{beneficiaryService:L}},void 0),ue=await ie.uploadBeneficiaries(Z,t.uid,L=>{console.log(" Progreso:",L),W!=null&&W.onProgress&&W.onProgress(L.processed||0)},!0);if(ue.success){x(ue.data);const L=ue.replacedPrevious?` Base de datos REEMPLAZADA: ${ue.successful} beneficiarios cargados`:` Se cargaron ${ue.successful} beneficiarios correctamente`,K=ue.errors>0?` (${ue.errors} errores encontrados)`:"";A(L+K,"success"),console.log(" UPLOAD COMPLETADO:",ue),s(!1)}else throw new Error(ue.message||"Error durante la carga")}catch(ie){console.error(" Error en upload:",ie),A(` Error: ${ie.message}`,"error")}},oe=Z=>{console.log("Editar beneficiario:",Z)},ae=async Z=>{if(window.confirm(`Ests seguro de eliminar a ${Z.nombre}?`))try{await y(Z.id)?A(` ${Z.nombre} eliminado correctamente`,"success"):A(" Error al eliminar beneficiario","error")}catch(W){A(` Error: ${W.message}`,"error")}},ve=Z=>{console.log("Asignar teleoperadora a:",Z),A(`TODO: Implementar asignacin para ${Z.nombre}`,"info")},he=P();return f.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[i&&f.jsx(Le.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md ${i.type==="success"?"bg-green-500 text-white":i.type==="error"?"bg-red-500 text-white":i.type==="warning"?"bg-yellow-500 text-white":"bg-blue-500 text-white"}`,children:i.message}),f.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"flex justify-between items-center py-4",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(u1,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Beneficiarios Base"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gestin centralizada de beneficiarios y validacin con asignaciones"})]})]}),f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(S5,{className:"h-4 w-4"}),f.jsx("span",{children:"Sincronizar con Asignaciones"})]}),f.jsxs("button",{onClick:R,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[f.jsx(GO,{className:"h-4 w-4"}),f.jsx("span",{children:"Diagnstico"})]}),f.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[f.jsx(_s,{className:"h-4 w-4"}),f.jsx("span",{children:"Debug Especfico"})]}),yse(t==null?void 0:t.email)&&f.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Qf,{className:"h-4 w-4"}),f.jsx("span",{children:"Cargar Excel"})]})]})]}),f.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:f.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"dashboard",name:"Dashboard",icon:u1},{id:"list",name:"Lista completa",icon:Dr},{id:"validation",name:"Validacin",icon:Ka}].map(Z=>f.jsxs("button",{onClick:()=>r(Z.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${e===Z.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[f.jsx(Z.icon,{className:"h-4 w-4"}),f.jsx("span",{children:Z.name})]},Z.id))})})]})}),f.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e==="dashboard"&&f.jsxs(Le.div,{initial:{opacity:0},animate:{opacity:1},children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Dashboard de Beneficiarios"}),f.jsx(Tse,{beneficiaries:o,assignments:E(),onAssignOperator:ve}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:f.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[f.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3",children:"Distribucin por Estado"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Con Asignacin"}),f.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:l.total-l.unassigned})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sin Asignar"}),f.jsx("span",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:l.unassigned})]})]})]})})]},"dashboard"),e==="list"&&f.jsx(Le.div,{initial:{opacity:0},animate:{opacity:1},children:f.jsx(Ese,{beneficiaries:he,searchTerm:m,onSearchChange:p,onEdit:oe,onDelete:ae,onAssignOperator:ve,isLoading:c})},"list"),e==="validation"&&f.jsx(Le.div,{initial:{opacity:0},animate:{opacity:1},children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Validacin y Consistencia"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Herramientas de validacin y auditora en desarrollo..."})]})},"validation")]}),n&&f.jsx(_se,{onUploadComplete:F,onClose:()=>s(!1),isUploading:u,uploadProgress:h})]})};class Ase{constructor(){this.collection="seguimientos"}async createSeguimiento(e,r){try{const n=await Q1(Pt(We,this.collection),{...r,userId:e,createdAt:Rr(),updatedAt:Rr()});return console.log(" Seguimiento creado:",n.id),n.id}catch(n){throw console.error(" Error creando seguimiento:",n),new Error("Error al crear el seguimiento")}}async getSeguimientos(e){try{const r=gr(Pt(We,this.collection),pr("userId","==",e),qo("fechaContacto","desc")),n=await Kr(r),s=[];return n.forEach(i=>{s.push({id:i.id,...i.data()})}),console.log(` Seguimientos obtenidos: ${s.length}`),s}catch(r){return console.error(" Error obteniendo seguimientos:",r),[]}}async getSeguimientosByBeneficiario(e,r){try{const n=gr(Pt(We,this.collection),pr("userId","==",e),pr("beneficiarioId","==",r),qo("fechaContacto","desc")),s=await Kr(n),i=[];return s.forEach(a=>{i.push({id:a.id,...a.data()})}),i}catch(n){return console.error(" Error obteniendo seguimientos del beneficiario:",n),[]}}async updateSeguimiento(e,r){try{const n=ar(We,this.collection,e);return await Th(n,{...r,updatedAt:Rr()}),console.log(" Seguimiento actualizado:",e),!0}catch(n){throw console.error(" Error actualizando seguimiento:",n),new Error("Error al actualizar el seguimiento")}}async deleteSeguimiento(e){try{const r=ar(We,this.collection,e);return await Qc(r),console.log(" Seguimiento eliminado:",e),!0}catch(r){throw console.error(" Error eliminando seguimiento:",r),new Error("Error al eliminar el seguimiento")}}async getEstadisticasOperadora(e,r=null){try{let n;r?n=gr(Pt(We,this.collection),pr("userId","==",e),pr("operadorId","==",r)):n=gr(Pt(We,this.collection),pr("userId","==",e));const s=await Kr(n),i=[];s.forEach(o=>{i.push({id:o.id,...o.data()})});const a={totalSeguimientos:i.length,exitosos:i.filter(o=>o.tipoResultado==="exitoso").length,fallidos:i.filter(o=>o.tipoResultado==="fallido").length,noRespuesta:i.filter(o=>o.tipoResultado==="no-respuesta").length,ocupados:i.filter(o=>o.tipoResultado==="ocupado").length,mensajes:i.filter(o=>o.tipoResultado==="mensaje").length,beneficiariosContactados:new Set(i.map(o=>o.beneficiarioId||o.beneficiario)).size,llamadas:i.filter(o=>o.tipoContacto==="llamada").length,videollamadas:i.filter(o=>o.tipoContacto==="videollamada").length,whatsapp:i.filter(o=>o.tipoContacto==="whatsapp").length,presenciales:i.filter(o=>o.tipoContacto==="presencial").length,recientes:i.filter(o=>{const l=new Date(o.fechaContacto),c=new Date;return c.setDate(c.getDate()-30),l>=c}).length};return a.porcentajeExito=a.totalSeguimientos>0?Math.round(a.exitosos/a.totalSeguimientos*100):0,a}catch(n){return console.error(" Error obteniendo estadsticas:",n),{totalSeguimientos:0,exitosos:0,fallidos:0,noRespuesta:0,ocupados:0,mensajes:0,beneficiariosContactados:0,llamadas:0,videollamadas:0,whatsapp:0,presenciales:0,recientes:0,porcentajeExito:0}}}async getBeneficiariosConEstado(e,r=[]){try{const n=await this.getSeguimientos(e);return r.map(s=>{const i=n.filter(u=>u.beneficiarioId===s.id||u.beneficiario===s.beneficiary),a=i.filter(u=>u.tipoResultado==="exitoso");if(a.length===0)return{...s,estado:"urgente",ultimoContacto:null,diasSinContacto:null,totalSeguimientos:i.length};const o=a.sort((u,h)=>new Date(h.fechaContacto)-new Date(u.fechaContacto))[0],l=Math.floor((new Date-new Date(o.fechaContacto))/(1e3*60*60*24));let c;return l<=15?c="al-dia":l<=30?c="pendiente":c="urgente",{...s,estado:c,ultimoContacto:o.fechaContacto,diasSinContacto:l,totalSeguimientos:i.length}})}catch(n){return console.error(" Error calculando estados de beneficiarios:",n),r.map(s=>({...s,estado:"urgente",totalSeguimientos:0}))}}async buscarSeguimientos(e,r={}){try{let n=gr(Pt(We,this.collection),pr("userId","==",e));r.beneficiario&&(n=gr(n,pr("beneficiario","==",r.beneficiario))),r.tipoResultado&&(n=gr(n,pr("tipoResultado","==",r.tipoResultado))),r.tipoContacto&&(n=gr(n,pr("tipoContacto","==",r.tipoContacto))),r.operador&&(n=gr(n,pr("operador","==",r.operador))),n=gr(n,qo("fechaContacto","desc"));const s=await Kr(n),i=[];return s.forEach(a=>{const o=a.data();if(r.fechaInicio&&r.fechaFin){const l=new Date(o.fechaContacto),c=new Date(r.fechaInicio),u=new Date(r.fechaFin);if(l<c||l>u)return}i.push({id:a.id,...o})}),i}catch(n){return console.error(" Error buscando seguimientos:",n),[]}}async migrarDatosLlamadas(e,r=[]){try{console.log(" Iniciando migracin de datos de llamadas...");const n=[];for(const s of r){const i={beneficiarioId:s.id||null,beneficiario:s.beneficiary||s.beneficiario,telefono:s.phone||s.telefono,tipoContacto:"llamada",tipoResultado:this.mapearResultadoLlamada(s.result||s.resultado),observaciones:s.observations||s.observaciones||"",fechaContacto:s.date||s.fecha||new Date().toISOString(),operadorId:e,operador:s.operator||s.operador||"Sistema",duracion:s.duration||s.duracion||0,evento:s.event||s.evento||"",migrado:!0,datosOriginales:s};try{const a=await Q1(Pt(We,this.collection),{...i,userId:e,createdAt:Rr(),updatedAt:Rr()});n.push(a.id)}catch(a){console.error("Error migrando seguimiento:",s,a)}}return console.log(` Migracin completada: ${n.length} seguimientos migrados`),n}catch(n){throw console.error(" Error en migracin:",n),new Error("Error en la migracin de datos")}}mapearResultadoLlamada(e){if(!e)return"fallido";const r=e.toLowerCase();return r.includes("exitoso")||r.includes("successful")?"exitoso":r.includes("ocupado")||r.includes("busy")?"ocupado":r.includes("no contest")||r.includes("no responde")?"no-respuesta":r.includes("mensaje")||r.includes("message")?"mensaje":"fallido"}async limpiarSeguimientosAntiguos(e,r=365){try{const n=new Date;n.setDate(n.getDate()-r);const s=gr(Pt(We,this.collection),pr("userId","==",e),pr("fechaContacto","<",n.toISOString())),i=await Kr(s),a=[];for(const o of i.docs)await Qc(o.ref),a.push(o.id);return console.log(` Limpieza completada: ${a.length} seguimientos antiguos eliminados`),a.length}catch(n){throw console.error(" Error en limpieza:",n),new Error("Error al limpiar seguimientos antiguos")}}}const Ok=new Ase,i0=({title:t,value:e,icon:r,color:n="blue",subtitle:s,percentage:i=null,trend:a=null})=>{const o={blue:{bg:"bg-white",border:"border-gray-200",icon:"text-gray-600",text:"text-gray-900",accent:"text-gray-600",shadow:"shadow-sm hover:shadow-md"},green:{bg:"bg-white",border:"border-gray-200",icon:"text-teal-600",text:"text-gray-900",accent:"text-teal-600",shadow:"shadow-sm hover:shadow-md"},yellow:{bg:"bg-white",border:"border-gray-200",icon:"text-orange-500",text:"text-gray-900",accent:"text-orange-500",shadow:"shadow-sm hover:shadow-md"},red:{bg:"bg-white",border:"border-gray-200",icon:"text-red-500",text:"text-gray-900",accent:"text-red-500",shadow:"shadow-sm hover:shadow-md"}},l=o[n]||o.blue;return f.jsxs(Le.div,{className:`
        ${l.bg} ${l.border} ${l.shadow}
        border rounded-xl p-6 transition-all duration-200
        cursor-default
      `,whileHover:{scale:1.02},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:15},children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-2 rounded-lg bg-gray-50",children:f.jsx(r,{className:`w-5 h-5 ${l.icon}`})}),a&&f.jsxs("div",{className:`text-xs font-medium ${a>0?"text-teal-600":a<0?"text-red-500":"text-gray-500"}`,children:[a>0?"":a<0?"":""," ",Math.abs(a),"%"]})]}),f.jsxs("div",{className:"mb-2",children:[f.jsx(Le.div,{className:`text-3xl font-bold ${l.text}`,initial:{scale:.5},animate:{scale:1},transition:{type:"spring",stiffness:200,delay:.1},children:typeof e=="number"?e.toLocaleString():e}),i!==null&&f.jsxs(Le.div,{className:`text-sm font-medium ${l.accent} mt-1`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[i,"% del total"]})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:t}),s&&f.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:s})]}),i!==null&&i<=100&&f.jsx("div",{className:"mt-4",children:f.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:f.jsx(Le.div,{className:`h-2 rounded-full ${n==="green"?"bg-teal-500":n==="yellow"?"bg-orange-500":n==="red"?"bg-red-500":"bg-gray-400"}`,initial:{width:0},animate:{width:`${i}%`},transition:{duration:1,ease:"easeOut",delay:.3}})})})]})},kse=({beneficiario:t,seguimientos:e=[],onSelect:r,onNewContact:n})=>{const[s,i]=te.useState(!1),a=()=>{const v=e.filter(O=>O.tipoResultado==="exitoso");if(v.length===0)return{estado:"urgente",ultimoContacto:null,diasSinContacto:null,mensaje:"Sin contactos exitosos"};const _=v.sort((O,P)=>new Date(P.fechaContacto)-new Date(O.fechaContacto))[0],w=Math.floor((new Date-new Date(_.fechaContacto))/(1e3*60*60*24));let y,I;return w<=15?(y="al-dia",I=`ltimo contacto hace ${w} da${w!==1?"s":""}`):w<=30?(y="pendiente",I=`${w} das sin contacto`):(y="urgente",I=`${w} das sin contacto!`),{estado:y,ultimoContacto:_.fechaContacto,diasSinContacto:w,mensaje:I}},{estado:o,ultimoContacto:l,diasSinContacto:c,mensaje:u}=a(),m={"al-dia":{bg:"bg-white",border:"border-gray-200",text:"text-gray-900",icon:Ka,iconColor:"text-teal-600",badge:"bg-teal-50 text-teal-700 border border-teal-200",shadow:"shadow-sm hover:shadow-md"},pendiente:{bg:"bg-white",border:"border-gray-200",text:"text-gray-900",icon:Li,iconColor:"text-orange-500",badge:"bg-orange-50 text-orange-700 border border-orange-200",shadow:"shadow-sm hover:shadow-md"},urgente:{bg:"bg-white",border:"border-gray-200",text:"text-gray-900",icon:mi,iconColor:"text-red-500",badge:"bg-red-50 text-red-700 border border-red-200",shadow:"shadow-sm hover:shadow-md"}}[o],p=m.icon,x=v=>{if(!v)return"N/A";try{return new Date(v).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Santiago"})}catch(_){return console.error("Error formateando fecha:",_),"Fecha invlida"}},g=v=>{if(!v)return"Sin telfono";const _=v.replace(/\D/g,"");return _.length===9?`+56 ${_.substring(0,1)} ${_.substring(1,5)} ${_.substring(5)}`:v};return f.jsxs(Le.div,{className:`
        ${m.bg} 
        ${m.border} ${m.shadow}
        border rounded-xl overflow-hidden transition-all duration-200
        cursor-pointer
      `,onClick:r,whileHover:{scale:1.02},layout:!0,children:[f.jsxs("div",{className:"p-4",children:[f.jsxs("div",{className:"flex items-start justify-between mb-3",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:t.beneficiary||"Sin nombre"}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx(p,{className:`w-4 h-4 ${m.iconColor}`}),f.jsx("span",{className:"text-xs font-medium text-gray-600",children:o==="al-dia"?"Al da":o==="pendiente"?"Pendiente":"Urgente"})]})]}),f.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${m.badge}`,children:[e.length," contacto",e.length!==1?"s":""]})]}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[f.jsx(zr,{className:"w-4 h-4"}),f.jsx("span",{className:"truncate",children:g(t.primaryPhone)})]}),t.commune&&f.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[f.jsx(n4,{className:"w-4 h-4"}),f.jsx("span",{className:"truncate",children:t.commune})]}),f.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[f.jsx(P5,{className:"w-4 h-4"}),f.jsx("span",{className:"text-xs",children:u})]})]}),f.jsxs("div",{className:"flex items-center justify-between mt-4",children:[f.jsxs("button",{onClick:v=>{v.stopPropagation(),i(!s)},className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:[s?f.jsx(JC,{className:"w-4 h-4"}):f.jsx(QC,{className:"w-4 h-4"}),"Historial"]}),f.jsxs(Le.button,{onClick:v=>{v.stopPropagation(),n()},className:"flex items-center gap-1 bg-slate-700 hover:bg-slate-800 text-white text-xs px-3 py-1.5 rounded-lg transition-colors shadow-sm",whileHover:{scale:1.05},whileTap:{scale:.95},children:[f.jsx(xv,{className:"w-3 h-3"}),"Contacto"]})]})]}),f.jsx(pl,{children:s&&f.jsx(Le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"border-t border-gray-200 dark:border-gray-700",children:f.jsx("div",{className:"p-4 bg-white/50 dark:bg-gray-800/50",children:e.length===0?f.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400 text-sm",children:[f.jsx(s4,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Sin seguimientos registrados"]}):f.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:[e.sort((v,_)=>new Date(_.fechaContacto)-new Date(v.fechaContacto)).slice(0,5).map((v,_)=>f.jsxs(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:_*.1},className:`p-3 rounded-lg border ${v.tipoResultado==="exitoso"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":v.tipoResultado==="fallido"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"}`,children:[f.jsxs("div",{className:"flex items-start justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[v.tipoResultado==="exitoso"&&f.jsx(Ka,{className:"w-4 h-4 text-green-600"}),v.tipoResultado==="fallido"&&f.jsx(mi,{className:"w-4 h-4 text-red-600"}),f.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-white",children:v.tipoContacto||"Contacto"})]}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:x(v.fechaContacto)})]}),v.observaciones&&f.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:v.observaciones})]},v.id||_)),e.length>5&&f.jsx("div",{className:"text-center",children:f.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",e.length-5," seguimiento",e.length-5!==1?"s":""," ms"]})})]})})})})]})},bse=({beneficiario:t=null,beneficiarios:e=[],onSave:r,onClose:n})=>{const s=()=>{const E=new Date,A=new Date(E.toLocaleString("en-US",{timeZone:"America/Santiago"})),N=A.getFullYear(),C=String(A.getMonth()+1).padStart(2,"0"),R=String(A.getDate()).padStart(2,"0"),F=String(A.getHours()).padStart(2,"0"),oe=String(A.getMinutes()).padStart(2,"0");return`${N}-${C}-${R}T${F}:${oe}`},[i,a]=te.useState({beneficiarioId:(t==null?void 0:t.id)||"",beneficiario:(t==null?void 0:t.beneficiary)||"",telefono:(t==null?void 0:t.primaryPhone)||"",tipoContacto:"llamada",tipoResultado:"",observaciones:"",fechaContacto:s()}),[o,l]=te.useState({}),[c,u]=te.useState(!1),[h,m]=te.useState(!t),[p,x]=te.useState(""),g=te.useRef(null),v=te.useRef(null);te.useEffect(()=>{v.current&&v.current.focus()},[]),te.useEffect(()=>{const E=A=>{A.key==="Escape"&&n()};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[n]);const _=[{value:"llamada",label:"Llamada Telefnica",icon:zr},{value:"presencial",label:"Visita Presencial",icon:Xa}],w=[{value:"exitoso",label:"Contacto Exitoso",icon:Ka,color:"text-emerald-700"},{value:"no-respuesta",label:"No Responde",icon:EE,color:"text-amber-700"},{value:"ocupado",label:"Lnea Ocupada",icon:Li,color:"text-slate-600"},{value:"mensaje",label:"Mensaje Dejado",icon:s4,color:"text-slate-700"},{value:"fallido",label:"Llamada Fallida",icon:EE,color:"text-rose-700"}],y=e.filter(E=>{var A,N,C;return((A=E.beneficiary)==null?void 0:A.toLowerCase().includes(p.toLowerCase()))||((N=E.primaryPhone)==null?void 0:N.includes(p))||((C=E.commune)==null?void 0:C.toLowerCase().includes(p.toLowerCase()))});te.useEffect(()=>{console.log(" NewContactForm - Debug beneficiarios:",{totalBeneficiarios:e.length,searchTerm:p,beneficiariosFiltrados:y.length,primerosEjemplos:e.slice(0,3).map(E=>({beneficiary:E.beneficiary,primaryPhone:E.primaryPhone,commune:E.commune}))})},[e,p,y.length]);const I=(E,A)=>{a(N=>({...N,[E]:A})),o[E]&&l(N=>({...N,[E]:null}))},O=E=>{a(A=>({...A,beneficiarioId:E.id||"",beneficiario:E.beneficiary||"",telefono:E.primaryPhone||""})),m(!1),x("")},P=()=>{const E={};return i.beneficiario.trim()||(E.beneficiario="Debe seleccionar un beneficiario"),i.tipoContacto||(E.tipoContacto="Debe seleccionar el tipo de contacto"),i.tipoResultado||(E.tipoResultado="Debe seleccionar el resultado del contacto"),i.fechaContacto||(E.fechaContacto="Debe especificar la fecha y hora"),l(E),Object.keys(E).length===0},S=async E=>{if(E.preventDefault(),!!P()){u(!0);try{await r({...i,id:Date.now().toString(),createdAt:new Date().toISOString()})}catch(A){console.error("Error guardando contacto:",A),l({submit:"Error al guardar el contacto. Intenta nuevamente."})}finally{u(!1)}}};return f.jsx(Le.div,{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E=>{E.target===E.currentTarget&&n()},children:f.jsxs(Le.div,{ref:g,className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:E=>E.stopPropagation(),children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Registrar Nuevo Contacto"}),f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ingresa los detalles del seguimiento realizado"})]}),f.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(Bc,{className:"w-5 h-5 text-gray-500"})})]}),f.jsxs("form",{onSubmit:S,className:"p-6 space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beneficiario *"}),h?f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),f.jsx("input",{ref:v,type:"text",placeholder:"Buscar beneficiario por nombre, telfono o comuna...",value:p,onChange:E=>x(E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white text-gray-900 shadow-sm transition-all duration-200"})]}),f.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-lg",children:y.length===0?f.jsx("div",{className:"p-4 text-center text-gray-500",children:p?"No se encontraron beneficiarios":"Escribe para buscar beneficiarios"}):y.map((E,A)=>f.jsxs("button",{type:"button",onClick:()=>O(E),className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[f.jsx("div",{className:"font-medium text-gray-900",children:E.beneficiary}),f.jsxs("div",{className:"text-sm text-gray-600",children:[E.primaryPhone,"  ",E.commune]})]},E.id||A))})]}):f.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-gray-50",children:[f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-gray-900",children:i.beneficiario}),f.jsx("div",{className:"text-sm text-gray-600",children:i.telefono})]}),f.jsx("button",{type:"button",onClick:()=>m(!0),className:"text-teal-600 hover:text-teal-700 text-sm font-medium",children:"Cambiar"})]}),o.beneficiario&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.beneficiario})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha y Hora del Contacto *"}),f.jsxs("div",{className:"relative",children:[f.jsx(YC,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),f.jsx("input",{type:"datetime-local",value:i.fechaContacto,onChange:E=>I("fechaContacto",E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white text-gray-900 shadow-sm transition-all duration-200"})]}),o.fechaContacto&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.fechaContacto})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Contacto *"}),f.jsx("div",{className:"flex gap-3",children:_.map(E=>{const A=E.icon;return f.jsx("button",{type:"button",onClick:()=>I("tipoContacto",E.value),className:`flex-1 p-3 rounded-lg border-2 transition-colors ${i.tipoContacto===E.value?"border-teal-500 bg-teal-50 text-teal-700":"border-gray-200 hover:border-gray-300"}`,children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx(A,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm font-medium",children:E.label})]})},E.value)})}),o.tipoContacto&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.tipoContacto})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resultado del Contacto *"}),f.jsx("div",{className:"grid grid-cols-1 gap-2",children:w.map(E=>{const A=E.icon;return f.jsx("button",{type:"button",onClick:()=>I("tipoResultado",E.value),className:`p-3 rounded-lg border-2 transition-colors text-left ${i.tipoResultado===E.value?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(A,{className:`w-5 h-5 ${E.color}`}),f.jsx("span",{className:"font-medium text-gray-900",children:E.label})]})},E.value)})}),o.tipoResultado&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.tipoResultado})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaciones"}),f.jsx("textarea",{value:i.observaciones,onChange:E=>I("observaciones",E.target.value),placeholder:"Notas adicionales sobre el contacto...",rows:4,className:"w-full px-3 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white text-gray-900 resize-none shadow-sm transition-all duration-200"})]}),o.submit&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:f.jsx("p",{className:"text-red-700 text-sm",children:o.submit})}),f.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[f.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:c,children:"Cancelar"}),f.jsx(Le.button,{type:"submit",disabled:c,className:"flex items-center gap-2 bg-teal-600 hover:bg-teal-700 disabled:bg-teal-400 text-white px-6 py-2 rounded-lg transition-colors shadow-sm",whileHover:{scale:1.05},whileTap:{scale:.95},children:c?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Guardando..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yv,{className:"w-4 h-4"}),"Guardar Contacto"]})})]})]})]})})},Cse=()=>{var N;const{user:t}=Nl(),{operators:e,getAllAssignments:r,getAssignmentsByEmail:n}=Dn(),{callData:s}=Sh(),[i,a]=te.useState([]),[o,l]=te.useState([]),[c,u]=te.useState(!0),[h,m]=te.useState(null),[p,x]=te.useState(!1),[g,v]=te.useState(""),[_,w]=te.useState("todos"),y=(t==null?void 0:t.role)===DZ.ADMIN||((N=t==null?void 0:t.email)==null?void 0:N.includes("admin")),I=y?"Administrador":(t==null?void 0:t.displayName)||(t==null?void 0:t.email);te.useEffect(()=>{t&&(console.log(" Usuario autenticado, cargando datos directamente desde Firebase..."),O())},[t==null?void 0:t.uid]);const O=async()=>{var C,R,F;if(!t){console.log(" No hay usuario autenticado");return}u(!0);try{console.log(" Cargando datos para:",t==null?void 0:t.email);const oe=await Ok.getSeguimientos(t.uid);console.log(" Seguimientos Firebase:",oe.length);const{getFollowUpData:ae}=Sh.getState(),ve=r(),he=ae(ve);console.log(" Seguimientos del Excel:",he.length);let Z=[];if(y)Z=r(),console.log(" Admin - Total:",Z.length);else{console.log(" Consultando Firebase directamente para teleoperadora:",t==null?void 0:t.email);try{const{operatorService:ue,assignmentService:L}=await I0(async()=>{const{operatorService:re,assignmentService:ee}=await Promise.resolve().then(()=>ex);return{operatorService:re,assignmentService:ee}},void 0);console.log(" Obteniendo operadores desde Firebase...");const K=await ue.getAll();console.log(" Operadores obtenidos desde Firebase:",K.length);const X=(C=t==null?void 0:t.email)==null?void 0:C.toLowerCase().trim(),H=K.find(re=>{var we;const ee=(we=re.email)==null?void 0:we.toLowerCase().trim(),le=ee===X;return console.log(` Verificando operador ${re.name}:`,{opEmail:ee,userEmail:X,exactMatch:le}),le});if(H){console.log(" Operador encontrado en Firebase:",H),console.log(" Obteniendo asignaciones desde Firebase...");const re=await L.getAll();console.log(" Asignaciones obtenidas desde Firebase:",re.length);const ee=re.filter(de=>de.operatorId===H.id);console.log(` DEBUGGING FILTRO - Buscando asignaciones para operatorId: ${H.id}`),console.log(" Primeras 3 asignaciones de Firebase:",re.slice(0,3)),console.log(" Estructura de primera asignacin:",re[0]);const le=[...new Set(re.map(de=>de.operatorId))];console.log(" Todos los operatorId en Firebase:",le),console.log(" Buscando operatorId:",H.id),console.log(" Existe el operatorId?",le.includes(H.id));let we=ee;ee.length===0&&(console.log(" No se encontraron asignaciones por operatorId, intentando bsqueda por nombre..."),we=re.filter(de=>{const Pe=de.operator||de.operatorName||"",B=H.name||"",et=Pe.toLowerCase().includes(B.toLowerCase())||B.toLowerCase().includes(Pe.toLowerCase());return et&&console.log(" Coincidencia por nombre:",{assignmentOperator:Pe,matchingOperator:B}),et}),console.log(` Asignaciones encontradas por nombre: ${we.length}`)),console.log(` Asignaciones finales para ${H.name}:`,we.length),Z=we.map(de=>({id:de.id,operator:H.name,operatorName:H.name,operatorEmail:H.email,beneficiary:de.beneficiary,primaryPhone:de.primaryPhone||de.phone,commune:de.commune})),console.log(` RESULTADO FINAL: ${Z.length} beneficiarios para dashboard de ${H.name}`)}else console.warn(" No se encontr operador en Firebase para:",t==null?void 0:t.email),console.log(" Operadores disponibles en Firebase:",K.map(re=>({name:re.name,email:re.email,id:re.id})))}catch(ue){console.error(" Error consultando Firebase directamente:",ue),console.log(" Fallback: intentando usar store...");const{operators:L,operatorAssignments:K}=Dn.getState();if(L.length>0){console.log(" Store tiene operadores, usando fallback...");const X=(R=t==null?void 0:t.email)==null?void 0:R.toLowerCase().trim(),H=L.find(re=>{var ee;return((ee=re.email)==null?void 0:ee.toLowerCase().trim())===X});H&&(Z=(K[H.id]||[]).map(ee=>({id:ee.id,operator:H.name,operatorName:H.name,operatorEmail:H.email,beneficiary:ee.beneficiary,primaryPhone:ee.primaryPhone||ee.phone,commune:ee.commune})),console.log(` Fallback exitoso: ${Z.length} asignaciones`))}}}let W=[...oe];if(!y){const ue=(F=t==null?void 0:t.email)==null?void 0:F.toLowerCase().trim(),L=he.filter(H=>{var le,we,de,Pe,B;const ee=((le=H.operatorEmail)==null?void 0:le.toLowerCase().trim())===ue||((de=H.operator)==null?void 0:de.toLowerCase().includes(((we=t==null?void 0:t.displayName)==null?void 0:we.toLowerCase())||""))||((Pe=H.operator)==null?void 0:Pe.toLowerCase().includes("javiera"))||((B=H.operator)==null?void 0:B.toLowerCase().includes("reyes"));return ee&&console.log(" Seguimiento del Excel para esta teleoperadora:",{beneficiario:H.beneficiary,operador:H.operator,ultimaLlamada:H.lastCall}),ee});if(console.log(` Seguimientos Excel filtrados para ${t==null?void 0:t.email}:`,L.length),L.length>0){console.log(" Muestra de seguimientos del Excel:",L.slice(0,3));const H=L.find(re=>{var ee,le;return((ee=re.beneficiary)==null?void 0:ee.toLowerCase().includes("sergio"))&&((le=re.beneficiary)==null?void 0:le.toLowerCase().includes("romn"))});H&&console.log(" SERGIO en datos Excel:",H)}const K=L.map((H,re)=>{var de,Pe,B,et,Ye,tt;const ee=((de=H.lastCall)==null?void 0:de.toLowerCase().includes("exitoso"))||((Pe=H.lastCall)==null?void 0:Pe.toLowerCase().includes("contactado"))||((B=H.lastCall)==null?void 0:B.toLowerCase().includes("atendido"))||((et=H.lastCall)==null?void 0:et.toLowerCase().includes("respondi"))||H.status==="al-dia"||H.callCount>0;let le;if(H.lastCallDate)le=new Date(H.lastCallDate).toISOString();else if(H.fecha)le=new Date(H.fecha).toISOString();else{const He=new Date;He.setDate(He.getDate()-(ee?1:31)),le=He.toISOString()}const we={id:`excel_${H.id||re}_${Math.random()}`,beneficiarioId:H.beneficiary,beneficiario:H.beneficiary,telefono:H.phone||"Sin telfono",tipoContacto:"llamada",tipoResultado:ee?"exitoso":"no-respuesta",observaciones:`Registro del Excel: ${H.lastCall||H.status||"Contacto registrado"}`,fechaContacto:le,operadorEmail:t==null?void 0:t.email,operadorNombre:(t==null?void 0:t.displayName)||(t==null?void 0:t.email),source:"excel"};return(Ye=H.beneficiary)!=null&&Ye.toLowerCase().includes("sergio")&&((tt=H.beneficiary)!=null&&tt.toLowerCase().includes("romn"))&&console.log(" CONVERSIN SERGIO:",{original:H,convertido:we}),we});W=[...oe,...K],console.log(` Total seguimientos combinados: ${W.length} (Firebase: ${oe.length}, Excel: ${K.length})`);const X=W.filter(H=>{var re,ee;return((re=H.beneficiario)==null?void 0:re.toLowerCase().includes("sergio"))&&((ee=H.beneficiario)==null?void 0:ee.toLowerCase().includes("romn"))});X.length>0&&console.log(" SERGIO ROMN ROJAS encontrado en seguimientos:",X)}a(Z),l(W),console.log(" VERIFICACIN FINAL:"),console.log(`   Beneficiarios cargados: ${Z.length}`),console.log(`   Seguimientos totales: ${W.length}`);const ie=Z.find(ue=>{var L,K;return((L=ue.beneficiary)==null?void 0:L.toLowerCase().includes("sergio"))&&((K=ue.beneficiary)==null?void 0:K.toLowerCase().includes("romn"))});if(ie){console.log(" Sergio encontrado en beneficiarios:",ie);const ue=W.filter(L=>{var K,X;return((K=L.beneficiario)==null?void 0:K.toLowerCase().includes("sergio"))&&((X=L.beneficiario)==null?void 0:X.toLowerCase().includes("romn"))});console.log(` Seguimientos de Sergio: ${ue.length}`,ue)}else console.log(" Sergio NO encontrado en beneficiarios")}catch(oe){console.error("Error cargando datos del dashboard:",oe)}finally{u(!1)}},P=async C=>{try{console.log(" Guardando nuevo seguimiento:",C);const R=ae=>{const[ve,he]=ae.split("T"),[Z,W,ie]=ve.split("-"),[ue,L]=he.split(":"),K=new Date;return K.setFullYear(parseInt(Z)),K.setMonth(parseInt(W)-1),K.setDate(parseInt(ie)),K.setHours(parseInt(ue)),K.setMinutes(parseInt(L)),K.setSeconds(0),K.setMilliseconds(0),K.toISOString()};console.log(" Fecha original:",C.fechaContacto),console.log(" Fecha convertida a ISO chileno:",R(C.fechaContacto));const F={beneficiarioId:C.beneficiarioId,beneficiario:C.beneficiario,telefono:C.telefono,tipoContacto:C.tipoContacto,tipoResultado:C.tipoResultado,observaciones:C.observaciones,fechaContacto:R(C.fechaContacto),operadorEmail:t==null?void 0:t.email,operadorNombre:(t==null?void 0:t.displayName)||(t==null?void 0:t.email)},oe=await Ok.createSeguimiento(t.uid,F);console.log(" Seguimiento guardado con ID:",oe),await O(),x(!1),m(null)}catch(R){throw console.error(" Error guardando seguimiento:",R),new Error("Error al guardar el contacto. Intenta nuevamente.")}},S=C=>{var Z,W;const R=o.filter(ie=>ie.beneficiarioId===C.id||ie.beneficiario===C.beneficiary),F=((Z=C.beneficiary)==null?void 0:Z.toLowerCase().includes("sergio"))&&((W=C.beneficiary)==null?void 0:W.toLowerCase().includes("romn"));if(F&&(console.log(" DEBUG SERGIO ROMN ROJAS:"),console.log("   Beneficiario:",C.beneficiary),console.log("   ID:",C.id),console.log("   Seguimientos encontrados:",R.length),console.log("   Seguimientos:",R),console.log("   Total seguimientos disponibles:",o.length)),R.length===0)return F&&console.log("    Sin seguimientos - estado URGENTE"),{estado:"urgente",ultimoContacto:null,diasSinContacto:null};const oe=R.filter(ie=>ie.tipoResultado==="exitoso");if(F&&(console.log("   Contactos exitosos:",oe.length),oe.forEach(ie=>console.log("     -",ie.fechaContacto,ie.tipoResultado))),oe.length===0)return F&&console.log("    Sin contactos exitosos - estado URGENTE"),{estado:"urgente",ultimoContacto:null,diasSinContacto:null};const ae=oe.sort((ie,ue)=>new Date(ue.fechaContacto)-new Date(ie.fechaContacto))[0],ve=Math.floor((new Date-new Date(ae.fechaContacto))/(1e3*60*60*24));let he;return ve<=15?he="al-dia":ve<=30?he="pendiente":he="urgente",F&&(console.log("    ltimo contacto:",ae.fechaContacto),console.log("    Das sin contacto:",ve),console.log("    Estado final:",he)),{estado:he,ultimoContacto:ae.fechaContacto,diasSinContacto:ve,totalSeguimientos:R.length}},E=te.useMemo(()=>{const C=i.map(ae=>({...ae,...S(ae)})),R=C.filter(ae=>ae.estado==="al-dia").length,F=C.filter(ae=>ae.estado==="pendiente").length,oe=C.filter(ae=>ae.estado==="urgente").length;return{total:i.length,alDia:R,pendientes:F,urgentes:oe,beneficiariosConEstado:C}},[i,o]),A=te.useMemo(()=>{let C=E.beneficiariosConEstado;return g&&(C=C.filter(R=>{var F,oe,ae;return((F=R.beneficiary)==null?void 0:F.toLowerCase().includes(g.toLowerCase()))||((oe=R.primaryPhone)==null?void 0:oe.includes(g))||((ae=R.commune)==null?void 0:ae.toLowerCase().includes(g.toLowerCase()))})),_!=="todos"&&(C=C.filter(R=>_==="al-dia"?R.estado==="al-dia":_==="pendientes"?R.estado==="pendiente":_==="urgentes"?R.estado==="urgente":!0)),C},[E.beneficiariosConEstado,g,_]);return c?f.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:f.jsxs(Le.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Cargando dashboard..."})]})}):f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex justify-between items-center py-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(XC,{className:"w-8 h-8 text-teal-600"}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seguimientos Peridicos"})]}),f.jsxs("p",{className:"text-gray-600 mt-1",children:["Cartera de beneficiarios - ",(t==null?void 0:t.email)||I]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(Le.button,{onClick:async()=>{console.log(" DEBUG COMPLETO - Estado actual:"),console.log(" Usuario autenticado:",{email:t==null?void 0:t.email,displayName:t==null?void 0:t.displayName,uid:t==null?void 0:t.uid});try{const{operatorService:F,assignmentService:oe}=await I0(async()=>{const{operatorService:Z,assignmentService:W}=await Promise.resolve().then(()=>ex);return{operatorService:Z,assignmentService:W}},void 0),ae=await F.getAll();console.log(" Operadores en Firebase:",ae.length,ae);const ve=await oe.getAll();console.log(" Asignaciones en Firebase:",ve.length);const he=ae.find(Z=>{var W,ie;return((W=Z.email)==null?void 0:W.toLowerCase().includes("javiera"))||((ie=Z.email)==null?void 0:ie.toLowerCase())==="reyesalvaradojaviera@gmail.com"});if(he){console.log(" Javiera encontrada en Firebase:",he),console.log(" ESTRUCTURA DE ASIGNACIONES - Analizando..."),console.log(" Total asignaciones en Firebase:",ve.length);const Z=[...new Set(ve.map(L=>L.operatorId))];console.log(" OperatorIDs nicos en Firebase:",Z),console.log(" OperatorID de Javiera buscado:",he.id);const W=ve.filter(L=>L.operatorId===he.id);console.log(` Asignaciones con operatorId ${he.id}:`,W.length);const ie=ve.filter(L=>{const K=L.operator||L.operatorName||"";return K.toLowerCase().includes("javiera")||K.toLowerCase().includes("reyes")});if(console.log(' Asignaciones con nombre "Javiera" o "Reyes":',ie.length),console.log(" ESTRUCTURA - Primeras 3 asignaciones:",ve.slice(0,3)),ve.length>0){const L=ve[0];console.log(" CAMPOS DE ASIGNACIN DISPONIBLES:",Object.keys(L)),console.log(" ASIGNACIN COMPLETA EJEMPLO:",L)}const ue=ve.filter(L=>{const K=L.operatorId,X=L.operator||"",H=L.operatorName||"",re=L.userId;return K===he.id||X.toLowerCase().includes("javiera")||X.toLowerCase().includes("reyes")||H.toLowerCase().includes("javiera")||H.toLowerCase().includes("reyes")||re===he.id});console.log(" ASIGNACIONES POSIBLES DE JAVIERA (todos los mtodos):",ue.length),ue.length>0&&console.log(" Primeras 3 asignaciones encontradas:",ue.slice(0,3))}else console.log(" Javiera NO encontrada en Firebase")}catch(F){console.error(" Error consultando Firebase:",F)}const{operators:C,operatorAssignments:R}=Dn.getState();console.log(" Store - Operadores:",C.length),console.log(" Store - Asignaciones:",Object.keys(R).length),console.log(" Beneficiarios cargados en dashboard:",i.length),console.log(" Recargando dashboard..."),await O()},className:"flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded-lg transition-colors shadow-sm text-sm",whileHover:{scale:1.02},whileTap:{scale:.98},children:[f.jsx(mi,{className:"w-4 h-4"}),"Debug"]}),f.jsxs(Le.button,{onClick:async()=>{console.log(" RECARGA COMPLETA - Firebase + Dashboard..."),u(!0);try{const{loadOperators:C,loadAssignments:R}=Dn.getState();await C(),await R(),await O()}catch(C){console.error(" Error en recarga completa:",C)}u(!1)},className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded-lg transition-colors shadow-sm text-sm",whileHover:{scale:1.02},whileTap:{scale:.98},children:[f.jsx(TE,{className:"w-4 h-4"}),"Cargar Firebase"]}),f.jsxs(Le.button,{onClick:async()=>{console.log(" DIAGNSTICO COMPLETO DE MATCHING - Analizando por qu no encuentra asignaciones para Javiera"),console.log(" USUARIO ACTUAL:",{email:t==null?void 0:t.email,displayName:t==null?void 0:t.displayName,uid:t==null?void 0:t.uid,fullUser:t}),console.log(" VERIFICANDO OPERADORES DIRECTAMENTE DESDE FIREBASE...");try{const{operatorService:ve,assignmentService:he}=await I0(async()=>{const{operatorService:ue,assignmentService:L}=await Promise.resolve().then(()=>ex);return{operatorService:ue,assignmentService:L}},void 0),Z=await ve.getAll();console.log(" OPERADORES DESDE FIREBASE DIRECTO:",Z.length,Z);const W=await he.getAll();console.log(" ASIGNACIONES DESDE FIREBASE DIRECTO:",W.length);const ie=Z.find(ue=>{var L,K,X;return((L=ue.email)==null?void 0:L.toLowerCase().includes("javiera"))||((K=ue.name)==null?void 0:K.toLowerCase().includes("javiera"))||((X=ue.email)==null?void 0:X.toLowerCase())==="reyesalvaradojaviera@gmail.com"});if(ie){console.log(" JAVIERA ENCONTRADA EN FIREBASE:",ie);const ue=W.filter(L=>L.operatorId===ie.id);console.log(` ASIGNACIONES DE JAVIERA: ${ue.length}`,ue.slice(0,3))}else console.warn(" JAVIERA NO ENCONTRADA EN FIREBASE"),console.log(" OPERADORES DISPONIBLES EN FIREBASE:",Z.map(ue=>({id:ue.id,name:ue.name,email:ue.email})))}catch(ve){console.error(" Error accediendo Firebase directo:",ve)}const{operators:C,operatorAssignments:R}=Dn.getState();console.log(" OPERADORES EN STORE:",C.length,C),console.log(" ASIGNACIONES EN STORE:",Object.keys(R).length,R),console.log(" FORZANDO RECARGA DEL STORE...");const{loadOperators:F,loadAssignments:oe}=Dn.getState();await F(),await oe();const{operators:ae}=Dn.getState();console.log(" OPERADORES DESPUS DE RECARGA:",ae.length,ae),ae.length>0&&(console.log(" OPERADORES CARGADOS, RECARGANDO DASHBOARD..."),setTimeout(()=>{O()},500))},className:"flex items-center gap-2 bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-2 rounded-lg transition-colors shadow-sm text-sm",whileHover:{scale:1.02},whileTap:{scale:.98},children:[f.jsx(_s,{className:"w-4 h-4"}),"Diagnstico"]}),f.jsxs(Le.button,{onClick:()=>x(!0),className:"flex items-center gap-2 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors shadow-sm",whileHover:{scale:1.02},whileTap:{scale:.98},children:[f.jsx(xv,{className:"w-4 h-4"}),"Nuevo Contacto"]})]})]})})}),f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[f.jsx(i0,{title:"Total Beneficiarios",value:E.total,subtitle:"Mis beneficiarios asignados",icon:Dr,color:"blue"}),f.jsx(i0,{title:"Al Da",value:E.alDia,subtitle:"Contacto ltimos 15 das",percentage:E.total>0?Math.round(E.alDia/E.total*100):0,icon:Ka,color:"green"}),f.jsx(i0,{title:"Pendientes",value:E.pendientes,subtitle:"16-30 das sin contacto",percentage:E.total>0?Math.round(E.pendientes/E.total*100):0,icon:Li,color:"yellow"}),f.jsx(i0,{title:"Urgentes",value:E.urgentes,subtitle:"+30 das sin contacto",percentage:E.total>0?Math.round(E.urgentes/E.total*100):0,icon:mi,color:"red"})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[f.jsx("div",{className:"flex-1 max-w-md",children:f.jsxs("div",{className:"relative",children:[f.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),f.jsx("input",{type:"text",placeholder:"Buscar beneficiario, telfono o comuna...",value:g,onChange:C=>v(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})}),f.jsx("div",{className:"flex gap-2",children:[{key:"todos",label:"Todos",color:"teal"},{key:"al-dia",label:"Al Da",color:"green"},{key:"pendientes",label:"Pendientes",color:"yellow"},{key:"urgentes",label:"Urgentes",color:"red"}].map(C=>f.jsx(Le.button,{onClick:()=>w(C.key),className:`px-4 py-2 rounded-lg font-medium text-sm transition-colors ${_===C.key?`bg-${C.color}-100 text-${C.color}-800 border border-${C.color}-300`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:C.label},C.key))})]})}),i.length===0?f.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[f.jsx(mi,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:" No se encontraron asignaciones para tu usuario"}),f.jsxs("div",{className:"text-yellow-700 space-y-1",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Usuario:"})," ",t==null?void 0:t.email]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nombre mostrado:"})," ",(t==null?void 0:t.displayName)||"No definido"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Nombre de operadora buscado:"})," ",t==null?void 0:t.email]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Total de asignaciones en sistema:"})," ",r().length]})]}),f.jsxs("details",{className:"mt-4 text-left",children:[f.jsx("summary",{className:"cursor-pointer text-yellow-800 font-medium",children:" Ver operadoras disponibles"}),f.jsx("div",{className:"mt-2 text-sm space-y-1",children:e.map(C=>{var R;return f.jsxs("div",{className:"bg-yellow-100 p-2 rounded border",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Nombre:"})," ",C.name]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Email:"})," ",C.email]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Asignaciones:"})," ",((R=Dn.getState().operatorAssignments[C.id])==null?void 0:R.length)||0]})]},C.id)})})]}),f.jsxs(Le.button,{onClick:async()=>{console.log(" Recarga simple de datos..."),await O()},className:"mt-4 flex items-center gap-2 bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg mx-auto transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[f.jsx(TE,{className:"w-4 h-4"}),"Recargar asignaciones"]})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.jsx(pl,{children:A.map(C=>{const R=o.filter(F=>F.beneficiarioId===C.id||F.beneficiario===C.beneficiary);return f.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:f.jsx(kse,{beneficiario:C,seguimientos:R,onNewContact:()=>{m(C),x(!0)}})},C.id)})})}),i.length>0&&f.jsxs("div",{className:"mt-8 text-center text-gray-500 text-sm",children:["Mostrando ",A.length," de ",i.length," beneficiarios"]})]}),f.jsx(pl,{children:p&&f.jsx(bse,{beneficiario:h,beneficiarios:i,onClose:()=>{x(!1),m(null)},onSave:P})})]})},Ise=({roles:t,onSave:e,onClose:r,isLoading:n})=>{const[s,i]=te.useState({email:"",displayName:"",role:"teleoperadora",isActive:!0}),[a,o]=te.useState({}),l=te.useRef(null),c=te.useRef(null);te.useEffect(()=>{c.current&&c.current.focus()},[]),te.useEffect(()=>{const p=x=>{x.key==="Escape"&&r()};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[r]);const u=(p,x)=>{i(g=>({...g,[p]:x})),a[p]&&o(g=>({...g,[p]:null}))},h=()=>{const p={};return s.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)||(p.email="Email invlido"):p.email="El email es requerido",s.displayName.trim()||(p.displayName="El nombre es requerido"),s.role||(p.role="Selecciona un rol"),o(p),Object.keys(p).length===0},m=async p=>{if(p.preventDefault(),!!h())try{await e(s)}catch(x){o({submit:x.message})}};return f.jsx(Le.div,{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p=>{p.target===p.currentTarget&&r()},children:f.jsxs(Le.div,{ref:l,className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:p=>p.stopPropagation(),children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:f.jsx(Vc,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Crear Nuevo Usuario"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Ingresa los datos del nuevo usuario"})]})]}),f.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f.jsx(Bc,{className:"w-5 h-5 text-gray-500"})})]}),f.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre Completo *"}),f.jsxs("div",{className:"relative",children:[f.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),f.jsx("input",{ref:c,type:"text",value:s.displayName,onChange:p=>u("displayName",p.target.value),placeholder:"Ej: Mara Gonzlez",className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${a.displayName?"border-red-300":"border-gray-300 dark:border-gray-600"}`})]}),a.displayName&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.displayName})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email *"}),f.jsxs("div",{className:"relative",children:[f.jsx(r4,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),f.jsx("input",{type:"email",value:s.email,onChange:p=>u("email",p.target.value),placeholder:"usuario@empresa.com",className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${a.email?"border-red-300":"border-gray-300 dark:border-gray-600"}`})]}),a.email&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rol *"}),f.jsxs("div",{className:"relative",children:[f.jsx(f1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),f.jsx("select",{value:s.role,onChange:p=>u("role",p.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${a.role?"border-red-300":"border-gray-300 dark:border-gray-600"}`,children:t.filter(p=>p.id!=="super_admin").map(p=>f.jsxs("option",{value:p.id,children:[p.name," - ",p.description]},p.id))})]}),a.role&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.role})]}),f.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx(jc,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"text-sm",children:[f.jsx("p",{className:"font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Informacin importante sobre la creacin de usuarios"}),f.jsx("p",{className:"text-blue-700 dark:text-blue-300",children:"Se crear un perfil de usuario en el sistema. El usuario deber registrarse por separado en Firebase Auth usando el mismo email para poder acceder al sistema."})]})]})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("input",{type:"checkbox",id:"isActive",checked:s.isActive,onChange:p=>u("isActive",p.target.checked),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500"}),f.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Usuario activo al crear"})]}),a.submit&&f.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-3",children:[f.jsx(jc,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),f.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:a.submit})]}),f.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",disabled:n,children:"Cancelar"}),f.jsx(Le.button,{type:"submit",disabled:n,className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white px-6 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:n?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creando..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Vc,{className:"w-4 h-4"}),"Crear Usuario"]})})]})]})]})})},Nse=({user:t,roles:e,onSave:r,onClose:n,isLoading:s})=>{const[i,a]=te.useState({displayName:t.displayName||"",role:t.role||"teleoperadora",isActive:t.isActive!==!1}),[o,l]=te.useState({}),c=te.useRef(null),u=(p,x)=>{a(g=>({...g,[p]:x})),o[p]&&l(g=>({...g,[p]:null}))},h=()=>{const p={};return i.displayName.trim()||(p.displayName="El nombre es requerido"),i.role||(p.role="Selecciona un rol"),l(p),Object.keys(p).length===0},m=async p=>{if(p.preventDefault(),!!h())try{await r(i)}catch(x){l({submit:x.message})}};return f.jsx(Le.div,{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p=>p.target===p.currentTarget&&n(),children:f.jsxs(Le.div,{ref:c,className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:p=>p.stopPropagation(),children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Editar Usuario"}),f.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:f.jsx(Bc,{className:"w-5 h-5 text-gray-500"})})]}),f.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),f.jsx("input",{type:"email",value:t.email,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-500"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"El email no se puede modificar"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre Completo *"}),f.jsx("input",{type:"text",value:i.displayName,onChange:p=>u("displayName",p.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 ${o.displayName?"border-red-300":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`}),o.displayName&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.displayName})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rol *"}),f.jsx("select",{value:i.role,onChange:p=>u("role",p.target.value),disabled:t.role==="super_admin",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 ${o.role?"border-red-300":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white disabled:bg-gray-100 disabled:text-gray-500`,children:e.filter(p=>p.id!=="super_admin"||t.role==="super_admin").map(p=>f.jsx("option",{value:p.id,children:p.name},p.id))}),o.role&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.role})]}),f.jsx("div",{children:f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:i.isActive,onChange:p=>u("isActive",p.target.checked),disabled:t.role==="super_admin",className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500 disabled:opacity-50"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Usuario activo"})]})}),o.submit&&f.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[f.jsx(jc,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),f.jsx("p",{className:"text-red-700 text-sm",children:o.submit})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("button",{type:"button",onClick:n,disabled:s,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),f.jsx(Le.button,{type:"submit",disabled:s,className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white px-6 py-2 rounded-lg",whileHover:{scale:1.05},whileTap:{scale:.95},children:s?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Guardando..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yv,{className:"w-4 h-4"}),"Guardar"]})})]})]})]})})},Rse=()=>{var H,re;const{user:t}=Nl(),{users:e,roles:r,isLoading:n,stats:s,searchTerm:i,filterRole:a,selectedUser:o,setSearchTerm:l,setFilterRole:c,setSelectedUser:u,loadUsers:h,createUser:m,updateUser:p,deleteUser:x,toggleUserStatus:g,getFilteredUsers:v,isSuperAdmin:_,exportUsers:w}=g3(),[y,I]=te.useState("users"),[O,P]=te.useState(!1),[S,E]=te.useState(!1),[A,N]=te.useState(!1),[C,R]=te.useState(!1),[F,oe]=te.useState(!1),ae=_(t);te.useEffect(()=>{console.log(" SuperAdminDashboard: Efecto de carga ejecutndose"),console.log(" HasAccess:",ae),console.log(" User:",t==null?void 0:t.email),ae?(console.log(" Iniciando carga de usuarios..."),h()):console.log(" Sin acceso para cargar usuarios")},[ae,h]),te.useEffect(()=>{console.log(" Usuarios en el estado:",e),console.log(" Stats:",s),console.log(" Loading:",n)},[e,s,n]);const ve=v(),he=async ee=>{N(!0);try{await m(ee),P(!1)}catch(le){console.error("Error creando usuario:",le),alert("Error al crear usuario: "+le.message)}finally{N(!1)}},Z=async ee=>{if(o){N(!0);try{await p(o.id,ee),E(!1),u(null)}catch(le){console.error("Error editando usuario:",le),alert("Error al editar usuario: "+le.message)}finally{N(!1)}}},W=async ee=>{if(window.confirm("Ests seguro de eliminar este usuario?")){N(!0);try{await x(ee)}catch(le){console.error("Error eliminando usuario:",le),alert("Error al eliminar usuario: "+le.message)}finally{N(!1)}}},ie=async ee=>{N(!0);try{await g(ee)}catch(le){console.error("Error cambiando estado:",le),alert("Error al cambiar estado: "+le.message)}finally{N(!1)}},ue=async()=>{console.log(" Forzando recarga de usuarios..."),N(!0);try{await h(),console.log(" Recarga completada")}catch(ee){console.error(" Error en recarga:",ee),alert("Error al recargar usuarios: "+ee.message)}finally{N(!1)}},L=async()=>{var ee;console.log(" Ejecutando diagnstico..."),N(!0);try{const le=await jo.diagnoseUserCollection();console.log(" Resultado del diagnstico:",le);const we=`DIAGNSTICO DE USUARIOS
======================
Conexin exitosa: ${le.success}
Autenticado: ${le.authenticated}
Email: ${le.userEmail}
Super Admin: ${le.isSuperAdmin}
Documentos encontrados: ${le.documentsCount||0}

${((ee=le.documents)==null?void 0:ee.length)>0?`USUARIOS ENCONTRADOS:
`+le.documents.map(de=>` ${de.email} (${de.role})`).join(`
`):"No se encontraron usuarios en la coleccin"}

${le.error?`ERROR: ${le.error}`:""}`;alert(we)}catch(le){console.error(" Error en diagnstico:",le),alert("Error ejecutando diagnstico: "+le.message)}finally{N(!1)}},K=async()=>{console.log(" Iniciando creacin de usuarios de prueba..."),R(!0);try{const ee=await jo.createTestUsers();await h(),console.log(" Usuarios de prueba creados exitosamente:",ee),alert(` Se crearon ${ee.length} usuarios de prueba correctamente`)}catch(ee){console.error(" Error creando usuarios de prueba:",ee),alert(" Error creando usuarios de prueba: "+ee.message)}finally{R(!1)}},X=async()=>{if(window.confirm("Ests seguro de eliminar todos los usuarios de prueba?")){console.log(" Iniciando limpieza de usuarios de prueba..."),oe(!0);try{const ee=await jo.cleanTestUsers();await h(),console.log(" Usuarios de prueba eliminados:",ee),alert(` Se eliminaron ${ee} usuarios de prueba`)}catch(ee){console.error(" Error limpiando usuarios de prueba:",ee),alert(" Error limpiando usuarios de prueba: "+ee.message)}finally{oe(!1)}}};return ae?f.jsxs(Le.div,{className:"space-y-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[f.jsx(s5,{className:"w-8 h-8 text-purple-600"}),"Configuracin del Sistema"]}),f.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Gestin de usuarios, roles y configuracin del sistema"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs(Le.button,{onClick:ue,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},disabled:n||A,title:"Recargar usuarios desde Firebase",children:[f.jsx(Qf,{className:"w-4 h-4"}),n?"Cargando...":"Recargar"]}),f.jsxs(Le.button,{onClick:L,className:"flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Ejecutar diagnstico de la base de datos",disabled:A,children:[f.jsx(mi,{className:"w-4 h-4"}),"Diagnstico"]}),f.jsxs(Le.button,{onClick:K,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Crear usuarios de prueba para resolver la coleccin vaca",disabled:C||A,children:[f.jsx(Vc,{className:"w-4 h-4"}),C?"Creando...":"Crear Prueba"]}),f.jsxs(Le.button,{onClick:X,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Eliminar todos los usuarios de prueba",disabled:F||A,children:[f.jsx(Yf,{className:"w-4 h-4"}),F?"Limpiando...":"Limpiar Prueba"]}),f.jsxs(Le.button,{onClick:()=>P(!0),className:"flex items-center gap-2 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[f.jsx(xv,{className:"w-4 h-4"}),"Nuevo Usuario"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Total Usuarios"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.totalUsers})]}),f.jsx(Dr,{className:"w-8 h-8 text-blue-600"})]})}),f.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Usuarios Activos"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.activeUsers})]}),f.jsx(Ka,{className:"w-8 h-8 text-green-600"})]})}),f.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Administradores"}),f.jsx("p",{className:"text-2xl font-bold text-purple-600",children:((H=s.usersByRole)==null?void 0:H.admin)||0})]}),f.jsx(f1,{className:"w-8 h-8 text-purple-600"})]})}),f.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Teleoperadoras"}),f.jsx("p",{className:"text-2xl font-bold text-orange-600",children:((re=s.usersByRole)==null?void 0:re.teleoperadora)||0})]}),f.jsx(Vc,{className:"w-8 h-8 text-orange-600"})]})})]}),f.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),f.jsx("input",{type:"text",placeholder:"Buscar por nombre o email...",value:i,onChange:ee=>l(ee.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(t4,{className:"w-4 h-4 text-gray-400"}),f.jsxs("select",{value:a,onChange:ee=>c(ee.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"all",children:"Todos los roles"}),f.jsx("option",{value:"super_admin",children:"Super Admin"}),f.jsx("option",{value:"admin",children:"Administrador"}),f.jsx("option",{value:"auditor",children:"Auditor"}),f.jsx("option",{value:"teleoperadora",children:"Teleoperadora"})]})]})]})}),f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[f.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Usuarios (",ve.length,")"]})}),n?f.jsxs("div",{className:"flex items-center justify-center py-12",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),f.jsx("span",{className:"ml-2 text-gray-600",children:"Cargando usuarios..."})]}):ve.length===0?f.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[f.jsx(Dr,{className:"w-12 h-12 text-gray-400 mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay usuarios"}),f.jsx("p",{className:"text-gray-600 text-center mb-4",children:"No se encontraron usuarios o no tienes permisos para verlos."}),f.jsxs("button",{onClick:L,className:"flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors",children:[f.jsx(mi,{className:"w-4 h-4"}),"Ejecutar Diagnstico"]})]}):f.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:ve.map(ee=>f.jsx("div",{className:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:f.jsx(Dr,{className:"w-5 h-5 text-gray-600"})})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ee.displayName||ee.email}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:ee.email}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.role==="super_admin"?"bg-purple-100 text-purple-800":ee.role==="admin"?"bg-blue-100 text-blue-800":ee.role==="auditor"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:ee.role}),f.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ee.isActive?"Activo":"Inactivo"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>{u(ee),E(!0)},className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:f.jsx(i4,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>ie(ee.id),className:"p-2 text-gray-400 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",disabled:A,children:ee.isActive?f.jsx(ZC,{className:"w-4 h-4"}):f.jsx(e4,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>W(ee.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",disabled:A,children:f.jsx(Yf,{className:"w-4 h-4"})})]})]})},ee.id))})]}),f.jsx(pl,{children:O&&f.jsx(Le.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>P(!1),children:f.jsx(Le.div,{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:ee=>ee.stopPropagation(),children:f.jsx(Ise,{roles:r,onSave:he,onClose:()=>P(!1),isLoading:A})})})}),f.jsx(pl,{children:S&&o&&f.jsx(Le.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>E(!1),children:f.jsx(Le.div,{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:ee=>ee.stopPropagation(),children:f.jsx(Nse,{user:o,onSubmit:Z,onCancel:()=>{E(!1),u(null)},isLoading:A})})})})]}):f.jsx("div",{className:"flex items-center justify-center min-h-96",children:f.jsxs("div",{className:"text-center",children:[f.jsx(f1,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acceso Denegado"}),f.jsx("p",{className:"text-gray-600",children:"Este mdulo es solo para super administradores."})]})})},Pse=()=>{const{user:t}=Nl(),{roles:e,getRoleById:r,getUserPermissions:n,hasPermission:s,isSuperAdmin:i,canAccessModule:a}=g3(),o=te.useMemo(()=>t?t.email==="roberto@mistatas.com"?{...t,role:"super_admin",isActive:!0}:{...t,role:t.role||"teleoperadora",isActive:t.isActive!==!1}:null,[t]),l=te.useMemo(()=>o!=null&&o.role?r(o.role):null,[o==null?void 0:o.role,r]),c=te.useMemo(()=>o?n(o):[],[o,n]),u=te.useMemo(()=>i(o),[o,i]),h=E=>s(o,E),m=E=>a(o,E),p=m("dashboard"),x=m("calls"),g=m("assignments"),v=m("beneficiaries"),_=m("seguimientos"),w=m("history"),y=m("audit"),I=m("reports"),O=u,P=te.useMemo(()=>{const E=[];return p&&E.push({id:"dashboard",label:"Panel Principal",icon:"BarChart3"}),x&&E.push({id:"calls",label:"Registro de Llamadas",icon:"Phone"}),g&&E.push({id:"assignments",label:"Asignaciones",icon:"Users"}),v&&E.push({id:"beneficiaries",label:"Beneficiarios Base",icon:"Database"}),_&&E.push({id:"seguimientos",label:"Seguimientos Peridicos",icon:"Activity"}),w&&E.push({id:"history",label:"Historial de Seguimientos",icon:"Clock"}),y&&E.push({id:"audit",label:"Auditora Avanzada",icon:"BarChart3"}),O&&E.push({id:"config",label:"Configuracin",icon:"Settings"}),E},[p,x,g,v,_,w,y,O]),S=te.useMemo(()=>{var E;return _&&(o==null?void 0:o.role)==="teleoperadora"?"seguimientos":p?"dashboard":((E=P[0])==null?void 0:E.id)||"dashboard"},[_,p,o==null?void 0:o.role,P]);return{user:o,currentRole:l,permissions:c,isSuperAdmin:u,isAdmin:(o==null?void 0:o.role)==="admin"||u,isAuditor:(o==null?void 0:o.role)==="auditor",isTeleoperadora:(o==null?void 0:o.role)==="teleoperadora",checkPermission:h,checkModuleAccess:m,canViewDashboard:p,canViewCalls:x,canViewAssignments:g,canViewBeneficiaries:v,canViewSeguimientos:_,canViewHistory:w,canViewAudit:y,canViewReports:I,canViewConfig:O,visibleModules:P,defaultTab:S,hasAnyPermission:c.length>0,roleLevel:(l==null?void 0:l.level)||0,roleName:(l==null?void 0:l.name)||"Sin rol"}},Dse=()=>{const{user:t,logout:e}=Nl(),{user:r,isSuperAdmin:n,visibleModules:s,defaultTab:i,canViewConfig:a,checkModuleAccess:o}=Pse(),l=b=>{if(!b)return"N/A";try{let G;if(typeof b=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(b)){const J=b.split(/[-\/]/),Y=parseInt(J[0]),q=parseInt(J[1]),Q=parseInt(J[2]);if(Y<=31&&q<=12&&Q>=1900)return`${Y.toString().padStart(2,"0")}-${q.toString().padStart(2,"0")}-${Q}`}if(typeof b=="number"?G=new Date((b-25569)*86400*1e3):G=new Date(b),G&&!isNaN(G.getTime())){const J=G.getDate().toString().padStart(2,"0"),Y=(G.getMonth()+1).toString().padStart(2,"0"),q=G.getFullYear();return`${J}-${Y}-${q}`}return"Fecha invlida"}catch{return typeof b=="string"?b:"Error en fecha"}},{callData:c,processedData:u,callMetrics:h,setCallData:m,analyzeCallData:p,forceReanalysis:x,getOperatorMetrics:g,getHourlyDistribution:v,getFollowUpData:_,hasData:w,isLoading:y,loadingStage:I,loadingMessage:O,setLoadingStage:P}=Sh(),{operators:S,operatorAssignments:E,activeTab:A,setOperators:N,setOperatorAssignments:C,setActiveTab:R,getAllAssignments:F}=Dn(),[oe,ae]=te.useState("dashboard");te.useEffect(()=>{i&&oe==="dashboard"&&!o("dashboard")&&ae(i)},[i,o]);const[ve,he]=te.useState([]),[Z,W]=te.useState([]),[ie,ue]=te.useState("connecting"),[L,K]=te.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[X,H]=te.useState([]),[re,ee]=te.useState([]),[le,we]=te.useState("all"),[de,Pe]=te.useState(""),[B,et]=te.useState([]),[Ye,tt]=te.useState(!1),[He,be]=te.useState(null),[ct,ur]=te.useState({name:"",email:"",phone:""}),[Je,Mr]=te.useState({}),[ua,Cn]=te.useState(null);te.useEffect(()=>{B.length>0&&(console.log(" Sincronizando operators locales con Zustand:",B.length),N(B))},[B,N]),te.useEffect(()=>{Object.keys(Je).length>0&&(console.log(" Sincronizando operatorAssignments locales con Zustand:",Object.keys(Je).length),C(Je))},[Je,C]);const[Xt,In]=te.useState(!1),[gt,Mt]=te.useState(""),[Ct,br]=te.useState([]),ze=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}],Et=te.useRef(!1),[Bt,At]=te.useState(!1);te.useEffect(()=>{t&&!Bt&&!Et.current&&Hn()},[t,Bt]),te.useEffect(()=>{Bt&&B.length>0&&(console.log(" FORZANDO SINCRONIZACIN INICIAL CON ZUSTAND"),console.log(" Operators locales:",B.length),console.log(" OperatorAssignments locales:",Object.keys(Je).length),N(B),C(Je),setTimeout(()=>{const{operators:b,operatorAssignments:G}=Dn.getState();console.log(" Verificacin post-sincronizacin:",{zustandOperators:(b==null?void 0:b.length)||0,zustandAssignments:Object.keys(G||{}).length})},500))},[Bt,B,Je,N,C]),te.useEffect(()=>{if(c.length>0&&Object.keys(E).length>0){const b=setTimeout(()=>{console.log(" Re-analizando datos tras actualizacin de asignaciones (optimizado)...")},500);return()=>clearTimeout(b)}},[E]);const Hn=async()=>{if(!Et.current){Et.current=!0,ue("connecting");try{console.log(" Cargando datos generales del sistema...");const{loadOperators:b,loadAssignments:G}=Dn.getState();await Promise.all([b(),G()]);const{operators:J,operatorAssignments:Y}=Dn.getState();console.log(" DATOS GENERALES CARGADOS:",{operadores:(J==null?void 0:J.length)||0,asignacionesGrupos:Object.keys(Y||{}).length,totalAsignaciones:Object.values(Y||{}).flat().length});const[q,Q,se]=await Promise.all([kf.getByUser(t.uid),oc.getAllUserAssignments(t.uid),Z1.getCallData(t.uid)]);if(q!==null)et(q||[]),Mr(Q||{}),he(se||[]),N(q||[]),C(Q||{}),fa(Q||{},q||[]),se&&se.length>0?(console.log(" Cargando datos en Zustand store optimizado..."),m(se,"firebase")):(console.log(" No hay datos de llamadas, inicializando mtricas por defecto..."),Rs()),ue("connected"),At(!0),console.log(" Conectado a Firebase - datos cargados con optimizacin");else throw new Error("Insufficient permissions")}catch{ue("demo"),At(!0),yu()}finally{Et.current=!1}}},fa=(b,G)=>{const J=[];Object.entries(b).forEach(([Y,q])=>{const Q=G.find(se=>se.id===Y);Q&&q&&q.forEach(se=>{J.push({id:se.id,operator:Q.name,beneficiary:se.beneficiary,phone:se.primaryPhone,commune:se.commune})})}),W(J)},yu=()=>{console.log(" Inicializando con datos de ejemplo..."),W(ze);const b={};ze.forEach(J=>{let q=`operator-${J.operator.toLowerCase().replace(/\s+/g,"-")}`;b[q]||(b[q]=[]),b[q].push({id:J.id,beneficiary:J.beneficiary,beneficiario:J.beneficiary,primaryPhone:J.phone,phone:J.phone,commune:J.commune,comuna:J.commune})});const G=[...new Set(ze.map(J=>J.operator))].map((J,Y)=>({id:`operator-${J.toLowerCase().replace(/\s+/g,"-")}`,name:J,email:`${J.toLowerCase().replace(/\s+/g,".")}@example.com`,phone:`+56${Y+1}12345678`}));N(G),C(b),console.log(" Datos sincronizados con Zustand:",{operators:G,assignments:b}),vu(),Rs(),console.log(" Datos de ejemplo inicializados")},vu=()=>{const G=[{id:"sample-1",name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-2",name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-3",name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-4",name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-5",name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325",userId:(t==null?void 0:t.uid)||"demo-user"}].filter(J=>J&&J.id&&J.name);et(G)},ha=async()=>{if(ct.name.trim()!=="")try{const b=await kf.create(t.uid,ct);et([...B,b]),ur({name:"",email:"",phone:""}),tt(!1)}catch(b){console.error("Error creating operator:",b),alert("Error al crear teleoperador. Intenta nuevamente.")}},_o=async b=>{try{await kf.delete(b),await oc.deleteOperatorAssignments(t.uid,b),et(B.filter(Y=>Y.id!==b));const G={...Je};delete G[b],Mr(G);const J=Z.filter(Y=>!Y.id.toString().startsWith(`${b}-`));W(J)}catch(G){console.error("Error deleting operator:",G),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},Eo=(b,G)=>{const J=b.target.files[0];if(J){const Y=new FileReader;Y.onload=q=>{const Q=new Uint8Array(q.target.result),se=fh(Q,{type:"array"}),ye=se.SheetNames[0],me=se.Sheets[ye],xe=Sc.sheet_to_json(me,{header:1});Ci(xe,G)},Y.readAsArrayBuffer(J)}b.target.value=""},Ci=async(b,G)=>{if(b.length<2)return;const J=B.find(q=>q.id===G);if(!J)return;const Y=b.slice(1).map((q,Q)=>{const se=q[1]?String(q[1]).split(/[\|\-\s]+/).filter(ye=>ye.trim().length===9):[];return{id:`${G}-${Q}`,operatorId:G,operatorName:J.name,beneficiary:q[0]||"",phones:se,primaryPhone:se[0]||"",commune:q[2]||""}}).filter(q=>q.beneficiary&&q.primaryPhone);try{await oc.saveOperatorAssignments(t.uid,G,Y),Mr(Q=>({...Q,[G]:Y}));const q=Y.map(Q=>({id:Q.id,operator:Q.operatorName,beneficiary:Q.beneficiary,phone:Q.primaryPhone,commune:Q.commune}));W(Q=>[...Q.filter(ye=>!ye.id.toString().startsWith(`${G}-`)),...q]),Cn(null)}catch(q){console.error("Error saving assignments:",q),alert("Error al guardar asignaciones. Intenta nuevamente.")}},To=async b=>{try{await oc.deleteOperatorAssignments(t.uid,b);const G={...Je};delete G[b],Mr(G),W(J=>J.filter(Y=>!Y.id.toString().startsWith(`${b}-`)))}catch(G){console.error("Error clearing assignments:",G),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},Rs=()=>{if(ve.length>0){console.log(" Datos reales disponibles, omitiendo generacin de datos de ejemplo");return}console.log(" Generando datos de ejemplo...");const G=(B.length>0?B.map(Y=>Y.name):["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"]).map(Y=>({operator:Y,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),J=Array.from({length:24},(Y,q)=>({hour:q,calls:Math.floor(Math.random()*20)+1}));H(G),ee(J),K({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:Z.length||5,operators:B.length||5,protocolCompliance:85,pendingFollowUps:12}),Z.length>0},Ps=b=>{if(!b.trim()){br([]);return}console.log(" Iniciando bsqueda para:",b);const G=[];Object.entries(Je).forEach(([Q,se])=>{const ye=B.find(me=>me.id===Q);se&&Array.isArray(se)&&se.forEach(me=>{G.push({beneficiary:me.beneficiary||me.beneficiario,beneficiario:me.beneficiary||me.beneficiario,operatorName:(ye==null?void 0:ye.name)||me.operator||me.operatorName||"Operador no encontrado",operator:(ye==null?void 0:ye.name)||me.operator||me.operatorName,phone:me.primaryPhone||me.phone||me.telefono||me.numero_cliente||me.phones&&me.phones[0]||"N/A",primaryPhone:me.primaryPhone,phones:me.phones||[],telefono:me.telefono,numero_cliente:me.numero_cliente,commune:me.commune||me.comuna||"N/A",comuna:me.comuna,operatorId:Q,source:"operatorAssignments",id:me.id})})});const J=F();console.log(" Asignaciones de Zustand:",J),J.forEach(Q=>{G.push({beneficiary:Q.beneficiary||Q.beneficiario,beneficiario:Q.beneficiary||Q.beneficiario,operatorName:Q.operator||Q.operatorName||Q.name||"Sin asignar",operator:Q.operator||Q.operatorName||Q.name,phone:Q.phone||Q.telefono||Q.numero_cliente||"N/A",commune:Q.commune||Q.comuna||"N/A",operatorId:Q.operatorId||"zustand",source:"zustand"})}),console.log(" Total asignaciones encontradas:",G.length),console.log(" Muestra de asignaciones:",G.slice(0,3));const Y=b.toLowerCase().trim(),q=G.filter(Q=>{const se=(Q.beneficiary||Q.beneficiario||"").toLowerCase(),ye=(Q.operatorName||Q.operator||"").toLowerCase(),me=(Q.commune||Q.comuna||"").toLowerCase(),xe=[Q.phone,Q.primaryPhone,Q.telefono,Q.numero_cliente,...Q.phones||[]].filter(jr=>jr&&jr!=="N/A").join(" ").toLowerCase(),pe=se.includes(Y),Ce=ye.includes(Y),Oe=xe.includes(Y),qe=me.includes(Y),pt=pe||Ce||Oe||qe;return pt&&console.log(" Coincidencia encontrada:",{beneficiary:se,operator:ye,phones:xe,commune:me,searchTerm:Y,matches:{beneficiaryName:pe,operatorName:Ce,phones:Oe,commune:qe},source:Q.source}),pt});console.log(" Resultados filtrados:",q.length),br(q)},ei=te.useRef(null);te.useEffect(()=>()=>{ei.current&&clearTimeout(ei.current)},[]);const da=b=>{if(Mt(b),ei.current&&clearTimeout(ei.current),!b.trim()){br([]);return}ei.current=setTimeout(()=>{Ps(b)},300)},Rl=b=>{const G=b.target.files[0];if(G){P("uploading",`Subiendo archivo: ${G.name}`);const J=new FileReader;J.onload=Y=>{try{P("processing","Leyendo datos del archivo Excel...");const q=new Uint8Array(Y.target.result),Q=fh(q,{type:"array"}),se=Q.SheetNames[0],ye=Q.Sheets[se],me=Sc.sheet_to_json(ye,{header:1});Ii(me)}catch(q){console.error("Error al procesar archivo Excel:",q),P("error","Error al procesar el archivo Excel")}},J.onerror=()=>{P("error","Error al leer el archivo")},J.readAsArrayBuffer(G)}b.target.value=""},Ii=async b=>{if(b.length<2){P("error","El archivo Excel no contiene datos vlidos");return}try{P("processing",`Procesando ${b.length-1} filas de datos...`);const J=(q=>{const Q=q.slice(1,Math.min(6,q.length)),se=pe=>!pe||typeof pe!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(pe)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(pe)||!isNaN(Date.parse(pe))||/^\d+$/.test(pe)||pe.trim().length<3?!1:!!(pe.trim().split(/\s+/).filter(Oe=>Oe.length>1).length>=2||/^[a-zA-Z\s\-\.]+$/.test(pe)),ye={};for(let pe=0;pe<15;pe++){let Ce=0;const Oe=Q.map(qe=>qe[pe]).filter(qe=>qe!=null);if(Oe.length!==0){for(const qe of Oe)se(String(qe))&&Ce++;Ce>0&&(ye[pe]={score:Ce,percentage:Ce/Oe.length*100,sampleValues:Oe.slice(0,3)})}}console.log(" Anlisis de columnas para detectar operadores:",ye);let me=7,xe=0;for(const[pe,Ce]of Object.entries(ye))(Ce.score>xe||Ce.score===xe&&Ce.percentage>50)&&(xe=Ce.score,me=parseInt(pe));return console.log(` Columna de operadores detectada: ${me} (puntuacin: ${xe})`),me})(b),Y=b.slice(1).map((q,Q)=>{Q<3&&console.log(`Fila ${Q}:`,{col0:q[0],col1:q[1],col2:q[2],col3:q[3],col4:q[4],col5:q[5],col6:q[6],col7:q[7],col8:q[8],col9:q[9],col10:q[10],col11:q[11],operadorDetectado:q[J]});let se=q[J];if(se&&/^\d{1,2}:\d{2}/.test(String(se))){console.warn(` Valor de operador parece ser hora: "${se}". Buscando en otras columnas...`);for(let me=0;me<q.length;me++){const xe=q[me];if(xe&&typeof xe=="string"&&!/^\d{1,2}:\d{2}/.test(xe)&&!/^\d+$/.test(xe)&&xe.trim().split(/\s+/).length>=2){se=xe,console.log(` Operador encontrado en columna ${me}: "${se}"`);break}}}const ye=l;return{id:q[0]||`call-${Q}-${Date.now()}`,fecha:ye(q[1]),beneficiario:q[2],comuna:q[3],tipo_llamada:q[4]==="Entrante"?"entrante":"saliente",numero_cliente:q[5],hora:q[6]||"09:00:00",operador:se||"No identificado",duracion:parseInt(q[8])||0,categoria:q[9]==="Llamado exitoso"?"exitosa":"fallida",resultado:q[9],observacion:q[10],apiId:q[11]}});try{ie==="connected"&&await Z1.saveCallData(t.uid,Y)&&console.log(" Datos de llamadas guardados en Firebase")}catch(q){console.error("Error guardando datos en Firebase:",q)}m(Y,"excel"),allAssignments.length===0&&Y.length>0&&(console.log(" No hay asignaciones previas, creando asignaciones basadas en operadoras detectadas..."),Pl(Y)),console.log(` Procesados ${Y.length} registros en Zustand`)}catch(G){console.error("Error durante el procesamiento de datos:",G),P("error","Error al procesar los datos del Excel")}},Pl=b=>{try{const G={},J=se=>!se||typeof se!="string"?!1:se.trim().length>2&&!/^\d{1,2}:\d{2}/.test(se)&&!/^\d+$/.test(se)&&!/^(si|no|exitoso|fallido|pendiente|hangup|solo)$/i.test(se)&&/^[a-zA-Z\s\-\.]{3,}$/.test(se);b.forEach(se=>{const ye=se.beneficiario||se.beneficiary,me=se.operador||se.operator||se.teleoperadora;ye&&me&&J(me)&&(G[me]||(G[me]=new Set),G[me].add(ye))});const Y=Object.keys(G).map((se,ye)=>({id:`auto-operator-${ye+1}`,name:se,email:`${se.toLowerCase().replace(/\s+/g,".")}@auto.com`,phone:`+56${ye+1}87654321`})),q={},Q=[];Object.entries(G).forEach(([se,ye],me)=>{const xe=`auto-operator-${me+1}`;q[xe]=[],Array.from(ye).forEach((pe,Ce)=>{const Oe={id:`auto-${xe}-${Ce+1}`,beneficiary:pe,beneficiario:pe,primaryPhone:"N/A",phone:"N/A",commune:"N/A",comuna:"N/A"};q[xe].push(Oe),Q.push({...Oe,operator:se})})}),Y.length>0&&(N(Y),C(q),W(Q),console.log(" Asignaciones automticas creadas:",{operators:Y.length,assignments:Q.length,operatorMap:G}))}catch(G){console.error("Error creando asignaciones automticas:",G)}},Ni=(()=>{const b=[];console.log(" App.jsx - operatorAssignments (fuente de verdad):",Je),console.log(" App.jsx - operators disponibles:",B),Object.entries(Je).forEach(([J,Y])=>{const q=B.find(Q=>Q.id===J);q&&Y&&Array.isArray(Y)?(console.log(` Procesando asignaciones para ${q.name}:`,Y.length),Y.forEach(Q=>{const se={id:Q.id,operator:q.name,operatorName:q.name,beneficiary:Q.beneficiary,phone:Q.primaryPhone,commune:Q.commune};b.push(se),console.log(" Asignacin local agregada:",se)})):console.log(` Problemas con operador ${J}:`,{operator:q,assignments:Y,isArray:Array.isArray(Y)})}),console.log(" Total asignaciones locales:",b.length),console.log(" DIAGNSTICO - Buscando Hermes Eduardo Valbuena Romero en resultado final...");const G=b.find(J=>{var Y,q;return((Y=J.beneficiary)==null?void 0:Y.includes("Hermes"))||((q=J.beneficiary)==null?void 0:q.includes("HERMES"))});return G?console.log(" Hermes encontrado en resultado final:",G):(console.log(" Hermes NO encontrado en resultado final"),console.log(" Primeros 5 beneficiarios disponibles:",b.slice(0,5).map(J=>J.beneficiary))),b})();console.log(" App.jsx - assignmentsToUse final:",Ni);const yn=_(Ni);console.log(" App.jsx - followUpData resultado:",yn);const ti=yn.filter(b=>{const G=le==="all"||b.status===le,J=b.beneficiary.toLowerCase().includes(de.toLowerCase())||b.operator.toLowerCase().includes(de.toLowerCase());return G&&J}),wu=()=>{const b={dashboard:Ul,calls:zr,assignments:Dr,beneficiaries:u1,seguimientos:XC,history:Li,audit:Ul,reports:YO,config:C5};return f.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[f.jsxs("div",{className:"p-6 flex-1",children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Mistatas - Seguimiento de llamadas"}),f.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),f.jsx("nav",{className:"space-y-2",children:s.map(G=>{const J=b[G.id]||Ul;return f.jsx(_u,{icon:J,label:G.label,active:oe===G.id,onClick:()=>ae(G.id)},G.id)})}),r&&f.jsxs("div",{className:"mt-6 p-3 bg-gray-50 rounded-lg",children:[f.jsxs("p",{className:"text-xs text-gray-600",children:["Rol: ",f.jsx("span",{className:"font-medium",children:r.role})]}),n&&f.jsx("p",{className:"text-xs text-blue-600 font-medium",children:" Super Administrador"})]})]}),f.jsxs("div",{className:"p-6 border-t border-gray-200",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx(Xa,{className:"w-5 h-5 text-blue-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||(r==null?void 0:r.name)||"Usuario"}),f.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),f.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-gray-50",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`w-2 h-2 rounded-full ${ie==="connected"?"bg-green-500":ie==="connecting"?"bg-yellow-500":"bg-orange-500"}`}),f.jsx("span",{className:"text-xs text-gray-600",children:ie==="connected"?"Firebase conectado":ie==="connecting"?"Conectando...":"Modo demo"})]}),ve.length>0&&f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ve.length," llamadas cargadas"]})]}),f.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[f.jsx(x5,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]})},_u=({icon:b,label:G,active:J,onClick:Y})=>f.jsxs("button",{onClick:Y,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${J?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[f.jsx(b,{className:"w-5 h-5 mr-3"}),f.jsx("span",{className:"text-sm",children:G})]}),D=()=>{const b=(c==null?void 0:c.length)>0?c:ve,J=ie==="connecting"?{color:"bg-yellow-50 border-yellow-200",icon:"",title:"Conectando...",message:"Conectando con Firebase para cargar datos"}:ie==="connected"?b.length>0?{color:"bg-green-50 border-green-200",icon:"",title:"Datos reales activos",message:`Mostrando datos reales de ${b.length} llamadas registradas`}:{color:"bg-blue-50 border-blue-200",icon:"",title:"Firebase conectado - Sin datos de llamadas",message:"Conectado a Firebase. Sube un archivo Excel para ver datos reales"}:{color:"bg-orange-50 border-orange-200",icon:"",title:"Modo demostracin",message:"Mostrando datos de ejemplo. Configura Firebase para persistencia completa"},Y=async()=>{ie==="connected"&&(At(!1),await Hn())};return f.jsx("div",{className:`${J.color} border rounded-lg p-4 mb-6`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-lg mr-3",children:J.icon}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-800",children:J.title}),f.jsx("p",{className:"text-sm text-gray-600",children:J.message}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Mtricas: ",h?`${h.successfulCalls}/${h.totalCalls} exitosas`:"Sin mtricas"]})]})]}),f.jsxs("div",{className:"flex gap-2",children:[ie==="connected"&&f.jsx("button",{onClick:Y,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",title:"Recargar datos desde Firebase",children:" Sincronizar"}),b.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>{console.log(" DEBUG: Forzando re-anlisis..."),console.log(" Datos antes del re-anlisis:",h),x()},className:"px-3 py-1 text-xs bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",title:"Forzar re-anlisis de datos",children:" Re-analizar"}),f.jsx("button",{onClick:()=>{console.log(" DIAGNSTICO: Analizando datos reales...");const q=Sh.getState().callData;q&&q.length>0?window.analyzeRealData?window.analyzeRealData(q):(console.log(" Funcin de diagnstico no disponible"),console.log("Datos disponibles:",q.length,"llamadas"),console.log("Muestra de datos:",q.slice(0,3))):console.log(" No hay datos disponibles para analizar")},className:"px-3 py-1 text-xs bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors",title:"Diagnosticar datos reales del Excel (ver consola)",children:" Diagnosticar"})]})]})]})})},U=()=>{Pf.useEffect(()=>{ve.length>0&&(!c||c.length===0)&&(console.log(" Sincronizando datos locales con Zustand:",ve.length),m(ve,"sync"))},[ve,c,m]);const b=h||{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},G=S.length;E&&Object.keys(E).length;const J=g(Ni);v();let Y=J;(!J||J.length===0)&&(Y=Object.entries(Je).map(([Ce,Oe])=>{const qe=B.find(pt=>pt.id===Ce);if(qe&&Oe&&Array.isArray(Oe)){const pt=Oe.length,jr=Math.max(1,Math.floor(b.totalCalls*(pt/Math.max(1,Ni.length)))),Ds=Math.floor(jr*.6);return{operatorName:qe.name,totalCalls:jr,successfulCalls:Ds,failedCalls:jr-Ds,averageDuration:60,successRate:Math.round(Ds/jr*100),isEmergencyData:!0}}return null}).filter(Boolean)),(!Y||!Array.isArray(Y))&&(Y=[]);const q=b.totalCalls>0?(b.successfulCalls/b.totalCalls*100).toFixed(1):0,Q=b.totalCalls>0?(b.failedCalls/b.totalCalls*100).toFixed(1):0,se=G>0?(b.totalCalls/G).toFixed(1):0,ye=b.uniqueBeneficiaries>0?(b.successfulCalls/b.uniqueBeneficiaries*100).toFixed(1):0,me=Y.sort((pe,Ce)=>Ce.successfulCalls-pe.successfulCalls).slice(0,3),xe=Y.length>0?Y.reduce((pe,Ce)=>pe.totalCalls>Ce.totalCalls?pe:Ce):null;return f.jsxs("div",{className:"space-y-8",children:[f.jsx(D,{}),f.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-6 text-white",children:[f.jsx("h2",{className:"text-2xl font-bold mb-4",children:" Resumen Ejecutivo de Teleasistencia"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[f.jsxs("div",{className:"text-3xl font-bold",children:[q,"%"]}),f.jsx("div",{className:"text-sm opacity-90",children:"Tasa de xito"})]}),f.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[f.jsx("div",{className:"text-3xl font-bold",children:b.uniqueBeneficiaries}),f.jsx("div",{className:"text-sm opacity-90",children:"Beneficiarios Atendidos"})]}),f.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[f.jsx("div",{className:"text-3xl font-bold",children:se}),f.jsx("div",{className:"text-sm opacity-90",children:"Llamadas por Operadora"})]}),f.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[f.jsxs("div",{className:"text-3xl font-bold",children:[ye,"%"]}),f.jsx("div",{className:"text-sm opacity-90",children:"Tasa de Contactabilidad"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Llamadas Exitosas"}),f.jsx("p",{className:"text-3xl font-bold text-green-600",children:b.successfulCalls}),f.jsxs("p",{className:"text-sm text-gray-500",children:["de ",b.totalCalls," total"]})]}),f.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:f.jsx(zr,{className:"h-8 w-8 text-green-600"})})]}),f.jsx("div",{className:"mt-4 pt-4 border-t",children:f.jsxs("div",{className:"flex items-center text-sm",children:[f.jsx(h1,{className:"h-4 w-4 text-green-500 mr-1"}),f.jsxs("span",{className:"text-green-600 font-medium",children:[q,"% de xito"]})]})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Llamadas Fallidas"}),f.jsx("p",{className:"text-3xl font-bold text-red-600",children:b.failedCalls}),f.jsx("p",{className:"text-sm text-gray-500",children:"sin contacto efectivo"})]}),f.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:f.jsx(zr,{className:"h-8 w-8 text-red-600"})})]}),f.jsx("div",{className:"mt-4 pt-4 border-t",children:f.jsxs("div",{className:"flex items-center text-sm",children:[f.jsx(O5,{className:"h-4 w-4 text-red-500 mr-1"}),f.jsxs("span",{className:"text-red-600 font-medium",children:[Q,"% de fallas"]})]})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Beneficiarios nicos"}),f.jsx("p",{className:"text-3xl font-bold text-blue-600",children:b.uniqueBeneficiaries}),f.jsx("p",{className:"text-sm text-gray-500",children:"personas atendidas"})]}),f.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:f.jsx(Dr,{className:"h-8 w-8 text-blue-600"})})]}),f.jsx("div",{className:"mt-4 pt-4 border-t",children:f.jsxs("div",{className:"flex items-center text-sm",children:[f.jsx(Dr,{className:"h-4 w-4 text-blue-500 mr-1"}),f.jsx("span",{className:"text-blue-600 font-medium",children:"Cobertura poblacional"})]})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Tiempo Promedio"}),f.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[Math.round(b.averageDuration/60),"min"]}),f.jsx("p",{className:"text-sm text-gray-500",children:"por llamada"})]}),f.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:f.jsx(Li,{className:"h-8 w-8 text-purple-600"})})]}),f.jsx("div",{className:"mt-4 pt-4 border-t",children:f.jsxs("div",{className:"flex items-center text-sm",children:[f.jsx(Li,{className:"h-4 w-4 text-purple-500 mr-1"}),f.jsx("span",{className:"text-purple-600 font-medium",children:"Eficiencia temporal"})]})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[f.jsx(h1,{className:"h-5 w-5 text-green-500 mr-2"})," Top Performers"]}),me.length>0?f.jsx("div",{className:"space-y-3",children:me.map((pe,Ce)=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold mr-3 ${Ce===0?"bg-yellow-500":Ce===1?"bg-gray-400":"bg-orange-500"}`,children:Ce+1}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:pe.operatorName}),f.jsxs("p",{className:"text-sm text-gray-500",children:[pe.totalCalls," llamadas",pe.isEmergencyData&&f.jsx("span",{className:"ml-1 text-xs text-yellow-600",children:"(estimado)"})]})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-bold text-green-600",children:pe.successfulCalls}),f.jsx("p",{className:"text-sm text-gray-500",children:"exitosas"})]})]},Ce))}):f.jsxs("div",{className:"text-center py-6",children:[f.jsx("p",{className:"text-gray-500 mb-2",children:"No hay datos de operadoras disponibles"}),f.jsx("p",{className:"text-sm text-gray-400",children:Je&&Object.keys(Je).length>0?" Verifica que haya datos de llamadas cargados":" Necesitas crear operadoras y asignar beneficiarios en el mdulo Asignaciones"})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[f.jsx(Ul,{className:"h-5 w-5 text-blue-500 mr-2"})," Anlisis de Productividad"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Operadora ms activa"}),f.jsx("p",{className:"font-bold text-lg",children:(xe==null?void 0:xe.operatorName)||"N/A"}),f.jsxs("p",{className:"text-sm text-blue-600",children:[(xe==null?void 0:xe.totalCalls)||0," llamadas realizadas"]})]}),f.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Tasa de xito promedio"}),f.jsxs("p",{className:"font-bold text-lg",children:[q,"%"]}),f.jsx("p",{className:"text-sm text-green-600",children:"Indicador de calidad del servicio"})]}),f.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Cumplimiento de protocolo"}),f.jsxs("p",{className:"font-bold text-lg",children:[b.protocolCompliance,"%"]}),f.jsx("p",{className:"text-sm text-purple-600",children:"Adherencia a procedimientos"})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-6",children:" Acceso Rpido a Mdulos"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsxs("div",{onClick:()=>ae("calls"),className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 border border-green-200 cursor-pointer hover:shadow-md transition-all",children:[f.jsx("div",{className:"flex items-center justify-center mb-4",children:f.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-lg flex items-center justify-center",children:f.jsx(zr,{className:"w-8 h-8 text-white"})})}),f.jsx("h4",{className:"text-lg font-semibold text-green-800 mb-2",children:"Registro de Llamadas"}),f.jsx("p",{className:"text-sm text-green-700",children:"Sube historiales Excel, analiza resultados y clasifica por beneficiario y teleoperadora."})]}),f.jsxs("div",{onClick:()=>ae("assignments"),className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200 cursor-pointer hover:shadow-md transition-all",children:[f.jsx("div",{className:"flex items-center justify-center mb-4",children:f.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-lg flex items-center justify-center",children:f.jsx(Dr,{className:"w-8 h-8 text-white"})})}),f.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Asignaciones"}),f.jsx("p",{className:"text-sm text-blue-700",children:"Gestiona relaciones entre beneficiarios y teleoperadoras de manera eficiente."})]}),f.jsxs("div",{onClick:()=>ae("history"),className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 border border-purple-200 cursor-pointer hover:shadow-md transition-all",children:[f.jsx("div",{className:"flex items-center justify-center mb-4",children:f.jsx("div",{className:"w-16 h-16 bg-purple-500 rounded-lg flex items-center justify-center",children:f.jsx(Li,{className:"w-8 h-8 text-white"})})}),f.jsx("h4",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Historial de Seguimientos"}),f.jsx("p",{className:"text-sm text-purple-700",children:"Clasifica beneficiarios por frecuencia y estado de contacto para seguimiento."})]})]})]}),Y.length>0&&f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[f.jsx(Dr,{className:"h-5 w-5 text-indigo-500 mr-2"})," Detalle Completo por Teleoperadora",Y.some(pe=>pe.isEmergencyData)&&f.jsx("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Datos Estimados"})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operadora"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Llamadas"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exitosas"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fallidas"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tasa xito"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rendimiento"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y.map((pe,Ce)=>{var qe;const Oe=pe.totalCalls>0?(pe.successfulCalls/pe.totalCalls*100).toFixed(1):0;return f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:f.jsx("span",{className:"text-indigo-600 font-semibold text-sm",children:(qe=pe.operatorName)==null?void 0:qe.substring(0,2).toUpperCase()})}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:pe.operatorName})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:f.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:pe.totalCalls})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:pe.successfulCalls}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-medium",children:pe.failedCalls}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${parseFloat(Oe)>=70?"bg-green-100 text-green-800":parseFloat(Oe)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Oe,"%"]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:f.jsx("div",{className:`h-2 rounded-full ${parseFloat(Oe)>=70?"bg-green-500":parseFloat(Oe)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(parseFloat(Oe),100)}%`}})}),f.jsx("span",{className:"text-xs text-gray-500",children:parseFloat(Oe)>=70?" Excelente":parseFloat(Oe)>=50?" Regular":" Revisar"})]})})]},Ce)})})]})})]})]})},j=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),f.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),f.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[f.jsx(Qf,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),f.jsxs("label",{className:"cursor-pointer",children:[f.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),f.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:Rl,className:"hidden"})]}),f.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]}),y&&f.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),f.jsxs("div",{children:[f.jsxs("h4",{className:"text-sm font-medium text-blue-900",children:[I==="uploading"&&" Subiendo archivo...",I==="processing"&&" Procesando datos...",I==="analyzing"&&" Analizando llamadas..."]}),f.jsx("p",{className:"text-sm text-blue-700",children:O})]})]}),f.jsx("div",{className:"mt-3 w-full bg-blue-200 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:I==="uploading"?"25%":I==="processing"?"50%":I==="analyzing"?"75%":"100%"}})})]}),I==="complete"&&!y&&c.length>0&&f.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("div",{className:"w-6 h-6 bg-green-600 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-green-900",children:" Anlisis completado exitosamente"}),f.jsx("p",{className:"text-sm text-green-700",children:O})]})]})}),I==="error"&&!y&&f.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("div",{className:"w-6 h-6 bg-red-600 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-red-900",children:" Error en el procesamiento"}),f.jsx("p",{className:"text-sm text-red-700",children:O}),f.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Por favor, verifica el formato del archivo e intenta nuevamente."})]})]})})]}),c.length>0&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resumen del Anlisis"}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Total Llamadas"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.filter(b=>b.categoria==="exitosa"||b.resultado==="Llamado exitoso").length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Exitosas"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.filter(b=>b.categoria!=="exitosa"&&b.resultado!=="Llamado exitoso").length}),f.jsx("div",{className:"text-sm text-gray-600",children:"Fallidas"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(c.map(b=>b.beneficiario).filter(Boolean)).size}),f.jsx("div",{className:"text-sm text-gray-600",children:"Beneficiarios"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),f.jsxs("div",{className:"overflow-x-auto",children:[f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-50",children:[f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Comuna"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Operador"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tipo"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),f.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),f.jsx("tbody",{children:c.slice(0,10).map((b,G)=>f.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:b.id||`call-${G}`}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:b.fecha||"N/A"}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:b.beneficiario||"N/A"}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:b.comuna||"N/A"}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:b.operador||"No identificado"}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${b.tipo_llamada==="entrante"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:b.tipo_llamada==="entrante"?"Entrante":"Saliente"})}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${b.resultado==="Llamado exitoso"||b.categoria==="exitosa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.resultado||(b.categoria==="exitosa"?"Exitoso":"Fallido")})}),f.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[b.duracion||0,"s"]})]},b.id||G))})]}),f.jsxs("div",{className:"mt-4 flex justify-between items-center text-sm text-gray-600",children:[f.jsxs("span",{children:["Mostrando ",Math.min(10,c.length)," de ",c.length," llamadas procesadas"]}),c.length>10&&f.jsx("span",{className:"text-blue-600",children:"Mostrando solo las primeras 10 filas"})]})]})]})]})]}),V=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),f.jsxs("button",{onClick:()=>tt(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[f.jsx(Vc,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[f.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:B.length})]}),f.jsx(Dr,{className:"w-8 h-8 text-blue-500"})]})}),f.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(Je).reduce((b,G)=>b+G.length,0)})]}),f.jsx(zr,{className:"w-8 h-8 text-green-500"})]})}),f.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),f.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(Je).length})]}),f.jsx(vc,{className:"w-8 h-8 text-purple-500"})]})})]})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Bsqueda de Beneficiarios"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Encuentra rpidamente qu teleoperadora est asignada a un beneficiario"})]}),f.jsxs("button",{onClick:()=>In(!Xt),className:`px-4 py-2 rounded-lg transition-colors flex items-center gap-2 ${Xt?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[f.jsx(_s,{className:"w-4 h-4"}),Xt?"Cerrar Bsqueda":"Buscar Beneficiario"]})]}),Xt&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsx("div",{className:"flex-1",children:f.jsx("input",{type:"text",placeholder:"Buscar por nombre del beneficiario, teleoperadora, telfono o comuna...",value:gt,onChange:b=>{const G=b.target.value;da(G)},className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),f.jsx("button",{onClick:()=>{Mt(""),br([])},className:"px-3 py-2 text-gray-500 hover:text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:f.jsx(Bc,{className:"w-4 h-4"})})]}),Ct.length>0&&f.jsxs("div",{className:"border border-gray-200 rounded-lg divide-y divide-gray-200 max-h-96 overflow-y-auto",children:[f.jsxs("div",{className:"bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700",children:[Ct.length," resultado(s) encontrado(s)"]}),Ct.map((b,G)=>f.jsx("div",{className:"p-4 hover:bg-gray-50",children:f.jsx("div",{className:"flex justify-between items-start",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("h5",{className:"font-semibold text-gray-900",children:b.beneficiary||b.beneficiario}),f.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"Beneficiario"}),f.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:b.source})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Dr,{className:"w-4 h-4 text-gray-400"}),f.jsxs("span",{children:[f.jsx("strong",{children:"Teleoperadora:"})," ",b.operatorName||b.operator||"Sin asignar"]})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(zr,{className:"w-4 h-4 text-gray-400"}),f.jsxs("span",{children:[f.jsx("strong",{children:"Telfono Principal:"})," ",b.primaryPhone||b.phone||b.telefono||b.numero_cliente||"N/A"]})]}),b.phones&&b.phones.length>1&&f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(zr,{className:"w-4 h-4 text-gray-400"}),f.jsxs("span",{children:[f.jsx("strong",{children:"Otros Telfonos:"})," ",b.phones.slice(1).join(", ")]})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(vc,{className:"w-4 h-4 text-gray-400"}),f.jsxs("span",{children:[f.jsx("strong",{children:"Comuna:"})," ",b.commune||b.comuna||"N/A"]})]})]})]})})},`${b.id||G}-${b.source}`))]}),gt&&Ct.length===0&&f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(_s,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),f.jsxs("p",{children:['No se encontraron beneficiarios que coincidan con "',gt,'"']}),f.jsx("p",{className:"text-sm mt-1",children:"Intenta con otro trmino de bsqueda"})]}),!gt&&f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(_s,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),f.jsx("p",{children:"Escribe el nombre de un beneficiario, teleoperadora, telfono o comuna para buscar"}),f.jsx("p",{className:"text-sm mt-1",children:"La bsqueda incluye todas las asignaciones registradas"})]})]})]}),Ye&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),f.jsx("button",{onClick:()=>tt(!1),className:"text-gray-500 hover:text-gray-700",children:f.jsx(Bc,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),f.jsx("input",{type:"text",value:ct.name,onChange:b=>ur({...ct,name:b.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"email",value:ct.email,onChange:b=>ur({...ct,email:b.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),f.jsx("input",{type:"tel",value:ct.phone,onChange:b=>ur({...ct,phone:b.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),f.jsxs("div",{className:"flex gap-3 mt-6",children:[f.jsxs("button",{onClick:ha,disabled:!ct.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f.jsx(yv,{className:"w-4 h-4"}),"Crear Teleoperador"]}),f.jsx("button",{onClick:()=>tt(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),f.jsxs("div",{className:"space-y-4",children:[B.filter(b=>b&&b.id).map(b=>f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:b.name||"Operador sin nombre"}),Je[b.id]&&f.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[Je[b.id].length," beneficiarios"]})]}),f.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[b.email&&f.jsxs("p",{children:[" ",b.email]}),b.phone&&f.jsxs("p",{children:[" ",b.phone]})]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[f.jsx(Qf,{className:"w-4 h-4"}),"Subir Excel",f.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:G=>Eo(G,b.id),className:"hidden"})]}),Je[b.id]&&f.jsxs("button",{onClick:()=>To(b.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[f.jsx(Yf,{className:"w-4 h-4"}),"Limpiar"]}),f.jsxs("button",{onClick:()=>_o(b.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[f.jsx(Yf,{className:"w-4 h-4"}),"Eliminar"]})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[f.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),f.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),Je[b.id]&&Je[b.id].length>0&&f.jsxs("div",{className:"border-t pt-4",children:[f.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",Je[b.id].length,")"]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-50",children:[f.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),f.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),f.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),f.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),f.jsxs("tbody",{children:[Je[b.id].slice(0,5).map(G=>f.jsxs("tr",{className:"border-b",children:[f.jsx("td",{className:"px-3 py-2 text-gray-900",children:G.beneficiary}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:G.primaryPhone}),f.jsx("td",{className:"px-3 py-2 text-gray-600",children:G.phones.length>1?G.phones.slice(1).join(", "):"-"}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:G.commune})]},G.id)),Je[b.id].length>5&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",Je[b.id].length-5," beneficiarios ms"]})})]})]})})]})]},b.id)),B.length===0&&f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[f.jsx(Dr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),f.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),f.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),f.jsxs("button",{onClick:()=>tt(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[f.jsx(Vc,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),z=()=>f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),f.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-green-800 font-semibold",children:"Al da"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:yn.filter(b=>b.status==="al-dia").length})]}),f.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-white text-sm",children:""})})]})}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-yellow-800 font-semibold",children:"Pendientes"}),f.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:yn.filter(b=>b.status==="pendiente").length})]}),f.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-white text-sm",children:""})})]})}),f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-red-800 font-semibold",children:"Urgentes"}),f.jsx("p",{className:"text-2xl font-bold text-red-600",children:yn.filter(b=>b.status==="urgente").length})]}),f.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-white text-sm",children:""})})]})})]}),f.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(t4,{className:"w-4 h-4 text-gray-400"}),f.jsxs("select",{value:le,onChange:b=>we(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los estados"}),f.jsx("option",{value:"al-dia",children:"Al da"}),f.jsx("option",{value:"pendiente",children:"Pendiente"}),f.jsx("option",{value:"urgente",children:"Urgente"})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_s,{className:"w-4 h-4 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:de,onChange:b=>Pe(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ti.length===0?f.jsx("div",{className:"col-span-full bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx(vc,{className:"w-12 h-12 text-gray-400 mb-4"}),f.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay datos de seguimiento"}),f.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:w?"No se encontraron seguimientos que coincidan con los filtros aplicados.":"Para ver el historial de seguimientos, sube un archivo Excel con datos de llamadas desde el Panel Principal."}),!w&&f.jsxs("div",{className:"text-sm text-gray-500",children:[" Ve al ",f.jsx("strong",{children:"Panel Principal"}),"  ",f.jsx("strong",{children:"Cargar Excel"})," para comenzar"]})]})}):ti.map(b=>f.jsxs("div",{className:`border-2 rounded-lg p-4 hover:shadow-md transition-shadow ${b.status==="al-dia"?"border-green-200 bg-green-50":b.status==="pendiente"?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50"}`,children:[f.jsxs("div",{className:"flex items-start justify-between mb-3",children:[f.jsx("h4",{className:"font-semibold text-gray-900",children:b.beneficiary}),f.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${b.status==="al-dia"?"bg-green-100 text-green-800 border border-green-300":b.status==="pendiente"?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-red-100 text-red-800 border border-red-300"}`,children:b.status==="al-dia"?" Al da":b.status==="pendiente"?" Pendiente":" Urgente"})]}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex items-center text-gray-700",children:[f.jsx(Xa,{className:"w-4 h-4 mr-2 text-gray-500"}),f.jsx("span",{className:"font-medium",children:"Teleoperadora:"}),f.jsx("span",{className:"ml-1",children:b.operator})]}),f.jsxs("div",{className:"flex items-center text-gray-700",children:[f.jsx(zr,{className:"w-4 h-4 mr-2 text-gray-500"}),f.jsx("span",{className:"font-medium",children:"Telfono:"}),f.jsx("span",{className:"ml-1",children:b.phone})]}),f.jsxs("div",{className:"flex items-center text-gray-700",children:[f.jsx(Li,{className:"w-4 h-4 mr-2 text-gray-500"}),f.jsx("span",{className:"font-medium",children:"ltima llamada:"}),f.jsx("span",{className:"ml-1",children:b.lastCall})]}),f.jsxs("div",{className:"flex items-center text-gray-700",children:[f.jsx(Ul,{className:"w-4 h-4 mr-2 text-gray-500"}),f.jsx("span",{className:"font-medium",children:"Llamadas:"}),f.jsxs("span",{className:"ml-1",children:[b.callCount," total (",b.successfulCallCount||0," exitosas)"]})]}),b.daysSinceLastCall!==null&&f.jsxs("div",{className:"flex items-center text-gray-700",children:[f.jsx(YC,{className:"w-4 h-4 mr-2 text-gray-500"}),f.jsx("span",{className:"font-medium",children:"Hace:"}),f.jsxs("span",{className:"ml-1",children:[b.daysSinceLastCall," das"]})]}),b.lastCallResult&&b.lastCallResult!=="Sin resultado"&&f.jsxs("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs",children:[f.jsx("span",{className:"font-medium",children:"ltimo resultado:"}),f.jsx("span",{className:"ml-1",children:b.lastCallResult})]})]}),b.statusReason&&f.jsx("div",{className:`mt-3 p-2 rounded text-xs ${b.status==="al-dia"?"bg-green-100 text-green-700":b.status==="pendiente"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:f.jsxs("div",{className:"flex items-start",children:[b.status==="urgente"&&f.jsx(jc,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),f.jsx("span",{children:b.statusReason})]})})]},b.id))})]})});return f.jsxs("div",{className:"flex h-screen bg-gray-100",children:[f.jsx(wu,{}),f.jsx("div",{className:"flex-1 overflow-auto",children:f.jsxs("div",{className:"p-6",children:[f.jsx("div",{className:"mb-6",children:f.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[oe==="dashboard"&&"Panel principal",oe==="calls"&&"Registro de Llamadas",oe==="assignments"&&"Asignaciones",oe==="beneficiaries"&&"Beneficiarios Base",oe==="seguimientos"&&"Seguimientos Peridicos",oe==="history"&&"Historial de Seguimientos",oe==="audit"&&"Auditora Avanzada",oe==="config"&&"Configuracin del Sistema"]})}),ie==="demo"&&f.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx(jc,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-blue-800 font-medium",children:"Modo Local"}),f.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"La aplicacin funciona con datos locales. Para persistencia en la nube, completa la configuracin de Firebase."}),f.jsx("p",{className:"text-blue-600 text-xs mt-2",children:" Consulta FIREBASE_SETUP.md para instrucciones de configuracin"})]})]})}),ie==="connecting"&&f.jsx("div",{className:"mb-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),f.jsx("span",{className:"text-slate-700 text-sm",children:"Verificando configuracin de Firebase..."})]})}),oe==="dashboard"&&f.jsx(ju,{children:f.jsx(U,{})}),oe==="calls"&&f.jsx(j,{}),oe==="assignments"&&f.jsx(V,{}),oe==="beneficiaries"&&f.jsx(ju,{children:f.jsx(Sse,{})}),oe==="seguimientos"&&f.jsx(ju,{children:f.jsx(Cse,{})}),oe==="history"&&f.jsx(z,{}),oe==="audit"&&f.jsx(ju,{children:f.jsx(LZ,{})}),oe==="config"&&a&&f.jsx(ju,{children:f.jsx(Rse,{})})]})})]})},Fse=()=>{const[t,e]=te.useState(!0),[r,n]=te.useState(!1),[s,i]=te.useState({email:"",password:"",confirmPassword:"",displayName:""}),[a,o]=te.useState(!1),{login:l,register:c,error:u,clearError:h}=Nl(),m=v=>{const{name:_,value:w}=v.target;i(y=>({...y,[_]:w})),h()},p=async v=>{v.preventDefault(),o(!0);try{if(t)await l(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await c(s.email,s.password,s.displayName)}}catch(_){console.error("Error en autenticacin:",_)}finally{o(!1)}},x=()=>{e(!t),i({email:"",password:"",confirmPassword:"",displayName:""}),h()},g=v=>v?v.includes("user-not-found")?"Usuario no encontrado":v.includes("wrong-password")?"Contrasea incorrecta":v.includes("email-already-in-use")?"Este email ya est registrado":v.includes("weak-password")?"La contrasea es muy dbil":v.includes("invalid-email")?"Email invlido":v.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":v:"";return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(zr,{className:"w-8 h-8 text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),f.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),u&&f.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[f.jsx(jc,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),f.jsx("p",{className:"text-red-600 text-sm mt-1",children:g(u)})]})]}),f.jsxs("form",{onSubmit:p,className:"space-y-6",children:[!t&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),f.jsxs("div",{className:"relative",children:[f.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),f.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),f.jsxs("div",{className:"relative",children:[f.jsx(r4,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),f.jsx("input",{type:"email",name:"email",value:s.email,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),f.jsxs("div",{className:"relative",children:[f.jsx(SE,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),f.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:m,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),f.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?f.jsx(ZC,{className:"w-5 h-5"}):f.jsx(e4,{className:"w-5 h-5"})})]})]}),!t&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),f.jsxs("div",{className:"relative",children:[f.jsx(SE,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),f.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),f.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):f.jsx(f.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),f.jsxs("div",{className:"mt-8 text-center",children:[f.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),f.jsx("button",{onClick:x,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),f.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx(Ka,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),f.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},Ose=()=>f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:f.jsx(zr,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),f.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),f.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),f.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),Lse=()=>{const{user:t,loading:e}=Nl();return e?f.jsx(Ose,{}):t?f.jsx(Dse,{}):f.jsx(Fse,{})};xx.createRoot(document.getElementById("root")).render(f.jsx(Pf.StrictMode,{children:f.jsx(AZ,{children:f.jsx(Lse,{})})}));
