(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function GI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nw={exports:{}},Xh={},Rw={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var au=Symbol.for("react.element"),qI=Symbol.for("react.portal"),KI=Symbol.for("react.fragment"),XI=Symbol.for("react.strict_mode"),YI=Symbol.for("react.profiler"),QI=Symbol.for("react.provider"),JI=Symbol.for("react.context"),ZI=Symbol.for("react.forward_ref"),eC=Symbol.for("react.suspense"),tC=Symbol.for("react.memo"),rC=Symbol.for("react.lazy"),wx=Symbol.iterator;function nC(t){return t===null||typeof t!="object"?null:(t=wx&&t[wx]||t["@@iterator"],typeof t=="function"?t:null)}var Pw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bw=Object.assign,Dw={};function al(t,e,r){this.props=t,this.context=e,this.refs=Dw,this.updater=r||Pw}al.prototype.isReactComponent={};al.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};al.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Fw(){}Fw.prototype=al.prototype;function Sm(t,e,r){this.props=t,this.context=e,this.refs=Dw,this.updater=r||Pw}var km=Sm.prototype=new Fw;km.constructor=Sm;bw(km,al.prototype);km.isPureReactComponent=!0;var Ex=Array.isArray,Ow=Object.prototype.hasOwnProperty,Im={current:null},Lw={key:!0,ref:!0,__self:!0,__source:!0};function Mw(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)Ow.call(e,n)&&!Lw.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:au,type:t,key:a,ref:i,props:s,_owner:Im.current}}function sC(t,e){return{$$typeof:au,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Cm(t){return typeof t=="object"&&t!==null&&t.$$typeof===au}function aC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Tx=/\/+/g;function q0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?aC(""+t.key):e.toString(36)}function _f(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case au:case qI:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+q0(i,0):n,Ex(s)?(r="",t!=null&&(r=t.replace(Tx,"$&/")+"/"),_f(s,e,r,"",function(c){return c})):s!=null&&(Cm(s)&&(s=sC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Tx,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Ex(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+q0(a,o);i+=_f(a,e,r,l,s)}else if(l=nC(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+q0(a,o++),i+=_f(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function ju(t,e,r){if(t==null)return t;var n=[],s=0;return _f(t,n,"","",function(a){return e.call(r,a,s++)}),n}function iC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Gr={current:null},wf={transition:null},oC={ReactCurrentDispatcher:Gr,ReactCurrentBatchConfig:wf,ReactCurrentOwner:Im};function Vw(){throw Error("act(...) is not supported in production builds of React.")}He.Children={map:ju,forEach:function(t,e,r){ju(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ju(t,function(){e++}),e},toArray:function(t){return ju(t,function(e){return e})||[]},only:function(t){if(!Cm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};He.Component=al;He.Fragment=KI;He.Profiler=YI;He.PureComponent=Sm;He.StrictMode=XI;He.Suspense=eC;He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oC;He.act=Vw;He.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=bw({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=Im.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Ow.call(e,l)&&!Lw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:au,type:t.type,key:s,ref:a,props:n,_owner:i}};He.createContext=function(t){return t={$$typeof:JI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QI,_context:t},t.Consumer=t};He.createElement=Mw;He.createFactory=function(t){var e=Mw.bind(null,t);return e.type=t,e};He.createRef=function(){return{current:null}};He.forwardRef=function(t){return{$$typeof:ZI,render:t}};He.isValidElement=Cm;He.lazy=function(t){return{$$typeof:rC,_payload:{_status:-1,_result:t},_init:iC}};He.memo=function(t,e){return{$$typeof:tC,type:t,compare:e===void 0?null:e}};He.startTransition=function(t){var e=wf.transition;wf.transition={};try{t()}finally{wf.transition=e}};He.unstable_act=Vw;He.useCallback=function(t,e){return Gr.current.useCallback(t,e)};He.useContext=function(t){return Gr.current.useContext(t)};He.useDebugValue=function(){};He.useDeferredValue=function(t){return Gr.current.useDeferredValue(t)};He.useEffect=function(t,e){return Gr.current.useEffect(t,e)};He.useId=function(){return Gr.current.useId()};He.useImperativeHandle=function(t,e,r){return Gr.current.useImperativeHandle(t,e,r)};He.useInsertionEffect=function(t,e){return Gr.current.useInsertionEffect(t,e)};He.useLayoutEffect=function(t,e){return Gr.current.useLayoutEffect(t,e)};He.useMemo=function(t,e){return Gr.current.useMemo(t,e)};He.useReducer=function(t,e,r){return Gr.current.useReducer(t,e,r)};He.useRef=function(t){return Gr.current.useRef(t)};He.useState=function(t){return Gr.current.useState(t)};He.useSyncExternalStore=function(t,e,r){return Gr.current.useSyncExternalStore(t,e,r)};He.useTransition=function(){return Gr.current.useTransition()};He.version="18.3.1";Rw.exports=He;var ze=Rw.exports;const Tc=GI(ze);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lC=ze,cC=Symbol.for("react.element"),uC=Symbol.for("react.fragment"),fC=Object.prototype.hasOwnProperty,hC=lC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dC={key:!0,ref:!0,__self:!0,__source:!0};function jw(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)fC.call(e,n)&&!dC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:cC,type:t,key:a,ref:i,props:s,_owner:hC.current}}Xh.Fragment=uC;Xh.jsx=jw;Xh.jsxs=jw;Nw.exports=Xh;var p=Nw.exports,Hd={},Bw={exports:{}},mn={},Uw={exports:{}},$w={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,q){var ue=ie.length;ie.push(q);e:for(;0<ue;){var Te=ue-1>>>1,j=ie[Te];if(0<s(j,q))ie[Te]=q,ie[ue]=j,ue=Te;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var q=ie[0],ue=ie.pop();if(ue!==q){ie[0]=ue;e:for(var Te=0,j=ie.length,J=j>>>1;Te<J;){var G=2*(Te+1)-1,W=ie[G],re=G+1,fe=ie[re];if(0>s(W,ue))re<j&&0>s(fe,W)?(ie[Te]=fe,ie[re]=ue,Te=re):(ie[Te]=W,ie[G]=ue,Te=G);else if(re<j&&0>s(fe,ue))ie[Te]=fe,ie[re]=ue,Te=re;else break e}}return q}function s(ie,q){var ue=ie.sortIndex-q.sortIndex;return ue!==0?ue:ie.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,h=null,d=3,m=!1,g=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ie){for(var q=r(c);q!==null;){if(q.callback===null)n(c);else if(q.startTime<=ie)n(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=r(c)}}function O(ie){if(v=!1,y(ie),!g)if(r(l)!==null)g=!0,Se(z);else{var q=r(c);q!==null&&ye(O,q.startTime-ie)}}function z(ie,q){g=!1,v&&(v=!1,T(S),S=-1),m=!0;var ue=d;try{for(y(q),h=r(l);h!==null&&(!(h.expirationTime>q)||ie&&!b());){var Te=h.callback;if(typeof Te=="function"){h.callback=null,d=h.priorityLevel;var j=Te(h.expirationTime<=q);q=t.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&n(l),y(q)}else n(l);h=r(l)}if(h!==null)var J=!0;else{var G=r(c);G!==null&&ye(O,G.startTime-q),J=!1}return J}finally{h=null,d=ue,m=!1}}var B=!1,E=null,S=-1,k=5,R=-1;function b(){return!(t.unstable_now()-R<k)}function D(){if(E!==null){var ie=t.unstable_now();R=ie;var q=!0;try{q=E(!0,ie)}finally{q?F():(B=!1,E=null)}}else B=!1}var F;if(typeof _=="function")F=function(){_(D)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,pe=_e.port2;_e.port1.onmessage=D,F=function(){pe.postMessage(null)}}else F=function(){w(D,0)};function Se(ie){E=ie,B||(B=!0,F())}function ye(ie,q){S=w(function(){ie(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,Se(z))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var ue=d;d=q;try{return ie()}finally{d=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ue=d;d=ie;try{return q()}finally{d=ue}},t.unstable_scheduleCallback=function(ie,q,ue){var Te=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Te+ue:Te):ue=Te,ie){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ue+j,ie={id:f++,callback:q,priorityLevel:ie,startTime:ue,expirationTime:j,sortIndex:-1},ue>Te?(ie.sortIndex=ue,e(c,ie),r(l)===null&&ie===r(c)&&(v?(T(S),S=-1):v=!0,ye(O,ue-Te))):(ie.sortIndex=j,e(l,ie),g||m||(g=!0,Se(z))),ie},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(ie){var q=d;return function(){var ue=d;d=q;try{return ie.apply(this,arguments)}finally{d=ue}}}})($w);Uw.exports=$w;var pC=Uw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mC=ze,dn=pC;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zw=new Set,Ac={};function Vi(t,e){zo(t,e),zo(t+"Capture",e)}function zo(t,e){for(Ac[t]=e,t=0;t<e.length;t++)zw.add(e[t])}var Hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=Object.prototype.hasOwnProperty,gC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ax={},Sx={};function xC(t){return Wd.call(Sx,t)?!0:Wd.call(Ax,t)?!1:gC.test(t)?Sx[t]=!0:(Ax[t]=!0,!1)}function vC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yC(t,e,r,n){if(e===null||typeof e>"u"||vC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qr(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){gr[t]=new qr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];gr[e]=new qr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){gr[t]=new qr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){gr[t]=new qr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){gr[t]=new qr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){gr[t]=new qr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){gr[t]=new qr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){gr[t]=new qr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){gr[t]=new qr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nm=/[\-:]([a-z])/g;function Rm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nm,Rm);gr[e]=new qr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nm,Rm);gr[e]=new qr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nm,Rm);gr[e]=new qr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){gr[t]=new qr(t,1,!1,t.toLowerCase(),null,!1,!1)});gr.xlinkHref=new qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){gr[t]=new qr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pm(t,e,r,n){var s=gr.hasOwnProperty(e)?gr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yC(e,r,s,n)&&(r=null),n||s===null?xC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Zs=mC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bu=Symbol.for("react.element"),mo=Symbol.for("react.portal"),go=Symbol.for("react.fragment"),bm=Symbol.for("react.strict_mode"),Gd=Symbol.for("react.profiler"),Hw=Symbol.for("react.provider"),Ww=Symbol.for("react.context"),Dm=Symbol.for("react.forward_ref"),qd=Symbol.for("react.suspense"),Kd=Symbol.for("react.suspense_list"),Fm=Symbol.for("react.memo"),fa=Symbol.for("react.lazy"),Gw=Symbol.for("react.offscreen"),kx=Symbol.iterator;function Il(t){return t===null||typeof t!="object"?null:(t=kx&&t[kx]||t["@@iterator"],typeof t=="function"?t:null)}var At=Object.assign,K0;function Ol(t){if(K0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);K0=e&&e[1]||""}return`
`+K0+t}var X0=!1;function Y0(t,e){if(!t||X0)return"";X0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{X0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ol(t):""}function _C(t){switch(t.tag){case 5:return Ol(t.type);case 16:return Ol("Lazy");case 13:return Ol("Suspense");case 19:return Ol("SuspenseList");case 0:case 2:case 15:return t=Y0(t.type,!1),t;case 11:return t=Y0(t.type.render,!1),t;case 1:return t=Y0(t.type,!0),t;default:return""}}function Xd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case go:return"Fragment";case mo:return"Portal";case Gd:return"Profiler";case bm:return"StrictMode";case qd:return"Suspense";case Kd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ww:return(t.displayName||"Context")+".Consumer";case Hw:return(t._context.displayName||"Context")+".Provider";case Dm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fm:return e=t.displayName||null,e!==null?e:Xd(t.type)||"Memo";case fa:e=t._payload,t=t._init;try{return Xd(t(e))}catch{}}return null}function wC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xd(e);case 8:return e===bm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ja(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function EC(t){var e=qw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uu(t){t._valueTracker||(t._valueTracker=EC(t))}function Kw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=qw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Hf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yd(t,e){var r=e.checked;return At({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Ix(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ja(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Xw(t,e){e=e.checked,e!=null&&Pm(t,"checked",e,!1)}function Qd(t,e){Xw(t,e);var r=ja(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Jd(t,e.type,ja(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Cx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Jd(t,e,r){(e!=="number"||Hf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ll=Array.isArray;function No(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ja(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return At({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Nx(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(le(92));if(Ll(r)){if(1<r.length)throw Error(le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ja(r)}}function Yw(t,e){var r=ja(e.value),n=ja(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Rx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Qw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ep(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $u,Jw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($u=$u||document.createElement("div"),$u.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$u.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Sc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ql={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},TC=["Webkit","ms","Moz","O"];Object.keys(Ql).forEach(function(t){TC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ql[e]=Ql[t]})});function Zw(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ql.hasOwnProperty(t)&&Ql[t]?(""+e).trim():e+"px"}function eE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Zw(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var AC=At({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tp(t,e){if(e){if(AC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function rp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var np=null;function Om(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sp=null,Ro=null,Po=null;function Px(t){if(t=lu(t)){if(typeof sp!="function")throw Error(le(280));var e=t.stateNode;e&&(e=e0(e),sp(t.stateNode,t.type,e))}}function tE(t){Ro?Po?Po.push(t):Po=[t]:Ro=t}function rE(){if(Ro){var t=Ro,e=Po;if(Po=Ro=null,Px(t),e)for(t=0;t<e.length;t++)Px(e[t])}}function nE(t,e){return t(e)}function sE(){}var Q0=!1;function aE(t,e,r){if(Q0)return t(e,r);Q0=!0;try{return nE(t,e,r)}finally{Q0=!1,(Ro!==null||Po!==null)&&(sE(),rE())}}function kc(t,e){var r=t.stateNode;if(r===null)return null;var n=e0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(le(231,e,typeof r));return r}var ap=!1;if(Hs)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){ap=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{ap=!1}function SC(t,e,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var Jl=!1,Wf=null,Gf=!1,ip=null,kC={onError:function(t){Jl=!0,Wf=t}};function IC(t,e,r,n,s,a,i,o,l){Jl=!1,Wf=null,SC.apply(kC,arguments)}function CC(t,e,r,n,s,a,i,o,l){if(IC.apply(this,arguments),Jl){if(Jl){var c=Wf;Jl=!1,Wf=null}else throw Error(le(198));Gf||(Gf=!0,ip=c)}}function ji(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function iE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bx(t){if(ji(t)!==t)throw Error(le(188))}function NC(t){var e=t.alternate;if(!e){if(e=ji(t),e===null)throw Error(le(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return bx(s),t;if(a===n)return bx(s),e;a=a.sibling}throw Error(le(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?t:e}function oE(t){return t=NC(t),t!==null?lE(t):null}function lE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lE(t);if(e!==null)return e;t=t.sibling}return null}var cE=dn.unstable_scheduleCallback,Dx=dn.unstable_cancelCallback,RC=dn.unstable_shouldYield,PC=dn.unstable_requestPaint,Ot=dn.unstable_now,bC=dn.unstable_getCurrentPriorityLevel,Lm=dn.unstable_ImmediatePriority,uE=dn.unstable_UserBlockingPriority,qf=dn.unstable_NormalPriority,DC=dn.unstable_LowPriority,fE=dn.unstable_IdlePriority,Yh=null,ps=null;function FC(t){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(Yh,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:MC,OC=Math.log,LC=Math.LN2;function MC(t){return t>>>=0,t===0?32:31-(OC(t)/LC|0)|0}var zu=64,Hu=4194304;function Ml(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Ml(o):(a&=i,a!==0&&(n=Ml(a)))}else i=r&~s,i!==0?n=Ml(i):a!==0&&(n=Ml(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Kn(e),s=1<<r,n|=t[r],e&=~s;return n}function VC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Kn(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=VC(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function op(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hE(){var t=zu;return zu<<=1,!(zu&4194240)&&(zu=64),t}function J0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function iu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=r}function BC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Kn(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function Mm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Kn(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var at=0;function dE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pE,Vm,mE,gE,xE,lp=!1,Wu=[],Sa=null,ka=null,Ia=null,Ic=new Map,Cc=new Map,da=[],UC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fx(t,e){switch(t){case"focusin":case"focusout":Sa=null;break;case"dragenter":case"dragleave":ka=null;break;case"mouseover":case"mouseout":Ia=null;break;case"pointerover":case"pointerout":Ic.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cc.delete(e.pointerId)}}function Nl(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=lu(e),e!==null&&Vm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function $C(t,e,r,n,s){switch(e){case"focusin":return Sa=Nl(Sa,t,e,r,n,s),!0;case"dragenter":return ka=Nl(ka,t,e,r,n,s),!0;case"mouseover":return Ia=Nl(Ia,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return Ic.set(a,Nl(Ic.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Cc.set(a,Nl(Cc.get(a)||null,t,e,r,n,s)),!0}return!1}function vE(t){var e=di(t.target);if(e!==null){var r=ji(e);if(r!==null){if(e=r.tag,e===13){if(e=iE(r),e!==null){t.blockedOn=e,xE(t.priority,function(){mE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ef(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=cp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);np=n,r.target.dispatchEvent(n),np=null}else return e=lu(r),e!==null&&Vm(e),t.blockedOn=r,!1;e.shift()}return!0}function Ox(t,e,r){Ef(t)&&r.delete(e)}function zC(){lp=!1,Sa!==null&&Ef(Sa)&&(Sa=null),ka!==null&&Ef(ka)&&(ka=null),Ia!==null&&Ef(Ia)&&(Ia=null),Ic.forEach(Ox),Cc.forEach(Ox)}function Rl(t,e){t.blockedOn===e&&(t.blockedOn=null,lp||(lp=!0,dn.unstable_scheduleCallback(dn.unstable_NormalPriority,zC)))}function Nc(t){function e(s){return Rl(s,t)}if(0<Wu.length){Rl(Wu[0],t);for(var r=1;r<Wu.length;r++){var n=Wu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Sa!==null&&Rl(Sa,t),ka!==null&&Rl(ka,t),Ia!==null&&Rl(Ia,t),Ic.forEach(e),Cc.forEach(e),r=0;r<da.length;r++)n=da[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<da.length&&(r=da[0],r.blockedOn===null);)vE(r),r.blockedOn===null&&da.shift()}var bo=Zs.ReactCurrentBatchConfig,Xf=!0;function HC(t,e,r,n){var s=at,a=bo.transition;bo.transition=null;try{at=1,jm(t,e,r,n)}finally{at=s,bo.transition=a}}function WC(t,e,r,n){var s=at,a=bo.transition;bo.transition=null;try{at=4,jm(t,e,r,n)}finally{at=s,bo.transition=a}}function jm(t,e,r,n){if(Xf){var s=cp(t,e,r,n);if(s===null)ld(t,e,n,Yf,r),Fx(t,n);else if($C(s,t,e,r,n))n.stopPropagation();else if(Fx(t,n),e&4&&-1<UC.indexOf(t)){for(;s!==null;){var a=lu(s);if(a!==null&&pE(a),a=cp(t,e,r,n),a===null&&ld(t,e,n,Yf,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else ld(t,e,n,null,r)}}var Yf=null;function cp(t,e,r,n){if(Yf=null,t=Om(n),t=di(t),t!==null)if(e=ji(t),e===null)t=null;else if(r=e.tag,r===13){if(t=iE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yf=t,null}function yE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bC()){case Lm:return 1;case uE:return 4;case qf:case DC:return 16;case fE:return 536870912;default:return 16}default:return 16}}var _a=null,Bm=null,Tf=null;function _E(){if(Tf)return Tf;var t,e=Bm,r=e.length,n,s="value"in _a?_a.value:_a.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return Tf=s.slice(t,1<n?1-n:void 0)}function Af(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Gu(){return!0}function Lx(){return!1}function gn(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Gu:Lx,this.isPropagationStopped=Lx,this}return At(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gu)},persist:function(){},isPersistent:Gu}),e}var il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Um=gn(il),ou=At({},il,{view:0,detail:0}),GC=gn(ou),Z0,ed,Pl,Qh=At({},ou,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$m,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pl&&(Pl&&t.type==="mousemove"?(Z0=t.screenX-Pl.screenX,ed=t.screenY-Pl.screenY):ed=Z0=0,Pl=t),Z0)},movementY:function(t){return"movementY"in t?t.movementY:ed}}),Mx=gn(Qh),qC=At({},Qh,{dataTransfer:0}),KC=gn(qC),XC=At({},ou,{relatedTarget:0}),td=gn(XC),YC=At({},il,{animationName:0,elapsedTime:0,pseudoElement:0}),QC=gn(YC),JC=At({},il,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZC=gn(JC),e4=At({},il,{data:0}),Vx=gn(e4),t4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=n4[t])?!!e[t]:!1}function $m(){return s4}var a4=At({},ou,{key:function(t){if(t.key){var e=t4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Af(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?r4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$m,charCode:function(t){return t.type==="keypress"?Af(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Af(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),i4=gn(a4),o4=At({},Qh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jx=gn(o4),l4=At({},ou,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$m}),c4=gn(l4),u4=At({},il,{propertyName:0,elapsedTime:0,pseudoElement:0}),f4=gn(u4),h4=At({},Qh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),d4=gn(h4),p4=[9,13,27,32],zm=Hs&&"CompositionEvent"in window,Zl=null;Hs&&"documentMode"in document&&(Zl=document.documentMode);var m4=Hs&&"TextEvent"in window&&!Zl,wE=Hs&&(!zm||Zl&&8<Zl&&11>=Zl),Bx=" ",Ux=!1;function EE(t,e){switch(t){case"keyup":return p4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xo=!1;function g4(t,e){switch(t){case"compositionend":return TE(e);case"keypress":return e.which!==32?null:(Ux=!0,Bx);case"textInput":return t=e.data,t===Bx&&Ux?null:t;default:return null}}function x4(t,e){if(xo)return t==="compositionend"||!zm&&EE(t,e)?(t=_E(),Tf=Bm=_a=null,xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wE&&e.locale!=="ko"?null:e.data;default:return null}}var v4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $x(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v4[t.type]:e==="textarea"}function AE(t,e,r,n){tE(n),e=Qf(e,"onChange"),0<e.length&&(r=new Um("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ec=null,Rc=null;function y4(t){OE(t,0)}function Jh(t){var e=_o(t);if(Kw(e))return t}function _4(t,e){if(t==="change")return e}var SE=!1;if(Hs){var rd;if(Hs){var nd="oninput"in document;if(!nd){var zx=document.createElement("div");zx.setAttribute("oninput","return;"),nd=typeof zx.oninput=="function"}rd=nd}else rd=!1;SE=rd&&(!document.documentMode||9<document.documentMode)}function Hx(){ec&&(ec.detachEvent("onpropertychange",kE),Rc=ec=null)}function kE(t){if(t.propertyName==="value"&&Jh(Rc)){var e=[];AE(e,Rc,t,Om(t)),aE(y4,e)}}function w4(t,e,r){t==="focusin"?(Hx(),ec=e,Rc=r,ec.attachEvent("onpropertychange",kE)):t==="focusout"&&Hx()}function E4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Jh(Rc)}function T4(t,e){if(t==="click")return Jh(e)}function A4(t,e){if(t==="input"||t==="change")return Jh(e)}function S4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qn=typeof Object.is=="function"?Object.is:S4;function Pc(t,e){if(Qn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Wd.call(e,s)||!Qn(t[s],e[s]))return!1}return!0}function Wx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gx(t,e){var r=Wx(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wx(r)}}function IE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?IE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function CE(){for(var t=window,e=Hf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Hf(t.document)}return e}function Hm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function k4(t){var e=CE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&IE(r.ownerDocument.documentElement,r)){if(n!==null&&Hm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=Gx(r,a);var i=Gx(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var I4=Hs&&"documentMode"in document&&11>=document.documentMode,vo=null,up=null,tc=null,fp=!1;function qx(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fp||vo==null||vo!==Hf(n)||(n=vo,"selectionStart"in n&&Hm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),tc&&Pc(tc,n)||(tc=n,n=Qf(up,"onSelect"),0<n.length&&(e=new Um("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=vo)))}function qu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var yo={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},sd={},NE={};Hs&&(NE=document.createElement("div").style,"AnimationEvent"in window||(delete yo.animationend.animation,delete yo.animationiteration.animation,delete yo.animationstart.animation),"TransitionEvent"in window||delete yo.transitionend.transition);function Zh(t){if(sd[t])return sd[t];if(!yo[t])return t;var e=yo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in NE)return sd[t]=e[r];return t}var RE=Zh("animationend"),PE=Zh("animationiteration"),bE=Zh("animationstart"),DE=Zh("transitionend"),FE=new Map,Kx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ya(t,e){FE.set(t,e),Vi(e,[t])}for(var ad=0;ad<Kx.length;ad++){var id=Kx[ad],C4=id.toLowerCase(),N4=id[0].toUpperCase()+id.slice(1);Ya(C4,"on"+N4)}Ya(RE,"onAnimationEnd");Ya(PE,"onAnimationIteration");Ya(bE,"onAnimationStart");Ya("dblclick","onDoubleClick");Ya("focusin","onFocus");Ya("focusout","onBlur");Ya(DE,"onTransitionEnd");zo("onMouseEnter",["mouseout","mouseover"]);zo("onMouseLeave",["mouseout","mouseover"]);zo("onPointerEnter",["pointerout","pointerover"]);zo("onPointerLeave",["pointerout","pointerover"]);Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),R4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vl));function Xx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,CC(n,e,void 0,t),t.currentTarget=null}function OE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Xx(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Xx(s,o,c),a=l}}}if(Gf)throw t=ip,Gf=!1,ip=null,t}function pt(t,e){var r=e[gp];r===void 0&&(r=e[gp]=new Set);var n=t+"__bubble";r.has(n)||(LE(e,t,2,!1),r.add(n))}function od(t,e,r){var n=0;e&&(n|=4),LE(r,t,n,e)}var Ku="_reactListening"+Math.random().toString(36).slice(2);function bc(t){if(!t[Ku]){t[Ku]=!0,zw.forEach(function(r){r!=="selectionchange"&&(R4.has(r)||od(r,!1,t),od(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ku]||(e[Ku]=!0,od("selectionchange",!1,e))}}function LE(t,e,r,n){switch(yE(e)){case 1:var s=HC;break;case 4:s=WC;break;default:s=jm}r=s.bind(null,e,r,t),s=void 0,!ap||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function ld(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=di(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}aE(function(){var c=a,f=Om(r),h=[];e:{var d=FE.get(t);if(d!==void 0){var m=Um,g=t;switch(t){case"keypress":if(Af(r)===0)break e;case"keydown":case"keyup":m=i4;break;case"focusin":g="focus",m=td;break;case"focusout":g="blur",m=td;break;case"beforeblur":case"afterblur":m=td;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Mx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=KC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=c4;break;case RE:case PE:case bE:m=QC;break;case DE:m=f4;break;case"scroll":m=GC;break;case"wheel":m=d4;break;case"copy":case"cut":case"paste":m=ZC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=jx}var v=(e&4)!==0,w=!v&&t==="scroll",T=v?d!==null?d+"Capture":null:d;v=[];for(var _=c,y;_!==null;){y=_;var O=y.stateNode;if(y.tag===5&&O!==null&&(y=O,T!==null&&(O=kc(_,T),O!=null&&v.push(Dc(_,O,y)))),w)break;_=_.return}0<v.length&&(d=new m(d,g,null,r,f),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==np&&(g=r.relatedTarget||r.fromElement)&&(di(g)||g[Ws]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?di(g):null,g!==null&&(w=ji(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(v=Mx,O="onMouseLeave",T="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(v=jx,O="onPointerLeave",T="onPointerEnter",_="pointer"),w=m==null?d:_o(m),y=g==null?d:_o(g),d=new v(O,_+"leave",m,r,f),d.target=w,d.relatedTarget=y,O=null,di(f)===c&&(v=new v(T,_+"enter",g,r,f),v.target=y,v.relatedTarget=w,O=v),w=O,m&&g)t:{for(v=m,T=g,_=0,y=v;y;y=io(y))_++;for(y=0,O=T;O;O=io(O))y++;for(;0<_-y;)v=io(v),_--;for(;0<y-_;)T=io(T),y--;for(;_--;){if(v===T||T!==null&&v===T.alternate)break t;v=io(v),T=io(T)}v=null}else v=null;m!==null&&Yx(h,d,m,v,!1),g!==null&&w!==null&&Yx(h,w,g,v,!0)}}e:{if(d=c?_o(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var z=_4;else if($x(d))if(SE)z=A4;else{z=E4;var B=w4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=T4);if(z&&(z=z(t,c))){AE(h,z,r,f);break e}B&&B(t,d,c),t==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&Jd(d,"number",d.value)}switch(B=c?_o(c):window,t){case"focusin":($x(B)||B.contentEditable==="true")&&(vo=B,up=c,tc=null);break;case"focusout":tc=up=vo=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,qx(h,r,f);break;case"selectionchange":if(I4)break;case"keydown":case"keyup":qx(h,r,f)}var E;if(zm)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else xo?EE(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(wE&&r.locale!=="ko"&&(xo||S!=="onCompositionStart"?S==="onCompositionEnd"&&xo&&(E=_E()):(_a=f,Bm="value"in _a?_a.value:_a.textContent,xo=!0)),B=Qf(c,S),0<B.length&&(S=new Vx(S,t,null,r,f),h.push({event:S,listeners:B}),E?S.data=E:(E=TE(r),E!==null&&(S.data=E)))),(E=m4?g4(t,r):x4(t,r))&&(c=Qf(c,"onBeforeInput"),0<c.length&&(f=new Vx("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=E))}OE(h,e)})}function Dc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Qf(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=kc(t,r),a!=null&&n.unshift(Dc(t,a,s)),a=kc(t,e),a!=null&&n.push(Dc(t,a,s))),t=t.return}return n}function io(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Yx(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=kc(r,a),l!=null&&i.unshift(Dc(r,l,o))):s||(l=kc(r,a),l!=null&&i.push(Dc(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var P4=/\r\n?/g,b4=/\u0000|\uFFFD/g;function Qx(t){return(typeof t=="string"?t:""+t).replace(P4,`
`).replace(b4,"")}function Xu(t,e,r){if(e=Qx(e),Qx(t)!==e&&r)throw Error(le(425))}function Jf(){}var hp=null,dp=null;function pp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mp=typeof setTimeout=="function"?setTimeout:void 0,D4=typeof clearTimeout=="function"?clearTimeout:void 0,Jx=typeof Promise=="function"?Promise:void 0,F4=typeof queueMicrotask=="function"?queueMicrotask:typeof Jx<"u"?function(t){return Jx.resolve(null).then(t).catch(O4)}:mp;function O4(t){setTimeout(function(){throw t})}function cd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Nc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Nc(e)}function Ca(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ol=Math.random().toString(36).slice(2),us="__reactFiber$"+ol,Fc="__reactProps$"+ol,Ws="__reactContainer$"+ol,gp="__reactEvents$"+ol,L4="__reactListeners$"+ol,M4="__reactHandles$"+ol;function di(t){var e=t[us];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ws]||r[us]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Zx(t);t!==null;){if(r=t[us])return r;t=Zx(t)}return e}t=r,r=t.parentNode}return null}function lu(t){return t=t[us]||t[Ws],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _o(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function e0(t){return t[Fc]||null}var xp=[],wo=-1;function Qa(t){return{current:t}}function gt(t){0>wo||(t.current=xp[wo],xp[wo]=null,wo--)}function ct(t,e){wo++,xp[wo]=t.current,t.current=e}var Ba={},br=Qa(Ba),Zr=Qa(!1),Ai=Ba;function Ho(t,e){var r=t.type.contextTypes;if(!r)return Ba;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function en(t){return t=t.childContextTypes,t!=null}function Zf(){gt(Zr),gt(br)}function ev(t,e,r){if(br.current!==Ba)throw Error(le(168));ct(br,e),ct(Zr,r)}function ME(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(le(108,wC(t)||"Unknown",s));return At({},r,n)}function eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ba,Ai=br.current,ct(br,t),ct(Zr,Zr.current),!0}function tv(t,e,r){var n=t.stateNode;if(!n)throw Error(le(169));r?(t=ME(t,e,Ai),n.__reactInternalMemoizedMergedChildContext=t,gt(Zr),gt(br),ct(br,t)):gt(Zr),ct(Zr,r)}var Ds=null,t0=!1,ud=!1;function VE(t){Ds===null?Ds=[t]:Ds.push(t)}function V4(t){t0=!0,VE(t)}function Ja(){if(!ud&&Ds!==null){ud=!0;var t=0,e=at;try{var r=Ds;for(at=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Ds=null,t0=!1}catch(s){throw Ds!==null&&(Ds=Ds.slice(t+1)),cE(Lm,Ja),s}finally{at=e,ud=!1}}return null}var Eo=[],To=0,th=null,rh=0,wn=[],En=0,Si=null,Fs=1,Os="";function ci(t,e){Eo[To++]=rh,Eo[To++]=th,th=t,rh=e}function jE(t,e,r){wn[En++]=Fs,wn[En++]=Os,wn[En++]=Si,Si=t;var n=Fs;t=Os;var s=32-Kn(n)-1;n&=~(1<<s),r+=1;var a=32-Kn(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Fs=1<<32-Kn(e)+s|r<<s|n,Os=a+t}else Fs=1<<a|r<<s|n,Os=t}function Wm(t){t.return!==null&&(ci(t,1),jE(t,1,0))}function Gm(t){for(;t===th;)th=Eo[--To],Eo[To]=null,rh=Eo[--To],Eo[To]=null;for(;t===Si;)Si=wn[--En],wn[En]=null,Os=wn[--En],wn[En]=null,Fs=wn[--En],wn[En]=null}var fn=null,cn=null,wt=!1,zn=null;function BE(t,e){var r=Sn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function rv(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fn=t,cn=Ca(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fn=t,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Si!==null?{id:Fs,overflow:Os}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Sn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,fn=t,cn=null,!0):!1;default:return!1}}function vp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yp(t){if(wt){var e=cn;if(e){var r=e;if(!rv(t,e)){if(vp(t))throw Error(le(418));e=Ca(r.nextSibling);var n=fn;e&&rv(t,e)?BE(n,r):(t.flags=t.flags&-4097|2,wt=!1,fn=t)}}else{if(vp(t))throw Error(le(418));t.flags=t.flags&-4097|2,wt=!1,fn=t}}}function nv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fn=t}function Yu(t){if(t!==fn)return!1;if(!wt)return nv(t),wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pp(t.type,t.memoizedProps)),e&&(e=cn)){if(vp(t))throw UE(),Error(le(418));for(;e;)BE(t,e),e=Ca(e.nextSibling)}if(nv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){cn=Ca(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}cn=null}}else cn=fn?Ca(t.stateNode.nextSibling):null;return!0}function UE(){for(var t=cn;t;)t=Ca(t.nextSibling)}function Wo(){cn=fn=null,wt=!1}function qm(t){zn===null?zn=[t]:zn.push(t)}var j4=Zs.ReactCurrentBatchConfig;function bl(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,t))}return t}function Qu(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sv(t){var e=t._init;return e(t._payload)}function $E(t){function e(T,_){if(t){var y=T.deletions;y===null?(T.deletions=[_],T.flags|=16):y.push(_)}}function r(T,_){if(!t)return null;for(;_!==null;)e(T,_),_=_.sibling;return null}function n(T,_){for(T=new Map;_!==null;)_.key!==null?T.set(_.key,_):T.set(_.index,_),_=_.sibling;return T}function s(T,_){return T=ba(T,_),T.index=0,T.sibling=null,T}function a(T,_,y){return T.index=y,t?(y=T.alternate,y!==null?(y=y.index,y<_?(T.flags|=2,_):y):(T.flags|=2,_)):(T.flags|=1048576,_)}function i(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,_,y,O){return _===null||_.tag!==6?(_=xd(y,T.mode,O),_.return=T,_):(_=s(_,y),_.return=T,_)}function l(T,_,y,O){var z=y.type;return z===go?f(T,_,y.props.children,O,y.key):_!==null&&(_.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===fa&&sv(z)===_.type)?(O=s(_,y.props),O.ref=bl(T,_,y),O.return=T,O):(O=Pf(y.type,y.key,y.props,null,T.mode,O),O.ref=bl(T,_,y),O.return=T,O)}function c(T,_,y,O){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=vd(y,T.mode,O),_.return=T,_):(_=s(_,y.children||[]),_.return=T,_)}function f(T,_,y,O,z){return _===null||_.tag!==7?(_=_i(y,T.mode,O,z),_.return=T,_):(_=s(_,y),_.return=T,_)}function h(T,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=xd(""+_,T.mode,y),_.return=T,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Bu:return y=Pf(_.type,_.key,_.props,null,T.mode,y),y.ref=bl(T,null,_),y.return=T,y;case mo:return _=vd(_,T.mode,y),_.return=T,_;case fa:var O=_._init;return h(T,O(_._payload),y)}if(Ll(_)||Il(_))return _=_i(_,T.mode,y,null),_.return=T,_;Qu(T,_)}return null}function d(T,_,y,O){var z=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return z!==null?null:o(T,_,""+y,O);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Bu:return y.key===z?l(T,_,y,O):null;case mo:return y.key===z?c(T,_,y,O):null;case fa:return z=y._init,d(T,_,z(y._payload),O)}if(Ll(y)||Il(y))return z!==null?null:f(T,_,y,O,null);Qu(T,y)}return null}function m(T,_,y,O,z){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(y)||null,o(_,T,""+O,z);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Bu:return T=T.get(O.key===null?y:O.key)||null,l(_,T,O,z);case mo:return T=T.get(O.key===null?y:O.key)||null,c(_,T,O,z);case fa:var B=O._init;return m(T,_,y,B(O._payload),z)}if(Ll(O)||Il(O))return T=T.get(y)||null,f(_,T,O,z,null);Qu(_,O)}return null}function g(T,_,y,O){for(var z=null,B=null,E=_,S=_=0,k=null;E!==null&&S<y.length;S++){E.index>S?(k=E,E=null):k=E.sibling;var R=d(T,E,y[S],O);if(R===null){E===null&&(E=k);break}t&&E&&R.alternate===null&&e(T,E),_=a(R,_,S),B===null?z=R:B.sibling=R,B=R,E=k}if(S===y.length)return r(T,E),wt&&ci(T,S),z;if(E===null){for(;S<y.length;S++)E=h(T,y[S],O),E!==null&&(_=a(E,_,S),B===null?z=E:B.sibling=E,B=E);return wt&&ci(T,S),z}for(E=n(T,E);S<y.length;S++)k=m(E,T,S,y[S],O),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?S:k.key),_=a(k,_,S),B===null?z=k:B.sibling=k,B=k);return t&&E.forEach(function(b){return e(T,b)}),wt&&ci(T,S),z}function v(T,_,y,O){var z=Il(y);if(typeof z!="function")throw Error(le(150));if(y=z.call(y),y==null)throw Error(le(151));for(var B=z=null,E=_,S=_=0,k=null,R=y.next();E!==null&&!R.done;S++,R=y.next()){E.index>S?(k=E,E=null):k=E.sibling;var b=d(T,E,R.value,O);if(b===null){E===null&&(E=k);break}t&&E&&b.alternate===null&&e(T,E),_=a(b,_,S),B===null?z=b:B.sibling=b,B=b,E=k}if(R.done)return r(T,E),wt&&ci(T,S),z;if(E===null){for(;!R.done;S++,R=y.next())R=h(T,R.value,O),R!==null&&(_=a(R,_,S),B===null?z=R:B.sibling=R,B=R);return wt&&ci(T,S),z}for(E=n(T,E);!R.done;S++,R=y.next())R=m(E,T,S,R.value,O),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?S:R.key),_=a(R,_,S),B===null?z=R:B.sibling=R,B=R);return t&&E.forEach(function(D){return e(T,D)}),wt&&ci(T,S),z}function w(T,_,y,O){if(typeof y=="object"&&y!==null&&y.type===go&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Bu:e:{for(var z=y.key,B=_;B!==null;){if(B.key===z){if(z=y.type,z===go){if(B.tag===7){r(T,B.sibling),_=s(B,y.props.children),_.return=T,T=_;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===fa&&sv(z)===B.type){r(T,B.sibling),_=s(B,y.props),_.ref=bl(T,B,y),_.return=T,T=_;break e}r(T,B);break}else e(T,B);B=B.sibling}y.type===go?(_=_i(y.props.children,T.mode,O,y.key),_.return=T,T=_):(O=Pf(y.type,y.key,y.props,null,T.mode,O),O.ref=bl(T,_,y),O.return=T,T=O)}return i(T);case mo:e:{for(B=y.key;_!==null;){if(_.key===B)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){r(T,_.sibling),_=s(_,y.children||[]),_.return=T,T=_;break e}else{r(T,_);break}else e(T,_);_=_.sibling}_=vd(y,T.mode,O),_.return=T,T=_}return i(T);case fa:return B=y._init,w(T,_,B(y._payload),O)}if(Ll(y))return g(T,_,y,O);if(Il(y))return v(T,_,y,O);Qu(T,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(r(T,_.sibling),_=s(_,y),_.return=T,T=_):(r(T,_),_=xd(y,T.mode,O),_.return=T,T=_),i(T)):r(T,_)}return w}var Go=$E(!0),zE=$E(!1),nh=Qa(null),sh=null,Ao=null,Km=null;function Xm(){Km=Ao=sh=null}function Ym(t){var e=nh.current;gt(nh),t._currentValue=e}function _p(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Do(t,e){sh=t,Km=Ao=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jr=!0),t.firstContext=null)}function Nn(t){var e=t._currentValue;if(Km!==t)if(t={context:t,memoizedValue:e,next:null},Ao===null){if(sh===null)throw Error(le(308));Ao=t,sh.dependencies={lanes:0,firstContext:t}}else Ao=Ao.next=t;return e}var pi=null;function Qm(t){pi===null?pi=[t]:pi.push(t)}function HE(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Qm(e)):(r.next=s.next,s.next=r),e.interleaved=r,Gs(t,n)}function Gs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ha=!1;function Jm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function js(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Na(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Gs(t,r)}return s=n.interleaved,s===null?(e.next=e,Qm(n)):(e.next=s.next,s.next=e),n.interleaved=e,Gs(t,r)}function Sf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Mm(t,r)}}function av(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ah(t,e,r,n){var s=t.updateQueue;ha=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,f=c=l=null,o=a;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,v=o;switch(d=e,m=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(m,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,d=typeof g=="function"?g.call(m,h,d):g,d==null)break e;h=At({},h,d);break e;case 2:ha=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=h):f=f.next=m,i|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Ii|=i,t.lanes=i,t.memoizedState=h}}function iv(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(le(191,s));s.call(n)}}}var cu={},ms=Qa(cu),Oc=Qa(cu),Lc=Qa(cu);function mi(t){if(t===cu)throw Error(le(174));return t}function Zm(t,e){switch(ct(Lc,e),ct(Oc,t),ct(ms,cu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ep(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ep(e,t)}gt(ms),ct(ms,e)}function qo(){gt(ms),gt(Oc),gt(Lc)}function GE(t){mi(Lc.current);var e=mi(ms.current),r=ep(e,t.type);e!==r&&(ct(Oc,t),ct(ms,r))}function eg(t){Oc.current===t&&(gt(ms),gt(Oc))}var Et=Qa(0);function ih(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fd=[];function tg(){for(var t=0;t<fd.length;t++)fd[t]._workInProgressVersionPrimary=null;fd.length=0}var kf=Zs.ReactCurrentDispatcher,hd=Zs.ReactCurrentBatchConfig,ki=0,Tt=null,Xt=null,rr=null,oh=!1,rc=!1,Mc=0,B4=0;function wr(){throw Error(le(321))}function rg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Qn(t[r],e[r]))return!1;return!0}function ng(t,e,r,n,s,a){if(ki=a,Tt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kf.current=t===null||t.memoizedState===null?H4:W4,t=r(n,s),rc){a=0;do{if(rc=!1,Mc=0,25<=a)throw Error(le(301));a+=1,rr=Xt=null,e.updateQueue=null,kf.current=G4,t=r(n,s)}while(rc)}if(kf.current=lh,e=Xt!==null&&Xt.next!==null,ki=0,rr=Xt=Tt=null,oh=!1,e)throw Error(le(300));return t}function sg(){var t=Mc!==0;return Mc=0,t}function ls(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?Tt.memoizedState=rr=t:rr=rr.next=t,rr}function Rn(){if(Xt===null){var t=Tt.alternate;t=t!==null?t.memoizedState:null}else t=Xt.next;var e=rr===null?Tt.memoizedState:rr.next;if(e!==null)rr=e,Xt=t;else{if(t===null)throw Error(le(310));Xt=t,t={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},rr===null?Tt.memoizedState=rr=t:rr=rr.next=t}return rr}function Vc(t,e){return typeof e=="function"?e(t):e}function dd(t){var e=Rn(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=Xt,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var f=c.lane;if((ki&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Tt.lanes|=f,Ii|=f}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,Qn(n,e.memoizedState)||(Jr=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,Tt.lanes|=a,Ii|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function pd(t){var e=Rn(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Qn(a,e.memoizedState)||(Jr=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function qE(){}function KE(t,e){var r=Tt,n=Rn(),s=e(),a=!Qn(n.memoizedState,s);if(a&&(n.memoizedState=s,Jr=!0),n=n.queue,ag(QE.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||rr!==null&&rr.memoizedState.tag&1){if(r.flags|=2048,jc(9,YE.bind(null,r,n,s,e),void 0,null),nr===null)throw Error(le(349));ki&30||XE(r,e,s)}return s}function XE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Tt.updateQueue,e===null?(e={lastEffect:null,stores:null},Tt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function YE(t,e,r,n){e.value=r,e.getSnapshot=n,JE(e)&&ZE(t)}function QE(t,e,r){return r(function(){JE(e)&&ZE(t)})}function JE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Qn(t,r)}catch{return!0}}function ZE(t){var e=Gs(t,1);e!==null&&Xn(e,t,1,-1)}function ov(t){var e=ls();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vc,lastRenderedState:t},e.queue=t,t=t.dispatch=z4.bind(null,Tt,t),[e.memoizedState,t]}function jc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Tt.updateQueue,e===null?(e={lastEffect:null,stores:null},Tt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function e2(){return Rn().memoizedState}function If(t,e,r,n){var s=ls();Tt.flags|=t,s.memoizedState=jc(1|e,r,void 0,n===void 0?null:n)}function r0(t,e,r,n){var s=Rn();n=n===void 0?null:n;var a=void 0;if(Xt!==null){var i=Xt.memoizedState;if(a=i.destroy,n!==null&&rg(n,i.deps)){s.memoizedState=jc(e,r,a,n);return}}Tt.flags|=t,s.memoizedState=jc(1|e,r,a,n)}function lv(t,e){return If(8390656,8,t,e)}function ag(t,e){return r0(2048,8,t,e)}function t2(t,e){return r0(4,2,t,e)}function r2(t,e){return r0(4,4,t,e)}function n2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function s2(t,e,r){return r=r!=null?r.concat([t]):null,r0(4,4,n2.bind(null,e,t),r)}function ig(){}function a2(t,e){var r=Rn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function i2(t,e){var r=Rn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function o2(t,e,r){return ki&21?(Qn(r,e)||(r=hE(),Tt.lanes|=r,Ii|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jr=!0),t.memoizedState=r)}function U4(t,e){var r=at;at=r!==0&&4>r?r:4,t(!0);var n=hd.transition;hd.transition={};try{t(!1),e()}finally{at=r,hd.transition=n}}function l2(){return Rn().memoizedState}function $4(t,e,r){var n=Pa(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},c2(t))u2(e,r);else if(r=HE(t,e,r,n),r!==null){var s=zr();Xn(r,t,n,s),f2(r,e,n)}}function z4(t,e,r){var n=Pa(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(c2(t))u2(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Qn(o,i)){var l=e.interleaved;l===null?(s.next=s,Qm(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=HE(t,e,s,n),r!==null&&(s=zr(),Xn(r,t,n,s),f2(r,e,n))}}function c2(t){var e=t.alternate;return t===Tt||e!==null&&e===Tt}function u2(t,e){rc=oh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function f2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Mm(t,r)}}var lh={readContext:Nn,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useInsertionEffect:wr,useLayoutEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useMutableSource:wr,useSyncExternalStore:wr,useId:wr,unstable_isNewReconciler:!1},H4={readContext:Nn,useCallback:function(t,e){return ls().memoizedState=[t,e===void 0?null:e],t},useContext:Nn,useEffect:lv,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,If(4194308,4,n2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return If(4194308,4,t,e)},useInsertionEffect:function(t,e){return If(4,2,t,e)},useMemo:function(t,e){var r=ls();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ls();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=$4.bind(null,Tt,t),[n.memoizedState,t]},useRef:function(t){var e=ls();return t={current:t},e.memoizedState=t},useState:ov,useDebugValue:ig,useDeferredValue:function(t){return ls().memoizedState=t},useTransition:function(){var t=ov(!1),e=t[0];return t=U4.bind(null,t[1]),ls().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Tt,s=ls();if(wt){if(r===void 0)throw Error(le(407));r=r()}else{if(r=e(),nr===null)throw Error(le(349));ki&30||XE(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,lv(QE.bind(null,n,a,t),[t]),n.flags|=2048,jc(9,YE.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=ls(),e=nr.identifierPrefix;if(wt){var r=Os,n=Fs;r=(n&~(1<<32-Kn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Mc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=B4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},W4={readContext:Nn,useCallback:a2,useContext:Nn,useEffect:ag,useImperativeHandle:s2,useInsertionEffect:t2,useLayoutEffect:r2,useMemo:i2,useReducer:dd,useRef:e2,useState:function(){return dd(Vc)},useDebugValue:ig,useDeferredValue:function(t){var e=Rn();return o2(e,Xt.memoizedState,t)},useTransition:function(){var t=dd(Vc)[0],e=Rn().memoizedState;return[t,e]},useMutableSource:qE,useSyncExternalStore:KE,useId:l2,unstable_isNewReconciler:!1},G4={readContext:Nn,useCallback:a2,useContext:Nn,useEffect:ag,useImperativeHandle:s2,useInsertionEffect:t2,useLayoutEffect:r2,useMemo:i2,useReducer:pd,useRef:e2,useState:function(){return pd(Vc)},useDebugValue:ig,useDeferredValue:function(t){var e=Rn();return Xt===null?e.memoizedState=t:o2(e,Xt.memoizedState,t)},useTransition:function(){var t=pd(Vc)[0],e=Rn().memoizedState;return[t,e]},useMutableSource:qE,useSyncExternalStore:KE,useId:l2,unstable_isNewReconciler:!1};function jn(t,e){if(t&&t.defaultProps){e=At({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function wp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:At({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var n0={isMounted:function(t){return(t=t._reactInternals)?ji(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=zr(),s=Pa(t),a=js(n,s);a.payload=e,r!=null&&(a.callback=r),e=Na(t,a,s),e!==null&&(Xn(e,t,s,n),Sf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=zr(),s=Pa(t),a=js(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Na(t,a,s),e!==null&&(Xn(e,t,s,n),Sf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=zr(),n=Pa(t),s=js(r,n);s.tag=2,e!=null&&(s.callback=e),e=Na(t,s,n),e!==null&&(Xn(e,t,n,r),Sf(e,t,n))}};function cv(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!Pc(r,n)||!Pc(s,a):!0}function h2(t,e,r){var n=!1,s=Ba,a=e.contextType;return typeof a=="object"&&a!==null?a=Nn(a):(s=en(e)?Ai:br.current,n=e.contextTypes,a=(n=n!=null)?Ho(t,s):Ba),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=n0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function uv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&n0.enqueueReplaceState(e,e.state,null)}function Ep(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Jm(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Nn(a):(a=en(e)?Ai:br.current,s.context=Ho(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(wp(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&n0.enqueueReplaceState(s,s.state,null),ah(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ko(t,e){try{var r="",n=e;do r+=_C(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function md(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Tp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var q4=typeof WeakMap=="function"?WeakMap:Map;function d2(t,e,r){r=js(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){uh||(uh=!0,Dp=n),Tp(t,e)},r}function p2(t,e,r){r=js(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Tp(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Tp(t,e),typeof n!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function fv(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new q4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=oN.bind(null,t,e,r),e.then(t,t))}function hv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dv(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=js(-1,1),e.tag=2,Na(r,e,1))),r.lanes|=1),t)}var K4=Zs.ReactCurrentOwner,Jr=!1;function jr(t,e,r,n){e.child=t===null?zE(e,null,r,n):Go(e,t.child,r,n)}function pv(t,e,r,n,s){r=r.render;var a=e.ref;return Do(e,s),n=ng(t,e,r,n,a,s),r=sg(),t!==null&&!Jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qs(t,e,s)):(wt&&r&&Wm(e),e.flags|=1,jr(t,e,n,s),e.child)}function mv(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!pg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,m2(t,e,a,n,s)):(t=Pf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Pc,r(i,n)&&t.ref===e.ref)return qs(t,e,s)}return e.flags|=1,t=ba(a,n),t.ref=e.ref,t.return=e,e.child=t}function m2(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(Pc(a,n)&&t.ref===e.ref)if(Jr=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Jr=!0);else return e.lanes=t.lanes,qs(t,e,s)}return Ap(t,e,r,n,s)}function g2(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(ko,an),an|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(ko,an),an|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,ct(ko,an),an|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,ct(ko,an),an|=n;return jr(t,e,s,r),e.child}function x2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Ap(t,e,r,n,s){var a=en(r)?Ai:br.current;return a=Ho(e,a),Do(e,s),r=ng(t,e,r,n,a,s),n=sg(),t!==null&&!Jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qs(t,e,s)):(wt&&n&&Wm(e),e.flags|=1,jr(t,e,r,s),e.child)}function gv(t,e,r,n,s){if(en(r)){var a=!0;eh(e)}else a=!1;if(Do(e,s),e.stateNode===null)Cf(t,e),h2(e,r,n),Ep(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Nn(c):(c=en(r)?Ai:br.current,c=Ho(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&uv(e,i,n,c),ha=!1;var d=e.memoizedState;i.state=d,ah(e,n,i,s),l=e.memoizedState,o!==n||d!==l||Zr.current||ha?(typeof f=="function"&&(wp(e,r,f,n),l=e.memoizedState),(o=ha||cv(e,r,o,n,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,WE(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:jn(e.type,o),i.props=c,h=e.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Nn(l):(l=en(r)?Ai:br.current,l=Ho(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||d!==l)&&uv(e,i,n,l),ha=!1,d=e.memoizedState,i.state=d,ah(e,n,i,s);var g=e.memoizedState;o!==h||d!==g||Zr.current||ha?(typeof m=="function"&&(wp(e,r,m,n),g=e.memoizedState),(c=ha||cv(e,r,c,n,d,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Sp(t,e,r,n,a,s)}function Sp(t,e,r,n,s,a){x2(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&tv(e,r,!1),qs(t,e,a);n=e.stateNode,K4.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=Go(e,t.child,null,a),e.child=Go(e,null,o,a)):jr(t,e,o,a),e.memoizedState=n.state,s&&tv(e,r,!0),e.child}function v2(t){var e=t.stateNode;e.pendingContext?ev(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ev(t,e.context,!1),Zm(t,e.containerInfo)}function xv(t,e,r,n,s){return Wo(),qm(s),e.flags|=256,jr(t,e,r,n),e.child}var kp={dehydrated:null,treeContext:null,retryLane:0};function Ip(t){return{baseLanes:t,cachePool:null,transitions:null}}function y2(t,e,r){var n=e.pendingProps,s=Et.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ct(Et,s&1),t===null)return yp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=i0(i,n,0,null),t=_i(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Ip(r),e.memoizedState=kp,t):og(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return X4(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ba(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ba(o,a):(a=_i(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?Ip(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=kp,n}return a=t.child,t=a.sibling,n=ba(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function og(t,e){return e=i0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ju(t,e,r,n){return n!==null&&qm(n),Go(e,t.child,null,r),t=og(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function X4(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=md(Error(le(422))),Ju(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=i0({mode:"visible",children:n.children},s,0,null),a=_i(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&Go(e,t.child,null,i),e.child.memoizedState=Ip(i),e.memoizedState=kp,a);if(!(e.mode&1))return Ju(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(le(419)),n=md(a,n,void 0),Ju(t,e,i,n)}if(o=(i&t.childLanes)!==0,Jr||o){if(n=nr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Gs(t,s),Xn(n,t,s,-1))}return dg(),n=md(Error(le(421))),Ju(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=lN.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,cn=Ca(s.nextSibling),fn=e,wt=!0,zn=null,t!==null&&(wn[En++]=Fs,wn[En++]=Os,wn[En++]=Si,Fs=t.id,Os=t.overflow,Si=e),e=og(e,n.children),e.flags|=4096,e)}function vv(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),_p(t.return,e,r)}function gd(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function _2(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(jr(t,e,n.children,r),n=Et.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vv(t,r,e);else if(t.tag===19)vv(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ct(Et,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&ih(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),gd(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ih(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}gd(e,!0,r,null,a);break;case"together":gd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ii|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,r=ba(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ba(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Y4(t,e,r){switch(e.tag){case 3:v2(e),Wo();break;case 5:GE(e);break;case 1:en(e.type)&&eh(e);break;case 4:Zm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;ct(nh,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ct(Et,Et.current&1),e.flags|=128,null):r&e.child.childLanes?y2(t,e,r):(ct(Et,Et.current&1),t=qs(t,e,r),t!==null?t.sibling:null);ct(Et,Et.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return _2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ct(Et,Et.current),n)break;return null;case 22:case 23:return e.lanes=0,g2(t,e,r)}return qs(t,e,r)}var w2,Cp,E2,T2;w2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Cp=function(){};E2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,mi(ms.current);var a=null;switch(r){case"input":s=Yd(t,s),n=Yd(t,n),a=[];break;case"select":s=At({},s,{value:void 0}),n=At({},n,{value:void 0}),a=[];break;case"textarea":s=Zd(t,s),n=Zd(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Jf)}tp(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ac.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ac.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&pt("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};T2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Dl(t,e){if(!wt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Er(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Q4(t,e,r){var n=e.pendingProps;switch(Gm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(e),null;case 1:return en(e.type)&&Zf(),Er(e),null;case 3:return n=e.stateNode,qo(),gt(Zr),gt(br),tg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Yu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zn!==null&&(Lp(zn),zn=null))),Cp(t,e),Er(e),null;case 5:eg(e);var s=mi(Lc.current);if(r=e.type,t!==null&&e.stateNode!=null)E2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(le(166));return Er(e),null}if(t=mi(ms.current),Yu(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[us]=e,n[Fc]=a,t=(e.mode&1)!==0,r){case"dialog":pt("cancel",n),pt("close",n);break;case"iframe":case"object":case"embed":pt("load",n);break;case"video":case"audio":for(s=0;s<Vl.length;s++)pt(Vl[s],n);break;case"source":pt("error",n);break;case"img":case"image":case"link":pt("error",n),pt("load",n);break;case"details":pt("toggle",n);break;case"input":Ix(n,a),pt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},pt("invalid",n);break;case"textarea":Nx(n,a),pt("invalid",n)}tp(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Xu(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Xu(n.textContent,o,t),s=["children",""+o]):Ac.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&pt("scroll",n)}switch(r){case"input":Uu(n),Cx(n,a,!0);break;case"textarea":Uu(n),Rx(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Jf)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[us]=e,t[Fc]=n,w2(t,e,!1,!1),e.stateNode=t;e:{switch(i=rp(r,n),r){case"dialog":pt("cancel",t),pt("close",t),s=n;break;case"iframe":case"object":case"embed":pt("load",t),s=n;break;case"video":case"audio":for(s=0;s<Vl.length;s++)pt(Vl[s],t);s=n;break;case"source":pt("error",t),s=n;break;case"img":case"image":case"link":pt("error",t),pt("load",t),s=n;break;case"details":pt("toggle",t),s=n;break;case"input":Ix(t,n),s=Yd(t,n),pt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=At({},n,{value:void 0}),pt("invalid",t);break;case"textarea":Nx(t,n),s=Zd(t,n),pt("invalid",t);break;default:s=n}tp(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?eE(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jw(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Sc(t,l):typeof l=="number"&&Sc(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ac.hasOwnProperty(a)?l!=null&&a==="onScroll"&&pt("scroll",t):l!=null&&Pm(t,a,l,i))}switch(r){case"input":Uu(t),Cx(t,n,!1);break;case"textarea":Uu(t),Rx(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ja(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?No(t,!!n.multiple,a,!1):n.defaultValue!=null&&No(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Er(e),null;case 6:if(t&&e.stateNode!=null)T2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(le(166));if(r=mi(Lc.current),mi(ms.current),Yu(e)){if(n=e.stateNode,r=e.memoizedProps,n[us]=e,(a=n.nodeValue!==r)&&(t=fn,t!==null))switch(t.tag){case 3:Xu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xu(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[us]=e,e.stateNode=n}return Er(e),null;case 13:if(gt(Et),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wt&&cn!==null&&e.mode&1&&!(e.flags&128))UE(),Wo(),e.flags|=98560,a=!1;else if(a=Yu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(le(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(le(317));a[us]=e}else Wo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Er(e),a=!1}else zn!==null&&(Lp(zn),zn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Et.current&1?Yt===0&&(Yt=3):dg())),e.updateQueue!==null&&(e.flags|=4),Er(e),null);case 4:return qo(),Cp(t,e),t===null&&bc(e.stateNode.containerInfo),Er(e),null;case 10:return Ym(e.type._context),Er(e),null;case 17:return en(e.type)&&Zf(),Er(e),null;case 19:if(gt(Et),a=e.memoizedState,a===null)return Er(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)Dl(a,!1);else{if(Yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ih(t),i!==null){for(e.flags|=128,Dl(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ct(Et,Et.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ot()>Xo&&(e.flags|=128,n=!0,Dl(a,!1),e.lanes=4194304)}else{if(!n)if(t=ih(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Dl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!wt)return Er(e),null}else 2*Ot()-a.renderingStartTime>Xo&&r!==1073741824&&(e.flags|=128,n=!0,Dl(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ot(),e.sibling=null,r=Et.current,ct(Et,n?r&1|2:r&1),e):(Er(e),null);case 22:case 23:return hg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?an&1073741824&&(Er(e),e.subtreeFlags&6&&(e.flags|=8192)):Er(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function J4(t,e){switch(Gm(e),e.tag){case 1:return en(e.type)&&Zf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qo(),gt(Zr),gt(br),tg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return eg(e),null;case 13:if(gt(Et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));Wo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(Et),null;case 4:return qo(),null;case 10:return Ym(e.type._context),null;case 22:case 23:return hg(),null;case 24:return null;default:return null}}var Zu=!1,Ir=!1,Z4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function So(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Rt(t,e,n)}else r.current=null}function Np(t,e,r){try{r()}catch(n){Rt(t,e,n)}}var yv=!1;function eN(t,e){if(hp=Xf,t=CE(),Hm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++c===s&&(o=i),d===a&&++f===n&&(l=i),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(dp={focusedElem:t,selectionRange:r},Xf=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,w=g.memoizedState,T=e.stateNode,_=T.getSnapshotBeforeUpdate(e.elementType===e.type?v:jn(e.type,v),w);T.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(O){Rt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return g=yv,yv=!1,g}function nc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&Np(e,r,a)}s=s.next}while(s!==n)}}function s0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Rp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function A2(t){var e=t.alternate;e!==null&&(t.alternate=null,A2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[us],delete e[Fc],delete e[gp],delete e[L4],delete e[M4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function S2(t){return t.tag===5||t.tag===3||t.tag===4}function _v(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||S2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Jf));else if(n!==4&&(t=t.child,t!==null))for(Pp(t,e,r),t=t.sibling;t!==null;)Pp(t,e,r),t=t.sibling}function bp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(bp(t,e,r),t=t.sibling;t!==null;)bp(t,e,r),t=t.sibling}var cr=null,$n=!1;function la(t,e,r){for(r=r.child;r!==null;)k2(t,e,r),r=r.sibling}function k2(t,e,r){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(Yh,r)}catch{}switch(r.tag){case 5:Ir||So(r,e);case 6:var n=cr,s=$n;cr=null,la(t,e,r),cr=n,$n=s,cr!==null&&($n?(t=cr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):cr.removeChild(r.stateNode));break;case 18:cr!==null&&($n?(t=cr,r=r.stateNode,t.nodeType===8?cd(t.parentNode,r):t.nodeType===1&&cd(t,r),Nc(t)):cd(cr,r.stateNode));break;case 4:n=cr,s=$n,cr=r.stateNode.containerInfo,$n=!0,la(t,e,r),cr=n,$n=s;break;case 0:case 11:case 14:case 15:if(!Ir&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Np(r,e,i),s=s.next}while(s!==n)}la(t,e,r);break;case 1:if(!Ir&&(So(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Rt(r,e,o)}la(t,e,r);break;case 21:la(t,e,r);break;case 22:r.mode&1?(Ir=(n=Ir)||r.memoizedState!==null,la(t,e,r),Ir=n):la(t,e,r);break;default:la(t,e,r)}}function wv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Z4),e.forEach(function(n){var s=cN.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ln(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:cr=o.stateNode,$n=!1;break e;case 3:cr=o.stateNode.containerInfo,$n=!0;break e;case 4:cr=o.stateNode.containerInfo,$n=!0;break e}o=o.return}if(cr===null)throw Error(le(160));k2(a,i,s),cr=null,$n=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Rt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)I2(e,t),e=e.sibling}function I2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ln(e,t),as(t),n&4){try{nc(3,t,t.return),s0(3,t)}catch(v){Rt(t,t.return,v)}try{nc(5,t,t.return)}catch(v){Rt(t,t.return,v)}}break;case 1:Ln(e,t),as(t),n&512&&r!==null&&So(r,r.return);break;case 5:if(Ln(e,t),as(t),n&512&&r!==null&&So(r,r.return),t.flags&32){var s=t.stateNode;try{Sc(s,"")}catch(v){Rt(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Xw(s,a),rp(o,i);var c=rp(o,a);for(i=0;i<l.length;i+=2){var f=l[i],h=l[i+1];f==="style"?eE(s,h):f==="dangerouslySetInnerHTML"?Jw(s,h):f==="children"?Sc(s,h):Pm(s,f,h,c)}switch(o){case"input":Qd(s,a);break;case"textarea":Yw(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?No(s,!!a.multiple,m,!1):d!==!!a.multiple&&(a.defaultValue!=null?No(s,!!a.multiple,a.defaultValue,!0):No(s,!!a.multiple,a.multiple?[]:"",!1))}s[Fc]=a}catch(v){Rt(t,t.return,v)}}break;case 6:if(Ln(e,t),as(t),n&4){if(t.stateNode===null)throw Error(le(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){Rt(t,t.return,v)}}break;case 3:if(Ln(e,t),as(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Nc(e.containerInfo)}catch(v){Rt(t,t.return,v)}break;case 4:Ln(e,t),as(t);break;case 13:Ln(e,t),as(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(ug=Ot())),n&4&&wv(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Ir=(c=Ir)||f,Ln(e,t),Ir=c):Ln(e,t),as(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Ce=t,f=t.child;f!==null;){for(h=Ce=f;Ce!==null;){switch(d=Ce,m=d.child,d.tag){case 0:case 11:case 14:case 15:nc(4,d,d.return);break;case 1:So(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Rt(n,r,v)}}break;case 5:So(d,d.return);break;case 22:if(d.memoizedState!==null){Tv(h);continue}}m!==null?(m.return=d,Ce=m):Tv(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Zw("display",i))}catch(v){Rt(t,t.return,v)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Rt(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ln(e,t),as(t),n&4&&wv(t);break;case 21:break;default:Ln(e,t),as(t)}}function as(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(S2(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Sc(s,""),n.flags&=-33);var a=_v(t);bp(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=_v(t);Pp(t,o,i);break;default:throw Error(le(161))}}catch(l){Rt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tN(t,e,r){Ce=t,C2(t)}function C2(t,e,r){for(var n=(t.mode&1)!==0;Ce!==null;){var s=Ce,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Zu;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Ir;o=Zu;var c=Ir;if(Zu=i,(Ir=l)&&!c)for(Ce=s;Ce!==null;)i=Ce,l=i.child,i.tag===22&&i.memoizedState!==null?Av(s):l!==null?(l.return=i,Ce=l):Av(s);for(;a!==null;)Ce=a,C2(a),a=a.sibling;Ce=s,Zu=o,Ir=c}Ev(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ce=a):Ev(t)}}function Ev(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ir||s0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ir)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:jn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&iv(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}iv(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Nc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Ir||e.flags&512&&Rp(e)}catch(d){Rt(e,e.return,d)}}if(e===t){Ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function Tv(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function Av(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{s0(4,e)}catch(l){Rt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Rt(e,s,l)}}var a=e.return;try{Rp(e)}catch(l){Rt(e,a,l)}break;case 5:var i=e.return;try{Rp(e)}catch(l){Rt(e,i,l)}}}catch(l){Rt(e,e.return,l)}if(e===t){Ce=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ce=o;break}Ce=e.return}}var rN=Math.ceil,ch=Zs.ReactCurrentDispatcher,lg=Zs.ReactCurrentOwner,kn=Zs.ReactCurrentBatchConfig,Je=0,nr=null,Ht=null,dr=0,an=0,ko=Qa(0),Yt=0,Bc=null,Ii=0,a0=0,cg=0,sc=null,Yr=null,ug=0,Xo=1/0,bs=null,uh=!1,Dp=null,Ra=null,ef=!1,wa=null,fh=0,ac=0,Fp=null,Nf=-1,Rf=0;function zr(){return Je&6?Ot():Nf!==-1?Nf:Nf=Ot()}function Pa(t){return t.mode&1?Je&2&&dr!==0?dr&-dr:j4.transition!==null?(Rf===0&&(Rf=hE()),Rf):(t=at,t!==0||(t=window.event,t=t===void 0?16:yE(t.type)),t):1}function Xn(t,e,r,n){if(50<ac)throw ac=0,Fp=null,Error(le(185));iu(t,r,n),(!(Je&2)||t!==nr)&&(t===nr&&(!(Je&2)&&(a0|=r),Yt===4&&pa(t,dr)),tn(t,n),r===1&&Je===0&&!(e.mode&1)&&(Xo=Ot()+500,t0&&Ja()))}function tn(t,e){var r=t.callbackNode;jC(t,e);var n=Kf(t,t===nr?dr:0);if(n===0)r!==null&&Dx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Dx(r),e===1)t.tag===0?V4(Sv.bind(null,t)):VE(Sv.bind(null,t)),F4(function(){!(Je&6)&&Ja()}),r=null;else{switch(dE(n)){case 1:r=Lm;break;case 4:r=uE;break;case 16:r=qf;break;case 536870912:r=fE;break;default:r=qf}r=L2(r,N2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function N2(t,e){if(Nf=-1,Rf=0,Je&6)throw Error(le(327));var r=t.callbackNode;if(Fo()&&t.callbackNode!==r)return null;var n=Kf(t,t===nr?dr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=hh(t,n);else{e=n;var s=Je;Je|=2;var a=P2();(nr!==t||dr!==e)&&(bs=null,Xo=Ot()+500,yi(t,e));do try{aN();break}catch(o){R2(t,o)}while(!0);Xm(),ch.current=a,Je=s,Ht!==null?e=0:(nr=null,dr=0,e=Yt)}if(e!==0){if(e===2&&(s=op(t),s!==0&&(n=s,e=Op(t,s))),e===1)throw r=Bc,yi(t,0),pa(t,n),tn(t,Ot()),r;if(e===6)pa(t,n);else{if(s=t.current.alternate,!(n&30)&&!nN(s)&&(e=hh(t,n),e===2&&(a=op(t),a!==0&&(n=a,e=Op(t,a))),e===1))throw r=Bc,yi(t,0),pa(t,n),tn(t,Ot()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(le(345));case 2:ui(t,Yr,bs);break;case 3:if(pa(t,n),(n&130023424)===n&&(e=ug+500-Ot(),10<e)){if(Kf(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){zr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=mp(ui.bind(null,t,Yr,bs),e);break}ui(t,Yr,bs);break;case 4:if(pa(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-Kn(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=Ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*rN(n/1960))-n,10<n){t.timeoutHandle=mp(ui.bind(null,t,Yr,bs),n);break}ui(t,Yr,bs);break;case 5:ui(t,Yr,bs);break;default:throw Error(le(329))}}}return tn(t,Ot()),t.callbackNode===r?N2.bind(null,t):null}function Op(t,e){var r=sc;return t.current.memoizedState.isDehydrated&&(yi(t,e).flags|=256),t=hh(t,e),t!==2&&(e=Yr,Yr=r,e!==null&&Lp(e)),t}function Lp(t){Yr===null?Yr=t:Yr.push.apply(Yr,t)}function nN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Qn(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pa(t,e){for(e&=~cg,e&=~a0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Kn(e),n=1<<r;t[r]=-1,e&=~n}}function Sv(t){if(Je&6)throw Error(le(327));Fo();var e=Kf(t,0);if(!(e&1))return tn(t,Ot()),null;var r=hh(t,e);if(t.tag!==0&&r===2){var n=op(t);n!==0&&(e=n,r=Op(t,n))}if(r===1)throw r=Bc,yi(t,0),pa(t,e),tn(t,Ot()),r;if(r===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ui(t,Yr,bs),tn(t,Ot()),null}function fg(t,e){var r=Je;Je|=1;try{return t(e)}finally{Je=r,Je===0&&(Xo=Ot()+500,t0&&Ja())}}function Ci(t){wa!==null&&wa.tag===0&&!(Je&6)&&Fo();var e=Je;Je|=1;var r=kn.transition,n=at;try{if(kn.transition=null,at=1,t)return t()}finally{at=n,kn.transition=r,Je=e,!(Je&6)&&Ja()}}function hg(){an=ko.current,gt(ko)}function yi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,D4(r)),Ht!==null)for(r=Ht.return;r!==null;){var n=r;switch(Gm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Zf();break;case 3:qo(),gt(Zr),gt(br),tg();break;case 5:eg(n);break;case 4:qo();break;case 13:gt(Et);break;case 19:gt(Et);break;case 10:Ym(n.type._context);break;case 22:case 23:hg()}r=r.return}if(nr=t,Ht=t=ba(t.current,null),dr=an=e,Yt=0,Bc=null,cg=a0=Ii=0,Yr=sc=null,pi!==null){for(e=0;e<pi.length;e++)if(r=pi[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}pi=null}return t}function R2(t,e){do{var r=Ht;try{if(Xm(),kf.current=lh,oh){for(var n=Tt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}oh=!1}if(ki=0,rr=Xt=Tt=null,rc=!1,Mc=0,lg.current=null,r===null||r.return===null){Yt=1,Bc=e,Ht=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=dr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=hv(i);if(m!==null){m.flags&=-257,dv(m,i,o,a,e),m.mode&1&&fv(a,c,e),e=m,l=c;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){fv(a,c,e),dg();break e}l=Error(le(426))}}else if(wt&&o.mode&1){var w=hv(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),dv(w,i,o,a,e),qm(Ko(l,o));break e}}a=l=Ko(l,o),Yt!==4&&(Yt=2),sc===null?sc=[a]:sc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var T=d2(a,l,e);av(a,T);break e;case 1:o=l;var _=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ra===null||!Ra.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var O=p2(a,o,e);av(a,O);break e}}a=a.return}while(a!==null)}D2(r)}catch(z){e=z,Ht===r&&r!==null&&(Ht=r=r.return);continue}break}while(!0)}function P2(){var t=ch.current;return ch.current=lh,t===null?lh:t}function dg(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),nr===null||!(Ii&268435455)&&!(a0&268435455)||pa(nr,dr)}function hh(t,e){var r=Je;Je|=2;var n=P2();(nr!==t||dr!==e)&&(bs=null,yi(t,e));do try{sN();break}catch(s){R2(t,s)}while(!0);if(Xm(),Je=r,ch.current=n,Ht!==null)throw Error(le(261));return nr=null,dr=0,Yt}function sN(){for(;Ht!==null;)b2(Ht)}function aN(){for(;Ht!==null&&!RC();)b2(Ht)}function b2(t){var e=O2(t.alternate,t,an);t.memoizedProps=t.pendingProps,e===null?D2(t):Ht=e,lg.current=null}function D2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=J4(r,e),r!==null){r.flags&=32767,Ht=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yt=6,Ht=null;return}}else if(r=Q4(r,e,an),r!==null){Ht=r;return}if(e=e.sibling,e!==null){Ht=e;return}Ht=e=t}while(e!==null);Yt===0&&(Yt=5)}function ui(t,e,r){var n=at,s=kn.transition;try{kn.transition=null,at=1,iN(t,e,r,n)}finally{kn.transition=s,at=n}return null}function iN(t,e,r,n){do Fo();while(wa!==null);if(Je&6)throw Error(le(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(BC(t,a),t===nr&&(Ht=nr=null,dr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ef||(ef=!0,L2(qf,function(){return Fo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=kn.transition,kn.transition=null;var i=at;at=1;var o=Je;Je|=4,lg.current=null,eN(t,r),I2(r,t),k4(dp),Xf=!!hp,dp=hp=null,t.current=r,tN(r),PC(),Je=o,at=i,kn.transition=a}else t.current=r;if(ef&&(ef=!1,wa=t,fh=s),a=t.pendingLanes,a===0&&(Ra=null),FC(r.stateNode),tn(t,Ot()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(uh)throw uh=!1,t=Dp,Dp=null,t;return fh&1&&t.tag!==0&&Fo(),a=t.pendingLanes,a&1?t===Fp?ac++:(ac=0,Fp=t):ac=0,Ja(),null}function Fo(){if(wa!==null){var t=dE(fh),e=kn.transition,r=at;try{if(kn.transition=null,at=16>t?16:t,wa===null)var n=!1;else{if(t=wa,wa=null,fh=0,Je&6)throw Error(le(331));var s=Je;for(Je|=4,Ce=t.current;Ce!==null;){var a=Ce,i=a.child;if(Ce.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:nc(8,f,a)}var h=f.child;if(h!==null)h.return=f,Ce=h;else for(;Ce!==null;){f=Ce;var d=f.sibling,m=f.return;if(A2(f),f===c){Ce=null;break}if(d!==null){d.return=m,Ce=d;break}Ce=m}}}var g=a.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Ce=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ce=i;else e:for(;Ce!==null;){if(a=Ce,a.flags&2048)switch(a.tag){case 0:case 11:case 15:nc(9,a,a.return)}var T=a.sibling;if(T!==null){T.return=a.return,Ce=T;break e}Ce=a.return}}var _=t.current;for(Ce=_;Ce!==null;){i=Ce;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ce=y;else e:for(i=_;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:s0(9,o)}}catch(z){Rt(o,o.return,z)}if(o===i){Ce=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,Ce=O;break e}Ce=o.return}}if(Je=s,Ja(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(Yh,t)}catch{}n=!0}return n}finally{at=r,kn.transition=e}}return!1}function kv(t,e,r){e=Ko(r,e),e=d2(t,e,1),t=Na(t,e,1),e=zr(),t!==null&&(iu(t,1,e),tn(t,e))}function Rt(t,e,r){if(t.tag===3)kv(t,t,r);else for(;e!==null;){if(e.tag===3){kv(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ra===null||!Ra.has(n))){t=Ko(r,t),t=p2(e,t,1),e=Na(e,t,1),t=zr(),e!==null&&(iu(e,1,t),tn(e,t));break}}e=e.return}}function oN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=zr(),t.pingedLanes|=t.suspendedLanes&r,nr===t&&(dr&r)===r&&(Yt===4||Yt===3&&(dr&130023424)===dr&&500>Ot()-ug?yi(t,0):cg|=r),tn(t,e)}function F2(t,e){e===0&&(t.mode&1?(e=Hu,Hu<<=1,!(Hu&130023424)&&(Hu=4194304)):e=1);var r=zr();t=Gs(t,e),t!==null&&(iu(t,e,r),tn(t,r))}function lN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),F2(t,r)}function cN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(e),F2(t,r)}var O2;O2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zr.current)Jr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Jr=!1,Y4(t,e,r);Jr=!!(t.flags&131072)}else Jr=!1,wt&&e.flags&1048576&&jE(e,rh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Cf(t,e),t=e.pendingProps;var s=Ho(e,br.current);Do(e,r),s=ng(null,e,n,t,s,r);var a=sg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(n)?(a=!0,eh(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Jm(e),s.updater=n0,e.stateNode=s,s._reactInternals=e,Ep(e,n,t,r),e=Sp(null,e,n,!0,a,r)):(e.tag=0,wt&&a&&Wm(e),jr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Cf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=fN(n),t=jn(n,t),s){case 0:e=Ap(null,e,n,t,r);break e;case 1:e=gv(null,e,n,t,r);break e;case 11:e=pv(null,e,n,t,r);break e;case 14:e=mv(null,e,n,jn(n.type,t),r);break e}throw Error(le(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:jn(n,s),Ap(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:jn(n,s),gv(t,e,n,s,r);case 3:e:{if(v2(e),t===null)throw Error(le(387));n=e.pendingProps,a=e.memoizedState,s=a.element,WE(t,e),ah(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Ko(Error(le(423)),e),e=xv(t,e,n,r,s);break e}else if(n!==s){s=Ko(Error(le(424)),e),e=xv(t,e,n,r,s);break e}else for(cn=Ca(e.stateNode.containerInfo.firstChild),fn=e,wt=!0,zn=null,r=zE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Wo(),n===s){e=qs(t,e,r);break e}jr(t,e,n,r)}e=e.child}return e;case 5:return GE(e),t===null&&yp(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,pp(n,s)?i=null:a!==null&&pp(n,a)&&(e.flags|=32),x2(t,e),jr(t,e,i,r),e.child;case 6:return t===null&&yp(e),null;case 13:return y2(t,e,r);case 4:return Zm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Go(e,null,n,r):jr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:jn(n,s),pv(t,e,n,s,r);case 7:return jr(t,e,e.pendingProps,r),e.child;case 8:return jr(t,e,e.pendingProps.children,r),e.child;case 12:return jr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,ct(nh,n._currentValue),n._currentValue=i,a!==null)if(Qn(a.value,i)){if(a.children===s.children&&!Zr.current){e=qs(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=js(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),_p(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(le(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),_p(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}jr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Do(e,r),s=Nn(s),n=n(s),e.flags|=1,jr(t,e,n,r),e.child;case 14:return n=e.type,s=jn(n,e.pendingProps),s=jn(n.type,s),mv(t,e,n,s,r);case 15:return m2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:jn(n,s),Cf(t,e),e.tag=1,en(n)?(t=!0,eh(e)):t=!1,Do(e,r),h2(e,n,s),Ep(e,n,s,r),Sp(null,e,n,!0,t,r);case 19:return _2(t,e,r);case 22:return g2(t,e,r)}throw Error(le(156,e.tag))};function L2(t,e){return cE(t,e)}function uN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(t,e,r,n){return new uN(t,e,r,n)}function pg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fN(t){if(typeof t=="function")return pg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Dm)return 11;if(t===Fm)return 14}return 2}function ba(t,e){var r=t.alternate;return r===null?(r=Sn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Pf(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")pg(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case go:return _i(r.children,s,a,e);case bm:i=8,s|=8;break;case Gd:return t=Sn(12,r,e,s|2),t.elementType=Gd,t.lanes=a,t;case qd:return t=Sn(13,r,e,s),t.elementType=qd,t.lanes=a,t;case Kd:return t=Sn(19,r,e,s),t.elementType=Kd,t.lanes=a,t;case Gw:return i0(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hw:i=10;break e;case Ww:i=9;break e;case Dm:i=11;break e;case Fm:i=14;break e;case fa:i=16,n=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=Sn(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function _i(t,e,r,n){return t=Sn(7,t,n,e),t.lanes=r,t}function i0(t,e,r,n){return t=Sn(22,t,n,e),t.elementType=Gw,t.lanes=r,t.stateNode={isHidden:!1},t}function xd(t,e,r){return t=Sn(6,t,null,e),t.lanes=r,t}function vd(t,e,r){return e=Sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hN(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=J0(0),this.expirationTimes=J0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=J0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mg(t,e,r,n,s,a,i,o,l){return t=new hN(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Sn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jm(a),t}function dN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function M2(t){if(!t)return Ba;t=t._reactInternals;e:{if(ji(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var r=t.type;if(en(r))return ME(t,r,e)}return e}function V2(t,e,r,n,s,a,i,o,l){return t=mg(r,n,!0,t,s,a,i,o,l),t.context=M2(null),r=t.current,n=zr(),s=Pa(r),a=js(n,s),a.callback=e??null,Na(r,a,s),t.current.lanes=s,iu(t,s,n),tn(t,n),t}function o0(t,e,r,n){var s=e.current,a=zr(),i=Pa(s);return r=M2(r),e.context===null?e.context=r:e.pendingContext=r,e=js(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Na(s,e,i),t!==null&&(Xn(t,s,i,a),Sf(t,s,i)),i}function dh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Iv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function gg(t,e){Iv(t,e),(t=t.alternate)&&Iv(t,e)}function pN(){return null}var j2=typeof reportError=="function"?reportError:function(t){console.error(t)};function xg(t){this._internalRoot=t}l0.prototype.render=xg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));o0(t,e,null,null)};l0.prototype.unmount=xg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ci(function(){o0(null,t,null,null)}),e[Ws]=null}};function l0(t){this._internalRoot=t}l0.prototype.unstable_scheduleHydration=function(t){if(t){var e=gE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<da.length&&e!==0&&e<da[r].priority;r++);da.splice(r,0,t),r===0&&vE(t)}};function vg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function c0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Cv(){}function mN(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=dh(i);a.call(c)}}var i=V2(e,n,t,0,null,!1,!1,"",Cv);return t._reactRootContainer=i,t[Ws]=i.current,bc(t.nodeType===8?t.parentNode:t),Ci(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=dh(l);o.call(c)}}var l=mg(t,0,!1,null,null,!1,!1,"",Cv);return t._reactRootContainer=l,t[Ws]=l.current,bc(t.nodeType===8?t.parentNode:t),Ci(function(){o0(e,l,r,n)}),l}function u0(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=dh(i);o.call(l)}}o0(e,i,t,s)}else i=mN(r,e,t,s,n);return dh(i)}pE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ml(e.pendingLanes);r!==0&&(Mm(e,r|1),tn(e,Ot()),!(Je&6)&&(Xo=Ot()+500,Ja()))}break;case 13:Ci(function(){var n=Gs(t,1);if(n!==null){var s=zr();Xn(n,t,1,s)}}),gg(t,1)}};Vm=function(t){if(t.tag===13){var e=Gs(t,134217728);if(e!==null){var r=zr();Xn(e,t,134217728,r)}gg(t,134217728)}};mE=function(t){if(t.tag===13){var e=Pa(t),r=Gs(t,e);if(r!==null){var n=zr();Xn(r,t,e,n)}gg(t,e)}};gE=function(){return at};xE=function(t,e){var r=at;try{return at=t,e()}finally{at=r}};sp=function(t,e,r){switch(e){case"input":if(Qd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=e0(n);if(!s)throw Error(le(90));Kw(n),Qd(n,s)}}}break;case"textarea":Yw(t,r);break;case"select":e=r.value,e!=null&&No(t,!!r.multiple,e,!1)}};nE=fg;sE=Ci;var gN={usingClientEntryPoint:!1,Events:[lu,_o,e0,tE,rE,fg]},Fl={findFiberByHostInstance:di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xN={bundleType:Fl.bundleType,version:Fl.version,rendererPackageName:Fl.rendererPackageName,rendererConfig:Fl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=oE(t),t===null?null:t.stateNode},findFiberByHostInstance:Fl.findFiberByHostInstance||pN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tf.isDisabled&&tf.supportsFiber)try{Yh=tf.inject(xN),ps=tf}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gN;mn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vg(e))throw Error(le(200));return dN(t,e,null,r)};mn.createRoot=function(t,e){if(!vg(t))throw Error(le(299));var r=!1,n="",s=j2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mg(t,1,!1,null,null,r,!1,n,s),t[Ws]=e.current,bc(t.nodeType===8?t.parentNode:t),new xg(e)};mn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=oE(e),t=t===null?null:t.stateNode,t};mn.flushSync=function(t){return Ci(t)};mn.hydrate=function(t,e,r){if(!c0(e))throw Error(le(200));return u0(null,t,e,!0,r)};mn.hydrateRoot=function(t,e,r){if(!vg(t))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=j2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=V2(e,null,t,1,r??null,s,!1,a,i),t[Ws]=e.current,bc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new l0(e)};mn.render=function(t,e,r){if(!c0(e))throw Error(le(200));return u0(null,t,e,!1,r)};mn.unmountComponentAtNode=function(t){if(!c0(t))throw Error(le(40));return t._reactRootContainer?(Ci(function(){u0(null,null,t,!1,function(){t._reactRootContainer=null,t[Ws]=null})}),!0):!1};mn.unstable_batchedUpdates=fg;mn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!c0(r))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return u0(t,e,r,!1,n)};mn.version="18.3.1-next-f1338f8080-20240426";function B2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B2)}catch(t){console.error(t)}}B2(),Bw.exports=mn;var vN=Bw.exports,Nv=vN;Hd.createRoot=Nv.createRoot,Hd.hydrateRoot=Nv.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_N=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),Rv=t=>{const e=_N(t);return e.charAt(0).toUpperCase()+e.slice(1)},U2=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),wN=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=ze.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>ze.createElement("svg",{ref:l,...EN,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:U2("lucide",s),...!a&&!wN(o)&&{"aria-hidden":"true"},...o},[...i.map(([c,f])=>ze.createElement(c,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=(t,e)=>{const r=ze.forwardRef(({className:n,...s},a)=>ze.createElement(TN,{ref:a,iconNode:e,className:U2(`lucide-${yN(Rv(t))}`,`lucide-${t}`,n),...s}));return r.displayName=Rv(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],SN=kt("calendar",AN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jl=kt("chart-column",kN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Mp=kt("circle-alert",IN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],NN=kt("circle-check-big",CN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],lo=kt("clock",RN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],bN=kt("eye-off",PN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],FN=kt("eye",DN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ic=kt("file-spreadsheet",ON);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],MN=kt("funnel",LN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Pv=kt("lock",VN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],BN=kt("log-out",jN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],$N=kt("mail",UN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Bn=kt("phone",zN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],WN=kt("save",HN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],rf=kt("search",GN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],bv=kt("trash-2",qN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],XN=kt("trending-down",KN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Vp=kt("trending-up",YN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Dv=kt("upload",QN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Fv=kt("user-plus",JN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ph=kt("user",ZN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Un=kt("users",eR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ov=kt("x",tR);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $2=1252,rR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],yg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_g=function(t){rR.indexOf(t)!=-1&&($2=yg[0]=t)};function nR(){_g(1252)}var Wn=function(t){_g(t)};function z2(){Wn(1200),nR()}function Lv(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function sR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function H2(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Bl=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?sR(t.slice(2)):e==254&&r==255?H2(t.slice(2)):e==65279?t.slice(1):t},nf=function(e){return String.fromCharCode(e)},Mv=function(e){return String.fromCharCode(e)},Uc,Ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vv(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),a=r>>2,n=t.charCodeAt(c++),i=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ea.charAt(a)+Ea.charAt(i)+Ea.charAt(o)+Ea.charAt(l);return e}function pn(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ea.indexOf(t.charAt(c++)),i=Ea.indexOf(t.charAt(c++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Ea.indexOf(t.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ea.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Bi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ua(t){return Ke?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function jv(t){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Hn=function(e){return Ke?Bi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ui(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function wg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return wg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ma=Ke?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Bi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function aR(t){for(var e=[],r=0,n=t.length+250,s=Ua(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Ua(65535),n=65530)}return e.push(s.slice(0,r)),ma(e)}var Hr=/\u0000/g,Ul=/[\u0001-\u0006]/g;function Oo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Gn(t,e){var r=""+t;return r.length>=e?r:Pt("0",e-r.length)+r}function Eg(t,e){var r=""+t;return r.length>=e?r:Pt(" ",e-r.length)+r}function mh(t,e){var r=""+t;return r.length>=e?r:r+Pt(" ",e-r.length)}function iR(t,e){var r=""+Math.round(t);return r.length>=e?r:Pt("0",e-r.length)+r}function oR(t,e){var r=""+t;return r.length>=e?r:Pt("0",e-r.length)+r}var Bv=Math.pow(2,32);function oo(t,e){if(t>Bv||t<-Bv)return iR(t,e);var r=Math.round(t);return oR(r,e)}function gh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Uv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],yd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ue={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$v={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xh(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,c=0,f=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*i+a,f=h*c+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=a):(f=c,o=i)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function gi(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=mR(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var W2=new Date(1899,11,31,0,0,0),uR=W2.getTime(),fR=new Date(1900,2,1,0,0,0);function G2(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=fR&&(r+=24*60*60*1e3),(r-(uR+(t.getTimezoneOffset()-W2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Tg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dR(t){var e=t<0?12:11,r=Tg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function pR(t){var e=Tg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function $c(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=dR(t):e===10?r=t.toFixed(10).substr(0,12):r=pR(t),Tg(hR(r.toUpperCase()))}function Ni(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):$c(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Pn(14,G2(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function mR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function gR(t,e,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return yd[r.m-1][1];case 5:return yd[r.m-1][0];default:return yd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Uv[r.q][0];default:return Uv[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Gn(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Gn(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Gn(l,c):"";return f}function Ta(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var q2=/%/g;function xR(t,e,r){var n=e.replace(q2,""),s=e.length-n.length;return Bs(t,n,r*Math.pow(10,2*s))+Pt("%",s)}function vR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Bs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function K2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+K2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var X2=/# (\?+)( ?)\/( ?)(\d+)/;function yR(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Pt(" ",t[1].length+1+t[4].length):Eg(i,t[1].length)+t[2]+"/"+t[3]+Gn(o,t[4].length))}function _R(t,e,r){return r+(e===0?"":""+e)+Pt(" ",t[1].length+2+t[4].length)}var Y2=/^#*0*\.([0#]+)/,Q2=/\).*[0#]/,J2=/\(###\) ###\\?-####/;function Br(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function zv(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Hv(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function wR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ER(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function yn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yn("n",n,r):"("+yn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return vR(t,e,r);if(e.indexOf("%")!==-1)return xR(t,e,r);if(e.indexOf("E")!==-1)return K2(e,r);if(e.charCodeAt(0)===36)return"$"+yn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+oo(l,e.length);if(e.match(/^[#?]+$/))return s=oo(r,0),s==="0"&&(s=""),s.length>e.length?s:Br(e.substr(0,e.length-s.length))+s;if(a=e.match(X2))return yR(a,l,c);if(e.match(/^#+0+$/))return c+oo(l,e.length-e.indexOf("0"));if(a=e.match(Y2))return s=zv(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Br(a[1])).replace(/\.$/,"."+Br(a[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+Pt("0",Br(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+zv(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+Ta(oo(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yn(t,e,-r):Ta(""+(Math.floor(r)+wR(r,a[1].length)))+"."+Gn(Hv(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return yn(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Oo(yn(t,e.replace(/[\\-]/g,""),r)),i=0,Oo(Oo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(e.match(J2))return s=yn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=xh(l,Math.pow(10,i)-1,!1),s=""+c,f=Bs("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=mh(o[2],i),f.length<a[4].length&&(f=Br(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=xh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+mh(o[2],i):Pt(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=oo(r,0),e.length<=s.length?s:Br(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,d=e.length-s.length-h;return Br(e.substr(0,h)+s+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=Hv(r,a[1].length),r<0?"-"+yn(t,e,-r):Ta(ER(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gn(0,3-g.length):"")+g})+"."+Gn(i,a[1].length);switch(e){case"###,##0.00":return yn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ta(oo(l,0));return m!=="0"?c+m:"";case"###,###.00":return yn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return yn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function TR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Bs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function AR(t,e,r){var n=e.replace(q2,""),s=e.length-n.length;return Bs(t,n,r*Math.pow(10,2*s))+Pt("%",s)}function Z2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Z2(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function os(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q2)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?os("n",n,r):"("+os("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return TR(t,e,r);if(e.indexOf("%")!==-1)return AR(t,e,r);if(e.indexOf("E")!==-1)return Z2(e,r);if(e.charCodeAt(0)===36)return"$"+os(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Gn(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Br(e.substr(0,e.length-s.length))+s;if(a=e.match(X2))return _R(a,l,c);if(e.match(/^#+0+$/))return c+Gn(l,e.length-e.indexOf("0"));if(a=e.match(Y2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Br(a[1])).replace(/\.$/,"."+Br(a[1])),s=s.replace(/\.(\d*)$/,function(g,v){return"."+v+Pt("0",Br(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+Ta(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+os(t,e,-r):Ta(""+r)+"."+Pt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return os(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Oo(os(t,e.replace(/[\\-]/g,""),r)),i=0,Oo(Oo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(e.match(J2))return s=os(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=xh(l,Math.pow(10,i)-1,!1),s=""+c,f=Bs("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=mh(o[2],i),f.length<a[4].length&&(f=Br(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=xh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+mh(o[2],i):Pt(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Br(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,d=e.length-s.length-h;return Br(e.substr(0,h)+s+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+os(t,e,-r):Ta(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gn(0,3-g.length):"")+g})+"."+Gn(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Ta(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return os(t,e.slice(0,e.lastIndexOf(".")),r)+Br(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Bs(t,e,r){return(r|0)===r?os(t,e,r):yn(t,e,r)}function SR(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var eT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ll(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":gh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(eT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function kR(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",c,f,h,d="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!gh(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var m=t.charAt(++i),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(c==null&&(c=gi(e,r,t.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=gi(e,r),c==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=gi(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",d="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",i+=5,d="h"):t.substr(i,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",i+=5,d="h"):(v.t="t",++i),c==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(eT)){if(c==null&&(c=gi(e,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ll(t)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var w=0,T=0,_;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=d,l="h",w<1&&(w=1);break;case"s":(_=s[i].v.match(/\.0+$/))&&(T=Math.max(T,_[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",O;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=gR(s[i].t.charCodeAt(0),s[i].v,c,T),s[i].t="t";break;case"n":case"?":for(O=i+1;s[O]!=null&&((o=s[O].t)==="?"||o==="D"||(o===" "||o==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[i].v+=s[O].v,s[O]={v:"",t:";"},++O;y+=s[i].v,i=O-1;break;case"G":s[i].t="t",s[i].v=Ni(e,r);break}var z="",B,E;if(y.length>0){y.charCodeAt(0)==40?(B=e<0&&y.charCodeAt(0)===45?-e:e,E=Bs("n",y,B)):(B=e<0&&n>1?-e:e,E=Bs("n",y,B),B<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),O=E.length-1;var S=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){S=i;break}var k=s.length;if(S===s.length&&E.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(O>=s[i].v.length-1?(O-=s[i].v.length,s[i].v=E.substr(O+1,s[i].v.length)):O<0?s[i].v="":(s[i].v=E.substr(0,O+1),O=-1),s[i].t="t",k=i);O>=0&&k<s.length&&(s[k].v=E.substr(0,O+1)+s[k].v)}else if(S!==s.length&&E.indexOf("E")===-1){for(O=E.indexOf(".")-1,i=S;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")-1:s[i].v.length-1,z=s[i].v.substr(f+1);f>=0;--f)O>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(z=E.charAt(O--)+z);s[i].v=z,s[i].t="t",k=i}for(O>=0&&k<s.length&&(s[k].v=E.substr(0,O+1)+s[k].v),O=E.indexOf(".")+1,i=S;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==S)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")+1:0,z=s[i].v.substr(0,f);f<s[i].v.length;++f)O<E.length&&(z+=E.charAt(O++));s[i].v=z,s[i].t="t",k=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(B=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Bs(s[i].t,s[i].v,B),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var Wv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gv(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function IR(t,e){var r=SR(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Wv),o=r[1].match(Wv);return Gv(e,i)?[n,r[0]]:Gv(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Pn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ue)[t],n==null&&(n=r.table&&r.table[$v[t]]||Ue[$v[t]]),n==null&&(n=cR[t]||"General");break}if(gh(n,0))return Ni(e,r);e instanceof Date&&(e=G2(e,r.date1904));var s=IR(n,e);if(gh(s[1]))return Ni(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return kR(s[1],e,r,s[0])}function wi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ue[r]==null){e<0&&(e=r);continue}if(Ue[r]==t){e=r;break}}e<0&&(e=391)}return Ue[e]=t,e}function tT(){Ue=lR()}var CR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NR(t){var e=typeof t=="number"?Ue[t]:t;return e=e.replace(rT,"(\\d+)"),new RegExp("^"+e+"$")}function RR(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(rT)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?f:c+"T"+f}var PR=function(){var t={};t.version="1.2.0";function e(){for(var E=0,S=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[k]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(E){var S=0,k=0,R=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)b[R]=E[R];for(R=0;R!=256;++R)for(k=E[R],S=256+R;S<4096;S+=256)k=b[S]=k>>>8^E[k&255];var D=[];for(R=1;R!=16;++R)D[R-1]=typeof Int32Array<"u"?b.subarray(R*256,R*256+256):b.slice(R*256,R*256+256);return D}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],f=s[5],h=s[6],d=s[7],m=s[8],g=s[9],v=s[10],w=s[11],T=s[12],_=s[13],y=s[14];function O(E,S){for(var k=S^-1,R=0,b=E.length;R<b;)k=k>>>8^r[(k^E.charCodeAt(R++))&255];return~k}function z(E,S){for(var k=S^-1,R=E.length-15,b=0;b<R;)k=y[E[b++]^k&255]^_[E[b++]^k>>8&255]^T[E[b++]^k>>16&255]^w[E[b++]^k>>>24]^v[E[b++]]^g[E[b++]]^m[E[b++]]^d[E[b++]]^h[E[b++]]^f[E[b++]]^c[E[b++]]^l[E[b++]]^o[E[b++]]^i[E[b++]]^a[E[b++]]^r[E[b++]];for(R+=15;b<R;)k=k>>>8^r[(k^E[b++])&255];return~k}function B(E,S){for(var k=S^-1,R=0,b=E.length,D=0,F=0;R<b;)D=E.charCodeAt(R++),D<128?k=k>>>8^r[(k^D)&255]:D<2048?(k=k>>>8^r[(k^(192|D>>6&31))&255],k=k>>>8^r[(k^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,F=E.charCodeAt(R++)&1023,k=k>>>8^r[(k^(240|D>>8&7))&255],k=k>>>8^r[(k^(128|D>>2&63))&255],k=k>>>8^r[(k^(128|F>>6&15|(D&3)<<4))&255],k=k>>>8^r[(k^(128|F&63))&255]):(k=k>>>8^r[(k^(224|D>>12&15))&255],k=k>>>8^r[(k^(128|D>>6&63))&255],k=k>>>8^r[(k^(128|D&63))&255]);return~k}return t.table=r,t.bstr=O,t.buf=z,t.str=B,t}(),Ye=function(){var e={};e.version="1.2.1";function r(I,N){for(var C=I.split("/"),P=N.split("/"),V=0,M=0,K=Math.min(C.length,P.length);V<K;++V){if(M=C[V].length-P[V].length)return M;if(C[V]!=P[V])return C[V]<P[V]?-1:1}return C.length-P.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var N=I.lastIndexOf("/");return N===-1?I:I.slice(0,N+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var N=I.lastIndexOf("/");return N===-1?I:I.slice(N+1)}function a(I,N){typeof N=="string"&&(N=new Date(N));var C=N.getHours();C=C<<6|N.getMinutes(),C=C<<5|N.getSeconds()>>>1,I.write_shift(2,C);var P=N.getFullYear()-1980;P=P<<4|N.getMonth()+1,P=P<<5|N.getDate(),I.write_shift(2,P)}function i(I){var N=I.read_shift(2)&65535,C=I.read_shift(2)&65535,P=new Date,V=C&31;C>>>=5;var M=C&15;C>>>=4,P.setMilliseconds(0),P.setFullYear(C+1980),P.setMonth(M-1),P.setDate(V);var K=N&31;N>>>=5;var Y=N&63;return N>>>=6,P.setHours(N),P.setMinutes(Y),P.setSeconds(K<<1),P}function o(I){fr(I,0);for(var N={},C=0;I.l<=I.length-4;){var P=I.read_shift(2),V=I.read_shift(2),M=I.l+V,K={};switch(P){case 21589:C=I.read_shift(1),C&1&&(K.mtime=I.read_shift(4)),V>5&&(C&2&&(K.atime=I.read_shift(4)),C&4&&(K.ctime=I.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}I.l=M,N[P]=K}return N}var l;function c(){return l||(l={})}function f(I,N){if(I[0]==80&&I[1]==75)return si(I,N);if((I[0]|32)==109&&(I[1]|32)==105)return eo(I,N);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var C=3,P=512,V=0,M=0,K=0,Y=0,X=0,Q=[],Z=I.slice(0,512);fr(Z,0);var ae=h(Z);switch(C=ae[0],C){case 3:P=512;break;case 4:P=4096;break;case 0:if(ae[1]==0)return si(I,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}P!==512&&(Z=I.slice(0,P),fr(Z,28));var de=I.slice(0,P);d(Z,C);var ke=Z.read_shift(4,"i");if(C===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);Z.l+=4,K=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),Y=Z.read_shift(4,"i"),V=Z.read_shift(4,"i"),X=Z.read_shift(4,"i"),M=Z.read_shift(4,"i");for(var he=-1,we=0;we<109&&(he=Z.read_shift(4,"i"),!(he<0));++we)Q[we]=he;var Oe=m(I,P);w(X,M,Oe,P,Q);var it=_(Oe,K,Q,P);it[K].name="!Directory",V>0&&Y!==F&&(it[Y].name="!MiniFAT"),it[Q[0]].name="!FAT",it.fat_addrs=Q,it.ssz=P;var st={},yt=[],Ns=[],ii=[];y(K,it,Oe,yt,V,st,Ns,Y),g(Ns,ii,yt),yt.shift();var aa={FileIndex:Ns,FullPaths:ii};return N&&N.raw&&(aa.raw={header:de,sectors:Oe}),aa}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(_e,"Header Signature: "),I.l+=16;var N=I.read_shift(2,"u");return[I.read_shift(2,"u"),N]}function d(I,N){var C=9;switch(I.l+=2,C=I.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,N){for(var C=Math.ceil(I.length/N)-1,P=[],V=1;V<C;++V)P[V-1]=I.slice(V*N,(V+1)*N);return P[C-1]=I.slice(C*N),P}function g(I,N,C){for(var P=0,V=0,M=0,K=0,Y=0,X=C.length,Q=[],Z=[];P<X;++P)Q[P]=Z[P]=P,N[P]=C[P];for(;Y<Z.length;++Y)P=Z[Y],V=I[P].L,M=I[P].R,K=I[P].C,Q[P]===P&&(V!==-1&&Q[V]!==V&&(Q[P]=Q[V]),M!==-1&&Q[M]!==M&&(Q[P]=Q[M])),K!==-1&&(Q[K]=P),V!==-1&&P!=Q[P]&&(Q[V]=Q[P],Z.lastIndexOf(V)<Y&&Z.push(V)),M!==-1&&P!=Q[P]&&(Q[M]=Q[P],Z.lastIndexOf(M)<Y&&Z.push(M));for(P=1;P<X;++P)Q[P]===P&&(M!==-1&&Q[M]!==M?Q[P]=Q[M]:V!==-1&&Q[V]!==V&&(Q[P]=Q[V]));for(P=1;P<X;++P)if(I[P].type!==0){if(Y=P,Y!=Q[Y])do Y=Q[Y],N[P]=N[Y]+"/"+N[P];while(Y!==0&&Q[Y]!==-1&&Y!=Q[Y]);Q[P]=-1}for(N[0]+="/",P=1;P<X;++P)I[P].type!==2&&(N[P]+="/")}function v(I,N,C){for(var P=I.start,V=I.size,M=[],K=P;C&&V>0&&K>=0;)M.push(N.slice(K*D,K*D+D)),V-=D,K=hi(C,K*4);return M.length===0?Kt(0):ma(M).slice(0,I.size)}function w(I,N,C,P,V){var M=F;if(I===F){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var K=C[I],Y=(P>>>2)-1;if(!K)return;for(var X=0;X<Y&&(M=hi(K,X*4))!==F;++X)V.push(M);w(hi(K,P-4),N-1,C,P,V)}}function T(I,N,C,P,V){var M=[],K=[];V||(V=[]);var Y=P-1,X=0,Q=0;for(X=N;X>=0;){V[X]=!0,M[M.length]=X,K.push(I[X]);var Z=C[Math.floor(X*4/P)];if(Q=X*4&Y,P<4+Q)throw new Error("FAT boundary crossed: "+X+" 4 "+P);if(!I[Z])break;X=hi(I[Z],Q)}return{nodes:M,data:ry([K])}}function _(I,N,C,P){var V=I.length,M=[],K=[],Y=[],X=[],Q=P-1,Z=0,ae=0,de=0,ke=0;for(Z=0;Z<V;++Z)if(Y=[],de=Z+N,de>=V&&(de-=V),!K[de]){X=[];var he=[];for(ae=de;ae>=0;){he[ae]=!0,K[ae]=!0,Y[Y.length]=ae,X.push(I[ae]);var we=C[Math.floor(ae*4/P)];if(ke=ae*4&Q,P<4+ke)throw new Error("FAT boundary crossed: "+ae+" 4 "+P);if(!I[we]||(ae=hi(I[we],ke),he[ae]))break}M[de]={nodes:Y,data:ry([X])}}return M}function y(I,N,C,P,V,M,K,Y){for(var X=0,Q=P.length?2:0,Z=N[I].data,ae=0,de=0,ke;ae<Z.length;ae+=128){var he=Z.slice(ae,ae+128);fr(he,64),de=he.read_shift(2),ke=Cg(he,0,de-Q),P.push(ke);var we={name:ke,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Oe=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Oe!==0&&(we.ct=O(he,he.l-8));var it=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);it!==0&&(we.mt=O(he,he.l-8)),we.start=he.read_shift(4,"i"),we.size=he.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=F,we.name=""),we.type===5?(X=we.start,V>0&&X!==F&&(N[X].name="!StreamData")):we.size>=4096?(we.storage="fat",N[we.start]===void 0&&(N[we.start]=T(C,we.start,N.fat_addrs,N.ssz)),N[we.start].name=we.name,we.content=N[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:X!==F&&we.start!==F&&N[X]&&(we.content=v(we,N[X].data,(N[Y]||{}).data))),we.content&&fr(we.content,0),M[ke]=we,K.push(we)}}function O(I,N){return new Date((on(I,N+4)/1e7*Math.pow(2,32)+on(I,N)/1e7-11644473600)*1e3)}function z(I,N){return c(),f(l.readFileSync(I),N)}function B(I,N){var C=N&&N.type;switch(C||Ke&&Buffer.isBuffer(I)&&(C="buffer"),C||"base64"){case"file":return z(I,N);case"base64":return f(Hn(pn(I)),N);case"binary":return f(Hn(I),N)}return f(I,N)}function E(I,N){var C=N||{},P=C.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=P+"/",I.FileIndex[0]={name:P,type:5}),C.CLSID&&(I.FileIndex[0].clsid=C.CLSID),S(I)}function S(I){var N="Sh33tJ5";if(!Ye.find(I,"/"+N)){var C=Kt(4);C[0]=55,C[1]=C[3]=50,C[2]=54,I.FileIndex.push({name:N,type:2,content:C,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+N),k(I)}}function k(I,N){E(I);for(var C=!1,P=!1,V=I.FullPaths.length-1;V>=0;--V){var M=I.FileIndex[V];switch(M.type){case 0:P?C=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(M.R*M.L*M.C)&&(C=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!N)){var K=new Date(1987,1,19),Y=0,X=Object.create?Object.create(null):{},Q=[];for(V=0;V<I.FullPaths.length;++V)X[I.FullPaths[V]]=!0,I.FileIndex[V].type!==0&&Q.push([I.FullPaths[V],I.FileIndex[V]]);for(V=0;V<Q.length;++V){var Z=n(Q[V][0]);P=X[Z],P||(Q.push([Z,{name:s(Z).replace("/",""),type:1,clsid:Se,ct:K,mt:K,content:null}]),X[Z]=!0)}for(Q.sort(function(ke,he){return r(ke[0],he[0])}),I.FullPaths=[],I.FileIndex=[],V=0;V<Q.length;++V)I.FullPaths[V]=Q[V][0],I.FileIndex[V]=Q[V][1];for(V=0;V<Q.length;++V){var ae=I.FileIndex[V],de=I.FullPaths[V];if(ae.name=s(de).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Se,V===0)ae.C=Q.length>1?1:-1,ae.size=0,ae.type=5;else if(de.slice(-1)=="/"){for(Y=V+1;Y<Q.length&&n(I.FullPaths[Y])!=de;++Y);for(ae.C=Y>=Q.length?-1:Y,Y=V+1;Y<Q.length&&n(I.FullPaths[Y])!=n(de);++Y);ae.R=Y>=Q.length?-1:Y,ae.type=1}else n(I.FullPaths[V+1]||"")==n(de)&&(ae.R=V+1),ae.type=2}}}function R(I,N){var C=N||{};if(C.fileType=="mad")return qt(I,C);switch(k(I),C.fileType){case"zip":return Zi(I,C)}var P=function(ke){for(var he=0,we=0,Oe=0;Oe<ke.FileIndex.length;++Oe){var it=ke.FileIndex[Oe];if(it.content){var st=it.content.length;st>0&&(st<4096?he+=st+63>>6:we+=st+511>>9)}}for(var yt=ke.FullPaths.length+3>>2,Ns=he+7>>3,ii=he+127>>7,aa=Ns+we+yt+ii,ss=aa+127>>7,ro=ss<=109?0:Math.ceil((ss-109)/127);aa+ss+ro+127>>7>ss;)ro=++ss<=109?0:Math.ceil((ss-109)/127);var nn=[1,ro,ss,ii,yt,we,he,0];return ke.FileIndex[0].size=he<<6,nn[7]=(ke.FileIndex[0].start=nn[0]+nn[1]+nn[2]+nn[3]+nn[4]+nn[5])+(nn[6]+7>>3),nn}(I),V=Kt(P[7]<<9),M=0,K=0;{for(M=0;M<8;++M)V.write_shift(1,pe[M]);for(M=0;M<8;++M)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),M=0;M<3;++M)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,P[2]),V.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:F),V.write_shift(4,P[3]),V.write_shift(-4,P[1]?P[0]-1:F),V.write_shift(4,P[1]),M=0;M<109;++M)V.write_shift(-4,M<P[2]?P[1]+M:-1)}if(P[1])for(K=0;K<P[1];++K){for(;M<236+K*127;++M)V.write_shift(-4,M<P[2]?P[1]+M:-1);V.write_shift(-4,K===P[1]-1?F:K+1)}var Y=function(ke){for(K+=ke;M<K-1;++M)V.write_shift(-4,M+1);ke&&(++M,V.write_shift(-4,F))};for(K=M=0,K+=P[1];M<K;++M)V.write_shift(-4,ye.DIFSECT);for(K+=P[2];M<K;++M)V.write_shift(-4,ye.FATSECT);Y(P[3]),Y(P[4]);for(var X=0,Q=0,Z=I.FileIndex[0];X<I.FileIndex.length;++X)Z=I.FileIndex[X],Z.content&&(Q=Z.content.length,!(Q<4096)&&(Z.start=K,Y(Q+511>>9)));for(Y(P[6]+7>>3);V.l&511;)V.write_shift(-4,ye.ENDOFCHAIN);for(K=M=0,X=0;X<I.FileIndex.length;++X)Z=I.FileIndex[X],Z.content&&(Q=Z.content.length,!(!Q||Q>=4096)&&(Z.start=K,Y(Q+63>>6)));for(;V.l&511;)V.write_shift(-4,ye.ENDOFCHAIN);for(M=0;M<P[4]<<2;++M){var ae=I.FullPaths[M];if(!ae||ae.length===0){for(X=0;X<17;++X)V.write_shift(4,0);for(X=0;X<3;++X)V.write_shift(4,-1);for(X=0;X<12;++X)V.write_shift(4,0);continue}Z=I.FileIndex[M],M===0&&(Z.start=Z.size?Z.start-1:F);var de=M===0&&C.root||Z.name;if(Q=2*(de.length+1),V.write_shift(64,de,"utf16le"),V.write_shift(2,Q),V.write_shift(1,Z.type),V.write_shift(1,Z.color),V.write_shift(-4,Z.L),V.write_shift(-4,Z.R),V.write_shift(-4,Z.C),Z.clsid)V.write_shift(16,Z.clsid,"hex");else for(X=0;X<4;++X)V.write_shift(4,0);V.write_shift(4,Z.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,Z.start),V.write_shift(4,Z.size),V.write_shift(4,0)}for(M=1;M<I.FileIndex.length;++M)if(Z=I.FileIndex[M],Z.size>=4096)if(V.l=Z.start+1<<9,Ke&&Buffer.isBuffer(Z.content))Z.content.copy(V,V.l,0,Z.size),V.l+=Z.size+511&-512;else{for(X=0;X<Z.size;++X)V.write_shift(1,Z.content[X]);for(;X&511;++X)V.write_shift(1,0)}for(M=1;M<I.FileIndex.length;++M)if(Z=I.FileIndex[M],Z.size>0&&Z.size<4096)if(Ke&&Buffer.isBuffer(Z.content))Z.content.copy(V,V.l,0,Z.size),V.l+=Z.size+63&-64;else{for(X=0;X<Z.size;++X)V.write_shift(1,Z.content[X]);for(;X&63;++X)V.write_shift(1,0)}if(Ke)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function b(I,N){var C=I.FullPaths.map(function(X){return X.toUpperCase()}),P=C.map(function(X){var Q=X.split("/");return Q[Q.length-(X.slice(-1)=="/"?2:1)]}),V=!1;N.charCodeAt(0)===47?(V=!0,N=C[0].slice(0,-1)+N):V=N.indexOf("/")!==-1;var M=N.toUpperCase(),K=V===!0?C.indexOf(M):P.indexOf(M);if(K!==-1)return I.FileIndex[K];var Y=!M.match(Ul);for(M=M.replace(Hr,""),Y&&(M=M.replace(Ul,"!")),K=0;K<C.length;++K)if((Y?C[K].replace(Ul,"!"):C[K]).replace(Hr,"")==M||(Y?P[K].replace(Ul,"!"):P[K]).replace(Hr,"")==M)return I.FileIndex[K];return null}var D=64,F=-2,_e="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],Se="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(I,N,C){c();var P=R(I,C);l.writeFileSync(N,P)}function q(I){for(var N=new Array(I.length),C=0;C<I.length;++C)N[C]=String.fromCharCode(I[C]);return N.join("")}function ue(I,N){var C=R(I,N);switch(N&&N.type||"buffer"){case"file":return c(),l.writeFileSync(N.filename,C),C;case"binary":return typeof C=="string"?C:q(C);case"base64":return Vv(typeof C=="string"?C:q(C));case"buffer":if(Ke)return Buffer.isBuffer(C)?C:Bi(C);case"array":return typeof C=="string"?Hn(C):C}return C}var Te;function j(I){try{var N=I.InflateRaw,C=new N;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)Te=I;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function J(I,N){if(!Te)return na(I,N);var C=Te.InflateRaw,P=new C,V=P._processChunk(I.slice(I.l),P._finishFlushFlag);return I.l+=P.bytesRead,V}function G(I){return Te?Te.deflateRawSync(I):je(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(I){var N=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(N>>16|N>>8|N)&255}for(var ge=typeof Uint8Array<"u",oe=ge?new Uint8Array(256):[],be=0;be<256;++be)oe[be]=Ee(be);function U(I,N){var C=oe[I&255];return N<=8?C>>>8-N:(C=C<<8|oe[I>>8&255],N<=16?C>>>16-N:(C=C<<8|oe[I>>16&255],C>>>24-N))}function Fe(I,N){var C=N&7,P=N>>>3;return(I[P]|(C<=6?0:I[P+1]<<8))>>>C&3}function $e(I,N){var C=N&7,P=N>>>3;return(I[P]|(C<=5?0:I[P+1]<<8))>>>C&7}function et(I,N){var C=N&7,P=N>>>3;return(I[P]|(C<=4?0:I[P+1]<<8))>>>C&15}function Be(I,N){var C=N&7,P=N>>>3;return(I[P]|(C<=3?0:I[P+1]<<8))>>>C&31}function xe(I,N){var C=N&7,P=N>>>3;return(I[P]|(C<=1?0:I[P+1]<<8))>>>C&127}function ft(I,N,C){var P=N&7,V=N>>>3,M=(1<<C)-1,K=I[V]>>>P;return C<8-P||(K|=I[V+1]<<8-P,C<16-P)||(K|=I[V+2]<<16-P,C<24-P)||(K|=I[V+3]<<24-P),K&M}function Vt(I,N,C){var P=N&7,V=N>>>3;return P<=5?I[V]|=(C&7)<<P:(I[V]|=C<<P&255,I[V+1]=(C&7)>>8-P),N+3}function ar(I,N,C){var P=N&7,V=N>>>3;return C=(C&1)<<P,I[V]|=C,N+1}function ir(I,N,C){var P=N&7,V=N>>>3;return C<<=P,I[V]|=C&255,C>>>=8,I[V+1]=C,N+8}function Dn(I,N,C){var P=N&7,V=N>>>3;return C<<=P,I[V]|=C&255,C>>>=8,I[V+1]=C&255,I[V+2]=C>>>8,N+16}function or(I,N){var C=I.length,P=2*C>N?2*C:N+5,V=0;if(C>=N)return I;if(Ke){var M=jv(P);if(I.copy)I.copy(M);else for(;V<I.length;++V)M[V]=I[V];return M}else if(ge){var K=new Uint8Array(P);if(K.set)K.set(I);else for(;V<C;++V)K[V]=I[V];return K}return I.length=P,I}function It(I){for(var N=new Array(I),C=0;C<I;++C)N[C]=0;return N}function Lr(I,N,C){var P=1,V=0,M=0,K=0,Y=0,X=I.length,Q=ge?new Uint16Array(32):It(32);for(M=0;M<32;++M)Q[M]=0;for(M=X;M<C;++M)I[M]=0;X=I.length;var Z=ge?new Uint16Array(X):It(X);for(M=0;M<X;++M)Q[V=I[M]]++,P<V&&(P=V),Z[M]=0;for(Q[0]=0,M=1;M<=P;++M)Q[M+16]=Y=Y+Q[M-1]<<1;for(M=0;M<X;++M)Y=I[M],Y!=0&&(Z[M]=Q[Y+16]++);var ae=0;for(M=0;M<X;++M)if(ae=I[M],ae!=0)for(Y=U(Z[M],P)>>P-ae,K=(1<<P+4-ae)-1;K>=0;--K)N[Y|K<<ae]=ae&15|M<<4;return P}var nt=ge?new Uint16Array(512):It(512),xt=ge?new Uint16Array(32):It(32);if(!ge){for(var Ct=0;Ct<512;++Ct)nt[Ct]=0;for(Ct=0;Ct<32;++Ct)xt[Ct]=0}(function(){for(var I=[],N=0;N<32;N++)I.push(5);Lr(I,xt,32);var C=[];for(N=0;N<=143;N++)C.push(8);for(;N<=255;N++)C.push(9);for(;N<=279;N++)C.push(7);for(;N<=287;N++)C.push(8);Lr(C,nt,288)})();var Mr=function(){for(var N=ge?new Uint8Array(32768):[],C=0,P=0;C<fe.length-1;++C)for(;P<fe[C+1];++P)N[P]=C;for(;P<32768;++P)N[P]=29;var V=ge?new Uint8Array(259):[];for(C=0,P=0;C<re.length-1;++C)for(;P<re[C+1];++P)V[P]=C;function M(Y,X){for(var Q=0;Q<Y.length;){var Z=Math.min(65535,Y.length-Q),ae=Q+Z==Y.length;for(X.write_shift(1,+ae),X.write_shift(2,Z),X.write_shift(2,~Z&65535);Z-- >0;)X[X.l++]=Y[Q++]}return X.l}function K(Y,X){for(var Q=0,Z=0,ae=ge?new Uint16Array(32768):[];Z<Y.length;){var de=Math.min(65535,Y.length-Z);if(de<10){for(Q=Vt(X,Q,+(Z+de==Y.length)),Q&7&&(Q+=8-(Q&7)),X.l=Q/8|0,X.write_shift(2,de),X.write_shift(2,~de&65535);de-- >0;)X[X.l++]=Y[Z++];Q=X.l*8;continue}Q=Vt(X,Q,+(Z+de==Y.length)+2);for(var ke=0;de-- >0;){var he=Y[Z];ke=(ke<<5^he)&32767;var we=-1,Oe=0;if((we=ae[ke])&&(we|=Z&-32768,we>Z&&(we-=32768),we<Z))for(;Y[we+Oe]==Y[Z+Oe]&&Oe<250;)++Oe;if(Oe>2){he=V[Oe],he<=22?Q=ir(X,Q,oe[he+1]>>1)-1:(ir(X,Q,3),Q+=5,ir(X,Q,oe[he-23]>>5),Q+=3);var it=he<8?0:he-4>>2;it>0&&(Dn(X,Q,Oe-re[he]),Q+=it),he=N[Z-we],Q=ir(X,Q,oe[he]>>3),Q-=3;var st=he<4?0:he-2>>1;st>0&&(Dn(X,Q,Z-we-fe[he]),Q+=st);for(var yt=0;yt<Oe;++yt)ae[ke]=Z&32767,ke=(ke<<5^Y[Z])&32767,++Z;de-=Oe-1}else he<=143?he=he+48:Q=ar(X,Q,1),Q=ir(X,Q,oe[he]),ae[ke]=Z&32767,++Z}Q=ir(X,Q,0)-1}return X.l=(Q+7)/8|0,X.l}return function(X,Q){return X.length<8?M(X,Q):K(X,Q)}}();function je(I){var N=Kt(50+Math.floor(I.length*1.1)),C=Mr(I,N);return N.slice(0,C)}var ht=ge?new Uint16Array(32768):It(32768),jt=ge?new Uint16Array(32768):It(32768),vt=ge?new Uint16Array(128):It(128),xn=1,ra=1;function Ji(I,N){var C=Be(I,N)+257;N+=5;var P=Be(I,N)+1;N+=5;var V=et(I,N)+4;N+=4;for(var M=0,K=ge?new Uint8Array(19):It(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,Q=ge?new Uint8Array(8):It(8),Z=ge?new Uint8Array(8):It(8),ae=K.length,de=0;de<V;++de)K[W[de]]=M=$e(I,N),X<M&&(X=M),Q[M]++,N+=3;var ke=0;for(Q[0]=0,de=1;de<=X;++de)Z[de]=ke=ke+Q[de-1]<<1;for(de=0;de<ae;++de)(ke=K[de])!=0&&(Y[de]=Z[ke]++);var he=0;for(de=0;de<ae;++de)if(he=K[de],he!=0){ke=oe[Y[de]]>>8-he;for(var we=(1<<7-he)-1;we>=0;--we)vt[ke|we<<he]=he&7|de<<3}var Oe=[];for(X=1;Oe.length<C+P;)switch(ke=vt[xe(I,N)],N+=ke&7,ke>>>=3){case 16:for(M=3+Fe(I,N),N+=2,ke=Oe[Oe.length-1];M-- >0;)Oe.push(ke);break;case 17:for(M=3+$e(I,N),N+=3;M-- >0;)Oe.push(0);break;case 18:for(M=11+xe(I,N),N+=7;M-- >0;)Oe.push(0);break;default:Oe.push(ke),X<ke&&(X=ke);break}var it=Oe.slice(0,C),st=Oe.slice(C);for(de=C;de<286;++de)it[de]=0;for(de=P;de<30;++de)st[de]=0;return xn=Lr(it,ht,286),ra=Lr(st,jt,30),N}function yl(I,N){if(I[0]==3&&!(I[1]&3))return[Ua(N),2];for(var C=0,P=0,V=jv(N||1<<18),M=0,K=V.length>>>0,Y=0,X=0;!(P&1);){if(P=$e(I,C),C+=3,P>>>1)P>>1==1?(Y=9,X=5):(C=Ji(I,C),Y=xn,X=ra);else{C&7&&(C+=8-(C&7));var Q=I[C>>>3]|I[(C>>>3)+1]<<8;if(C+=32,Q>0)for(!N&&K<M+Q&&(V=or(V,M+Q),K=V.length);Q-- >0;)V[M++]=I[C>>>3],C+=8;continue}for(;;){!N&&K<M+32767&&(V=or(V,M+32767),K=V.length);var Z=ft(I,C,Y),ae=P>>>1==1?nt[Z]:ht[Z];if(C+=ae&15,ae>>>=4,!(ae>>>8&255))V[M++]=ae;else{if(ae==256)break;ae-=257;var de=ae<8?0:ae-4>>2;de>5&&(de=0);var ke=M+re[ae];de>0&&(ke+=ft(I,C,de),C+=de),Z=ft(I,C,X),ae=P>>>1==1?xt[Z]:jt[Z],C+=ae&15,ae>>>=4;var he=ae<4?0:ae-2>>1,we=fe[ae];for(he>0&&(we+=ft(I,C,he),C+=he),!N&&K<ke&&(V=or(V,ke+100),K=V.length);M<ke;)V[M]=V[M-we],++M}}}return N?[V,C+7>>>3]:[V.slice(0,M),C+7>>>3]}function na(I,N){var C=I.slice(I.l||0),P=yl(C,N);return I.l+=P[1],P[0]}function ni(I,N){if(I)typeof console<"u"&&console.error(N);else throw new Error(N)}function si(I,N){var C=I;fr(C,0);var P=[],V=[],M={FileIndex:P,FullPaths:V};E(M,{root:N.root});for(var K=C.length-4;(C[K]!=80||C[K+1]!=75||C[K+2]!=5||C[K+3]!=6)&&K>=0;)--K;C.l=K+4,C.l+=4;var Y=C.read_shift(2);C.l+=6;var X=C.read_shift(4);for(C.l=X,K=0;K<Y;++K){C.l+=20;var Q=C.read_shift(4),Z=C.read_shift(4),ae=C.read_shift(2),de=C.read_shift(2),ke=C.read_shift(2);C.l+=8;var he=C.read_shift(4),we=o(C.slice(C.l+ae,C.l+ae+de));C.l+=ae+de+ke;var Oe=C.l;C.l=he+4,Is(C,Q,Z,M,we),C.l=Oe}return M}function Is(I,N,C,P,V){I.l+=2;var M=I.read_shift(2),K=I.read_shift(2),Y=i(I);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var X=I.read_shift(4),Q=I.read_shift(4),Z=I.read_shift(4),ae=I.read_shift(2),de=I.read_shift(2),ke="",he=0;he<ae;++he)ke+=String.fromCharCode(I[I.l++]);if(de){var we=o(I.slice(I.l,I.l+de));(we[21589]||{}).mt&&(Y=we[21589].mt),((V||{})[21589]||{}).mt&&(Y=V[21589].mt)}I.l+=de;var Oe=I.slice(I.l,I.l+Q);switch(K){case 8:Oe=J(I,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var it=!1;M&8&&(X=I.read_shift(4),X==134695760&&(X=I.read_shift(4),it=!0),Q=I.read_shift(4),Z=I.read_shift(4)),Q!=N&&ni(it,"Bad compressed size: "+N+" != "+Q),Z!=C&&ni(it,"Bad uncompressed size: "+C+" != "+Z),Fn(P,ke,Oe,{unsafe:!0,mt:Y})}function Zi(I,N){var C=N||{},P=[],V=[],M=Kt(1),K=C.compression?8:0,Y=0,X=0,Q=0,Z=0,ae=0,de=I.FullPaths[0],ke=de,he=I.FileIndex[0],we=[],Oe=0;for(X=1;X<I.FullPaths.length;++X)if(ke=I.FullPaths[X].slice(de.length),he=I.FileIndex[X],!(!he.size||!he.content||ke=="Sh33tJ5")){var it=Z,st=Kt(ke.length);for(Q=0;Q<ke.length;++Q)st.write_shift(1,ke.charCodeAt(Q)&127);st=st.slice(0,st.l),we[ae]=PR.buf(he.content,0);var yt=he.content;K==8&&(yt=G(yt)),M=Kt(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,Y),M.write_shift(2,K),he.mt?a(M,he.mt):M.write_shift(4,0),M.write_shift(-4,we[ae]),M.write_shift(4,yt.length),M.write_shift(4,he.content.length),M.write_shift(2,st.length),M.write_shift(2,0),Z+=M.length,P.push(M),Z+=st.length,P.push(st),Z+=yt.length,P.push(yt),M=Kt(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,Y),M.write_shift(2,K),M.write_shift(4,0),M.write_shift(-4,we[ae]),M.write_shift(4,yt.length),M.write_shift(4,he.content.length),M.write_shift(2,st.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,it),Oe+=M.l,V.push(M),Oe+=st.length,V.push(st),++ae}return M=Kt(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ae),M.write_shift(2,ae),M.write_shift(4,Oe),M.write_shift(4,Z),M.write_shift(2,0),ma([ma(P),ma(V),M])}var vr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vr(I,N){if(I.ctype)return I.ctype;var C=I.name||"",P=C.match(/\.([^\.]+)$/);return P&&vr[P[1]]||N&&(P=(C=N).match(/[\.\\]([^\.\\])+$/),P&&vr[P[1]])?vr[P[1]]:"application/octet-stream"}function ai(I){for(var N=Vv(I),C=[],P=0;P<N.length;P+=76)C.push(N.slice(P,P+76));return C.join(`\r
`)+`\r
`}function sa(I){var N=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var Z=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],P=N.split(`\r
`),V=0;V<P.length;++V){var M=P[V];if(M.length==0){C.push("");continue}for(var K=0;K<M.length;){var Y=76,X=M.slice(K,K+Y);X.charAt(Y-1)=="="?Y--:X.charAt(Y-2)=="="?Y-=2:X.charAt(Y-3)=="="&&(Y-=3),X=M.slice(K,K+Y),K+=Y,K<M.length&&(X+="="),C.push(X)}}return C.join(`\r
`)}function ns(I){for(var N=[],C=0;C<I.length;++C){for(var P=I[C];C<=I.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+I[++C];N.push(P)}for(var V=0;V<N.length;++V)N[V]=N[V].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Hn(N.join(`\r
`))}function Cs(I,N,C){for(var P="",V="",M="",K,Y=0;Y<10;++Y){var X=N[Y];if(!X||X.match(/^\s*$/))break;var Q=X.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":P=Q[2].trim();break;case"content-type":M=Q[2].trim();break;case"content-transfer-encoding":V=Q[2].trim();break}}switch(++Y,V.toLowerCase()){case"base64":K=Hn(pn(N.slice(Y).join("")));break;case"quoted-printable":K=ns(N.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var Z=Fn(I,P.slice(C.length),K,{unsafe:!0});M&&(Z.ctype=M)}function eo(I,N){if(q(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=N&&N.root||"",P=(Ke&&Buffer.isBuffer(I)?I.toString("binary"):q(I)).split(`\r
`),V=0,M="";for(V=0;V<P.length;++V)if(M=P[V],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),C||(C=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),M.slice(0,C.length)!=C););var K=(P[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var Y="--"+(K[1]||""),X=[],Q=[],Z={FileIndex:X,FullPaths:Q};E(Z);var ae,de=0;for(V=0;V<P.length;++V){var ke=P[V];ke!==Y&&ke!==Y+"--"||(de++&&Cs(Z,P.slice(ae,V),C),ae=V)}return Z}function qt(I,N){var C=N||{},P=C.boundary||"SheetJS";P="------="+P;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],M=I.FullPaths[0],K=M,Y=I.FileIndex[0],X=1;X<I.FullPaths.length;++X)if(K=I.FullPaths[X].slice(M.length),Y=I.FileIndex[X],!(!Y.size||!Y.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var Q=Y.content,Z=Ke&&Buffer.isBuffer(Q)?Q.toString("binary"):q(Q),ae=0,de=Math.min(1024,Z.length),ke=0,he=0;he<=de;++he)(ke=Z.charCodeAt(he))>=32&&ke<128&&++ae;var we=ae>=de*4/5;V.push(P),V.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+K),V.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),V.push("Content-Type: "+Vr(Y,K)),V.push(""),V.push(we?sa(Z):ai(Z))}return V.push(P+`--\r
`),V.join(`\r
`)}function to(I){var N={};return E(N,I),N}function Fn(I,N,C,P){var V=P&&P.unsafe;V||E(I);var M=!V&&Ye.find(I,N);if(!M){var K=I.FullPaths[0];N.slice(0,K.length)==K?K=N:(K.slice(-1)!="/"&&(K+="/"),K=(K+N).replace("//","/")),M={name:s(N),type:2},I.FileIndex.push(M),I.FullPaths.push(K),V||Ye.utils.cfb_gc(I)}return M.content=C,M.size=C?C.length:0,P&&(P.CLSID&&(M.clsid=P.CLSID),P.mt&&(M.mt=P.mt),P.ct&&(M.ct=P.ct)),M}function H(I,N){E(I);var C=Ye.find(I,N);if(C){for(var P=0;P<I.FileIndex.length;++P)if(I.FileIndex[P]==C)return I.FileIndex.splice(P,1),I.FullPaths.splice(P,1),!0}return!1}function ce(I,N,C){E(I);var P=Ye.find(I,N);if(P){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==P)return I.FileIndex[V].name=s(C),I.FullPaths[V]=C,!0}return!1}function me(I){k(I,!0)}return e.find=b,e.read=B,e.parse=f,e.write=ue,e.writeFile=ie,e.utils={cfb_new:to,cfb_add:Fn,cfb_del:H,cfb_mov:ce,cfb_gc:me,ReadShift:oc,CheckField:AT,prep_blob:fr,bconcat:ma,use_zlib:j,_deflateRaw:je,_inflateRaw:na,consts:ye},e}();function bR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Es(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ag(t){for(var e=[],r=Es(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var vh=new Date(1899,11,30,0,0,0);function Wr(t,e){var r=t.getTime(),n=vh.getTime()+(t.getTimezoneOffset()-vh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var nT=new Date,DR=vh.getTime()+(nT.getTimezoneOffset()-vh.getTimezoneOffset())*6e4,qv=nT.getTimezoneOffset();function f0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+DR),e.getTimezoneOffset()!==qv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-qv)*6e4),e}function FR(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var Kv=new Date("2017-02-19T19:06:09.000Z"),sT=isNaN(Kv.getFullYear())?new Date("2/19/17"):Kv,OR=sT.getFullYear()==2017;function sr(t,e){var r=new Date(t);if(OR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(sT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ri(t,e){if(Ke&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return zl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return zl(H2(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return zl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return zl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function pr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=pr(t[r]));return e}function Pt(t,e){for(var r="";r.length<e;)r+=t;return r}function Yn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var LR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&LR.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var MR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function aT(t){return t?t.content&&t.type?Ri(t.content,!0):t.data?Bl(t.data):t.asNodeBuffer&&Ke?Bl(t.asNodeBuffer().toString("binary")):t.asBinary?Bl(t.asBinary()):t._data&&t._data.getContent?Bl(Ri(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function iT(t){if(!t)return null;if(t.data)return Lv(t.data);if(t.asNodeBuffer&&Ke)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Lv(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function VR(t){return t&&t.name.slice(-4)===".bin"?iT(t):aT(t)}function _n(t,e){for(var r=t.FullPaths||Es(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Sg(t,e){var r=_n(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function $t(t,e,r){if(!r)return VR(Sg(t,e));if(!e)return null;try{return $t(t,e)}catch{return null}}function ln(t,e,r){if(!r)return aT(Sg(t,e));if(!e)return null;try{return ln(t,e)}catch{return null}}function jR(t,e,r){return iT(Sg(t,e))}function Xv(t){for(var e=t.FullPaths||Es(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function BR(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ke?n=Bi(r):n=aR(r),Ye.utils.cfb_add(t,e,n)}Ye.utils.cfb_add(t,e,r)}else t.file(e,r)}function oT(t,e){switch(e.type){case"base64":return Ye.read(t,{type:"base64"});case"binary":return Ye.read(t,{type:"binary"});case"buffer":case"array":return Ye.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function $l(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var lT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,UR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$R=/<[^>]*>/g,Or=lT.match(Yv)?Yv:$R,zR=/<\w*:/,HR=/<(\/?)\w+:/;function De(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(UR),o=0,l="",c=0,f="",h="",d=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(d=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ss(t){return t.replace(HR,"<$1")}var cT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},WR=Ag(cT),Ze=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return cT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),GR=/[&<>'"]/g,qR=/[\u0000-\u001f]/g;function kg(t){var e=t+"";return e.replace(GR,function(r){return WR[r]}).replace(/\n/g,"<br/>").replace(qR,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Qv=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function _t(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _d(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Jv(t){var e=Ua(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function Zv(t){return Bi(t,"binary").toString("utf8")}var sf="foo bar baz",ut=Ke&&(Zv(sf)==_d(sf)&&Zv||Jv(sf)==_d(sf)&&Jv)||_d,zl=Ke?function(t){return Bi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},zc=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),uT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),KR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),XR=/<\/?(?:vt:)?variant>/g,YR=/<(?:vt:)([^>]*)>([\s\S]*)</;function ey(t,e){var r=De(t),n=t.match(KR(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(XR,"").match(YR);i&&s.push({v:ut(i[2]),t:i[1]})}),s}var QR=/(^\s|\s$|\n)/;function JR(t){return Es(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ZR(t,e,r){return"<"+t+(r!=null?JR(r):"")+(e!=null?(e.match(QR)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Ig(t){if(Ke&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ut(Ui(wg(t)));throw new Error("Bad input format: expected Buffer or string")}var Hc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,e3={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},t3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function r3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function n3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var ty=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},ry=Ke?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Bi(e)})):ty(t)}:ty,ny=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Ls(t,s)));return n.join("").replace(Hr,"")},Cg=Ke?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Hr,""):ny(t,e,r)}:ny,sy=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},fT=Ke?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):sy(t,e,r)}:sy,ay=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(co(t,s)));return n.join("")},uu=Ke?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):ay(e,r,n)}:ay,hT=function(t,e){var r=on(t,e);return r>0?uu(t,e+4,e+4+r-1):""},dT=hT,pT=function(t,e){var r=on(t,e);return r>0?uu(t,e+4,e+4+r-1):""},mT=pT,gT=function(t,e){var r=2*on(t,e);return r>0?uu(t,e+4,e+4+r-1):""},xT=gT,vT=function(e,r){var n=on(e,r);return n>0?Cg(e,r+4,r+4+n):""},yT=vT,_T=function(t,e){var r=on(t,e);return r>0?uu(t,e+4,e+4+r):""},wT=_T,ET=function(t,e){return r3(t,e)},yh=ET,TT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ke&&(dT=function(e,r){if(!Buffer.isBuffer(e))return hT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},mT=function(e,r){if(!Buffer.isBuffer(e))return pT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},xT=function(e,r){if(!Buffer.isBuffer(e))return gT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},yT=function(e,r){if(!Buffer.isBuffer(e))return vT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},wT=function(e,r){if(!Buffer.isBuffer(e))return _T(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},yh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ET(e,r)},TT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var co=function(t,e){return t[e]},Ls=function(t,e){return t[e+1]*256+t[e]},s3=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},on=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},hi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},a3=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function oc(t,e){var r="",n,s,a=[],i,o,l,c;switch(e){case"dbcs":if(c=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ls(this,c)),c+=2;t*=2;break;case"utf8":r=uu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Cg(this,this.l,this.l+t);break;case"wstr":return oc.call(this,t,"dbcs");case"lpstr-ansi":r=dT(this,this.l),t=4+on(this,this.l);break;case"lpstr-cp":r=mT(this,this.l),t=4+on(this,this.l);break;case"lpwstr":r=xT(this,this.l),t=4+2*on(this,this.l);break;case"lpp4":t=4+on(this,this.l),r=yT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+on(this,this.l),r=wT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=co(this,this.l+t++))!==0;)a.push(nf(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Ls(this,this.l+t))!==0;)a.push(nf(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=co(this,c),this.l=c+1,o=oc.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(nf(Ls(this,c))),c+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=co(this,c),this.l=c+1,o=oc.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(nf(co(this,c))),c+=1}r=a.join("");break;default:switch(t){case 1:return n=co(this,this.l),this.l++,n;case 2:return n=(e==="i"?s3:Ls)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?hi:a3)(this,this.l),this.l+=4,n):(s=on(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=yh(this,this.l):s=yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=fT(this,this.l,t);break}}return this.l+=t,r}var i3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},o3=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},l3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function c3(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)l3(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,i3(this,e,this.l);break;case 8:if(n=8,r==="f"){n3(this,e,this.l);break}case 16:break;case-4:n=4,o3(this,e,this.l);break}return this.l+=n,this}function AT(t,e){var r=fT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function fr(t,e){t.l=e,t.read_shift=oc,t.chk=AT,t.write_shift=c3}function Dr(t,e){t.l+=e}function Kt(t){var e=Ua(t);return fr(e,0),e}function ea(t,e,r){if(t){var n,s,a;fr(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Sh[o]||Sh[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var f=c.f&&c.f(t,a,r);if(t.l=l,e(f,c,o))return}}}function jp(){var t=[],e=Ke?256:2048,r=function(c){var f=Kt(c);return fr(f,0),f},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},i=function(){return s(),ma(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function lc(t,e,r){var n=pr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iy(t,e,r){var n=pr(t);return n.s=lc(n.s,e.s,r),n.e=lc(n.e,e.s,r),n}function cc(t,e){if(t.cRel&&t.c<0)for(t=pr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=pr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Me(t);return!t.cRel&&t.cRel!=null&&(r=h3(r)),!t.rRel&&t.rRel!=null&&(r=u3(r)),r}function wd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Qt(t.s.c)+":"+(t.e.cRel?"":"$")+Qt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+mr(t.s.r)+":"+(t.e.rRel?"":"$")+mr(t.e.r):cc(t.s,e.biff)+":"+cc(t.e,e.biff)}function Ng(t){return parseInt(f3(t),10)-1}function mr(t){return""+(t+1)}function u3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function f3(t){return t.replace(/\$(\d+)$/,"$1")}function Rg(t){for(var e=d3(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Qt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function h3(t){return t.replace(/^([A-Z])/,"$$$1")}function d3(t){return t.replace(/^\$([A-Z])/,"$1")}function p3(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $r(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Me(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cl(t){var e=t.indexOf(":");return e==-1?{s:$r(t),e:$r(t)}:{s:$r(t.slice(0,e)),e:$r(t.slice(e+1))}}function Qe(t,e){return typeof e>"u"||typeof e=="number"?Qe(t.s,t.e):(typeof t!="string"&&(t=Me(t)),typeof e!="string"&&(e=Me(e)),t==e?t:t+":"+e)}function bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function oy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Pn(t.z,r?Wr(e):e)}catch{}try{return t.w=Pn((t.XF||{}).numFmtId||(r?14:0),r?Wr(e):e)}catch{return""+e}}function Ks(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Hi[t.v]||t.v:e==null?oy(t,t.v):oy(t,e))}function Za(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function ST(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=bt(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},g=i+h,v=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>v&&(c.s.c=v),c.e.r<g&&(c.e.r=g),c.e.c<v&&(c.e.c=v),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Ue[14],n.cellDates?(m.t="d",m.w=Pn(m.z,Wr(m.v))):(m.t="n",m.v=Wr(m.v),m.w=Pn(m.z,m.v))):m.t="s";if(s)a[g]||(a[g]=[]),a[g][v]&&a[g][v].z&&(m.z=a[g][v].z),a[g][v]=m;else{var w=Me({c:v,r:g});a[w]&&a[w].z&&(m.z=a[w].z),a[w]=m}}}return c.s.c<1e7&&(a["!ref"]=Qe(c)),a}function ul(t,e){return ST(null,t,e)}function m3(t){return t.read_shift(4,"i")}function Pr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function g3(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Pg(t,e){var r=t.l,n=t.read_shift(1),s=Pr(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(g3(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}var x3=Pg;function bn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function $i(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var v3=Pr;function bg(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var y3=Pr,Bp=bg;function Dg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?yh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):hi(e,0)>>2;return r?s/100:s}function kT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var zi=kT;function Nr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function _3(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Ei[s];c&&(e.rgb=Gc(c));break;case 2:e.rgb=Gc([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function w3(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function IT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function E3(t){return IT(t,1)}function T3(t){return IT(t,2)}var Fg=2,Kr=3,af=11,ly=12,_h=19,of=64,A3=65,S3=71,k3=4108,I3=4126,er=80,CT=81,C3=[er,CT],N3={1:{n:"CodePage",t:Fg},2:{n:"Category",t:er},3:{n:"PresentationFormat",t:er},4:{n:"ByteCount",t:Kr},5:{n:"LineCount",t:Kr},6:{n:"ParagraphCount",t:Kr},7:{n:"SlideCount",t:Kr},8:{n:"NoteCount",t:Kr},9:{n:"HiddenCount",t:Kr},10:{n:"MultimediaClipCount",t:Kr},11:{n:"ScaleCrop",t:af},12:{n:"HeadingPairs",t:k3},13:{n:"TitlesOfParts",t:I3},14:{n:"Manager",t:er},15:{n:"Company",t:er},16:{n:"LinksUpToDate",t:af},17:{n:"CharacterCount",t:Kr},19:{n:"SharedDoc",t:af},22:{n:"HyperlinksChanged",t:af},23:{n:"AppVersion",t:Kr,p:"version"},24:{n:"DigSig",t:A3},26:{n:"ContentType",t:er},27:{n:"ContentStatus",t:er},28:{n:"Language",t:er},29:{n:"Version",t:er},255:{},2147483648:{n:"Locale",t:_h},2147483651:{n:"Behavior",t:_h},1919054434:{}},R3={1:{n:"CodePage",t:Fg},2:{n:"Title",t:er},3:{n:"Subject",t:er},4:{n:"Author",t:er},5:{n:"Keywords",t:er},6:{n:"Comments",t:er},7:{n:"Template",t:er},8:{n:"LastAuthor",t:er},9:{n:"RevNumber",t:er},10:{n:"EditTime",t:of},11:{n:"LastPrinted",t:of},12:{n:"CreatedDate",t:of},13:{n:"ModifiedDate",t:of},14:{n:"PageCount",t:Kr},15:{n:"WordCount",t:Kr},16:{n:"CharCount",t:Kr},17:{n:"Thumbnail",t:S3},18:{n:"Application",t:er},19:{n:"DocSecurity",t:Kr},255:{},2147483648:{n:"Locale",t:_h},2147483651:{n:"Behavior",t:_h},1919054434:{}},cy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},P3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function b3(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var D3=b3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ei=pr(D3),Hi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},NT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function F3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function O3(t){var e=F3();if(!t||!t.match)return e;var r={};if((t.match(Or)||[]).forEach(function(n){var s=De(n);switch(s[0].replace(zR,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[uy[s.ContentType]]!==void 0&&e[uy[s.ContentType]].push(s.PartName);break}}),e.xmlns!==e3.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Io={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Up(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function uc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Or)||[]).forEach(function(s){var a=De(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:$l(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var L3="application/vnd.oasis.opendocument.spreadsheet";function M3(t,e){for(var r=Ig(t),n,s;n=Hc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=De(n[0],!1),s.path=="/"&&s.type!==L3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var fc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],V3=function(){for(var t=new Array(fc.length),e=0;e<fc.length;++e){var r=fc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function RT(t){var e={};t=ut(t);for(var r=0;r<fc.length;++r){var n=fc[r],s=t.match(V3[r]);s!=null&&s.length>0&&(e[n[1]]=Ze(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=sr(e[n[1]]))}return e}var j3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function PT(t,e,r,n){var s=[];if(typeof t=="string")s=ey(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(f){return{v:f}}));var i=typeof e=="string"?ey(e,n).map(function(f){return f.v}):e,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function B3(t,e,r){var n={};return e||(e={}),t=ut(t),j3.forEach(function(s){var a=(t.match(zc(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=Ze(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&PT(n.HeadingPairs,n.TitlesOfParts,e,r),e}var U3=/<[^>]+>[^<]*/g;function $3(t,e){var r={},n="",s=t.match(U3);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=De(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ze(f);break;case"bool":r[n]=_t(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=sr(f);break;case"cy":case"error":r[n]=Ze(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}var z3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ed;function H3(t,e,r){Ed||(Ed=Ag(z3)),e=Ed[e]||e,t[e]=r}function Og(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function bT(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function DT(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function FT(t,e,r){return e===31?DT(t):bT(t,e,r)}function $p(t,e,r){return FT(t,e,r===!1?0:4)}function W3(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return FT(t,e,0)}function G3(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Hr,""),t.l-s&2&&(t.l+=2)}return r}function q3(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Hr,"");return r}function K3(t){var e=t.l,r=wh(t,CT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=wh(t,Kr);return[r,n]}function X3(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(K3(t));return r}function fy(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(Hr,"").replace(Ul,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function OT(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function Y3(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function wh(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==ly&&n!==e&&C3.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ly?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return bT(t,n,4).replace(Hr,"");case 31:return DT(t);case 64:return Og(t);case 65:return OT(t);case 71:return Y3(t);case 80:return $p(t,n,!a.raw).replace(Hr,"");case 81:return W3(t,n).replace(Hr,"");case 4108:return X3(t);case 4126:case 4127:return n==4127?G3(t):q3(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function hy(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var f=t.read_shift(4),h=t.read_shift(4);a[i]=[f,h+r]}a.sort(function(_,y){return _[1]-y[1]});var d={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var m=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,m=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],m=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],m=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(m=!1,t.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var g=e[a[i][0]];if(d[g.n]=wh(t,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Wn(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(a[i][0]===1){if(o=d.CodePage=wh(t,Fg),Wn(o),l!==-1){var v=t.l;t.l=a[l][1],c=fy(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}c=fy(t,o)}else{var w=c[a[i][0]],T;switch(t[t.l]){case 65:t.l+=4,T=OT(t);break;case 30:t.l+=4,T=$p(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=$p(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Dt(t,4);break;case 64:t.l+=4,T=sr(Og(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[w]=T}}return t.l=r+n,d}function dy(t,e,r){var n=t.content;if(!n)return{};fr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ye.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=hy(n,e),d={SystemIdentifier:c};for(var m in h)d[m]=h[m];if(d.FMTID=a,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=hy(n,null)}catch{}for(m in g)d[m]=g[m];return d.FMTID=[a,i],d}function ca(t,e){return t.read_shift(e),null}function Q3(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Dt(t,e){return t.read_shift(e)===1}function zt(t){return t.read_shift(2,"u")}function LT(t,e){return Q3(t,e,zt)}function J3(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function fu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function Z3(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Pi(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function hu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Pi(t,n,r)}function Wi(t,e,r){if(r.biff>5)return hu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function eP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function tP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Hr,"");return n&&(t.l+=24),s}function rP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(Hr,"");return r+i}function nP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return tP(t);case"0303000000000000c000000000000046":return rP(t);default:throw new Error("Unsupported Moniker "+r)}}function lf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Hr,""):"";return r}function sP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,c="",f,h;s&16&&(a=lf(t,r-t.l)),s&128&&(i=lf(t,r-t.l)),(s&257)===257&&(o=lf(t,r-t.l)),(s&257)===1&&(l=nP(t,r-t.l)),s&8&&(c=lf(t,r-t.l)),s&32&&(f=t.read_shift(16)),s&64&&(h=Og(t)),t.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return f&&(m.guid=f),h&&(m.time=h),a&&(m.Tooltip=a),m}function MT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function VT(t,e){var r=MT(t);return r[3]=0,r}function ks(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function aP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function iP(t,e,r){return e===0?"":Wi(t,e,r)}function oP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function jT(t){var e=t.read_shift(2),r=Dg(t);return[e,r]}function lP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=fu(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function h0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function BT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var cP=BT;function UT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function uP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function fP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Tr(t){t.l+=2,t.l+=t.read_shift(2)}var hP={0:Tr,4:Tr,5:Tr,6:Tr,7:fP,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:uP,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:UT};function dP(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(hP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function cf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function pP(t,e){return e===0||t.read_shift(2),1200}function mP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Wi(t,0,r);return t.read_shift(e+n-t.l),s}function gP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function xP(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=fu(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function vP(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(Z3(t));return a.Count=n,a.Unique=s,a}function yP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function _P(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function wP(t){var e=aP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function EP(t){return t.read_shift(2),t.read_shift(4)}function py(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function TP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function AP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function SP(){}function kP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=fu(t,0,r),n}function IP(t){var e=ks(t);return e.isst=t.read_shift(4),e}function CP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=ks(t);r.biff==2&&t.l++;var a=hu(t,n-t.l,r);return s.val=a,s}function NP(t,e,r){var n=t.read_shift(2),s=Wi(t,0,r);return[n,s]}var RP=Wi;function my(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function PP(t){var e=t.read_shift(2),r=t.read_shift(2),n=jT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function bP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(jT(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function DP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function FP(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=P3[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function OP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=FP(t,e,n.fStyle,r),n}function LP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function gy(t,e,r){var n=ks(t);(r.biff==2||e==9)&&++t.l;var s=J3(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function MP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ks(t),s=Nr(t);return n.val=s,n}var xy=iP;function VP(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Pi(t,a),o=[];n>t.l;)o.push(hu(t));return[a,s,i,o]}function vy(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=lP(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var jP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yy(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Pi(t,i,r);s&32&&(c=jP[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:_6(t,f,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function $T(t,e,r){if(r.biff<8)return BP(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(oP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function BP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=fu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function UP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Pi(t,n,r),i=Pi(t,s,r);return[a,i]}function $P(t,e,r){var n=BT(t);t.l++;var s=t.read_shift(1);return e-=8,[w6(t,e,r),s,n]}function _y(t,e,r){var n=cP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,v6(t,e,r)]}function zP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function HP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=Wi(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function WP(t,e,r){return HP(t,e,r)}function GP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(h0(t));return r}function qP(t,e,r){if(r&&r.biff<8)return XP(t,e,r);var n=UT(t),s=dP(t,e-22,n[1]);return{cmo:n,ft:s}}var KP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function XP(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((KP[n]||Dr)(t,e,r)),{cmo:[s,n,a],ft:i}}function YP(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=eP(t,6,r);var o=t.read_shift(2);t.read_shift(2),zt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Pi(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function QP(t,e){var r=h0(t);t.l+=16;var n=sP(t,e-24);return[r,n]}function JP(t,e){t.read_shift(2);var r=h0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Hr,""),[r,n]}function ZP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=cy[r]||r,r=t.read_shift(2),e[1]=cy[r]||r,e}function eb(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(VT(t));return r}function tb(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(VT(t));return r}function rb(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function zT(t,e,r){if(!r.cellStyles)return Dr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function nb(t,e){var r={};return e<32||(t.l+=16,r.header=Nr(t),r.footer=Nr(t),t.l+=2),r}function sb(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var ab=ks,ib=LT,ob=hu;function lb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function cb(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ks(t);++t.l;var s=Wi(t,e-7,r);return n.t="str",n.val=s,n}function ub(t){var e=ks(t);++t.l;var r=Nr(t);return e.t="n",e.val=r,e}function fb(t){var e=ks(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function hb(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function db(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function pb(t,e,r){var n=t.l+e,s=ks(t),a=t.read_shift(2),i=Pi(t,a,r);return t.l=n,s.t="str",s.val=i,s}var mb=[2,3,48,49,131,139,140,245],wy=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ag({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Ua(1);switch(l.type){case"base64":f=Hn(pn(o));break;case"binary":f=Hn(o);break;case"buffer":case"array":f=o;break}fr(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,w=521;h==2&&(v=f.read_shift(2)),f.l+=3,h!=2&&(v=f.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(w=f.read_shift(2));var T=f.read_shift(2),_=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=t[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var y=[],O={},z=Math.min(f.length,h==2?521:w-10-(m?264:0)),B=g?32:11;f.l<z&&f[f.l]!=13;)switch(O={},O.name=Uc.utils.decode(_,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,O.type=String.fromCharCode(f.read_shift(1)),h!=2&&!g&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),h==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&y.push(O),h!=2&&(f.l+=g?13:14),O.type){case"B":(!m||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var E=0,S=0;for(c[0]=[],S=0;S!=y.length;++S)c[0][S]=y[S].name;for(;v-- >0;){if(f[f.l]===42){f.l+=T;continue}for(++f.l,c[++E]=[],S=0,S=0;S!=y.length;++S){var k=f.slice(f.l,f.l+y[S].len);f.l+=y[S].len,fr(k,0);var R=Uc.utils.decode(_,k);switch(y[S].type){case"C":R.trim().length&&(c[E][S]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[E][S]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[E][S]=R;break;case"F":c[E][S]=parseFloat(R.trim());break;case"+":case"I":c[E][S]=g?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[E][S]=!0;break;case"N":case"F":c[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[E][S]="##MEMO##"+(g?parseInt(R.trim(),10):k.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[E][S]=+R||0);break;case"@":c[E][S]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[E][S]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[E][S]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][S]=-k.read_shift(-8,"f");break;case"B":if(m&&y[S].len==8){c[E][S]=k.read_shift(8,"f");break}case"G":case"P":k.l+=y[S].len;break;case"0":if(y[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[S].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=ul(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function s(o,l){try{return Za(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Wn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=jp(),h=Kp(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],v=0,w=0,T=0,_=1;for(v=0;v<d.length;++v){if(((g[v]||{}).DBF||{}).name){d[v]=g[v].DBF.name,++T;continue}if(d[v]!=null){if(++T,typeof d[v]=="number"&&(d[v]=d[v].toString(10)),typeof d[v]!="string")throw new Error("DBF Invalid column name "+d[v]+" |"+typeof d[v]+"|");if(d.indexOf(d[v])!==v){for(w=0;w<1024;++w)if(d.indexOf(d[v]+"_"+w)==-1){d[v]+="_"+w;break}}}}var y=bt(o["!ref"]),O=[],z=[],B=[];for(v=0;v<=y.e.c-y.s.c;++v){var E="",S="",k=0,R=[];for(w=0;w<m.length;++w)m[w][v]!=null&&R.push(m[w][v]);if(R.length==0||d[v]==null){O[v]="?";continue}for(w=0;w<R.length;++w){switch(typeof R[w]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=R[w]instanceof Date?"D":"C";break;default:S="C"}k=Math.max(k,String(R[w]).length),E=E&&E!=S?"C":S}k>250&&(k=250),S=((g[v]||{}).DBF||{}).type,S=="C"&&g[v].DBF.len>k&&(k=g[v].DBF.len),E=="B"&&S=="N"&&(E="N",B[v]=g[v].DBF.dec,k=g[v].DBF.len),z[v]=E=="C"||S=="N"?k:a[E]||0,_+=z[v],O[v]=E}var b=f.next(32);for(b.write_shift(4,318902576),b.write_shift(4,m.length),b.write_shift(2,296+32*T),b.write_shift(2,_),v=0;v<4;++v)b.write_shift(4,0);for(b.write_shift(4,0|(+e[$2]||3)<<8),v=0,w=0;v<d.length;++v)if(d[v]!=null){var D=f.next(32),F=(d[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,F,"sbcs"),D.write_shift(1,O[v]=="?"?"C":O[v],"sbcs"),D.write_shift(4,w),D.write_shift(1,z[v]||a[O[v]]||0),D.write_shift(1,B[v]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),w+=z[v]||a[O[v]]||0}var _e=f.next(264);for(_e.write_shift(4,13),v=0;v<65;++v)_e.write_shift(4,0);for(v=0;v<m.length;++v){var pe=f.next(_);for(pe.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(O[w]){case"L":pe.write_shift(1,m[v][w]==null?63:m[v][w]?84:70);break;case"B":pe.write_shift(8,m[v][w]||0,"f");break;case"N":var Se="0";for(typeof m[v][w]=="number"&&(Se=m[v][w].toFixed(B[w]||0)),T=0;T<z[w]-Se.length;++T)pe.write_shift(1,32);pe.write_shift(1,Se,"sbcs");break;case"D":m[v][w]?(pe.write_shift(4,("0000"+m[v][w].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(m[v][w].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+m[v][w].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(m[v][w]!=null?m[v][w]:"").slice(0,z[w]);for(pe.write_shift(1,ye,"sbcs"),T=0;T<z[w]-ye.length;++T)pe.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),gb=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Es(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var g=t[m];return typeof g=="number"?Mv(g):g},n=function(d,m,g){var v=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?d:Mv(v)};t["|"]=254;function s(d,m){switch(m.type){case"base64":return a(pn(d),m);case"binary":return a(d,m);case"buffer":return a(Ke&&Buffer.isBuffer(d)?d.toString("binary"):Ui(d),m);case"array":return a(Ri(d),m)}throw new Error("Unrecognized type "+m.type)}function a(d,m){var g=d.split(/[\n\r]+/),v=-1,w=-1,T=0,_=0,y=[],O=[],z=null,B={},E=[],S=[],k=[],R=0,b;for(+m.codepage>=0&&Wn(+m.codepage);T!==g.length;++T){R=0;var D=g[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=D.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),_e=F[0],pe;if(D.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&O.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Se=!1,ye=!1,ie=!1,q=!1,ue=-1,Te=-1;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"A":break;case"X":w=parseInt(F[_].slice(1))-1,ye=!0;break;case"Y":for(v=parseInt(F[_].slice(1))-1,ye||(w=0),b=y.length;b<=v;++b)y[b]=[];break;case"K":pe=F[_].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(Yn(pe))?isNaN(Yo(pe).getDate())||(pe=sr(pe)):(pe=Yn(pe),z!==null&&ll(z)&&(pe=f0(pe))),Se=!0;break;case"E":q=!0;var j=Lo(F[_].slice(1),{r:v,c:w});y[v][w]=[y[v][w],j];break;case"S":ie=!0,y[v][w]=[y[v][w],"S5S"];break;case"G":break;case"R":ue=parseInt(F[_].slice(1))-1;break;case"C":Te=parseInt(F[_].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Se&&(y[v][w]&&y[v][w].length==2?y[v][w][0]=pe:y[v][w]=pe,z=null),ie){if(q)throw new Error("SYLK shared formula cannot have own formula");var J=ue>-1&&y[ue][Te];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");y[v][w][1]=ZT(J[1],{r:v-ue,c:w-Te})}break;case"F":var G=0;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"X":w=parseInt(F[_].slice(1))-1,++G;break;case"Y":for(v=parseInt(F[_].slice(1))-1,b=y.length;b<=v;++b)y[b]=[];break;case"M":R=parseInt(F[_].slice(1))/20;break;case"F":break;case"G":break;case"P":z=O[parseInt(F[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=F[_].slice(1).split(" "),b=parseInt(k[0],10);b<=parseInt(k[1],10);++b)R=parseInt(k[2],10),S[b-1]=R===0?{hidden:!0}:{wch:R},Qo(S[b-1]);break;case"C":w=parseInt(F[_].slice(1))-1,S[w]||(S[w]={});break;case"R":v=parseInt(F[_].slice(1))-1,E[v]||(E[v]={}),R>0?(E[v].hpt=R,E[v].hpx=qc(R)):R===0&&(E[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}G<1&&(z=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return E.length>0&&(B["!rows"]=E),S.length>0&&(B["!cols"]=S),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,B]}function i(d,m){var g=s(d,m),v=g[0],w=g[1],T=ul(v,m);return Es(w).forEach(function(_){T[_]=w[_]}),T}function o(d,m){return Za(i(d,m),m)}function l(d,m,g,v){var w="C;Y"+(g+1)+";X"+(v+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+rF(d.f,{r:g,c:v}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(d,m){m.forEach(function(g,v){var w="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?w+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Th(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ah(g.wpx)),typeof g.wch=="number"&&(w+=Math.round(g.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function f(d,m){m.forEach(function(g,v){var w="F;";g.hidden?w+="M0;":g.hpt?w+="M"+20*g.hpt+";":g.hpx&&(w+="M"+20*YT(g.hpx)+";"),w.length>2&&d.push(w+"R"+(v+1))})}function h(d,m){var g=["ID;PWXL;N;E"],v=[],w=bt(d["!ref"]),T,_=Array.isArray(d),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var O=w.s.r;O<=w.e.r;++O)for(var z=w.s.c;z<=w.e.c;++z){var B=Me({r:O,c:z});T=_?(d[O]||[])[z]:d[B],!(!T||T.v==null&&(!T.f||T.F))&&v.push(l(T,d,O,z))}return g.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),xb=function(){function t(a,i){switch(i.type){case"base64":return e(pn(a),i);case"binary":return e(a,i);case"buffer":return e(Ke&&Buffer.isBuffer(a)?a.toString("binary"):Ui(a),i);case"array":return e(Ri(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),m=d[0],g=d[1];++f;for(var v=o[f]||"";(v.match(/["]/g)||[]).length&1&&f<o.length-1;)v+=`
`+o[++f];switch(v=v.trim(),+m){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN(Yn(g))?isNaN(Yo(g).getDate())?h[l][c]=g:h[l][c]=sr(g):h[l][c]=Yn(g),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return ul(t(a,i),i)}function n(a,i){return Za(r(a,i),i)}var s=function(){var a=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=bt(l["!ref"]),h,d=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){i(c,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var v=Me({r:m,c:g});if(h=d?(l[m]||[])[g]:l[v],!h){i(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,w,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Pn(h.z||Ue[14],Wr(sr(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var T=`\r
`,_=c.join(T);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),vb=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),g=-1,v=-1,w=0,T=[];w!==m.length;++w){var _=m[w].trim().split(":");if(_[0]==="cell"){var y=$r(_[1]);if(T.length<=y.r)for(g=T.length;g<=y.r;++g)T[g]||(T[g]=[]);switch(g=y.r,v=y.c,_[2]){case"t":T[g][v]=t(_[3]);break;case"v":T[g][v]=+_[3];break;case"vtf":var O=_[_.length-1];case"vtc":switch(_[3]){case"nl":T[g][v]=!!+_[4];break;default:T[g][v]=+_[4];break}_[2]=="vtf"&&(T[g][v]=[T[g][v],O])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return ul(r(h,d),d)}function s(h,d){return Za(n(h,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,v="",w=cl(h["!ref"]),T=Array.isArray(h),_=w.s.r;_<=w.e.r;++_)for(var y=w.s.c;y<=w.e.c;++y)if(v=Me({r:_,c:y}),g=T?(h[_]||[])[y]:h[v],!(!g||g.v==null||g.t==="z")){switch(m=["cell",v,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var O=Wr(sr(g.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=g.w||Pn(g.z||Ue[14],O);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[a,i,o,i,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),Wc=function(){function t(f,h,d,m,g){g.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(Yn(f))?isNaN(Yo(f).getDate())?h[d][m]=f:h[d][m]=sr(f):h[d][m]=Yn(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var g=f.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var w=10,T=0,_=0;_<=v;++_)T=g[_].indexOf(" "),T==-1?T=g[_].length:T++,w=Math.max(w,T);for(_=0;_<=v;++_){m[_]=[];var y=0;for(t(g[_].slice(0,w).trim(),m,_,y,d),y=1;y<=(g[_].length-w)/10+1;++y)t(g[_].slice(w+(y-1)*10,w+y*10).trim(),m,_,y,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},d=!1,m=0,g=0;m<f.length;++m)(g=f.charCodeAt(m))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[g.pop()[1]]||44}function a(f,h){var d=h||{},m="",g=d.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):d&&d.FS?m=d.FS:m=s(f.slice(0,1024));var w=0,T=0,_=0,y=0,O=0,z=m.charCodeAt(0),B=!1,E=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?NR(d.dateNF):null;function R(){var b=f.slice(y,O),D={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)D.t="z";else if(d.raw)D.t="s",D.v=b;else if(b.trim().length===0)D.t="s",D.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(D.t="s",D.v=b.slice(2,-1).replace(/""/g,'"')):sF(b)?(D.t="n",D.f=b.slice(1)):(D.t="s",D.v=b);else if(b=="TRUE")D.t="b",D.v=!0;else if(b=="FALSE")D.t="b",D.v=!1;else if(!isNaN(_=Yn(b)))D.t="n",d.cellText!==!1&&(D.w=b),D.v=_;else if(!isNaN(Yo(b).getDate())||k&&b.match(k)){D.z=d.dateNF||Ue[14];var F=0;k&&b.match(k)&&(b=RR(b,d.dateNF,b.match(k)||[]),F=1),d.cellDates?(D.t="d",D.v=sr(b,F)):(D.t="n",D.v=Wr(sr(b,F))),d.cellText!==!1&&(D.w=Pn(D.z,D.v instanceof Date?Wr(D.v):D.v)),d.cellNF||delete D.z}else D.t="s",D.v=b;if(D.t=="z"||(d.dense?(g[w]||(g[w]=[]),g[w][T]=D):g[Me({c:T,r:w})]=D),y=O+1,S=f.charCodeAt(y),v.e.c<T&&(v.e.c=T),v.e.r<w&&(v.e.r=w),E==z)++T;else if(T=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;O<f.length;++O)switch(E=f.charCodeAt(O)){case 34:S===34&&(B=!B);break;case z:case 10:case 13:if(!B&&R())break e;break}return O-y>0&&R(),g["!ref"]=Qe(v),g}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):ul(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:zg(f,h);switch(h.type){case"base64":d=pn(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Uc<"u"||(d=Ke&&Buffer.isBuffer(f)?f.toString("binary"):Ui(f));break;case"array":d=Ri(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=ut(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=ut(d):h.type=="binary"&&typeof Uc<"u",d.slice(0,19)=="socialcalc:version:"?vb.to_sheet(h.type=="string"?d:ut(d),h):i(d,h)}function l(f,h){return Za(o(f,h),h)}function c(f){for(var h=[],d=bt(f["!ref"]),m,g=Array.isArray(f),v=d.s.r;v<=d.e.r;++v){for(var w=[],T=d.s.c;T<=d.e.c;++T){var _=Me({r:v,c:T});if(m=g?(f[v]||[])[T]:f[_],!m||m.v==null){w.push("          ");continue}for(var y=(m.w||(Ks(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(T===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function yb(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=gb.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Wc.to_workbook(t,e)}}var hc=function(){function t(j,J,G){if(j){fr(j,j.l||0);for(var W=G.Enum||ue;j.l<j.length;){var re=j.read_shift(2),fe=W[re]||W[65535],Ee=j.read_shift(2),ge=j.l+Ee,oe=fe.f&&fe.f(j,Ee,G);if(j.l=ge,J(oe,fe,re))return}}}function e(j,J){switch(J.type){case"base64":return r(Hn(pn(j)),J);case"binary":return r(Hn(j),J);case"buffer":case"array":return r(j,J)}throw"Unsupported type "+J.type}function r(j,J){if(!j)return j;var G=J||{},W=G.dense?[]:{},re="Sheet1",fe="",Ee=0,ge={},oe=[],be=[],U={s:{r:0,c:0},e:{r:0,c:0}},Fe=G.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)G.Enum=ue,t(j,function(xe,ft,Vt){switch(Vt){case 0:G.vers=xe,xe>=4096&&(G.qpro=!0);break;case 6:U=xe;break;case 204:xe&&(fe=xe);break;case 222:fe=xe;break;case 15:case 51:G.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Vt==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=G.dateNF||Ue[14],G.cellDates&&(xe[1].t="d",xe[1].v=f0(xe[1].v))),G.qpro&&xe[3]>Ee&&(W["!ref"]=Qe(U),ge[re]=W,oe.push(re),W=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},Ee=xe[3],re=fe||"Sheet"+(Ee+1),fe="");var ar=G.dense?(W[xe[0].r]||[])[xe[0].c]:W[Me(xe[0])];if(ar){ar.t=xe[1].t,ar.v=xe[1].v,xe[1].z!=null&&(ar.z=xe[1].z),xe[1].f!=null&&(ar.f=xe[1].f);break}G.dense?(W[xe[0].r]||(W[xe[0].r]=[]),W[xe[0].r][xe[0].c]=xe[1]):W[Me(xe[0])]=xe[1];break}},G);else if(j[2]==26||j[2]==14)G.Enum=Te,j[2]==14&&(G.qpro=!0,j.l=0),t(j,function(xe,ft,Vt){switch(Vt){case 204:re=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>Ee&&(W["!ref"]=Qe(U),ge[re]=W,oe.push(re),W=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},Ee=xe[3],re="Sheet"+(Ee+1)),Fe>0&&xe[0].r>=Fe)break;G.dense?(W[xe[0].r]||(W[xe[0].r]=[]),W[xe[0].r][xe[0].c]=xe[1]):W[Me(xe[0])]=xe[1],U.e.c<xe[0].c&&(U.e.c=xe[0].c),U.e.r<xe[0].r&&(U.e.r=xe[0].r);break;case 27:xe[14e3]&&(be[xe[14e3][0]]=xe[14e3][1]);break;case 1537:be[xe[0]]=xe[1],xe[0]==Ee&&(re=xe[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(W["!ref"]=Qe(U),ge[fe||re]=W,oe.push(fe||re),!be.length)return{SheetNames:oe,Sheets:ge};for(var $e={},et=[],Be=0;Be<be.length;++Be)ge[oe[Be]]?(et.push(be[Be]||oe[Be]),$e[be[Be]]=ge[be[Be]]||ge[oe[Be]]):(et.push(be[Be]),$e[be[Be]]={"!ref":"A1"});return{SheetNames:et,Sheets:$e}}function n(j,J){var G=J||{};if(+G.codepage>=0&&Wn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var W=jp(),re=bt(j["!ref"]),fe=Array.isArray(j),Ee=[];Vn(W,0,a(1030)),Vn(W,6,l(re));for(var ge=Math.min(re.e.r,8191),oe=re.s.r;oe<=ge;++oe)for(var be=mr(oe),U=re.s.c;U<=re.e.c;++U){oe===re.s.r&&(Ee[U]=Qt(U));var Fe=Ee[U]+be,$e=fe?(j[oe]||[])[U]:j[Fe];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Vn(W,13,m(oe,U,$e.v)):Vn(W,14,v(oe,U,$e.v));else{var et=Ks($e);Vn(W,15,h(oe,U,et.slice(0,239)))}}return Vn(W,1),W.end()}function s(j,J){var G=J||{};if(+G.codepage>=0&&Wn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var W=jp();Vn(W,0,i(j));for(var re=0,fe=0;re<j.SheetNames.length;++re)(j.Sheets[j.SheetNames[re]]||{})["!ref"]&&Vn(W,27,q(j.SheetNames[re],fe++));var Ee=0;for(re=0;re<j.SheetNames.length;++re){var ge=j.Sheets[j.SheetNames[re]];if(!(!ge||!ge["!ref"])){for(var oe=bt(ge["!ref"]),be=Array.isArray(ge),U=[],Fe=Math.min(oe.e.r,8191),$e=oe.s.r;$e<=Fe;++$e)for(var et=mr($e),Be=oe.s.c;Be<=oe.e.c;++Be){$e===oe.s.r&&(U[Be]=Qt(Be));var xe=U[Be]+et,ft=be?(ge[$e]||[])[Be]:ge[xe];if(!(!ft||ft.t=="z"))if(ft.t=="n")Vn(W,23,R($e,Be,Ee,ft.v));else{var Vt=Ks(ft);Vn(W,22,E($e,Be,Ee,Vt.slice(0,239)))}}++Ee}}return Vn(W,1),W.end()}function a(j){var J=Kt(2);return J.write_shift(2,j),J}function i(j){var J=Kt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var G=0,W=0,re=0,fe=0;fe<j.SheetNames.length;++fe){var Ee=j.SheetNames[fe],ge=j.Sheets[Ee];if(!(!ge||!ge["!ref"])){++re;var oe=cl(ge["!ref"]);G<oe.e.r&&(G=oe.e.r),W<oe.e.c&&(W=oe.e.c)}}return G>8191&&(G=8191),J.write_shift(2,G),J.write_shift(1,re),J.write_shift(1,W),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(j,J,G){var W={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&G.qpro?(W.s.c=j.read_shift(1),j.l++,W.s.r=j.read_shift(2),W.e.c=j.read_shift(1),j.l++,W.e.r=j.read_shift(2),W):(W.s.c=j.read_shift(2),W.s.r=j.read_shift(2),J==12&&G.qpro&&(j.l+=2),W.e.c=j.read_shift(2),W.e.r=j.read_shift(2),J==12&&G.qpro&&(j.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(j){var J=Kt(8);return J.write_shift(2,j.s.c),J.write_shift(2,j.s.r),J.write_shift(2,j.e.c),J.write_shift(2,j.e.r),J}function c(j,J,G){var W=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(W[0].c=j.read_shift(1),W[3]=j.read_shift(1),W[0].r=j.read_shift(2),j.l+=2):(W[2]=j.read_shift(1),W[0].c=j.read_shift(2),W[0].r=j.read_shift(2)),W}function f(j,J,G){var W=j.l+J,re=c(j,J,G);if(re[1].t="s",G.vers==20768){j.l++;var fe=j.read_shift(1);return re[1].v=j.read_shift(fe,"utf8"),re}return G.qpro&&j.l++,re[1].v=j.read_shift(W-j.l,"cstr"),re}function h(j,J,G){var W=Kt(7+G.length);W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,j),W.write_shift(1,39);for(var re=0;re<W.length;++re){var fe=G.charCodeAt(re);W.write_shift(1,fe>=128?95:fe)}return W.write_shift(1,0),W}function d(j,J,G){var W=c(j,J,G);return W[1].v=j.read_shift(2,"i"),W}function m(j,J,G){var W=Kt(7);return W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,j),W.write_shift(2,G,"i"),W}function g(j,J,G){var W=c(j,J,G);return W[1].v=j.read_shift(8,"f"),W}function v(j,J,G){var W=Kt(13);return W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,j),W.write_shift(8,G,"f"),W}function w(j,J,G){var W=j.l+J,re=c(j,J,G);if(re[1].v=j.read_shift(8,"f"),G.qpro)j.l=W;else{var fe=j.read_shift(2);O(j.slice(j.l,j.l+fe),re),j.l+=fe}return re}function T(j,J,G){var W=J&32768;return J&=-32769,J=(W?j:0)+(J>=8192?J-16384:J),(W?"":"$")+(G?Qt(J):mr(J))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(j,J){fr(j,0);for(var G=[],W=0,re="",fe="",Ee="",ge="";j.l<j.length;){var oe=j[j.l++];switch(oe){case 0:G.push(j.read_shift(8,"f"));break;case 1:fe=T(J[0].c,j.read_shift(2),!0),re=T(J[0].r,j.read_shift(2),!1),G.push(fe+re);break;case 2:{var be=T(J[0].c,j.read_shift(2),!0),U=T(J[0].r,j.read_shift(2),!1);fe=T(J[0].c,j.read_shift(2),!0),re=T(J[0].r,j.read_shift(2),!1),G.push(be+U+":"+fe+re)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(j.read_shift(2));break;case 6:{for(var Fe="";oe=j[j.l++];)Fe+=String.fromCharCode(oe);G.push('"'+Fe.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:ge=G.pop(),Ee=G.pop(),G.push(["AND","OR"][oe-20]+"("+Ee+","+ge+")");break;default:if(oe<32&&y[oe])ge=G.pop(),Ee=G.pop(),G.push(Ee+y[oe]+ge);else if(_[oe]){if(W=_[oe][1],W==69&&(W=j[j.l++]),W>G.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+G.join("|")+"|");return}var $e=G.slice(-W);G.length-=W,G.push(_[oe][0]+"("+$e.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}G.length==1?J[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function z(j){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=j.read_shift(2),J[3]=j[j.l++],J[0].c=j[j.l++],J}function B(j,J){var G=z(j);return G[1].t="s",G[1].v=j.read_shift(J-4,"cstr"),G}function E(j,J,G,W){var re=Kt(6+W.length);re.write_shift(2,j),re.write_shift(1,G),re.write_shift(1,J),re.write_shift(1,39);for(var fe=0;fe<W.length;++fe){var Ee=W.charCodeAt(fe);re.write_shift(1,Ee>=128?95:Ee)}return re.write_shift(1,0),re}function S(j,J){var G=z(j);G[1].v=j.read_shift(2);var W=G[1].v>>1;if(G[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return G[1].v=W,G}function k(j,J){var G=z(j),W=j.read_shift(4),re=j.read_shift(4),fe=j.read_shift(2);if(fe==65535)return W===0&&re===3221225472?(G[1].t="e",G[1].v=15):W===0&&re===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ee=fe&32768;return fe=(fe&32767)-16446,G[1].v=(1-Ee*2)*(re*Math.pow(2,fe+32)+W*Math.pow(2,fe)),G}function R(j,J,G,W){var re=Kt(14);if(re.write_shift(2,j),re.write_shift(1,G),re.write_shift(1,J),W==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var fe=0,Ee=0,ge=0,oe=0;return W<0&&(fe=1,W=-W),Ee=Math.log2(W)|0,W/=Math.pow(2,Ee-31),oe=W>>>0,oe&2147483648||(W/=2,++Ee,oe=W>>>0),W-=oe,oe|=2147483648,oe>>>=0,W*=Math.pow(2,32),ge=W>>>0,re.write_shift(4,ge),re.write_shift(4,oe),Ee+=16383+(fe?32768:0),re.write_shift(2,Ee),re}function b(j,J){var G=k(j);return j.l+=J-14,G}function D(j,J){var G=z(j),W=j.read_shift(4);return G[1].v=W>>6,G}function F(j,J){var G=z(j),W=j.read_shift(8,"f");return G[1].v=W,G}function _e(j,J){var G=F(j);return j.l+=J-10,G}function pe(j,J){return j[j.l+J-1]==0?j.read_shift(J,"cstr"):""}function Se(j,J){var G=j[j.l++];G>J-1&&(G=J-1);for(var W="";W.length<G;)W+=String.fromCharCode(j[j.l++]);return W}function ye(j,J,G){if(!(!G.qpro||J<21)){var W=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var re=j.read_shift(J-21,"cstr");return[W,re]}}function ie(j,J){for(var G={},W=j.l+J;j.l<W;){var re=j.read_shift(2);if(re==14e3){for(G[re]=[0,""],G[re][0]=j.read_shift(2);j[j.l];)G[re][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return G}function q(j,J){var G=Kt(5+j.length);G.write_shift(2,14e3),G.write_shift(2,J);for(var W=0;W<j.length;++W){var re=j.charCodeAt(W);G[G.l++]=re>127?95:re}return G[G.l++]=0,G}var ue={0:{n:"BOF",f:zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:Se},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function _b(t){var e={},r=t.match(Or),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=De(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=yg[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var wb=function(){var t=zc("t"),e=zc("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:Ze(i[1])},l=a.match(e);return l&&(o.s=_b(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),Eb=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Tb=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ab=/<(?:\w+:)?r>/,Sb=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Lg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(ut(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ut(t),r&&(n.h=kg(n.t))):t.match(Ab)&&(n.r=ut(t),n.t=Ze(ut((t.replace(Sb,"").match(Tb)||[]).join("").replace(Or,""))),r&&(n.h=Eb(wb(n.r)))),n):{t:""}}var kb=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ib=/<(?:\w+:)?(?:si|sstItem)>/g,Cb=/<\/(?:\w+:)?(?:si|sstItem)>/;function Nb(t,e){var r=[],n="";if(!t)return r;var s=t.match(kb);if(s){n=s[2].replace(Ib,"").split(Cb);for(var a=0;a!=n.length;++a){var i=Lg(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=De(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Rb(t){return[t.read_shift(4),t.read_shift(4)]}function Pb(t,e){var r=[],n=!1;return ea(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function HT(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Us(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function bb(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Us(t,4),e.U=Us(t,4),e.W=Us(t,4),e}function Db(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Fb(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Db(t));return e}function Ob(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Lb(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Us(t,4),e.U=Us(t,4),e.W=Us(t,4),e}function Mb(t){var e=Lb(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function WT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function GT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Vb(t){var e=Us(t);switch(e.Minor){case 2:return[e.Minor,jb(t)];case 3:return[e.Minor,Bb()];case 4:return[e.Minor,Ub(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function jb(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=WT(t,r),s=GT(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Bb(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ub(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Or,function(a){var i=De(a);switch(Ss(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function $b(t,e){var r={},n=r.EncryptionVersionInfo=Us(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=WT(t,s),e-=s,r.EncryptionVerifier=GT(t,e),r}function zb(t){var e={},r=e.EncryptionVersionInfo=Us(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Hb(t){var e=0,r,n=HT(t),s=n.length+1,a,i,o,l,c;for(r=Ua(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^i;return e^52811}var qT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=HT(i),l=a(o),c=o.length,f=Ua(16),h=0;h!=16;++h)f[h]=0;var d,m,g;for((c&1)===1&&(d=l>>8,f[c]=s(t[0],d),--c,d=l&255,m=o[o.length-1],f[c]=s(m,d));c>0;)--c,d=l>>8,f[c]=s(o[c],d),--c,d=l&255,f[c]=s(o[c],d);for(c=15,g=15-o.length;g>0;)d=l>>8,f[c]=s(t[g],d),--c,--g,d=l&255,f[c]=s(o[c],d),--c,--g;return f}}(),Wb=function(t,e,r,n,s){s||(s=e),n||(n=qT(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Gb=function(t){var e=0,r=qT(t);return function(n){var s=Wb("",n,e,r);return e=s[1],s[0]}};function qb(t,e,r,n){var s={key:zt(t),verificationBytes:zt(t)};return r.password&&(s.verifier=Hb(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Gb(r.password)),s}function Kb(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=zb(t):n.Data=$b(t,e),n}function Xb(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Kb(t,e-2,n):qb(t,r.biff>=8?e:e-2,r,n),n}var Yb=function(){function t(s,a){switch(a.type){case"base64":return e(pn(s),a);case"binary":return e(s,a);case"buffer":return e(Ke&&Buffer.isBuffer(s)?s.toString("binary"):Ui(s),a);case"array":return e(Ri(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,v=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var w=f.slice(m,d.lastIndex-g[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[h][v]=T:o[Me({r:h,c:v})]=T}break}m=d.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=Qe(c),o}function r(s,a){return Za(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=bt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Me({r:c,c:f});o=l?(s[c]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Ks(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Qb(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Gc(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Jb(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,c/2]}function Zb(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Eh(t,e){if(e===0)return t;var r=Jb(Qb(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Gc(Zb(r))}var KT=6,eD=15,tD=1,Ur=KT;function Th(t){return Math.floor((t+Math.round(128/Ur)/256)*Ur)}function Ah(t){return Math.floor((t-5)/Ur*100+.5)/100}function zp(t){return Math.round((t*Ur+5)/Ur*256)/256}function Td(t){return zp(Ah(Th(t)))}function Mg(t){var e=Math.abs(t-Td(t)),r=Ur;if(e>.005)for(Ur=tD;Ur<eD;++Ur)Math.abs(t-Td(t))<=e&&(e=Math.abs(t-Td(t)),r=Ur);Ur=r}function Qo(t){t.width?(t.wpx=Th(t.width),t.wch=Ah(t.wpx),t.MDW=Ur):t.wpx?(t.wch=Ah(t.wpx),t.width=zp(t.wch),t.MDW=Ur):typeof t.wch=="number"&&(t.width=zp(t.wch),t.wpx=Th(t.width),t.MDW=Ur),t.customWidth&&delete t.customWidth}var rD=96,XT=rD;function YT(t){return t*96/XT}function qc(t){return t*XT/96}var nD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function sD(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Or)||[]).forEach(function(i){var o=De(i);switch(Ss(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=_t(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=_t(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function aD(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Or)||[]).forEach(function(i){var o=De(i);switch(Ss(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function iD(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Or)||[]).forEach(function(i){var o=De(i);switch(Ss(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?_t(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?_t(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?_t(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?_t(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?_t(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?_t(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?_t(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=yg[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=_t(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Ei[s.color.index];s.color.index==81&&(l=Ei[1]),l||(l=Ei[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Eh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function oD(t,e,r){e.NumberFmt=[];for(var n=Es(Ue),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Ue[n[s]];var a=t[0].match(Or);if(a)for(s=0;s<a.length;++s){var i=De(a[s]);switch(Ss(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(ut(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}wi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var uf=["numFmtId","fillId","fontId","borderId","xfId"],ff=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lD(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Or)||[]).forEach(function(a){var i=De(a),o=0;switch(Ss(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<uf.length;++o)n[uf[o]]&&(n[uf[o]]=parseInt(n[uf[o]],10));for(o=0;o<ff.length;++o)n[ff[o]]&&(n[ff[o]]=_t(n[ff[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=_t(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var cD=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&oD(h,f,c),(h=o.match(s))&&iD(h,f,l,c),(h=o.match(n))&&aD(h,f,l,c),(h=o.match(a))&&sD(h,f,l,c),(h=o.match(r))&&lD(h,f,c),f}}();function uD(t,e){var r=t.read_shift(2),n=Pr(t);return[r,n]}function fD(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=w3(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=_3(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pr(t),n}var hD=Dr;function dD(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var pD=Dr;function mD(t,e,r){var n={};n.NumberFmt=[];for(var s in Ue)n.NumberFmt[s]=Ue[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ea(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],wi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Eh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(f);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var gD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xD(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Or)||[]).forEach(function(s){var a=De(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[gD.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function vD(){}function yD(){}var _D=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ED=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TD(t,e,r){e.themeElements={};var n;[["clrScheme",_D,xD],["fontScheme",wD,vD],["fmtScheme",ED,yD]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var AD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function QT(t,e){(!t||t.length===0)&&(t=SD());var r,n={};if(!(r=t.match(AD)))throw new Error("themeElements not found in theme");return TD(r[0],n,e),n.raw=t,n}function SD(t,e){var r=[lT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kD(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=oT(a,{type:"array"})}catch{return}var o=ln(i,"theme/theme/theme1.xml",!0);if(o)return QT(o,r)}}function ID(t){return t.read_shift(4)}function CD(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=ND(t,4);break;case 2:e.xclrValue=MT(t);break;case 3:e.xclrValue=ID(t);break;case 4:t.l+=4;break}return t.l+=8,e}function ND(t,e){return Dr(t,e)}function RD(t,e){return Dr(t,e)}function PD(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=CD(t);break;case 6:n[1]=RD(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function bD(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(PD(t,r-t.l));return{ixfe:n,ext:a}}function DD(t,e){e.forEach(function(r){switch(r[0]){}})}function FD(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Pr(t)}}function OD(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function LD(t){return t.l+=4,t.read_shift(4)!=0}function MD(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ea(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function VD(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Or,function(o){var l=De(o);switch(Ss(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function jD(t){var e=[];if(!t)return e;var r=1;return(t.match(Or)||[]).forEach(function(n){var s=De(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function BD(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Me(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function UD(t,e,r){var n=[];return ea(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function $D(t,e,r,n){if(!t)return t;var s=n||{},a=!1;ea(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function zD(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function Ey(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=$r(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=bt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Qe(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}a.c.push(f)})}function HD(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=De(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=$r(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Lg(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function WD(t,e){var r=[],n=!1,s={},a=0;return t.replace(Or,function(o,l){var c=De(o);switch(Ss(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function GD(t,e){var r=[],n=!1;return t.replace(Or,function(a){var i=De(a);switch(Ss(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function qD(t){var e={};e.iauthor=t.read_shift(4);var r=zi(t);return e.rfx=r.s,e.ref=Me(r.s),t.l+=16,e}var KD=Pr;function XD(t,e){var r=[],n=[],s={},a=!1;return ea(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var YD="application/vnd.ms-office.vbaProject";function QD(t){var e=Ye.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Ye.write(e)}function JD(){return{"!type":"dialog"}}function ZD(){return{"!type":"dialog"}}function eF(){return{"!type":"macro"}}function tF(){return{"!type":"macro"}}var Lo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,s+(o?"":"$")+Qt(f)+(l?"":"$")+mr(c)}return function(s,a){return e=a,s.replace(t,r)}}(),JT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rF=function(){return function(e,r){return e.replace(JT,function(n,s,a,i,o,l){var c=Rg(i)-(a?0:r.c),f=Ng(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":a?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function ZT(t,e){return t.replace(JT,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Qt(Rg(a)+e.c))+(i=="$"?i+o:mr(Ng(o)+e.r))})}function nF(t,e,r){var n=cl(e),s=n.s,a=$r(r),i={r:a.r-s.r,c:a.c-s.c};return ZT(t,i)}function sF(t){return t.length!=1}function Ty(t){return t.replace(/_xlfn\./g,"")}function Bt(t){t.l+=1}function $a(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function eA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tA(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=$a(t),o=$a(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function tA(t){var e=$a(t),r=$a(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function aF(t,e,r){if(r.biff<8)return tA(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=$a(t),i=$a(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function rA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return iF(t);var n=t.read_shift(r&&r.biff==12?4:2),s=$a(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function iF(t){var e=$a(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function oF(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lF(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return cF(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function cF(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function uF(t,e,r){var n=(t[t.l++]&96)>>5,s=eA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function fF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=eA(t,a,r);return[n,s,i]}function hF(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function dF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function pF(t,e,r){var n=(t[t.l++]&96)>>5,s=aF(t,e-1,r);return[n,s]}function mF(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ay(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function gF(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function xF(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vF(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function yF(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function _F(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function nA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function wF(t){return t.read_shift(2),nA(t)}function EF(t){return t.read_shift(2),nA(t)}function TF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=rA(t,0,r);return[n,s]}function AF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=lF(t,0,r);return[n,s]}function SF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=rA(t,0,r);return[n,s,a]}function kF(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[I6[s],iA[s],n]}function IF(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:CF(t);return[s,(a[0]===0?iA:k6)[a[1]]]}function CF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function NF(t,e,r){t.l+=r&&r.biff==2?3:4}function RF(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function PF(t){return t.l++,Hi[t.read_shift(1)]}function bF(t){return t.l++,t.read_shift(2)}function DF(t){return t.l++,t.read_shift(1)!==0}function FF(t){return t.l++,Nr(t)}function OF(t,e,r){return t.l++,fu(t,e-1,r)}function LF(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Hi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Nr(t);break;case 2:r[1]=Wi(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function MF(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?zi:h0)(t));return s}function VF(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=LF(t,r.biff);return i}function jF(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function BF(t,e,r){if(r.biff==5)return UF(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function UF(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function $F(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function zF(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function HF(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function WF(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var GF=Dr,qF=Dr,KF=Dr;function du(t,e,r){return t.l+=2,[oF(t)]}function Vg(t){return t.l+=6,[]}var XF=du,YF=Vg,QF=Vg,JF=du;function sA(t){return t.l+=2,[zt(t),t.read_shift(2)&1]}var ZF=du,e6=sA,t6=Vg,r6=du,n6=du,s6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function a6(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=s6[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function i6(t){return t.l+=2,[t.read_shift(4)]}function o6(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function l6(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function c6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function u6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function f6(t){return t.l+=4,[0,0]}var Sy={1:{n:"PtgExp",f:RF},2:{n:"PtgTbl",f:KF},3:{n:"PtgAdd",f:Bt},4:{n:"PtgSub",f:Bt},5:{n:"PtgMul",f:Bt},6:{n:"PtgDiv",f:Bt},7:{n:"PtgPower",f:Bt},8:{n:"PtgConcat",f:Bt},9:{n:"PtgLt",f:Bt},10:{n:"PtgLe",f:Bt},11:{n:"PtgEq",f:Bt},12:{n:"PtgGe",f:Bt},13:{n:"PtgGt",f:Bt},14:{n:"PtgNe",f:Bt},15:{n:"PtgIsect",f:Bt},16:{n:"PtgUnion",f:Bt},17:{n:"PtgRange",f:Bt},18:{n:"PtgUplus",f:Bt},19:{n:"PtgUminus",f:Bt},20:{n:"PtgPercent",f:Bt},21:{n:"PtgParen",f:Bt},22:{n:"PtgMissArg",f:Bt},23:{n:"PtgStr",f:OF},26:{n:"PtgSheet",f:o6},27:{n:"PtgEndSheet",f:l6},28:{n:"PtgErr",f:PF},29:{n:"PtgBool",f:DF},30:{n:"PtgInt",f:bF},31:{n:"PtgNum",f:FF},32:{n:"PtgArray",f:mF},33:{n:"PtgFunc",f:kF},34:{n:"PtgFuncVar",f:IF},35:{n:"PtgName",f:jF},36:{n:"PtgRef",f:TF},37:{n:"PtgArea",f:uF},38:{n:"PtgMemArea",f:$F},39:{n:"PtgMemErr",f:GF},40:{n:"PtgMemNoMem",f:qF},41:{n:"PtgMemFunc",f:zF},42:{n:"PtgRefErr",f:HF},43:{n:"PtgAreaErr",f:hF},44:{n:"PtgRefN",f:AF},45:{n:"PtgAreaN",f:pF},46:{n:"PtgMemAreaN",f:c6},47:{n:"PtgMemNoMemN",f:u6},57:{n:"PtgNameX",f:BF},58:{n:"PtgRef3d",f:SF},59:{n:"PtgArea3d",f:fF},60:{n:"PtgRefErr3d",f:WF},61:{n:"PtgAreaErr3d",f:dF},255:{}},h6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},d6={1:{n:"PtgElfLel",f:sA},2:{n:"PtgElfRw",f:r6},3:{n:"PtgElfCol",f:XF},6:{n:"PtgElfRwV",f:n6},7:{n:"PtgElfColV",f:JF},10:{n:"PtgElfRadical",f:ZF},11:{n:"PtgElfRadicalS",f:t6},13:{n:"PtgElfColS",f:YF},15:{n:"PtgElfColSV",f:QF},16:{n:"PtgElfRadicalLel",f:e6},25:{n:"PtgList",f:a6},29:{n:"PtgSxName",f:i6},255:{}},p6={0:{n:"PtgAttrNoop",f:f6},1:{n:"PtgAttrSemi",f:_F},2:{n:"PtgAttrIf",f:vF},4:{n:"PtgAttrChoose",f:gF},8:{n:"PtgAttrGoto",f:xF},16:{n:"PtgAttrSum",f:NF},32:{n:"PtgAttrBaxcel",f:Ay},33:{n:"PtgAttrBaxcel",f:Ay},64:{n:"PtgAttrSpace",f:wF},65:{n:"PtgAttrSpaceSemi",f:EF},128:{n:"PtgAttrIfError",f:yF},255:{}};function pu(t,e,r,n){if(n.biff<8)return Dr(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=VF(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=MF(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Dr(t,e)),a}function mu(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=Sy[a]||Sy[h6[a]],(a===24||a===25)&&(s=(a===24?d6:p6)[t[t.l+1]]),!s||!s.f?Dr(t,e):i.push([s.n,s.f(t,e,r)]);return i}function m6(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var g6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x6(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function aA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ky(t,e,r){var n=aA(t,e,r);return n=="#REF"?n:x6(n,r)}function kr(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,m,g="";if(!t[0]||!t[0][0])return"";for(var v=-1,w="",T=0,_=t[0].length;T<_;++T){var y=t[0][T];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:w=Pt(" ",t[0][v][1][1]);break;case 1:w=Pt("\r",t[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}c=c+w,v=-1}o.push(c+g6[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=lc(y[1][1],i,s),o.push(cc(f,a));break;case"PtgRefN":f=r?lc(y[1][1],r,s):y[1][1],o.push(cc(f,a));break;case"PtgRef3d":h=y[1][1],f=lc(y[1][2],i,s),g=ky(n,h,s),o.push(g+"!"+cc(f,a));break;case"PtgFunc":case"PtgFuncVar":var O=y[1][0],z=y[1][1];O||(O=0),O&=127;var B=O==0?[]:o.slice(-O);o.length-=O,z==="User"&&(z=B.shift()),o.push(z+"("+B.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":m=iy(y[1][1],r?{s:r}:i,s),o.push(wd(m,s));break;case"PtgArea":m=iy(y[1][1],i,s),o.push(wd(m,s));break;case"PtgArea3d":h=y[1][1],m=y[1][2],g=ky(n,h,s),o.push(g+"!"+wd(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],S=E?E.Name:"SH33TJSNAME"+String(d);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var k=y[1][1];d=y[1][2];var R;if(s.biff<=5)k<0&&(k=-k),n[k]&&(R=n[k][d]);else{var b="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(b=n.SheetNames[n[k][d].itab-1]+"!"):b=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])b+=n[k][d].Name;else if(n[0]&&n[0][d])b+=n[0][d].Name;else{var D=(aA(n,k,s)||"").split(";;");D[d-1]?b=D[d-1]:b+="SH33TJSERRX"}o.push(b);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var F="(",_e=")";if(v>=0){switch(w="",t[0][v][1][0]){case 2:F=Pt(" ",t[0][v][1][1])+F;break;case 3:F=Pt("\r",t[0][v][1][1])+F;break;case 4:_e=Pt(" ",t[0][v][1][1])+_e;break;case 5:_e=Pt("\r",t[0][v][1][1])+_e;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(F+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[Me(f)]){var Se=n.sharedf[Me(f)];o.push(kr(Se,i,pe,n,s))}else{var ye=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(kr(c[1],i,pe,n,s)),ye=!0;break}ye||o.push(y[1])}break;case"PtgArray":o.push("{"+m6(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ie.indexOf(t[0][T][0])==-1){y=t[0][v];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:w=Pt(" ",y[1][1]);break;case 5:q=!1;case 1:w=Pt("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((q?w:"")+o.pop()+(q?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function v6(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Dr(t,e-2)];var o=mu(t,i,r);return e!==i+s&&(a=pu(t,e-i-s,o,r)),t.l=n,[o,a]}function y6(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Dr(t,e-2)];var o=mu(t,i,r);return e!==i+s&&(a=pu(t,e-i-s,o,r)),t.l=n,[o,a]}function _6(t,e,r,n){var s=t.l+e,a=mu(t,n,r),i;return s!==t.l&&(i=pu(t,s-t.l,a,r)),[a,i]}function w6(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=mu(t,a,r);return a==65535?[[],Dr(t,e-2)]:(e!==a+2&&(s=pu(t,n-a-2,i,r)),[i,s])}function E6(t){var e;if(Ls(t,t.l+6)!==65535)return[Nr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Ad(t,e,r){var n=t.l+e,s=ks(t);r.biff==2&&++t.l;var a=E6(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=y6(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function d0(t,e,r){var n=t.read_shift(4),s=mu(t,n,r),a=t.read_shift(4),i=a>0?pu(t,a,s,r):null;return[s,i]}var T6=d0,p0=d0,A6=d0,S6=d0,k6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},I6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Iy(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Sd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var dc={},Mo={};function pc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function oA(t,e,r,n,s,a){try{n.cellNF&&(t.z=Ue[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=sr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ue[e]==null&&wi(CR[e]||"General",e),t.t==="e")t.w=t.w||Hi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$c(t.v);else if(t.t==="d"){var i=Wr(t.v);(i|0)===i?t.w=i.toString(10):t.w=$c(i)}else{if(t.v===void 0)return"";t.w=Ni(t.v,Mo)}else t.t==="d"?t.w=Pn(e,Wr(t.v),Mo):t.w=Pn(e,t.v,Mo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Eh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Eh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function C6(t,e){var r=bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Qe(r))}var N6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,R6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P6=/<(?:\w:)?hyperlink [^>]*>/mg,b6=/"(\w*:\w*)"/,D6=/<(?:\w:)?col\b[^>]*[\/]?>/g,F6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O6=/<(?:\w:)?pageMargins[^>]*\/>/g,lA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,L6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,M6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function V6(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(R6);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(lA);d?jg(d[0],o,s,r):(d=c.match(L6))&&j6(d[0],d[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=c.slice(m,m+50).match(b6);g&&C6(o,g[1])}var v=c.match(M6);v&&v[1]&&W6(v[1],s);var w=[];if(e.cellStyles){var T=c.match(D6);T&&$6(w,T)}h&&G6(h[1],o,e,l,a,i);var _=f.match(F6);_&&(o["!autofilter"]=z6(_[0]));var y=[],O=f.match(N6);if(O)for(m=0;m!=O.length;++m)y[m]=bt(O[m].slice(O[m].indexOf('"')+1));var z=f.match(P6);z&&B6(o,z,n);var B=f.match(O6);if(B&&(o["!margins"]=U6(De(B[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Qe(l)),e.sheetRows>0&&o["!ref"]){var E=bt(o["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Qe(E))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function jg(t,e,r,n){var s=De(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Ze(ut(s.codeName)))}function j6(t,e,r,n,s){jg(t.slice(0,t.indexOf(">")),r,n,s)}function B6(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=De(ut(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Ze(a.location))):(a.Target="#"+Ze(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=bt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Me({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=a)}}}function U6(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function $6(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=De(e[n],!0);s.hidden&&(s.hidden=_t(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Mg(s.width)),Qo(s);a<=i;)t[a++]=pr(s)}}function z6(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var H6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function W6(t,e){e.Views||(e.Views=[{}]),(t.match(H6)||[]).forEach(function(r,n){var s=De(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),_t(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var G6=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=zc("v"),i=zc("f");return function(l,c,f,h,d,m){for(var g=0,v="",w=[],T=[],_=0,y=0,O=0,z="",B,E,S=0,k=0,R,b,D=0,F=0,_e=Array.isArray(m.CellXf),pe,Se=[],ye=[],ie=Array.isArray(c),q=[],ue={},Te=!1,j=!!f.sheetStubs,J=l.split(e),G=0,W=J.length;G!=W;++G){v=J[G].trim();var re=v.length;if(re!==0){var fe=0;e:for(g=0;g<re;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(E=De(v.slice(fe,g),!0),S=E.r!=null?parseInt(E.r,10):S+1,k=-1,f.sheetRows&&f.sheetRows<S)continue;ue={},Te=!1,E.ht&&(Te=!0,ue.hpt=parseFloat(E.ht),ue.hpx=qc(ue.hpt)),E.hidden=="1"&&(Te=!0,ue.hidden=!0),E.outlineLevel!=null&&(Te=!0,ue.level=+E.outlineLevel),Te&&(q[S-1]=ue)}break;case"<":fe=g;break}if(fe>=g)break;if(E=De(v.slice(fe,g),!0),S=E.r!=null?parseInt(E.r,10):S+1,k=-1,!(f.sheetRows&&f.sheetRows<S)){h.s.r>S-1&&(h.s.r=S-1),h.e.r<S-1&&(h.e.r=S-1),f&&f.cellStyles&&(ue={},Te=!1,E.ht&&(Te=!0,ue.hpt=parseFloat(E.ht),ue.hpx=qc(ue.hpt)),E.hidden=="1"&&(Te=!0,ue.hidden=!0),E.outlineLevel!=null&&(Te=!0,ue.level=+E.outlineLevel),Te&&(q[S-1]=ue)),w=v.slice(g).split(t);for(var Ee=0;Ee!=w.length&&w[Ee].trim().charAt(0)=="<";++Ee);for(w=w.slice(Ee),g=0;g!=w.length;++g)if(v=w[g].trim(),v.length!==0){if(T=v.match(r),_=g,y=0,O=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,T!=null&&T.length===2){for(_=0,z=T[1],y=0;y!=z.length&&!((O=z.charCodeAt(y)-64)<1||O>26);++y)_=26*_+O;--_,k=_}else++k;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,E=De(v.slice(0,y),!0),E.r||(E.r=Me({r:S-1,c:k})),z=v.slice(y),B={t:""},(T=z.match(a))!=null&&T[1]!==""&&(B.v=Ze(T[1])),f.cellFormula){if((T=z.match(i))!=null&&T[1]!==""){if(B.f=Ze(ut(T[1])).replace(/\r\n/g,`
`),f.xlfn||(B.f=Ty(B.f)),T[0].indexOf('t="array"')>-1)B.F=(z.match(s)||[])[1],B.F.indexOf(":")>-1&&Se.push([bt(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){b=De(T[0]);var ge=Ze(ut(T[1]));f.xlfn||(ge=Ty(ge)),ye[parseInt(b.si,10)]=[b,ge,E.r]}}else(T=z.match(/<f[^>]*\/>/))&&(b=De(T[0]),ye[b.si]&&(B.f=nF(ye[b.si][1],ye[b.si][2],E.r)));var oe=$r(E.r);for(y=0;y<Se.length;++y)oe.r>=Se[y][0].s.r&&oe.r<=Se[y][0].e.r&&oe.c>=Se[y][0].s.c&&oe.c<=Se[y][0].e.c&&(B.F=Se[y][1])}if(E.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=E.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else R=dc[parseInt(B.v,10)],B.v=R.t,B.r=R.r,f.cellHTML&&(B.h=R.h);break;case"str":B.t="s",B.v=B.v!=null?ut(B.v):"",f.cellHTML&&(B.h=kg(B.v));break;case"inlineStr":T=z.match(n),B.t="s",T!=null&&(R=Lg(T[1]))?(B.v=R.t,f.cellHTML&&(B.h=R.h)):B.v="";break;case"b":B.v=_t(B.v);break;case"d":f.cellDates?B.v=sr(B.v,1):(B.v=Wr(sr(B.v,1)),B.t="n");break;case"e":(!f||f.cellText!==!1)&&(B.w=B.v),B.v=NT[B.v];break}if(D=F=0,pe=null,_e&&E.s!==void 0&&(pe=m.CellXf[E.s],pe!=null&&(pe.numFmtId!=null&&(D=pe.numFmtId),f.cellStyles&&pe.fillId!=null&&(F=pe.fillId))),oA(B,D,F,f,d,m),f.cellDates&&_e&&B.t=="n"&&ll(Ue[D])&&(B.t="d",B.v=f0(B.v)),E.cm&&f.xlmeta){var be=(f.xlmeta.Cell||[])[+E.cm-1];be&&be.type=="XLDAPR"&&(B.D=!0)}if(ie){var U=$r(E.r);c[U.r]||(c[U.r]=[]),c[U.r][U.c]=B}else c[E.r]=B}}}}q.length>0&&(c["!rows"]=q)}}();function q6(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var K6=zi;function X6(){}function Y6(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=v3(t),r}function Q6(t){var e=bn(t);return[e]}function J6(t){var e=$i(t);return[e]}function Z6(t){var e=bn(t),r=t.read_shift(1);return[e,r,"b"]}function eO(t){var e=$i(t),r=t.read_shift(1);return[e,r,"b"]}function tO(t){var e=bn(t),r=t.read_shift(1);return[e,r,"e"]}function rO(t){var e=$i(t),r=t.read_shift(1);return[e,r,"e"]}function nO(t){var e=bn(t),r=t.read_shift(4);return[e,r,"s"]}function sO(t){var e=$i(t),r=t.read_shift(4);return[e,r,"s"]}function aO(t){var e=bn(t),r=Nr(t);return[e,r,"n"]}function cA(t){var e=$i(t),r=Nr(t);return[e,r,"n"]}function iO(t){var e=bn(t),r=Dg(t);return[e,r,"n"]}function oO(t){var e=$i(t),r=Dg(t);return[e,r,"n"]}function lO(t){var e=bn(t),r=Pg(t);return[e,r,"is"]}function cO(t){var e=bn(t),r=Pr(t);return[e,r,"str"]}function uO(t){var e=$i(t),r=Pr(t);return[e,r,"str"]}function fO(t,e,r){var n=t.l+e,s=bn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=p0(t,n-t.l,r);i[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return i}function hO(t,e,r){var n=t.l+e,s=bn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=p0(t,n-t.l,r);i[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return i}function dO(t,e,r){var n=t.l+e,s=bn(t);s.r=r["!row"];var a=Nr(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=p0(t,n-t.l,r);i[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return i}function pO(t,e,r){var n=t.l+e,s=bn(t);s.r=r["!row"];var a=Pr(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=p0(t,n-t.l,r);i[3]=kr(o,null,s,r.supbooks,r)}else t.l=n;return i}var mO=zi;function gO(t,e){var r=t.l+e,n=zi(t),s=bg(t),a=Pr(t),i=Pr(t),o=Pr(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function xO(){}function vO(t,e,r){var n=t.l+e,s=kT(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=T6(t,n-t.l,r);i[1]=o}else t.l=n;return i}function yO(t,e,r){var n=t.l+e,s=zi(t),a=[s];if(r.cellFormula){var i=S6(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}var _O=["left","right","top","bottom","header","footer"];function wO(t){var e={};return _O.forEach(function(r){e[r]=Nr(t)}),e}function EO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function TO(){}function AO(){}function SO(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,g,v,w,T,_,y,O,z,B=[];o.biff=12,o["!row"]=0;var E=0,S=!1,k=[],R={},b=o.supbooks||s.supbooks||[[]];if(b.sharedf=R,b.arrayf=k,b.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=b,s.Names))for(var D=0;D<s.Names.length;++D)b[0][D+1]=s.Names[D];var F=[],_e=[],pe=!1;Sh[16]={n:"BrtShortReal",f:cA};var Se;if(ea(t,function(q,ue,Te){if(!d)switch(Te){case 148:c=q;break;case 0:m=q,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),O=mr(w=m.r),o["!row"]=m.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=qc(q.hpt)),_e[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:q[2]},q[2]){case"n":g.v=q[1];break;case"s":y=dc[q[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!q[1];break;case"e":g.v=q[1],o.cellText!==!1&&(g.w=Hi[g.v]);break;case"str":g.t="s",g.v=q[1];break;case"is":g.t="s",g.v=q[1].t;break}if((v=i.CellXf[q[0].iStyleRef])&&oA(g,v.numFmtId,null,o,a,i),T=q[0].c==-1?T+1:q[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=g):l[Qt(T)+O]=g,o.cellFormula){for(S=!1,E=0;E<k.length;++E){var j=k[E];m.r>=j[0].s.r&&m.r<=j[0].e.r&&T>=j[0].s.c&&T<=j[0].e.c&&(g.F=Qe(j[0]),S=!0)}!S&&q.length>3&&(g.f=q[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),o.cellDates&&v&&g.t=="n"&&ll(Ue[v.numFmtId])){var J=gi(g.v);J&&(g.t="d",g.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Se&&(Se.type=="XLDAPR"&&(g.D=!0),Se=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},T=q[0].c==-1?T+1:q[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=g):l[Qt(T)+O]=g,f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),Se&&(Se.type=="XLDAPR"&&(g.D=!0),Se=void 0);break;case 176:B.push(q);break;case 49:Se=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var G=n["!id"][q.relId];for(G?(q.Target=G.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=G):q.relId==""&&(q.Target="#"+q.loc),w=q.rfx.s.r;w<=q.rfx.e.r;++w)for(T=q.rfx.s.c;T<=q.rfx.e.c;++T)o.dense?(l[w]||(l[w]=[]),l[w][T]||(l[w][T]={t:"z",v:void 0}),l[w][T].l=q):(_=Me({c:T,r:w}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=q);break;case 426:if(!o.cellFormula)break;k.push(q),z=o.dense?l[w][T]:l[Qt(T)+O],z.f=kr(q[1],f,{r:m.r,c:T},b,o),z.F=Qe(q[0]);break;case 427:if(!o.cellFormula)break;R[Me(q[0].s)]=q[1],z=o.dense?l[w][T]:l[Qt(T)+O],z.f=kr(q[1],f,{r:m.r,c:T},b,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)F[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},pe||(pe=!0,Mg(q.w/256)),Qo(F[q.e+1]);break;case 161:l["!autofilter"]={ref:Qe(q)};break;case 476:l["!margins"]=q;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),q.name&&(s.Sheets[r].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),q.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Qe(c||f)),o.sheetRows&&l["!ref"]){var ye=bt(l["!ref"]);o.sheetRows<=+ye.e.r&&(ye.e.r=o.sheetRows-1,ye.e.r>f.e.r&&(ye.e.r=f.e.r),ye.e.r<ye.s.r&&(ye.s.r=ye.e.r),ye.e.c>f.e.c&&(ye.e.c=f.e.c),ye.e.c<ye.s.c&&(ye.s.c=ye.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Qe(ye))}return B.length>0&&(l["!merges"]=B),F.length>0&&(l["!cols"]=F),_e.length>0&&(l["!rows"]=_e),l}function kO(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=Ze((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function IO(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=kO(h);f.s.r=f.s.c=0,f.e.c=o,c=Qt(o),d[0].forEach(function(m,g){i[c+mr(g)]={t:"n",v:m,z:d[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Qe(f)),i}function CO(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(lA);return o&&jg(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function NO(t,e){t.l+=10;var r=Pr(t);return{name:r}}function RO(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ea(t,function(l,c,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var uA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PO=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],bO=[],DO=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cy(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=_t(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Ny(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=_t(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function fA(t){Ny(t.WBProps,uA),Ny(t.CalcPr,DO),Cy(t.WBView,PO),Cy(t.Sheets,bO),Mo.date1904=_t(t.WBProps.date1904)}var FO="][*?/\\".split("");function OO(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FO.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var LO=/<\w+:workbook/;function MO(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Or,function(l,c){var f=De(l);switch(Ss(f[0])){case"<?xml":break;case"<workbook":l.match(LO)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uA.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=_t(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=ut(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ze(ut(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=ut(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),_t(f.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=Ze(ut(t.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),t3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return fA(r),r}function VO(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Bp(t),r.name=Pr(t),r}function jO(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Pr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function BO(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function UO(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=y3(t),i=A6(t,0,r),o=bg(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function $O(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Sh[16]={n:"BrtFRTArchID$",f:BO},ea(t,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=kr(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),fA(r),r.Names=a,r.supbooks=i,r}function zO(t,e,r){return e.slice(-4)===".bin"?$O(t,r):MO(t,r)}function HO(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?SO(t,n,r,s,a,i,o):V6(t,n,r,s,a,i,o)}function WO(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?RO(t,n,r,s,a):CO(t,n,r,s,a)}function GO(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?eF():tF()}function qO(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?JD():ZD()}function KO(t,e,r,n){return e.slice(-4)===".bin"?mD(t,r,n):cD(t,r,n)}function XO(t,e,r){return QT(t,r)}function YO(t,e,r){return e.slice(-4)===".bin"?Pb(t,r):Nb(t,r)}function QO(t,e,r){return e.slice(-4)===".bin"?XD(t,r):HD(t,r)}function JO(t,e,r){return e.slice(-4)===".bin"?UD(t):jD(t)}function ZO(t,e,r,n){return r.slice(-4)===".bin"?$D(t,e,r,n):void 0}function e5(t,e,r){return e.slice(-4)===".bin"?MD(t,e,r):VD(t,e,r)}var hA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(hA),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(dA),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function t5(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(hA),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(dA),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var mc;function r5(t,e){var r=mc[t]||Ze(t);return r==="General"?Ni(e):Pn(r,e)}function n5(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=_t(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=sr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ze(e)]=s}function s5(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Hi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$c(t.v):t.w=Ni(t.v):t.w=r5(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=mc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&ll(n)){var s=gi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function a5(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=nD[n.Pattern]||n.Pattern)}t[e.ID]=e}function i5(t,e,r,n,s,a,i,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var m=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&m.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=_t(t);break;case"String":n.t="s",n.r=Qv(Ze(t)),n.v=t.indexOf("<")>-1?Ze(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(sr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=NT[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Qv(e||t));break}if(s5(n,f,c),c.cellFormula!==!1)if(n.Formula){var v=Ze(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Lo(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Lo("RC:RC",s):n.ArrayRange&&(n.F=Lo(n.ArrayRange,s),l.push([bt(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(m.forEach(function(w){!d.patternType&&w.patternType&&(d.patternType=w.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function o5(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function kd(t,e){var r=e||{};tT();var n=Bl(Ig(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ut(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=pr(r);return i.type="string",Wc.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ft){s.indexOf("<"+ft)>=0&&(a=!0)}),a)return g5(n,r);mc={"General Number":"General","General Date":Ue[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ue[15],"Short Date":Ue[14],"Long Time":Ue[19],"Medium Time":Ue[18],"Short Time":Ue[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ue[2],Standard:Ue[4],Percent:Ue[10],Scientific:Ue[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},m="",g={},v={},w=Mn('<Data ss:Type="String">'),T=0,_=0,y=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},B={},E="",S=0,k=[],R={},b={},D=0,F=[],_e=[],pe={},Se=[],ye,ie=!1,q=[],ue=[],Te={},j=0,J=0,G={Sheets:[],WBProps:{date1904:!1}},W={};Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=Hc.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?i5(n.slice(T,o.index),E,w,l[l.length-1][0]=="comment"?pe:g,{c:_,r:y},z,Se[_],v,q,r):(E="",w=Mn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(_e.length>0&&(g.c=_e),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][_]=g):d[Qt(_)+mr(y)]=g),g.HRef&&(g.l={Target:Ze(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(j=_+(parseInt(g.MergeAcross,10)|0),J=y+(parseInt(g.MergeDown,10)|0),k.push({s:{c:_,r:y},e:{c:j,r:J}})),!r.sheetStubs)g.MergeAcross?_=j+1:++_;else if(g.MergeAcross||g.MergeDown){for(var fe=_;fe<=j;++fe)for(var Ee=y;Ee<=J;++Ee)(fe>_||Ee>y)&&(r.dense?(d[Ee]||(d[Ee]=[]),d[Ee][fe]={t:"z"}):d[Qt(fe)+mr(Ee)]={t:"z"});_=j+1}else++_;else g=t5(o[0]),g.Index&&(_=+g.Index-1),_<O.s.c&&(O.s.c=_),_>O.e.c&&(O.e.c=_),o[0].slice(-2)==="/>"&&++_,_e=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<O.s.r&&(O.s.r=y),y>O.e.r&&(O.e.r=y),o[0].slice(-2)==="/>"&&(v=Mn(o[0]),v.Index&&(y=+v.Index-1)),_=0,++y):(v=Mn(o[0]),v.Index&&(y=+v.Index-1),Te={},(v.AutoFitHeight=="0"||v.Height)&&(Te.hpx=parseInt(v.Height,10),Te.hpt=YT(Te.hpx),ue[y]=Te),v.Hidden=="1"&&(Te.hidden=!0,ue[y]=Te));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(d["!ref"]=Qe(O),r.sheetRows&&r.sheetRows<=O.e.r&&(d["!fullref"]=d["!ref"],O.e.r=r.sheetRows-1,d["!ref"]=Qe(O))),k.length&&(d["!merges"]=k),Se.length>0&&(d["!cols"]=Se),ue.length>0&&(d["!rows"]=ue),f[m]=d}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=_=0,l.push([o[3],!1]),c=Mn(o[0]),m=Ze(c.Name),d=r.dense?[]:{},k=[],q=[],ue=[],W={name:m,Hidden:0},G.Sheets.push(W);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Se=[],ie=!1}break;case"style":o[1]==="/"?a5(z,B,r):B=Mn(o[0]);break;case"numberformat":B.nf=Ze(Mn(o[0]).Format||"General"),mc[B.nf]&&(B.nf=mc[B.nf]);for(var ge=0;ge!=392&&Ue[ge]!=B.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(Ue[ge]==null){wi(B.nf,ge);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ye=Mn(o[0]),ye.Hidden&&(ye.hidden=!0,delete ye.Hidden),ye.Width&&(ye.wpx=parseInt(ye.Width,10)),!ie&&ye.wpx>10){ie=!0,Ur=KT;for(var oe=0;oe<Se.length;++oe)Se[oe]&&Qo(Se[oe])}ie&&Qo(ye),Se[ye.Index-1||Se.length]=ye;for(var be=0;be<+ye.Span;++be)Se[Se.length]=pr(ye);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var U=De(o[0]),Fe={Name:U.Name,Ref:Lo(U.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Fe.Sheet=G.Sheets.length-1),G.Names.push(Fe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?H3(R,re,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));o5(pe),_e.push(pe)}else l.push([o[3],!1]),c=Mn(o[0]),pe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=Mn(o[0]);d["!autofilter"]={ref:Lo($e.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Oy(n,r);var et=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else D=o.index+o[0].length;break;case"header":d["!margins"]||pc(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].header=+De(o[0]).Margin);break;case"footer":d["!margins"]||pc(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var Be=De(o[0]);d["!margins"]||pc(d["!margins"]={},"xlml"),isNaN(+Be.Top)||(d["!margins"].top=+Be.Top),isNaN(+Be.Left)||(d["!margins"].left=+Be.Left),isNaN(+Be.Right)||(d["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(d["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?n5(b,re,F,n.slice(D,o.index)):(F=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=f),xe.SheetNames=h,xe.Workbook=G,xe.SSF=pr(Ue),xe.Props=R,xe.Custprops=b,xe}function Hp(t,e){switch($g(e=e||{}),e.type||"base64"){case"base64":return kd(pn(t),e);case"binary":case"buffer":case"file":return kd(t,e);case"array":return kd(Ui(t),e)}}function l5(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=E3(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=T3(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var c5=[60,1084,2066,2165,2175];function u5(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Ls(r,r.l),c=Wp[l],f=0;c!=null&&c5.indexOf(l)>-1;)a=Ls(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,c=Wp[l=Ls(r,r.l)];var h=ma(i);fr(h,0);var d=0;h.lens=[];for(var m=0;m<i.length;++m)h.lens.push(d),d+=i[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function is(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ue[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Hi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$c(t.v):t.w=Ni(t.v):t.w=Pn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&ll(Ue[n]||String(n))){var s=gi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function hf(t,e,r){return{v:t,ixfe:e,t:r}}function f5(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],c="",f={},h,d="",m,g,v,w,T={},_=[],y,O,z=[],B=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},k=function(je){return je<8?Ei[je]:je<64&&B[je-8]||Ei[je]},R=function(je,ht,jt){var vt=ht.XF.data;if(!(!vt||!vt.patternType||!jt||!jt.cellStyles)){ht.s={},ht.s.patternType=vt.patternType;var xn;(xn=Gc(k(vt.icvFore)))&&(ht.s.fgColor={rgb:xn}),(xn=Gc(k(vt.icvBack)))&&(ht.s.bgColor={rgb:xn})}},b=function(je,ht,jt){if(!(Te>1)&&!(jt.sheetRows&&je.r>=jt.sheetRows)){if(jt.cellStyles&&ht.XF&&ht.XF.data&&R(je,ht,jt),delete ht.ixfe,delete ht.XF,h=je,d=Me(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),jt.cellFormula&&ht.f){for(var vt=0;vt<_.length;++vt)if(!(_[vt][0].s.c>je.c||_[vt][0].s.r>je.r)&&!(_[vt][0].e.c<je.c||_[vt][0].e.r<je.r)){ht.F=Qe(_[vt][0]),(_[vt][0].s.c!=je.c||_[vt][0].s.r!=je.r)&&delete ht.f,ht.f&&(ht.f=""+kr(_[vt][1],i,je,q,D));break}}jt.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=ht):s[d]=ht}},D={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var F,_e=[],pe=[],Se=[],ye=[],ie=!1,q=[];q.SheetNames=D.snames,q.sharedf=D.sharedf,q.arrayf=D.arrayf,q.names=[],q.XTI=[];var ue=0,Te=0,j=0,J=[],G=[],W;D.codepage=1200,Wn(1200);for(var re=!1;t.l<t.length-1;){var fe=t.l,Ee=t.read_shift(2);if(Ee===0&&ue===10)break;var ge=t.l===t.length?0:t.read_shift(2),oe=Wp[Ee];if(oe&&oe.f){if(e.bookSheets&&ue===133&&Ee!==133)break;if(ue=Ee,oe.r===2||oe.r==12){var be=t.read_shift(2);if(ge-=2,!D.enc&&be!==Ee&&((be&255)<<8|be>>8)!==Ee)throw new Error("rt mismatch: "+be+"!="+Ee);oe.r==12&&(t.l+=10,ge-=10)}var U={};if(Ee===10?U=oe.f(t,ge,D):U=u5(Ee,oe,t,ge,D),Te==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(Ee){case 34:r.opts.Date1904=E.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=U;break;case 66:var Fe=Number(U);switch(Fe){case 21010:Fe=1200;break;case 32768:Fe=1e4;break;case 32769:Fe=1252;break}Wn(D.codepage=Fe),re=!0;break;case 317:D.rrtabid=U;break;case 25:D.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:D.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(s["!type"]="dialog"),U.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),U.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:z.push(U);break;case 430:q.push([U]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(U);break;case 24:case 536:W={Name:U.Name,Ref:kr(U.rgce,i,null,q,D)},U.itab>0&&(W.Sheet=U.itab-1),q.names.push(W),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(G[U.itab-1]={ref:Qe(U.rgce[0][0][1][2])});break;case 22:D.ExternCount=U;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(U),q.XTI=q.XTI.concat(U);break;case 2196:if(D.biff<8)break;W!=null&&(W.Comment=U[1]);break;case 18:s["!protect"]=U;break;case 19:U!==0&&D.WTF&&console.error("Password verifier: "+U);break;case 133:a[U.pos]=U,D.snames.push(U.name);break;case 10:{if(--Te)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Qe(i),e.sheetRows&&e.sheetRows<=i.e.r){var $e=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Qe(i),i.e.r=$e}i.e.r++,i.e.c++}_e.length>0&&(s["!merges"]=_e),pe.length>0&&(s["!objects"]=pe),Se.length>0&&(s["!cols"]=Se),ye.length>0&&(s["!rows"]=ye),E.Sheets.push(S)}c===""?f=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),D.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(D.biff=5,re=!0,Wn(D.codepage=28591)),D.biff==8&&U.BIFFVer==0&&U.dt==16&&(D.biff=2),Te++)break;if(s=e.dense?[]:{},D.biff<8&&!re&&(re=!0,Wn(D.codepage=e.codepage||1252)),D.biff<5||U.BIFFVer==0&&U.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:t.l-ge,name:c};a[et.pos]=et,D.snames.push(c)}else c=(a[fe]||{name:""}).name;U.dt==32&&(s["!type"]="chart"),U.dt==64&&(s["!type"]="macro"),_e=[],pe=[],D.arrayf=_=[],Se=[],ye=[],ie=!1,S={Hidden:(a[fe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[U.r]||[])[U.c]:s[Me({c:U.c,r:U.r})])&&++U.c,y={ixfe:U.ixfe,XF:z[U.ixfe]||{},v:U.val,t:"n"},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e);break;case 5:case 517:y={ixfe:U.ixfe,XF:z[U.ixfe],v:U.val,t:U.t},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e);break;case 638:y={ixfe:U.ixfe,XF:z[U.ixfe],v:U.rknum,t:"n"},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e);break;case 189:for(var Be=U.c;Be<=U.C;++Be){var xe=U.rkrec[Be-U.c][0];y={ixfe:xe,XF:z[xe],v:U.rkrec[Be-U.c][1],t:"n"},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:Be,r:U.r},y,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(y=hf(U.val,U.cell.ixfe,U.tt),y.XF=z[y.ixfe],e.cellFormula){var ft=U.formula;if(ft&&ft[0]&&ft[0][0]&&ft[0][0][0]=="PtgExp"){var Vt=ft[0][0][1][0],ar=ft[0][0][1][1],ir=Me({r:Vt,c:ar});T[ir]?y.f=""+kr(U.formula,i,U.cell,q,D):y.F=((e.dense?(s[Vt]||[])[ar]:s[ir])||{}).F}else y.f=""+kr(U.formula,i,U.cell,q,D)}j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b(U.cell,y,e),o=U}break;case 7:case 519:if(o)o.val=U,y=hf(U,o.cell.ixfe,"s"),y.XF=z[y.ixfe],e.cellFormula&&(y.f=""+kr(o.formula,i,o.cell,q,D)),j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(U);var Dn=Me(U[0].s);if(m=e.dense?(s[U[0].s.r]||[])[U[0].s.c]:s[Dn],e.cellFormula&&m){if(!o||!Dn||!m)break;m.f=""+kr(U[1],i,U[0],q,D),m.F=Qe(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Me(o.cell)]=U[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Me(o.cell)],(m||{}).f=""+kr(U[0],i,h,q,D)}}break;case 253:y=hf(l[U.isst].t,U.ixfe,"s"),l[U.isst].h&&(y.h=l[U.isst].h),y.XF=z[y.ixfe],j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:U.ixfe,XF:z[U.ixfe],t:"z"},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e));break;case 190:if(e.sheetStubs)for(var or=U.c;or<=U.C;++or){var It=U.ixfe[or-U.c];y={ixfe:It,XF:z[It],t:"z"},j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:or,r:U.r},y,e)}break;case 214:case 516:case 4:y=hf(U.val,U.ixfe,"s"),y.XF=z[y.ixfe],j>0&&(y.z=J[y.ixfe>>8&63]),is(y,e,r.opts.Date1904),b({c:U.c,r:U.r},y,e);break;case 0:case 512:Te===1&&(i=U);break;case 252:l=U;break;case 1054:if(D.biff==4){J[j++]=U[1];for(var Lr=0;Lr<j+163&&Ue[Lr]!=U[1];++Lr);Lr>=163&&wi(U[1],j+163)}else wi(U[1],U[0]);break;case 30:{J[j++]=U;for(var nt=0;nt<j+163&&Ue[nt]!=U;++nt);nt>=163&&wi(U,j+163)}break;case 229:_e=_e.concat(U);break;case 93:pe[U.cmo[0]]=D.lastobj=U;break;case 438:D.lastobj.TxO=U;break;case 127:D.lastobj.ImData=U;break;case 440:for(w=U[0].s.r;w<=U[0].e.r;++w)for(v=U[0].s.c;v<=U[0].e.c;++v)m=e.dense?(s[w]||[])[v]:s[Me({c:v,r:w})],m&&(m.l=U[1]);break;case 2048:for(w=U[0].s.r;w<=U[0].e.r;++w)for(v=U[0].s.c;v<=U[0].e.c;++v)m=e.dense?(s[w]||[])[v]:s[Me({c:v,r:w})],m&&m.l&&(m.l.Tooltip=U[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(s[U[0].r]||[])[U[0].c]:s[Me(U[0])];var xt=pe[U[2]];m||(e.dense?(s[U[0].r]||(s[U[0].r]=[]),m=s[U[0].r][U[0].c]={t:"z"}):m=s[Me(U[0])]={t:"z"},i.e.r=Math.max(i.e.r,U[0].r),i.s.r=Math.min(i.s.r,U[0].r),i.e.c=Math.max(i.e.c,U[0].c),i.s.c=Math.min(i.s.c,U[0].c)),m.c||(m.c=[]),g={a:U[1],t:xt.TxO.t},m.c.push(g)}break;case 2173:DD(z[U.ixfe],U.ext);break;case 125:{if(!D.cellStyles)break;for(;U.e>=U.s;)Se[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},ie||(ie=!0,Mg(U.w/256)),Qo(Se[U.e+1])}break;case 520:{var Ct={};U.level!=null&&(ye[U.r]=Ct,Ct.level=U.level),U.hidden&&(ye[U.r]=Ct,Ct.hidden=!0),U.hpt&&(ye[U.r]=Ct,Ct.hpt=U.hpt,Ct.hpx=qc(U.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||pc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=U;break;case 161:s["!margins"]||pc(s["!margins"]={}),s["!margins"].header=U.header,s["!margins"].footer=U.footer;break;case 574:U.RTL&&(E.Views[0].RTL=!0);break;case 146:B=U;break;case 2198:F=U;break;case 140:O=U;break;case 442:c?S.CodeName=U||S.name:E.WBProps.CodeName=U||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=ge}return r.SheetNames=Es(a).sort(function(Mr,je){return Number(Mr)-Number(je)}).map(function(Mr){return a[Mr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&G.forEach(function(Mr,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Mr}),r.Strings=l,r.SSF=pr(Ue),D.enc&&(r.Encryption=D.enc),F&&(r.Themes=F),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),q.names.length>0&&(E.Names=q.names),r.Workbook=E,r}var Ry={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function h5(t,e,r){var n=Ye.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=dy(n,N3,Ry.DSI);for(var a in s)e[a]=s[a]}catch(c){if(r.WTF)throw c}var i=Ye.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=dy(i,R3,Ry.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(PT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function pA(t,e){e||(e={}),$g(e),z2(),e.codepage&&_g(e.codepage);var r,n;if(t.FullPaths){if(Ye.find(t,"/encryption"))throw new Error("File is password-protected");r=Ye.find(t,"!CompObj"),n=Ye.find(t,"/Workbook")||Ye.find(t,"/Book")}else{switch(e.type){case"base64":t=Hn(pn(t));break;case"binary":t=Hn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}fr(t,0),n={content:t}}var s,a;if(r&&l5(r),e.bookProps&&!e.bookSheets)s={};else{var i=Ke?"buffer":"array";if(n&&n.content)s=f5(n.content,e);else if((a=Ye.find(t,"PerfectOffice_MAIN"))&&a.content)s=hc.to_workbook(a.content,(e.type=i,e));else if((a=Ye.find(t,"NativeContent_MAIN"))&&a.content)s=hc.to_workbook(a.content,(e.type=i,e));else throw(a=Ye.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ye.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=QD(t))}var o={};return t.FullPaths&&h5(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Sh={0:{f:q6},1:{f:Q6},2:{f:iO},3:{f:tO},4:{f:Z6},5:{f:aO},6:{f:cO},7:{f:nO},8:{f:pO},9:{f:dO},10:{f:fO},11:{f:hO},12:{f:J6},13:{f:oO},14:{f:rO},15:{f:eO},16:{f:cA},17:{f:uO},18:{f:sO},19:{f:Pg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UO},40:{},42:{},43:{f:fD},44:{f:uD},45:{f:hD},46:{f:pD},47:{f:dD},48:{},49:{f:m3},50:{},51:{f:OD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zT},62:{f:lO},63:{f:BD},64:{f:TO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Y6},148:{f:K6,p:16},151:{f:xO},152:{},153:{f:jO},154:{},155:{},156:{f:VO},157:{},158:{},159:{T:1,f:Rb},160:{T:-1},161:{T:1,f:zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FD},336:{T:-1},337:{f:LD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$T},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vO},427:{f:yO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:X6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:KD},633:{T:1},634:{T:-1},635:{T:1,f:qD},636:{T:-1},637:{f:x3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:NO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wp={6:{f:Ad},10:{f:ca},12:{f:zt},13:{f:zt},14:{f:Dt},15:{f:Dt},16:{f:Nr},17:{f:Dt},18:{f:Dt},19:{f:zt},20:{f:xy},21:{f:xy},23:{f:$T},24:{f:yy},25:{f:Dt},26:{},27:{},28:{f:WP},29:{},34:{f:Dt},35:{f:vy},38:{f:Nr},39:{f:Nr},40:{f:Nr},41:{f:Nr},42:{f:Dt},43:{f:Dt},47:{f:Xb},49:{f:kP},51:{f:zt},60:{},61:{f:TP},64:{f:Dt},65:{f:SP},66:{f:zt},77:{},80:{},81:{},82:{},85:{f:zt},89:{},90:{},91:{},92:{f:mP},93:{f:qP},94:{},95:{f:Dt},96:{},97:{},99:{f:Dt},125:{f:zT},128:{f:LP},129:{f:gP},130:{f:zt},131:{f:Dt},132:{f:Dt},133:{f:xP},134:{},140:{f:ZP},141:{f:zt},144:{},146:{f:tb},151:{},152:{},153:{},154:{},155:{},156:{f:zt},157:{},158:{},160:{f:ib},161:{f:nb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:bP},190:{f:DP},193:{f:ca},197:{},198:{},199:{},200:{},201:{},202:{f:Dt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:zt},220:{},221:{f:Dt},222:{},224:{f:OP},225:{f:pP},226:{f:ca},227:{},229:{f:GP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:vP},253:{f:IP},255:{f:yP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dt},353:{f:ca},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VP},431:{f:Dt},432:{},433:{},434:{},437:{},438:{f:YP},439:{f:Dt},440:{f:QP},441:{},442:{f:hu},443:{},444:{f:zt},445:{},446:{},448:{f:ca},449:{f:EP,r:2},450:{f:ca},512:{f:my},513:{f:ab},515:{f:MP},516:{f:CP},517:{f:gy},519:{f:ob},520:{f:_P},523:{},545:{f:_y},549:{f:py},566:{},574:{f:AP},638:{f:PP},659:{},1048:{},1054:{f:NP},1084:{},1212:{f:$P},2048:{f:JP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:cf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ca},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:rb,r:12},2173:{f:bD,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:UP,r:12},2197:{},2198:{f:kD,r:12},2199:{},2200:{},2201:{},2202:{f:zP,r:12},2203:{f:ca},2204:{},2205:{},2206:{},2207:{},2211:{f:wP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eb},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:my},1:{},2:{f:fb},3:{f:ub},4:{f:cb},5:{f:gy},7:{f:hb},8:{},9:{f:cf},11:{},22:{f:zt},30:{f:RP},31:{},32:{},33:{f:_y},36:{},37:{f:py},50:{f:db},62:{},52:{},67:{},68:{f:zt},69:{},86:{},126:{},127:{f:lb},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pb},223:{},234:{},354:{},421:{},518:{f:Ad},521:{f:cf},536:{f:yy},547:{f:vy},561:{},579:{},1030:{f:Ad},1033:{f:cf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vn(t,e,r,n){var s=e;if(!isNaN(s)){var a=(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&TT(r)&&t.push(r)}}function Py(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=MR(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var T=v.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var _=T[o].trim();if(_.match(/<t[dh]/i)){for(var y=_,O=0;y.charAt(0)=="<"&&(O=y.indexOf(">"))>-1;)y=y.slice(O+1);for(var z=0;z<g.length;++z){var B=g[z];B.s.c==f&&B.s.r<c&&c<=B.e.r&&(f=B.e.c+1,z=-1)}var E=De(_.slice(0,_.indexOf(">")));d=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||d>1)&&g.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var S=E.t||E["data-t"]||"";if(!y.length){f+=d;continue}if(y=uT(y),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!y.length){f+=d;continue}var k={t:"s",v:y};r.raw||!y.trim().length||S=="s"||(y==="TRUE"?k={t:"b",v:!0}:y==="FALSE"?k={t:"b",v:!1}:isNaN(Yn(y))?isNaN(Yo(y).getDate())||(k={t:"d",v:sr(y)},r.cellDates||(k={t:"n",v:Wr(k.v)}),k.z=r.dateNF||Ue[14]):k={t:"n",v:Yn(y)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=k):n[Me({r:c,c:f})]=k,f+=d}}}}return n["!ref"]=Qe(m),g.length&&(n["!merges"]=g),n}function d5(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var f=Me({r,c:i}),h=n.dense?(t[r]||[])[i]:t[f],d=h&&h.v!=null&&(h.h||kg(h.w||(Ks(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,a.push(ZR("td",d,m))}}var g="<tr>";return g+a.join("")+"</tr>"}var p5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',m5="</body></html>";function g5(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Za(Py(r[0],e),e);var n=Hg();return r.forEach(function(s,a){Wg(n,Py(s,e),"Sheet"+(a+1))}),n}function x5(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function v5(t,e){var r=e||{},n=r.header!=null?r.header:p5,s=r.footer!=null?r.footer:m5,a=[n],i=cl(t["!ref"]);r.dense=Array.isArray(t),a.push(x5(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(d5(t,i,o,r));return a.push("</table>"+s),a.join("")}function mA(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?$r(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var f=cl(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),g=0,v=0,w=0,T=0,_=0,y=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&v<l;++g){var O=o[g];if(by(O)){if(n.display)continue;m[v]={hidden:!0}}var z=O.children;for(w=T=0;w<z.length;++w){var B=z[w];if(!(n.display&&by(B))){var E=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):uT(B.innerHTML),S=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==T+a&&k.s.r<v+s&&v+s<=k.e.r&&(T=k.e.c+1-a,d=-1)}y=+B.getAttribute("colspan")||1,((_=+B.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:v+s,c:T+a},e:{r:v+s+(_||1)-1,c:T+a+(y||1)-1}});var R={t:"s",v:E},b=B.getAttribute("data-t")||B.getAttribute("t")||"";E!=null&&(E.length==0?R.t=b||"z":n.raw||E.trim().length==0||b=="s"||(E==="TRUE"?R={t:"b",v:!0}:E==="FALSE"?R={t:"b",v:!1}:isNaN(Yn(E))?isNaN(Yo(E).getDate())||(R={t:"d",v:sr(E)},n.cellDates||(R={t:"n",v:Wr(R.v)}),R.z=n.dateNF||Ue[14]):R={t:"n",v:Yn(E)})),R.z===void 0&&S!=null&&(R.z=S);var D="",F=B.getElementsByTagName("A");if(F&&F.length)for(var _e=0;_e<F.length&&!(F[_e].hasAttribute("href")&&(D=F[_e].getAttribute("href"),D.charAt(0)!="#"));++_e);D&&D.charAt(0)!="#"&&(R.l={Target:D}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][T+a]=R):t[Me({c:T+a,r:v+s})]=R,c.e.c<T+a&&(c.e.c=T+a),T+=y}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+s),t["!ref"]=Qe(c),v>=l&&(t["!fullref"]=Qe((c.e.r=o.length-g+v-1+s,c))),t}function gA(t,e){var r=e||{},n=r.dense?[]:{};return mA(n,t,e)}function y5(t,e){return Za(gA(t,e),e)}function by(t){var e="",r=_5(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function _5(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function w5(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(e.replace(/<[^>]*>/g,""));return[r]}var Dy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xA(t,e){var r=e||{},n=Ig(t),s=[],a,i,o={name:""},l="",c=0,f,h,d={},m=[],g=r.dense?[]:{},v,w,T={value:""},_="",y=0,O=[],z=-1,B=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},R=[],b={},D=0,F=0,_e=[],pe=1,Se=1,ye=[],ie={Names:[]},q={},ue=["",""],Te=[],j={},J="",G=0,W=!1,re=!1,fe=0;for(Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Hc.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=Qe(E):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=r.sheetRows-1,g["!ref"]=Qe(E)),R.length&&(g["!merges"]=R),_e.length&&(g["!rows"]=_e),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),d[f.name]=g,re=!1):v[0].charAt(v[0].length-2)!=="/"&&(f=De(v[0],!1),z=B=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=r.dense?[]:{},R=[],_e=[],re=!0);break;case"table-row-group":v[1]==="/"?--S:++S;break;case"table-row":case"":if(v[1]==="/"){z+=pe,pe=1;break}if(h=De(v[0],!1),h.?z=h.-1:z==-1&&(z=0),pe=+h["number-rows-repeated"]||1,pe<10)for(fe=0;fe<pe;++fe)S>0&&(_e[z+fe]={level:S});B=-1;break;case"covered-table-cell":v[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(g[z]||(g[z]=[]),g[z][B]={t:"z"}):g[Me({r:z,c:B})]={t:"z"}),_="",O=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++B,T=De(v[0],!1),Se=parseInt(T["number-columns-repeated"]||"1",10),w={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(w.f=Iy(Ze(T.formula))),(T.||T["value-type"])=="string"&&(w.t="s",w.v=Ze(T["string-value"]||""),r.dense?(g[z]||(g[z]=[]),g[z][B]=w):g[Me({r:z,c:B})]=w),B+=Se-1;else if(v[1]!=="/"){++B,_="",y=0,O=[],Se=1;var Ee=pe?z+pe-1:z;if(B>E.e.c&&(E.e.c=B),B<E.s.c&&(E.s.c=B),z<E.s.r&&(E.s.r=z),Ee>E.e.r&&(E.e.r=Ee),T=De(v[0],!1),Te=[],j={},w={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Ze(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(D=parseInt(T["number-matrix-rows-spanned"],10)||0,F=parseInt(T["number-matrix-columns-spanned"],10)||0,b={s:{r:z,c:B},e:{r:z+D-1,c:B+F-1}},w.F=Qe(b),ye.push([b,w.F])),T.formula)w.f=Iy(T.formula);else for(fe=0;fe<ye.length;++fe)z>=ye[fe][0].s.r&&z<=ye[fe][0].e.r&&B>=ye[fe][0].s.c&&B<=ye[fe][0].e.c&&(w.F=ye[fe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(D=parseInt(T["number-rows-spanned"],10)||0,F=parseInt(T["number-columns-spanned"],10)||0,b={s:{r:z,c:B},e:{r:z+D-1,c:B+F-1}},R.push(b)),T["number-columns-repeated"]&&(Se=parseInt(T["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=_t(T["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(T.value);break;case"percentage":w.t="n",w.v=parseFloat(T.value);break;case"currency":w.t="n",w.v=parseFloat(T.value);break;case"date":w.t="d",w.v=sr(T["date-value"]),r.cellDates||(w.t="n",w.v=Wr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=FR(T["time-value"])/86400,r.cellDates&&(w.t="d",w.v=f0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(T.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",T["string-value"]!=null&&(_=Ze(T["string-value"]),O=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(W=!1,w.t==="s"&&(w.v=_||"",O.length&&(w.R=O),W=y==0),q.Target&&(w.l=q),Te.length>0&&(w.c=Te,Te=[]),_&&r.cellText!==!1&&(w.w=_),W&&(w.t="z",delete w.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var ge=0;ge<pe;++ge){if(Se=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(g[z+ge]||(g[z+ge]=[]),g[z+ge][B]=ge==0?w:pr(w);--Se>0;)g[z+ge][B+Se]=pr(w);else for(g[Me({r:z+ge,c:B})]=w;--Se>0;)g[Me({r:z+ge,c:B+Se})]=pr(w);E.e.c<=B&&(E.e.c=B)}Se=parseInt(T["number-columns-repeated"]||"1",10),B+=Se-1,Se=0,w={},_="",O=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;j.t=_,O.length&&(j.R=O),j.a=J,Te.push(j)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);J="",G=0,_="",y=0,O=[];break;case"creator":v[1]==="/"?J=n.slice(G,v.index):G=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);_="",y=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(k[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=De(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=De(v[0],!1),l+=Dy[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=De(v[0],!1),l+=Dy[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":i=De(v[0],!1),ue=Sd(i["cell-range-address"]);var oe={Name:i.name,Ref:ue[0]+"!"+ue[1]};re&&(oe.Sheet=m.length),ie.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!T||!T["string-value"])){var be=w5(n.slice(y,v.index));_=(_.length>0?_+`
`:"")+be[0]}else De(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ue=Sd(De(v[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(q=De(v[0],!1),!q.href)break;q.Target=Ze(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ue=Sd(q.Target.slice(1)),q.Target="#"+ue[0]+"!"+ue[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var U={Sheets:d,SheetNames:m,Workbook:ie};return r.bookSheets&&delete U.Sheets,U}function Fy(t,e){e=e||{},_n(t,"META-INF/manifest.xml")&&M3($t(t,"META-INF/manifest.xml"),e);var r=ln(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=xA(ut(r),e);return _n(t,"meta.xml")&&(n.Props=RT($t(t,"meta.xml"))),n}function Oy(t,e){return xA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Bg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Gp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ut(Ui(t))}function qp(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Ly(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function E5(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Kc(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Jt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Rr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Kc(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Kc(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Ug(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function T5(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Kc(t,n),a=Rr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Jt(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Rr(o.data),c=Jt(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=a[3])!=null&&e[0]&&(i.merge=Jt(a[3][0].data)>>>0>0),r.push(i)}return r}function A5(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Kc(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[qp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var f=qp(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function S5(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(A5(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return qp(e)}function k5(t,e,r,n){var s=Bg(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Ly(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Ly(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function I5(t,e,r){var n=Bg(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);s&1&&(l=E5(t,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function C5(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return k5(t,e,r,t[0]);case 5:return I5(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Da(t){var e=Rr(t);return Kc(e[1][0].data)}function My(t,e){var r=Rr(e.data),n=Jt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Rr(i.data),l=Jt(o[1][0].data)>>>0;switch(n){case 1:a[l]=Gp(o[3][0].data);break;case 8:{var c=t[Da(o[9][0].data)][0],f=Rr(c.data),h=t[Da(f[1][0].data)][0],d=Jt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=Rr(h.data);a[l]=m[3].map(function(g){return Gp(g.data)}).join("")}break}}),a}function N5(t,e){var r,n,s,a,i,o,l,c,f,h,d,m,g,v,w=Rr(t),T=Jt(w[1][0].data)>>>0,_=Jt(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Jt(w[8][0].data)>0||!1,O,z;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&e!=0)O=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,z=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&e!=1)O=(m=(d=w[4])==null?void 0:d[0])==null?void 0:m.data,z=(v=(g=w[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=y?4:1,E=Bg(O),S=[],k=0;k<O.length/2;++k){var R=E.getUint16(k*2,!0);R<65535&&S.push([k,R])}if(S.length!=_)throw"Expected ".concat(_," cells, found ").concat(S.length);var b=[];for(k=0;k<S.length-1;++k)b[S[k][0]]=z.subarray(S[k][1]*B,S[k+1][1]*B);return S.length>=1&&(b[S[S.length-1][0]]=z.subarray(S[S.length-1][1]*B)),{R:T,cells:b}}function R5(t,e){var r,n=Rr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Jt(n[7][0].data)>>>0>0?1:0:-1,a=Ug(n[5],function(i){return N5(i,s)});return{nrows:Jt(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function P5(t,e,r){var n,s=Rr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Jt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Jt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Qe(a);var i=Rr(s[4][0].data),o=My(t,t[Da(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?My(t,t[Da(i[17][0].data)][0]):[],c=Rr(i[3][0].data),f=0;c[1].forEach(function(h){var d=Rr(h.data),m=t[Da(d[2][0].data)][0],g=Jt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var v=R5(t,m);v.data.forEach(function(w,T){w.forEach(function(_,y){var O=Me({r:f+T,c:y}),z=C5(_,o,l);z&&(r[O]=z)})}),f+=v.nrows})}function b5(t,e){var r=Rr(e.data),n={"!ref":"A1"},s=t[Da(r[2][0].data)],a=Jt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return P5(t,s[0],n),n}function D5(t,e){var r,n=Rr(e.data),s={name:(r=n[1])!=null&&r[0]?Gp(n[1][0].data):"",sheets:[]},a=Ug(n[2],Da);return a.forEach(function(i){t[i].forEach(function(o){var l=Jt(o.meta[1][0].data);l==6e3&&s.sheets.push(b5(t,o))})}),s}function F5(t,e){var r=Hg(),n=Rr(e.data),s=Ug(n[1],Da);if(s.forEach(function(a){t[a].forEach(function(i){var o=Jt(i.meta[1][0].data);if(o==2){var l=D5(t,i);l.sheets.forEach(function(c,f){Wg(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Id(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=S5(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=T5(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Jt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var f=Jt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return F5(a,o)}function O5(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function $g(t){O5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function L5(t){return Io.WS.indexOf(t)>-1?"sheet":t==Io.CS?"chart":t==Io.DS?"dialog":t==Io.MS?"macro":t&&t.length?t:"sheet"}function M5(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,L5(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function V5(t,e,r,n,s,a,i,o,l,c,f,h){try{a[n]=uc(ln(t,r,!0),e);var d=$t(t,e),m;switch(o){case"sheet":m=HO(d,e,s,l,a[n],c,f,h);break;case"chart":if(m=WO(d,e,s,l,a[n],c,f,h),!m||!m["!drawel"])break;var g=$l(m["!drawel"].Target,e),v=Up(g),w=zD(ln(t,g,!0),uc(ln(t,v,!0),g)),T=$l(w,g),_=Up(T);m=IO(ln(t,T,!0),T,l,uc(ln(t,_,!0),T),c,m);break;case"macro":m=GO(d,e,s,l,a[n],c,f,h);break;case"dialog":m=qO(d,e,s,l,a[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var y=[];a&&a[n]&&Es(a[n]).forEach(function(O){var z="";if(a[n][O].Type==Io.CMNT){z=$l(a[n][O].Target,e);var B=QO($t(t,z,!0),z,l);if(!B||!B.length)return;Ey(m,B,!1)}a[n][O].Type==Io.TCMNT&&(z=$l(a[n][O].Target,e),y=y.concat(WD($t(t,z,!0),l)))}),y&&y.length&&Ey(m,y,!0,l.people||[])}catch(O){if(l.WTF)throw O}}function vn(t){return t.charAt(0)=="/"?t.slice(1):t}function j5(t,e){if(tT(),e=e||{},$g(e),_n(t,"META-INF/manifest.xml")||_n(t,"objectdata.xml"))return Fy(t,e);if(_n(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Id<"u"){if(t.FileIndex)return Id(t);var r=Ye.utils.cfb_new();return Xv(t).forEach(function(_e){BR(r,_e,jR(t,_e))}),Id(r)}throw new Error("Unsupported NUMBERS file")}if(!_n(t,"[Content_Types].xml"))throw _n(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_n(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Xv(t),s=O3(ln(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",$t(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!$t(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(dc=[],s.sst)try{dc=YO($t(t,vn(s.sst)),s.sst,e)}catch(_e){if(e.WTF)throw _e}e.cellStyles&&s.themes.length&&(l=XO(ln(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=KO($t(t,vn(s.style)),s.style,l,e))}s.links.map(function(_e){try{var pe=uc(ln(t,Up(vn(_e))),_e);return ZO($t(t,vn(_e)),pe,_e,e)}catch{}});var f=zO($t(t,vn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=$t(t,vn(s.coreprops[0]),!0),d&&(h=RT(d)),s.extprops.length!==0&&(d=$t(t,vn(s.extprops[0]),!0),d&&B3(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=ln(t,vn(s.custprops[0]),!0),d&&(m=$3(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(f.Sheets?i=f.Sheets.map(function(pe){return pe.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=m),e.bookSheets&&typeof i<"u"&&(g.SheetNames=i),e.bookSheets?g.SheetNames:e.bookProps))return g;i={};var v={};e.bookDeps&&s.calcchain&&(v=JO($t(t,vn(s.calcchain)),s.calcchain));var w=0,T={},_,y;{var O=f.Sheets;h.Worksheets=O.length,h.SheetNames=[];for(var z=0;z!=O.length;++z)h.SheetNames[z]=O[z].name}var B=a?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");_n(t,S)||(S="xl/_rels/workbook."+B+".rels");var k=uc(ln(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=e5($t(t,vn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=GD($t(t,vn(s.people[0])),e)),k&&(k=M5(k,f.Sheets));var R=$t(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var b="sheet";if(k&&k[w]?(_="xl/"+k[w][1].replace(/[\/]?xl\//,""),_n(t,_)||(_=k[w][1]),_n(t,_)||(_=S.replace(/_rels\/.*$/,"")+k[w][1]),b=k[w][2]):(_="xl/worksheets/sheet"+(w+1-R)+"."+B,_=_.replace(/sheet0\./,"sheet.")),y=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==w&&(D=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[w].toLowerCase()&&(D=1);if(!D)continue e}}V5(t,_,y,h.SheetNames[w],w,T,i,b,e,f,l,c)}return g={Directory:s,Workbook:f,Props:h,Custprops:m,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:dc,Styles:c,Themes:l,SSF:pr(Ue)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(_e,pe){_e=_e.replace(/^Root Entry[\/]/,""),g.keys.push(_e),g.files[_e]=t.FileIndex[pe]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=$t(t,vn(s.vba[0]),!0):s.defaults&&s.defaults.bin===YD&&(g.vbaraw=$t(t,"xl/vbaProject.bin",!0))),g}function B5(t,e){var r=e||{},n="Workbook",s=Ye.find(t,n);try{if(n="/!DataSpaces/Version",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(bb(s.content),n="/!DataSpaces/DataSpaceMap",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Fb(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Ob(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Mb(s.content)}catch{}if(n="/EncryptionInfo",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Vb(s.content);if(n="/EncryptedPackage",s=Ye.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function zg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=pn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function U5(t,e){return Ye.find(t,"EncryptedPackage")?B5(t,e):pA(t,e)}function $5(t,e){var r,n=t,s=e||{};return s.type||(s.type=Ke&&Buffer.isBuffer(t)?"buffer":"base64"),r=oT(n,s),j5(r,s)}function vA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Hp(t.slice(r),e);default:break e}return Wc.to_workbook(t,e)}function z5(t,e){var r="",n=zg(t,e);switch(e.type){case"base64":r=pn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ri(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ut(r)),e.type="binary",vA(r,e)}function H5(t,e){var r=t;return e.type=="base64"&&(r=pn(r)),r=Uc.utils.decode(1200,r.slice(2),"str"),e.type="binary",vA(r,e)}function W5(t){return t.match(/[^\x00-\x7F]/)?zl(t):t}function Cd(t,e,r,n){return n?(r.type="string",Wc.to_workbook(t,r)):Wc.to_workbook(e,r)}function kh(t,e){z2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return kh(new Uint8Array(t),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Mo={},r.dateNF&&(Mo.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",n=bR(t),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=W5(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=pr(r),r.type="array",kh(wg(n),r)}switch((s=zg(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return U5(Ye.read(n,r),r);break;case 9:if(s[1]<=8)return pA(n,r);break;case 60:return Hp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return yb(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return xb.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?$5(n,r):Cd(t,n,r,a);case 239:return s[3]===60?Hp(n,r):Cd(t,n,r,a);case 255:if(s[1]===254)return H5(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return hc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return hc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return wy.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Yb.to_workbook(n,r);break;case 10:case 13:case 32:return z5(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mb.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?wy.to_workbook(n,r):Cd(t,n,r,a)}function G5(t,e,r,n,s,a,i,o){var l=mr(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||t[r])for(var m=e.s.c;m<=e.e.c;++m){var g=i?t[r][m]:t[n[m]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[m]!=null&&(d[a[m]]=c);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[m]!=null){if(v==null)if(g.t=="e"&&v===null)d[a[m]]=null;else if(c!==void 0)d[a[m]]=c;else if(f&&v===null)d[a[m]]=null;else continue;else d[a[m]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?v:Ks(g,v,o);v!=null&&(h=!1)}}return{row:d,isempty:h}}function Kp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=bt(f);break;case"number":l=bt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var h=mr(l.s.r),d=[],m=[],g=0,v=0,w=Array.isArray(t),T=l.s.r,_=0,y={};w&&!t[T]&&(t[T]=[]);var O=c.skipHidden&&t["!cols"]||[],z=c.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(O[_]||{}).hidden)switch(d[_]=Qt(_),r=w?t[T][_]:t[d[_]+h],n){case 1:a[_]=_-l.s.c;break;case 2:a[_]=d[_];break;case 3:a[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Ks(r,null,c),v=y[i]||0,!v)y[i]=1;else{do o=i+"_"+v++;while(y[o]);y[i]=v,y[o]=1}a[_]=o}for(T=l.s.r+s;T<=l.e.r;++T)if(!(z[T]||{}).hidden){var B=G5(t,l,T,d,n,a,w,c);(B.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[g++]=B.row)}return m.length=g,m}var Vy=/"/g;function q5(t,e,r,n,s,a,i,o){for(var l=!0,c=[],f="",h=mr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Ks(m,null,o));for(var g=0,v=0;g!==f.length;++g)if((v=f.charCodeAt(g))===s||v===a||v===34||o.forceQuotes){f='"'+f.replace(Vy,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(Vy,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function yA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=bt(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(d[g]||{}).hidden||(h[g]=Qt(g));for(var v=0,w=s.s.r;w<=s.e.r;++w)(m[w]||{}).hidden||(f=q5(t,s,w,h,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((v++?o:"")+f)));return delete n.dense,r.join("")}function K5(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=yA(t,e);return r}function X5(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=bt(t["!ref"]),a="",i=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=Qt(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=mr(f),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function _A(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var h=bt(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+e.length-1+s)}else i==-1&&(i=0,f.e.r=e.length-1+s);var d=n.header||[],m=0;e.forEach(function(v,w){Es(v).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var _=v[T],y="z",O="",z=Me({c:o+m,r:i+w+s});c=Xc(a,z),_&&typeof _=="object"&&!(_ instanceof Date)?a[z]=_:(typeof _=="number"?y="n":typeof _=="boolean"?y="b":typeof _=="string"?y="s":_ instanceof Date?(y="d",n.cellDates||(y="n",_=Wr(_)),O=n.dateNF||Ue[14]):_===null&&n.nullError&&(y="e",_=0),c?(c.t=y,c.v=_,delete c.w,delete c.R,O&&(c.z=O)):a[z]=c={t:y,v:_},O&&(c.z=O))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var g=mr(i);if(s)for(m=0;m<d.length;++m)a[Qt(m+o)+g]={t:"s",v:d[m]};return a["!ref"]=Qe(f),a}function Y5(t,e){return _A(null,t,e)}function Xc(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=$r(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Xc(t,Me(e)):Xc(t,Me({r:e,c:r||0}))}function Q5(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Hg(){return{SheetNames:[],Sheets:{}}}function Wg(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(OO(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function J5(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Q5(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Z5(t,e){return t.z=e,t}function wA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function eL(t,e,r){return wA(t,"#"+e,r)}function tL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function rL(t,e,r,n){for(var s=typeof e!="string"?e:bt(e),a=typeof e=="string"?e:Qe(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Xc(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var jy={encode_col:Qt,encode_row:mr,encode_cell:Me,encode_range:Qe,decode_col:Rg,decode_row:Ng,split_cell:p3,decode_cell:$r,decode_range:cl,format_cell:Ks,sheet_add_aoa:ST,sheet_add_json:_A,sheet_add_dom:mA,aoa_to_sheet:ul,json_to_sheet:Y5,table_to_sheet:gA,table_to_book:y5,sheet_to_csv:yA,sheet_to_txt:K5,sheet_to_json:Kp,sheet_to_html:v5,sheet_to_formulae:X5,sheet_to_row_object_array:Kp,sheet_get_cell:Xc,book_new:Hg,book_append_sheet:Wg,book_set_sheet_visibility:J5,cell_set_number_format:Z5,cell_set_hyperlink:wA,cell_set_internal_link:eL,cell_add_comment:tL,sheet_set_array_formula:rL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const nL=()=>{};var By={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},sL=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],i=t[r++],o=t[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],i=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return e.join("")},TA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],i=s+1<t.length,o=i?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,f=a>>2,h=(a&3)<<4|o>>4;let d=(o&15)<<2|c>>6,m=c&63;l||(m=64,i||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(EA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||o==null||c==null||h==null)throw new aL;const d=a<<2|o>>4;if(n.push(d),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const g=c<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class aL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iL=function(t){const e=EA(t);return TA.encodeByteArray(e,!0)},Ih=function(t){return iL(t).replace(/\./g,"")},AA=function(t){try{return TA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL=()=>oL().__FIREBASE_DEFAULTS__,cL=()=>{if(typeof process>"u"||typeof By>"u")return;const t=By.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&AA(t[1]);return e&&JSON.parse(e)},m0=()=>{try{return nL()||lL()||cL()||uL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SA=t=>{var e,r;return(r=(e=m0())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},fL=t=>{const e=SA(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},kA=()=>{var t;return(t=m0())==null?void 0:t.config},IA=t=>{var e;return(e=m0())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CA(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ih(JSON.stringify(r)),Ih(JSON.stringify(i)),""].join(".")}const gc={};function pL(){const t={prod:[],emulator:[]};for(const e of Object.keys(gc))gc[e]?t.emulator.push(e):t.prod.push(e);return t}function mL(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Uy=!1;function NA(t,e){if(typeof window>"u"||typeof document>"u"||!fl(window.location.host)||gc[t]===e||gc[t]||Uy)return;gc[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",a=pL().prod.length>0;function i(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{Uy=!0,i()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=mL(n),m=r("text"),g=document.getElementById(m)||document.createElement("span"),v=r("learnmore"),w=document.getElementById(v)||document.createElement("a"),T=r("preprendIcon"),_=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const y=d.element;o(y),f(w,v);const O=c();l(_,T),y.append(_,g,w,O),document.body.appendChild(y)}a?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fr())}function xL(){var e;const t=(e=m0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _L(){const t=Fr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wL(){return!xL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PA(){try{return typeof indexedDB=="object"}catch{return!1}}function bA(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(r){e(r)}})}function EL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="FirebaseError";class rs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=TL,Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gi.prototype.create)}}class Gi{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],i=a?AL(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new rs(s,o,n)}}function AL(t,e){return t.replace(SL,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const SL=/\{\$([^}]+)}/g;function kL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function za(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],i=e[s];if($y(a)&&$y(i)){if(!za(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function $y(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Hl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Wl(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function IL(t,e){const r=new CL(t,e);return r.subscribe.bind(r)}class CL{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");NL(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Nd),s.error===void 0&&(s.error=Nd),s.complete===void 0&&(s.complete=Nd);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function NL(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Nd(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=1e3,PL=2,bL=4*60*60*1e3,DL=.5;function zy(t,e=RL,r=PL){const n=e*Math.pow(r,t),s=Math.round(DL*n*(Math.random()-.5)*2);return Math.min(bL,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(t){return t&&t._delegate?t._delegate:t}class Jn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new hL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LL(e))try{this.getOrInitializeService({instanceIdentifier:fi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=fi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fi){return this.instances.has(e)}getOptions(e=fi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:OL(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=fi){return this.component?this.component.multipleInstances?e:fi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function OL(t){return t===fi?void 0:t}function LL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new FL(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(We||(We={}));const VL={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},jL=We.INFO,BL={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},UL=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=BL[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class g0{constructor(e){this.name=e,this._logLevel=jL,this._logHandler=UL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const $L=(t,e)=>e.some(r=>t instanceof r);let Hy,Wy;function zL(){return Hy||(Hy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HL(){return Wy||(Wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DA=new WeakMap,Xp=new WeakMap,FA=new WeakMap,Rd=new WeakMap,Gg=new WeakMap;function WL(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r(Fa(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(r=>{r instanceof IDBCursor&&DA.set(r,t)}).catch(()=>{}),Gg.set(e,t),e}function GL(t){if(Xp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});Xp.set(t,e)}let Yp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Xp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||FA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Fa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function qL(t){Yp=t(Yp)}function KL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Pd(this),e,...r);return FA.set(n,e.sort?e.sort():[e]),Fa(n)}:HL().includes(t)?function(...e){return t.apply(Pd(this),e),Fa(DA.get(this))}:function(...e){return Fa(t.apply(Pd(this),e))}}function XL(t){return typeof t=="function"?KL(t):(t instanceof IDBTransaction&&GL(t),$L(t,zL())?new Proxy(t,Yp):t)}function Fa(t){if(t instanceof IDBRequest)return WL(t);if(Rd.has(t))return Rd.get(t);const e=XL(t);return e!==t&&(Rd.set(t,e),Gg.set(e,t)),e}const Pd=t=>Gg.get(t);function OA(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),o=Fa(i);return n&&i.addEventListener("upgradeneeded",l=>{n(Fa(i.result),l.oldVersion,l.newVersion,Fa(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const YL=["get","getKey","getAll","getAllKeys","count"],QL=["put","add","delete","clear"],bd=new Map;function Gy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(bd.get(e))return bd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=QL.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||YL.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return bd.set(e,a),a}qL(t=>({...t,get:(e,r,n)=>Gy(e,r)||t.get(e,r,n),has:(e,r)=>!!Gy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(ZL(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function ZL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qp="@firebase/app",qy="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=new g0("@firebase/app"),e8="@firebase/app-compat",t8="@firebase/analytics-compat",r8="@firebase/analytics",n8="@firebase/app-check-compat",s8="@firebase/app-check",a8="@firebase/auth",i8="@firebase/auth-compat",o8="@firebase/database",l8="@firebase/data-connect",c8="@firebase/database-compat",u8="@firebase/functions",f8="@firebase/functions-compat",h8="@firebase/installations",d8="@firebase/installations-compat",p8="@firebase/messaging",m8="@firebase/messaging-compat",g8="@firebase/performance",x8="@firebase/performance-compat",v8="@firebase/remote-config",y8="@firebase/remote-config-compat",_8="@firebase/storage",w8="@firebase/storage-compat",E8="@firebase/firestore",T8="@firebase/ai",A8="@firebase/firestore-compat",S8="firebase",k8="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp="[DEFAULT]",I8={[Qp]:"fire-core",[e8]:"fire-core-compat",[r8]:"fire-analytics",[t8]:"fire-analytics-compat",[s8]:"fire-app-check",[n8]:"fire-app-check-compat",[a8]:"fire-auth",[i8]:"fire-auth-compat",[o8]:"fire-rtdb",[l8]:"fire-data-connect",[c8]:"fire-rtdb-compat",[u8]:"fire-fn",[f8]:"fire-fn-compat",[h8]:"fire-iid",[d8]:"fire-iid-compat",[p8]:"fire-fcm",[m8]:"fire-fcm-compat",[g8]:"fire-perf",[x8]:"fire-perf-compat",[v8]:"fire-rc",[y8]:"fire-rc-compat",[_8]:"fire-gcs",[w8]:"fire-gcs-compat",[E8]:"fire-fst",[A8]:"fire-fst-compat",[T8]:"fire-vertex","fire-js":"fire-js",[S8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=new Map,C8=new Map,Zp=new Map;function Ky(t,e){try{t.container.addComponent(e)}catch(r){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ts(t){const e=t.name;if(Zp.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,t);for(const r of Ch.values())Ky(r,t);for(const r of C8.values())Ky(r,t);return!0}function qi(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Tn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oa=new Gi("app","Firebase",N8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=k8;function LA(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Jp,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Oa.create("bad-app-name",{appName:String(s)});if(r||(r=kA()),!r)throw Oa.create("no-options");const a=Ch.get(s);if(a){if(za(r,a.options)&&za(n,a.config))return a;throw Oa.create("duplicate-app",{appName:s})}const i=new ML(s);for(const l of Zp.values())i.addComponent(l);const o=new R8(r,n,i);return Ch.set(s,o),o}function qg(t=Jp){const e=Ch.get(t);if(!e&&t===Jp&&kA())return LA();if(!e)throw Oa.create("no-app",{appName:t});return e}function In(t,e,r){let n=I8[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const i=[`Unable to register library "${n}" with version "${e}":`];s&&i.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&i.push("and"),a&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(i.join(" "));return}Ts(new Jn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8="firebase-heartbeat-database",b8=1,Yc="firebase-heartbeat-store";let Dd=null;function MA(){return Dd||(Dd=OA(P8,b8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Oa.create("idb-open",{originalErrorMessage:t.message})})),Dd}async function D8(t){try{const r=(await MA()).transaction(Yc),n=await r.objectStore(Yc).get(VA(t));return await r.done,n}catch(e){if(e instanceof rs)Xs.warn(e.message);else{const r=Oa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xs.warn(r.message)}}}async function Xy(t,e){try{const n=(await MA()).transaction(Yc,"readwrite");await n.objectStore(Yc).put(e,VA(t)),await n.done}catch(r){if(r instanceof rs)Xs.warn(r.message);else{const n=Oa.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Xs.warn(n.message)}}}function VA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F8=1024,O8=30;class L8{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new V8(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Yy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>O8){const i=j8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Xs.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Yy(),{heartbeatsToSend:n,unsentEntries:s}=M8(this._heartbeatsCache.heartbeats),a=Ih(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Xs.warn(r),""}}}function Yy(){return new Date().toISOString().substring(0,10)}function M8(t,e=F8){const r=[];let n=t.slice();for(const s of t){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),Qy(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Qy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class V8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PA()?bA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await D8(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Qy(t){return Ih(JSON.stringify({version:2,heartbeats:t})).length}function j8(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B8(t){Ts(new Jn("platform-logger",e=>new JL(e),"PRIVATE")),Ts(new Jn("heartbeat",e=>new L8(e),"PRIVATE")),In(Qp,qy,t),In(Qp,qy,"esm2020"),In("fire-js","")}B8("");function jA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const U8=jA,BA=new Gi("auth","Firebase",jA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=new g0("@firebase/auth");function $8(t,...e){Nh.logLevel<=We.WARN&&Nh.warn(`Auth (${hl}): ${t}`,...e)}function bf(t,...e){Nh.logLevel<=We.ERROR&&Nh.error(`Auth (${hl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(t,...e){throw Kg(t,...e)}function gs(t,...e){return Kg(t,...e)}function UA(t,e,r){const n={...U8(),[e]:r};return new Gi("auth","Firebase",n).create(e,{appName:t.name})}function $s(t){return UA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Kg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return BA.create(t,...e)}function Re(t,e,...r){if(!t)throw Kg(e,...r)}function Ms(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bf(e),new Error(e)}function Ys(t,e){t||Ms(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function z8(){return Jy()==="http:"||Jy()==="https:"}function Jy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(z8()||RA()||"connection"in navigator)?navigator.onLine:!0}function W8(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ys(r>e,"Short delay should be less than long delay!"),this.isMobile=gL()||yL()}get(){return H8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t,e){Ys(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ms("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ms("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ms("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],K8=new xu(3e4,6e4);function ei(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ta(t,e,r,n,s={}){return zA(t,s,async()=>{let a={},i={};n&&(e==="GET"?i=n:a={body:JSON.stringify(n)});const o=gu({key:t.config.apiKey,...i}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...a};return vL()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&fl(t.emulatorConfig.host)&&(c.credentials="include"),$A.fetch()(await HA(t,t.config.apiHost,r,o),c)})}async function zA(t,e,r){t._canInitEmulator=!1;const n={...G8,...e};try{const s=new Y8(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw df(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw df(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw df(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw df(t,"user-disabled",i);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw UA(t,f,c);Zn(t,f)}}catch(s){if(s instanceof rs)throw s;Zn(t,"network-request-failed",{message:String(s)})}}async function vu(t,e,r,n,s={}){const a=await ta(t,e,r,n,s);return"mfaPendingCredential"in a&&Zn(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function HA(t,e,r,n){const s=`${e}${r}?${n}`,a=t,i=a.config.emulator?Xg(t.config,s):`${t.config.apiScheme}://${s}`;return q8.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(i).toString():i}function X8(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Y8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(gs(this.auth,"network-request-failed")),K8.get())})}}function df(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=gs(t,e,n);return s.customData._tokenResponse=r,s}function Zy(t){return t!==void 0&&t.enterprise!==void 0}class Q8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return X8(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function J8(t,e){return ta(t,"GET","/v2/recaptchaConfig",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z8(t,e){return ta(t,"POST","/v1/accounts:delete",e)}async function Rh(t,e){return ta(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eM(t,e=!1){const r=Mt(t),n=await r.getIdToken(e),s=Yg(n);Re(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:xc(Fd(s.auth_time)),issuedAtTime:xc(Fd(s.iat)),expirationTime:xc(Fd(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Fd(t){return Number(t)*1e3}function Yg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return bf("JWT malformed, contained fewer than 3 sections"),null;try{const s=AA(r);return s?JSON.parse(s):(bf("Failed to decode base64 JWT payload"),null)}catch(s){return bf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function e_(t){const e=Yg(t);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof rs&&tM(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function tM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=xc(this.lastLoginAt),this.creationTime=xc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(t){var h;const e=t.auth,r=await t.getIdToken(),n=await Jo(t,Rh(e,{idToken:r}));Re(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const a=(h=s.providerUserInfo)!=null&&h.length?WA(s.providerUserInfo):[],i=sM(t.providerData,a),o=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(i!=null&&i.length),c=o?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new tm(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,f)}async function nM(t){const e=Mt(t);await Ph(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sM(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function WA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(t,e){const r=await zA(t,{},async()=>{const n=gu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,i=await HA(t,s,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&fl(t.emulatorConfig.host)&&(l.credentials="include"),$A.fetch()(i,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function iM(t,e){return ta(t,"POST","/v2/accounts:revokeToken",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):e_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const r=e_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await aM(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Vo;return n&&(Re(typeof n=="string","internal-error",{appName:e}),i.refreshToken=n),s&&(Re(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),a&&(Re(typeof a=="number","internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vo,this.toJSON())}_performRefresh(){return Ms("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t,e){Re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qn{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new rM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new tm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Jo(this,this.stsTokenManager.getToken(this.auth,e));return Re(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return eM(this,e)}reload(){return nM(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ph(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tn(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await Jo(this,Z8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,a=r.phoneNumber??void 0,i=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:m,providerData:g,stsTokenManager:v}=r;Re(h&&v,e,"internal-error");const w=Vo.fromJSON(this.name,v);Re(typeof h=="string",e,"internal-error"),ua(n,e.name),ua(s,e.name),Re(typeof d=="boolean",e,"internal-error"),Re(typeof m=="boolean",e,"internal-error"),ua(a,e.name),ua(i,e.name),ua(o,e.name),ua(l,e.name),ua(c,e.name),ua(f,e.name);const T=new qn({uid:h,auth:e,email:s,emailVerified:d,displayName:n,isAnonymous:m,photoURL:i,phoneNumber:a,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:f});return g&&Array.isArray(g)&&(T.providerData=g.map(_=>({..._}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new Vo;s.updateFromServerResponse(r);const a=new qn({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Ph(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Re(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?WA(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Vo;o.updateFromIdToken(n);const l=new qn({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new tm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Map;function Vs(t){Ys(t instanceof Function,"Expected a class definition");let e=t_.get(t);return e?(Ys(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,t_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}GA.type="NONE";const r_=GA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t,e,r){return`firebase:${t}:${e}:${r}`}class jo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Df(this.userKey,s.apiKey,a),this.fullPersistenceKey=Df("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Rh(this.auth,{idToken:e}).catch(()=>{});return r?qn._fromGetAccountInfoResponse(this.auth,r,e):null}return qn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new jo(Vs(r_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||Vs(r_);const i=Df(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(i);if(f){let h;if(typeof f=="string"){const d=await Rh(e,{idToken:f}).catch(()=>{});if(!d)break;h=await qn._fromGetAccountInfoResponse(e,d,f)}else h=qn._fromJSON(e,f);c!==a&&(o=h),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new jo(a,e,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new jo(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(YA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(JA(e))return"Blackberry";if(ZA(e))return"Webos";if(KA(e))return"Safari";if((e.includes("chrome/")||XA(e))&&!e.includes("edge/"))return"Chrome";if(QA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function qA(t=Fr()){return/firefox\//i.test(t)}function KA(t=Fr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XA(t=Fr()){return/crios\//i.test(t)}function YA(t=Fr()){return/iemobile/i.test(t)}function QA(t=Fr()){return/android/i.test(t)}function JA(t=Fr()){return/blackberry/i.test(t)}function ZA(t=Fr()){return/webos/i.test(t)}function Qg(t=Fr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function oM(t=Fr()){var e;return Qg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function lM(){return _L()&&document.documentMode===10}function eS(t=Fr()){return Qg(t)||QA(t)||ZA(t)||JA(t)||/windows phone/i.test(t)||YA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t,e=[]){let r;switch(t){case"Browser":r=n_(Fr());break;case"Worker":r=`${n_(Fr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${hl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((i,o)=>{try{const l=e(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uM(t,e={}){return ta(t,"GET","/v2/passwordPolicy",ei(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=6;class hM{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??fM,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new s_(this),this.idTokenSubscription=new s_(this),this.beforeStateQueue=new cM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Vs(r)),this._initializationPromise=this.queue(async()=>{var n,s,a;if(!this._deleted&&(this.persistenceManager=await jo.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Rh(this,{idToken:e}),n=await qn._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(Tn(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(a=this.redirectUser)==null?void 0:a._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ph(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=W8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tn(this.app))return Promise.reject($s(this));const r=e?Mt(e):null;return r&&Re(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tn(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tn(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uM(this),r=new hM(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gi("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await iM(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Vs(e)||this._popupRedirectResolver;Re(r,this,"argument-error"),this.redirectPersistenceManager=await jo.create(this,[Vs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=e.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(Tn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&$8(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ki(t){return Mt(t)}class s_{constructor(e){this.auth=e,this.observer=null,this.addObserver=IL(r=>this.observer=r)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pM(t){x0=t}function rS(t){return x0.loadJS(t)}function mM(){return x0.recaptchaEnterpriseScript}function gM(){return x0.gapiScript}function xM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class vM{constructor(){this.enterprise=new yM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class yM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const _M="recaptcha-enterprise",nS="NO_RECAPTCHA";class wM{constructor(e){this.type=_M,this.auth=Ki(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(i,o)=>{J8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new Q8(l);return a.tenantId==null?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,i(c.siteKey)}}).catch(l=>{o(l)})})}function s(a,i,o){const l=window.grecaptcha;Zy(l)?l.enterprise.ready(()=>{l.enterprise.execute(a,{action:e}).then(c=>{i(c)}).catch(()=>{i(nS)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new vM().execute("siteKey",{action:"verify"}):new Promise((a,i)=>{n(this.auth).then(o=>{if(!r&&Zy(window.grecaptcha))s(o,a,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let l=mM();l.length!==0&&(l+=o),rS(l).then(()=>{s(o,a,i)}).catch(c=>{i(c)})}}).catch(o=>{i(o)})})}}async function a_(t,e,r,n=!1,s=!1){const a=new wM(t);let i;if(s)i=nS;else try{i=await a.verify(r)}catch{i=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function rm(t,e,r,n,s){var a;if((a=t._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await a_(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await a_(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(t,e){const r=qi(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(za(a,e??{}))return s;Zn(s,"already-initialized")}return r.initialize({options:e})}function TM(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Vs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function AM(t,e,r){const n=Ki(t);Re(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=sS(e),{host:i,port:o}=SM(e),l=o===null?"":`:${o}`,c={url:`${a}//${i}${l}/`},f=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Re(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Re(za(c,n.config.emulator)&&za(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,fl(i)?(CA(`${a}//${i}${l}`),NA("Auth",!0)):kM()}function sS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function SM(t){const e=sS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:i_(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:i_(i)}}}function i_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kM(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ms("not implemented")}_getIdTokenResponse(e){return Ms("not implemented")}_linkToIdToken(e,r){return Ms("not implemented")}_getReauthenticationResolver(e){return Ms("not implemented")}}async function IM(t,e){return ta(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CM(t,e){return vu(t,"POST","/v1/accounts:signInWithPassword",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NM(t,e){return vu(t,"POST","/v1/accounts:signInWithEmailLink",ei(t,e))}async function RM(t,e){return vu(t,"POST","/v1/accounts:signInWithEmailLink",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends Jg{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Qc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Qc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rm(e,r,"signInWithPassword",CM);case"emailLink":return NM(e,{email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rm(e,n,"signUpPassword",IM);case"emailLink":return RM(e,{idToken:r,email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bo(t,e){return vu(t,"POST","/v1/accounts:signInWithIdp",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM="http://localhost";class bi extends Jg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new bi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Zn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...a}=r;if(!n||!s)return null;const i=new bi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){const r=this.buildRequest();return Bo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Bo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Bo(e,r)}buildRequest(){const e={requestUri:PM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=gu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DM(t){const e=Hl(Wl(t)).link,r=e?Hl(Wl(e)).deep_link_id:null,n=Hl(Wl(t)).deep_link_id;return(n?Hl(Wl(n)).link:null)||n||r||e||t}class Zg{constructor(e){const r=Hl(Wl(e)),n=r.apiKey??null,s=r.oobCode??null,a=bM(r.mode??null);Re(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=DM(e);try{return new Zg(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(){this.providerId=dl.PROVIDER_ID}static credential(e,r){return Qc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Zg.parseLink(r);return Re(n,"argument-error"),Qc._fromEmailAndCode(e,n.code,n.tenantId)}}dl.PROVIDER_ID="password";dl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends aS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends yu{constructor(){super("facebook.com")}static credential(e){return bi._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ga.credential(e.oauthAccessToken)}catch{return null}}}ga.FACEBOOK_SIGN_IN_METHOD="facebook.com";ga.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends yu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return bi._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xa.credential(r,n)}catch{return null}}}xa.GOOGLE_SIGN_IN_METHOD="google.com";xa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends yu{constructor(){super("github.com")}static credential(e){return bi._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return va.credential(e.oauthAccessToken)}catch{return null}}}va.GITHUB_SIGN_IN_METHOD="github.com";va.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends yu{constructor(){super("twitter.com")}static credential(e,r){return bi._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ya.credential(r,n)}catch{return null}}}ya.TWITTER_SIGN_IN_METHOD="twitter.com";ya.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FM(t,e){return vu(t,"POST","/v1/accounts:signUp",ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await qn._fromIdTokenResponse(e,n,s),i=o_(n);return new Di({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=o_(n);return new Di({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function o_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends rs{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,bh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new bh(e,r,n,s)}}function iS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?bh._fromErrorAndOperation(t,a,e,n):a})}async function OM(t,e,r=!1){const n=await Jo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Di._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LM(t,e,r=!1){const{auth:n}=t;if(Tn(n.app))return Promise.reject($s(n));const s="reauthenticate";try{const a=await Jo(t,iS(n,s,e,t),r);Re(a.idToken,n,"internal-error");const i=Yg(a.idToken);Re(i,n,"internal-error");const{sub:o}=i;return Re(t.uid===o,n,"user-mismatch"),Di._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Zn(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(t,e,r=!1){if(Tn(t.app))return Promise.reject($s(t));const n="signIn",s=await iS(t,n,e),a=await Di._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function MM(t,e){return oS(Ki(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lS(t){const e=Ki(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function VM(t,e,r){if(Tn(t.app))return Promise.reject($s(t));const n=Ki(t),i=await rm(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FM).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&lS(t),l}),o=await Di._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(o.user),o}function jM(t,e,r){return Tn(t.app)?Promise.reject($s(t)):MM(Mt(t),dl.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&lS(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BM(t,e){return ta(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UM(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Mt(t),a={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},i=await Jo(n,BM(n.auth,a));n.displayName=i.displayName||null,n.photoURL=i.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(i)}function $M(t,e,r,n){return Mt(t).onIdTokenChanged(e,r,n)}function zM(t,e,r){return Mt(t).beforeAuthStateChanged(e,r)}function HM(t,e,r,n){return Mt(t).onAuthStateChanged(e,r,n)}function WM(t){return Mt(t).signOut()}const Dh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=1e3,qM=10;class uS extends cS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);lM()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,qM):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},GM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}uS.type="LOCAL";const KM=uS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS extends cS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}fS.type="SESSION";const hS=fS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new v0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await XM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}v0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=e1("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(d.data.response);break;default:clearTimeout(f),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(){return window}function QM(t){xs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){return typeof xs().WorkerGlobalScope<"u"&&typeof xs().importScripts=="function"}async function JM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function e9(){return dS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="firebaseLocalStorageDb",t9=1,Fh="firebaseLocalStorage",mS="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function y0(t,e){return t.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function r9(){const t=indexedDB.deleteDatabase(pS);return new _u(t).toPromise()}function nm(){const t=indexedDB.open(pS,t9);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Fh,{keyPath:mS})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Fh)?e(n):(n.close(),await r9(),e(await nm()))})})}async function l_(t,e,r){const n=y0(t,!0).put({[mS]:e,value:r});return new _u(n).toPromise()}async function n9(t,e){const r=y0(t,!1).get(e),n=await new _u(r).toPromise();return n===void 0?null:n.value}function c_(t,e){const r=y0(t,!0).delete(e);return new _u(r).toPromise()}const s9=800,a9=3;class gS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>a9)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=v0._getInstance(e9()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await JM(),!this.activeServiceWorker)return;this.sender=new YM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nm();return await l_(e,Dh,"1"),await c_(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>l_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>n9(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>c_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=y0(s,!1).getAll();return new _u(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),s9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gS.type="LOCAL";const i9=gS;new xu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o9(t,e){return e?Vs(e):(Re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1 extends Jg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Bo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Bo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function l9(t){return oS(t.auth,new t1(t),t.bypassAuthState)}function c9(t){const{auth:e,user:r}=t;return Re(r,e,"internal-error"),LM(r,new t1(t),t.bypassAuthState)}async function u9(t){const{auth:e,user:r}=t;return Re(r,e,"internal-error"),OM(r,new t1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return l9;case"linkViaPopup":case"linkViaRedirect":return u9;case"reauthViaPopup":case"reauthViaRedirect":return c9;default:Zn(this.auth,"internal-error")}}resolve(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9=new xu(2e3,1e4);class Co extends xS{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Co.currentPopupAction&&Co.currentPopupAction.cancel(),Co.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Ys(this.filter.length===1,"Popup operations only handle one event");const e=e1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(gs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(gs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Co.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f9.get())};e()}}Co.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9="pendingRedirect",Ff=new Map;class d9 extends xS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ff.get(this.auth._key());if(!e){try{const n=await p9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ff.set(this.auth._key(),e)}return this.bypassAuthState||Ff.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function p9(t,e){const r=x9(e),n=g9(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function m9(t,e){Ff.set(t._key(),e)}function g9(t){return Vs(t._redirectPersistence)}function x9(t){return Df(h9,t.config.apiKey,t.name)}async function v9(t,e,r=!1){if(Tn(t.app))return Promise.reject($s(t));const n=Ki(t),s=o9(n,e),i=await new d9(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y9=10*60*1e3;class _9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!w9(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!vS(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(gs(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=y9&&this.cachedEventUids.clear(),this.cachedEventUids.has(u_(e))}saveEventToCache(e){this.cachedEventUids.add(u_(e)),this.lastProcessedEventTime=Date.now()}}function u_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function w9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E9(t,e={}){return ta(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,A9=/^https?/;async function S9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await E9(t);for(const r of e)try{if(k9(r))return}catch{}Zn(t,"unauthorized-domain")}function k9(t){const e=em(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!A9.test(r))return!1;if(T9.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9=new xu(3e4,6e4);function f_(){const t=xs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function C9(t){return new Promise((e,r)=>{var s,a,i;function n(){f_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{f_(),r(gs(t,"network-request-failed"))},timeout:I9.get()})}if((a=(s=xs().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((i=xs().gapi)!=null&&i.load)n();else{const o=xM("iframefcb");return xs()[o]=()=>{gapi.load?n():r(gs(t,"network-request-failed"))},rS(`${gM()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Of=null,e})}let Of=null;function N9(t){return Of=Of||C9(t),Of}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R9=new xu(5e3,15e3),P9="__/auth/iframe",b9="emulator/auth/iframe",D9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},F9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O9(t){const e=t.config;Re(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Xg(e,b9):`https://${t.config.authDomain}/${P9}`,n={apiKey:e.apiKey,appName:t.name,v:hl},s=F9.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${gu(n).slice(1)}`}async function L9(t){const e=await N9(t),r=xs().gapi;return Re(r,t,"internal-error"),e.open({where:document.body,url:O9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D9,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=gs(t,"network-request-failed"),o=xs().setTimeout(()=>{a(i)},R9.get());function l(){xs().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V9=500,j9=600,B9="_blank",U9="http://localhost";class h_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $9(t,e,r,n=V9,s=j9){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...M9,width:n.toString(),height:s.toString(),top:a,left:i},c=Fr().toLowerCase();r&&(o=XA(c)?B9:r),qA(c)&&(e=e||U9,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[m,g])=>`${d}${m}=${g},`,"");if(oM(c)&&o!=="_self")return z9(e||"",o),new h_(null);const h=window.open(e||"",o,f);Re(h,t,"popup-blocked");try{h.focus()}catch{}return new h_(h)}function z9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H9="__/auth/handler",W9="emulator/auth/handler",G9=encodeURIComponent("fac");async function d_(t,e,r,n,s,a){Re(t.config.authDomain,t,"auth-domain-config-required"),Re(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:hl,eventId:s};if(e instanceof aS){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",kL(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))i[f]=h}if(e instanceof yu){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(i.scopes=f.join(","))}t.tenantId&&(i.tid=t.tenantId);const o=i;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${G9}=${encodeURIComponent(l)}`:"";return`${q9(t)}?${gu(o).slice(1)}${c}`}function q9({config:t}){return t.emulator?Xg(t,W9):`https://${t.authDomain}/${H9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="webStorageSupport";class K9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hS,this._completeRedirectFn=v9,this._overrideRedirectResult=m9}async _openPopup(e,r,n,s){var i;Ys((i=this.eventManagers[e._key()])==null?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await d_(e,r,n,em(),s);return $9(e,a,e1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await d_(e,r,n,em(),s);return QM(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(Ys(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await L9(e),n=new _9(e);return r.register("authEvent",s=>(Re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Od,{type:Od},s=>{var i;const a=(i=s==null?void 0:s[0])==null?void 0:i[Od];a!==void 0&&r(!!a),Zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=S9(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return eS()||KA()||Qg()}}const X9=K9;var p_="@firebase/auth",m_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function J9(t){Ts(new Jn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Re(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tS(t)},c=new dM(n,s,a,l);return TM(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ts(new Jn("auth-internal",e=>{const r=Ki(e.getProvider("auth").getImmediate());return(n=>new Y9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),In(p_,m_,Q9(t)),In(p_,m_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z9=5*60,e7=IA("authIdTokenMaxAge")||Z9;let g_=null;const t7=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>e7)return;const s=r==null?void 0:r.token;g_!==s&&(g_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function r7(t=qg()){const e=qi(t,"auth");if(e.isInitialized())return e.getImmediate();const r=EM(t,{popupRedirectResolver:X9,persistence:[i9,KM,hS]}),n=IA("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=t7(a.toString());zM(r,i,()=>i(r.currentUser)),$M(r,o=>i(o))}}const s=SA("auth");return s&&AM(r,`http://${s}`),r}function n7(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}pM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=gs("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",n7().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});J9("Browser");var s7="firebase",a7="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In(s7,a7,"app");var x_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var La,yS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,S){function k(){}k.prototype=S.prototype,E.D=S.prototype,E.prototype=new k,E.prototype.constructor=E,E.C=function(R,b,D){for(var F=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)F[_e-2]=arguments[_e];return S.prototype[b].apply(R,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,S,k){k||(k=0);var R=Array(16);if(typeof S=="string")for(var b=0;16>b;++b)R[b]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(b=0;16>b;++b)R[b]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=E.g[0],k=E.g[1],b=E.g[2];var D=E.g[3],F=S+(D^k&(b^D))+R[0]+3614090360&4294967295;S=k+(F<<7&4294967295|F>>>25),F=D+(b^S&(k^b))+R[1]+3905402710&4294967295,D=S+(F<<12&4294967295|F>>>20),F=b+(k^D&(S^k))+R[2]+606105819&4294967295,b=D+(F<<17&4294967295|F>>>15),F=k+(S^b&(D^S))+R[3]+3250441966&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(D^k&(b^D))+R[4]+4118548399&4294967295,S=k+(F<<7&4294967295|F>>>25),F=D+(b^S&(k^b))+R[5]+1200080426&4294967295,D=S+(F<<12&4294967295|F>>>20),F=b+(k^D&(S^k))+R[6]+2821735955&4294967295,b=D+(F<<17&4294967295|F>>>15),F=k+(S^b&(D^S))+R[7]+4249261313&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(D^k&(b^D))+R[8]+1770035416&4294967295,S=k+(F<<7&4294967295|F>>>25),F=D+(b^S&(k^b))+R[9]+2336552879&4294967295,D=S+(F<<12&4294967295|F>>>20),F=b+(k^D&(S^k))+R[10]+4294925233&4294967295,b=D+(F<<17&4294967295|F>>>15),F=k+(S^b&(D^S))+R[11]+2304563134&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(D^k&(b^D))+R[12]+1804603682&4294967295,S=k+(F<<7&4294967295|F>>>25),F=D+(b^S&(k^b))+R[13]+4254626195&4294967295,D=S+(F<<12&4294967295|F>>>20),F=b+(k^D&(S^k))+R[14]+2792965006&4294967295,b=D+(F<<17&4294967295|F>>>15),F=k+(S^b&(D^S))+R[15]+1236535329&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(b^D&(k^b))+R[1]+4129170786&4294967295,S=k+(F<<5&4294967295|F>>>27),F=D+(k^b&(S^k))+R[6]+3225465664&4294967295,D=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(D^S))+R[11]+643717713&4294967295,b=D+(F<<14&4294967295|F>>>18),F=k+(D^S&(b^D))+R[0]+3921069994&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^D&(k^b))+R[5]+3593408605&4294967295,S=k+(F<<5&4294967295|F>>>27),F=D+(k^b&(S^k))+R[10]+38016083&4294967295,D=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(D^S))+R[15]+3634488961&4294967295,b=D+(F<<14&4294967295|F>>>18),F=k+(D^S&(b^D))+R[4]+3889429448&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^D&(k^b))+R[9]+568446438&4294967295,S=k+(F<<5&4294967295|F>>>27),F=D+(k^b&(S^k))+R[14]+3275163606&4294967295,D=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(D^S))+R[3]+4107603335&4294967295,b=D+(F<<14&4294967295|F>>>18),F=k+(D^S&(b^D))+R[8]+1163531501&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^D&(k^b))+R[13]+2850285829&4294967295,S=k+(F<<5&4294967295|F>>>27),F=D+(k^b&(S^k))+R[2]+4243563512&4294967295,D=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(D^S))+R[7]+1735328473&4294967295,b=D+(F<<14&4294967295|F>>>18),F=k+(D^S&(b^D))+R[12]+2368359562&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(k^b^D)+R[5]+4294588738&4294967295,S=k+(F<<4&4294967295|F>>>28),F=D+(S^k^b)+R[8]+2272392833&4294967295,D=S+(F<<11&4294967295|F>>>21),F=b+(D^S^k)+R[11]+1839030562&4294967295,b=D+(F<<16&4294967295|F>>>16),F=k+(b^D^S)+R[14]+4259657740&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^D)+R[1]+2763975236&4294967295,S=k+(F<<4&4294967295|F>>>28),F=D+(S^k^b)+R[4]+1272893353&4294967295,D=S+(F<<11&4294967295|F>>>21),F=b+(D^S^k)+R[7]+4139469664&4294967295,b=D+(F<<16&4294967295|F>>>16),F=k+(b^D^S)+R[10]+3200236656&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^D)+R[13]+681279174&4294967295,S=k+(F<<4&4294967295|F>>>28),F=D+(S^k^b)+R[0]+3936430074&4294967295,D=S+(F<<11&4294967295|F>>>21),F=b+(D^S^k)+R[3]+3572445317&4294967295,b=D+(F<<16&4294967295|F>>>16),F=k+(b^D^S)+R[6]+76029189&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^D)+R[9]+3654602809&4294967295,S=k+(F<<4&4294967295|F>>>28),F=D+(S^k^b)+R[12]+3873151461&4294967295,D=S+(F<<11&4294967295|F>>>21),F=b+(D^S^k)+R[15]+530742520&4294967295,b=D+(F<<16&4294967295|F>>>16),F=k+(b^D^S)+R[2]+3299628645&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(b^(k|~D))+R[0]+4096336452&4294967295,S=k+(F<<6&4294967295|F>>>26),F=D+(k^(S|~b))+R[7]+1126891415&4294967295,D=S+(F<<10&4294967295|F>>>22),F=b+(S^(D|~k))+R[14]+2878612391&4294967295,b=D+(F<<15&4294967295|F>>>17),F=k+(D^(b|~S))+R[5]+4237533241&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~D))+R[12]+1700485571&4294967295,S=k+(F<<6&4294967295|F>>>26),F=D+(k^(S|~b))+R[3]+2399980690&4294967295,D=S+(F<<10&4294967295|F>>>22),F=b+(S^(D|~k))+R[10]+4293915773&4294967295,b=D+(F<<15&4294967295|F>>>17),F=k+(D^(b|~S))+R[1]+2240044497&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~D))+R[8]+1873313359&4294967295,S=k+(F<<6&4294967295|F>>>26),F=D+(k^(S|~b))+R[15]+4264355552&4294967295,D=S+(F<<10&4294967295|F>>>22),F=b+(S^(D|~k))+R[6]+2734768916&4294967295,b=D+(F<<15&4294967295|F>>>17),F=k+(D^(b|~S))+R[13]+1309151649&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~D))+R[4]+4149444226&4294967295,S=k+(F<<6&4294967295|F>>>26),F=D+(k^(S|~b))+R[11]+3174756917&4294967295,D=S+(F<<10&4294967295|F>>>22),F=b+(S^(D|~k))+R[2]+718787259&4294967295,b=D+(F<<15&4294967295|F>>>17),F=k+(D^(b|~S))+R[9]+3951481745&4294967295,E.g[0]=E.g[0]+S&4294967295,E.g[1]=E.g[1]+(b+(F<<21&4294967295|F>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+D&4294967295}n.prototype.u=function(E,S){S===void 0&&(S=E.length);for(var k=S-this.blockSize,R=this.B,b=this.h,D=0;D<S;){if(b==0)for(;D<=k;)s(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<S;)if(R[b++]=E.charCodeAt(D++),b==this.blockSize){s(this,R),b=0;break}}else for(;D<S;)if(R[b++]=E[D++],b==this.blockSize){s(this,R),b=0;break}}this.h=b,this.o+=S},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var S=1;S<E.length-8;++S)E[S]=0;var k=8*this.o;for(S=E.length-8;S<E.length;++S)E[S]=k&255,k/=256;for(this.u(E),E=Array(16),S=k=0;4>S;++S)for(var R=0;32>R;R+=8)E[k++]=this.g[S]>>>R&255;return E};function a(E,S){var k=o;return Object.prototype.hasOwnProperty.call(k,E)?k[E]:k[E]=S(E)}function i(E,S){this.h=S;for(var k=[],R=!0,b=E.length-1;0<=b;b--){var D=E[b]|0;R&&D==S||(k[b]=D,R=!1)}this.g=k}var o={};function l(E){return-128<=E&&128>E?a(E,function(S){return new i([S|0],0>S?-1:0)}):new i([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return w(c(-E));for(var S=[],k=1,R=0;E>=k;R++)S[R]=E/k|0,k*=4294967296;return new i(S,0)}function f(E,S){if(E.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E.charAt(0)=="-")return w(f(E.substring(1),S));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(S,8)),R=h,b=0;b<E.length;b+=8){var D=Math.min(8,E.length-b),F=parseInt(E.substring(b,b+D),S);8>D?(D=c(Math.pow(S,D)),R=R.j(D).add(c(F))):(R=R.j(k),R=R.add(c(F)))}return R}var h=l(0),d=l(1),m=l(16777216);t=i.prototype,t.m=function(){if(v(this))return-w(this).m();for(var E=0,S=1,k=0;k<this.g.length;k++){var R=this.i(k);E+=(0<=R?R:4294967296+R)*S,S*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(v(this))return"-"+w(this).toString(E);for(var S=c(Math.pow(E,6)),k=this,R="";;){var b=O(k,S).g;k=T(k,b.j(S));var D=((0<k.g.length?k.g[0]:k.h)>>>0).toString(E);if(k=b,g(k))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var S=0;S<E.g.length;S++)if(E.g[S]!=0)return!1;return!0}function v(E){return E.h==-1}t.l=function(E){return E=T(this,E),v(E)?-1:g(E)?0:1};function w(E){for(var S=E.g.length,k=[],R=0;R<S;R++)k[R]=~E.g[R];return new i(k,~E.h).add(d)}t.abs=function(){return v(this)?w(this):this},t.add=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],R=0,b=0;b<=S;b++){var D=R+(this.i(b)&65535)+(E.i(b)&65535),F=(D>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);R=F>>>16,D&=65535,F&=65535,k[b]=F<<16|D}return new i(k,k[k.length-1]&-2147483648?-1:0)};function T(E,S){return E.add(w(S))}t.j=function(E){if(g(this)||g(E))return h;if(v(this))return v(E)?w(this).j(w(E)):w(w(this).j(E));if(v(E))return w(this.j(w(E)));if(0>this.l(m)&&0>E.l(m))return c(this.m()*E.m());for(var S=this.g.length+E.g.length,k=[],R=0;R<2*S;R++)k[R]=0;for(R=0;R<this.g.length;R++)for(var b=0;b<E.g.length;b++){var D=this.i(R)>>>16,F=this.i(R)&65535,_e=E.i(b)>>>16,pe=E.i(b)&65535;k[2*R+2*b]+=F*pe,_(k,2*R+2*b),k[2*R+2*b+1]+=D*pe,_(k,2*R+2*b+1),k[2*R+2*b+1]+=F*_e,_(k,2*R+2*b+1),k[2*R+2*b+2]+=D*_e,_(k,2*R+2*b+2)}for(R=0;R<S;R++)k[R]=k[2*R+1]<<16|k[2*R];for(R=S;R<2*S;R++)k[R]=0;return new i(k,0)};function _(E,S){for(;(E[S]&65535)!=E[S];)E[S+1]+=E[S]>>>16,E[S]&=65535,S++}function y(E,S){this.g=E,this.h=S}function O(E,S){if(g(S))throw Error("division by zero");if(g(E))return new y(h,h);if(v(E))return S=O(w(E),S),new y(w(S.g),w(S.h));if(v(S))return S=O(E,w(S)),new y(w(S.g),S.h);if(30<E.g.length){if(v(E)||v(S))throw Error("slowDivide_ only works with positive integers.");for(var k=d,R=S;0>=R.l(E);)k=z(k),R=z(R);var b=B(k,1),D=B(R,1);for(R=B(R,2),k=B(k,2);!g(R);){var F=D.add(R);0>=F.l(E)&&(b=b.add(k),D=F),R=B(R,1),k=B(k,1)}return S=T(E,b.j(S)),new y(b,S)}for(b=h;0<=E.l(S);){for(k=Math.max(1,Math.floor(E.m()/S.m())),R=Math.ceil(Math.log(k)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=c(k),F=D.j(S);v(F)||0<F.l(E);)k-=R,D=c(k),F=D.j(S);g(D)&&(D=d),b=b.add(D),E=T(E,F)}return new y(b,E)}t.A=function(E){return O(this,E).h},t.and=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],R=0;R<S;R++)k[R]=this.i(R)&E.i(R);return new i(k,this.h&E.h)},t.or=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],R=0;R<S;R++)k[R]=this.i(R)|E.i(R);return new i(k,this.h|E.h)},t.xor=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],R=0;R<S;R++)k[R]=this.i(R)^E.i(R);return new i(k,this.h^E.h)};function z(E){for(var S=E.g.length+1,k=[],R=0;R<S;R++)k[R]=E.i(R)<<1|E.i(R-1)>>>31;return new i(k,E.h)}function B(E,S){var k=S>>5;S%=32;for(var R=E.g.length-k,b=[],D=0;D<R;D++)b[D]=0<S?E.i(D+k)>>>S|E.i(D+k+1)<<32-S:E.i(D+k);return new i(b,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yS=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=f,La=i}).apply(typeof x_<"u"?x_:typeof self<"u"?self:typeof window<"u"?window:{});var pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _S,Gl,wS,Lf,sm,ES,TS,AS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,x,A){return u==Array.prototype||u==Object.prototype||(u[x]=A.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof pf=="object"&&pf];for(var x=0;x<u.length;++x){var A=u[x];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(u,x){if(x)e:{var A=n;u=u.split(".");for(var L=0;L<u.length-1;L++){var ee=u[L];if(!(ee in A))break e;A=A[ee]}u=u[u.length-1],L=A[u],x=x(L),x!=L&&x!=null&&e(A,u,{configurable:!0,writable:!0,value:x})}}function a(u,x){u instanceof String&&(u+="");var A=0,L=!1,ee={next:function(){if(!L&&A<u.length){var te=A++;return{value:x(te,u[te]),done:!1}}return L=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}s("Array.prototype.values",function(u){return u||function(){return a(this,function(x,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(u){var x=typeof u;return x=x!="object"?x:u?Array.isArray(u)?"array":x:"null",x=="array"||x=="object"&&typeof u.length=="number"}function c(u){var x=typeof u;return x=="object"&&u!=null||x=="function"}function f(u,x,A){return u.call.apply(u.bind,arguments)}function h(u,x,A){if(!u)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,L),u.apply(x,ee)}}return function(){return u.apply(x,arguments)}}function d(u,x,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,x){var A=Array.prototype.slice.call(arguments,1);return function(){var L=A.slice();return L.push.apply(L,arguments),u.apply(this,L)}}function g(u,x){function A(){}A.prototype=x.prototype,u.aa=x.prototype,u.prototype=new A,u.prototype.constructor=u,u.Qb=function(L,ee,te){for(var ve=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)ve[ot-2]=arguments[ot];return x.prototype[ee].apply(L,ve)}}function v(u){const x=u.length;if(0<x){const A=Array(x);for(let L=0;L<x;L++)A[L]=u[L];return A}return[]}function w(u,x){for(let A=1;A<arguments.length;A++){const L=arguments[A];if(l(L)){const ee=u.length||0,te=L.length||0;u.length=ee+te;for(let ve=0;ve<te;ve++)u[ee+ve]=L[ve]}else u.push(L)}}class T{constructor(x,A){this.i=x,this.j=A,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function _(u){return/^[\s\xa0]*$/.test(u)}function y(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var z=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function B(u,x,A){for(const L in u)x.call(A,u[L],L,u)}function E(u,x){for(const A in u)x.call(void 0,u[A],A,u)}function S(u){const x={};for(const A in u)x[A]=u[A];return x}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(u,x){let A,L;for(let ee=1;ee<arguments.length;ee++){L=arguments[ee];for(A in L)u[A]=L[A];for(let te=0;te<k.length;te++)A=k[te],Object.prototype.hasOwnProperty.call(L,A)&&(u[A]=L[A])}}function b(u){var x=1;u=u.split(":");const A=[];for(;0<x&&u.length;)A.push(u.shift()),x--;return u.length&&A.push(u.join(":")),A}function D(u){o.setTimeout(()=>{throw u},0)}function F(){var u=q;let x=null;return u.g&&(x=u.g,u.g=u.g.next,u.g||(u.h=null),x.next=null),x}class _e{constructor(){this.h=this.g=null}add(x,A){const L=pe.get();L.set(x,A),this.h?this.h.next=L:this.g=L,this.h=L}}var pe=new T(()=>new Se,u=>u.reset());class Se{constructor(){this.next=this.g=this.h=null}set(x,A){this.h=x,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ye,ie=!1,q=new _e,ue=()=>{const u=o.Promise.resolve(void 0);ye=()=>{u.then(Te)}};var Te=()=>{for(var u;u=F();){try{u.h.call(u.g)}catch(A){D(A)}var x=pe;x.j(u),100>x.h&&(x.h++,u.next=x.g,x.g=u)}ie=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(u,x){this.type=u,this.g=this.target=x,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,x=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const A=()=>{};o.addEventListener("test",A,x),o.removeEventListener("test",A,x)}catch{}return u}();function W(u,x){if(J.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var A=this.type=u.type,L=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=x,x=u.relatedTarget){if(z){e:{try{O(x.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(x=null)}}else A=="mouseover"?x=u.fromElement:A=="mouseout"&&(x=u.toElement);this.relatedTarget=x,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:re[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&W.aa.h.call(this)}}g(W,J);var re={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function ge(u,x,A,L,ee){this.listener=u,this.proxy=null,this.src=x,this.type=A,this.capture=!!L,this.ha=ee,this.key=++Ee,this.da=this.fa=!1}function oe(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function be(u){this.src=u,this.g={},this.h=0}be.prototype.add=function(u,x,A,L,ee){var te=u.toString();u=this.g[te],u||(u=this.g[te]=[],this.h++);var ve=Fe(u,x,L,ee);return-1<ve?(x=u[ve],A||(x.fa=!1)):(x=new ge(x,this.src,te,!!L,ee),x.fa=A,u.push(x)),x};function U(u,x){var A=x.type;if(A in u.g){var L=u.g[A],ee=Array.prototype.indexOf.call(L,x,void 0),te;(te=0<=ee)&&Array.prototype.splice.call(L,ee,1),te&&(oe(x),u.g[A].length==0&&(delete u.g[A],u.h--))}}function Fe(u,x,A,L){for(var ee=0;ee<u.length;++ee){var te=u[ee];if(!te.da&&te.listener==x&&te.capture==!!A&&te.ha==L)return ee}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),et={};function Be(u,x,A,L,ee){if(Array.isArray(x)){for(var te=0;te<x.length;te++)Be(u,x[te],A,L,ee);return null}return A=Lr(A),u&&u[fe]?u.K(x,A,c(L)?!!L.capture:!1,ee):xe(u,x,A,!1,L,ee)}function xe(u,x,A,L,ee,te){if(!x)throw Error("Invalid event type");var ve=c(ee)?!!ee.capture:!!ee,ot=or(u);if(ot||(u[$e]=ot=new be(u)),A=ot.add(x,A,L,ve,te),A.proxy)return A;if(L=ft(),A.proxy=L,L.src=u,L.listener=A,u.addEventListener)G||(ee=ve),ee===void 0&&(ee=!1),u.addEventListener(x.toString(),L,ee);else if(u.attachEvent)u.attachEvent(ir(x.toString()),L);else if(u.addListener&&u.removeListener)u.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return A}function ft(){function u(A){return x.call(u.src,u.listener,A)}const x=Dn;return u}function Vt(u,x,A,L,ee){if(Array.isArray(x))for(var te=0;te<x.length;te++)Vt(u,x[te],A,L,ee);else L=c(L)?!!L.capture:!!L,A=Lr(A),u&&u[fe]?(u=u.i,x=String(x).toString(),x in u.g&&(te=u.g[x],A=Fe(te,A,L,ee),-1<A&&(oe(te[A]),Array.prototype.splice.call(te,A,1),te.length==0&&(delete u.g[x],u.h--)))):u&&(u=or(u))&&(x=u.g[x.toString()],u=-1,x&&(u=Fe(x,A,L,ee)),(A=-1<u?x[u]:null)&&ar(A))}function ar(u){if(typeof u!="number"&&u&&!u.da){var x=u.src;if(x&&x[fe])U(x.i,u);else{var A=u.type,L=u.proxy;x.removeEventListener?x.removeEventListener(A,L,u.capture):x.detachEvent?x.detachEvent(ir(A),L):x.addListener&&x.removeListener&&x.removeListener(L),(A=or(x))?(U(A,u),A.h==0&&(A.src=null,x[$e]=null)):oe(u)}}}function ir(u){return u in et?et[u]:et[u]="on"+u}function Dn(u,x){if(u.da)u=!0;else{x=new W(x,this);var A=u.listener,L=u.ha||u.src;u.fa&&ar(u),u=A.call(L,x)}return u}function or(u){return u=u[$e],u instanceof be?u:null}var It="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lr(u){return typeof u=="function"?u:(u[It]||(u[It]=function(x){return u.handleEvent(x)}),u[It])}function nt(){j.call(this),this.i=new be(this),this.M=this,this.F=null}g(nt,j),nt.prototype[fe]=!0,nt.prototype.removeEventListener=function(u,x,A,L){Vt(this,u,x,A,L)};function xt(u,x){var A,L=u.F;if(L)for(A=[];L;L=L.F)A.push(L);if(u=u.M,L=x.type||x,typeof x=="string")x=new J(x,u);else if(x instanceof J)x.target=x.target||u;else{var ee=x;x=new J(L,u),R(x,ee)}if(ee=!0,A)for(var te=A.length-1;0<=te;te--){var ve=x.g=A[te];ee=Ct(ve,L,!0,x)&&ee}if(ve=x.g=u,ee=Ct(ve,L,!0,x)&&ee,ee=Ct(ve,L,!1,x)&&ee,A)for(te=0;te<A.length;te++)ve=x.g=A[te],ee=Ct(ve,L,!1,x)&&ee}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var u=this.i,x;for(x in u.g){for(var A=u.g[x],L=0;L<A.length;L++)oe(A[L]);delete u.g[x],u.h--}}this.F=null},nt.prototype.K=function(u,x,A,L){return this.i.add(String(u),x,!1,A,L)},nt.prototype.L=function(u,x,A,L){return this.i.add(String(u),x,!0,A,L)};function Ct(u,x,A,L){if(x=u.i.g[String(x)],!x)return!0;x=x.concat();for(var ee=!0,te=0;te<x.length;++te){var ve=x[te];if(ve&&!ve.da&&ve.capture==A){var ot=ve.listener,lr=ve.ha||ve.src;ve.fa&&U(u.i,ve),ee=ot.call(lr,L)!==!1&&ee}}return ee&&!L.defaultPrevented}function Mr(u,x,A){if(typeof u=="function")A&&(u=d(u,A));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:o.setTimeout(u,x||0)}function je(u){u.g=Mr(()=>{u.g=null,u.i&&(u.i=!1,je(u))},u.l);const x=u.h;u.h=null,u.m.apply(null,x)}class ht extends j{constructor(x,A){super(),this.m=x,this.l=A,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jt(u){j.call(this),this.h=u,this.g={}}g(jt,j);var vt=[];function xn(u){B(u.g,function(x,A){this.g.hasOwnProperty(A)&&ar(x)},u),u.g={}}jt.prototype.N=function(){jt.aa.N.call(this),xn(this)},jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ra=o.JSON.stringify,Ji=o.JSON.parse,yl=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function na(){}na.prototype.h=null;function ni(u){return u.h||(u.h=u.i())}function si(){}var Is={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Zi(){J.call(this,"d")}g(Zi,J);function vr(){J.call(this,"c")}g(vr,J);var Vr={},ai=null;function sa(){return ai=ai||new nt}Vr.La="serverreachability";function ns(u){J.call(this,Vr.La,u)}g(ns,J);function Cs(u){const x=sa();xt(x,new ns(x))}Vr.STAT_EVENT="statevent";function eo(u,x){J.call(this,Vr.STAT_EVENT,u),this.stat=x}g(eo,J);function qt(u){const x=sa();xt(x,new eo(x,u))}Vr.Ma="timingevent";function to(u,x){J.call(this,Vr.Ma,u),this.size=x}g(to,J);function Fn(u,x){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},x)}function H(){this.g=!0}H.prototype.xa=function(){this.g=!1};function ce(u,x,A,L,ee,te){u.info(function(){if(u.g)if(te)for(var ve="",ot=te.split("&"),lr=0;lr<ot.length;lr++){var tt=ot[lr].split("=");if(1<tt.length){var yr=tt[0];tt=tt[1];var _r=yr.split("_");ve=2<=_r.length&&_r[1]=="type"?ve+(yr+"="+tt+"&"):ve+(yr+"=redacted&")}}else ve=null;else ve=te;return"XMLHTTP REQ ("+L+") [attempt "+ee+"]: "+x+`
`+A+`
`+ve})}function me(u,x,A,L,ee,te,ve){u.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+ee+"]: "+x+`
`+A+`
`+te+" "+ve})}function I(u,x,A,L){u.info(function(){return"XMLHTTP TEXT ("+x+"): "+C(u,A)+(L?" "+L:"")})}function N(u,x){u.info(function(){return"TIMEOUT: "+x})}H.prototype.info=function(){};function C(u,x){if(!u.g)return x;if(!x)return null;try{var A=JSON.parse(x);if(A){for(u=0;u<A.length;u++)if(Array.isArray(A[u])){var L=A[u];if(!(2>L.length)){var ee=L[1];if(Array.isArray(ee)&&!(1>ee.length)){var te=ee[0];if(te!="noop"&&te!="stop"&&te!="close")for(var ve=1;ve<ee.length;ve++)ee[ve]=""}}}}return ra(A)}catch{return x}}var P={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},M;function K(){}g(K,na),K.prototype.g=function(){return new XMLHttpRequest},K.prototype.i=function(){return{}},M=new K;function Y(u,x,A,L){this.j=u,this.i=x,this.l=A,this.R=L||1,this.U=new jt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Q={},Z={};function ae(u,x,A){u.L=1,u.v=Ru(Rs(x)),u.m=A,u.P=!0,de(u,null)}function de(u,x){u.F=Date.now(),we(u),u.A=Rs(u.v);var A=u.A,L=u.R;Array.isArray(L)||(L=[String(L)]),Z1(A.i,"t",L),u.C=0,A=u.j.J,u.h=new X,u.g=xx(u.j,A?x:null,!u.m),0<u.O&&(u.M=new ht(d(u.Y,u,u.g),u.O)),x=u.U,A=u.g,L=u.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(vt[0]=ee.toString()),ee=vt);for(var te=0;te<ee.length;te++){var ve=Be(A,ee[te],L||x.handleEvent,!1,x.h||x);if(!ve)break;x.g[ve.key]=ve}x=u.H?S(u.H):{},u.m?(u.u||(u.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,x)):(u.u="GET",u.g.ea(u.A,u.u,null,x)),Cs(),ce(u.i,u.u,u.A,u.l,u.R,u.m)}Y.prototype.ca=function(u){u=u.target;const x=this.M;x&&Ps(u)==3?x.j():this.Y(u)},Y.prototype.Y=function(u){try{if(u==this.g)e:{const _r=Ps(this.g);var x=this.g.Ba();const ao=this.g.Z();if(!(3>_r)&&(_r!=3||this.g&&(this.h.h||this.g.oa()||ix(this.g)))){this.J||_r!=4||x==7||(x==8||0>=ao?Cs(3):Cs(2)),it(this);var A=this.g.Z();this.X=A;t:if(ke(this)){var L=ix(this.g);u="";var ee=L.length,te=Ps(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yt(this),st(this);var ve="";break t}this.h.i=new o.TextDecoder}for(x=0;x<ee;x++)this.h.h=!0,u+=this.h.i.decode(L[x],{stream:!(te&&x==ee-1)});L.length=0,this.h.g+=u,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=A==200,me(this.i,this.u,this.A,this.l,this.R,_r,A),this.o){if(this.T&&!this.K){t:{if(this.g){var ot,lr=this.g;if((ot=lr.g?lr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(ot)){var tt=ot;break t}}tt=null}if(A=tt)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ns(this,A);else{this.o=!1,this.s=3,qt(12),yt(this),st(this);break e}}if(this.P){A=!0;let On;for(;!this.J&&this.C<ve.length;)if(On=he(this,ve),On==Z){_r==4&&(this.s=4,qt(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(On==Q){this.s=4,qt(15),I(this.i,this.l,ve,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,On,null),Ns(this,On);if(ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_r!=4||ve.length!=0||this.h.h||(this.s=1,qt(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,ve,"[Invalid Chunked Response]"),yt(this),st(this);else if(0<ve.length&&!this.W){this.W=!0;var yr=this.j;yr.g==this&&yr.ba&&!yr.M&&(yr.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),W0(yr),yr.M=!0,qt(11))}}else I(this.i,this.l,ve,null),Ns(this,ve);_r==4&&yt(this),this.o&&!this.J&&(_r==4?dx(this.j,this):(this.o=!1,we(this)))}else HI(this.g),A==400&&0<ve.indexOf("Unknown SID")?(this.s=3,qt(12)):(this.s=0,qt(13)),yt(this),st(this)}}}catch{}finally{}};function ke(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function he(u,x){var A=u.C,L=x.indexOf(`
`,A);return L==-1?Z:(A=Number(x.substring(A,L)),isNaN(A)?Q:(L+=1,L+A>x.length?Z:(x=x.slice(L,L+A),u.C=L+A,x)))}Y.prototype.cancel=function(){this.J=!0,yt(this)};function we(u){u.S=Date.now()+u.I,Oe(u,u.I)}function Oe(u,x){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Fn(d(u.ba,u),x)}function it(u){u.B&&(o.clearTimeout(u.B),u.B=null)}Y.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(N(this.i,this.A),this.L!=2&&(Cs(),qt(17)),yt(this),this.s=2,st(this)):Oe(this,this.S-u)};function st(u){u.j.G==0||u.J||dx(u.j,u)}function yt(u){it(u);var x=u.M;x&&typeof x.ma=="function"&&x.ma(),u.M=null,xn(u.U),u.g&&(x=u.g,u.g=null,x.abort(),x.ma())}function Ns(u,x){try{var A=u.j;if(A.G!=0&&(A.g==u||nn(A.h,u))){if(!u.K&&nn(A.h,u)&&A.G==3){try{var L=A.Da.g.parse(x)}catch{L=null}if(Array.isArray(L)&&L.length==3){var ee=L;if(ee[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<u.F)Lu(A),Fu(A);else break e;H0(A),qt(18)}}else A.za=ee[1],0<A.za-A.T&&37500>ee[2]&&A.F&&A.v==0&&!A.C&&(A.C=Fn(d(A.Za,A),6e3));if(1>=ro(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else li(A,11)}else if((u.K||A.g==u)&&Lu(A),!_(x))for(ee=A.Da.g.parse(x),x=0;x<ee.length;x++){let tt=ee[x];if(A.T=tt[0],tt=tt[1],A.G==2)if(tt[0]=="c"){A.K=tt[1],A.ia=tt[2];const yr=tt[3];yr!=null&&(A.la=yr,A.j.info("VER="+A.la));const _r=tt[4];_r!=null&&(A.Aa=_r,A.j.info("SVER="+A.Aa));const ao=tt[5];ao!=null&&typeof ao=="number"&&0<ao&&(L=1.5*ao,A.L=L,A.j.info("backChannelRequestTimeoutMs_="+L)),L=A;const On=u.g;if(On){const Vu=On.g?On.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vu){var te=L.h;te.g||Vu.indexOf("spdy")==-1&&Vu.indexOf("quic")==-1&&Vu.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(U0(te,te.h),te.h=null))}if(L.D){const G0=On.g?On.g.getResponseHeader("X-HTTP-Session-Id"):null;G0&&(L.ya=G0,dt(L.I,L.D,G0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-u.F,A.j.info("Handshake RTT: "+A.R+"ms")),L=A;var ve=u;if(L.qa=gx(L,L.J?L.ia:null,L.W),ve.K){W1(L.h,ve);var ot=ve,lr=L.L;lr&&(ot.I=lr),ot.B&&(it(ot),we(ot)),L.g=ve}else fx(L);0<A.i.length&&Ou(A)}else tt[0]!="stop"&&tt[0]!="close"||li(A,7);else A.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?li(A,7):z0(A):tt[0]!="noop"&&A.l&&A.l.ta(tt),A.v=0)}}Cs(4)}catch{}}var ii=class{constructor(u,x){this.g=u,this.map=x}};function aa(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ss(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ro(u){return u.h?1:u.g?u.g.size:0}function nn(u,x){return u.h?u.h==x:u.g?u.g.has(x):!1}function U0(u,x){u.g?u.g.add(x):u.h=x}function W1(u,x){u.h&&u.h==x?u.h=null:u.g&&u.g.has(x)&&u.g.delete(x)}aa.prototype.cancel=function(){if(this.i=G1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function G1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let x=u.i;for(const A of u.g.values())x=x.concat(A.D);return x}return v(u.i)}function NI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var x=[],A=u.length,L=0;L<A;L++)x.push(u[L]);return x}x=[],A=0;for(L in u)x[A++]=u[L];return x}function RI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var x=[];u=u.length;for(var A=0;A<u;A++)x.push(A);return x}x=[],A=0;for(const L in u)x[A++]=L;return x}}}function q1(u,x){if(u.forEach&&typeof u.forEach=="function")u.forEach(x,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,x,void 0);else for(var A=RI(u),L=NI(u),ee=L.length,te=0;te<ee;te++)x.call(void 0,L[te],A&&A[te],u)}var K1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PI(u,x){if(u){u=u.split("&");for(var A=0;A<u.length;A++){var L=u[A].indexOf("="),ee=null;if(0<=L){var te=u[A].substring(0,L);ee=u[A].substring(L+1)}else te=u[A];x(te,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function oi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof oi){this.h=u.h,Cu(this,u.j),this.o=u.o,this.g=u.g,Nu(this,u.s),this.l=u.l;var x=u.i,A=new El;A.i=x.i,x.g&&(A.g=new Map(x.g),A.h=x.h),X1(this,A),this.m=u.m}else u&&(x=String(u).match(K1))?(this.h=!1,Cu(this,x[1]||"",!0),this.o=_l(x[2]||""),this.g=_l(x[3]||"",!0),Nu(this,x[4]),this.l=_l(x[5]||"",!0),X1(this,x[6]||"",!0),this.m=_l(x[7]||"")):(this.h=!1,this.i=new El(null,this.h))}oi.prototype.toString=function(){var u=[],x=this.j;x&&u.push(wl(x,Y1,!0),":");var A=this.g;return(A||x=="file")&&(u.push("//"),(x=this.o)&&u.push(wl(x,Y1,!0),"@"),u.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&u.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&u.push("/"),u.push(wl(A,A.charAt(0)=="/"?FI:DI,!0))),(A=this.i.toString())&&u.push("?",A),(A=this.m)&&u.push("#",wl(A,LI)),u.join("")};function Rs(u){return new oi(u)}function Cu(u,x,A){u.j=A?_l(x,!0):x,u.j&&(u.j=u.j.replace(/:$/,""))}function Nu(u,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);u.s=x}else u.s=null}function X1(u,x,A){x instanceof El?(u.i=x,MI(u.i,u.h)):(A||(x=wl(x,OI)),u.i=new El(x,u.h))}function dt(u,x,A){u.i.set(x,A)}function Ru(u){return dt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function _l(u,x){return u?x?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function wl(u,x,A){return typeof u=="string"?(u=encodeURI(u).replace(x,bI),A&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function bI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Y1=/[#\/\?@]/g,DI=/[#\?:]/g,FI=/[#\?]/g,OI=/[#\?@]/g,LI=/#/g;function El(u,x){this.h=this.g=null,this.i=u||null,this.j=!!x}function ia(u){u.g||(u.g=new Map,u.h=0,u.i&&PI(u.i,function(x,A){u.add(decodeURIComponent(x.replace(/\+/g," ")),A)}))}t=El.prototype,t.add=function(u,x){ia(this),this.i=null,u=no(this,u);var A=this.g.get(u);return A||this.g.set(u,A=[]),A.push(x),this.h+=1,this};function Q1(u,x){ia(u),x=no(u,x),u.g.has(x)&&(u.i=null,u.h-=u.g.get(x).length,u.g.delete(x))}function J1(u,x){return ia(u),x=no(u,x),u.g.has(x)}t.forEach=function(u,x){ia(this),this.g.forEach(function(A,L){A.forEach(function(ee){u.call(x,ee,L,this)},this)},this)},t.na=function(){ia(this);const u=Array.from(this.g.values()),x=Array.from(this.g.keys()),A=[];for(let L=0;L<x.length;L++){const ee=u[L];for(let te=0;te<ee.length;te++)A.push(x[L])}return A},t.V=function(u){ia(this);let x=[];if(typeof u=="string")J1(this,u)&&(x=x.concat(this.g.get(no(this,u))));else{u=Array.from(this.g.values());for(let A=0;A<u.length;A++)x=x.concat(u[A])}return x},t.set=function(u,x){return ia(this),this.i=null,u=no(this,u),J1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[x]),this.h+=1,this},t.get=function(u,x){return u?(u=this.V(u),0<u.length?String(u[0]):x):x};function Z1(u,x,A){Q1(u,x),0<A.length&&(u.i=null,u.g.set(no(u,x),v(A)),u.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],x=Array.from(this.g.keys());for(var A=0;A<x.length;A++){var L=x[A];const te=encodeURIComponent(String(L)),ve=this.V(L);for(L=0;L<ve.length;L++){var ee=te;ve[L]!==""&&(ee+="="+encodeURIComponent(String(ve[L]))),u.push(ee)}}return this.i=u.join("&")};function no(u,x){return x=String(x),u.j&&(x=x.toLowerCase()),x}function MI(u,x){x&&!u.j&&(ia(u),u.i=null,u.g.forEach(function(A,L){var ee=L.toLowerCase();L!=ee&&(Q1(this,L),Z1(this,ee,A))},u)),u.j=x}function VI(u,x){const A=new H;if(o.Image){const L=new Image;L.onload=m(oa,A,"TestLoadImage: loaded",!0,x,L),L.onerror=m(oa,A,"TestLoadImage: error",!1,x,L),L.onabort=m(oa,A,"TestLoadImage: abort",!1,x,L),L.ontimeout=m(oa,A,"TestLoadImage: timeout",!1,x,L),o.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=u}else x(!1)}function jI(u,x){const A=new H,L=new AbortController,ee=setTimeout(()=>{L.abort(),oa(A,"TestPingServer: timeout",!1,x)},1e4);fetch(u,{signal:L.signal}).then(te=>{clearTimeout(ee),te.ok?oa(A,"TestPingServer: ok",!0,x):oa(A,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(ee),oa(A,"TestPingServer: error",!1,x)})}function oa(u,x,A,L,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),L(A)}catch{}}function BI(){this.g=new yl}function UI(u,x,A){const L=A||"";try{q1(u,function(ee,te){let ve=ee;c(ee)&&(ve=ra(ee)),x.push(L+te+"="+encodeURIComponent(ve))})}catch(ee){throw x.push(L+"type="+encodeURIComponent("_badmap")),ee}}function Pu(u){this.l=u.Ub||null,this.j=u.eb||!1}g(Pu,na),Pu.prototype.g=function(){return new bu(this.l,this.j)},Pu.prototype.i=function(u){return function(){return u}}({});function bu(u,x){nt.call(this),this.D=u,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(bu,nt),t=bu.prototype,t.open=function(u,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=x,this.readyState=1,Al(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(x.body=u),(this.D||o).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Tl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Al(this)),this.g&&(this.readyState=3,Al(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ex(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ex(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var x=u.value?u.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!u.done}))&&(this.response=this.responseText+=x)}u.done?Tl(this):Al(this),this.readyState==3&&ex(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Tl(this))},t.Qa=function(u){this.g&&(this.response=u,Tl(this))},t.ga=function(){this.g&&Tl(this)};function Tl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Al(u)}t.setRequestHeader=function(u,x){this.u.append(u,x)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],x=this.h.entries();for(var A=x.next();!A.done;)A=A.value,u.push(A[0]+": "+A[1]),A=x.next();return u.join(`\r
`)};function Al(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(bu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function tx(u){let x="";return B(u,function(A,L){x+=L,x+=":",x+=A,x+=`\r
`}),x}function $0(u,x,A){e:{for(L in A){var L=!1;break e}L=!0}L||(A=tx(A),typeof u=="string"?A!=null&&encodeURIComponent(String(A)):dt(u,x,A))}function Nt(u){nt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Nt,nt);var $I=/^https?$/i,zI=["POST","PUT"];t=Nt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,x,A,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);x=x?x.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():M.g(),this.v=this.o?ni(this.o):ni(M),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(x,String(u),!0),this.B=!1}catch(te){rx(this,te);return}if(u=A||"",A=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var ee in L)A.set(ee,L[ee]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const te of L.keys())A.set(te,L.get(te));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(A.keys()).find(te=>te.toLowerCase()=="content-type"),ee=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(zI,x,void 0))||L||ee||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ve]of A)this.g.setRequestHeader(te,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ax(this),this.u=!0,this.g.send(u),this.u=!1}catch(te){rx(this,te)}};function rx(u,x){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=x,u.m=5,nx(u),Du(u)}function nx(u){u.A||(u.A=!0,xt(u,"complete"),xt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,xt(this,"complete"),xt(this,"abort"),Du(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Du(this,!0)),Nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?sx(this):this.bb())},t.bb=function(){sx(this)};function sx(u){if(u.h&&typeof i<"u"&&(!u.v[1]||Ps(u)!=4||u.Z()!=2)){if(u.u&&Ps(u)==4)Mr(u.Ea,0,u);else if(xt(u,"readystatechange"),Ps(u)==4){u.h=!1;try{const ve=u.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var A;if(!(A=x)){var L;if(L=ve===0){var ee=String(u.D).match(K1)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),L=!$I.test(ee?ee.toLowerCase():"")}A=L}if(A)xt(u,"complete"),xt(u,"success");else{u.m=6;try{var te=2<Ps(u)?u.g.statusText:""}catch{te=""}u.l=te+" ["+u.Z()+"]",nx(u)}}finally{Du(u)}}}}function Du(u,x){if(u.g){ax(u);const A=u.g,L=u.v[0]?()=>{}:null;u.g=null,u.v=null,x||xt(u,"ready");try{A.onreadystatechange=L}catch{}}}function ax(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ps(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ps(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var x=this.g.responseText;return u&&x.indexOf(u)==0&&(x=x.substring(u.length)),Ji(x)}};function ix(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function HI(u){const x={};u=(u.g&&2<=Ps(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<u.length;L++){if(_(u[L]))continue;var A=b(u[L]);const ee=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const te=x[ee]||[];x[ee]=te,te.push(A)}E(x,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sl(u,x,A){return A&&A.internalChannelParams&&A.internalChannelParams[u]||x}function ox(u){this.Aa=0,this.i=[],this.j=new H,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Sl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Sl("baseRetryDelayMs",5e3,u),this.cb=Sl("retryDelaySeedMs",1e4,u),this.Wa=Sl("forwardChannelMaxRetries",2,u),this.wa=Sl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new aa(u&&u.concurrentRequestLimit),this.Da=new BI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ox.prototype,t.la=8,t.G=1,t.connect=function(u,x,A,L){qt(0),this.W=u,this.H=x||{},A&&L!==void 0&&(this.H.OSID=A,this.H.OAID=L),this.F=this.X,this.I=gx(this,null,this.W),Ou(this)};function z0(u){if(lx(u),u.G==3){var x=u.U++,A=Rs(u.I);if(dt(A,"SID",u.K),dt(A,"RID",x),dt(A,"TYPE","terminate"),kl(u,A),x=new Y(u,u.j,x),x.L=2,x.v=Ru(Rs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(x.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=x.v,A=!0),A||(x.g=xx(x.j,null),x.g.ea(x.v)),x.F=Date.now(),we(x)}mx(u)}function Fu(u){u.g&&(W0(u),u.g.cancel(),u.g=null)}function lx(u){Fu(u),u.u&&(o.clearTimeout(u.u),u.u=null),Lu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Ou(u){if(!ss(u.h)&&!u.s){u.s=!0;var x=u.Ga;ye||ue(),ie||(ye(),ie=!0),q.add(x,u),u.B=0}}function WI(u,x){return ro(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=x.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Fn(d(u.Ga,u,x),px(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ee=new Y(this,this.j,u);let te=this.o;if(this.S&&(te?(te=S(te),R(te,this.S)):te=this.S),this.m!==null||this.O||(ee.H=te,te=null),this.P)e:{for(var x=0,A=0;A<this.i.length;A++){t:{var L=this.i[A];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(x+=L,4096<x){x=A;break e}if(x===4096||A===this.i.length-1){x=A+1;break e}}x=1e3}else x=1e3;x=ux(this,ee,x),A=Rs(this.I),dt(A,"RID",u),dt(A,"CVER",22),this.D&&dt(A,"X-HTTP-Session-Id",this.D),kl(this,A),te&&(this.O?x="headers="+encodeURIComponent(String(tx(te)))+"&"+x:this.m&&$0(A,this.m,te)),U0(this.h,ee),this.Ua&&dt(A,"TYPE","init"),this.P?(dt(A,"$req",x),dt(A,"SID","null"),ee.T=!0,ae(ee,A,null)):ae(ee,A,x),this.G=2}}else this.G==3&&(u?cx(this,u):this.i.length==0||ss(this.h)||cx(this))};function cx(u,x){var A;x?A=x.l:A=u.U++;const L=Rs(u.I);dt(L,"SID",u.K),dt(L,"RID",A),dt(L,"AID",u.T),kl(u,L),u.m&&u.o&&$0(L,u.m,u.o),A=new Y(u,u.j,A,u.B+1),u.m===null&&(A.H=u.o),x&&(u.i=x.D.concat(u.i)),x=ux(u,A,1e3),A.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),U0(u.h,A),ae(A,L,x)}function kl(u,x){u.H&&B(u.H,function(A,L){dt(x,L,A)}),u.l&&q1({},function(A,L){dt(x,L,A)})}function ux(u,x,A){A=Math.min(u.i.length,A);var L=u.l?d(u.l.Na,u.l,u):null;e:{var ee=u.i;let te=-1;for(;;){const ve=["count="+A];te==-1?0<A?(te=ee[0].g,ve.push("ofs="+te)):te=0:ve.push("ofs="+te);let ot=!0;for(let lr=0;lr<A;lr++){let tt=ee[lr].g;const yr=ee[lr].map;if(tt-=te,0>tt)te=Math.max(0,ee[lr].g-100),ot=!1;else try{UI(yr,ve,"req"+tt+"_")}catch{L&&L(yr)}}if(ot){L=ve.join("&");break e}}}return u=u.i.splice(0,A),x.D=u,L}function fx(u){if(!u.g&&!u.u){u.Y=1;var x=u.Fa;ye||ue(),ie||(ye(),ie=!0),q.add(x,u),u.v=0}}function H0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Fn(d(u.Fa,u),px(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,hx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Fn(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qt(10),Fu(this),hx(this))};function W0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function hx(u){u.g=new Y(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var x=Rs(u.qa);dt(x,"RID","rpc"),dt(x,"SID",u.K),dt(x,"AID",u.T),dt(x,"CI",u.F?"0":"1"),!u.F&&u.ja&&dt(x,"TO",u.ja),dt(x,"TYPE","xmlhttp"),kl(u,x),u.m&&u.o&&$0(x,u.m,u.o),u.L&&(u.g.I=u.L);var A=u.g;u=u.ia,A.L=1,A.v=Ru(Rs(x)),A.m=null,A.P=!0,de(A,u)}t.Za=function(){this.C!=null&&(this.C=null,Fu(this),H0(this),qt(19))};function Lu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function dx(u,x){var A=null;if(u.g==x){Lu(u),W0(u),u.g=null;var L=2}else if(nn(u.h,x))A=x.D,W1(u.h,x),L=1;else return;if(u.G!=0){if(x.o)if(L==1){A=x.m?x.m.length:0,x=Date.now()-x.F;var ee=u.B;L=sa(),xt(L,new to(L,A)),Ou(u)}else fx(u);else if(ee=x.s,ee==3||ee==0&&0<x.X||!(L==1&&WI(u,x)||L==2&&H0(u)))switch(A&&0<A.length&&(x=u.h,x.i=x.i.concat(A)),ee){case 1:li(u,5);break;case 4:li(u,10);break;case 3:li(u,6);break;default:li(u,2)}}}function px(u,x){let A=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(A*=2),A*x}function li(u,x){if(u.j.info("Error code "+x),x==2){var A=d(u.fb,u),L=u.Xa;const ee=!L;L=new oi(L||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Cu(L,"https"),Ru(L),ee?VI(L.toString(),A):jI(L.toString(),A)}else qt(2);u.G=0,u.l&&u.l.sa(x),mx(u),lx(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function mx(u){if(u.G=0,u.ka=[],u.l){const x=G1(u.h);(x.length!=0||u.i.length!=0)&&(w(u.ka,x),w(u.ka,u.i),u.h.i.length=0,v(u.i),u.i.length=0),u.l.ra()}}function gx(u,x,A){var L=A instanceof oi?Rs(A):new oi(A);if(L.g!="")x&&(L.g=x+"."+L.g),Nu(L,L.s);else{var ee=o.location;L=ee.protocol,x=x?x+"."+ee.hostname:ee.hostname,ee=+ee.port;var te=new oi(null);L&&Cu(te,L),x&&(te.g=x),ee&&Nu(te,ee),A&&(te.l=A),L=te}return A=u.D,x=u.ya,A&&x&&dt(L,A,x),dt(L,"VER",u.la),kl(u,L),L}function xx(u,x,A){if(x&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=u.Ca&&!u.pa?new Nt(new Pu({eb:A})):new Nt(u.pa),x.Ha(u.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vx(){}t=vx.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Mu(){}Mu.prototype.g=function(u,x){return new sn(u,x)};function sn(u,x){nt.call(this),this.g=new ox(x),this.l=u,this.h=x&&x.messageUrlParams||null,u=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(u?u["X-WebChannel-Content-Type"]=x.messageContentType:u={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(u?u["X-WebChannel-Client-Profile"]=x.va:u={"X-WebChannel-Client-Profile":x.va}),this.g.S=u,(u=x&&x.Sb)&&!_(u)&&(this.g.m=u),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!_(x)&&(this.g.D=x,u=this.h,u!==null&&x in u&&(u=this.h,x in u&&delete u[x])),this.j=new so(this)}g(sn,nt),sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},sn.prototype.close=function(){z0(this.g)},sn.prototype.o=function(u){var x=this.g;if(typeof u=="string"){var A={};A.__data__=u,u=A}else this.u&&(A={},A.__data__=ra(u),u=A);x.i.push(new ii(x.Ya++,u)),x.G==3&&Ou(x)},sn.prototype.N=function(){this.g.l=null,delete this.j,z0(this.g),delete this.g,sn.aa.N.call(this)};function yx(u){Zi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var x=u.__sm__;if(x){e:{for(const A in x){u=A;break e}u=void 0}(this.i=u)&&(u=this.i,x=x!==null&&u in x?x[u]:void 0),this.data=x}else this.data=u}g(yx,Zi);function _x(){vr.call(this),this.status=1}g(_x,vr);function so(u){this.g=u}g(so,vx),so.prototype.ua=function(){xt(this.g,"a")},so.prototype.ta=function(u){xt(this.g,new yx(u))},so.prototype.sa=function(u){xt(this.g,new _x)},so.prototype.ra=function(){xt(this.g,"b")},Mu.prototype.createWebChannel=Mu.prototype.g,sn.prototype.send=sn.prototype.o,sn.prototype.open=sn.prototype.m,sn.prototype.close=sn.prototype.close,AS=function(){return new Mu},TS=function(){return sa()},ES=Vr,sm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},P.NO_ERROR=0,P.TIMEOUT=8,P.HTTP_ERROR=6,Lf=P,V.COMPLETE="complete",wS=V,si.EventType=Is,Is.OPEN="a",Is.CLOSE="b",Is.ERROR="c",Is.MESSAGE="d",nt.prototype.listen=nt.prototype.K,Gl=si,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,_S=Nt}).apply(typeof pf<"u"?pf:typeof self<"u"?self:typeof window<"u"?window:{});const v_="@firebase/firestore",y_="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sr.UNAUTHENTICATED=new Sr(null),Sr.GOOGLE_CREDENTIALS=new Sr("google-credentials-uid"),Sr.FIRST_PARTY=new Sr("first-party-uid"),Sr.MOCK_USER=new Sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi=new g0("@firebase/firestore");function uo(){return Fi.logLevel}function Ie(t,...e){if(Fi.logLevel<=We.DEBUG){const r=e.map(r1);Fi.debug(`Firestore (${pl}): ${t}`,...r)}}function Qs(t,...e){if(Fi.logLevel<=We.ERROR){const r=e.map(r1);Fi.error(`Firestore (${pl}): ${t}`,...r)}}function Zo(t,...e){if(Fi.logLevel<=We.WARN){const r=e.map(r1);Fi.warn(`Firestore (${pl}): ${t}`,...r)}}function r1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,SS(t,n,r)}function SS(t,e,r){let n=`FIRESTORE (${pl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Qs(n),new Error(n)}function rt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||SS(e,s,n)}function Ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends rs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class i7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Sr.UNAUTHENTICATED))}shutdown(){}}class o7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class l7{constructor(e){this.t=e,this.currentUser=Sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){rt(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new zs;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new zs,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new zs)}},0),i()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(rt(typeof n.accessToken=="string",31837,{l:n}),new kS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rt(e===null||typeof e=="string",2055,{h:e}),new Sr(e)}}class c7{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class u7{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new c7(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class __{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class f7{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){rt(this.o===void 0,3512);const n=a=>{a.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.m;return this.m=a.token,Ie("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new __(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(rt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new __(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=h7(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%62))}return n}}function Ge(t,e){return t<e?-1:t>e?1:0}function am(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),a=e.charAt(n);if(s!==a)return Ld(s)===Ld(a)?Ge(s,a):Ld(s)?1:-1}return Ge(t.length,e.length)}const d7=55296,p7=57343;function Ld(t){const e=t.charCodeAt(0);return e>=d7&&e<=p7}function el(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_="__name__";class cs{constructor(e,r,n){r===void 0?r=0:r>e.length&&Pe(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Pe(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return cs.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof cs?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=cs.compareSegments(e.get(s),r.get(s));if(a!==0)return a}return Ge(e.length,r.length)}static compareSegments(e,r){const n=cs.isNumericId(e),s=cs.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?cs.extractNumericId(e).compare(cs.extractNumericId(r)):am(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return La.fromString(e.substring(4,e.length-2))}}class lt extends cs{construct(e,r,n){return new lt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new lt(r)}static emptyPath(){return new lt([])}}const m7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hr extends cs{construct(e,r,n){return new hr(e,r,n)}static isValidIdentifier(e){return m7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===w_}static keyField(){return new hr([w_])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ae(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ae(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Ae(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hr(r)}static emptyPath(){return new hr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(lt.fromString(e))}static fromName(e){return new Ne(lt.fromString(e).popFirst(5))}static empty(){return new Ne(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return lt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new lt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t,e,r){if(!r)throw new Ae(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function g7(t,e,r,n){if(e===!0&&n===!0)throw new Ae(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function E_(t){if(!Ne.isDocumentKey(t))throw new Ae(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function T_(t){if(Ne.isDocumentKey(t))throw new Ae(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function CS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pe(12329,{type:typeof t})}function es(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ae(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=_0(t);throw new Ae(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(t,e){const r={typeString:t};return e&&(r.value=e),r}function wu(t,e){if(!CS(t))throw new Ae(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const i=t[n];if(s&&typeof i!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&i!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Ae(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=-62135596800,S_=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*S_);return new mt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<A_)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/S_}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wu(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-A_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:Gt("string",mt._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{static fromTimestamp(e){return new Le(e)}static min(){return new Le(new mt(0,0))}static max(){return new Le(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=-1;function x7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Le.fromTimestamp(n===1e9?new mt(r+1,0):new mt(r,n));return new Ha(s,Ne.empty(),e)}function v7(t){return new Ha(t.readTime,t.key,Jc)}class Ha{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ha(Le.min(),Ne.empty(),Jc)}static max(){return new Ha(Le.max(),Ne.empty(),Jc)}}function y7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ne.comparator(t.documentKey,e.documentKey),r!==0?r:Ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ml(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==_7)throw t;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new se((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof se?r:se.resolve(r)}catch(r){return se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):se.reject(r)}static resolve(e){return new se((r,n)=>{r(e)})}static reject(e){return new se((r,n)=>{n(e)})}static waitFor(e){return new se((r,n)=>{let s=0,a=0,i=!1;e.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(e){let r=se.resolve(!1);for(const n of e)r=r.next(s=>s?se.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new se((n,s)=>{const a=e.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(f=>{i[c]=f,++o,o===a&&n(i)},f=>s(f))}})}static doWhile(e,r){return new se((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}function E7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function gl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}w0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=-1;function E0(t){return t==null}function Oh(t){return t===0&&1/t==-1/0}function T7(t){return typeof t=="number"&&Number.isInteger(t)&&!Oh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="";function A7(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=k_(e)),e=S7(t.get(r),e);return k_(e)}function S7(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case NS:r+="";break;default:r+=a}}return r}function k_(t){return t+NS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ti(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function RS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,r){this.comparator=e,this.root=r||ur.EMPTY}insert(e,r){return new St(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mf(this.root,e,this.comparator,!1)}getReverseIterator(){return new mf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mf(this.root,e,this.comparator,!0)}}class mf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??ur.RED,this.left=s??ur.EMPTY,this.right=a??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new ur(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return ur.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1;ur.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,r,n,s,a){return this}insert(e,r,n){return new ur(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new C_(this.data.getIterator())}getIteratorFrom(e){return new C_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Zt(this.comparator);return r.data=e,r}}class C_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(hr.comparator)}static empty(){return new un([])}unionWith(e){let r=new Zt(hr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new un(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return el(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new PS("Invalid base64 string: "+a):a}}(e);return new xr(r)}static fromUint8Array(e){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(e);return new xr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xr.EMPTY_BYTE_STRING=new xr("");const k7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wa(t){if(rt(!!t,39018),typeof t=="string"){let e=0;const r=k7.exec(t);if(rt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ft(t.seconds),nanos:Ft(t.nanos)}}function Ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ga(t){return typeof t=="string"?xr.fromBase64String(t):xr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="server_timestamp",DS="__type__",FS="__previous_value__",OS="__local_write_time__";function a1(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[DS])==null?void 0:n.stringValue)===bS}function T0(t){const e=t.mapValue.fields[FS];return a1(e)?T0(e):e}function Zc(t){const e=Wa(t.mapValue.fields[OS].timestampValue);return new mt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(e,r,n,s,a,i,o,l,c,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const Lh="(default)";class eu{constructor(e,r){this.projectId=e,this.database=r||Lh}static empty(){return new eu("","")}get isDefaultDatabase(){return this.database===Lh}isEqual(e){return e instanceof eu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="__type__",C7="__max__",gf={mapValue:{}},MS="__vector__",Mh="value";function qa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?a1(t)?4:R7(t)?9007199254740991:N7(t)?10:11:Pe(28295,{value:t})}function As(t,e){if(t===e)return!0;const r=qa(t);if(r!==qa(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zc(t).isEqual(Zc(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=Wa(s.timestampValue),o=Wa(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Ga(s.bytesValue).isEqual(Ga(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return Ft(s.geoPointValue.latitude)===Ft(a.geoPointValue.latitude)&&Ft(s.geoPointValue.longitude)===Ft(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Ft(s.integerValue)===Ft(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=Ft(s.doubleValue),o=Ft(a.doubleValue);return i===o?Oh(i)===Oh(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return el(t.arrayValue.values||[],e.arrayValue.values||[],As);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(I_(i)!==I_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!As(i[l],o[l])))return!1;return!0}(t,e);default:return Pe(52216,{left:t})}}function tu(t,e){return(t.values||[]).find(r=>As(r,e))!==void 0}function tl(t,e){if(t===e)return 0;const r=qa(t),n=qa(e);if(r!==n)return Ge(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ge(t.booleanValue,e.booleanValue);case 2:return function(a,i){const o=Ft(a.integerValue||a.doubleValue),l=Ft(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return N_(t.timestampValue,e.timestampValue);case 4:return N_(Zc(t),Zc(e));case 5:return am(t.stringValue,e.stringValue);case 6:return function(a,i){const o=Ga(a),l=Ga(i);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=Ge(o[c],l[c]);if(f!==0)return f}return Ge(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,i){const o=Ge(Ft(a.latitude),Ft(i.latitude));return o!==0?o:Ge(Ft(a.longitude),Ft(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return R_(t.arrayValue,e.arrayValue);case 10:return function(a,i){var d,m,g,v;const o=a.fields||{},l=i.fields||{},c=(d=o[Mh])==null?void 0:d.arrayValue,f=(m=l[Mh])==null?void 0:m.arrayValue,h=Ge(((g=c==null?void 0:c.values)==null?void 0:g.length)||0,((v=f==null?void 0:f.values)==null?void 0:v.length)||0);return h!==0?h:R_(c,f)}(t.mapValue,e.mapValue);case 11:return function(a,i){if(a===gf.mapValue&&i===gf.mapValue)return 0;if(a===gf.mapValue)return 1;if(i===gf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=am(l[h],f[h]);if(d!==0)return d;const m=tl(o[l[h]],c[f[h]]);if(m!==0)return m}return Ge(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Pe(23264,{he:r})}}function N_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ge(t,e);const r=Wa(t),n=Wa(e),s=Ge(r.seconds,n.seconds);return s!==0?s:Ge(r.nanos,n.nanos)}function R_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=tl(r[s],n[s]);if(a)return a}return Ge(r.length,n.length)}function rl(t){return im(t)}function im(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Wa(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ga(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ne.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=im(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${im(r.fields[i])}`;return s+"}"}(t.mapValue):Pe(61005,{value:t})}function Mf(t){switch(qa(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=T0(t);return e?16+Mf(e):16;case 5:return 2*t.stringValue.length;case 6:return Ga(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,a)=>s+Mf(a),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return ti(n.fields,(a,i)=>{s+=a.length+Mf(i)}),s}(t.mapValue);default:throw Pe(13486,{value:t})}}function P_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function om(t){return!!t&&"integerValue"in t}function i1(t){return!!t&&"arrayValue"in t}function b_(t){return!!t&&"nullValue"in t}function D_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vf(t){return!!t&&"mapValue"in t}function N7(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[LS])==null?void 0:n.stringValue)===MS}function vc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ti(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=vc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=vc(t.arrayValue.values[r]);return e}return{...t}}function R7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===C7}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.value=e}static empty(){return new Qr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Vf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=vc(r)}setAll(e){let r=hr.emptyPath(),n={},s=[];e.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=vc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());Vf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return As(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Vf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ti(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Qr(vc(this.value))}}function VS(t){const e=[];return ti(t.fields,(r,n)=>{const s=new hr([r]);if(Vf(n)){const a=VS(n.mapValue).fields;if(a.length===0)e.push(s);else for(const i of a)e.push(s.child(i))}else e.push(s)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,r,n,s,a,i,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Cr(e,0,Le.min(),Le.min(),Le.min(),Qr.empty(),0)}static newFoundDocument(e,r,n,s){return new Cr(e,1,r,Le.min(),n,s,0)}static newNoDocument(e,r){return new Cr(e,2,r,Le.min(),Le.min(),Qr.empty(),0)}static newUnknownDocument(e,r){return new Cr(e,3,r,Le.min(),Le.min(),Qr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,r){this.position=e,this.inclusive=r}}function F_(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],i=t.position[s];if(a.field.isKeyField()?n=Ne.comparator(Ne.fromName(i.referenceValue),r.key):n=tl(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function O_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!As(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,r="asc"){this.field=e,this.dir=r}}function P7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{}class Wt extends jS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new D7(e,r,n):r==="array-contains"?new L7(e,n):r==="in"?new M7(e,n):r==="not-in"?new V7(e,n):r==="array-contains-any"?new j7(e,n):new Wt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new F7(e,n):new O7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(tl(r,this.value)):r!==null&&qa(this.value)===qa(r)&&this.matchesComparison(tl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends jS{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ts(e,r)}matches(e){return BS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BS(t){return t.op==="and"}function US(t){return b7(t)&&BS(t)}function b7(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function lm(t){if(t instanceof Wt)return t.field.canonicalString()+t.op.toString()+rl(t.value);if(US(t))return t.filters.map(e=>lm(e)).join(",");{const e=t.filters.map(r=>lm(r)).join(",");return`${t.op}(${e})`}}function $S(t,e){return t instanceof Wt?function(n,s){return s instanceof Wt&&n.op===s.op&&n.field.isEqual(s.field)&&As(n.value,s.value)}(t,e):t instanceof ts?function(n,s){return s instanceof ts&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&$S(i,s.filters[o]),!0):!1}(t,e):void Pe(19439)}function zS(t){return t instanceof Wt?function(r){return`${r.field.canonicalString()} ${r.op} ${rl(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(zS).join(" ,")+"}"}(t):"Filter"}class D7 extends Wt{constructor(e,r,n){super(e,r,n),this.key=Ne.fromName(n.referenceValue)}matches(e){const r=Ne.comparator(e.key,this.key);return this.matchesComparison(r)}}class F7 extends Wt{constructor(e,r){super(e,"in",r),this.keys=HS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class O7 extends Wt{constructor(e,r){super(e,"not-in",r),this.keys=HS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function HS(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Ne.fromName(n.referenceValue))}class L7 extends Wt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return i1(r)&&tu(r.arrayValue,this.value)}}class M7 extends Wt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&tu(this.value.arrayValue,r)}}class V7 extends Wt{constructor(e,r){super(e,"not-in",r)}matches(e){if(tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!tu(this.value.arrayValue,r)}}class j7 extends Wt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!i1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>tu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,r=null,n=[],s=[],a=null,i=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.Te=null}}function L_(t,e=null,r=[],n=[],s=null,a=null,i=null){return new B7(t,e,r,n,s,a,i)}function o1(t){const e=Ve(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>lm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),E0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>rl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>rl(n)).join(",")),e.Te=r}return e.Te}function l1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!P7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!$S(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!O_(t.startAt,e.startAt)&&O_(t.endAt,e.endAt)}function cm(t){return Ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function U7(t,e,r,n,s,a,i,o){return new Eu(t,e,r,n,s,a,i,o)}function c1(t){return new Eu(t)}function M_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function WS(t){return t.collectionGroup!==null}function yc(t){const e=Ve(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new Zt(hr.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new jh(a,n))}),r.has(hr.keyField().canonicalString())||e.Ie.push(new jh(hr.keyField(),n))}return e.Ie}function vs(t){const e=Ve(t);return e.Ee||(e.Ee=$7(e,yc(t))),e.Ee}function $7(t,e){if(t.limitType==="F")return L_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new jh(s.field,a)});const r=t.endAt?new Vh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Vh(t.startAt.position,t.startAt.inclusive):null;return L_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function um(t,e){const r=t.filters.concat([e]);return new Eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function fm(t,e,r){return new Eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function A0(t,e){return l1(vs(t),vs(e))&&t.limitType===e.limitType}function GS(t){return`${o1(vs(t))}|lt:${t.limitType}`}function fo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>zS(s)).join(", ")}]`),E0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>rl(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>rl(s)).join(",")),`Target(${n})`}(vs(t))}; limitType=${t.limitType})`}function S0(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Ne.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of yc(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=F_(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,yc(n),s)||n.endAt&&!function(i,o,l){const c=F_(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,yc(n),s))}(t,e)}function z7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qS(t){return(e,r)=>{let n=!1;for(const s of yc(t)){const a=H7(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function H7(t,e,r){const n=t.field.isKeyField()?Ne.comparator(e.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?tl(l,c):Pe(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ti(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return RS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7=new St(Ne.comparator);function Js(){return W7}const KS=new St(Ne.comparator);function ql(...t){let e=KS;for(const r of t)e=e.insert(r.key,r);return e}function XS(t){let e=KS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function xi(){return _c()}function YS(){return _c()}function _c(){return new Xi(t=>t.toString(),(t,e)=>t.isEqual(e))}const G7=new St(Ne.comparator),q7=new Zt(Ne.comparator);function qe(...t){let e=q7;for(const r of t)e=e.add(r);return e}const K7=new Zt(Ge);function X7(){return K7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function QS(t){return{integerValue:""+t}}function Y7(t,e){return T7(e)?QS(e):u1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(){this._=void 0}}function Q7(t,e,r){return t instanceof Bh?function(s,a){const i={fields:{[DS]:{stringValue:bS},[OS]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&a1(a)&&(a=T0(a)),a&&(i.fields[FS]=a),{mapValue:i}}(r,e):t instanceof ru?ZS(t,e):t instanceof nu?ek(t,e):function(s,a){const i=JS(s,a),o=V_(i)+V_(s.Ae);return om(i)&&om(s.Ae)?QS(o):u1(s.serializer,o)}(t,e)}function J7(t,e,r){return t instanceof ru?ZS(t,e):t instanceof nu?ek(t,e):r}function JS(t,e){return t instanceof Uh?function(n){return om(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Bh extends k0{}class ru extends k0{constructor(e){super(),this.elements=e}}function ZS(t,e){const r=tk(e);for(const n of t.elements)r.some(s=>As(s,n))||r.push(n);return{arrayValue:{values:r}}}class nu extends k0{constructor(e){super(),this.elements=e}}function ek(t,e){let r=tk(e);for(const n of t.elements)r=r.filter(s=>!As(s,n));return{arrayValue:{values:r}}}class Uh extends k0{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function V_(t){return Ft(t.integerValue||t.doubleValue)}function tk(t){return i1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Z7(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof ru&&s instanceof ru||n instanceof nu&&s instanceof nu?el(n.elements,s.elements,As):n instanceof Uh&&s instanceof Uh?As(n.Ae,s.Ae):n instanceof Bh&&s instanceof Bh}(t.transform,e.transform)}class eV{constructor(e,r){this.version=e,this.transformResults=r}}class Cn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class I0{}function rk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new f1(t.key,Cn.none()):new Tu(t.key,t.data,Cn.none());{const r=t.data,n=Qr.empty();let s=new Zt(hr.comparator);for(let a of e.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new ri(t.key,n,new un(s.toArray()),Cn.none())}}function tV(t,e,r){t instanceof Tu?function(s,a,i){const o=s.value.clone(),l=B_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ri?function(s,a,i){if(!jf(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=B_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(nk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,r)}function wc(t,e,r,n){return t instanceof Tu?function(a,i,o,l){if(!jf(a.precondition,i))return o;const c=a.value.clone(),f=U_(a.fieldTransforms,l,i);return c.setAll(f),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof ri?function(a,i,o,l){if(!jf(a.precondition,i))return o;const c=U_(a.fieldTransforms,l,i),f=i.data;return f.setAll(nk(a)),f.setAll(c),i.convertToFoundDocument(i.version,f).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,i,o){return jf(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,r)}function rV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=JS(n.transform,s||null);a!=null&&(r===null&&(r=Qr.empty()),r.set(n.field,a))}return r||null}function j_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&el(n,s,(a,i)=>Z7(a,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Tu extends I0{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ri extends I0{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function nk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function B_(t,e,r){const n=new Map;rt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const a=t[s],i=a.transform,o=e.data.field(a.field);n.set(a.field,J7(i,o,r[s]))}return n}function U_(t,e,r){const n=new Map;for(const s of t){const a=s.transform,i=r.data.field(s.field);n.set(s.field,Q7(a,i,e))}return n}class f1 extends I0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nV extends I0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&tV(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=wc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=wc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YS();return this.mutations.forEach(s=>{const a=e.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=rk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Le.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qe())}isEqual(e){return this.batchId===e.batchId&&el(this.mutations,e.mutations,(r,n)=>j_(r,n))&&el(this.baseMutations,e.baseMutations,(r,n)=>j_(r,n))}}class h1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){rt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return G7}();const a=e.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new h1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut,Xe;function oV(t){switch(t){case ne.OK:return Pe(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Pe(15467,{code:t})}}function sk(t){if(t===void 0)return Qs("GRPC error has no .code"),ne.UNKNOWN;switch(t){case Ut.OK:return ne.OK;case Ut.CANCELLED:return ne.CANCELLED;case Ut.UNKNOWN:return ne.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return ne.INTERNAL;case Ut.UNAVAILABLE:return ne.UNAVAILABLE;case Ut.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Ut.NOT_FOUND:return ne.NOT_FOUND;case Ut.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Ut.ABORTED:return ne.ABORTED;case Ut.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Ut.DATA_LOSS:return ne.DATA_LOSS;default:return Pe(39323,{code:t})}}(Xe=Ut||(Ut={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV=new La([4294967295,4294967295],0);function $_(t){const e=lV().encode(t),r=new yS;return r.update(e),new Uint8Array(r.digest())}function z_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new La([r,n],0),new La([s,a],0)]}class d1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Kl(`Invalid padding: ${r}`);if(n<0)throw new Kl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Kl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Kl(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=La.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(La.fromNumber(n)));return s.compare(cV)===1&&(s=new La([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=$_(e),[n,s]=z_(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);if(!this.we(i))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new d1(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(e){if(this.ge===0)return;const r=$_(e),[n,s]=z_(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);this.Se(i)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new C0(Le.min(),s,new St(Ge),Js(),qe())}}class Au{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Au(n,r,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class ak{constructor(e,r){this.targetId=e,this.Ce=r}}class ik{constructor(e,r,n=xr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class H_{constructor(){this.ve=0,this.Fe=W_(),this.Me=xr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=qe(),r=qe(),n=qe();return this.Fe.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Pe(38017,{changeType:a})}}),new Au(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=W_()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,rt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Js(),this.Je=xf(),this.He=xf(),this.Ye=new St(Ge)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const a=s.target;if(cm(a))if(n===0){const i=new Ne(a.path);this.et(r,i,Cr.newNoDocument(i,Le.min()))}else rt(n===1,20013,{expectedCount:n});else{const i=this._t(r);if(i!==n){const o=this.ut(e),l=o?this.ct(o,e,i):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Ga(n).toUint8Array()}catch(l){if(l instanceof PS)return Zo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new d1(i,s,a)}catch(l){return Zo(l instanceof Kl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Ge.ht(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((a,i)=>{const o=this.ot(i);if(o){if(a.current&&cm(o.target)){const l=new Ne(o.target.path);this.It(l).has(i)||this.Et(i,l)||this.et(i,l,Cr.newNoDocument(l,e))}a.Be&&(r.set(i,a.ke()),a.qe())}});let n=qe();this.He.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,i)=>i.setReadTime(e));const s=new C0(e,r,this.Ye,this.je,n);return this.je=Js(),this.Je=xf(),this.He=xf(),this.Ye=new St(Ge),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new H_,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Zt(Ge),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Zt(Ge),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ie("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new H_),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function xf(){return new St(Ne.comparator)}function W_(){return new St(Ne.comparator)}const fV={asc:"ASCENDING",desc:"DESCENDING"},hV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dV={and:"AND",or:"OR"};class pV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function hm(t,e){return t.useProto3Json||E0(e)?e:{value:e}}function $h(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ok(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function mV(t,e){return $h(t,e.toTimestamp())}function ys(t){return rt(!!t,49232),Le.fromTimestamp(function(r){const n=Wa(r);return new mt(n.seconds,n.nanos)}(t))}function p1(t,e){return dm(t,e).canonicalString()}function dm(t,e){const r=function(s){return new lt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function lk(t){const e=lt.fromString(t);return rt(dk(e),10190,{key:e.toString()}),e}function pm(t,e){return p1(t.databaseId,e.path)}function Md(t,e){const r=lk(e);if(r.get(1)!==t.databaseId.projectId)throw new Ae(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ae(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ne(uk(r))}function ck(t,e){return p1(t.databaseId,e)}function gV(t){const e=lk(t);return e.length===4?lt.emptyPath():uk(e)}function mm(t){return new lt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uk(t){return rt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function G_(t,e,r){return{name:pm(t,e),fields:r.value.mapValue.fields}}function xV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Pe(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(c,f){return c.useProto3Json?(rt(f===void 0||typeof f=="string",58123),xr.fromBase64String(f||"")):(rt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),xr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(c){const f=c.code===void 0?ne.UNKNOWN:sk(c.code);return new Ae(f,c.message||"")}(i);r=new ik(n,s,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Md(t,n.document.name),a=ys(n.document.updateTime),i=n.document.createTime?ys(n.document.createTime):Le.min(),o=new Qr({mapValue:{fields:n.document.fields}}),l=Cr.newFoundDocument(s,a,i,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new Bf(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Md(t,n.document),a=n.readTime?ys(n.readTime):Le.min(),i=Cr.newNoDocument(s,a),o=n.removedTargetIds||[];r=new Bf([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Md(t,n.document),a=n.removedTargetIds||[];r=new Bf([],a,s,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new iV(s,a),o=n.targetId;r=new ak(o,i)}}return r}function vV(t,e){let r;if(e instanceof Tu)r={update:G_(t,e.key,e.value)};else if(e instanceof f1)r={delete:pm(t,e.key)};else if(e instanceof ri)r={update:G_(t,e.key,e.data),updateMask:IV(e.fieldMask)};else{if(!(e instanceof nV))return Pe(16599,{Vt:e.type});r={verify:pm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof Bh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ru)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof nu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Uh)return{fieldPath:i.field.canonicalString(),increment:o.Ae};throw Pe(20930,{transform:i.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:mV(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Pe(27497)}(t,e.precondition)),r}function yV(t,e){return t&&t.length>0?(rt(e!==void 0,14353),t.map(r=>function(s,a){let i=s.updateTime?ys(s.updateTime):ys(a);return i.isEqual(Le.min())&&(i=ys(a)),new eV(i,s.transformResults||[])}(r,e))):[]}function _V(t,e){return{documents:[ck(t,e.path)]}}function wV(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=ck(t,s);const a=function(c){if(c.length!==0)return hk(ts.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:ho(d.field),direction:AV(d.dir)}}(f))}(e.orderBy);i&&(r.structuredQuery.orderBy=i);const o=hm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:s}}function EV(t){let e=gV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){rt(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let a=[];r.where&&(a=function(h){const d=fk(h);return d instanceof ts&&US(d)?d.getFilters():[d]}(r.where));let i=[];r.orderBy&&(i=function(h){return h.map(d=>function(g){return new jh(po(g.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,E0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,m=h.values||[];return new Vh(m,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,m=h.values||[];return new Vh(m,d)}(r.endAt)),U7(e,s,i,a,o,"F",l,c)}function TV(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function fk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=po(r.unaryFilter.field);return Wt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=po(r.unaryFilter.field);return Wt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=po(r.unaryFilter.field);return Wt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=po(r.unaryFilter.field);return Wt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}}(t):t.fieldFilter!==void 0?function(r){return Wt.create(po(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>fk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}}(r.compositeFilter.op))}(t):Pe(30097,{filter:t})}function AV(t){return fV[t]}function SV(t){return hV[t]}function kV(t){return dV[t]}function ho(t){return{fieldPath:t.canonicalString()}}function po(t){return hr.fromServerFormat(t.fieldPath)}function hk(t){return t instanceof Wt?function(r){if(r.op==="=="){if(D_(r.value))return{unaryFilter:{field:ho(r.field),op:"IS_NAN"}};if(b_(r.value))return{unaryFilter:{field:ho(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(D_(r.value))return{unaryFilter:{field:ho(r.field),op:"IS_NOT_NAN"}};if(b_(r.value))return{unaryFilter:{field:ho(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ho(r.field),op:SV(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(s=>hk(s));return n.length===1?n[0]:{compositeFilter:{op:kV(r.op),filters:n}}}(t):Pe(54877,{filter:t})}function IV(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function dk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,r,n,s,a=Le.min(),i=Le.min(),o=xr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Aa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e){this.yt=e}}function NV(t){const e=EV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(){this.Cn=new PV}addToCollectionParentIndex(e,r){return this.Cn.add(r),se.resolve()}getCollectionParents(e,r){return se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return se.resolve()}deleteFieldIndex(e,r){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,r){return se.resolve()}getDocumentsMatchingTarget(e,r){return se.resolve(null)}getIndexType(e,r){return se.resolve(0)}getFieldIndexes(e,r){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,r){return se.resolve(Ha.min())}getMinOffsetFromCollectionGroup(e,r){return se.resolve(Ha.min())}updateCollectionGroup(e,r,n){return se.resolve()}updateIndexEntries(e,r){return se.resolve()}}class PV{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Zt(lt.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Zt(lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pk=41943040;class Xr{static withCacheSize(e){return new Xr(e,Xr.DEFAULT_COLLECTION_PERCENTILE,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr.DEFAULT_COLLECTION_PERCENTILE=10,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xr.DEFAULT=new Xr(pk,Xr.DEFAULT_COLLECTION_PERCENTILE,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xr.DISABLED=new Xr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new nl(0)}static cr(){return new nl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_="LruGarbageCollector",bV=1048576;function X_([t,e],[r,n]){const s=Ge(t,r);return s===0?Ge(e,n):s}class DV{constructor(e){this.Ir=e,this.buffer=new Zt(X_),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();X_(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class FV{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ie(K_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){gl(r)?Ie(K_,"Ignoring IndexedDB error during garbage collection: ",r):await ml(r)}await this.Vr(3e5)})}}class OV{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return se.resolve(w0.ce);const n=new DV(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ie("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(q_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),q_):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,a,i,o,l,c;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,i=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),uo()<=We.DEBUG&&Ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-f}ms
	Determined least recently used ${s} in `+(o-i)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:h})))}}function LV(t,e){return new OV(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.changes=new Xi(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Cr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&wc(n.mutation,s,un.empty(),mt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qe()){const s=xi();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let i=ql();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(e,r){const n=xi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qe()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(e,r,n,s){let a=Js();const i=_c(),o=function(){return _c()}();return r.forEach((l,c)=>{const f=n.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof ri)?a=a.insert(c.key,c):f!==void 0?(i.set(c.key,f.mutation.getFieldMask()),wc(f.mutation,c,f.mutation.getFieldMask(),mt.now())):i.set(c.key,un.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,f)=>i.set(c,f)),r.forEach((c,f)=>o.set(c,new VV(f,i.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=_c();let s=new St((i,o)=>i-o),a=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||un.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(s.get(o.batchId)||qe()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=YS();f.forEach(d=>{if(!a.has(d)){const m=rk(r.get(d),n.get(d));m!==null&&h.set(d,m),a=a.add(d)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return se.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(i){return Ne.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):WS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):se.resolve(xi());let o=Jc,l=a;return i.next(c=>se.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(f)?se.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,qe())).next(f=>({batchId:o,changes:XS(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ne(r)).next(n=>{let s=ql();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let i=ql();return this.indexManager.getCollectionParents(e,a).next(o=>se.forEach(o,l=>{const c=function(h,d){return new Eu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(f=>{f.forEach((h,d)=>{i=i.insert(h,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const f=c.getKey();i.get(f)===null&&(i=i.insert(f,Cr.newInvalidDocument(f)))});let o=ql();return i.forEach((l,c)=>{const f=a.get(l);f!==void 0&&wc(f.mutation,c,un.empty(),mt.now()),S0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return se.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ys(s.createTime)}}(r)),se.resolve()}getNamedQuery(e,r){return se.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:NV(s.bundledQuery),readTime:ys(s.readTime)}}(r)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(){this.overlays=new St(Ne.comparator),this.qr=new Map}getOverlay(e,r){return se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=xi();return se.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.St(e,r,a)}),se.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),se.resolve()}getOverlaysForCollection(e,r,n){const s=xi(),a=r.length+1,i=new Ne(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return se.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new St((c,f)=>c-f);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=a.get(c.largestBatchId);f===null&&(f=xi(),a=a.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=xi(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=s)););return se.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new aV(r,n));let a=this.qr.get(r);a===void 0&&(a=qe(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(){this.sessionToken=xr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(){this.Qr=new Zt(tr.$r),this.Ur=new Zt(tr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new tr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new tr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Ne(new lt([])),n=new tr(r,e),s=new tr(r,e+1),a=[];return this.Ur.forEachInRange([n,s],i=>{this.Gr(i),a.push(i.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ne(new lt([])),n=new tr(r,e),s=new tr(r,e+1);let a=qe();return this.Ur.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(e){const r=new tr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class tr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ne.comparator(e.key,r.key)||Ge(e.Yr,r.Yr)}static Kr(e,r){return Ge(e.Yr,r.Yr)||Ne.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Zt(tr.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new sV(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.Zr=this.Zr.add(new tr(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(i)}lookupMutationBatch(e,r){return se.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),a=s<0?0:s;return se.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?s1:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new tr(r,0),s=new tr(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,s],i=>{const o=this.Xr(i.Yr);a.push(o)}),se.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Zt(Ge);return r.forEach(s=>{const a=new tr(s,0),i=new tr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,i],o=>{n=n.add(o.Yr)})}),se.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Ne.isDocumentKey(a)||(a=a.child(""));const i=new tr(new Ne(a),0);let o=new Zt(Ge);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)},i),se.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){rt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return se.forEach(r.mutations,s=>{const a=new tr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new tr(r,0),s=this.Zr.firstAfterOrEqual(n);return se.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e){this.ri=e,this.docs=function(){return new St(Ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return se.resolve(n?n.document.mutableCopy():Cr.newInvalidDocument(r))}getEntries(e,r){let n=Js();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Cr.newInvalidDocument(s))}),se.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=Js();const i=r.path,o=new Ne(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||y7(v7(f),n)<=0||(s.has(f.key)||S0(r,f))&&(a=a.insert(f.key,f.mutableCopy()))}return se.resolve(a)}getAllFromCollectionGroup(e,r,n,s){Pe(9500)}ii(e,r){return se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new WV(this)}getSize(e){return se.resolve(this.size)}}class WV extends MV{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),se.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.persistence=e,this.si=new Xi(r=>o1(r),l1),this.lastRemoteSnapshotVersion=Le.min(),this.highestTargetId=0,this.oi=0,this._i=new m1,this.targetCount=0,this.ai=nl.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),se.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new nl(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,se.resolve()}updateTargetData(e,r){return this.Pr(r),se.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(a).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return se.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),se.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(e,i))}),se.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),se.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return se.resolve(n)}containsKey(e,r){return se.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,r){this.ui={},this.overlays={},this.ci=new w0(0),this.li=!1,this.li=!0,this.hi=new $V,this.referenceDelegate=e(this),this.Pi=new GV(this),this.indexManager=new RV,this.remoteDocumentCache=function(s){return new HV(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new CV(r),this.Ii=new BV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new UV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new zV(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ie("MemoryPersistence","Starting transaction:",e);const s=new qV(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(a=>this.referenceDelegate.di(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ai(e,r){return se.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class qV extends w7{constructor(e){super(),this.currentSequenceNumber=e}}class g1{constructor(e){this.persistence=e,this.Ri=new m1,this.Vi=null}static mi(e){return new g1(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),se.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),se.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,n=>{const s=Ne.fromPath(n);return this.gi(e,s).next(a=>{a||r.removeEntry(s,Le.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return se.or([()=>se.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class zh{constructor(e,r){this.persistence=e,this.pi=new Xi(n=>A7(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=LV(this,r)}static mi(e,r){return new zh(e,r)}Ei(){}di(e){return se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return se.forEach(this.pi,(n,s)=>this.br(e,n,s).next(a=>a?se.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,i=>this.br(e,i,r).next(o=>{o||(n++,a.removeEntry(i,Le.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Mf(e.data.value)),r}br(e,r,n){return se.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return se.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=qe(),s=qe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new x1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return wL()?8:E7(Fr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.ys(e,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.ws(e,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new KV;return this.Ss(e,r,i).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,i,o.size)})}).next(()=>a.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(uo()<=We.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",fo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(uo()<=We.DEBUG&&Ie("QueryEngine","Query:",fo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(uo()<=We.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",fo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vs(r))):se.resolve())}ys(e,r){if(M_(r))return se.resolve(null);let n=vs(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=fm(r,null,"F"),n=vs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=qe(...a);return this.ps.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,i,l.readTime)?this.ys(e,fm(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,s){return M_(r)||s.isEqual(Le.min())?se.resolve(null):this.ps.getDocuments(e,n).next(a=>{const i=this.Ds(r,a);return this.Cs(r,i,n,s)?se.resolve(null):(uo()<=We.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fo(r)),this.vs(e,i,r,x7(s,Jc)).next(o=>o))})}Ds(e,r){let n=new Zt(qS(e));return r.forEach((s,a)=>{S0(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,r,n){return uo()<=We.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",fo(r)),this.ps.getDocumentsMatchingQuery(e,r,Ha.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1="LocalStore",YV=3e8;class QV{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new St(Ge),this.xs=new Xi(a=>o1(a),l1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function JV(t,e,r,n){return new QV(t,e,r,n)}async function gk(t,e){const r=Ve(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=qe();for(const c of s){i.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of a){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:i,addedBatchIds:o}))})})}function ZV(t,e){const r=Ve(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let m=se.resolve();return d.forEach(g=>{m=m.next(()=>f.getEntry(l,g)).next(v=>{const w=c.docVersions.get(g);rt(w!==null,48541),v.version.compareTo(w)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),f.addEntry(v)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=qe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function xk(t){const e=Ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function ej(t,e){const r=Ve(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=s.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(a,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,f.addedDocuments,h)));let m=d.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(xr.EMPTY_BYTE_STRING,Le.min()).withLastLimboFreeSnapshotVersion(Le.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),s=s.insert(h,m),function(v,w,T){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=YV?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,f)&&o.push(r.Pi.updateTargetData(a,m))});let l=Js(),c=qe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,f))}),o.push(tj(a,i,e.documentUpdates).next(f=>{l=f.ks,c=f.qs})),!n.isEqual(Le.min())){const f=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(f)}return se.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=s,a))}function tj(t,e,r){let n=qe(),s=qe();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let i=Js();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Le.min())?(e.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),i=i.insert(o,l)):Ie(v1,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:i,qs:s}})}function rj(t,e){const r=Ve(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=s1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function nj(t,e){const r=Ve(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(a=>a?(s=a,se.resolve(s)):r.Pi.allocateTargetId(n).next(i=>(s=new Aa(e,i,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function gm(t,e,r){const n=Ve(t),s=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!gl(i))throw i;Ie(v1,`Failed to update sequence numbers for target ${e}: ${i}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function Y_(t,e,r){const n=Ve(t);let s=Le.min(),a=qe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,f){const h=Ve(l),d=h.xs.get(f);return d!==void 0?se.resolve(h.Ms.get(d)):h.Pi.getTargetData(c,f)}(n,i,vs(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(i,e,r?s:Le.min(),r?a:qe())).next(o=>(sj(n,z7(e),o),{documents:o,Qs:a})))}function sj(t,e,r){let n=t.Os.get(e)||Le.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class Q_{constructor(){this.activeTargetIds=X7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aj{constructor(){this.Mo=new Q_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Q_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="ConnectivityMonitor";class Z_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ie(J_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ie(J_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf=null;function xm(){return vf===null?vf=function(){return 268435456+Math.round(2147483648*Math.random())}():vf++,"0x"+vf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="RestConnection",oj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Lh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,a){const i=xm(),o=this.zo(e,r.toUriEncodedString());Ie(Vd,`Sending RPC '${e}' ${i}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,a);const{host:c}=new URL(o),f=fl(c);return this.Jo(e,o,l,n,f).then(h=>(Ie(Vd,`Received RPC '${e}' ${i}: `,h),h),h=>{throw Zo(Vd,`RPC '${e}' ${i} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,a,i){return this.Go(e,r,n,s,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>e[a]=s),n&&n.headers.forEach((s,a)=>e[a]=s)}zo(e,r){const n=oj[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="WebChannelConnection";class uj extends lj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,a){const i=xm();return new Promise((o,l)=>{const c=new _S;c.setWithCredentials(!0),c.listenOnce(wS.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Lf.NO_ERROR:const h=c.getResponseJson();Ie(Ar,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Lf.TIMEOUT:Ie(Ar,`RPC '${e}' ${i} timed out`),l(new Ae(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Lf.HTTP_ERROR:const d=c.getStatus();if(Ie(Ar,`RPC '${e}' ${i} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const v=function(T){const _=T.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(_)>=0?_:ne.UNKNOWN}(g.status);l(new Ae(v,g.message))}else l(new Ae(ne.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ae(ne.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:i,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Ie(Ar,`RPC '${e}' ${i} completed.`)}});const f=JSON.stringify(s);Ie(Ar,`RPC '${e}' ${i} sending request:`,s),c.send(r,"POST",f,n,15)})}T_(e,r,n){const s=xm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=AS(),o=TS(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=a.join("");Ie(Ar,`Creating RPC '${e}' stream ${s}: ${f}`,l);const h=i.createWebChannel(f,l);this.I_(h);let d=!1,m=!1;const g=new cj({Yo:w=>{m?Ie(Ar,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(d||(Ie(Ar,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Ie(Ar,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},Zo:()=>h.close()}),v=(w,T,_)=>{w.listen(T,y=>{try{_(y)}catch(O){setTimeout(()=>{throw O},0)}})};return v(h,Gl.EventType.OPEN,()=>{m||(Ie(Ar,`RPC '${e}' stream ${s} transport opened.`),g.o_())}),v(h,Gl.EventType.CLOSE,()=>{m||(m=!0,Ie(Ar,`RPC '${e}' stream ${s} transport closed`),g.a_(),this.E_(h))}),v(h,Gl.EventType.ERROR,w=>{m||(m=!0,Zo(Ar,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),g.a_(new Ae(ne.UNAVAILABLE,"The operation could not be completed")))}),v(h,Gl.EventType.MESSAGE,w=>{var T;if(!m){const _=w.data[0];rt(!!_,16349);const y=_,O=(y==null?void 0:y.error)||((T=y[0])==null?void 0:T.error);if(O){Ie(Ar,`RPC '${e}' stream ${s} received error:`,O);const z=O.status;let B=function(k){const R=Ut[k];if(R!==void 0)return sk(R)}(z),E=O.message;B===void 0&&(B=ne.INTERNAL,E="Unknown error status: "+z+" with message "+O.message),m=!0,g.a_(new Ae(B,E)),h.close()}else Ie(Ar,`RPC '${e}' stream ${s} received:`,_),g.u_(_)}}),v(o,ES.STAT_EVENT,w=>{w.stat===sm.PROXY?Ie(Ar,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===sm.NOPROXY&&Ie(Ar,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function jd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){return new pV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e,r,n=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew="PersistentStream";class yk{constructor(e,r,n,s,a,i,o,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vk(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(Qs(r.toString()),Qs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Ae(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ie(ew,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ie(ew,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fj extends yk{constructor(e,r,n,s,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=xV(this.serializer,e),n=function(a){if(!("targetChange"in a))return Le.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Le.min():i.readTime?ys(i.readTime):Le.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=mm(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=cm(l)?{documents:_V(a,l)}:{query:wV(a,l).ft},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=ok(a,i.resumeToken);const c=hm(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Le.min())>0){o.readTime=$h(a,i.snapshotVersion.toTimestamp());const c=hm(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=TV(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=mm(this.serializer),r.removeTarget=e,this.q_(r)}}class hj extends yk{constructor(e,r,n,s,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=yV(e.writeResults,e.commitTime),n=ys(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=mm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>vV(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{}class pj extends dj{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ae(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Go(e,dm(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ae(ne.UNKNOWN,a.toString())})}Ho(e,r,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(e,dm(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ae(ne.UNKNOWN,i.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class mj{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Qs(r),this.aa=!1):Ie("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi="RemoteStore";class gj{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(i=>{n.enqueueAndForget(async()=>{Yi(this)&&(Ie(Oi,"Restarting streams for network reachability change."),await async function(l){const c=Ve(l);c.Ea.add(4),await Su(c),c.Ra.set("Unknown"),c.Ea.delete(4),await R0(c)}(this))})}),this.Ra=new mj(n,s)}}async function R0(t){if(Yi(t))for(const e of t.da)await e(!0)}async function Su(t){for(const e of t.da)await e(!1)}function _k(t,e){const r=Ve(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),E1(r)?w1(r):xl(r).O_()&&_1(r,e))}function y1(t,e){const r=Ve(t),n=xl(r);r.Ia.delete(e),n.O_()&&wk(r,e),r.Ia.size===0&&(n.O_()?n.L_():Yi(r)&&r.Ra.set("Unknown"))}function _1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Le.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}xl(t).Y_(e)}function wk(t,e){t.Va.Ue(e),xl(t).Z_(e)}function w1(t){t.Va=new uV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),xl(t).start(),t.Ra.ua()}function E1(t){return Yi(t)&&!xl(t).x_()&&t.Ia.size>0}function Yi(t){return Ve(t).Ea.size===0}function Ek(t){t.Va=void 0}async function xj(t){t.Ra.set("Online")}async function vj(t){t.Ia.forEach((e,r)=>{_1(t,e)})}async function yj(t,e){Ek(t),E1(t)?(t.Ra.ha(e),w1(t)):t.Ra.set("Unknown")}async function _j(t,e,r){if(t.Ra.set("Online"),e instanceof ik&&e.state===2&&e.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Ie(Oi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Hh(t,n)}else if(e instanceof Bf?t.Va.Ze(e):e instanceof ak?t.Va.st(e):t.Va.tt(e),!r.isEqual(Le.min()))try{const n=await xk(t.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Va.Tt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=a.Ia.get(c);f&&a.Ia.set(c,f.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const f=a.Ia.get(l);if(!f)return;a.Ia.set(l,f.withResumeToken(xr.EMPTY_BYTE_STRING,f.snapshotVersion)),wk(a,l);const h=new Aa(f.target,l,c,f.sequenceNumber);_1(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ie(Oi,"Failed to raise snapshot:",n),await Hh(t,n)}}async function Hh(t,e,r){if(!gl(e))throw e;t.Ea.add(1),await Su(t),t.Ra.set("Offline"),r||(r=()=>xk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ie(Oi,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await R0(t)})}function Tk(t,e){return e().catch(r=>Hh(t,r,e))}async function P0(t){const e=Ve(t),r=Ka(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:s1;for(;wj(e);)try{const s=await rj(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,Ej(e,s)}catch(s){await Hh(e,s)}Ak(e)&&Sk(e)}function wj(t){return Yi(t)&&t.Ta.length<10}function Ej(t,e){t.Ta.push(e);const r=Ka(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Ak(t){return Yi(t)&&!Ka(t).x_()&&t.Ta.length>0}function Sk(t){Ka(t).start()}async function Tj(t){Ka(t).ra()}async function Aj(t){const e=Ka(t);for(const r of t.Ta)e.ea(r.mutations)}async function Sj(t,e,r){const n=t.Ta.shift(),s=h1.from(n,e,r);await Tk(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await P0(t)}async function kj(t,e){e&&Ka(t).X_&&await async function(n,s){if(function(i){return oV(i)&&i!==ne.ABORTED}(s.code)){const a=n.Ta.shift();Ka(n).B_(),await Tk(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await P0(n)}}(t,e),Ak(t)&&Sk(t)}async function tw(t,e){const r=Ve(t);r.asyncQueue.verifyOperationInProgress(),Ie(Oi,"RemoteStore received new credentials");const n=Yi(r);r.Ea.add(3),await Su(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await R0(r)}async function Ij(t,e){const r=Ve(t);e?(r.Ea.delete(2),await R0(r)):e||(r.Ea.add(2),await Su(r),r.Ra.set("Unknown"))}function xl(t){return t.ma||(t.ma=function(r,n,s){const a=Ve(r);return a.sa(),new fj(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:xj.bind(null,t),t_:vj.bind(null,t),r_:yj.bind(null,t),H_:_j.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),E1(t)?w1(t):t.Ra.set("Unknown")):(await t.ma.stop(),Ek(t))})),t.ma}function Ka(t){return t.fa||(t.fa=function(r,n,s){const a=Ve(r);return a.sa(),new hj(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Tj.bind(null,t),r_:kj.bind(null,t),ta:Aj.bind(null,t),na:Sj.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await P0(t)):(await t.fa.stop(),t.Ta.length>0&&(Ie(Oi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new zs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const i=Date.now()+n,o=new T1(e,r,i,s,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function A1(t,e){if(Qs("AsyncQueue",`${e}: ${t}`),gl(t))return new Ae(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{static emptySet(e){return new Uo(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ne.comparator(r.key,n.key):(r,n)=>Ne.comparator(r.key,n.key),this.keyedMap=ql(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Uo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Uo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(){this.ga=new St(Ne.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class sl{constructor(e,r,n,s,a,i,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new sl(e,r,Uo.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&A0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Nj{constructor(){this.queries=nw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Ve(r),a=s.queries;s.queries=nw(),a.forEach((i,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new Ae(ne.ABORTED,"Firestore shutting down"))}}function nw(){return new Xi(t=>GS(t),A0)}async function kk(t,e){const r=Ve(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.ba()&&e.Da()&&(n=2):(a=new Cj,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(s,!0);break;case 1:a.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=A1(i,`Initialization of query '${fo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&S1(r)}async function Ik(t,e){const r=Ve(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const i=a.Sa.indexOf(e);i>=0&&(a.Sa.splice(i,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Rj(t,e){const r=Ve(t);let n=!1;for(const s of e){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.Sa)o.Fa(s)&&(n=!0);i.wa=s}}n&&S1(r)}function Pj(t,e,r){const n=Ve(t),s=n.queries.get(e);if(s)for(const a of s.Sa)a.onError(r);n.queries.delete(e)}function S1(t){t.Ca.forEach(e=>{e.next()})}var vm,sw;(sw=vm||(vm={})).Ma="default",sw.Cache="cache";class Ck{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new sl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.key=e}}class Rk{constructor(e){this.key=e}}class bj{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=qe(),this.mutatedKeys=qe(),this.eu=qS(e),this.tu=new Uo(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new rw,s=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,h)=>{const d=s.get(f),m=S0(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;d&&m?d.data.isEqual(m.data)?g!==v&&(n.track({type:3,doc:m}),w=!0):this.su(d,m)||(n.track({type:2,doc:m}),w=!0,(l&&this.eu(m,l)>0||c&&this.eu(m,c)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),w=!0):d&&!m&&(n.track({type:1,doc:d}),w=!0,(l||c)&&(o=!0)),w&&(m?(i=i.add(m),a=v?a.add(f):a.delete(f)):(i=i.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{tu:i,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((f,h)=>function(m,g){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:w})}};return v(m)-v(g)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,i.length!==0||c?{snapshot:new sl(this.query,e.tu,a,i,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=qe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Rk(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Nk(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=qe();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return sl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const k1="SyncEngine";class Dj{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Fj{constructor(e){this.key=e,this.hu=!1}}class Oj{constructor(e,r,n,s,a,i){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Xi(o=>GS(o),A0),this.Iu=new Map,this.Eu=new Set,this.du=new St(Ne.comparator),this.Au=new Map,this.Ru=new m1,this.Vu={},this.mu=new Map,this.fu=nl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Lj(t,e,r=!0){const n=Lk(t);let s;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await Pk(n,e,r,!0),s}async function Mj(t,e){const r=Lk(t);await Pk(r,e,!0,!1)}async function Pk(t,e,r,n){const s=await nj(t.localStore,vs(e)),a=s.targetId,i=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await Vj(t,e,a,i==="current",s.resumeToken)),t.isPrimaryClient&&r&&_k(t.remoteStore,s),o}async function Vj(t,e,r,n,s){t.pu=(h,d,m)=>async function(v,w,T,_){let y=w.view.ru(T);y.Cs&&(y=await Y_(v.localStore,w.query,!1).then(({documents:E})=>w.view.ru(E,y)));const O=_&&_.targetChanges.get(w.targetId),z=_&&_.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(y,v.isPrimaryClient,O,z);return iw(v,w.targetId,B.au),B.snapshot}(t,h,d,m);const a=await Y_(t.localStore,e,!0),i=new bj(e,a.Qs),o=i.ru(a.documents),l=Au.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=i.applyChanges(o,t.isPrimaryClient,l);iw(t,r,c.au);const f=new Dj(e,r,i);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function jj(t,e,r){const n=Ve(t),s=n.Tu.get(e),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter(i=>!A0(i,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await gm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&y1(n.remoteStore,s.targetId),ym(n,s.targetId)}).catch(ml)):(ym(n,s.targetId),await gm(n.localStore,s.targetId,!0))}async function Bj(t,e){const r=Ve(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),y1(r.remoteStore,n.targetId))}async function Uj(t,e,r){const n=Kj(t);try{const s=await function(i,o){const l=Ve(i),c=mt.now(),f=o.reduce((m,g)=>m.add(g.key),qe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Js(),v=qe();return l.Ns.getEntries(m,f).next(w=>{g=w,g.forEach((T,_)=>{_.isValidDocument()||(v=v.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(w=>{h=w;const T=[];for(const _ of o){const y=rV(_,h.get(_.key).overlayedDocument);y!=null&&T.push(new ri(_.key,y,VS(y.value.mapValue),Cn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,T,o)}).next(w=>{d=w;const T=w.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(m,w.batchId,T)})}).then(()=>({batchId:d.batchId,changes:XS(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Vu[i.currentUser.toKey()];c||(c=new St(Ge)),c=c.insert(o,l),i.Vu[i.currentUser.toKey()]=c}(n,s.batchId,r),await ku(n,s.changes),await P0(n.remoteStore)}catch(s){const a=A1(s,"Failed to persist write");r.reject(a)}}async function bk(t,e){const r=Ve(t);try{const n=await ej(r.localStore,e);e.targetChanges.forEach((s,a)=>{const i=r.Au.get(a);i&&(rt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?i.hu=!0:s.modifiedDocuments.size>0?rt(i.hu,14607):s.removedDocuments.size>0&&(rt(i.hu,42227),i.hu=!1))}),await ku(r,n,e)}catch(n){await ml(n)}}function aw(t,e,r){const n=Ve(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((a,i)=>{const o=i.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Ve(i);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(c=!0)}),c&&S1(l)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $j(t,e,r){const n=Ve(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),a=s&&s.key;if(a){let i=new St(Ne.comparator);i=i.insert(a,Cr.newNoDocument(a,Le.min()));const o=qe().add(a),l=new C0(Le.min(),new Map,new St(Ge),i,o);await bk(n,l),n.du=n.du.remove(a),n.Au.delete(e),I1(n)}else await gm(n.localStore,e,!1).then(()=>ym(n,e,r)).catch(ml)}async function zj(t,e){const r=Ve(t),n=e.batch.batchId;try{const s=await ZV(r.localStore,e);Fk(r,n,null),Dk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ku(r,s)}catch(s){await ml(s)}}async function Hj(t,e,r){const n=Ve(t);try{const s=await function(i,o){const l=Ve(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(rt(h!==null,37113),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);Fk(n,e,r),Dk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ku(n,s)}catch(s){await ml(s)}}function Dk(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Fk(t,e,r){const n=Ve(t);let s=n.Vu[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function ym(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Ok(t,n)})}function Ok(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(y1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),I1(t))}function iw(t,e,r){for(const n of r)n instanceof Nk?(t.Ru.addReference(n.key,e),Wj(t,n)):n instanceof Rk?(Ie(k1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Ok(t,n.key)):Pe(19791,{wu:n})}function Wj(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ie(k1,"New document in limbo: "+r),t.Eu.add(n),I1(t))}function I1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ne(lt.fromString(e)),n=t.fu.next();t.Au.set(n,new Fj(r)),t.du=t.du.insert(r,n),_k(t.remoteStore,new Aa(vs(c1(r.path)),n,"TargetPurposeLimboResolution",w0.ce))}}async function ku(t,e,r){const n=Ve(t),s=[],a=[],i=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{i.push(n.pu(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=x1.As(l.targetId,c);a.push(h)}}))}),await Promise.all(i),n.Pu.H_(s),await async function(l,c){const f=Ve(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>se.forEach(c,d=>se.forEach(d.Es,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>se.forEach(d.ds,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!gl(h))throw h;Ie(v1,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const m=f.Ms.get(d),g=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(g);f.Ms=f.Ms.insert(d,v)}}}(n.localStore,a))}async function Gj(t,e){const r=Ve(t);if(!r.currentUser.isEqual(e)){Ie(k1,"User change. New user:",e.toKey());const n=await gk(r.localStore,e);r.currentUser=e,function(a,i){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new Ae(ne.CANCELLED,i))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ku(r,n.Ls)}}function qj(t,e){const r=Ve(t),n=r.Au.get(e);if(n&&n.hu)return qe().add(n.key);{let s=qe();const a=r.Iu.get(e);if(!a)return s;for(const i of a){const o=r.Tu.get(i);s=s.unionWith(o.view.nu)}return s}}function Lk(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$j.bind(null,e),e.Pu.H_=Rj.bind(null,e.eventManager),e.Pu.yu=Pj.bind(null,e.eventManager),e}function Kj(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Hj.bind(null,e),e}class Wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=N0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return JV(this.persistence,new XV,e.initialUser,this.serializer)}Cu(e){return new mk(g1.mi,this.serializer)}Du(e){return new aj}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wh.provider={build:()=>new Wh};class Xj extends Wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){rt(this.persistence.referenceDelegate instanceof zh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new FV(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Xr.withCacheSize(this.cacheSizeBytes):Xr.DEFAULT;return new mk(n=>zh.mi(n,r),this.serializer)}}class _m{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>aw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gj.bind(null,this.syncEngine),await Ij(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Nj}()}createDatastore(e){const r=N0(e.databaseInfo.databaseId),n=function(a){return new uj(a)}(e.databaseInfo);return function(a,i,o,l){return new pj(a,i,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,i,o){return new gj(n,s,a,i,o)}(this.localStore,this.datastore,e.asyncQueue,r=>aw(this.syncEngine,r,0),function(){return Z_.v()?new Z_:new ij}())}createSyncEngine(e,r){return function(s,a,i,o,l,c,f){const h=new Oj(s,a,i,o,l,c);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Ve(s);Ie(Oi,"RemoteStore shutting down."),a.Ea.add(5),await Su(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}_m.provider={build:()=>new _m};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Qs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa="FirestoreClient";class Yj{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Sr.UNAUTHENTICATED,this.clientId=n1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{Ie(Xa,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Ie(Xa,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=A1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Bd(t,e){t.asyncQueue.verifyOperationInProgress(),Ie(Xa,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await gk(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ow(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Qj(t);Ie(Xa,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>tw(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>tw(e.remoteStore,s)),t._onlineComponents=e}async function Qj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ie(Xa,"Using user provided OfflineComponentProvider");try{await Bd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ne.FAILED_PRECONDITION||s.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Zo("Error using user provided cache. Falling back to memory cache: "+r),await Bd(t,new Wh)}}else Ie(Xa,"Using default OfflineComponentProvider"),await Bd(t,new Xj(void 0));return t._offlineComponents}async function Vk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ie(Xa,"Using user provided OnlineComponentProvider"),await ow(t,t._uninitializedComponentsProvider._online)):(Ie(Xa,"Using default OnlineComponentProvider"),await ow(t,new _m))),t._onlineComponents}function Jj(t){return Vk(t).then(e=>e.syncEngine)}async function jk(t){const e=await Vk(t),r=e.eventManager;return r.onListen=Lj.bind(null,e.syncEngine),r.onUnlisten=jj.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Mj.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Bj.bind(null,e.syncEngine),r}function Zj(t,e,r={}){const n=new zs;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Mk({next:d=>{f.Nu(),i.enqueueAndForget(()=>Ik(a,h));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Ae(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&l&&l.source==="server"?c.reject(new Ae(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Ck(c1(o.path),f,{includeMetadataChanges:!0,qa:!0});return kk(a,h)}(await jk(t),t.asyncQueue,e,r,n)),n.promise}function eB(t,e,r={}){const n=new zs;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Mk({next:d=>{f.Nu(),i.enqueueAndForget(()=>Ik(a,h)),d.fromCache&&l.source==="server"?c.reject(new Ae(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Ck(o,f,{includeMetadataChanges:!0,qa:!0});return kk(a,h)}(await jk(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk="firestore.googleapis.com",cw=!0;class uw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Uk,this.ssl=cw}else this.host=e.host,this.ssl=e.ssl??cw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<bV)throw new Ae(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}g7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bk(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ae(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class b0{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new i7;switch(n.type){case"firstParty":return new u7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ae(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=lw.get(r);n&&(Ie("ComponentProvider","Removing Datastore"),lw.delete(r),n.terminate())}(this),Promise.resolve()}}function tB(t,e,r,n={}){var c;t=es(t,b0);const s=fl(e),a=t._getSettings(),i={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(CA(`https://${o}`),NA("Firestore",!0)),a.host!==Uk&&a.host!==o&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:s,emulatorOptions:n};if(!za(l,i)&&(t._setSettings(l),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=Sr.MOCK_USER;else{f=dL(n.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Ae(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Sr(d)}t._authCredentials=new o7(new kS(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new vl(this.firestore,e,this._query)}}class Lt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}toJSON(){return{type:Lt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(wu(r,Lt._jsonSchema))return new Lt(e,n||null,new Ne(lt.fromString(r.referencePath)))}}Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:Gt("string",Lt._jsonSchemaVersion),referencePath:Gt("string")};class Ma extends vl{constructor(e,r,n){super(e,r,c1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new Ne(e))}withConverter(e){return new Ma(this.firestore,e,this._path)}}function wm(t,e,...r){if(t=Mt(t),IS("collection","path",e),t instanceof b0){const n=lt.fromString(e,...r);return T_(n),new Ma(t,null,n)}{if(!(t instanceof Lt||t instanceof Ma))throw new Ae(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(lt.fromString(e,...r));return T_(n),new Ma(t.firestore,null,n)}}function Va(t,e,...r){if(t=Mt(t),arguments.length===1&&(e=n1.newId()),IS("doc","path",e),t instanceof b0){const n=lt.fromString(e,...r);return E_(n),new Lt(t,null,new Ne(n))}{if(!(t instanceof Lt||t instanceof Ma))throw new Ae(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(lt.fromString(e,...r));return E_(n),new Lt(t.firestore,t instanceof Ma?t.converter:null,new Ne(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw="AsyncQueue";class hw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vk(this,"async_queue_retry"),this._c=()=>{const n=jd();n&&Ie(fw,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=jd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=jd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new zs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;Ie(fw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Qs("INTERNAL UNHANDLED ERROR: ",dw(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=T1.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(s),s}uc(){this.nc&&Pe(47125,{Pc:dw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function dw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Qi extends b0{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new hw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hw(e),this._firestoreClient=void 0,await e}}}function rB(t,e){const r=typeof t=="object"?t:qg(),n=typeof t=="string"?t:Lh,s=qi(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=fL("firestore");a&&tB(s,...a)}return s}function C1(t){if(t._terminated)throw new Ae(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||nB(t),t._firestoreClient}function nB(t){var n,s,a;const e=t._freezeSettings(),r=function(o,l,c,f){return new I7(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Bk(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Yj(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._byteString=e}static fromBase64String(e){try{return new An(xr.fromBase64String(e))}catch(r){throw new Ae(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new An(xr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:An._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wu(e,An._jsonSchema))return An.fromBase64String(e.bytes)}}An._jsonSchemaVersion="firestore/bytes/1.0",An._jsonSchema={type:Gt("string",An._jsonSchemaVersion),bytes:Gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ae(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ae(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ae(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:_s._jsonSchemaVersion}}static fromJSON(e){if(wu(e,_s._jsonSchema))return new _s(e.latitude,e.longitude)}}_s._jsonSchemaVersion="firestore/geoPoint/1.0",_s._jsonSchema={type:Gt("string",_s._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ws._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wu(e,ws._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ws(e.vectorValues);throw new Ae(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ws._jsonSchemaVersion="firestore/vectorValue/1.0",ws._jsonSchema={type:Gt("string",ws._jsonSchemaVersion),vectorValues:Gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sB=/^__.*__$/;class aB{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ri(e,this.data,this.fieldMask,r,this.fieldTransforms):new Tu(e,this.data,r,this.fieldTransforms)}}class $k{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ri(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function zk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:t})}}class R1{constructor(e,r,n,s,a,i){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new R1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(zk(this.Ac)&&sB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class iB{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||N0(e)}Cc(e,r,n,s=!1){return new R1({Ac:e,methodName:r,Dc:n,path:hr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F0(t){const e=t._freezeSettings(),r=N0(t._databaseId);return new iB(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hk(t,e,r,n,s,a={}){const i=t.Cc(a.merge||a.mergeFields?2:0,e,r,s);P1("Data must be an object, but it was:",i,n);const o=Wk(n,i);let l,c;if(a.merge)l=new un(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const f=[];for(const h of a.mergeFields){const d=Em(e,h,r);if(!i.contains(d))throw new Ae(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);qk(f,d)||f.push(d)}l=new un(f),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new aB(new Qr(o),l,c)}class O0 extends N1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof O0}}function oB(t,e,r,n){const s=t.Cc(1,e,r);P1("Data must be an object, but it was:",s,n);const a=[],i=Qr.empty();ti(n,(l,c)=>{const f=b1(e,l,r);c=Mt(c);const h=s.yc(f);if(c instanceof O0)a.push(f);else{const d=Iu(c,h);d!=null&&(a.push(f),i.set(f,d))}});const o=new un(a);return new $k(i,o,s.fieldTransforms)}function lB(t,e,r,n,s,a){const i=t.Cc(1,e,r),o=[Em(e,n,r)],l=[s];if(a.length%2!=0)throw new Ae(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<a.length;d+=2)o.push(Em(e,a[d])),l.push(a[d+1]);const c=[],f=Qr.empty();for(let d=o.length-1;d>=0;--d)if(!qk(c,o[d])){const m=o[d];let g=l[d];g=Mt(g);const v=i.yc(m);if(g instanceof O0)c.push(m);else{const w=Iu(g,v);w!=null&&(c.push(m),f.set(m,w))}}const h=new un(c);return new $k(f,h,i.fieldTransforms)}function cB(t,e,r,n=!1){return Iu(r,t.Cc(n?4:3,e))}function Iu(t,e){if(Gk(t=Mt(t)))return P1("Unsupported field value:",e,t),Wk(t,e);if(t instanceof N1)return function(n,s){if(!zk(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Iu(o,s.wc(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=Mt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Y7(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=mt.fromDate(n);return{timestampValue:$h(s.serializer,a)}}if(n instanceof mt){const a=new mt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$h(s.serializer,a)}}if(n instanceof _s)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof An)return{bytesValue:ok(s.serializer,n._byteString)};if(n instanceof Lt){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:p1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof ws)return function(i,o){return{mapValue:{fields:{[LS]:{stringValue:MS},[Mh]:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return u1(o.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${_0(n)}`)}(t,e)}function Wk(t,e){const r={};return RS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ti(t,(n,s)=>{const a=Iu(s,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function Gk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mt||t instanceof _s||t instanceof An||t instanceof Lt||t instanceof N1||t instanceof ws)}function P1(t,e,r){if(!Gk(r)||!CS(r)){const n=_0(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Em(t,e,r){if((e=Mt(e))instanceof D0)return e._internalPath;if(typeof e=="string")return b1(t,e);throw Gh("Field path arguments must be of type string or ",t,!1,void 0,r)}const uB=new RegExp("[~\\*/\\[\\]]");function b1(t,e,r){if(e.search(uB)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new D0(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Gh(t,e,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Ae(ne.INVALID_ARGUMENT,o+t+l)}function qk(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(D1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class fB extends Kk{data(){return super.data()}}function D1(t,e){return typeof e=="string"?b1(t,e):e instanceof D0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ae(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F1{}class dB extends F1{}function Xk(t,e,...r){let n=[];e instanceof F1&&n.push(e),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof O1).length,o=a.filter(l=>l instanceof L0).length;if(i>1||i>0&&o>0)throw new Ae(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class L0 extends dB{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new L0(e,r,n)}_apply(e){const r=this._parse(e);return Qk(e._query,r),new vl(e.firestore,e.converter,um(e._query,r))}_parse(e){const r=F0(e.firestore);return function(a,i,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ae(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){mw(h,f);const g=[];for(const v of h)g.push(pw(l,a,v));d={arrayValue:{values:g}}}else d=pw(l,a,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||mw(h,f),d=cB(o,i,h,f==="in"||f==="not-in");return Wt.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Yk(t,e,r){const n=e,s=D1("where",t);return L0._create(s,n,r)}class O1 extends F1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new O1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)Qk(i,l),i=um(i,l)}(e._query,r),new vl(e.firestore,e.converter,um(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function pw(t,e,r){if(typeof(r=Mt(r))=="string"){if(r==="")throw new Ae(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!WS(e)&&r.indexOf("/")!==-1)throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(lt.fromString(r));if(!Ne.isDocumentKey(n))throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return P_(t,new Ne(n))}if(r instanceof Lt)return P_(t,r._key);throw new Ae(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_0(r)}.`)}function mw(t,e){if(!Array.isArray(t)||t.length===0)throw new Ae(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Qk(t,e){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ae(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class pB{convertValue(e,r="none"){switch(qa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ga(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ti(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var n,s,a;const r=(a=(s=(n=e.fields)==null?void 0:n[Mh].arrayValue)==null?void 0:s.values)==null?void 0:a.map(i=>Ft(i.doubleValue));return new ws(r)}convertGeoPoint(e){return new _s(Ft(e.latitude),Ft(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=T0(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zc(e));default:return null}}convertTimestamp(e){const r=Wa(e);return new mt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=lt.fromString(e);rt(dk(n),9688,{name:e});const s=new eu(n.get(1),n.get(3)),a=new Ne(n.popFirst(5));return s.isEqual(r)||Qs(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Xl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ti extends Kk{constructor(e,r,n,s,a,i){super(e,r,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Uf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(D1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Ti._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ti._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ti._jsonSchema={type:Gt("string",Ti._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class Uf extends Ti{data(e={}){return super.data(e)}}class $o{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Xl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Uf(this._firestore,this._userDataWriter,n.key,n,new Xl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ae(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new Uf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Xl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new Uf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Xl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),f=i.indexOf(o.doc.key)),{type:mB(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=$o._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=n1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function mB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(t){t=es(t,Lt);const e=es(t.firestore,Qi);return Zj(C1(e),t._key).then(r=>vB(e,t,r))}$o._jsonSchemaVersion="firestore/querySnapshot/1.0",$o._jsonSchema={type:Gt("string",$o._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class eI extends pB{constructor(e){super(),this.firestore=e}convertBytes(e){return new An(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,r)}}function tI(t){t=es(t,vl);const e=es(t.firestore,Qi),r=C1(e),n=new eI(e);return hB(t._query),eB(r,t._query).then(s=>new $o(e,n,t,s))}function rI(t,e,r){t=es(t,Lt);const n=es(t.firestore,Qi),s=Jk(t.converter,e);return M0(n,[Hk(F0(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Cn.none())])}function gB(t,e,r,...n){t=es(t,Lt);const s=es(t.firestore,Qi),a=F0(s);let i;return i=typeof(e=Mt(e))=="string"||e instanceof D0?lB(a,"updateDoc",t._key,e,r,n):oB(a,"updateDoc",t._key,e),M0(s,[i.toMutation(t._key,Cn.exists(!0))])}function nI(t){return M0(es(t.firestore,Qi),[new f1(t._key,Cn.none())])}function xB(t,e){const r=es(t.firestore,Qi),n=Va(t),s=Jk(t.converter,e);return M0(r,[Hk(F0(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Cn.exists(!1))]).then(()=>n)}function M0(t,e){return function(n,s){const a=new zs;return n.asyncQueue.enqueueAndForget(async()=>Uj(await Jj(n),s,a)),a.promise}(C1(t),e)}function vB(t,e,r){const n=r.docs.get(e._key),s=new eI(t);return new Ti(t,s,e._key,n,new Xl(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){pl=s})(hl),Ts(new Jn("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new Qi(new l7(n.getProvider("auth-internal")),new f7(i,n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ae(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eu(c.options.projectId,f)}(i,s),i);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),In(v_,y_,e),In(v_,y_,"esm2020")})();const sI="@firebase/installations",L1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI=1e4,iI=`w:${L1}`,oI="FIS_v2",yB="https://firebaseinstallations.googleapis.com/v1",_B=60*60*1e3,wB="installations",EB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Li=new Gi(wB,EB,TB);function lI(t){return t instanceof rs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI({projectId:t}){return`${yB}/projects/${t}/installations`}function uI(t){return{token:t.token,requestStatus:2,expiresIn:SB(t.expiresIn),creationTime:Date.now()}}async function fI(t,e){const n=(await e.json()).error;return Li.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function hI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function AB(t,{refreshToken:e}){const r=hI(t);return r.append("Authorization",kB(e)),r}async function dI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function SB(t){return Number(t.replace("s","000"))}function kB(t){return`${oI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IB({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=cI(t),s=hI(t),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const i={fid:r,authVersion:oI,appId:t.appId,sdkVersion:iI},o={method:"POST",headers:s,body:JSON.stringify(i)},l=await dI(()=>fetch(n,o));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:uI(c.authToken)}}else throw await fI("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB=/^[cdef][\w-]{21}$/,Tm="";function RB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=PB(t);return NB.test(r)?r:Tm}catch{return Tm}}function PB(t){return CB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI=new Map;function gI(t,e){const r=V0(t);xI(r,e),bB(r,e)}function xI(t,e){const r=mI.get(t);if(r)for(const n of r)n(e)}function bB(t,e){const r=DB();r&&r.postMessage({key:t,fid:e}),FB()}let vi=null;function DB(){return!vi&&"BroadcastChannel"in self&&(vi=new BroadcastChannel("[Firebase] FID Change"),vi.onmessage=t=>{xI(t.data.key,t.data.fid)}),vi}function FB(){mI.size===0&&vi&&(vi.close(),vi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB="firebase-installations-database",LB=1,Mi="firebase-installations-store";let Ud=null;function M1(){return Ud||(Ud=OA(OB,LB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Mi)}}})),Ud}async function qh(t,e){const r=V0(t),s=(await M1()).transaction(Mi,"readwrite"),a=s.objectStore(Mi),i=await a.get(r);return await a.put(e,r),await s.done,(!i||i.fid!==e.fid)&&gI(t,e.fid),e}async function vI(t){const e=V0(t),n=(await M1()).transaction(Mi,"readwrite");await n.objectStore(Mi).delete(e),await n.done}async function j0(t,e){const r=V0(t),s=(await M1()).transaction(Mi,"readwrite"),a=s.objectStore(Mi),i=await a.get(r),o=e(i);return o===void 0?await a.delete(r):await a.put(o,r),await s.done,o&&(!i||i.fid!==o.fid)&&gI(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V1(t){let e;const r=await j0(t.appConfig,n=>{const s=MB(n),a=VB(t,s);return e=a.registrationPromise,a.installationEntry});return r.fid===Tm?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function MB(t){const e=t||{fid:RB(),registrationStatus:0};return yI(e)}function VB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Li.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=jB(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:BB(t)}:{installationEntry:e}}async function jB(t,e){try{const r=await IB(t,e);return qh(t.appConfig,r)}catch(r){throw lI(r)&&r.customData.serverCode===409?await vI(t.appConfig):await qh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function BB(t){let e=await gw(t.appConfig);for(;e.registrationStatus===1;)await pI(100),e=await gw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await V1(t);return n||r}return e}function gw(t){return j0(t,e=>{if(!e)throw Li.create("installation-not-found");return yI(e)})}function yI(t){return UB(t)?{fid:t.fid,registrationStatus:0}:t}function UB(t){return t.registrationStatus===1&&t.registrationTime+aI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $B({appConfig:t,heartbeatServiceProvider:e},r){const n=zB(t,r),s=AB(t,r),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const i={installation:{sdkVersion:iI,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(i)},l=await dI(()=>fetch(n,o));if(l.ok){const c=await l.json();return uI(c)}else throw await fI("Generate Auth Token",l)}function zB(t,{fid:e}){return`${cI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j1(t,e=!1){let r;const n=await j0(t.appConfig,a=>{if(!_I(a))throw Li.create("not-registered");const i=a.authToken;if(!e&&GB(i))return a;if(i.requestStatus===1)return r=HB(t,e),a;{if(!navigator.onLine)throw Li.create("app-offline");const o=KB(a);return r=WB(t,o),o}});return r?await r:n.authToken}async function HB(t,e){let r=await xw(t.appConfig);for(;r.authToken.requestStatus===1;)await pI(100),r=await xw(t.appConfig);const n=r.authToken;return n.requestStatus===0?j1(t,e):n}function xw(t){return j0(t,e=>{if(!_I(e))throw Li.create("not-registered");const r=e.authToken;return XB(r)?{...e,authToken:{requestStatus:0}}:e})}async function WB(t,e){try{const r=await $B(t,e),n={...e,authToken:r};return await qh(t.appConfig,n),r}catch(r){if(lI(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await vI(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await qh(t.appConfig,n)}throw r}}function _I(t){return t!==void 0&&t.registrationStatus===2}function GB(t){return t.requestStatus===2&&!qB(t)}function qB(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+_B}function KB(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function XB(t){return t.requestStatus===1&&t.requestTime+aI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YB(t){const e=t,{installationEntry:r,registrationPromise:n}=await V1(e);return n?n.catch(console.error):j1(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QB(t,e=!1){const r=t;return await JB(r),(await j1(r,e)).token}async function JB(t){const{registrationPromise:e}=await V1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZB(t){if(!t||!t.options)throw $d("App Configuration");if(!t.name)throw $d("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw $d(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function $d(t){return Li.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="installations",eU="installations-internal",tU=t=>{const e=t.getProvider("app").getImmediate(),r=ZB(e),n=qi(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},rU=t=>{const e=t.getProvider("app").getImmediate(),r=qi(e,wI).getImmediate();return{getId:()=>YB(r),getToken:s=>QB(r,s)}};function nU(){Ts(new Jn(wI,tU,"PUBLIC")),Ts(new Jn(eU,rU,"PRIVATE"))}nU();In(sI,L1);In(sI,L1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="analytics",sU="firebase_id",aU="origin",iU=60*1e3,oU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",B1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn=new g0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},hn=new Gi("analytics","Analytics",lU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cU(t){if(!t.startsWith(B1)){const e=hn.create("invalid-gtag-resource",{gtagURL:t});return rn.warn(e.message),""}return t}function EI(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function uU(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function fU(t,e){const r=uU("firebase-js-sdk-policy",{createScriptURL:cU}),n=document.createElement("script"),s=`${B1}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function hU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function dU(t,e,r,n,s,a){const i=n[s];try{if(i)await e[i];else{const l=(await EI(r)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(o){rn.error(o)}t("config",s,a)}async function pU(t,e,r,n,s){try{let a=[];if(s&&s.send_to){let i=s.send_to;Array.isArray(i)||(i=[i]);const o=await EI(r);for(const l of i){const c=o.find(h=>h.measurementId===l),f=c&&e[c.appId];if(f)a.push(f);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),t("event",n,s||{})}catch(a){rn.error(a)}}function mU(t,e,r,n){async function s(a,...i){try{if(a==="event"){const[o,l]=i;await pU(t,e,r,o,l)}else if(a==="config"){const[o,l]=i;await dU(t,e,r,n,o,l)}else if(a==="consent"){const[o,l]=i;t("consent",o,l)}else if(a==="get"){const[o,l,c]=i;t("get",o,l,c)}else if(a==="set"){const[o]=i;t("set",o)}else t(a,...i)}catch(o){rn.error(o)}}return s}function gU(t,e,r,n,s){let a=function(...i){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=mU(a,t,e,r),{gtagCore:a,wrappedGtag:window[s]}}function xU(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(B1)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=30,yU=1e3;class _U{constructor(e={},r=yU){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const TI=new _U;function wU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function EU(t){var i;const{appId:e,apiKey:r}=t,n={method:"GET",headers:wU(r)},s=oU.replace("{app-id}",e),a=await fetch(s,n);if(a.status!==200&&a.status!==304){let o="";try{const l=await a.json();(i=l.error)!=null&&i.message&&(o=l.error.message)}catch{}throw hn.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function TU(t,e=TI,r){const{appId:n,apiKey:s,measurementId:a}=t.options;if(!n)throw hn.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:n};throw hn.create("no-api-key")}const i=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new kU;return setTimeout(async()=>{o.abort()},iU),AI({appId:n,apiKey:s,measurementId:a},i,o,e)}async function AI(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=TI){var o;const{appId:a,measurementId:i}=t;try{await AU(n,e)}catch(l){if(i)return rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:a,measurementId:i};throw l}try{const l=await EU(t);return s.deleteThrottleMetadata(a),l}catch(l){const c=l;if(!SU(c)){if(s.deleteThrottleMetadata(a),i)return rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:a,measurementId:i};throw l}const f=Number((o=c==null?void 0:c.customData)==null?void 0:o.httpStatus)===503?zy(r,s.intervalMillis,vU):zy(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return s.setThrottleMetadata(a,h),rn.debug(`Calling attemptFetch again in ${f} millis`),AI(t,h,n,s)}}function AU(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(a),n(hn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function SU(t){if(!(t instanceof rs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class kU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function IU(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const a=await e,i={...n,send_to:a};t("event",r,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CU(){if(PA())try{await bA()}catch(t){return rn.warn(hn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return rn.warn(hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function NU(t,e,r,n,s,a,i){const o=TU(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&rn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>rn.error(d)),e.push(o);const l=CU().then(d=>{if(d)return n.getId()}),[c,f]=await Promise.all([o,l]);xU(a)||fU(a,c.measurementId),s("js",new Date);const h=(i==null?void 0:i.config)??{};return h[aU]="firebase",h.update=!0,f!=null&&(h[sU]=f),s("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(e){this.app=e}_delete(){return delete Ec[this.app.options.appId],Promise.resolve()}}let Ec={},vw=[];const yw={};let zd="dataLayer",PU="gtag",_w,SI,ww=!1;function bU(){const t=[];if(RA()&&t.push("This is a browser extension environment."),EL()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=hn.create("invalid-analytics-context",{errorInfo:e});rn.warn(r.message)}}function DU(t,e,r){bU();const n=t.options.appId;if(!n)throw hn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw hn.create("no-api-key");if(Ec[n]!=null)throw hn.create("already-exists",{id:n});if(!ww){hU(zd);const{wrappedGtag:a,gtagCore:i}=gU(Ec,vw,yw,zd,PU);SI=a,_w=i,ww=!0}return Ec[n]=NU(t,vw,yw,e,_w,zd,r),new RU(t)}function FU(t=qg()){t=Mt(t);const e=qi(t,Kh);return e.isInitialized()?e.getImmediate():OU(t)}function OU(t,e={}){const r=qi(t,Kh);if(r.isInitialized()){const s=r.getImmediate();if(za(e,r.getOptions()))return s;throw hn.create("already-initialized")}return r.initialize({options:e})}function LU(t,e,r,n){t=Mt(t),IU(SI,Ec[t.app.options.appId],e,r,n).catch(s=>rn.error(s))}const Ew="@firebase/analytics",Tw="0.10.18";function MU(){Ts(new Jn(Kh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return DU(n,s,r)},"PUBLIC")),Ts(new Jn("analytics-internal",t,"PRIVATE")),In(Ew,Tw),In(Ew,Tw,"esm2020");function t(e){try{const r=e.getProvider(Kh).getImmediate();return{logEvent:(n,s,a)=>LU(r,n,s,a)}}catch(r){throw hn.create("interop-component-reg-failed",{reason:r})}}}MU();const VU={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},U1=LA(VU),yf=r7(U1),fs=rB(U1);typeof window<"u"&&FU(U1);const kI=ze.createContext(),$1=()=>{const t=ze.useContext(kI);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},jU=({children:t})=>{const[e,r]=ze.useState(null),[n,s]=ze.useState(!0),[a,i]=ze.useState(null),o=async(h,d,m)=>{try{i(null);const g=await VM(yf,h,d);return m&&await UM(g.user,{displayName:m}),g.user}catch(g){throw i(g.message),g}},l=async(h,d)=>{try{return i(null),(await jM(yf,h,d)).user}catch(m){throw i(m.message),m}},c=async()=>{try{i(null),await WM(yf)}catch(h){throw i(h.message),h}};ze.useEffect(()=>HM(yf,d=>{r(d),s(!1)}),[]);const f={user:e,loading:n,error:a,register:o,login:l,logout:c,clearError:()=>i(null)};return p.jsx(kI.Provider,{value:f,children:t})},hs={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData"};let su=!1;const ds=(t,e)=>{if(t.code==="permission-denied")return su||(console.warn(" Firebase Firestore: Permisos insuficientes. La aplicacin funciona en modo demo."),console.info(" Para habilitar persistencia, configura Firestore siguiendo las instrucciones en FIREBASE_SETUP.md"),su=!0),null;if(t.code==="failed-precondition"&&t.message.includes("index"))return console.info(" Firebase est creando ndices necesarios. Usando datos locales temporalmente."),console.info(" Estado del ndice: https://console.firebase.google.com/project/centralteleoperadores/firestore/indexes"),null;throw console.error(`Error en ${e}:`,t),t},$f={async create(t,e){try{return{id:(await xB(wm(fs,hs.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){return ds(r,"crear operador")}},async getByUser(t){if(su)return[];try{const e=Xk(wm(fs,hs.OPERATORS),Yk("userId","==",t));return(await tI(e)).docs.map(s=>({id:s.id,...s.data()})).sort((s,a)=>{var l,c,f,h;const i=((c=(l=s.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(0);return(((h=(f=a.createdAt)==null?void 0:f.toDate)==null?void 0:h.call(f))||new Date(0))-i})}catch(e){return ds(e,"obtener operadores")||[]}},async update(t,e){try{const r=Va(fs,hs.OPERATORS,t);return await gB(r,{...e,updatedAt:new Date}),!0}catch(r){return ds(r,"actualizar operador")}},async delete(t){try{return await nI(Va(fs,hs.OPERATORS,t)),!0}catch(e){return ds(e,"eliminar operador")}}},Yl={async saveOperatorAssignments(t,e,r){try{const n=Va(fs,hs.ASSIGNMENTS,`${t}_${e}`);return await rI(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date}),!0}catch(n){return ds(n,"guardar asignaciones")}},async getOperatorAssignments(t,e){try{const r=Va(fs,hs.ASSIGNMENTS,`${t}_${e}`),n=await Zk(r);return n.exists()?n.data().assignments||[]:[]}catch(r){return ds(r,"obtener asignaciones")||[]}},async getAllUserAssignments(t){if(su)return{};try{const e=Xk(wm(fs,hs.ASSIGNMENTS),Yk("userId","==",t)),r=await tI(e),n={};return r.docs.forEach(s=>{const a=s.data();n[a.operatorId]=a.assignments||[]}),n}catch(e){return ds(e,"obtener todas las asignaciones")||{}}},async deleteOperatorAssignments(t,e){try{return await nI(Va(fs,hs.ASSIGNMENTS,`${t}_${e}`)),!0}catch(r){return ds(r,"eliminar asignaciones")}}},Aw={async saveCallData(t,e){try{const r=Va(fs,hs.CALL_DATA,t);return await rI(r,{userId:t,callData:e,updatedAt:new Date}),!0}catch(r){return ds(r,"guardar datos de llamadas")}},async getCallData(t){if(su)return[];try{const e=Va(fs,hs.CALL_DATA,t),r=await Zk(e);return r.exists()?r.data().callData||[]:[]}catch(e){return ds(e,"obtener datos de llamadas")||[]}}},Sw=t=>{let e;const r=new Set,n=(c,f)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const d=e;e=f??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(m=>m(e,d))}},s=()=>e,o={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,s,o);return o},BU=t=>t?Sw(t):Sw,UU=t=>t;function $U(t,e=UU){const r=Tc.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Tc.useDebugValue(r),r}const kw=t=>{const e=BU(t),r=n=>$U(e,n);return Object.assign(r,e),r},z1=t=>t?kw(t):kw;function B0(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var a;const i=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(s))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const Am=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Am(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Am(n)(r)}}}},zU=(t,e)=>(r,n,s)=>{let a={storage:B0(()=>localStorage),partialize:v=>v,version:0,merge:(v,w)=>({...w,...v}),...e},i=!1;const o=new Set,l=new Set;let c=a.storage;if(!c)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...v)},n,s);const f=()=>{const v=a.partialize({...n()});return c.setItem(a.name,{state:v,version:a.version})},h=s.setState;s.setState=(v,w)=>{h(v,w),f()};const d=t((...v)=>{r(...v),f()},n,s);s.getInitialState=()=>d;let m;const g=()=>{var v,w;if(!c)return;i=!1,o.forEach(_=>{var y;return _((y=n())!=null?y:d)});const T=((w=a.onRehydrateStorage)==null?void 0:w.call(a,(v=n())!=null?v:d))||void 0;return Am(c.getItem.bind(c))(a.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==a.version){if(a.migrate){const y=a.migrate(_.state,_.version);return y instanceof Promise?y.then(O=>[!0,O]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var y;const[O,z]=_;if(m=a.merge(z,(y=n())!=null?y:d),r(m,!0),O)return f()}).then(()=>{T==null||T(m,void 0),m=n(),i=!0,l.forEach(_=>_(m))}).catch(_=>{T==null||T(void 0,_)})};return s.persist={setOptions:v=>{a={...a,...v},v.storage&&(c=v.storage)},clearStorage:()=>{c==null||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},a.skipHydration||g(),m||d},H1=zU;z1(H1((t,e)=>({user:null,isAuthenticated:!1,loading:!1,error:null,setUser:r=>{t({user:r,isAuthenticated:!!r,error:null})},setLoading:r=>{t({loading:r})},setError:r=>{t({error:r})},logout:()=>{t({user:null,isAuthenticated:!1,loading:!1,error:null})},updateUser:r=>{const n=e().user;n&&t({user:{...n,...r}})},getUserDisplayName:()=>{const{user:r}=e();return(r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"Usuario"},getUserEmail:()=>{const{user:r}=e();return(r==null?void 0:r.email)||""},isAdmin:()=>{const{user:r}=e();return(r==null?void 0:r.role)==="admin"||!1}}),{name:"user-storage",storage:B0(()=>localStorage),partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated})}));const II=z1(H1((t,e)=>({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},isLoading:!1,loadingStage:null,loadingMessage:"",lastUpdated:null,dataSource:null,filters:{dateRange:null,operator:null,status:"all",commune:null},setCallData:(r,n="excel")=>{const s=new Date().toISOString();t({callData:r,dataSource:n,lastUpdated:s,isLoading:!1,loadingStage:"complete",loadingMessage:`${r.length} llamadas cargadas exitosamente`}),e().analyzeCallData()},setLoading:(r,n=null,s="")=>{t({isLoading:r,loadingStage:n,loadingMessage:s})},setLoadingStage:(r,n="")=>{t({loadingStage:r,loadingMessage:n||{uploading:"Subiendo archivo Excel...",processing:"Procesando datos del archivo...",analyzing:"Analizando llamadas y generando mtricas...",complete:"Anlisis completado exitosamente",error:"Error durante el procesamiento"}[r]||"",isLoading:r!=="complete"&&r!=="error"})},analyzeCallData:()=>{const{callData:r}=e();if(e().setLoadingStage("analyzing","Analizando datos de llamadas..."),!r||r.length===0){t({processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},loadingStage:"complete",loadingMessage:"No hay datos para analizar",isLoading:!1});return}setTimeout(()=>{const n=r.map(f=>({...f,duracion:parseInt(f.duracion)||0,isSuccessful:f.categoria==="exitosa"||f.result==="Llamado exitoso",fecha:f.fecha||"N/A",hora:f.hora?parseInt(f.hora.split(":")[0]):null})),s=n.filter(f=>f.isSuccessful),a=new Set(n.map(f=>f.beneficiario||f.beneficiary)).size,i=n.reduce((f,h)=>f+(h.duracion||0),0),o=n.length>0?Math.round(i/n.length):0,l=n.length>0?Math.round(s.length/n.length*100):0,c={totalCalls:n.length,successfulCalls:s.length,failedCalls:n.length-s.length,averageDuration:o,uniqueBeneficiaries:a,protocolCompliance:l};t({processedData:n,callMetrics:c,loadingStage:"complete",loadingMessage:`Anlisis completado: ${n.length} llamadas procesadas`,isLoading:!1})},800)},setFilters:r=>{t(n=>({filters:{...n.filters,...r}}))},getFilteredData:()=>{const{processedData:r,filters:n}=e();let s=[...r];if(n.operator&&n.operator!=="all"&&(s=s.filter(a=>a.operator===n.operator)),n.status&&n.status!=="all"&&(n.status==="successful"?s=s.filter(a=>a.isSuccessful):n.status==="failed"&&(s=s.filter(a=>!a.isSuccessful))),n.commune&&n.commune!=="all"&&(s=s.filter(a=>a.commune===n.commune)),n.dateRange){const{start:a,end:i}=n.dateRange;s=s.filter(o=>{const l=new Date(o.date);return l>=new Date(a)&&l<=new Date(i)})}return s},clearData:()=>{t({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},lastUpdated:null,dataSource:null,isLoading:!1,loadingStage:null,loadingMessage:""})},getOperatorMetrics:(r=null)=>{try{const{callData:n}=e();if(console.log(" SISTEMA ROBUSTO - Anlisis por telfono:"),console.log("- callData length:",(n==null?void 0:n.length)||0),console.log("- operatorAssignments length:",(r==null?void 0:r.length)||0),!n||n.length===0)return console.log(" No hay datos de llamadas"),[];if(!r||!Array.isArray(r)||r.length===0)return console.log(" No hay asignaciones vlidas"),[];const s={};let a=0;r.forEach(g=>{const v=g.operator||g.operatorName||"Sin Asignar",w=[];g.phone&&w.push(g.phone),g.primaryPhone&&w.push(g.primaryPhone),g.telefono&&w.push(g.telefono),g.numero_cliente&&w.push(g.numero_cliente),g.phones&&Array.isArray(g.phones)&&w.push(...g.phones),g.phone&&g.phone.includes(";")&&w.push(...g.phone.split(";").map(T=>T.trim())),g.primaryPhone&&g.primaryPhone.includes(";")&&w.push(...g.primaryPhone.split(";").map(T=>T.trim())),w.forEach(T=>{if(T&&T!=="N/A"&&T.trim()){const _=T.toString().replace(/[^\d]/g,"");if(_.length>=8){const y=_.slice(-8);s[y]=v,a++}}})}),console.log(` Telfonos procesados: ${a}`),console.log(` Mapa telfono-operadora creado con ${Object.keys(s).length} entradas`),console.log(" Primeros 5 mapeos:",Object.entries(s).slice(0,5));const i=[...new Set(Object.values(s))],o={};i.forEach(g=>{o[g]={operatorName:g,totalCalls:0,successfulCalls:0,failedCalls:0,totalDuration:0,matchedCalls:0}}),console.log(` Operadoras inicializadas: ${i.join(", ")}`);let l=0,c=0;n.forEach((g,v)=>{const w=g.phone||g.telefono||g.numero||g.numero_cliente||g.numero_telefono||"";if(w&&w.trim()){const T=w.toString().replace(/[^\d]/g,"");if(T.length>=8){const _=T.slice(-8),y=s[_];if(y&&o[y]){l++;const O=o[y];O.totalCalls++,O.matchedCalls++;const z=parseInt(g.duration||g.duracion||0);O.totalDuration+=z;const B=(g.result||g.resultado||g.estado||"").toLowerCase();B.includes("exitosa")||B.includes("exitoso")||B.includes("contactado")||B.includes("atendida")||B.includes("respuesta")||B.includes("contesto")||B.includes("completada")||B.includes("respondio")?O.successfulCalls++:O.failedCalls++,v%500===0&&console.log(` Procesando llamada ${v}: ${w}  ${y}`)}else c++,c<=5&&console.log(` Llamada sin asignacin: ${w} (${_})`)}}}),console.log(" RESULTADOS DEL PROCESAMIENTO:"),console.log(`- Total llamadas: ${n.length}`),console.log(`- Llamadas coincidentes: ${l}`),console.log(`- Llamadas sin asignacin: ${c}`),console.log(`- Porcentaje de cobertura: ${(l/n.length*100).toFixed(1)}%`);const f=Object.values(o).filter(g=>g.totalCalls>0).map(g=>({operatorName:g.operatorName,totalCalls:g.totalCalls,successfulCalls:g.successfulCalls,failedCalls:g.failedCalls,averageDuration:g.totalCalls>0?Math.round(g.totalDuration/g.totalCalls):0,successRate:g.totalCalls>0?Math.round(g.successfulCalls/g.totalCalls*100):0,matchedCalls:g.matchedCalls})).sort((g,v)=>v.totalCalls-g.totalCalls),h=f.reduce((g,v)=>g+v.totalCalls,0),d=f.reduce((g,v)=>g+v.successfulCalls,0),m=f.reduce((g,v)=>g+v.failedCalls,0);return console.log(`
 VERIFICACIN MATEMTICA:`),console.log(`- Total sistema: ${n.length} llamadas`),console.log(`- Total operadoras: ${h} llamadas`),console.log(`- Exitosas operadoras: ${d}`),console.log(`- Fallidas operadoras: ${m}`),console.log(`- Suma verifica: ${d+m===h?"":""}`),console.log(`- Cobertura: ${(h/n.length*100).toFixed(1)}%`),console.log(`
 MTRICAS FINALES POR OPERADORA:`),f.forEach(g=>{console.log(`- ${g.operatorName}: ${g.totalCalls} llamadas, ${g.successfulCalls} exitosas (${g.successRate}%), ${g.failedCalls} fallidas`)}),f}catch(n){return console.error(" Error en getOperatorMetrics:",n),console.error("Stack trace:",n.stack),[]}},getOperatorMetricsOld:(r=null)=>{const{processedData:n}=e();if(!r||typeof r!="object"){const a={},i=o=>!o||typeof o!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(o)||/^\d+$/.test(o)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(o)||!isNaN(Date.parse(o))||o.trim().length<3?!1:!!(o.trim().split(/\s+/).filter(c=>c.length>1).length>=2||/^[a-zA-Z\s\-\.]{3,}$/.test(o));return n.forEach(o=>{let l=o.operador||o.operator||o.teleoperadora||o.agente;(!i(l)||l===o.beneficiario||l===o.beneficiary)&&(l="No identificado"),l!=="No identificado"&&(/^\d{1,2}:\d{2}/.test(o.operador)||o.operador===o.beneficiario||o.operador===o.beneficiary)&&console.warn(` Operador problemtico detectado: "${o.operador}"  corregido a: "${l}" de llamada:`,{operadorOriginal:o.operador,beneficiario:o.beneficiario,operadorFinal:l}),a[l]||(a[l]={operador:l,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0});const c=a[l];c.totalLlamadas++,o.categoria==="exitosa"&&c.llamadasExitosas++,c.tiempoTotal+=o.duracion||0}),Object.values(a).forEach(o=>{o.promedioLlamada=o.totalLlamadas>0?Math.round(o.tiempoTotal/o.totalLlamadas):0}),Object.values(a)}const s={};try{Object.values(r).flat().forEach(a=>{a.operatorName&&!s[a.operatorName]&&(s[a.operatorName]={operador:a.operatorName,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0})})}catch(a){return console.warn("Error procesando operatorAssignments:",a),[]}return n.forEach(a=>{try{const i=Object.values(r).flat().find(o=>o.beneficiary===a.beneficiary);if(i&&s[i.operatorName]){const o=s[i.operatorName];o.totalLlamadas++,a.categoria==="exitosa"&&o.llamadasExitosas++,o.tiempoTotal+=a.duracion||0}}catch(i){console.warn("Error procesando call data:",i)}}),Object.values(s).forEach(a=>{a.promedioLlamada=a.totalLlamadas>0?Math.round(a.tiempoTotal/a.totalLlamadas):0}),Object.values(s)},getHourlyDistribution:()=>{const{processedData:r}=e(),n=Array.from({length:24},(s,a)=>({hour:a,calls:0}));return Array.isArray(r)&&r.forEach(s=>{try{let a=null;if(s.hora){const o=s.hora.toString().match(/^(\d{1,2})/);o&&(a=parseInt(o[1]))}else s.hour!==void 0&&(a=parseInt(s.hour));a!==null&&a>=0&&a<24&&n[a].calls++}catch(a){console.warn("Error procesando hora de llamada:",a)}}),n},getFollowUpData:r=>{const{processedData:n}=e();if(console.log(" getFollowUpData iniciando con assignments:",r),console.log(" getFollowUpData - processedData:",n==null?void 0:n.length,"llamadas"),!n||n.length===0)return console.log(" No hay processedData disponible"),[];const s=l=>{if(!l)return"N/A";try{let c;if(typeof l=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(l)){const f=l.split(/[-\/]/),h=parseInt(f[0]),d=parseInt(f[1]),m=parseInt(f[2]);if(h<=31&&d<=12&&m>=1900)return`${h.toString().padStart(2,"0")}-${d.toString().padStart(2,"0")}-${m}`}if(typeof l=="number"?c=new Date((l-25569)*86400*1e3):c=new Date(l),c&&!isNaN(c.getTime())){const f=c.getDate().toString().padStart(2,"0"),h=(c.getMonth()+1).toString().padStart(2,"0"),d=c.getFullYear();return`${f}-${h}-${d}`}return"Fecha invlida"}catch{return typeof l=="string"?l:"Error en fecha"}},a=l=>{if(!l||l==="N/A")return null;try{if(typeof l=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(l)){const[c,f,h]=l.split(/[-\/]/);return new Date(parseInt(h),parseInt(f)-1,parseInt(c))}return typeof l=="number"?new Date((l-25569)*86400*1e3):new Date(l)}catch(c){return console.warn("Error parseando fecha:",l,c),null}},i={};n.forEach(l=>{const c=l.beneficiario||l.beneficiary,f=l.resultado||l.result||(l.categoria==="exitosa"?"Llamado exitoso":"Llamado fallido"),h=l.fecha||l.date;if(c&&c.includes("Sara")&&console.log(" SARA DEBUG - Procesando llamada:",{beneficiary:c,date:h,result:f,rawCall:l}),!c)return;i[c]||(i[c]={beneficiary:c,calls:[],lastResult:f,lastDate:h}),i[c].calls.push(l);const d=a(h),m=a(i[c].lastDate);c&&c.includes("Sara")&&console.log(" SARA DEBUG - Comparacin de fechas CORREGIDA:",{beneficiary:c,currentDateString:h,currentDateParsed:d,currentDateValid:d!==null,lastDateString:i[c].lastDate,lastDateParsed:m,lastDateValid:m!==null,currentIsNewer:d&&m?d>m:!1,willUpdate:d&&(!m||d>m)}),d&&(!m||d>m)&&(i[c].lastResult=f,i[c].lastDate=h,c&&c.includes("Sara")&&console.log(" SARA DEBUG - Fecha actualizada CORREGIDA:",{beneficiary:c,newLastDate:h,newLastResult:f,totalCalls:i[c].calls.length}))});const o=Object.values(i).map(l=>{if(console.log(" Procesando beneficiario:",l.beneficiary),l.beneficiary&&l.beneficiary.includes("Sara")){console.log(" SARA DEBUG - Anlisis completo:",{beneficiary:l.beneficiary,totalCalls:l.calls.length,lastDate:l.lastDate,lastResult:l.lastResult,allDates:l.calls.map(_=>_.fecha||_.date),sortedDates:l.calls.map(_=>_.fecha||_.date).sort(),uniqueDates:[...new Set(l.calls.map(_=>_.fecha||_.date))]});const w=l.calls.map(_=>_.fecha||_.date).filter(_=>_&&_!=="N/A");console.log(" SARA DEBUG - Todas las fechas sin filtrar:",w);const T=w.map(_=>{if(typeof _=="string"&&/^\d{1,2}-\d{1,2}-\d{4}$/.test(_)){const[y,O,z]=_.split("-");return{original:_,parsed:new Date(z,O-1,y),timestamp:new Date(z,O-1,y).getTime()}}else return{original:_,parsed:new Date(_),timestamp:new Date(_).getTime()}}).filter(_=>!isNaN(_.timestamp));T.sort((_,y)=>y.timestamp-_.timestamp),console.log(" SARA DEBUG - Fechas ordenadas manualmente:",T),T.length>0&&console.log(" SARA DEBUG - Fecha ms reciente encontrada:",T[0].original)}let c=null;r&&Array.isArray(r)?(console.log(" Buscando assignment para:",l.beneficiary),console.log(" Total assignments disponibles:",r.length),c=r.find(w=>{const T=(w.beneficiary||w.beneficiario||"").trim(),_=(l.beneficiary||"").trim();if(console.log(` Comparando: "${T}" vs "${_}"`),T===_)return console.log(" Coincidencia exacta encontrada"),!0;if(T.toLowerCase()===_.toLowerCase())return console.log(" Coincidencia exacta (case insensitive) encontrada"),!0;const y=T.toLowerCase(),O=_.toLowerCase();return y&&O&&(y.includes(O)||O.includes(y))?(console.log(" Coincidencia parcial encontrada"),!0):!1}),c?console.log(" Assignment encontrado para",l.beneficiary,":",c):(console.log(" No se encontr assignment para:",l.beneficiary),console.log(" Assignments disponibles:",r==null?void 0:r.map(w=>({beneficiary:w.beneficiary||w.beneficiario,operator:w.operator||w.operatorName}))),console.log(" Comparacin detallada para:",l.beneficiary),r==null||r.forEach((w,T)=>{const _=(w.beneficiary||w.beneficiario||"").trim().toLowerCase(),y=(l.beneficiary||"").trim().toLowerCase();console.log(`  [${T}] "${_}" vs "${y}" - Exacta: ${_===y}`)}))):console.log(" No hay assignments array disponible");let f="pendiente",h="bg-yellow-100 text-yellow-800";l.lastResult==="Llamado exitoso"||l.lastResult==="exitosa"?(f="al-dia",h="bg-green-100 text-green-800"):l.calls.length>3&&(f="urgente",h="bg-red-100 text-red-800");let d="No Asignado",m="N/A",g="N/A";if(c){console.log(" Assignment encontrado para",l.beneficiary,":",c);const w=c.operator||c.operador||c.operatorName||c.teleoperadora||c.name;console.log(" Candidate operator:",w),w&&w!=="Solo HANGUP"&&w!=="HANGUP"&&w!=="No identificado"&&w!=="Llamado exitoso"&&w!=="Llamado fallido"&&w!=="exitosa"&&w!=="fallida"&&w.trim().length>2&&!/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(w)?(d=w,console.log(" Operadora asignada encontrada:",d)):console.log(" Operadora invlida filtrada:",w),m=c.phone||c.telefono||c.primaryPhone||c.numero_cliente||"N/A",g=c.commune||c.comuna||"N/A"}else console.log(" No hay asignacin para beneficiario:",l.beneficiary);const v={id:l.beneficiary,operator:d,beneficiary:l.beneficiary,phone:m,commune:g,status:f,lastCall:s(l.lastDate),callCount:l.calls.length,colorClass:h};return l.beneficiary&&l.beneficiary.includes("Sara")&&console.log(" SARA DEBUG - Resultado final:",v),v});return console.log(" Total de beneficiarios en seguimiento:",o.length),o},hasData:()=>{const{callData:r}=e();return r&&r.length>0},getSuccessRate:()=>{const{callMetrics:r}=e();return!r||!r.totalCalls||r.totalCalls===0?0:Math.round(r.successfulCalls/r.totalCalls*100)},getDataSummary:()=>{const{callMetrics:r,lastUpdated:n,dataSource:s}=e();return{...r,lastUpdated:n,dataSource:s,successRate:e().getSuccessRate()}}}),{name:"call-audit-storage",storage:B0(()=>localStorage),partialize:t=>({callData:t.callData,processedData:t.processedData,callMetrics:t.callMetrics,lastUpdated:t.lastUpdated,dataSource:t.dataSource,filters:t.filters,loadingStage:t.loadingStage,loadingMessage:t.loadingMessage})})),CI=z1(H1((t,e)=>({operators:[],operatorAssignments:{},activeTab:"dashboard",isLoading:!1,settings:{autoRefresh:!1,refreshInterval:3e4,defaultView:"dashboard"},setOperators:r=>{t({operators:r||[]})},addOperator:r=>{t(n=>({operators:[...n.operators,r]}))},updateOperator:(r,n)=>{t(s=>({operators:s.operators.map(a=>a.id===r?{...a,...n}:a)}))},removeOperator:r=>{t(n=>({operators:n.operators.filter(s=>s.id!==r),operatorAssignments:Object.fromEntries(Object.entries(n.operatorAssignments).filter(([s])=>s!==r))}))},setOperatorAssignments:r=>{t({operatorAssignments:r||{}})},updateOperatorAssignments:(r,n)=>{t(s=>({operatorAssignments:{...s.operatorAssignments,[r]:n}}))},clearOperatorAssignments:r=>{t(n=>{const s={...n.operatorAssignments};return delete s[r],{operatorAssignments:s}})},setActiveTab:r=>{t({activeTab:r})},setLoading:r=>{t({isLoading:r})},updateSettings:r=>{t(n=>({settings:{...n.settings,...r}}))},getOperatorById:r=>{const{operators:n}=e();return n.find(s=>s.id===r)||null},getOperatorAssignments:r=>{const{operatorAssignments:n}=e();return n[r]||[]},getAllAssignments:()=>{const{operatorAssignments:r,operators:n}=e(),s=[];return console.log(" getAllAssignments - operatorAssignments:",r),console.log(" getAllAssignments - operators:",n),Object.entries(r).forEach(([a,i])=>{const o=n.find(l=>l.id===a);o&&i&&(console.log(` Procesando asignaciones para ${o.name}:`,i.length),i.forEach(l=>{const c={id:l.id,operator:o.name,operatorName:o.name,beneficiary:l.beneficiary,phone:l.primaryPhone,commune:l.commune};s.push(c),console.log(" Asignacin agregada:",c)}))}),console.log(" Total asignaciones devueltas:",s.length),s},getTotalAssignments:()=>{const{operatorAssignments:r}=e();return Object.values(r).reduce((n,s)=>n+((s==null?void 0:s.length)||0),0)},loadOperators:async()=>{try{t({isLoading:!0}),console.log(" Cargando operadores desde Firebase...");const r=await $f.getAll();return console.log(" Operadores cargados:",r.length),t({operators:r||[],isLoading:!1}),r}catch(r){return console.error(" Error cargando operadores:",r),t({isLoading:!1}),[]}},loadAssignments:async()=>{try{t({isLoading:!0}),console.log(" Cargando asignaciones desde Firebase...");const r=await Yl.getAll();console.log(" Asignaciones cargadas:",r.length);const n={};return r.forEach(s=>{s.operatorId&&(n[s.operatorId]||(n[s.operatorId]=[]),n[s.operatorId].push(s))}),t({operatorAssignments:n,isLoading:!1}),console.log(" Asignaciones agrupadas por operador:",Object.keys(n).length),r}catch(r){return console.error(" Error cargando asignaciones:",r),t({isLoading:!1}),[]}},clearAllData:()=>{t({operators:[],operatorAssignments:{},activeTab:"dashboard"})}}),{name:"app-storage",storage:B0(()=>localStorage),partialize:t=>({operators:t.operators,operatorAssignments:t.operatorAssignments,settings:t.settings})})),Iw={manualMappings:{ocupado:null,sin_respuesta:null,llamado_exitoso:null,no_identificado:null,busy:null,no_answer:null},excludePatterns:[/^ocupado$/i,/^sin\s+respuesta$/i,/^no\s+identificado$/i,/^llamado\s+exitoso$/i,/^busy$/i,/^no\s+answer$/i,/^\d+$/,/^[A-Z]{2,}$/]};function zf(t){if(!t||typeof t!="string")return"";let e=t;return e=e.toLowerCase(),e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),e=e.replace(/[^\w\s]/g,""),e=e.replace(/\s+/g," ").trim(),e}function HU(t){if(!t)return!0;const e=zf(t);return Iw.manualMappings[e]===null?!0:Iw.excludePatterns.some(r=>r.test(t))}function WU(t,e,r){if(!t||!e||!r)return null;const n=zf(t);for(const[s,a]of Object.entries(e))if(a.find(o=>zf(o)===n)){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"exact"}}for(const[s,a]of Object.entries(e))if(a.find(o=>{const l=zf(o);return l.includes(n)||n.includes(l)})){const o=r.find(l=>l.id===s);if(o)return{operatorId:s,operatorName:o.name,operatorInfo:o,matchType:"partial"}}return null}function GU(){const{callData:t,callMetrics:e,processedData:r,isLoading:n,lastUpdated:s,dataSource:a,clearData:i,hasData:o,getSuccessRate:l,getOperatorMetrics:c,getHourlyDistribution:f,getFollowUpData:h}=II(),{operators:d,operatorAssignments:m,getAllAssignments:g}=CI();ze.useEffect(()=>{},[r,d,m]);const v=y=>{if(!y||isNaN(y))return"0:00";const O=Math.floor(y/60),z=y%60;return`${O}:${z.toString().padStart(2,"0")}`},w=y=>{if(!y)return"N/A";try{return new Date(y).toLocaleString()}catch{return"N/A"}};c&&c(),f&&f();const _=(()=>{if(console.log(" [AUDIT CRITICAL] === MAPEO INTELIGENTE CON UTILIDADES ==="),console.log(" [AUDIT] Datos disponibles:",(r==null?void 0:r.length)||0),console.log(" [AUDIT] Operadores disponibles:",(d==null?void 0:d.length)||0),console.log(" [AUDIT] Asignaciones disponibles:",m?Object.keys(m).length:0),!r||r.length===0||!d||d.length===0)return console.log(" [AUDIT] Sin datos suficientes para anlisis"),[];const y={};let O=0,z=0,B=0;r.forEach((S,k)=>{const R=S.beneficiario||S.beneficiary||"";k<5&&console.log(` [AUDIT] Llamada ${k}: beneficiario="${R}"`);const b=S.operador||S.operator||S.teleoperadora;b&&HU(b)&&(B++,k<10&&console.log(` [AUDIT] Excluido estado como operador: "${b}"`));const D=WU(R,m,d);if(D){O++;const F=D.operatorName;y[F]||(y[F]={operatorInfo:D.operatorInfo,totalCalls:0,successfulCalls:0,totalDuration:0,beneficiaries:new Set,assignedBeneficiaries:0}),y[F].totalCalls++,y[F].beneficiaries.add(R),(S.isSuccessful||S.categoria==="exitosa"||S.resultado==="Llamado exitoso")&&y[F].successfulCalls++,y[F].totalDuration+=S.duracion||0}else z++,k<10&&console.log(` [AUDIT] Llamada sin mapeo: beneficiario="${R}"`)}),console.log(` [AUDIT] Resultado del mapeo: ${O} mapeadas, ${z} sin mapeo, ${B} excluidas`),console.log(" [AUDIT] Operadores con actividad:",Object.keys(y));const E=Object.entries(y).map(([S,k])=>{var F;const R=k.operatorInfo.id,b=((F=m==null?void 0:m[R])==null?void 0:F.length)||0,D=b>0?Math.round(k.totalCalls/b*10)/10:0;return{operatorName:S,operatorInfo:k.operatorInfo,totalCalls:k.totalCalls,assignedBeneficiaries:b,averageCallsPerBeneficiary:D,beneficiariesWithCalls:k.beneficiaries.size,successfulCalls:k.successfulCalls,successRate:k.totalCalls>0?Math.round(k.successfulCalls/k.totalCalls*100):0}});return d&&d.forEach(S=>{var k;if(!y[S.name]){const R=((k=m==null?void 0:m[S.id])==null?void 0:k.length)||0;E.push({operatorName:S.name,operatorInfo:S,totalCalls:0,assignedBeneficiaries:R,averageCallsPerBeneficiary:0,beneficiariesWithCalls:0,successfulCalls:0,successRate:0})}}),console.log(" [AUDIT] Mtricas finales calculadas:",E.length,"operadores"),E.forEach((S,k)=>{console.log(`  ${k+1}. "${S.operatorName}": ${S.totalCalls} llamadas, ${S.assignedBeneficiaries} asignados, ${S.beneficiariesWithCalls} activos`)}),E.sort((S,k)=>k.totalCalls-S.totalCalls)})();return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(jl,{className:"w-6 h-6 text-blue-600"}),"Auditora Avanzada de Llamadas"]}),p.jsxs("p",{className:"text-gray-600",children:["Anlisis detallado y mtricas en tiempo real de todas las llamadas registradas en el sistema. Estado de datos: ",p.jsx("span",{className:"font-semibold",children:o&&o()?"Datos cargados":"Sin datos"}),s&&` | ltima actualizacin: ${w(s)}`]})]}),o&&o()&&p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Total Llamadas"}),p.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(e==null?void 0:e.totalCalls)||0})]}),p.jsx(Bn,{className:"w-8 h-8 text-blue-500"})]}),p.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Registros procesados"})]}),p.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Tasa de xito"}),p.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l?l():0,"%"]})]}),p.jsx(Vp,{className:"w-8 h-8 text-green-500"})]}),p.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Llamadas exitosas"})]}),p.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-purple-800 mb-1",children:"Operadores Activos"}),p.jsx("p",{className:"text-2xl font-bold text-purple-600",children:(_==null?void 0:_.length)||0})]}),p.jsx(Un,{className:"w-8 h-8 text-purple-500"})]}),p.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Con actividad registrada"})]}),p.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-orange-800 mb-1",children:"Duracin Promedio"}),p.jsx("p",{className:"text-2xl font-bold text-orange-600",children:v((e==null?void 0:e.averageDuration)||0)})]}),p.jsx(lo,{className:"w-8 h-8 text-orange-500"})]}),p.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"Tiempo por llamada"})]})]}),_.length>0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(Un,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),p.jsx("div",{className:"mb-4",children:!o||!o()?p.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),p.jsxs("p",{className:"text-blue-700 text-sm",children:[p.jsx("span",{className:"font-medium",children:"Modo Asignaciones:"})," Mostrando teleoperadoras con sus asignaciones actuales.",p.jsx("span",{className:"font-medium",children:"Carga datos de llamadas"})," para ver mtricas completas."]})]})}):p.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),p.jsxs("p",{className:"text-green-700 text-sm",children:[p.jsx("span",{className:"font-medium",children:"Datos Completos:"})," Mostrando mtricas extradas directamente de llamadas."]})]}),!1]})})}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map((y,O)=>{var z;return p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow bg-gradient-to-br from-blue-50 to-indigo-50",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:p.jsx(ph,{className:"w-5 h-5 text-white"})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:y.operatorName}),p.jsx("p",{className:"text-xs text-gray-500",children:((z=y.operatorInfo)==null?void 0:z.email)||`${y.operatorName.toLowerCase().replace(/\s+/g,".")}@mistatas.com`})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-sm text-gray-600",children:"Total Llamadas:"}),p.jsx("span",{className:"font-bold text-lg text-blue-600",children:y.totalCalls})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados:"}),p.jsx("span",{className:"font-medium text-gray-700",children:y.assignedBeneficiaries})]}),y.assignedBeneficiaries>0&&p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-sm text-gray-600",children:"Promedio por Beneficiario:"}),p.jsx("span",{className:"font-medium text-gray-700",children:y.averageCallsPerBeneficiary})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-sm text-gray-600",children:"Con Actividad:"}),p.jsxs("span",{className:"font-medium text-gray-700",children:[y.beneficiariesWithCalls," / ",y.assignedBeneficiaries]})]}),y.successfulCalls!==void 0&&y.totalCalls>0&&p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-sm text-gray-600",children:"Llamadas Exitosas:"}),p.jsxs("span",{className:"font-medium text-green-600",children:[y.successfulCalls," (",y.successRate,"%)"]})]})]}),p.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:o&&o()?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-xs text-gray-500",children:"Rendimiento:"}),p.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.totalCalls>=20?"bg-green-100 text-green-800":y.totalCalls>=10?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:y.totalCalls>=20?"Alto":y.totalCalls>=10?"Medio":"Bajo"})]}),p.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:p.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${y.totalCalls>=20?"bg-green-500":y.totalCalls>=10?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(y.totalCalls/30*100,100)}%`}})})]}):p.jsx("div",{className:"text-center",children:p.jsx("span",{className:"text-xs text-gray-400",children:y.assignedBeneficiaries>0?` ${y.assignedBeneficiaries} beneficiarios asignados`:" Sin asignaciones"})})})]},y.operatorName)})}),p.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resumen Estadstico"}),p.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-600",children:"Total Teleoperadoras:"}),p.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.length})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-600",children:"Llamadas Totales:"}),p.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.reduce((y,O)=>y+O.totalCalls,0)})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-600",children:"Beneficiarios Totales:"}),p.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.reduce((y,O)=>y+O.assignedBeneficiaries,0)})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-600",children:"Promedio General:"}),p.jsx("span",{className:"font-bold text-blue-600 ml-2",children:_.length>0?Math.round(_.reduce((y,O)=>y+O.totalCalls,0)/_.length*10)/10:0})]})]})]})]}),_.length===0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(Un,{className:"w-5 h-5 text-blue-600"}),"Mtricas por Teleoperadora"]}),p.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(ic,{className:"w-5 h-5 text-yellow-500"}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-yellow-800 font-medium",children:"No hay teleoperadoras disponibles"}),p.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Para ver las mtricas por teleoperadora, necesitas:"}),p.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 list-disc list-inside",children:[p.jsx("li",{children:'Crear teleoperadoras en el mdulo "Asignaciones"'}),p.jsx("li",{children:"Asignar beneficiarios a las teleoperadoras"}),p.jsx("li",{children:"Opcionalmente, cargar datos de llamadas para mtricas completas"})]})]})]})})]}),(!o||!o())&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[p.jsx(ic,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),p.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No hay datos de auditora disponibles"}),p.jsx("p",{className:"text-gray-500 mb-4",children:'Sube un archivo Excel en la seccin "Registro de Llamadas" para comenzar el anlisis de auditora avanzada.'}),p.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:p.jsxs("p",{className:"text-blue-800 text-sm",children:[" ",p.jsx("strong",{children:"Tip:"})," Una vez que subas datos, vers mtricas detalladas, anlisis por operador y distribucin temporal de llamadas."]})})]}),o&&o()&&p.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{className:"text-sm text-gray-600",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Fuente de datos:"})," ",a||"Desconocida"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"ltima actualizacin:"})," ",w(s)]})]}),i&&p.jsx("button",{onClick:i,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:" Limpiar Datos"})]})})]})}class Cw extends Tc.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error capturado por ErrorBoundary:",e,r)}render(){return this.state.hasError?p.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 m-4",children:[p.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error en la aplicacin"}),p.jsx("p",{className:"text-red-600 mb-4",children:"Ha ocurrido un error inesperado. Por favor, recarga la pgina."}),p.jsxs("details",{className:"text-sm text-red-700",children:[p.jsx("summary",{className:"cursor-pointer",children:"Detalles tcnicos"}),p.jsx("pre",{className:"mt-2 whitespace-pre-wrap",children:this.state.error&&this.state.error.toString()})]}),p.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Recargar pgina"})]}):this.props.children}}const qU=()=>{const{user:t,logout:e}=$1(),r=H=>{if(!H)return"N/A";try{let ce;if(typeof H=="string"&&/^\d{1,2}[-\/]\d{1,2}[-\/]\d{4}$/.test(H)){const me=H.split(/[-\/]/),I=parseInt(me[0]),N=parseInt(me[1]),C=parseInt(me[2]);if(I<=31&&N<=12&&C>=1900)return`${I.toString().padStart(2,"0")}-${N.toString().padStart(2,"0")}-${C}`}if(typeof H=="number"?ce=new Date((H-25569)*86400*1e3):ce=new Date(H),ce&&!isNaN(ce.getTime())){const me=ce.getDate().toString().padStart(2,"0"),I=(ce.getMonth()+1).toString().padStart(2,"0"),N=ce.getFullYear();return`${me}-${I}-${N}`}return"Fecha invlida"}catch{return typeof H=="string"?H:"Error en fecha"}},{callData:n,processedData:s,callMetrics:a,setCallData:i,analyzeCallData:o,getOperatorMetrics:l,getHourlyDistribution:c,getFollowUpData:f,hasData:h,isLoading:d,loadingStage:m,loadingMessage:g,setLoadingStage:v}=II(),{operators:w,operatorAssignments:T,activeTab:_,setOperators:y,setOperatorAssignments:O,setActiveTab:z,getAllAssignments:B}=CI(),[E,S]=ze.useState("dashboard"),[k,R]=ze.useState([]),[b,D]=ze.useState([]),[F,_e]=ze.useState("connecting"),[pe,Se]=ze.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[ye,ie]=ze.useState([]),[q,ue]=ze.useState([]),[Te,j]=ze.useState("all"),[J,G]=ze.useState(""),[W,re]=ze.useState([]),[fe,Ee]=ze.useState(!1),[ge,oe]=ze.useState(null),[be,U]=ze.useState({name:"",email:"",phone:""}),[Fe,$e]=ze.useState({}),[et,Be]=ze.useState(null),[xe,ft]=ze.useState(!1),[Vt,ar]=ze.useState(""),[ir,Dn]=ze.useState([]),or=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}],It=ze.useRef(!1),[Lr,nt]=ze.useState(!1);ze.useEffect(()=>{t&&!Lr&&!It.current&&xt()},[t,Lr]),ze.useEffect(()=>{k.length>0&&b.length>0&&(console.log(" Re-analizando datos tras actualizacin de asignaciones..."),o(k))},[b]);const xt=async()=>{if(!It.current){It.current=!0,_e("connecting");try{const H=await $f.getByUser(t.uid);if(H!==null){re(H||[]);const ce=await Yl.getAllUserAssignments(t.uid);$e(ce||{});const me=await Aw.getCallData(t.uid);R(me||[]),Ct(ce||{},H||[]),me&&me.length>0?(console.log(" Analizando datos reales de llamadas..."),setTimeout(()=>o(me),100)):(console.log(" No hay datos de llamadas, inicializando mtricas por defecto..."),Ji()),_e("connected"),nt(!0),console.log(" Conectado a Firebase - persistencia habilitada")}else throw new Error("Insufficient permissions")}catch{_e("demo"),nt(!0),Mr()}finally{It.current=!1}}},Ct=(H,ce)=>{const me=[];Object.entries(H).forEach(([I,N])=>{const C=ce.find(P=>P.id===I);C&&N&&N.forEach(P=>{me.push({id:P.id,operator:C.name,beneficiary:P.beneficiary,phone:P.primaryPhone,commune:P.commune})})}),D(me)},Mr=()=>{console.log(" Inicializando con datos de ejemplo..."),D(or);const H={};or.forEach(me=>{let N=`operator-${me.operator.toLowerCase().replace(/\s+/g,"-")}`;H[N]||(H[N]=[]),H[N].push({id:me.id,beneficiary:me.beneficiary,beneficiario:me.beneficiary,primaryPhone:me.phone,phone:me.phone,commune:me.commune,comuna:me.commune})});const ce=[...new Set(or.map(me=>me.operator))].map((me,I)=>({id:`operator-${me.toLowerCase().replace(/\s+/g,"-")}`,name:me,email:`${me.toLowerCase().replace(/\s+/g,".")}@example.com`,phone:`+56${I+1}12345678`}));y(ce),O(H),console.log(" Datos sincronizados con Zustand:",{operators:ce,assignments:H}),je(),Ji(),console.log(" Datos de ejemplo inicializados")},je=()=>{const ce=[{id:"sample-1",name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-2",name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-3",name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-4",name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-5",name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325",userId:(t==null?void 0:t.uid)||"demo-user"}].filter(me=>me&&me.id&&me.name);re(ce)},ht=async()=>{if(be.name.trim()!=="")try{const H=await $f.create(t.uid,be);re([...W,H]),U({name:"",email:"",phone:""}),Ee(!1)}catch(H){console.error("Error creating operator:",H),alert("Error al crear teleoperador. Intenta nuevamente.")}},jt=async H=>{try{await $f.delete(H),await Yl.deleteOperatorAssignments(t.uid,H),re(W.filter(I=>I.id!==H));const ce={...Fe};delete ce[H],$e(ce);const me=b.filter(I=>!I.id.toString().startsWith(`${H}-`));D(me)}catch(ce){console.error("Error deleting operator:",ce),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},vt=(H,ce)=>{const me=H.target.files[0];if(me){const I=new FileReader;I.onload=N=>{const C=new Uint8Array(N.target.result),P=kh(C,{type:"array"}),V=P.SheetNames[0],M=P.Sheets[V],K=jy.sheet_to_json(M,{header:1});xn(K,ce)},I.readAsArrayBuffer(me)}H.target.value=""},xn=async(H,ce)=>{if(H.length<2)return;const me=W.find(N=>N.id===ce);if(!me)return;const I=H.slice(1).map((N,C)=>{const P=N[1]?String(N[1]).split(/[\|\-\s]+/).filter(V=>V.trim().length===9):[];return{id:`${ce}-${C}`,operatorId:ce,operatorName:me.name,beneficiary:N[0]||"",phones:P,primaryPhone:P[0]||"",commune:N[2]||""}}).filter(N=>N.beneficiary&&N.primaryPhone);try{await Yl.saveOperatorAssignments(t.uid,ce,I),$e(C=>({...C,[ce]:I}));const N=I.map(C=>({id:C.id,operator:C.operatorName,beneficiary:C.beneficiary,phone:C.primaryPhone,commune:C.commune}));D(C=>[...C.filter(V=>!V.id.toString().startsWith(`${ce}-`)),...N]),Be(null)}catch(N){console.error("Error saving assignments:",N),alert("Error al guardar asignaciones. Intenta nuevamente.")}},ra=async H=>{try{await Yl.deleteOperatorAssignments(t.uid,H);const ce={...Fe};delete ce[H],$e(ce),D(me=>me.filter(I=>!I.id.toString().startsWith(`${H}-`)))}catch(ce){console.error("Error clearing assignments:",ce),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},Ji=()=>{if(k.length>0){console.log(" Datos reales disponibles, omitiendo generacin de datos de ejemplo");return}console.log(" Generando datos de ejemplo...");const ce=(W.length>0?W.map(I=>I.name):["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"]).map(I=>({operator:I,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),me=Array.from({length:24},(I,N)=>({hour:N,calls:Math.floor(Math.random()*20)+1}));ie(ce),ue(me),Se({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:b.length||5,operators:W.length||5,protocolCompliance:85,pendingFollowUps:12}),b.length>0},yl=H=>{if(!H.trim()){Dn([]);return}console.log(" Iniciando bsqueda para:",H);const ce=[];Object.entries(Fe).forEach(([C,P])=>{const V=W.find(M=>M.id===C);P&&Array.isArray(P)&&P.forEach(M=>{ce.push({beneficiary:M.beneficiary||M.beneficiario,beneficiario:M.beneficiary||M.beneficiario,operatorName:(V==null?void 0:V.name)||M.operator||M.operatorName||"Operador no encontrado",operator:(V==null?void 0:V.name)||M.operator||M.operatorName,phone:M.primaryPhone||M.phone||M.telefono||M.numero_cliente||M.phones&&M.phones[0]||"N/A",primaryPhone:M.primaryPhone,phones:M.phones||[],telefono:M.telefono,numero_cliente:M.numero_cliente,commune:M.commune||M.comuna||"N/A",comuna:M.comuna,operatorId:C,source:"operatorAssignments",id:M.id})})});const me=B();console.log(" Asignaciones de Zustand:",me),me.forEach(C=>{ce.push({beneficiary:C.beneficiary||C.beneficiario,beneficiario:C.beneficiary||C.beneficiario,operatorName:C.operator||C.operatorName||C.name||"Sin asignar",operator:C.operator||C.operatorName||C.name,phone:C.phone||C.telefono||C.numero_cliente||"N/A",commune:C.commune||C.comuna||"N/A",operatorId:C.operatorId||"zustand",source:"zustand"})}),console.log(" Total asignaciones encontradas:",ce.length),console.log(" Muestra de asignaciones:",ce.slice(0,3));const I=H.toLowerCase().trim(),N=ce.filter(C=>{const P=(C.beneficiary||C.beneficiario||"").toLowerCase(),V=(C.operatorName||C.operator||"").toLowerCase(),M=(C.commune||C.comuna||"").toLowerCase(),K=[C.phone,C.primaryPhone,C.telefono,C.numero_cliente,...C.phones||[]].filter(de=>de&&de!=="N/A").join(" ").toLowerCase(),Y=P.includes(I),X=V.includes(I),Q=K.includes(I),Z=M.includes(I),ae=Y||X||Q||Z;return ae&&console.log(" Coincidencia encontrada:",{beneficiary:P,operator:V,phones:K,commune:M,searchTerm:I,matches:{beneficiaryName:Y,operatorName:X,phones:Q,commune:Z},source:C.source}),ae});console.log(" Resultados filtrados:",N.length),Dn(N)},na=H=>{ar(H),yl(H)},ni=H=>{const ce=H.target.files[0];if(ce){v("uploading",`Subiendo archivo: ${ce.name}`);const me=new FileReader;me.onload=I=>{try{v("processing","Leyendo datos del archivo Excel...");const N=new Uint8Array(I.target.result),C=kh(N,{type:"array"}),P=C.SheetNames[0],V=C.Sheets[P],M=jy.sheet_to_json(V,{header:1});si(M)}catch(N){console.error("Error al procesar archivo Excel:",N),v("error","Error al procesar el archivo Excel")}},me.onerror=()=>{v("error","Error al leer el archivo")},me.readAsArrayBuffer(ce)}H.target.value=""},si=async H=>{if(H.length<2){v("error","El archivo Excel no contiene datos vlidos");return}try{v("processing",`Procesando ${H.length-1} filas de datos...`);const me=(N=>{const C=N.slice(1,Math.min(6,N.length)),P=Y=>!Y||typeof Y!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(Y)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(Y)||!isNaN(Date.parse(Y))||/^\d+$/.test(Y)||Y.trim().length<3?!1:!!(Y.trim().split(/\s+/).filter(Q=>Q.length>1).length>=2||/^[a-zA-Z\s\-\.]+$/.test(Y)),V={};for(let Y=0;Y<15;Y++){let X=0;const Q=C.map(Z=>Z[Y]).filter(Z=>Z!=null);if(Q.length!==0){for(const Z of Q)P(String(Z))&&X++;X>0&&(V[Y]={score:X,percentage:X/Q.length*100,sampleValues:Q.slice(0,3)})}}console.log(" Anlisis de columnas para detectar operadores:",V);let M=7,K=0;for(const[Y,X]of Object.entries(V))(X.score>K||X.score===K&&X.percentage>50)&&(K=X.score,M=parseInt(Y));return console.log(` Columna de operadores detectada: ${M} (puntuacin: ${K})`),M})(H),I=H.slice(1).map((N,C)=>{C<3&&console.log(`Fila ${C}:`,{col0:N[0],col1:N[1],col2:N[2],col3:N[3],col4:N[4],col5:N[5],col6:N[6],col7:N[7],col8:N[8],col9:N[9],col10:N[10],col11:N[11],operadorDetectado:N[me]});let P=N[me];if(P&&/^\d{1,2}:\d{2}/.test(String(P))){console.warn(` Valor de operador parece ser hora: "${P}". Buscando en otras columnas...`);for(let M=0;M<N.length;M++){const K=N[M];if(K&&typeof K=="string"&&!/^\d{1,2}:\d{2}/.test(K)&&!/^\d+$/.test(K)&&K.trim().split(/\s+/).length>=2){P=K,console.log(` Operador encontrado en columna ${M}: "${P}"`);break}}}const V=r;return{id:N[0]||`call-${C}-${Date.now()}`,fecha:V(N[1]),beneficiario:N[2],comuna:N[3],tipo_llamada:N[4]==="Entrante"?"entrante":"saliente",numero_cliente:N[5],hora:N[6]||"09:00:00",operador:P||"No identificado",duracion:parseInt(N[8])||0,categoria:N[9]==="Llamado exitoso"?"exitosa":"fallida",resultado:N[9],observacion:N[10],apiId:N[11]}});try{F==="connected"&&await Aw.saveCallData(t.uid,I)&&console.log(" Datos de llamadas guardados en Firebase")}catch(N){console.error("Error guardando datos en Firebase:",N)}i(I,"excel"),allAssignments.length===0&&I.length>0&&(console.log(" No hay asignaciones previas, creando asignaciones basadas en operadoras detectadas..."),Is(I)),console.log(` Procesados ${I.length} registros en Zustand`)}catch(ce){console.error("Error durante el procesamiento de datos:",ce),v("error","Error al procesar los datos del Excel")}},Is=H=>{try{const ce={},me=P=>!P||typeof P!="string"?!1:P.trim().length>2&&!/^\d{1,2}:\d{2}/.test(P)&&!/^\d+$/.test(P)&&!/^(si|no|exitoso|fallido|pendiente|hangup|solo)$/i.test(P)&&/^[a-zA-Z\s\-\.]{3,}$/.test(P);H.forEach(P=>{const V=P.beneficiario||P.beneficiary,M=P.operador||P.operator||P.teleoperadora;V&&M&&me(M)&&(ce[M]||(ce[M]=new Set),ce[M].add(V))});const I=Object.keys(ce).map((P,V)=>({id:`auto-operator-${V+1}`,name:P,email:`${P.toLowerCase().replace(/\s+/g,".")}@auto.com`,phone:`+56${V+1}87654321`})),N={},C=[];Object.entries(ce).forEach(([P,V],M)=>{const K=`auto-operator-${M+1}`;N[K]=[],Array.from(V).forEach((Y,X)=>{const Q={id:`auto-${K}-${X+1}`,beneficiary:Y,beneficiario:Y,primaryPhone:"N/A",phone:"N/A",commune:"N/A",comuna:"N/A"};N[K].push(Q),C.push({...Q,operator:P})})}),I.length>0&&(y(I),O(N),D(C),console.log(" Asignaciones automticas creadas:",{operators:I.length,assignments:C.length,operatorMap:ce}))}catch(ce){console.error("Error creando asignaciones automticas:",ce)}},vr=(()=>{const H=[];console.log(" App.jsx - operatorAssignments (fuente de verdad):",Fe),console.log(" App.jsx - operators disponibles:",W),Object.entries(Fe).forEach(([me,I])=>{const N=W.find(C=>C.id===me);N&&I&&Array.isArray(I)?(console.log(` Procesando asignaciones para ${N.name}:`,I.length),I.forEach(C=>{const P={id:C.id,operator:N.name,operatorName:N.name,beneficiary:C.beneficiary,phone:C.primaryPhone,commune:C.commune};H.push(P),console.log(" Asignacin local agregada:",P)})):console.log(` Problemas con operador ${me}:`,{operator:N,assignments:I,isArray:Array.isArray(I)})}),console.log(" Total asignaciones locales:",H.length),console.log(" DIAGNSTICO - Buscando Hermes Eduardo Valbuena Romero en resultado final...");const ce=H.find(me=>{var I,N;return((I=me.beneficiary)==null?void 0:I.includes("Hermes"))||((N=me.beneficiary)==null?void 0:N.includes("HERMES"))});return ce?console.log(" Hermes encontrado en resultado final:",ce):(console.log(" Hermes NO encontrado en resultado final"),console.log(" Primeros 5 beneficiarios disponibles:",H.slice(0,5).map(me=>me.beneficiary))),H})();console.log(" App.jsx - assignmentsToUse final:",vr);const Vr=f(vr);console.log(" App.jsx - followUpData resultado:",Vr);const ai=Vr.filter(H=>{const ce=Te==="all"||H.status===Te,me=H.beneficiary.toLowerCase().includes(J.toLowerCase())||H.operator.toLowerCase().includes(J.toLowerCase());return ce&&me}),sa=()=>p.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[p.jsxs("div",{className:"p-6 flex-1",children:[p.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Mistatas - Seguimiento de llamadas"}),p.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),p.jsxs("nav",{className:"space-y-2",children:[p.jsx(ns,{icon:jl,label:"Panel principal",active:E==="dashboard",onClick:()=>S("dashboard")}),p.jsx(ns,{icon:Bn,label:"Registro de Llamadas",active:E==="calls",onClick:()=>S("calls")}),p.jsx(ns,{icon:Un,label:"Asignaciones",active:E==="assignments",onClick:()=>S("assignments")}),p.jsx(ns,{icon:lo,label:"Historial de Seguimientos",active:E==="history",onClick:()=>S("history")}),p.jsx(ns,{icon:jl,label:"Auditora Avanzada",active:E==="audit",onClick:()=>S("audit")})]})]}),p.jsxs("div",{className:"p-6 border-t border-gray-200",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx(ph,{className:"w-5 h-5 text-blue-600"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||"Usuario"}),p.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),p.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-gray-50",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:`w-2 h-2 rounded-full ${F==="connected"?"bg-green-500":F==="connecting"?"bg-yellow-500":"bg-orange-500"}`}),p.jsx("span",{className:"text-xs text-gray-600",children:F==="connected"?"Firebase conectado":F==="connecting"?"Conectando...":"Modo demo"})]}),k.length>0&&p.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[k.length," llamadas cargadas"]})]}),p.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[p.jsx(BN,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]}),ns=({icon:H,label:ce,active:me,onClick:I})=>p.jsxs("button",{onClick:I,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${me?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[p.jsx(H,{className:"w-5 h-5 mr-3"}),p.jsx("span",{className:"text-sm",children:ce})]}),Cs=()=>{const H=(n==null?void 0:n.length)>0?n:k,me=F==="connecting"?{color:"bg-yellow-50 border-yellow-200",icon:"",title:"Conectando...",message:"Conectando con Firebase para cargar datos"}:F==="connected"?H.length>0?{color:"bg-green-50 border-green-200",icon:"",title:"Datos reales activos",message:`Mostrando datos reales de ${H.length} llamadas registradas`}:{color:"bg-blue-50 border-blue-200",icon:"",title:"Firebase conectado - Sin datos de llamadas",message:"Conectado a Firebase. Sube un archivo Excel para ver datos reales"}:{color:"bg-orange-50 border-orange-200",icon:"",title:"Modo demostracin",message:"Mostrando datos de ejemplo. Configura Firebase para persistencia completa"},I=async()=>{F==="connected"&&(nt(!1),await xt())};return p.jsx("div",{className:`${me.color} border rounded-lg p-4 mb-6`,children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"text-lg mr-3",children:me.icon}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-800",children:me.title}),p.jsx("p",{className:"text-sm text-gray-600",children:me.message})]})]}),F==="connected"&&p.jsx("button",{onClick:I,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",title:"Recargar datos desde Firebase",children:" Sincronizar"})]})})},eo=()=>{Tc.useEffect(()=>{k.length>0&&(!n||n.length===0)&&(console.log(" Sincronizando datos locales con Zustand:",k.length),i(k,"sync"))},[k,n,i]);const H=a||{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0};console.log(" Dashboard - zustandCallMetrics:",a),console.log(" Dashboard - zustandCallData length:",(n==null?void 0:n.length)||0),console.log(" Dashboard - callData local length:",(k==null?void 0:k.length)||0),console.log(" Dashboard - metrics usado:",H);const ce=w.length;T&&Object.keys(T).length;const me=l(vr);c(),console.log(" Dashboard - Verificacin de datos:"),console.log("- assignmentsToUse length:",(vr==null?void 0:vr.length)||0),console.log("- operatorMetrics length:",(me==null?void 0:me.length)||0),console.log("- operatorMetrics data:",me),console.log("- zustandOperators length:",(w==null?void 0:w.length)||0),console.log("- operatorAssignments keys:",Object.keys(Fe));let I=me;if(!me||me.length===0){console.log(" No hay mtricas de operadoras, creando datos de emergencia...");const Y=[];Object.entries(Fe).forEach(([X,Q])=>{const Z=W.find(ae=>ae.id===X);if(Z&&Q&&Array.isArray(Q)){const ae=Math.floor(H.totalCalls*(Q.length/Math.max(1,vr.length))),de=Math.floor(ae*(H.successfulCalls/Math.max(1,H.totalCalls)));Y.push({operatorName:Z.name,totalCalls:ae,successfulCalls:de,failedCalls:ae-de,averageDuration:60,successRate:ae>0?Math.round(de/ae*100):0,isEmergencyData:!0})}}),console.log(" Mtricas de emergencia creadas:",Y),I=Y}(!I||!Array.isArray(I))&&(I=[]);const N=H.totalCalls>0?(H.successfulCalls/H.totalCalls*100).toFixed(1):0,C=H.totalCalls>0?(H.failedCalls/H.totalCalls*100).toFixed(1):0,P=ce>0?(H.totalCalls/ce).toFixed(1):0,V=H.uniqueBeneficiaries>0?(H.successfulCalls/H.uniqueBeneficiaries*100).toFixed(1):0,M=I.sort((Y,X)=>X.successfulCalls-Y.successfulCalls).slice(0,3),K=I.sort((Y,X)=>X.totalCalls-Y.totalCalls)[0];return console.log(" Top Performers calculados:",M),console.log(" Operadora con ms llamadas:",K),p.jsxs("div",{className:"space-y-8",children:[p.jsx(Cs,{}),p.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-6 text-white",children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:" Resumen Ejecutivo de Teleasistencia"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[p.jsxs("div",{className:"text-3xl font-bold",children:[N,"%"]}),p.jsx("div",{className:"text-sm opacity-90",children:"Tasa de xito"})]}),p.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[p.jsx("div",{className:"text-3xl font-bold",children:H.uniqueBeneficiaries}),p.jsx("div",{className:"text-sm opacity-90",children:"Beneficiarios Atendidos"})]}),p.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[p.jsx("div",{className:"text-3xl font-bold",children:P}),p.jsx("div",{className:"text-sm opacity-90",children:"Llamadas por Operadora"})]}),p.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[p.jsxs("div",{className:"text-3xl font-bold",children:[V,"%"]}),p.jsx("div",{className:"text-sm opacity-90",children:"Tasa de Contactabilidad"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Llamadas Exitosas"}),p.jsx("p",{className:"text-3xl font-bold text-green-600",children:H.successfulCalls}),p.jsxs("p",{className:"text-sm text-gray-500",children:["de ",H.totalCalls," total"]})]}),p.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:p.jsx(Bn,{className:"h-8 w-8 text-green-600"})})]}),p.jsx("div",{className:"mt-4 pt-4 border-t",children:p.jsxs("div",{className:"flex items-center text-sm",children:[p.jsx(Vp,{className:"h-4 w-4 text-green-500 mr-1"}),p.jsxs("span",{className:"text-green-600 font-medium",children:[N,"% de xito"]})]})})]}),p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Llamadas Fallidas"}),p.jsx("p",{className:"text-3xl font-bold text-red-600",children:H.failedCalls}),p.jsx("p",{className:"text-sm text-gray-500",children:"sin contacto efectivo"})]}),p.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:p.jsx(Bn,{className:"h-8 w-8 text-red-600"})})]}),p.jsx("div",{className:"mt-4 pt-4 border-t",children:p.jsxs("div",{className:"flex items-center text-sm",children:[p.jsx(XN,{className:"h-4 w-4 text-red-500 mr-1"}),p.jsxs("span",{className:"text-red-600 font-medium",children:[C,"% de fallas"]})]})})]}),p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Beneficiarios nicos"}),p.jsx("p",{className:"text-3xl font-bold text-blue-600",children:H.uniqueBeneficiaries}),p.jsx("p",{className:"text-sm text-gray-500",children:"personas atendidas"})]}),p.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:p.jsx(Un,{className:"h-8 w-8 text-blue-600"})})]}),p.jsx("div",{className:"mt-4 pt-4 border-t",children:p.jsxs("div",{className:"flex items-center text-sm",children:[p.jsx(Un,{className:"h-4 w-4 text-blue-500 mr-1"}),p.jsx("span",{className:"text-blue-600 font-medium",children:"Cobertura poblacional"})]})})]}),p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Tiempo Promedio"}),p.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[Math.round(H.averageDuration/60),"min"]}),p.jsx("p",{className:"text-sm text-gray-500",children:"por llamada"})]}),p.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:p.jsx(lo,{className:"h-8 w-8 text-purple-600"})})]}),p.jsx("div",{className:"mt-4 pt-4 border-t",children:p.jsxs("div",{className:"flex items-center text-sm",children:[p.jsx(lo,{className:"h-4 w-4 text-purple-500 mr-1"}),p.jsx("span",{className:"text-purple-600 font-medium",children:"Eficiencia temporal"})]})})]})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[p.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[p.jsx(Vp,{className:"h-5 w-5 text-green-500 mr-2"})," Top Performers"]}),M.length>0?p.jsx("div",{className:"space-y-3",children:M.map((Y,X)=>p.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold mr-3 ${X===0?"bg-yellow-500":X===1?"bg-gray-400":"bg-orange-500"}`,children:X+1}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium",children:Y.operatorName}),p.jsxs("p",{className:"text-sm text-gray-500",children:[Y.totalCalls," llamadas",Y.isEmergencyData&&p.jsx("span",{className:"ml-1 text-xs text-yellow-600",children:"(estimado)"})]})]})]}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"font-bold text-green-600",children:Y.successfulCalls}),p.jsx("p",{className:"text-sm text-gray-500",children:"exitosas"})]})]},X))}):p.jsxs("div",{className:"text-center py-6",children:[p.jsx("p",{className:"text-gray-500 mb-2",children:"No hay datos de operadoras disponibles"}),p.jsx("p",{className:"text-sm text-gray-400",children:Fe&&Object.keys(Fe).length>0?" Verifica que haya datos de llamadas cargados":" Necesitas crear operadoras y asignar beneficiarios en el mdulo Asignaciones"})]})]}),p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[p.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[p.jsx(jl,{className:"h-5 w-5 text-blue-500 mr-2"})," Anlisis de Productividad"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Operadora ms activa"}),p.jsx("p",{className:"font-bold text-lg",children:(K==null?void 0:K.operatorName)||"N/A"}),p.jsxs("p",{className:"text-sm text-blue-600",children:[(K==null?void 0:K.totalCalls)||0," llamadas realizadas"]})]}),p.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Tasa de xito promedio"}),p.jsxs("p",{className:"font-bold text-lg",children:[N,"%"]}),p.jsx("p",{className:"text-sm text-green-600",children:"Indicador de calidad del servicio"})]}),p.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Cumplimiento de protocolo"}),p.jsxs("p",{className:"font-bold text-lg",children:[H.protocolCompliance,"%"]}),p.jsx("p",{className:"text-sm text-purple-600",children:"Adherencia a procedimientos"})]})]})]})]}),p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-6",children:" Acceso Rpido a Mdulos"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[p.jsxs("div",{onClick:()=>S("calls"),className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 border border-green-200 cursor-pointer hover:shadow-md transition-all",children:[p.jsx("div",{className:"flex items-center justify-center mb-4",children:p.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-lg flex items-center justify-center",children:p.jsx(Bn,{className:"w-8 h-8 text-white"})})}),p.jsx("h4",{className:"text-lg font-semibold text-green-800 mb-2",children:"Registro de Llamadas"}),p.jsx("p",{className:"text-sm text-green-700",children:"Sube historiales Excel, analiza resultados y clasifica por beneficiario y teleoperadora."})]}),p.jsxs("div",{onClick:()=>S("assignments"),className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200 cursor-pointer hover:shadow-md transition-all",children:[p.jsx("div",{className:"flex items-center justify-center mb-4",children:p.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-lg flex items-center justify-center",children:p.jsx(Un,{className:"w-8 h-8 text-white"})})}),p.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Asignaciones"}),p.jsx("p",{className:"text-sm text-blue-700",children:"Gestiona relaciones entre beneficiarios y teleoperadoras de manera eficiente."})]}),p.jsxs("div",{onClick:()=>S("history"),className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 border border-purple-200 cursor-pointer hover:shadow-md transition-all",children:[p.jsx("div",{className:"flex items-center justify-center mb-4",children:p.jsx("div",{className:"w-16 h-16 bg-purple-500 rounded-lg flex items-center justify-center",children:p.jsx(lo,{className:"w-8 h-8 text-white"})})}),p.jsx("h4",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Historial de Seguimientos"}),p.jsx("p",{className:"text-sm text-purple-700",children:"Clasifica beneficiarios por frecuencia y estado de contacto para seguimiento."})]})]})]}),I.length>0&&p.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[p.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[p.jsx(Un,{className:"h-5 w-5 text-indigo-500 mr-2"})," Detalle Completo por Teleoperadora",I.some(Y=>Y.isEmergencyData)&&p.jsx("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Datos Estimados"})]}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operadora"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Llamadas"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exitosas"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fallidas"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tasa xito"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rendimiento"})]})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map((Y,X)=>{var Z;const Q=Y.totalCalls>0?(Y.successfulCalls/Y.totalCalls*100).toFixed(1):0;return p.jsxs("tr",{className:"hover:bg-gray-50",children:[p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:p.jsx("span",{className:"text-indigo-600 font-semibold text-sm",children:(Z=Y.operatorName)==null?void 0:Z.substring(0,2).toUpperCase()})}),p.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y.operatorName})]})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Y.totalCalls})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium",children:Y.successfulCalls}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-medium",children:Y.failedCalls}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${parseFloat(Q)>=70?"bg-green-100 text-green-800":parseFloat(Q)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[Q,"%"]})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:p.jsx("div",{className:`h-2 rounded-full ${parseFloat(Q)>=70?"bg-green-500":parseFloat(Q)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(parseFloat(Q),100)}%`}})}),p.jsx("span",{className:"text-xs text-gray-500",children:parseFloat(Q)>=70?" Excelente":parseFloat(Q)>=50?" Regular":" Revisar"})]})})]},X)})})]})})]})]})},qt=()=>p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),p.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[p.jsx(Dv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),p.jsxs("label",{className:"cursor-pointer",children:[p.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),p.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ni,className:"hidden"})]}),p.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]}),d&&p.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),p.jsxs("div",{children:[p.jsxs("h4",{className:"text-sm font-medium text-blue-900",children:[m==="uploading"&&" Subiendo archivo...",m==="processing"&&" Procesando datos...",m==="analyzing"&&" Analizando llamadas..."]}),p.jsx("p",{className:"text-sm text-blue-700",children:g})]})]}),p.jsx("div",{className:"mt-3 w-full bg-blue-200 rounded-full h-2",children:p.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:m==="uploading"?"25%":m==="processing"?"50%":m==="analyzing"?"75%":"100%"}})})]}),m==="complete"&&!d&&n.length>0&&p.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"w-6 h-6 bg-green-600 rounded-full flex items-center justify-center",children:p.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-sm font-medium text-green-900",children:" Anlisis completado exitosamente"}),p.jsx("p",{className:"text-sm text-green-700",children:g})]})]})}),m==="error"&&!d&&p.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"w-6 h-6 bg-red-600 rounded-full flex items-center justify-center",children:p.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-sm font-medium text-red-900",children:" Error en el procesamiento"}),p.jsx("p",{className:"text-sm text-red-700",children:g}),p.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Por favor, verifica el formato del archivo e intenta nuevamente."})]})]})})]}),n.length>0&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resumen del Anlisis"}),p.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),p.jsx("div",{className:"text-sm text-gray-600",children:"Total Llamadas"})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(H=>H.categoria==="exitosa"||H.resultado==="Llamado exitoso").length}),p.jsx("div",{className:"text-sm text-gray-600",children:"Exitosas"})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.filter(H=>H.categoria!=="exitosa"&&H.resultado!=="Llamado exitoso").length}),p.jsx("div",{className:"text-sm text-gray-600",children:"Fallidas"})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(n.map(H=>H.beneficiario).filter(Boolean)).size}),p.jsx("div",{className:"text-sm text-gray-600",children:"Beneficiarios"})]})]})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),p.jsxs("div",{className:"overflow-x-auto",children:[p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-gray-50",children:[p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Comuna"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Operador"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tipo"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),p.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),p.jsx("tbody",{children:n.slice(0,10).map((H,ce)=>p.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:H.id||`call-${ce}`}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:H.fecha||"N/A"}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:H.beneficiario||"N/A"}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:H.comuna||"N/A"}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:H.operador||"No identificado"}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${H.tipo_llamada==="entrante"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:H.tipo_llamada==="entrante"?"Entrante":"Saliente"})}),p.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${H.resultado==="Llamado exitoso"||H.categoria==="exitosa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H.resultado||(H.categoria==="exitosa"?"Exitoso":"Fallido")})}),p.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[H.duracion||0,"s"]})]},H.id||ce))})]}),p.jsxs("div",{className:"mt-4 flex justify-between items-center text-sm text-gray-600",children:[p.jsxs("span",{children:["Mostrando ",Math.min(10,n.length)," de ",n.length," llamadas procesadas"]}),n.length>10&&p.jsx("span",{className:"text-blue-600",children:"Mostrando solo las primeras 10 filas"})]})]})]})]})]}),to=()=>p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),p.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),p.jsxs("button",{onClick:()=>Ee(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[p.jsx(Fv,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[p.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),p.jsx("p",{className:"text-2xl font-bold text-blue-600",children:W.length})]}),p.jsx(Un,{className:"w-8 h-8 text-blue-500"})]})}),p.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),p.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(Fe).reduce((H,ce)=>H+ce.length,0)})]}),p.jsx(Bn,{className:"w-8 h-8 text-green-500"})]})}),p.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),p.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(Fe).length})]}),p.jsx(ic,{className:"w-8 h-8 text-purple-500"})]})})]})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Bsqueda de Beneficiarios"}),p.jsx("p",{className:"text-sm text-gray-600",children:"Encuentra rpidamente qu teleoperadora est asignada a un beneficiario"})]}),p.jsxs("button",{onClick:()=>ft(!xe),className:`px-4 py-2 rounded-lg transition-colors flex items-center gap-2 ${xe?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[p.jsx(rf,{className:"w-4 h-4"}),xe?"Cerrar Bsqueda":"Buscar Beneficiario"]})]}),xe&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-4 items-center",children:[p.jsx("div",{className:"flex-1",children:p.jsx("input",{type:"text",placeholder:"Buscar por nombre del beneficiario, teleoperadora, telfono o comuna...",value:Vt,onChange:H=>na(H.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),p.jsx("button",{onClick:()=>{ar(""),Dn([])},className:"px-3 py-2 text-gray-500 hover:text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:p.jsx(Ov,{className:"w-4 h-4"})})]}),ir.length>0&&p.jsxs("div",{className:"border border-gray-200 rounded-lg divide-y divide-gray-200 max-h-96 overflow-y-auto",children:[p.jsxs("div",{className:"bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700",children:[ir.length," resultado(s) encontrado(s)"]}),ir.map((H,ce)=>p.jsx("div",{className:"p-4 hover:bg-gray-50",children:p.jsx("div",{className:"flex justify-between items-start",children:p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx("h5",{className:"font-semibold text-gray-900",children:H.beneficiary||H.beneficiario}),p.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"Beneficiario"}),p.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:H.source})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(Un,{className:"w-4 h-4 text-gray-400"}),p.jsxs("span",{children:[p.jsx("strong",{children:"Teleoperadora:"})," ",H.operatorName||H.operator||"Sin asignar"]})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(Bn,{className:"w-4 h-4 text-gray-400"}),p.jsxs("span",{children:[p.jsx("strong",{children:"Telfono Principal:"})," ",H.primaryPhone||H.phone||H.telefono||H.numero_cliente||"N/A"]})]}),H.phones&&H.phones.length>1&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(Bn,{className:"w-4 h-4 text-gray-400"}),p.jsxs("span",{children:[p.jsx("strong",{children:"Otros Telfonos:"})," ",H.phones.slice(1).join(", ")]})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(ic,{className:"w-4 h-4 text-gray-400"}),p.jsxs("span",{children:[p.jsx("strong",{children:"Comuna:"})," ",H.commune||H.comuna||"N/A"]})]})]})]})})},`${H.id||ce}-${H.source}`))]}),Vt&&ir.length===0&&p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(rf,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),p.jsxs("p",{children:['No se encontraron beneficiarios que coincidan con "',Vt,'"']}),p.jsx("p",{className:"text-sm mt-1",children:"Intenta con otro trmino de bsqueda"})]}),!Vt&&p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(rf,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),p.jsx("p",{children:"Escribe el nombre de un beneficiario, teleoperadora, telfono o comuna para buscar"}),p.jsx("p",{className:"text-sm mt-1",children:"La bsqueda incluye todas las asignaciones registradas"})]})]})]}),fe&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),p.jsx("button",{onClick:()=>Ee(!1),className:"text-gray-500 hover:text-gray-700",children:p.jsx(Ov,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),p.jsx("input",{type:"text",value:be.name,onChange:H=>U({...be,name:H.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),p.jsx("input",{type:"email",value:be.email,onChange:H=>U({...be,email:H.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),p.jsx("input",{type:"tel",value:be.phone,onChange:H=>U({...be,phone:H.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),p.jsxs("div",{className:"flex gap-3 mt-6",children:[p.jsxs("button",{onClick:ht,disabled:!be.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[p.jsx(WN,{className:"w-4 h-4"}),"Crear Teleoperador"]}),p.jsx("button",{onClick:()=>Ee(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),p.jsxs("div",{className:"space-y-4",children:[W.filter(H=>H&&H.id).map(H=>p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:H.name||"Operador sin nombre"}),Fe[H.id]&&p.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[Fe[H.id].length," beneficiarios"]})]}),p.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[H.email&&p.jsxs("p",{children:[" ",H.email]}),H.phone&&p.jsxs("p",{children:[" ",H.phone]})]})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[p.jsx(Dv,{className:"w-4 h-4"}),"Subir Excel",p.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ce=>vt(ce,H.id),className:"hidden"})]}),Fe[H.id]&&p.jsxs("button",{onClick:()=>ra(H.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[p.jsx(bv,{className:"w-4 h-4"}),"Limpiar"]}),p.jsxs("button",{onClick:()=>jt(H.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[p.jsx(bv,{className:"w-4 h-4"}),"Eliminar"]})]})]}),p.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[p.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),p.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),Fe[H.id]&&Fe[H.id].length>0&&p.jsxs("div",{className:"border-t pt-4",children:[p.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",Fe[H.id].length,")"]}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full text-sm",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-gray-50",children:[p.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),p.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),p.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),p.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),p.jsxs("tbody",{children:[Fe[H.id].slice(0,5).map(ce=>p.jsxs("tr",{className:"border-b",children:[p.jsx("td",{className:"px-3 py-2 text-gray-900",children:ce.beneficiary}),p.jsx("td",{className:"px-3 py-2 text-gray-900",children:ce.primaryPhone}),p.jsx("td",{className:"px-3 py-2 text-gray-600",children:ce.phones.length>1?ce.phones.slice(1).join(", "):"-"}),p.jsx("td",{className:"px-3 py-2 text-gray-900",children:ce.commune})]},ce.id)),Fe[H.id].length>5&&p.jsx("tr",{children:p.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",Fe[H.id].length-5," beneficiarios ms"]})})]})]})})]})]},H.id)),W.length===0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[p.jsx(Un,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),p.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),p.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),p.jsxs("button",{onClick:()=>Ee(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[p.jsx(Fv,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),Fn=()=>p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[p.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-green-800 font-semibold",children:"Al da"}),p.jsx("p",{className:"text-2xl font-bold text-green-600",children:Vr.filter(H=>H.status==="al-dia").length})]}),p.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-white text-sm",children:""})})]})}),p.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-yellow-800 font-semibold",children:"Pendientes"}),p.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:Vr.filter(H=>H.status==="pendiente").length})]}),p.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-white text-sm",children:""})})]})}),p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-red-800 font-semibold",children:"Urgentes"}),p.jsx("p",{className:"text-2xl font-bold text-red-600",children:Vr.filter(H=>H.status==="urgente").length})]}),p.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-white text-sm",children:""})})]})})]}),p.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(MN,{className:"w-4 h-4 text-gray-400"}),p.jsxs("select",{value:Te,onChange:H=>j(H.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[p.jsx("option",{value:"all",children:"Todos los estados"}),p.jsx("option",{value:"al-dia",children:"Al da"}),p.jsx("option",{value:"pendiente",children:"Pendiente"}),p.jsx("option",{value:"urgente",children:"Urgente"})]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(rf,{className:"w-4 h-4 text-gray-400"}),p.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:J,onChange:H=>G(H.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ai.length===0?p.jsx("div",{className:"col-span-full bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(ic,{className:"w-12 h-12 text-gray-400 mb-4"}),p.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay datos de seguimiento"}),p.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:h?"No se encontraron seguimientos que coincidan con los filtros aplicados.":"Para ver el historial de seguimientos, sube un archivo Excel con datos de llamadas desde el Panel Principal."}),!h&&p.jsxs("div",{className:"text-sm text-gray-500",children:[" Ve al ",p.jsx("strong",{children:"Panel Principal"}),"  ",p.jsx("strong",{children:"Cargar Excel"})," para comenzar"]})]})}):ai.map(H=>p.jsxs("div",{className:`border-2 rounded-lg p-4 hover:shadow-md transition-shadow ${H.status==="al-dia"?"border-green-200 bg-green-50":H.status==="pendiente"?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50"}`,children:[p.jsxs("div",{className:"flex items-start justify-between mb-3",children:[p.jsx("h4",{className:"font-semibold text-gray-900",children:H.beneficiary}),p.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${H.status==="al-dia"?"bg-green-100 text-green-800 border border-green-300":H.status==="pendiente"?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-red-100 text-red-800 border border-red-300"}`,children:H.status==="al-dia"?" Al da":H.status==="pendiente"?" Pendiente":" Urgente"})]}),p.jsxs("div",{className:"space-y-2 text-sm",children:[p.jsxs("div",{className:"flex items-center text-gray-700",children:[p.jsx(ph,{className:"w-4 h-4 mr-2 text-gray-500"}),p.jsx("span",{className:"font-medium",children:"Teleoperadora:"}),p.jsx("span",{className:"ml-1",children:H.operator})]}),p.jsxs("div",{className:"flex items-center text-gray-700",children:[p.jsx(Bn,{className:"w-4 h-4 mr-2 text-gray-500"}),p.jsx("span",{className:"font-medium",children:"Telfono:"}),p.jsx("span",{className:"ml-1",children:H.phone})]}),p.jsxs("div",{className:"flex items-center text-gray-700",children:[p.jsx(lo,{className:"w-4 h-4 mr-2 text-gray-500"}),p.jsx("span",{className:"font-medium",children:"ltima llamada:"}),p.jsx("span",{className:"ml-1",children:H.lastCall})]}),p.jsxs("div",{className:"flex items-center text-gray-700",children:[p.jsx(jl,{className:"w-4 h-4 mr-2 text-gray-500"}),p.jsx("span",{className:"font-medium",children:"Llamadas:"}),p.jsxs("span",{className:"ml-1",children:[H.callCount," total (",H.successfulCallCount||0," exitosas)"]})]}),H.daysSinceLastCall!==null&&p.jsxs("div",{className:"flex items-center text-gray-700",children:[p.jsx(SN,{className:"w-4 h-4 mr-2 text-gray-500"}),p.jsx("span",{className:"font-medium",children:"Hace:"}),p.jsxs("span",{className:"ml-1",children:[H.daysSinceLastCall," das"]})]}),H.lastCallResult&&H.lastCallResult!=="Sin resultado"&&p.jsxs("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs",children:[p.jsx("span",{className:"font-medium",children:"ltimo resultado:"}),p.jsx("span",{className:"ml-1",children:H.lastCallResult})]})]}),H.statusReason&&p.jsx("div",{className:`mt-3 p-2 rounded text-xs ${H.status==="al-dia"?"bg-green-100 text-green-700":H.status==="pendiente"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:p.jsxs("div",{className:"flex items-start",children:[H.status==="urgente"&&p.jsx(Mp,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),p.jsx("span",{children:H.statusReason})]})})]},H.id))})]})});return p.jsxs("div",{className:"flex h-screen bg-gray-100",children:[p.jsx(sa,{}),p.jsx("div",{className:"flex-1 overflow-auto",children:p.jsxs("div",{className:"p-6",children:[p.jsx("div",{className:"mb-6",children:p.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[E==="dashboard"&&"Panel principal",E==="calls"&&"Registro de Llamadas",E==="assignments"&&"Asignaciones",E==="history"&&"Historial de Seguimientos",E==="audit"&&"Auditora Avanzada"]})}),F==="demo"&&p.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx(Mp,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h3",{className:"text-blue-800 font-medium",children:"Modo Local"}),p.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"La aplicacin funciona con datos locales. Para persistencia en la nube, completa la configuracin de Firebase."}),p.jsx("p",{className:"text-blue-600 text-xs mt-2",children:" Consulta FIREBASE_SETUP.md para instrucciones de configuracin"})]})]})}),F==="connecting"&&p.jsx("div",{className:"mb-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),p.jsx("span",{className:"text-slate-700 text-sm",children:"Verificando configuracin de Firebase..."})]})}),E==="dashboard"&&p.jsx(Cw,{children:p.jsx(eo,{})}),E==="calls"&&p.jsx(qt,{}),E==="assignments"&&p.jsx(to,{}),E==="history"&&p.jsx(Fn,{}),E==="audit"&&p.jsx(Cw,{children:p.jsx(GU,{})})]})})]})},KU=()=>{const[t,e]=ze.useState(!0),[r,n]=ze.useState(!1),[s,a]=ze.useState({email:"",password:"",confirmPassword:"",displayName:""}),[i,o]=ze.useState(!1),{login:l,register:c,error:f,clearError:h}=$1(),d=w=>{const{name:T,value:_}=w.target;a(y=>({...y,[T]:_})),h()},m=async w=>{w.preventDefault(),o(!0);try{if(t)await l(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await c(s.email,s.password,s.displayName)}}catch(T){console.error("Error en autenticacin:",T)}finally{o(!1)}},g=()=>{e(!t),a({email:"",password:"",confirmPassword:"",displayName:""}),h()},v=w=>w?w.includes("user-not-found")?"Usuario no encontrado":w.includes("wrong-password")?"Contrasea incorrecta":w.includes("email-already-in-use")?"Este email ya est registrado":w.includes("weak-password")?"La contrasea es muy dbil":w.includes("invalid-email")?"Email invlido":w.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":w:"";return p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(Bn,{className:"w-8 h-8 text-blue-600"})}),p.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),p.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),f&&p.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[p.jsx(Mp,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),p.jsx("p",{className:"text-red-600 text-sm mt-1",children:v(f)})]})]}),p.jsxs("form",{onSubmit:m,className:"space-y-6",children:[!t&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),p.jsxs("div",{className:"relative",children:[p.jsx(ph,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),p.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),p.jsxs("div",{className:"relative",children:[p.jsx($N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),p.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Pv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),p.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:d,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),p.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?p.jsx(bN,{className:"w-5 h-5"}):p.jsx(FN,{className:"w-5 h-5"})})]})]}),!t&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Pv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),p.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),p.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:i?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):p.jsx(p.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),p.jsxs("div",{className:"mt-8 text-center",children:[p.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),p.jsx("button",{onClick:g,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),p.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx(NN,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),p.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},XU=()=>p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:p.jsx(Bn,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),p.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),p.jsxs("div",{className:"flex items-center justify-center gap-2",children:[p.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),p.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),p.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),p.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),YU=()=>{const{user:t,loading:e}=$1();return e?p.jsx(XU,{}):t?p.jsx(qU,{}):p.jsx(KU,{})};Hd.createRoot(document.getElementById("root")).render(p.jsx(Tc.StrictMode,{children:p.jsx(jU,{children:p.jsx(YU,{})})}));
