(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function zI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wE={exports:{}},zh={},TE={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jc=Symbol.for("react.element"),$I=Symbol.for("react.portal"),HI=Symbol.for("react.fragment"),WI=Symbol.for("react.strict_mode"),GI=Symbol.for("react.profiler"),KI=Symbol.for("react.provider"),qI=Symbol.for("react.context"),XI=Symbol.for("react.forward_ref"),YI=Symbol.for("react.suspense"),QI=Symbol.for("react.memo"),JI=Symbol.for("react.lazy"),gx=Symbol.iterator;function ZI(t){return t===null||typeof t!="object"?null:(t=gx&&t[gx]||t["@@iterator"],typeof t=="function"?t:null)}var AE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kE=Object.assign,SE={};function rl(t,e,r){this.props=t,this.context=e,this.refs=SE,this.updater=r||AE}rl.prototype.isReactComponent={};rl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function IE(){}IE.prototype=rl.prototype;function ym(t,e,r){this.props=t,this.context=e,this.refs=SE,this.updater=r||AE}var Em=ym.prototype=new IE;Em.constructor=ym;kE(Em,rl.prototype);Em.isPureReactComponent=!0;var xx=Array.isArray,CE=Object.prototype.hasOwnProperty,wm={current:null},RE={key:!0,ref:!0,__self:!0,__source:!0};function NE(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)CE.call(e,n)&&!RE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Jc,type:t,key:i,ref:a,props:s,_owner:wm.current}}function eC(t,e){return{$$typeof:Jc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Tm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Jc}function tC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var vx=/\/+/g;function z0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tC(""+t.key):e.toString(36)}function df(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Jc:case $I:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+z0(a,0):n,xx(s)?(r="",t!=null&&(r=t.replace(vx,"$&/")+"/"),df(s,e,r,"",function(c){return c})):s!=null&&(Tm(s)&&(s=eC(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(vx,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",xx(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+z0(i,o);a+=df(i,e,r,l,s)}else if(l=ZI(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+z0(i,o++),a+=df(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Fu(t,e,r){if(t==null)return t;var n=[],s=0;return df(t,n,"","",function(i){return e.call(r,i,s++)}),n}function rC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xr={current:null},pf={transition:null},nC={ReactCurrentDispatcher:Xr,ReactCurrentBatchConfig:pf,ReactCurrentOwner:wm};function PE(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Fu,forEach:function(t,e,r){Fu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Fu(t,function(){e++}),e},toArray:function(t){return Fu(t,function(e){return e})||[]},only:function(t){if(!Tm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=rl;We.Fragment=HI;We.Profiler=GI;We.PureComponent=ym;We.StrictMode=WI;We.Suspense=YI;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nC;We.act=PE;We.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=kE({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=wm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)CE.call(e,l)&&!RE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Jc,type:t.type,key:s,ref:i,props:n,_owner:a}};We.createContext=function(t){return t={$$typeof:qI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KI,_context:t},t.Consumer=t};We.createElement=NE;We.createFactory=function(t){var e=NE.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:XI,render:t}};We.isValidElement=Tm;We.lazy=function(t){return{$$typeof:JI,_payload:{_status:-1,_result:t},_init:rC}};We.memo=function(t,e){return{$$typeof:QI,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=pf.transition;pf.transition={};try{t()}finally{pf.transition=e}};We.unstable_act=PE;We.useCallback=function(t,e){return Xr.current.useCallback(t,e)};We.useContext=function(t){return Xr.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return Xr.current.useDeferredValue(t)};We.useEffect=function(t,e){return Xr.current.useEffect(t,e)};We.useId=function(){return Xr.current.useId()};We.useImperativeHandle=function(t,e,r){return Xr.current.useImperativeHandle(t,e,r)};We.useInsertionEffect=function(t,e){return Xr.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return Xr.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return Xr.current.useMemo(t,e)};We.useReducer=function(t,e,r){return Xr.current.useReducer(t,e,r)};We.useRef=function(t){return Xr.current.useRef(t)};We.useState=function(t){return Xr.current.useState(t)};We.useSyncExternalStore=function(t,e,r){return Xr.current.useSyncExternalStore(t,e,r)};We.useTransition=function(){return Xr.current.useTransition()};We.version="18.3.1";TE.exports=We;var He=TE.exports;const Mf=zI(He);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC=He,iC=Symbol.for("react.element"),aC=Symbol.for("react.fragment"),oC=Object.prototype.hasOwnProperty,lC=sC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cC={key:!0,ref:!0,__self:!0,__source:!0};function FE(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)oC.call(e,n)&&!cC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:iC,type:t,key:i,ref:a,props:s,_owner:lC.current}}zh.Fragment=aC;zh.jsx=FE;zh.jsxs=FE;wE.exports=zh;var S=wE.exports,Bd={},DE={exports:{}},wn={},OE={exports:{}},bE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ae,W){var le=ae.length;ae.push(W);e:for(;0<le;){var we=le-1>>>1,L=ae[we];if(0<s(L,W))ae[we]=W,ae[le]=L,le=we;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var W=ae[0],le=ae.pop();if(le!==W){ae[0]=le;e:for(var we=0,L=ae.length,K=L>>>1;we<K;){var G=2*(we+1)-1,H=ae[G],te=G+1,fe=ae[te];if(0>s(H,le))te<L&&0>s(fe,H)?(ae[we]=fe,ae[te]=le,we=te):(ae[we]=H,ae[G]=le,we=G);else if(te<L&&0>s(fe,le))ae[we]=fe,ae[te]=le,we=te;else break e}}return W}function s(ae,W){var le=ae.sortIndex-W.sortIndex;return le!==0?le:ae.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,h=null,d=3,m=!1,x=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(ae){for(var W=r(c);W!==null;){if(W.callback===null)n(c);else if(W.startTime<=ae)n(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=r(c)}}function D(ae){if(g=!1,v(ae),!x)if(r(l)!==null)x=!0,ke(z);else{var W=r(c);W!==null&&ve(D,W.startTime-ae)}}function z(ae,W){x=!1,g&&(g=!1,T(A),A=-1),m=!0;var le=d;try{for(v(W),h=r(l);h!==null&&(!(h.expirationTime>W)||ae&&!R());){var we=h.callback;if(typeof we=="function"){h.callback=null,d=h.priorityLevel;var L=we(h.expirationTime<=W);W=t.unstable_now(),typeof L=="function"?h.callback=L:h===r(l)&&n(l),v(W)}else n(l);h=r(l)}if(h!==null)var K=!0;else{var G=r(c);G!==null&&ve(D,G.startTime-W),K=!1}return K}finally{h=null,d=le,m=!1}}var B=!1,y=null,A=-1,k=5,C=-1;function R(){return!(t.unstable_now()-C<k)}function N(){if(y!==null){var ae=t.unstable_now();C=ae;var W=!0;try{W=y(!0,ae)}finally{W?F():(B=!1,y=null)}}else B=!1}var F;if(typeof _=="function")F=function(){_(N)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,he=Ee.port2;Ee.port1.onmessage=N,F=function(){he.postMessage(null)}}else F=function(){w(N,0)};function ke(ae){y=ae,B||(B=!0,F())}function ve(ae,W){A=w(function(){ae(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_continueExecution=function(){x||m||(x=!0,ke(z))},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ae){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var le=d;d=W;try{return ae()}finally{d=le}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ae,W){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var le=d;d=ae;try{return W()}finally{d=le}},t.unstable_scheduleCallback=function(ae,W,le){var we=t.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?we+le:we):le=we,ae){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=le+L,ae={id:f++,callback:W,priorityLevel:ae,startTime:le,expirationTime:L,sortIndex:-1},le>we?(ae.sortIndex=le,e(c,ae),r(l)===null&&ae===r(c)&&(g?(T(A),A=-1):g=!0,ve(D,le-we))):(ae.sortIndex=L,e(l,ae),x||m||(x=!0,ke(z))),ae},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(ae){var W=d;return function(){var le=d;d=W;try{return ae.apply(this,arguments)}finally{d=le}}}})(bE);OE.exports=bE;var uC=OE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fC=He,yn=uC;function ce(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var LE=new Set,xc={};function Ba(t,e){Bo(t,e),Bo(t+"Capture",e)}function Bo(t,e){for(xc[t]=e,t=0;t<e.length;t++)LE.add(e[t])}var Ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jd=Object.prototype.hasOwnProperty,hC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_x={},yx={};function dC(t){return jd.call(yx,t)?!0:jd.call(_x,t)?!1:hC.test(t)?yx[t]=!0:(_x[t]=!0,!1)}function pC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mC(t,e,r,n){if(e===null||typeof e>"u"||pC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yr(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var _r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_r[t]=new Yr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_r[e]=new Yr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_r[t]=new Yr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_r[t]=new Yr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_r[t]=new Yr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_r[t]=new Yr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_r[t]=new Yr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_r[t]=new Yr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_r[t]=new Yr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Am=/[\-:]([a-z])/g;function km(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Am,km);_r[e]=new Yr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Am,km);_r[e]=new Yr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Am,km);_r[e]=new Yr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_r[t]=new Yr(t,1,!1,t.toLowerCase(),null,!1,!1)});_r.xlinkHref=new Yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_r[t]=new Yr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sm(t,e,r,n){var s=_r.hasOwnProperty(e)?_r[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mC(e,r,s,n)&&(r=null),n||s===null?dC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ri=fC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Du=Symbol.for("react.element"),fo=Symbol.for("react.portal"),ho=Symbol.for("react.fragment"),Im=Symbol.for("react.strict_mode"),zd=Symbol.for("react.profiler"),ME=Symbol.for("react.provider"),VE=Symbol.for("react.context"),Cm=Symbol.for("react.forward_ref"),$d=Symbol.for("react.suspense"),Hd=Symbol.for("react.suspense_list"),Rm=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),UE=Symbol.for("react.offscreen"),Ex=Symbol.iterator;function Al(t){return t===null||typeof t!="object"?null:(t=Ex&&t[Ex]||t["@@iterator"],typeof t=="function"?t:null)}var Pt=Object.assign,$0;function Fl(t){if($0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);$0=e&&e[1]||""}return`
`+$0+t}var H0=!1;function W0(t,e){if(!t||H0)return"";H0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{H0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Fl(t):""}function gC(t){switch(t.tag){case 5:return Fl(t.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return t=W0(t.type,!1),t;case 11:return t=W0(t.type.render,!1),t;case 1:return t=W0(t.type,!0),t;default:return""}}function Wd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ho:return"Fragment";case fo:return"Portal";case zd:return"Profiler";case Im:return"StrictMode";case $d:return"Suspense";case Hd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case VE:return(t.displayName||"Context")+".Consumer";case ME:return(t._context.displayName||"Context")+".Provider";case Cm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rm:return e=t.displayName||null,e!==null?e:Wd(t.type)||"Memo";case pi:e=t._payload,t=t._init;try{return Wd(t(e))}catch{}}return null}function xC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wd(e);case 8:return e===Im?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function BE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vC(t){var e=BE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ou(t){t._valueTracker||(t._valueTracker=vC(t))}function jE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=BE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Vf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gd(t,e){var r=e.checked;return Pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function wx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=zi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zE(t,e){e=e.checked,e!=null&&Sm(t,"checked",e,!1)}function Kd(t,e){zE(t,e);var r=zi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qd(t,e.type,r):e.hasOwnProperty("defaultValue")&&qd(t,e.type,zi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Tx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function qd(t,e,r){(e!=="number"||Vf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Dl=Array.isArray;function So(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+zi(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Xd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ax(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ce(92));if(Dl(r)){if(1<r.length)throw Error(ce(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:zi(r)}}function $E(t,e){var r=zi(e.value),n=zi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function kx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function HE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?HE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bu,WE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bu=bu||document.createElement("div"),bu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_C=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(t){_C.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gl[e]=Gl[t]})});function GE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Gl.hasOwnProperty(t)&&Gl[t]?(""+e).trim():e+"px"}function KE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=GE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var yC=Pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qd(t,e){if(e){if(yC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function Jd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zd=null;function Nm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ep=null,Io=null,Co=null;function Sx(t){if(t=tu(t)){if(typeof ep!="function")throw Error(ce(280));var e=t.stateNode;e&&(e=Kh(e),ep(t.stateNode,t.type,e))}}function qE(t){Io?Co?Co.push(t):Co=[t]:Io=t}function XE(){if(Io){var t=Io,e=Co;if(Co=Io=null,Sx(t),e)for(t=0;t<e.length;t++)Sx(e[t])}}function YE(t,e){return t(e)}function QE(){}var G0=!1;function JE(t,e,r){if(G0)return t(e,r);G0=!0;try{return YE(t,e,r)}finally{G0=!1,(Io!==null||Co!==null)&&(QE(),XE())}}function _c(t,e){var r=t.stateNode;if(r===null)return null;var n=Kh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ce(231,e,typeof r));return r}var tp=!1;if(Ks)try{var kl={};Object.defineProperty(kl,"passive",{get:function(){tp=!0}}),window.addEventListener("test",kl,kl),window.removeEventListener("test",kl,kl)}catch{tp=!1}function EC(t,e,r,n,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var Kl=!1,Uf=null,Bf=!1,rp=null,wC={onError:function(t){Kl=!0,Uf=t}};function TC(t,e,r,n,s,i,a,o,l){Kl=!1,Uf=null,EC.apply(wC,arguments)}function AC(t,e,r,n,s,i,a,o,l){if(TC.apply(this,arguments),Kl){if(Kl){var c=Uf;Kl=!1,Uf=null}else throw Error(ce(198));Bf||(Bf=!0,rp=c)}}function ja(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function ZE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ix(t){if(ja(t)!==t)throw Error(ce(188))}function kC(t){var e=t.alternate;if(!e){if(e=ja(t),e===null)throw Error(ce(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Ix(s),t;if(i===n)return Ix(s),e;i=i.sibling}throw Error(ce(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?t:e}function e2(t){return t=kC(t),t!==null?t2(t):null}function t2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=t2(t);if(e!==null)return e;t=t.sibling}return null}var r2=yn.unstable_scheduleCallback,Cx=yn.unstable_cancelCallback,SC=yn.unstable_shouldYield,IC=yn.unstable_requestPaint,jt=yn.unstable_now,CC=yn.unstable_getCurrentPriorityLevel,Pm=yn.unstable_ImmediatePriority,n2=yn.unstable_UserBlockingPriority,jf=yn.unstable_NormalPriority,RC=yn.unstable_LowPriority,s2=yn.unstable_IdlePriority,$h=null,xs=null;function NC(t){if(xs&&typeof xs.onCommitFiberRoot=="function")try{xs.onCommitFiberRoot($h,t,void 0,(t.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:DC,PC=Math.log,FC=Math.LN2;function DC(t){return t>>>=0,t===0?32:31-(PC(t)/FC|0)|0}var Lu=64,Mu=4194304;function Ol(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Ol(o):(i&=a,i!==0&&(n=Ol(i)))}else a=r&~s,a!==0?n=Ol(a):i!==0&&(n=Ol(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Jn(e),s=1<<r,n|=t[r],e&=~s;return n}function OC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Jn(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=OC(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function np(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function i2(){var t=Lu;return Lu<<=1,!(Lu&4194240)&&(Lu=64),t}function K0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Zc(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jn(e),t[e]=r}function LC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Jn(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Fm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Jn(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var ct=0;function a2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var o2,Dm,l2,c2,u2,sp=!1,Vu=[],Ci=null,Ri=null,Ni=null,yc=new Map,Ec=new Map,gi=[],MC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rx(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ri=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":yc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(e.pointerId)}}function Sl(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=tu(e),e!==null&&Dm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function VC(t,e,r,n,s){switch(e){case"focusin":return Ci=Sl(Ci,t,e,r,n,s),!0;case"dragenter":return Ri=Sl(Ri,t,e,r,n,s),!0;case"mouseover":return Ni=Sl(Ni,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return yc.set(i,Sl(yc.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Ec.set(i,Sl(Ec.get(i)||null,t,e,r,n,s)),!0}return!1}function f2(t){var e=ma(t.target);if(e!==null){var r=ja(e);if(r!==null){if(e=r.tag,e===13){if(e=ZE(r),e!==null){t.blockedOn=e,u2(t.priority,function(){l2(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ip(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Zd=n,r.target.dispatchEvent(n),Zd=null}else return e=tu(r),e!==null&&Dm(e),t.blockedOn=r,!1;e.shift()}return!0}function Nx(t,e,r){mf(t)&&r.delete(e)}function UC(){sp=!1,Ci!==null&&mf(Ci)&&(Ci=null),Ri!==null&&mf(Ri)&&(Ri=null),Ni!==null&&mf(Ni)&&(Ni=null),yc.forEach(Nx),Ec.forEach(Nx)}function Il(t,e){t.blockedOn===e&&(t.blockedOn=null,sp||(sp=!0,yn.unstable_scheduleCallback(yn.unstable_NormalPriority,UC)))}function wc(t){function e(s){return Il(s,t)}if(0<Vu.length){Il(Vu[0],t);for(var r=1;r<Vu.length;r++){var n=Vu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ci!==null&&Il(Ci,t),Ri!==null&&Il(Ri,t),Ni!==null&&Il(Ni,t),yc.forEach(e),Ec.forEach(e),r=0;r<gi.length;r++)n=gi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<gi.length&&(r=gi[0],r.blockedOn===null);)f2(r),r.blockedOn===null&&gi.shift()}var Ro=ri.ReactCurrentBatchConfig,$f=!0;function BC(t,e,r,n){var s=ct,i=Ro.transition;Ro.transition=null;try{ct=1,Om(t,e,r,n)}finally{ct=s,Ro.transition=i}}function jC(t,e,r,n){var s=ct,i=Ro.transition;Ro.transition=null;try{ct=4,Om(t,e,r,n)}finally{ct=s,Ro.transition=i}}function Om(t,e,r,n){if($f){var s=ip(t,e,r,n);if(s===null)nd(t,e,n,Hf,r),Rx(t,n);else if(VC(s,t,e,r,n))n.stopPropagation();else if(Rx(t,n),e&4&&-1<MC.indexOf(t)){for(;s!==null;){var i=tu(s);if(i!==null&&o2(i),i=ip(t,e,r,n),i===null&&nd(t,e,n,Hf,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else nd(t,e,n,null,r)}}var Hf=null;function ip(t,e,r,n){if(Hf=null,t=Nm(n),t=ma(t),t!==null)if(e=ja(t),e===null)t=null;else if(r=e.tag,r===13){if(t=ZE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hf=t,null}function h2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CC()){case Pm:return 1;case n2:return 4;case jf:case RC:return 16;case s2:return 536870912;default:return 16}default:return 16}}var Ti=null,bm=null,gf=null;function d2(){if(gf)return gf;var t,e=bm,r=e.length,n,s="value"in Ti?Ti.value:Ti.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return gf=s.slice(t,1<n?1-n:void 0)}function xf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Uu(){return!0}function Px(){return!1}function Tn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Uu:Px,this.isPropagationStopped=Px,this}return Pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Uu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Uu)},persist:function(){},isPersistent:Uu}),e}var nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lm=Tn(nl),eu=Pt({},nl,{view:0,detail:0}),zC=Tn(eu),q0,X0,Cl,Hh=Pt({},eu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cl&&(Cl&&t.type==="mousemove"?(q0=t.screenX-Cl.screenX,X0=t.screenY-Cl.screenY):X0=q0=0,Cl=t),q0)},movementY:function(t){return"movementY"in t?t.movementY:X0}}),Fx=Tn(Hh),$C=Pt({},Hh,{dataTransfer:0}),HC=Tn($C),WC=Pt({},eu,{relatedTarget:0}),Y0=Tn(WC),GC=Pt({},nl,{animationName:0,elapsedTime:0,pseudoElement:0}),KC=Tn(GC),qC=Pt({},nl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),XC=Tn(qC),YC=Pt({},nl,{data:0}),Dx=Tn(YC),QC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function e4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ZC[t])?!!e[t]:!1}function Mm(){return e4}var t4=Pt({},eu,{key:function(t){if(t.key){var e=QC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mm,charCode:function(t){return t.type==="keypress"?xf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),r4=Tn(t4),n4=Pt({},Hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ox=Tn(n4),s4=Pt({},eu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mm}),i4=Tn(s4),a4=Pt({},nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),o4=Tn(a4),l4=Pt({},Hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),c4=Tn(l4),u4=[9,13,27,32],Vm=Ks&&"CompositionEvent"in window,ql=null;Ks&&"documentMode"in document&&(ql=document.documentMode);var f4=Ks&&"TextEvent"in window&&!ql,p2=Ks&&(!Vm||ql&&8<ql&&11>=ql),bx=" ",Lx=!1;function m2(t,e){switch(t){case"keyup":return u4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var po=!1;function h4(t,e){switch(t){case"compositionend":return g2(e);case"keypress":return e.which!==32?null:(Lx=!0,bx);case"textInput":return t=e.data,t===bx&&Lx?null:t;default:return null}}function d4(t,e){if(po)return t==="compositionend"||!Vm&&m2(t,e)?(t=d2(),gf=bm=Ti=null,po=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return p2&&e.locale!=="ko"?null:e.data;default:return null}}var p4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!p4[t.type]:e==="textarea"}function x2(t,e,r,n){qE(n),e=Wf(e,"onChange"),0<e.length&&(r=new Lm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Xl=null,Tc=null;function m4(t){C2(t,0)}function Wh(t){var e=xo(t);if(jE(e))return t}function g4(t,e){if(t==="change")return e}var v2=!1;if(Ks){var Q0;if(Ks){var J0="oninput"in document;if(!J0){var Vx=document.createElement("div");Vx.setAttribute("oninput","return;"),J0=typeof Vx.oninput=="function"}Q0=J0}else Q0=!1;v2=Q0&&(!document.documentMode||9<document.documentMode)}function Ux(){Xl&&(Xl.detachEvent("onpropertychange",_2),Tc=Xl=null)}function _2(t){if(t.propertyName==="value"&&Wh(Tc)){var e=[];x2(e,Tc,t,Nm(t)),JE(m4,e)}}function x4(t,e,r){t==="focusin"?(Ux(),Xl=e,Tc=r,Xl.attachEvent("onpropertychange",_2)):t==="focusout"&&Ux()}function v4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wh(Tc)}function _4(t,e){if(t==="click")return Wh(e)}function y4(t,e){if(t==="input"||t==="change")return Wh(e)}function E4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ts=typeof Object.is=="function"?Object.is:E4;function Ac(t,e){if(ts(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!jd.call(e,s)||!ts(t[s],e[s]))return!1}return!0}function Bx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jx(t,e){var r=Bx(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bx(r)}}function y2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?y2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function E2(){for(var t=window,e=Vf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Vf(t.document)}return e}function Um(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function w4(t){var e=E2(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&y2(r.ownerDocument.documentElement,r)){if(n!==null&&Um(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=jx(r,i);var a=jx(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var T4=Ks&&"documentMode"in document&&11>=document.documentMode,mo=null,ap=null,Yl=null,op=!1;function zx(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;op||mo==null||mo!==Vf(n)||(n=mo,"selectionStart"in n&&Um(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yl&&Ac(Yl,n)||(Yl=n,n=Wf(ap,"onSelect"),0<n.length&&(e=new Lm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=mo)))}function Bu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var go={animationend:Bu("Animation","AnimationEnd"),animationiteration:Bu("Animation","AnimationIteration"),animationstart:Bu("Animation","AnimationStart"),transitionend:Bu("Transition","TransitionEnd")},Z0={},w2={};Ks&&(w2=document.createElement("div").style,"AnimationEvent"in window||(delete go.animationend.animation,delete go.animationiteration.animation,delete go.animationstart.animation),"TransitionEvent"in window||delete go.transitionend.transition);function Gh(t){if(Z0[t])return Z0[t];if(!go[t])return t;var e=go[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in w2)return Z0[t]=e[r];return t}var T2=Gh("animationend"),A2=Gh("animationiteration"),k2=Gh("animationstart"),S2=Gh("transitionend"),I2=new Map,$x="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zi(t,e){I2.set(t,e),Ba(e,[t])}for(var ed=0;ed<$x.length;ed++){var td=$x[ed],A4=td.toLowerCase(),k4=td[0].toUpperCase()+td.slice(1);Zi(A4,"on"+k4)}Zi(T2,"onAnimationEnd");Zi(A2,"onAnimationIteration");Zi(k2,"onAnimationStart");Zi("dblclick","onDoubleClick");Zi("focusin","onFocus");Zi("focusout","onBlur");Zi(S2,"onTransitionEnd");Bo("onMouseEnter",["mouseout","mouseover"]);Bo("onMouseLeave",["mouseout","mouseover"]);Bo("onPointerEnter",["pointerout","pointerover"]);Bo("onPointerLeave",["pointerout","pointerover"]);Ba("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ba("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ba("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ba("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ba("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ba("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S4=new Set("cancel close invalid load scroll toggle".split(" ").concat(bl));function Hx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,AC(n,e,void 0,t),t.currentTarget=null}function C2(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;Hx(s,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;Hx(s,o,c),i=l}}}if(Bf)throw t=rp,Bf=!1,rp=null,t}function Et(t,e){var r=e[hp];r===void 0&&(r=e[hp]=new Set);var n=t+"__bubble";r.has(n)||(R2(e,t,2,!1),r.add(n))}function rd(t,e,r){var n=0;e&&(n|=4),R2(r,t,n,e)}var ju="_reactListening"+Math.random().toString(36).slice(2);function kc(t){if(!t[ju]){t[ju]=!0,LE.forEach(function(r){r!=="selectionchange"&&(S4.has(r)||rd(r,!1,t),rd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ju]||(e[ju]=!0,rd("selectionchange",!1,e))}}function R2(t,e,r,n){switch(h2(e)){case 1:var s=BC;break;case 4:s=jC;break;default:s=Om}r=s.bind(null,e,r,t),s=void 0,!tp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function nd(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=ma(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}JE(function(){var c=i,f=Nm(r),h=[];e:{var d=I2.get(t);if(d!==void 0){var m=Lm,x=t;switch(t){case"keypress":if(xf(r)===0)break e;case"keydown":case"keyup":m=r4;break;case"focusin":x="focus",m=Y0;break;case"focusout":x="blur",m=Y0;break;case"beforeblur":case"afterblur":m=Y0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Fx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=HC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=i4;break;case T2:case A2:case k2:m=KC;break;case S2:m=o4;break;case"scroll":m=zC;break;case"wheel":m=c4;break;case"copy":case"cut":case"paste":m=XC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ox}var g=(e&4)!==0,w=!g&&t==="scroll",T=g?d!==null?d+"Capture":null:d;g=[];for(var _=c,v;_!==null;){v=_;var D=v.stateNode;if(v.tag===5&&D!==null&&(v=D,T!==null&&(D=_c(_,T),D!=null&&g.push(Sc(_,D,v)))),w)break;_=_.return}0<g.length&&(d=new m(d,x,null,r,f),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==Zd&&(x=r.relatedTarget||r.fromElement)&&(ma(x)||x[qs]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=c,x=x?ma(x):null,x!==null&&(w=ja(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(g=Fx,D="onMouseLeave",T="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(g=Ox,D="onPointerLeave",T="onPointerEnter",_="pointer"),w=m==null?d:xo(m),v=x==null?d:xo(x),d=new g(D,_+"leave",m,r,f),d.target=w,d.relatedTarget=v,D=null,ma(f)===c&&(g=new g(T,_+"enter",x,r,f),g.target=v,g.relatedTarget=w,D=g),w=D,m&&x)t:{for(g=m,T=x,_=0,v=g;v;v=so(v))_++;for(v=0,D=T;D;D=so(D))v++;for(;0<_-v;)g=so(g),_--;for(;0<v-_;)T=so(T),v--;for(;_--;){if(g===T||T!==null&&g===T.alternate)break t;g=so(g),T=so(T)}g=null}else g=null;m!==null&&Wx(h,d,m,g,!1),x!==null&&w!==null&&Wx(h,w,x,g,!0)}}e:{if(d=c?xo(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var z=g4;else if(Mx(d))if(v2)z=y4;else{z=v4;var B=x4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=_4);if(z&&(z=z(t,c))){x2(h,z,r,f);break e}B&&B(t,d,c),t==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&qd(d,"number",d.value)}switch(B=c?xo(c):window,t){case"focusin":(Mx(B)||B.contentEditable==="true")&&(mo=B,ap=c,Yl=null);break;case"focusout":Yl=ap=mo=null;break;case"mousedown":op=!0;break;case"contextmenu":case"mouseup":case"dragend":op=!1,zx(h,r,f);break;case"selectionchange":if(T4)break;case"keydown":case"keyup":zx(h,r,f)}var y;if(Vm)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else po?m2(t,r)&&(A="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(p2&&r.locale!=="ko"&&(po||A!=="onCompositionStart"?A==="onCompositionEnd"&&po&&(y=d2()):(Ti=f,bm="value"in Ti?Ti.value:Ti.textContent,po=!0)),B=Wf(c,A),0<B.length&&(A=new Dx(A,t,null,r,f),h.push({event:A,listeners:B}),y?A.data=y:(y=g2(r),y!==null&&(A.data=y)))),(y=f4?h4(t,r):d4(t,r))&&(c=Wf(c,"onBeforeInput"),0<c.length&&(f=new Dx("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=y))}C2(h,e)})}function Sc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Wf(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_c(t,r),i!=null&&n.unshift(Sc(t,i,s)),i=_c(t,e),i!=null&&n.push(Sc(t,i,s))),t=t.return}return n}function so(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Wx(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=_c(r,i),l!=null&&a.unshift(Sc(r,l,o))):s||(l=_c(r,i),l!=null&&a.push(Sc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var I4=/\r\n?/g,C4=/\u0000|\uFFFD/g;function Gx(t){return(typeof t=="string"?t:""+t).replace(I4,`
`).replace(C4,"")}function zu(t,e,r){if(e=Gx(e),Gx(t)!==e&&r)throw Error(ce(425))}function Gf(){}var lp=null,cp=null;function up(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fp=typeof setTimeout=="function"?setTimeout:void 0,R4=typeof clearTimeout=="function"?clearTimeout:void 0,Kx=typeof Promise=="function"?Promise:void 0,N4=typeof queueMicrotask=="function"?queueMicrotask:typeof Kx<"u"?function(t){return Kx.resolve(null).then(t).catch(P4)}:fp;function P4(t){setTimeout(function(){throw t})}function sd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),wc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);wc(e)}function Pi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var sl=Math.random().toString(36).slice(2),ds="__reactFiber$"+sl,Ic="__reactProps$"+sl,qs="__reactContainer$"+sl,hp="__reactEvents$"+sl,F4="__reactListeners$"+sl,D4="__reactHandles$"+sl;function ma(t){var e=t[ds];if(e)return e;for(var r=t.parentNode;r;){if(e=r[qs]||r[ds]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=qx(t);t!==null;){if(r=t[ds])return r;t=qx(t)}return e}t=r,r=t.parentNode}return null}function tu(t){return t=t[ds]||t[qs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ce(33))}function Kh(t){return t[Ic]||null}var dp=[],vo=-1;function ea(t){return{current:t}}function Tt(t){0>vo||(t.current=dp[vo],dp[vo]=null,vo--)}function vt(t,e){vo++,dp[vo]=t.current,t.current=e}var $i={},Lr=ea($i),an=ea(!1),Sa=$i;function jo(t,e){var r=t.type.contextTypes;if(!r)return $i;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function on(t){return t=t.childContextTypes,t!=null}function Kf(){Tt(an),Tt(Lr)}function Xx(t,e,r){if(Lr.current!==$i)throw Error(ce(168));vt(Lr,e),vt(an,r)}function N2(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(ce(108,xC(t)||"Unknown",s));return Pt({},r,n)}function qf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$i,Sa=Lr.current,vt(Lr,t),vt(an,an.current),!0}function Yx(t,e,r){var n=t.stateNode;if(!n)throw Error(ce(169));r?(t=N2(t,e,Sa),n.__reactInternalMemoizedMergedChildContext=t,Tt(an),Tt(Lr),vt(Lr,t)):Tt(an),vt(an,r)}var bs=null,qh=!1,id=!1;function P2(t){bs===null?bs=[t]:bs.push(t)}function O4(t){qh=!0,P2(t)}function ta(){if(!id&&bs!==null){id=!0;var t=0,e=ct;try{var r=bs;for(ct=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}bs=null,qh=!1}catch(s){throw bs!==null&&(bs=bs.slice(t+1)),r2(Pm,ta),s}finally{ct=e,id=!1}}return null}var _o=[],yo=0,Xf=null,Yf=0,Cn=[],Rn=0,Ia=null,Ms=1,Vs="";function fa(t,e){_o[yo++]=Yf,_o[yo++]=Xf,Xf=t,Yf=e}function F2(t,e,r){Cn[Rn++]=Ms,Cn[Rn++]=Vs,Cn[Rn++]=Ia,Ia=t;var n=Ms;t=Vs;var s=32-Jn(n)-1;n&=~(1<<s),r+=1;var i=32-Jn(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Ms=1<<32-Jn(e)+s|r<<s|n,Vs=i+t}else Ms=1<<i|r<<s|n,Vs=t}function Bm(t){t.return!==null&&(fa(t,1),F2(t,1,0))}function jm(t){for(;t===Xf;)Xf=_o[--yo],_o[yo]=null,Yf=_o[--yo],_o[yo]=null;for(;t===Ia;)Ia=Cn[--Rn],Cn[Rn]=null,Vs=Cn[--Rn],Cn[Rn]=null,Ms=Cn[--Rn],Cn[Rn]=null}var vn=null,gn=null,Ct=!1,Kn=null;function D2(t,e){var r=Fn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Qx(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vn=t,gn=Pi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vn=t,gn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ia!==null?{id:Ms,overflow:Vs}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Fn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,vn=t,gn=null,!0):!1;default:return!1}}function pp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mp(t){if(Ct){var e=gn;if(e){var r=e;if(!Qx(t,e)){if(pp(t))throw Error(ce(418));e=Pi(r.nextSibling);var n=vn;e&&Qx(t,e)?D2(n,r):(t.flags=t.flags&-4097|2,Ct=!1,vn=t)}}else{if(pp(t))throw Error(ce(418));t.flags=t.flags&-4097|2,Ct=!1,vn=t}}}function Jx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vn=t}function $u(t){if(t!==vn)return!1;if(!Ct)return Jx(t),Ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!up(t.type,t.memoizedProps)),e&&(e=gn)){if(pp(t))throw O2(),Error(ce(418));for(;e;)D2(t,e),e=Pi(e.nextSibling)}if(Jx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ce(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){gn=Pi(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}gn=null}}else gn=vn?Pi(t.stateNode.nextSibling):null;return!0}function O2(){for(var t=gn;t;)t=Pi(t.nextSibling)}function zo(){gn=vn=null,Ct=!1}function zm(t){Kn===null?Kn=[t]:Kn.push(t)}var b4=ri.ReactCurrentBatchConfig;function Rl(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,t))}return t}function Hu(t,e){throw t=Object.prototype.toString.call(e),Error(ce(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Zx(t){var e=t._init;return e(t._payload)}function b2(t){function e(T,_){if(t){var v=T.deletions;v===null?(T.deletions=[_],T.flags|=16):v.push(_)}}function r(T,_){if(!t)return null;for(;_!==null;)e(T,_),_=_.sibling;return null}function n(T,_){for(T=new Map;_!==null;)_.key!==null?T.set(_.key,_):T.set(_.index,_),_=_.sibling;return T}function s(T,_){return T=bi(T,_),T.index=0,T.sibling=null,T}function i(T,_,v){return T.index=v,t?(v=T.alternate,v!==null?(v=v.index,v<_?(T.flags|=2,_):v):(T.flags|=2,_)):(T.flags|=1048576,_)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,_,v,D){return _===null||_.tag!==6?(_=hd(v,T.mode,D),_.return=T,_):(_=s(_,v),_.return=T,_)}function l(T,_,v,D){var z=v.type;return z===ho?f(T,_,v.props.children,D,v.key):_!==null&&(_.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===pi&&Zx(z)===_.type)?(D=s(_,v.props),D.ref=Rl(T,_,v),D.return=T,D):(D=Af(v.type,v.key,v.props,null,T.mode,D),D.ref=Rl(T,_,v),D.return=T,D)}function c(T,_,v,D){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=dd(v,T.mode,D),_.return=T,_):(_=s(_,v.children||[]),_.return=T,_)}function f(T,_,v,D,z){return _===null||_.tag!==7?(_=wa(v,T.mode,D,z),_.return=T,_):(_=s(_,v),_.return=T,_)}function h(T,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=hd(""+_,T.mode,v),_.return=T,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Du:return v=Af(_.type,_.key,_.props,null,T.mode,v),v.ref=Rl(T,null,_),v.return=T,v;case fo:return _=dd(_,T.mode,v),_.return=T,_;case pi:var D=_._init;return h(T,D(_._payload),v)}if(Dl(_)||Al(_))return _=wa(_,T.mode,v,null),_.return=T,_;Hu(T,_)}return null}function d(T,_,v,D){var z=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return z!==null?null:o(T,_,""+v,D);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Du:return v.key===z?l(T,_,v,D):null;case fo:return v.key===z?c(T,_,v,D):null;case pi:return z=v._init,d(T,_,z(v._payload),D)}if(Dl(v)||Al(v))return z!==null?null:f(T,_,v,D,null);Hu(T,v)}return null}function m(T,_,v,D,z){if(typeof D=="string"&&D!==""||typeof D=="number")return T=T.get(v)||null,o(_,T,""+D,z);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Du:return T=T.get(D.key===null?v:D.key)||null,l(_,T,D,z);case fo:return T=T.get(D.key===null?v:D.key)||null,c(_,T,D,z);case pi:var B=D._init;return m(T,_,v,B(D._payload),z)}if(Dl(D)||Al(D))return T=T.get(v)||null,f(_,T,D,z,null);Hu(_,D)}return null}function x(T,_,v,D){for(var z=null,B=null,y=_,A=_=0,k=null;y!==null&&A<v.length;A++){y.index>A?(k=y,y=null):k=y.sibling;var C=d(T,y,v[A],D);if(C===null){y===null&&(y=k);break}t&&y&&C.alternate===null&&e(T,y),_=i(C,_,A),B===null?z=C:B.sibling=C,B=C,y=k}if(A===v.length)return r(T,y),Ct&&fa(T,A),z;if(y===null){for(;A<v.length;A++)y=h(T,v[A],D),y!==null&&(_=i(y,_,A),B===null?z=y:B.sibling=y,B=y);return Ct&&fa(T,A),z}for(y=n(T,y);A<v.length;A++)k=m(y,T,A,v[A],D),k!==null&&(t&&k.alternate!==null&&y.delete(k.key===null?A:k.key),_=i(k,_,A),B===null?z=k:B.sibling=k,B=k);return t&&y.forEach(function(R){return e(T,R)}),Ct&&fa(T,A),z}function g(T,_,v,D){var z=Al(v);if(typeof z!="function")throw Error(ce(150));if(v=z.call(v),v==null)throw Error(ce(151));for(var B=z=null,y=_,A=_=0,k=null,C=v.next();y!==null&&!C.done;A++,C=v.next()){y.index>A?(k=y,y=null):k=y.sibling;var R=d(T,y,C.value,D);if(R===null){y===null&&(y=k);break}t&&y&&R.alternate===null&&e(T,y),_=i(R,_,A),B===null?z=R:B.sibling=R,B=R,y=k}if(C.done)return r(T,y),Ct&&fa(T,A),z;if(y===null){for(;!C.done;A++,C=v.next())C=h(T,C.value,D),C!==null&&(_=i(C,_,A),B===null?z=C:B.sibling=C,B=C);return Ct&&fa(T,A),z}for(y=n(T,y);!C.done;A++,C=v.next())C=m(y,T,A,C.value,D),C!==null&&(t&&C.alternate!==null&&y.delete(C.key===null?A:C.key),_=i(C,_,A),B===null?z=C:B.sibling=C,B=C);return t&&y.forEach(function(N){return e(T,N)}),Ct&&fa(T,A),z}function w(T,_,v,D){if(typeof v=="object"&&v!==null&&v.type===ho&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Du:e:{for(var z=v.key,B=_;B!==null;){if(B.key===z){if(z=v.type,z===ho){if(B.tag===7){r(T,B.sibling),_=s(B,v.props.children),_.return=T,T=_;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===pi&&Zx(z)===B.type){r(T,B.sibling),_=s(B,v.props),_.ref=Rl(T,B,v),_.return=T,T=_;break e}r(T,B);break}else e(T,B);B=B.sibling}v.type===ho?(_=wa(v.props.children,T.mode,D,v.key),_.return=T,T=_):(D=Af(v.type,v.key,v.props,null,T.mode,D),D.ref=Rl(T,_,v),D.return=T,T=D)}return a(T);case fo:e:{for(B=v.key;_!==null;){if(_.key===B)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){r(T,_.sibling),_=s(_,v.children||[]),_.return=T,T=_;break e}else{r(T,_);break}else e(T,_);_=_.sibling}_=dd(v,T.mode,D),_.return=T,T=_}return a(T);case pi:return B=v._init,w(T,_,B(v._payload),D)}if(Dl(v))return x(T,_,v,D);if(Al(v))return g(T,_,v,D);Hu(T,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(r(T,_.sibling),_=s(_,v),_.return=T,T=_):(r(T,_),_=hd(v,T.mode,D),_.return=T,T=_),a(T)):r(T,_)}return w}var $o=b2(!0),L2=b2(!1),Qf=ea(null),Jf=null,Eo=null,$m=null;function Hm(){$m=Eo=Jf=null}function Wm(t){var e=Qf.current;Tt(Qf),t._currentValue=e}function gp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function No(t,e){Jf=t,$m=Eo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(sn=!0),t.firstContext=null)}function Ln(t){var e=t._currentValue;if($m!==t)if(t={context:t,memoizedValue:e,next:null},Eo===null){if(Jf===null)throw Error(ce(308));Eo=t,Jf.dependencies={lanes:0,firstContext:t}}else Eo=Eo.next=t;return e}var ga=null;function Gm(t){ga===null?ga=[t]:ga.push(t)}function M2(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Gm(e)):(r.next=s.next,s.next=r),e.interleaved=r,Xs(t,n)}function Xs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var mi=!1;function Km(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function V2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,nt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Xs(t,r)}return s=n.interleaved,s===null?(e.next=e,Gm(n)):(e.next=s.next,s.next=e),n.interleaved=e,Xs(t,r)}function vf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Fm(t,r)}}function ev(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Zf(t,e,r,n){var s=t.updateQueue;mi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;a=0,f=c=l=null,o=i;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,g=o;switch(d=e,m=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(m,h,d);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,d=typeof x=="function"?x.call(m,h,d):x,d==null)break e;h=Pt({},h,d);break e;case 2:mi=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(f===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ra|=a,t.lanes=a,t.memoizedState=h}}function tv(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ce(191,s));s.call(n)}}}var ru={},vs=ea(ru),Cc=ea(ru),Rc=ea(ru);function xa(t){if(t===ru)throw Error(ce(174));return t}function qm(t,e){switch(vt(Rc,e),vt(Cc,t),vt(vs,ru),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yd(e,t)}Tt(vs),vt(vs,e)}function Ho(){Tt(vs),Tt(Cc),Tt(Rc)}function U2(t){xa(Rc.current);var e=xa(vs.current),r=Yd(e,t.type);e!==r&&(vt(Cc,t),vt(vs,r))}function Xm(t){Cc.current===t&&(Tt(vs),Tt(Cc))}var Rt=ea(0);function eh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ad=[];function Ym(){for(var t=0;t<ad.length;t++)ad[t]._workInProgressVersionPrimary=null;ad.length=0}var _f=ri.ReactCurrentDispatcher,od=ri.ReactCurrentBatchConfig,Ca=0,Nt=null,er=null,or=null,th=!1,Ql=!1,Nc=0,L4=0;function kr(){throw Error(ce(321))}function Qm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ts(t[r],e[r]))return!1;return!0}function Jm(t,e,r,n,s,i){if(Ca=i,Nt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_f.current=t===null||t.memoizedState===null?B4:j4,t=r(n,s),Ql){i=0;do{if(Ql=!1,Nc=0,25<=i)throw Error(ce(301));i+=1,or=er=null,e.updateQueue=null,_f.current=z4,t=r(n,s)}while(Ql)}if(_f.current=rh,e=er!==null&&er.next!==null,Ca=0,or=er=Nt=null,th=!1,e)throw Error(ce(300));return t}function Zm(){var t=Nc!==0;return Nc=0,t}function fs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?Nt.memoizedState=or=t:or=or.next=t,or}function Mn(){if(er===null){var t=Nt.alternate;t=t!==null?t.memoizedState:null}else t=er.next;var e=or===null?Nt.memoizedState:or.next;if(e!==null)or=e,er=t;else{if(t===null)throw Error(ce(310));er=t,t={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},or===null?Nt.memoizedState=or=t:or=or.next=t}return or}function Pc(t,e){return typeof e=="function"?e(t):e}function ld(t){var e=Mn(),r=e.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=t;var n=er,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,c=i;do{var f=c.lane;if((Ca&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Nt.lanes|=f,Ra|=f}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,ts(n,e.memoizedState)||(sn=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Nt.lanes|=i,Ra|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function cd(t){var e=Mn(),r=e.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);ts(i,e.memoizedState)||(sn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function B2(){}function j2(t,e){var r=Nt,n=Mn(),s=e(),i=!ts(n.memoizedState,s);if(i&&(n.memoizedState=s,sn=!0),n=n.queue,eg(H2.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||or!==null&&or.memoizedState.tag&1){if(r.flags|=2048,Fc(9,$2.bind(null,r,n,s,e),void 0,null),lr===null)throw Error(ce(349));Ca&30||z2(r,e,s)}return s}function z2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function $2(t,e,r,n){e.value=r,e.getSnapshot=n,W2(e)&&G2(t)}function H2(t,e,r){return r(function(){W2(e)&&G2(t)})}function W2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ts(t,r)}catch{return!0}}function G2(t){var e=Xs(t,1);e!==null&&Zn(e,t,1,-1)}function rv(t){var e=fs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pc,lastRenderedState:t},e.queue=t,t=t.dispatch=U4.bind(null,Nt,t),[e.memoizedState,t]}function Fc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function K2(){return Mn().memoizedState}function yf(t,e,r,n){var s=fs();Nt.flags|=t,s.memoizedState=Fc(1|e,r,void 0,n===void 0?null:n)}function Xh(t,e,r,n){var s=Mn();n=n===void 0?null:n;var i=void 0;if(er!==null){var a=er.memoizedState;if(i=a.destroy,n!==null&&Qm(n,a.deps)){s.memoizedState=Fc(e,r,i,n);return}}Nt.flags|=t,s.memoizedState=Fc(1|e,r,i,n)}function nv(t,e){return yf(8390656,8,t,e)}function eg(t,e){return Xh(2048,8,t,e)}function q2(t,e){return Xh(4,2,t,e)}function X2(t,e){return Xh(4,4,t,e)}function Y2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q2(t,e,r){return r=r!=null?r.concat([t]):null,Xh(4,4,Y2.bind(null,e,t),r)}function tg(){}function J2(t,e){var r=Mn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Qm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Z2(t,e){var r=Mn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Qm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function ew(t,e,r){return Ca&21?(ts(r,e)||(r=i2(),Nt.lanes|=r,Ra|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,sn=!0),t.memoizedState=r)}function M4(t,e){var r=ct;ct=r!==0&&4>r?r:4,t(!0);var n=od.transition;od.transition={};try{t(!1),e()}finally{ct=r,od.transition=n}}function tw(){return Mn().memoizedState}function V4(t,e,r){var n=Oi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},rw(t))nw(e,r);else if(r=M2(t,e,r,n),r!==null){var s=Gr();Zn(r,t,n,s),sw(r,e,n)}}function U4(t,e,r){var n=Oi(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(rw(t))nw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,ts(o,a)){var l=e.interleaved;l===null?(s.next=s,Gm(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=M2(t,e,s,n),r!==null&&(s=Gr(),Zn(r,t,n,s),sw(r,e,n))}}function rw(t){var e=t.alternate;return t===Nt||e!==null&&e===Nt}function nw(t,e){Ql=th=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function sw(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Fm(t,r)}}var rh={readContext:Ln,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useInsertionEffect:kr,useLayoutEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useMutableSource:kr,useSyncExternalStore:kr,useId:kr,unstable_isNewReconciler:!1},B4={readContext:Ln,useCallback:function(t,e){return fs().memoizedState=[t,e===void 0?null:e],t},useContext:Ln,useEffect:nv,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,yf(4194308,4,Y2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return yf(4194308,4,t,e)},useInsertionEffect:function(t,e){return yf(4,2,t,e)},useMemo:function(t,e){var r=fs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=fs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=V4.bind(null,Nt,t),[n.memoizedState,t]},useRef:function(t){var e=fs();return t={current:t},e.memoizedState=t},useState:rv,useDebugValue:tg,useDeferredValue:function(t){return fs().memoizedState=t},useTransition:function(){var t=rv(!1),e=t[0];return t=M4.bind(null,t[1]),fs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Nt,s=fs();if(Ct){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=e(),lr===null)throw Error(ce(349));Ca&30||z2(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,nv(H2.bind(null,n,i,t),[t]),n.flags|=2048,Fc(9,$2.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=fs(),e=lr.identifierPrefix;if(Ct){var r=Vs,n=Ms;r=(n&~(1<<32-Jn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Nc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=L4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},j4={readContext:Ln,useCallback:J2,useContext:Ln,useEffect:eg,useImperativeHandle:Q2,useInsertionEffect:q2,useLayoutEffect:X2,useMemo:Z2,useReducer:ld,useRef:K2,useState:function(){return ld(Pc)},useDebugValue:tg,useDeferredValue:function(t){var e=Mn();return ew(e,er.memoizedState,t)},useTransition:function(){var t=ld(Pc)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:B2,useSyncExternalStore:j2,useId:tw,unstable_isNewReconciler:!1},z4={readContext:Ln,useCallback:J2,useContext:Ln,useEffect:eg,useImperativeHandle:Q2,useInsertionEffect:q2,useLayoutEffect:X2,useMemo:Z2,useReducer:cd,useRef:K2,useState:function(){return cd(Pc)},useDebugValue:tg,useDeferredValue:function(t){var e=Mn();return er===null?e.memoizedState=t:ew(e,er.memoizedState,t)},useTransition:function(){var t=cd(Pc)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:B2,useSyncExternalStore:j2,useId:tw,unstable_isNewReconciler:!1};function Wn(t,e){if(t&&t.defaultProps){e=Pt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function xp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Pt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Yh={isMounted:function(t){return(t=t._reactInternals)?ja(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Gr(),s=Oi(t),i=zs(n,s);i.payload=e,r!=null&&(i.callback=r),e=Fi(t,i,s),e!==null&&(Zn(e,t,s,n),vf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Gr(),s=Oi(t),i=zs(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Fi(t,i,s),e!==null&&(Zn(e,t,s,n),vf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Gr(),n=Oi(t),s=zs(r,n);s.tag=2,e!=null&&(s.callback=e),e=Fi(t,s,n),e!==null&&(Zn(e,t,n,r),vf(e,t,n))}};function sv(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!Ac(r,n)||!Ac(s,i):!0}function iw(t,e,r){var n=!1,s=$i,i=e.contextType;return typeof i=="object"&&i!==null?i=Ln(i):(s=on(e)?Sa:Lr.current,n=e.contextTypes,i=(n=n!=null)?jo(t,s):$i),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function iv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Yh.enqueueReplaceState(e,e.state,null)}function vp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Km(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Ln(i):(i=on(e)?Sa:Lr.current,s.context=jo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(xp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Yh.enqueueReplaceState(s,s.state,null),Zf(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Wo(t,e){try{var r="",n=e;do r+=gC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ud(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function _p(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var $4=typeof WeakMap=="function"?WeakMap:Map;function aw(t,e,r){r=zs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){sh||(sh=!0,Rp=n),_p(t,e)},r}function ow(t,e,r){r=zs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){_p(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){_p(t,e),typeof n!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function av(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new $4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=nR.bind(null,t,e,r),e.then(t,t))}function ov(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function lv(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=zs(-1,1),e.tag=2,Fi(r,e,1))),r.lanes|=1),t)}var H4=ri.ReactCurrentOwner,sn=!1;function zr(t,e,r,n){e.child=t===null?L2(e,null,r,n):$o(e,t.child,r,n)}function cv(t,e,r,n,s){r=r.render;var i=e.ref;return No(e,s),n=Jm(t,e,r,n,i,s),r=Zm(),t!==null&&!sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ys(t,e,s)):(Ct&&r&&Bm(e),e.flags|=1,zr(t,e,n,s),e.child)}function uv(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!cg(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,lw(t,e,i,n,s)):(t=Af(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ac,r(a,n)&&t.ref===e.ref)return Ys(t,e,s)}return e.flags|=1,t=bi(i,n),t.ref=e.ref,t.return=e,e.child=t}function lw(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Ac(i,n)&&t.ref===e.ref)if(sn=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(sn=!0);else return e.lanes=t.lanes,Ys(t,e,s)}return yp(t,e,r,n,s)}function cw(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(To,dn),dn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vt(To,dn),dn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,vt(To,dn),dn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,vt(To,dn),dn|=n;return zr(t,e,s,r),e.child}function uw(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function yp(t,e,r,n,s){var i=on(r)?Sa:Lr.current;return i=jo(e,i),No(e,s),r=Jm(t,e,r,n,i,s),n=Zm(),t!==null&&!sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ys(t,e,s)):(Ct&&n&&Bm(e),e.flags|=1,zr(t,e,r,s),e.child)}function fv(t,e,r,n,s){if(on(r)){var i=!0;qf(e)}else i=!1;if(No(e,s),e.stateNode===null)Ef(t,e),iw(e,r,n),vp(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ln(c):(c=on(r)?Sa:Lr.current,c=jo(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&iv(e,a,n,c),mi=!1;var d=e.memoizedState;a.state=d,Zf(e,n,a,s),l=e.memoizedState,o!==n||d!==l||an.current||mi?(typeof f=="function"&&(xp(e,r,f,n),l=e.memoizedState),(o=mi||sv(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,V2(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Wn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ln(l):(l=on(r)?Sa:Lr.current,l=jo(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&iv(e,a,n,l),mi=!1,d=e.memoizedState,a.state=d,Zf(e,n,a,s);var x=e.memoizedState;o!==h||d!==x||an.current||mi?(typeof m=="function"&&(xp(e,r,m,n),x=e.memoizedState),(c=mi||sv(e,r,c,n,d,x,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Ep(t,e,r,n,i,s)}function Ep(t,e,r,n,s,i){uw(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&Yx(e,r,!1),Ys(t,e,i);n=e.stateNode,H4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=$o(e,t.child,null,i),e.child=$o(e,null,o,i)):zr(t,e,o,i),e.memoizedState=n.state,s&&Yx(e,r,!0),e.child}function fw(t){var e=t.stateNode;e.pendingContext?Xx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xx(t,e.context,!1),qm(t,e.containerInfo)}function hv(t,e,r,n,s){return zo(),zm(s),e.flags|=256,zr(t,e,r,n),e.child}var wp={dehydrated:null,treeContext:null,retryLane:0};function Tp(t){return{baseLanes:t,cachePool:null,transitions:null}}function hw(t,e,r){var n=e.pendingProps,s=Rt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),vt(Rt,s&1),t===null)return mp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Zh(a,n,0,null),t=wa(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Tp(r),e.memoizedState=wp,t):rg(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return W4(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=bi(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=bi(o,i):(i=wa(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Tp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=wp,n}return i=t.child,t=i.sibling,n=bi(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function rg(t,e){return e=Zh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wu(t,e,r,n){return n!==null&&zm(n),$o(e,t.child,null,r),t=rg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function W4(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=ud(Error(ce(422))),Wu(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Zh({mode:"visible",children:n.children},s,0,null),i=wa(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&$o(e,t.child,null,a),e.child.memoizedState=Tp(a),e.memoizedState=wp,i);if(!(e.mode&1))return Wu(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ce(419)),n=ud(i,n,void 0),Wu(t,e,a,n)}if(o=(a&t.childLanes)!==0,sn||o){if(n=lr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xs(t,s),Zn(n,t,s,-1))}return lg(),n=ud(Error(ce(421))),Wu(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=sR.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,gn=Pi(s.nextSibling),vn=e,Ct=!0,Kn=null,t!==null&&(Cn[Rn++]=Ms,Cn[Rn++]=Vs,Cn[Rn++]=Ia,Ms=t.id,Vs=t.overflow,Ia=e),e=rg(e,n.children),e.flags|=4096,e)}function dv(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),gp(t.return,e,r)}function fd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function dw(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(zr(t,e,n.children,r),n=Rt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dv(t,r,e);else if(t.tag===19)dv(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(vt(Rt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&eh(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),fd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&eh(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}fd(e,!0,r,null,i);break;case"together":fd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ef(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ys(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ra|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ce(153));if(e.child!==null){for(t=e.child,r=bi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=bi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function G4(t,e,r){switch(e.tag){case 3:fw(e),zo();break;case 5:U2(e);break;case 1:on(e.type)&&qf(e);break;case 4:qm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;vt(Qf,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(vt(Rt,Rt.current&1),e.flags|=128,null):r&e.child.childLanes?hw(t,e,r):(vt(Rt,Rt.current&1),t=Ys(t,e,r),t!==null?t.sibling:null);vt(Rt,Rt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return dw(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),vt(Rt,Rt.current),n)break;return null;case 22:case 23:return e.lanes=0,cw(t,e,r)}return Ys(t,e,r)}var pw,Ap,mw,gw;pw=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ap=function(){};mw=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,xa(vs.current);var i=null;switch(r){case"input":s=Gd(t,s),n=Gd(t,n),i=[];break;case"select":s=Pt({},s,{value:void 0}),n=Pt({},n,{value:void 0}),i=[];break;case"textarea":s=Xd(t,s),n=Xd(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Gf)}Qd(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Et("scroll",t),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};gw=function(t,e,r,n){r!==n&&(e.flags|=4)};function Nl(t,e){if(!Ct)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Sr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function K4(t,e,r){var n=e.pendingProps;switch(jm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(e),null;case 1:return on(e.type)&&Kf(),Sr(e),null;case 3:return n=e.stateNode,Ho(),Tt(an),Tt(Lr),Ym(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&($u(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kn!==null&&(Fp(Kn),Kn=null))),Ap(t,e),Sr(e),null;case 5:Xm(e);var s=xa(Rc.current);if(r=e.type,t!==null&&e.stateNode!=null)mw(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ce(166));return Sr(e),null}if(t=xa(vs.current),$u(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[ds]=e,n[Ic]=i,t=(e.mode&1)!==0,r){case"dialog":Et("cancel",n),Et("close",n);break;case"iframe":case"object":case"embed":Et("load",n);break;case"video":case"audio":for(s=0;s<bl.length;s++)Et(bl[s],n);break;case"source":Et("error",n);break;case"img":case"image":case"link":Et("error",n),Et("load",n);break;case"details":Et("toggle",n);break;case"input":wx(n,i),Et("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Et("invalid",n);break;case"textarea":Ax(n,i),Et("invalid",n)}Qd(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&zu(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&zu(n.textContent,o,t),s=["children",""+o]):xc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Et("scroll",n)}switch(r){case"input":Ou(n),Tx(n,i,!0);break;case"textarea":Ou(n),kx(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Gf)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=HE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ds]=e,t[Ic]=n,pw(t,e,!1,!1),e.stateNode=t;e:{switch(a=Jd(r,n),r){case"dialog":Et("cancel",t),Et("close",t),s=n;break;case"iframe":case"object":case"embed":Et("load",t),s=n;break;case"video":case"audio":for(s=0;s<bl.length;s++)Et(bl[s],t);s=n;break;case"source":Et("error",t),s=n;break;case"img":case"image":case"link":Et("error",t),Et("load",t),s=n;break;case"details":Et("toggle",t),s=n;break;case"input":wx(t,n),s=Gd(t,n),Et("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Pt({},n,{value:void 0}),Et("invalid",t);break;case"textarea":Ax(t,n),s=Xd(t,n),Et("invalid",t);break;default:s=n}Qd(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?KE(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&WE(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&vc(t,l):typeof l=="number"&&vc(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Et("scroll",t):l!=null&&Sm(t,i,l,a))}switch(r){case"input":Ou(t),Tx(t,n,!1);break;case"textarea":Ou(t),kx(t);break;case"option":n.value!=null&&t.setAttribute("value",""+zi(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?So(t,!!n.multiple,i,!1):n.defaultValue!=null&&So(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Gf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Sr(e),null;case 6:if(t&&e.stateNode!=null)gw(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ce(166));if(r=xa(Rc.current),xa(vs.current),$u(e)){if(n=e.stateNode,r=e.memoizedProps,n[ds]=e,(i=n.nodeValue!==r)&&(t=vn,t!==null))switch(t.tag){case 3:zu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zu(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ds]=e,e.stateNode=n}return Sr(e),null;case 13:if(Tt(Rt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ct&&gn!==null&&e.mode&1&&!(e.flags&128))O2(),zo(),e.flags|=98560,i=!1;else if(i=$u(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(ce(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[ds]=e}else zo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Sr(e),i=!1}else Kn!==null&&(Fp(Kn),Kn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Rt.current&1?tr===0&&(tr=3):lg())),e.updateQueue!==null&&(e.flags|=4),Sr(e),null);case 4:return Ho(),Ap(t,e),t===null&&kc(e.stateNode.containerInfo),Sr(e),null;case 10:return Wm(e.type._context),Sr(e),null;case 17:return on(e.type)&&Kf(),Sr(e),null;case 19:if(Tt(Rt),i=e.memoizedState,i===null)return Sr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Nl(i,!1);else{if(tr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=eh(t),a!==null){for(e.flags|=128,Nl(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return vt(Rt,Rt.current&1|2),e.child}t=t.sibling}i.tail!==null&&jt()>Go&&(e.flags|=128,n=!0,Nl(i,!1),e.lanes=4194304)}else{if(!n)if(t=eh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Nl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ct)return Sr(e),null}else 2*jt()-i.renderingStartTime>Go&&r!==1073741824&&(e.flags|=128,n=!0,Nl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=jt(),e.sibling=null,r=Rt.current,vt(Rt,n?r&1|2:r&1),e):(Sr(e),null);case 22:case 23:return og(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?dn&1073741824&&(Sr(e),e.subtreeFlags&6&&(e.flags|=8192)):Sr(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function q4(t,e){switch(jm(e),e.tag){case 1:return on(e.type)&&Kf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ho(),Tt(an),Tt(Lr),Ym(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xm(e),null;case 13:if(Tt(Rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));zo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tt(Rt),null;case 4:return Ho(),null;case 10:return Wm(e.type._context),null;case 22:case 23:return og(),null;case 24:return null;default:return null}}var Gu=!1,Pr=!1,X4=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function wo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){bt(t,e,n)}else r.current=null}function kp(t,e,r){try{r()}catch(n){bt(t,e,n)}}var pv=!1;function Y4(t,e){if(lp=$f,t=E2(),Um(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++c===s&&(o=a),d===i&&++f===n&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(cp={focusedElem:t,selectionRange:r},$f=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,w=x.memoizedState,T=e.stateNode,_=T.getSnapshotBeforeUpdate(e.elementType===e.type?g:Wn(e.type,g),w);T.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(D){bt(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return x=pv,pv=!1,x}function Jl(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&kp(e,r,i)}s=s.next}while(s!==n)}}function Qh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Sp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function xw(t){var e=t.alternate;e!==null&&(t.alternate=null,xw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ds],delete e[Ic],delete e[hp],delete e[F4],delete e[D4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vw(t){return t.tag===5||t.tag===3||t.tag===4}function mv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ip(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Gf));else if(n!==4&&(t=t.child,t!==null))for(Ip(t,e,r),t=t.sibling;t!==null;)Ip(t,e,r),t=t.sibling}function Cp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Cp(t,e,r),t=t.sibling;t!==null;)Cp(t,e,r),t=t.sibling}var hr=null,Gn=!1;function ui(t,e,r){for(r=r.child;r!==null;)_w(t,e,r),r=r.sibling}function _w(t,e,r){if(xs&&typeof xs.onCommitFiberUnmount=="function")try{xs.onCommitFiberUnmount($h,r)}catch{}switch(r.tag){case 5:Pr||wo(r,e);case 6:var n=hr,s=Gn;hr=null,ui(t,e,r),hr=n,Gn=s,hr!==null&&(Gn?(t=hr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):hr.removeChild(r.stateNode));break;case 18:hr!==null&&(Gn?(t=hr,r=r.stateNode,t.nodeType===8?sd(t.parentNode,r):t.nodeType===1&&sd(t,r),wc(t)):sd(hr,r.stateNode));break;case 4:n=hr,s=Gn,hr=r.stateNode.containerInfo,Gn=!0,ui(t,e,r),hr=n,Gn=s;break;case 0:case 11:case 14:case 15:if(!Pr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&kp(r,e,a),s=s.next}while(s!==n)}ui(t,e,r);break;case 1:if(!Pr&&(wo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){bt(r,e,o)}ui(t,e,r);break;case 21:ui(t,e,r);break;case 22:r.mode&1?(Pr=(n=Pr)||r.memoizedState!==null,ui(t,e,r),Pr=n):ui(t,e,r);break;default:ui(t,e,r)}}function gv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new X4),e.forEach(function(n){var s=iR.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function zn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:hr=o.stateNode,Gn=!1;break e;case 3:hr=o.stateNode.containerInfo,Gn=!0;break e;case 4:hr=o.stateNode.containerInfo,Gn=!0;break e}o=o.return}if(hr===null)throw Error(ce(160));_w(i,a,s),hr=null,Gn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){bt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)yw(e,t),e=e.sibling}function yw(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zn(e,t),ls(t),n&4){try{Jl(3,t,t.return),Qh(3,t)}catch(g){bt(t,t.return,g)}try{Jl(5,t,t.return)}catch(g){bt(t,t.return,g)}}break;case 1:zn(e,t),ls(t),n&512&&r!==null&&wo(r,r.return);break;case 5:if(zn(e,t),ls(t),n&512&&r!==null&&wo(r,r.return),t.flags&32){var s=t.stateNode;try{vc(s,"")}catch(g){bt(t,t.return,g)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&zE(s,i),Jd(o,a);var c=Jd(o,i);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?KE(s,h):f==="dangerouslySetInnerHTML"?WE(s,h):f==="children"?vc(s,h):Sm(s,f,h,c)}switch(o){case"input":Kd(s,i);break;case"textarea":$E(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?So(s,!!i.multiple,m,!1):d!==!!i.multiple&&(i.defaultValue!=null?So(s,!!i.multiple,i.defaultValue,!0):So(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ic]=i}catch(g){bt(t,t.return,g)}}break;case 6:if(zn(e,t),ls(t),n&4){if(t.stateNode===null)throw Error(ce(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){bt(t,t.return,g)}}break;case 3:if(zn(e,t),ls(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{wc(e.containerInfo)}catch(g){bt(t,t.return,g)}break;case 4:zn(e,t),ls(t);break;case 13:zn(e,t),ls(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ig=jt())),n&4&&gv(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(Pr=(c=Pr)||f,zn(e,t),Pr=c):zn(e,t),ls(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Ce=t,f=t.child;f!==null;){for(h=Ce=f;Ce!==null;){switch(d=Ce,m=d.child,d.tag){case 0:case 11:case 14:case 15:Jl(4,d,d.return);break;case 1:wo(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(g){bt(n,r,g)}}break;case 5:wo(d,d.return);break;case 22:if(d.memoizedState!==null){vv(h);continue}}m!==null?(m.return=d,Ce=m):vv(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=GE("display",a))}catch(g){bt(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){bt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:zn(e,t),ls(t),n&4&&gv(t);break;case 21:break;default:zn(e,t),ls(t)}}function ls(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(vw(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(vc(s,""),n.flags&=-33);var i=mv(t);Cp(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=mv(t);Ip(t,o,a);break;default:throw Error(ce(161))}}catch(l){bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Q4(t,e,r){Ce=t,Ew(t)}function Ew(t,e,r){for(var n=(t.mode&1)!==0;Ce!==null;){var s=Ce,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Gu;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Pr;o=Gu;var c=Pr;if(Gu=a,(Pr=l)&&!c)for(Ce=s;Ce!==null;)a=Ce,l=a.child,a.tag===22&&a.memoizedState!==null?_v(s):l!==null?(l.return=a,Ce=l):_v(s);for(;i!==null;)Ce=i,Ew(i),i=i.sibling;Ce=s,Gu=o,Pr=c}xv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ce=i):xv(t)}}function xv(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pr||Qh(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Pr)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Wn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&tv(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}tv(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&wc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Pr||e.flags&512&&Sp(e)}catch(d){bt(e,e.return,d)}}if(e===t){Ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function vv(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ce=r;break}Ce=e.return}}function _v(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Qh(4,e)}catch(l){bt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){bt(e,s,l)}}var i=e.return;try{Sp(e)}catch(l){bt(e,i,l)}break;case 5:var a=e.return;try{Sp(e)}catch(l){bt(e,a,l)}}}catch(l){bt(e,e.return,l)}if(e===t){Ce=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ce=o;break}Ce=e.return}}var J4=Math.ceil,nh=ri.ReactCurrentDispatcher,ng=ri.ReactCurrentOwner,Dn=ri.ReactCurrentBatchConfig,nt=0,lr=null,Xt=null,gr=0,dn=0,To=ea(0),tr=0,Dc=null,Ra=0,Jh=0,sg=0,Zl=null,rn=null,ig=0,Go=1/0,Os=null,sh=!1,Rp=null,Di=null,Ku=!1,Ai=null,ih=0,ec=0,Np=null,wf=-1,Tf=0;function Gr(){return nt&6?jt():wf!==-1?wf:wf=jt()}function Oi(t){return t.mode&1?nt&2&&gr!==0?gr&-gr:b4.transition!==null?(Tf===0&&(Tf=i2()),Tf):(t=ct,t!==0||(t=window.event,t=t===void 0?16:h2(t.type)),t):1}function Zn(t,e,r,n){if(50<ec)throw ec=0,Np=null,Error(ce(185));Zc(t,r,n),(!(nt&2)||t!==lr)&&(t===lr&&(!(nt&2)&&(Jh|=r),tr===4&&xi(t,gr)),ln(t,n),r===1&&nt===0&&!(e.mode&1)&&(Go=jt()+500,qh&&ta()))}function ln(t,e){var r=t.callbackNode;bC(t,e);var n=zf(t,t===lr?gr:0);if(n===0)r!==null&&Cx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Cx(r),e===1)t.tag===0?O4(yv.bind(null,t)):P2(yv.bind(null,t)),N4(function(){!(nt&6)&&ta()}),r=null;else{switch(a2(n)){case 1:r=Pm;break;case 4:r=n2;break;case 16:r=jf;break;case 536870912:r=s2;break;default:r=jf}r=Rw(r,ww.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function ww(t,e){if(wf=-1,Tf=0,nt&6)throw Error(ce(327));var r=t.callbackNode;if(Po()&&t.callbackNode!==r)return null;var n=zf(t,t===lr?gr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=ah(t,n);else{e=n;var s=nt;nt|=2;var i=Aw();(lr!==t||gr!==e)&&(Os=null,Go=jt()+500,Ea(t,e));do try{tR();break}catch(o){Tw(t,o)}while(!0);Hm(),nh.current=i,nt=s,Xt!==null?e=0:(lr=null,gr=0,e=tr)}if(e!==0){if(e===2&&(s=np(t),s!==0&&(n=s,e=Pp(t,s))),e===1)throw r=Dc,Ea(t,0),xi(t,n),ln(t,jt()),r;if(e===6)xi(t,n);else{if(s=t.current.alternate,!(n&30)&&!Z4(s)&&(e=ah(t,n),e===2&&(i=np(t),i!==0&&(n=i,e=Pp(t,i))),e===1))throw r=Dc,Ea(t,0),xi(t,n),ln(t,jt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(ce(345));case 2:ha(t,rn,Os);break;case 3:if(xi(t,n),(n&130023424)===n&&(e=ig+500-jt(),10<e)){if(zf(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Gr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=fp(ha.bind(null,t,rn,Os),e);break}ha(t,rn,Os);break;case 4:if(xi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-Jn(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*J4(n/1960))-n,10<n){t.timeoutHandle=fp(ha.bind(null,t,rn,Os),n);break}ha(t,rn,Os);break;case 5:ha(t,rn,Os);break;default:throw Error(ce(329))}}}return ln(t,jt()),t.callbackNode===r?ww.bind(null,t):null}function Pp(t,e){var r=Zl;return t.current.memoizedState.isDehydrated&&(Ea(t,e).flags|=256),t=ah(t,e),t!==2&&(e=rn,rn=r,e!==null&&Fp(e)),t}function Fp(t){rn===null?rn=t:rn.push.apply(rn,t)}function Z4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!ts(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xi(t,e){for(e&=~sg,e&=~Jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Jn(e),n=1<<r;t[r]=-1,e&=~n}}function yv(t){if(nt&6)throw Error(ce(327));Po();var e=zf(t,0);if(!(e&1))return ln(t,jt()),null;var r=ah(t,e);if(t.tag!==0&&r===2){var n=np(t);n!==0&&(e=n,r=Pp(t,n))}if(r===1)throw r=Dc,Ea(t,0),xi(t,e),ln(t,jt()),r;if(r===6)throw Error(ce(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ha(t,rn,Os),ln(t,jt()),null}function ag(t,e){var r=nt;nt|=1;try{return t(e)}finally{nt=r,nt===0&&(Go=jt()+500,qh&&ta())}}function Na(t){Ai!==null&&Ai.tag===0&&!(nt&6)&&Po();var e=nt;nt|=1;var r=Dn.transition,n=ct;try{if(Dn.transition=null,ct=1,t)return t()}finally{ct=n,Dn.transition=r,nt=e,!(nt&6)&&ta()}}function og(){dn=To.current,Tt(To)}function Ea(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,R4(r)),Xt!==null)for(r=Xt.return;r!==null;){var n=r;switch(jm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Kf();break;case 3:Ho(),Tt(an),Tt(Lr),Ym();break;case 5:Xm(n);break;case 4:Ho();break;case 13:Tt(Rt);break;case 19:Tt(Rt);break;case 10:Wm(n.type._context);break;case 22:case 23:og()}r=r.return}if(lr=t,Xt=t=bi(t.current,null),gr=dn=e,tr=0,Dc=null,sg=Jh=Ra=0,rn=Zl=null,ga!==null){for(e=0;e<ga.length;e++)if(r=ga[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}ga=null}return t}function Tw(t,e){do{var r=Xt;try{if(Hm(),_f.current=rh,th){for(var n=Nt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}th=!1}if(Ca=0,or=er=Nt=null,Ql=!1,Nc=0,ng.current=null,r===null||r.return===null){tr=1,Dc=e,Xt=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=gr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=ov(a);if(m!==null){m.flags&=-257,lv(m,a,o,i,e),m.mode&1&&av(i,c,e),e=m,l=c;var x=e.updateQueue;if(x===null){var g=new Set;g.add(l),e.updateQueue=g}else x.add(l);break e}else{if(!(e&1)){av(i,c,e),lg();break e}l=Error(ce(426))}}else if(Ct&&o.mode&1){var w=ov(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),lv(w,a,o,i,e),zm(Wo(l,o));break e}}i=l=Wo(l,o),tr!==4&&(tr=2),Zl===null?Zl=[i]:Zl.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=aw(i,l,e);ev(i,T);break e;case 1:o=l;var _=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Di===null||!Di.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=ow(i,o,e);ev(i,D);break e}}i=i.return}while(i!==null)}Sw(r)}catch(z){e=z,Xt===r&&r!==null&&(Xt=r=r.return);continue}break}while(!0)}function Aw(){var t=nh.current;return nh.current=rh,t===null?rh:t}function lg(){(tr===0||tr===3||tr===2)&&(tr=4),lr===null||!(Ra&268435455)&&!(Jh&268435455)||xi(lr,gr)}function ah(t,e){var r=nt;nt|=2;var n=Aw();(lr!==t||gr!==e)&&(Os=null,Ea(t,e));do try{eR();break}catch(s){Tw(t,s)}while(!0);if(Hm(),nt=r,nh.current=n,Xt!==null)throw Error(ce(261));return lr=null,gr=0,tr}function eR(){for(;Xt!==null;)kw(Xt)}function tR(){for(;Xt!==null&&!SC();)kw(Xt)}function kw(t){var e=Cw(t.alternate,t,dn);t.memoizedProps=t.pendingProps,e===null?Sw(t):Xt=e,ng.current=null}function Sw(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=q4(r,e),r!==null){r.flags&=32767,Xt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tr=6,Xt=null;return}}else if(r=K4(r,e,dn),r!==null){Xt=r;return}if(e=e.sibling,e!==null){Xt=e;return}Xt=e=t}while(e!==null);tr===0&&(tr=5)}function ha(t,e,r){var n=ct,s=Dn.transition;try{Dn.transition=null,ct=1,rR(t,e,r,n)}finally{Dn.transition=s,ct=n}return null}function rR(t,e,r,n){do Po();while(Ai!==null);if(nt&6)throw Error(ce(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ce(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(LC(t,i),t===lr&&(Xt=lr=null,gr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ku||(Ku=!0,Rw(jf,function(){return Po(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Dn.transition,Dn.transition=null;var a=ct;ct=1;var o=nt;nt|=4,ng.current=null,Y4(t,r),yw(r,t),w4(cp),$f=!!lp,cp=lp=null,t.current=r,Q4(r),IC(),nt=o,ct=a,Dn.transition=i}else t.current=r;if(Ku&&(Ku=!1,Ai=t,ih=s),i=t.pendingLanes,i===0&&(Di=null),NC(r.stateNode),ln(t,jt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(sh)throw sh=!1,t=Rp,Rp=null,t;return ih&1&&t.tag!==0&&Po(),i=t.pendingLanes,i&1?t===Np?ec++:(ec=0,Np=t):ec=0,ta(),null}function Po(){if(Ai!==null){var t=a2(ih),e=Dn.transition,r=ct;try{if(Dn.transition=null,ct=16>t?16:t,Ai===null)var n=!1;else{if(t=Ai,Ai=null,ih=0,nt&6)throw Error(ce(331));var s=nt;for(nt|=4,Ce=t.current;Ce!==null;){var i=Ce,a=i.child;if(Ce.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:Jl(8,f,i)}var h=f.child;if(h!==null)h.return=f,Ce=h;else for(;Ce!==null;){f=Ce;var d=f.sibling,m=f.return;if(xw(f),f===c){Ce=null;break}if(d!==null){d.return=m,Ce=d;break}Ce=m}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}Ce=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ce=a;else e:for(;Ce!==null;){if(i=Ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Jl(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Ce=T;break e}Ce=i.return}}var _=t.current;for(Ce=_;Ce!==null;){a=Ce;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Ce=v;else e:for(a=_;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Qh(9,o)}}catch(z){bt(o,o.return,z)}if(o===a){Ce=null;break e}var D=o.sibling;if(D!==null){D.return=o.return,Ce=D;break e}Ce=o.return}}if(nt=s,ta(),xs&&typeof xs.onPostCommitFiberRoot=="function")try{xs.onPostCommitFiberRoot($h,t)}catch{}n=!0}return n}finally{ct=r,Dn.transition=e}}return!1}function Ev(t,e,r){e=Wo(r,e),e=aw(t,e,1),t=Fi(t,e,1),e=Gr(),t!==null&&(Zc(t,1,e),ln(t,e))}function bt(t,e,r){if(t.tag===3)Ev(t,t,r);else for(;e!==null;){if(e.tag===3){Ev(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Di===null||!Di.has(n))){t=Wo(r,t),t=ow(e,t,1),e=Fi(e,t,1),t=Gr(),e!==null&&(Zc(e,1,t),ln(e,t));break}}e=e.return}}function nR(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Gr(),t.pingedLanes|=t.suspendedLanes&r,lr===t&&(gr&r)===r&&(tr===4||tr===3&&(gr&130023424)===gr&&500>jt()-ig?Ea(t,0):sg|=r),ln(t,e)}function Iw(t,e){e===0&&(t.mode&1?(e=Mu,Mu<<=1,!(Mu&130023424)&&(Mu=4194304)):e=1);var r=Gr();t=Xs(t,e),t!==null&&(Zc(t,e,r),ln(t,r))}function sR(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Iw(t,r)}function iR(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(e),Iw(t,r)}var Cw;Cw=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||an.current)sn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return sn=!1,G4(t,e,r);sn=!!(t.flags&131072)}else sn=!1,Ct&&e.flags&1048576&&F2(e,Yf,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ef(t,e),t=e.pendingProps;var s=jo(e,Lr.current);No(e,r),s=Jm(null,e,n,t,s,r);var i=Zm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(n)?(i=!0,qf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Km(e),s.updater=Yh,e.stateNode=s,s._reactInternals=e,vp(e,n,t,r),e=Ep(null,e,n,!0,i,r)):(e.tag=0,Ct&&i&&Bm(e),zr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Ef(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=oR(n),t=Wn(n,t),s){case 0:e=yp(null,e,n,t,r);break e;case 1:e=fv(null,e,n,t,r);break e;case 11:e=cv(null,e,n,t,r);break e;case 14:e=uv(null,e,n,Wn(n.type,t),r);break e}throw Error(ce(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wn(n,s),yp(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wn(n,s),fv(t,e,n,s,r);case 3:e:{if(fw(e),t===null)throw Error(ce(387));n=e.pendingProps,i=e.memoizedState,s=i.element,V2(t,e),Zf(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Wo(Error(ce(423)),e),e=hv(t,e,n,r,s);break e}else if(n!==s){s=Wo(Error(ce(424)),e),e=hv(t,e,n,r,s);break e}else for(gn=Pi(e.stateNode.containerInfo.firstChild),vn=e,Ct=!0,Kn=null,r=L2(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zo(),n===s){e=Ys(t,e,r);break e}zr(t,e,n,r)}e=e.child}return e;case 5:return U2(e),t===null&&mp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,up(n,s)?a=null:i!==null&&up(n,i)&&(e.flags|=32),uw(t,e),zr(t,e,a,r),e.child;case 6:return t===null&&mp(e),null;case 13:return hw(t,e,r);case 4:return qm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=$o(e,null,n,r):zr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wn(n,s),cv(t,e,n,s,r);case 7:return zr(t,e,e.pendingProps,r),e.child;case 8:return zr(t,e,e.pendingProps.children,r),e.child;case 12:return zr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,vt(Qf,n._currentValue),n._currentValue=a,i!==null)if(ts(i.value,a)){if(i.children===s.children&&!an.current){e=Ys(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=zs(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),gp(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ce(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),gp(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,No(e,r),s=Ln(s),n=n(s),e.flags|=1,zr(t,e,n,r),e.child;case 14:return n=e.type,s=Wn(n,e.pendingProps),s=Wn(n.type,s),uv(t,e,n,s,r);case 15:return lw(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wn(n,s),Ef(t,e),e.tag=1,on(n)?(t=!0,qf(e)):t=!1,No(e,r),iw(e,n,s),vp(e,n,s,r),Ep(null,e,n,!0,t,r);case 19:return dw(t,e,r);case 22:return cw(t,e,r)}throw Error(ce(156,e.tag))};function Rw(t,e){return r2(t,e)}function aR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(t,e,r,n){return new aR(t,e,r,n)}function cg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oR(t){if(typeof t=="function")return cg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cm)return 11;if(t===Rm)return 14}return 2}function bi(t,e){var r=t.alternate;return r===null?(r=Fn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Af(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")cg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ho:return wa(r.children,s,i,e);case Im:a=8,s|=8;break;case zd:return t=Fn(12,r,e,s|2),t.elementType=zd,t.lanes=i,t;case $d:return t=Fn(13,r,e,s),t.elementType=$d,t.lanes=i,t;case Hd:return t=Fn(19,r,e,s),t.elementType=Hd,t.lanes=i,t;case UE:return Zh(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ME:a=10;break e;case VE:a=9;break e;case Cm:a=11;break e;case Rm:a=14;break e;case pi:a=16,n=null;break e}throw Error(ce(130,t==null?t:typeof t,""))}return e=Fn(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function wa(t,e,r,n){return t=Fn(7,t,n,e),t.lanes=r,t}function Zh(t,e,r,n){return t=Fn(22,t,n,e),t.elementType=UE,t.lanes=r,t.stateNode={isHidden:!1},t}function hd(t,e,r){return t=Fn(6,t,null,e),t.lanes=r,t}function dd(t,e,r){return e=Fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lR(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=K0(0),this.expirationTimes=K0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=K0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ug(t,e,r,n,s,i,a,o,l){return t=new lR(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Fn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Km(i),t}function cR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Nw(t){if(!t)return $i;t=t._reactInternals;e:{if(ja(t)!==t||t.tag!==1)throw Error(ce(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(t.tag===1){var r=t.type;if(on(r))return N2(t,r,e)}return e}function Pw(t,e,r,n,s,i,a,o,l){return t=ug(r,n,!0,t,s,i,a,o,l),t.context=Nw(null),r=t.current,n=Gr(),s=Oi(r),i=zs(n,s),i.callback=e??null,Fi(r,i,s),t.current.lanes=s,Zc(t,s,n),ln(t,n),t}function e0(t,e,r,n){var s=e.current,i=Gr(),a=Oi(s);return r=Nw(r),e.context===null?e.context=r:e.pendingContext=r,e=zs(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Fi(s,e,a),t!==null&&(Zn(t,s,a,i),vf(t,s,a)),a}function oh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function fg(t,e){wv(t,e),(t=t.alternate)&&wv(t,e)}function uR(){return null}var Fw=typeof reportError=="function"?reportError:function(t){console.error(t)};function hg(t){this._internalRoot=t}t0.prototype.render=hg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ce(409));e0(t,e,null,null)};t0.prototype.unmount=hg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Na(function(){e0(null,t,null,null)}),e[qs]=null}};function t0(t){this._internalRoot=t}t0.prototype.unstable_scheduleHydration=function(t){if(t){var e=c2();t={blockedOn:null,target:t,priority:e};for(var r=0;r<gi.length&&e!==0&&e<gi[r].priority;r++);gi.splice(r,0,t),r===0&&f2(t)}};function dg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function r0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Tv(){}function fR(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=oh(a);i.call(c)}}var a=Pw(e,n,t,0,null,!1,!1,"",Tv);return t._reactRootContainer=a,t[qs]=a.current,kc(t.nodeType===8?t.parentNode:t),Na(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=oh(l);o.call(c)}}var l=ug(t,0,!1,null,null,!1,!1,"",Tv);return t._reactRootContainer=l,t[qs]=l.current,kc(t.nodeType===8?t.parentNode:t),Na(function(){e0(e,l,r,n)}),l}function n0(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=oh(a);o.call(l)}}e0(e,a,t,s)}else a=fR(r,e,t,s,n);return oh(a)}o2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ol(e.pendingLanes);r!==0&&(Fm(e,r|1),ln(e,jt()),!(nt&6)&&(Go=jt()+500,ta()))}break;case 13:Na(function(){var n=Xs(t,1);if(n!==null){var s=Gr();Zn(n,t,1,s)}}),fg(t,1)}};Dm=function(t){if(t.tag===13){var e=Xs(t,134217728);if(e!==null){var r=Gr();Zn(e,t,134217728,r)}fg(t,134217728)}};l2=function(t){if(t.tag===13){var e=Oi(t),r=Xs(t,e);if(r!==null){var n=Gr();Zn(r,t,e,n)}fg(t,e)}};c2=function(){return ct};u2=function(t,e){var r=ct;try{return ct=t,e()}finally{ct=r}};ep=function(t,e,r){switch(e){case"input":if(Kd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Kh(n);if(!s)throw Error(ce(90));jE(n),Kd(n,s)}}}break;case"textarea":$E(t,r);break;case"select":e=r.value,e!=null&&So(t,!!r.multiple,e,!1)}};YE=ag;QE=Na;var hR={usingClientEntryPoint:!1,Events:[tu,xo,Kh,qE,XE,ag]},Pl={findFiberByHostInstance:ma,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dR={bundleType:Pl.bundleType,version:Pl.version,rendererPackageName:Pl.rendererPackageName,rendererConfig:Pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=e2(t),t===null?null:t.stateNode},findFiberByHostInstance:Pl.findFiberByHostInstance||uR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qu.isDisabled&&qu.supportsFiber)try{$h=qu.inject(dR),xs=qu}catch{}}wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hR;wn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dg(e))throw Error(ce(200));return cR(t,e,null,r)};wn.createRoot=function(t,e){if(!dg(t))throw Error(ce(299));var r=!1,n="",s=Fw;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ug(t,1,!1,null,null,r,!1,n,s),t[qs]=e.current,kc(t.nodeType===8?t.parentNode:t),new hg(e)};wn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ce(188)):(t=Object.keys(t).join(","),Error(ce(268,t)));return t=e2(e),t=t===null?null:t.stateNode,t};wn.flushSync=function(t){return Na(t)};wn.hydrate=function(t,e,r){if(!r0(e))throw Error(ce(200));return n0(null,t,e,!0,r)};wn.hydrateRoot=function(t,e,r){if(!dg(t))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=Fw;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=Pw(e,null,t,1,r??null,s,!1,i,a),t[qs]=e.current,kc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new t0(e)};wn.render=function(t,e,r){if(!r0(e))throw Error(ce(200));return n0(null,t,e,!1,r)};wn.unmountComponentAtNode=function(t){if(!r0(t))throw Error(ce(40));return t._reactRootContainer?(Na(function(){n0(null,null,t,!1,function(){t._reactRootContainer=null,t[qs]=null})}),!0):!1};wn.unstable_batchedUpdates=ag;wn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!r0(r))throw Error(ce(200));if(t==null||t._reactInternals===void 0)throw Error(ce(38));return n0(t,e,r,!1,n)};wn.version="18.3.1-next-f1338f8080-20240426";function Dw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dw)}catch(t){console.error(t)}}Dw(),DE.exports=wn;var pR=DE.exports,Av=pR;Bd.createRoot=Av.createRoot,Bd.hydrateRoot=Av.hydrateRoot;/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gR=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),kv=t=>{const e=gR(t);return e.charAt(0).toUpperCase()+e.slice(1)},Ow=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),xR=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=He.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...o},l)=>He.createElement("svg",{ref:l,...vR,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Ow("lucide",s),...!i&&!xR(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,f])=>He.createElement(c,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=(t,e)=>{const r=He.forwardRef(({className:n,...s},i)=>He.createElement(_R,{ref:i,iconNode:e,className:Ow(`lucide-${mR(kv(t))}`,`lucide-${t}`,n),...s}));return r.displayName=kv(t),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],kf=Vt("chart-column",yR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Dp=Vt("circle-alert",ER);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],TR=Vt("circle-check-big",wR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Sf=Vt("clock",AR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],SR=Vt("eye-off",kR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],CR=Vt("eye",IR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],bw=Vt("file-spreadsheet",RR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],PR=Vt("funnel",NR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Sv=Vt("lock",FR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],OR=Vt("log-out",DR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],LR=Vt("mail",bR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ls=Vt("phone",MR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],UR=Vt("save",VR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],jR=Vt("search",BR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Iv=Vt("trash-2",zR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],HR=Vt("trending-down",$R);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Lw=Vt("trending-up",WR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Cv=Vt("upload",GR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Rv=Vt("user-plus",KR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Mw=Vt("user",qR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],di=Vt("users",XR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],QR=Vt("x",YR);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Vw=1252,JR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],pg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mg=function(t){JR.indexOf(t)!=-1&&(Vw=pg[0]=t)};function ZR(){mg(1252)}var Xn=function(t){mg(t)};function Uw(){Xn(1200),ZR()}function Nv(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function e3(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function Bw(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ll=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?e3(t.slice(2)):e==254&&r==255?Bw(t.slice(2)):e==65279?t.slice(1):t},Xu=function(e){return String.fromCharCode(e)},Pv=function(e){return String.fromCharCode(e)},Oc,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fv(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=ki.charAt(i)+ki.charAt(a)+ki.charAt(o)+ki.charAt(l);return e}function En(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=ki.indexOf(t.charAt(c++)),a=ki.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=ki.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=ki.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),za=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hi(t){return Ye?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Dv(t){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var qn=function(e){return Ye?za(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function $a(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function gg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return gg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var vi=Ye?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:za(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function t3(t){for(var e=[],r=0,n=t.length+250,s=Hi(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Hi(65535),n=65530)}return e.push(s.slice(0,r)),vi(e)}var Kr=/\u0000/g,Ml=/[\u0001-\u0006]/g;function Fo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Yn(t,e){var r=""+t;return r.length>=e?r:Lt("0",e-r.length)+r}function xg(t,e){var r=""+t;return r.length>=e?r:Lt(" ",e-r.length)+r}function lh(t,e){var r=""+t;return r.length>=e?r:r+Lt(" ",e-r.length)}function r3(t,e){var r=""+Math.round(t);return r.length>=e?r:Lt("0",e-r.length)+r}function n3(t,e){var r=""+t;return r.length>=e?r:Lt("0",e-r.length)+r}var Ov=Math.pow(2,32);function io(t,e){if(t>Ov||t<-Ov)return r3(t,e);var r=Math.round(t);return n3(r,e)}function ch(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var bv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],pd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s3(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Lv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function uh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*a+i,f=h*c+l,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=i):(f=c,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function va(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=f3(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var jw=new Date(1899,11,31,0,0,0),a3=jw.getTime(),o3=new Date(1900,2,1,0,0,0);function zw(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=o3&&(r+=24*60*60*1e3),(r-(a3+(t.getTimezoneOffset()-jw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function vg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function l3(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c3(t){var e=t<0?12:11,r=vg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function u3(t){var e=vg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function bc(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=c3(t):e===10?r=t.toFixed(10).substr(0,12):r=u3(t),vg(l3(r.toUpperCase()))}function Pa(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):bc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Vn(14,zw(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function f3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function h3(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return pd[r.m-1][1];case 5:return pd[r.m-1][0];default:return pd[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return bv[r.q][0];default:return bv[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Yn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Yn(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Yn(l,c):"";return f}function Si(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var $w=/%/g;function d3(t,e,r){var n=e.replace($w,""),s=e.length-n.length;return $s(t,n,r*Math.pow(10,2*s))+Lt("%",s)}function p3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return $s(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Hw(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Hw(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ww=/# (\?+)( ?)\/( ?)(\d+)/;function m3(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Lt(" ",t[1].length+1+t[4].length):xg(a,t[1].length)+t[2]+"/"+t[3]+Yn(o,t[4].length))}function g3(t,e,r){return r+(e===0?"":""+e)+Lt(" ",t[1].length+2+t[4].length)}var Gw=/^#*0*\.([0#]+)/,Kw=/\).*[0#]/,qw=/\(###\) ###\\?-####/;function $r(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Mv(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Vv(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function x3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function v3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Sn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Kw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sn("n",n,r):"("+Sn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return p3(t,e,r);if(e.indexOf("%")!==-1)return d3(t,e,r);if(e.indexOf("E")!==-1)return Hw(e,r);if(e.charCodeAt(0)===36)return"$"+Sn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+io(l,e.length);if(e.match(/^[#?]+$/))return s=io(r,0),s==="0"&&(s=""),s.length>e.length?s:$r(e.substr(0,e.length-s.length))+s;if(i=e.match(Ww))return m3(i,l,c);if(e.match(/^#+0+$/))return c+io(l,e.length-e.indexOf("0"));if(i=e.match(Gw))return s=Mv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$r(i[1])).replace(/\.$/,"."+$r(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Lt("0",$r(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+Mv(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Si(io(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sn(t,e,-r):Si(""+(Math.floor(r)+x3(r,i[1].length)))+"."+Yn(Vv(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Sn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Fo(Sn(t,e.replace(/[\\-]/g,""),r)),a=0,Fo(Fo(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(qw))return s=Sn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=uh(l,Math.pow(10,a)-1,!1),s=""+c,f=$s("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=lh(o[2],a),f.length<i[4].length&&(f=$r(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=uh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xg(o[1],a)+i[2]+"/"+i[3]+lh(o[2],a):Lt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=io(r,0),e.length<=s.length?s:$r(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return $r(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Vv(r,i[1].length),r<0?"-"+Sn(t,e,-r):Si(v3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Yn(0,3-x.length):"")+x})+"."+Yn(a,i[1].length);switch(e){case"###,##0.00":return Sn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Si(io(l,0));return m!=="0"?c+m:"";case"###,###.00":return Sn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Sn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function _3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return $s(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function y3(t,e,r){var n=e.replace($w,""),s=e.length-n.length;return $s(t,n,r*Math.pow(10,2*s))+Lt("%",s)}function Xw(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Xw(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function us(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Kw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?us("n",n,r):"("+us("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return _3(t,e,r);if(e.indexOf("%")!==-1)return y3(t,e,r);if(e.indexOf("E")!==-1)return Xw(e,r);if(e.charCodeAt(0)===36)return"$"+us(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Yn(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:$r(e.substr(0,e.length-s.length))+s;if(i=e.match(Ww))return g3(i,l,c);if(e.match(/^#+0+$/))return c+Yn(l,e.length-e.indexOf("0"));if(i=e.match(Gw))return s=(""+r).replace(/^([^\.]+)$/,"$1."+$r(i[1])).replace(/\.$/,"."+$r(i[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+Lt("0",$r(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Si(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+us(t,e,-r):Si(""+r)+"."+Lt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return us(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Fo(us(t,e.replace(/[\\-]/g,""),r)),a=0,Fo(Fo(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(qw))return s=us(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=uh(l,Math.pow(10,a)-1,!1),s=""+c,f=$s("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=lh(o[2],a),f.length<i[4].length&&(f=$r(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=uh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xg(o[1],a)+i[2]+"/"+i[3]+lh(o[2],a):Lt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:$r(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return $r(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+us(t,e,-r):Si(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Yn(0,3-x.length):"")+x})+"."+Yn(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Si(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return us(t,e.slice(0,e.lastIndexOf(".")),r)+$r(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function $s(t,e,r){return(r|0)===r?us(t,e,r):Sn(t,e,r)}function E3(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Yw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function il(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":ch(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Yw))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function w3(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!ch(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=t.charAt(++a),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=va(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=va(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=va(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",a+=5,d="h"):(g.t="t",++a),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Yw)){if(c==null&&(c=va(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",il(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var w=0,T=0,_;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=d,l="h",w<1&&(w=1);break;case"s":(_=s[a].v.match(/\.0+$/))&&(T=Math.max(T,_[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[a].v.match(/[Hh]/)&&(w=1),w<2&&s[a].v.match(/[Mm]/)&&(w=2),w<3&&s[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",D;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=h3(s[a].t.charCodeAt(0),s[a].v,c,T),s[a].t="t";break;case"n":case"?":for(D=a+1;s[D]!=null&&((o=s[D].t)==="?"||o==="D"||(o===" "||o==="t")&&s[D+1]!=null&&(s[D+1].t==="?"||s[D+1].t==="t"&&s[D+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[D].v==="/"||s[D].v===" "&&s[D+1]!=null&&s[D+1].t=="?"));)s[a].v+=s[D].v,s[D]={v:"",t:";"},++D;v+=s[a].v,a=D-1;break;case"G":s[a].t="t",s[a].v=Pa(e,r);break}var z="",B,y;if(v.length>0){v.charCodeAt(0)==40?(B=e<0&&v.charCodeAt(0)===45?-e:e,y=$s("n",v,B)):(B=e<0&&n>1?-e:e,y=$s("n",v,B),B<0&&s[0]&&s[0].t=="t"&&(y=y.substr(1),s[0].v="-"+s[0].v)),D=y.length-1;var A=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){A=a;break}var k=s.length;if(A===s.length&&y.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(D>=s[a].v.length-1?(D-=s[a].v.length,s[a].v=y.substr(D+1,s[a].v.length)):D<0?s[a].v="":(s[a].v=y.substr(0,D+1),D=-1),s[a].t="t",k=a);D>=0&&k<s.length&&(s[k].v=y.substr(0,D+1)+s[k].v)}else if(A!==s.length&&y.indexOf("E")===-1){for(D=y.indexOf(".")-1,a=A;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===A?s[a].v.indexOf(".")-1:s[a].v.length-1,z=s[a].v.substr(f+1);f>=0;--f)D>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(z=y.charAt(D--)+z);s[a].v=z,s[a].t="t",k=a}for(D>=0&&k<s.length&&(s[k].v=y.substr(0,D+1)+s[k].v),D=y.indexOf(".")+1,a=A;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==A)){for(f=s[a].v.indexOf(".")>-1&&a===A?s[a].v.indexOf(".")+1:0,z=s[a].v.substr(0,f);f<s[a].v.length;++f)D<y.length&&(z+=y.charAt(D++));s[a].v=z,s[a].t="t",k=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(B=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=$s(s[a].t,s[a].v,B),s[a].t="t");var C="";for(a=0;a!==s.length;++a)s[a]!=null&&(C+=s[a].v);return C}var Uv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bv(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function T3(t,e){var r=E3(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Uv),o=r[1].match(Uv);return Bv(e,a)?[n,r[0]]:Bv(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Vn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Lv[t]]||ze[Lv[t]]),n==null&&(n=i3[t]||"General");break}if(ch(n,0))return Pa(e,r);e instanceof Date&&(e=zw(e,r.date1904));var s=T3(n,e);if(ch(s[1]))return Pa(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return w3(s[1],e,r,s[0])}function Ta(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function Qw(){ze=s3()}var A3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Jw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k3(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(Jw,"(\\d+)"),new RegExp("^"+e+"$")}function S3(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(Jw)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?f:c+"T"+f}var I3=function(){var t={};t.version="1.2.0";function e(){for(var y=0,A=new Array(256),k=0;k!=256;++k)y=k,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,A[k]=y;return typeof Int32Array<"u"?new Int32Array(A):A}var r=e();function n(y){var A=0,k=0,C=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)R[C]=y[C];for(C=0;C!=256;++C)for(k=y[C],A=256+C;A<4096;A+=256)k=R[A]=k>>>8^y[k&255];var N=[];for(C=1;C!=16;++C)N[C-1]=typeof Int32Array<"u"?R.subarray(C*256,C*256+256):R.slice(C*256,C*256+256);return N}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],f=s[5],h=s[6],d=s[7],m=s[8],x=s[9],g=s[10],w=s[11],T=s[12],_=s[13],v=s[14];function D(y,A){for(var k=A^-1,C=0,R=y.length;C<R;)k=k>>>8^r[(k^y.charCodeAt(C++))&255];return~k}function z(y,A){for(var k=A^-1,C=y.length-15,R=0;R<C;)k=v[y[R++]^k&255]^_[y[R++]^k>>8&255]^T[y[R++]^k>>16&255]^w[y[R++]^k>>>24]^g[y[R++]]^x[y[R++]]^m[y[R++]]^d[y[R++]]^h[y[R++]]^f[y[R++]]^c[y[R++]]^l[y[R++]]^o[y[R++]]^a[y[R++]]^i[y[R++]]^r[y[R++]];for(C+=15;R<C;)k=k>>>8^r[(k^y[R++])&255];return~k}function B(y,A){for(var k=A^-1,C=0,R=y.length,N=0,F=0;C<R;)N=y.charCodeAt(C++),N<128?k=k>>>8^r[(k^N)&255]:N<2048?(k=k>>>8^r[(k^(192|N>>6&31))&255],k=k>>>8^r[(k^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,F=y.charCodeAt(C++)&1023,k=k>>>8^r[(k^(240|N>>8&7))&255],k=k>>>8^r[(k^(128|N>>2&63))&255],k=k>>>8^r[(k^(128|F>>6&15|(N&3)<<4))&255],k=k>>>8^r[(k^(128|F&63))&255]):(k=k>>>8^r[(k^(224|N>>12&15))&255],k=k>>>8^r[(k^(128|N>>6&63))&255],k=k>>>8^r[(k^(128|N&63))&255]);return~k}return t.table=r,t.bstr=D,t.buf=z,t.str=B,t}(),et=function(){var e={};e.version="1.2.1";function r(I,M){for(var O=I.split("/"),b=M.split("/"),V=0,U=0,X=Math.min(O.length,b.length);V<X;++V){if(U=O[V].length-b[V].length)return U;if(O[V]!=b[V])return O[V]<b[V]?-1:1}return O.length-b.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(0,M+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(M+1)}function i(I,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,I.write_shift(2,O);var b=M.getFullYear()-1980;b=b<<4|M.getMonth()+1,b=b<<5|M.getDate(),I.write_shift(2,b)}function a(I){var M=I.read_shift(2)&65535,O=I.read_shift(2)&65535,b=new Date,V=O&31;O>>>=5;var U=O&15;O>>>=4,b.setMilliseconds(0),b.setFullYear(O+1980),b.setMonth(U-1),b.setDate(V);var X=M&31;M>>>=5;var ee=M&63;return M>>>=6,b.setHours(M),b.setMinutes(ee),b.setSeconds(X<<1),b}function o(I){pr(I,0);for(var M={},O=0;I.l<=I.length-4;){var b=I.read_shift(2),V=I.read_shift(2),U=I.l+V,X={};switch(b){case 21589:O=I.read_shift(1),O&1&&(X.mtime=I.read_shift(4)),V>5&&(O&2&&(X.atime=I.read_shift(4)),O&4&&(X.ctime=I.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}I.l=U,M[b]=X}return M}var l;function c(){return l||(l={})}function f(I,M){if(I[0]==80&&I[1]==75)return ne(I,M);if((I[0]|32)==109&&(I[1]|32)==105)return Bn(I,M);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var O=3,b=512,V=0,U=0,X=0,ee=0,Y=0,Q=[],J=I.slice(0,512);pr(J,0);var oe=h(J);switch(O=oe[0],O){case 3:b=512;break;case 4:b=4096;break;case 0:if(oe[1]==0)return ne(I,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}b!==512&&(J=I.slice(0,b),pr(J,28));var pe=I.slice(0,b);d(J,O);var Ae=J.read_shift(4,"i");if(O===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);J.l+=4,X=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ee=J.read_shift(4,"i"),V=J.read_shift(4,"i"),Y=J.read_shift(4,"i"),U=J.read_shift(4,"i");for(var ue=-1,_e=0;_e<109&&(ue=J.read_shift(4,"i"),!(ue<0));++_e)Q[_e]=ue;var be=m(I,b);w(Y,U,be,b,Q);var pt=_(be,X,Q,b);pt[X].name="!Directory",V>0&&ee!==F&&(pt[ee].name="!MiniFAT"),pt[Q[0]].name="!FAT",pt.fat_addrs=Q,pt.ssz=b;var lt={},St=[],Ps=[],la=[];v(X,pt,be,St,V,lt,Ps,ee),x(Ps,la,St),St.shift();var oi={FileIndex:Ps,FullPaths:la};return M&&M.raw&&(oi.raw={header:pe,sectors:be}),oi}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Ee,"Header Signature: "),I.l+=16;var M=I.read_shift(2,"u");return[I.read_shift(2,"u"),M]}function d(I,M){var O=9;switch(I.l+=2,O=I.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,M){for(var O=Math.ceil(I.length/M)-1,b=[],V=1;V<O;++V)b[V-1]=I.slice(V*M,(V+1)*M);return b[O-1]=I.slice(O*M),b}function x(I,M,O){for(var b=0,V=0,U=0,X=0,ee=0,Y=O.length,Q=[],J=[];b<Y;++b)Q[b]=J[b]=b,M[b]=O[b];for(;ee<J.length;++ee)b=J[ee],V=I[b].L,U=I[b].R,X=I[b].C,Q[b]===b&&(V!==-1&&Q[V]!==V&&(Q[b]=Q[V]),U!==-1&&Q[U]!==U&&(Q[b]=Q[U])),X!==-1&&(Q[X]=b),V!==-1&&b!=Q[b]&&(Q[V]=Q[b],J.lastIndexOf(V)<ee&&J.push(V)),U!==-1&&b!=Q[b]&&(Q[U]=Q[b],J.lastIndexOf(U)<ee&&J.push(U));for(b=1;b<Y;++b)Q[b]===b&&(U!==-1&&Q[U]!==U?Q[b]=Q[U]:V!==-1&&Q[V]!==V&&(Q[b]=Q[V]));for(b=1;b<Y;++b)if(I[b].type!==0){if(ee=b,ee!=Q[ee])do ee=Q[ee],M[b]=M[ee]+"/"+M[b];while(ee!==0&&Q[ee]!==-1&&ee!=Q[ee]);Q[b]=-1}for(M[0]+="/",b=1;b<Y;++b)I[b].type!==2&&(M[b]+="/")}function g(I,M,O){for(var b=I.start,V=I.size,U=[],X=b;O&&V>0&&X>=0;)U.push(M.slice(X*N,X*N+N)),V-=N,X=pa(O,X*4);return U.length===0?Zt(0):vi(U).slice(0,I.size)}function w(I,M,O,b,V){var U=F;if(I===F){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var X=O[I],ee=(b>>>2)-1;if(!X)return;for(var Y=0;Y<ee&&(U=pa(X,Y*4))!==F;++Y)V.push(U);w(pa(X,b-4),M-1,O,b,V)}}function T(I,M,O,b,V){var U=[],X=[];V||(V=[]);var ee=b-1,Y=0,Q=0;for(Y=M;Y>=0;){V[Y]=!0,U[U.length]=Y,X.push(I[Y]);var J=O[Math.floor(Y*4/b)];if(Q=Y*4&ee,b<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+b);if(!I[J])break;Y=pa(I[J],Q)}return{nodes:U,data:Yv([X])}}function _(I,M,O,b){var V=I.length,U=[],X=[],ee=[],Y=[],Q=b-1,J=0,oe=0,pe=0,Ae=0;for(J=0;J<V;++J)if(ee=[],pe=J+M,pe>=V&&(pe-=V),!X[pe]){Y=[];var ue=[];for(oe=pe;oe>=0;){ue[oe]=!0,X[oe]=!0,ee[ee.length]=oe,Y.push(I[oe]);var _e=O[Math.floor(oe*4/b)];if(Ae=oe*4&Q,b<4+Ae)throw new Error("FAT boundary crossed: "+oe+" 4 "+b);if(!I[_e]||(oe=pa(I[_e],Ae),ue[oe]))break}U[pe]={nodes:ee,data:Yv([Y])}}return U}function v(I,M,O,b,V,U,X,ee){for(var Y=0,Q=b.length?2:0,J=M[I].data,oe=0,pe=0,Ae;oe<J.length;oe+=128){var ue=J.slice(oe,oe+128);pr(ue,64),pe=ue.read_shift(2),Ae=Tg(ue,0,pe-Q),b.push(Ae);var _e={name:Ae,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},be=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);be!==0&&(_e.ct=D(ue,ue.l-8));var pt=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);pt!==0&&(_e.mt=D(ue,ue.l-8)),_e.start=ue.read_shift(4,"i"),_e.size=ue.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=F,_e.name=""),_e.type===5?(Y=_e.start,V>0&&Y!==F&&(M[Y].name="!StreamData")):_e.size>=4096?(_e.storage="fat",M[_e.start]===void 0&&(M[_e.start]=T(O,_e.start,M.fat_addrs,M.ssz)),M[_e.start].name=_e.name,_e.content=M[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:Y!==F&&_e.start!==F&&M[Y]&&(_e.content=g(_e,M[Y].data,(M[ee]||{}).data))),_e.content&&pr(_e.content,0),U[Ae]=_e,X.push(_e)}}function D(I,M){return new Date((pn(I,M+4)/1e7*Math.pow(2,32)+pn(I,M)/1e7-11644473600)*1e3)}function z(I,M){return c(),f(l.readFileSync(I),M)}function B(I,M){var O=M&&M.type;switch(O||Ye&&Buffer.isBuffer(I)&&(O="buffer"),O||"base64"){case"file":return z(I,M);case"base64":return f(qn(En(I)),M);case"binary":return f(qn(I),M)}return f(I,M)}function y(I,M){var O=M||{},b=O.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=b+"/",I.FileIndex[0]={name:b,type:5}),O.CLSID&&(I.FileIndex[0].clsid=O.CLSID),A(I)}function A(I){var M="Sh33tJ5";if(!et.find(I,"/"+M)){var O=Zt(4);O[0]=55,O[1]=O[3]=50,O[2]=54,I.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+M),k(I)}}function k(I,M){y(I);for(var O=!1,b=!1,V=I.FullPaths.length-1;V>=0;--V){var U=I.FileIndex[V];switch(U.type){case 0:b?O=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(U.R*U.L*U.C)&&(O=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var X=new Date(1987,1,19),ee=0,Y=Object.create?Object.create(null):{},Q=[];for(V=0;V<I.FullPaths.length;++V)Y[I.FullPaths[V]]=!0,I.FileIndex[V].type!==0&&Q.push([I.FullPaths[V],I.FileIndex[V]]);for(V=0;V<Q.length;++V){var J=n(Q[V][0]);b=Y[J],b||(Q.push([J,{name:s(J).replace("/",""),type:1,clsid:ke,ct:X,mt:X,content:null}]),Y[J]=!0)}for(Q.sort(function(Ae,ue){return r(Ae[0],ue[0])}),I.FullPaths=[],I.FileIndex=[],V=0;V<Q.length;++V)I.FullPaths[V]=Q[V][0],I.FileIndex[V]=Q[V][1];for(V=0;V<Q.length;++V){var oe=I.FileIndex[V],pe=I.FullPaths[V];if(oe.name=s(pe).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||ke,V===0)oe.C=Q.length>1?1:-1,oe.size=0,oe.type=5;else if(pe.slice(-1)=="/"){for(ee=V+1;ee<Q.length&&n(I.FullPaths[ee])!=pe;++ee);for(oe.C=ee>=Q.length?-1:ee,ee=V+1;ee<Q.length&&n(I.FullPaths[ee])!=n(pe);++ee);oe.R=ee>=Q.length?-1:ee,oe.type=1}else n(I.FullPaths[V+1]||"")==n(pe)&&(oe.R=V+1),oe.type=2}}}function C(I,M){var O=M||{};if(O.fileType=="mad")return Je(I,O);switch(k(I),O.fileType){case"zip":return Oe(I,O)}var b=function(Ae){for(var ue=0,_e=0,be=0;be<Ae.FileIndex.length;++be){var pt=Ae.FileIndex[be];if(pt.content){var lt=pt.content.length;lt>0&&(lt<4096?ue+=lt+63>>6:_e+=lt+511>>9)}}for(var St=Ae.FullPaths.length+3>>2,Ps=ue+7>>3,la=ue+127>>7,oi=Ps+_e+St+la,os=oi+127>>7,eo=os<=109?0:Math.ceil((os-109)/127);oi+os+eo+127>>7>os;)eo=++os<=109?0:Math.ceil((os-109)/127);var fn=[1,eo,os,la,St,_e,ue,0];return Ae.FileIndex[0].size=ue<<6,fn[7]=(Ae.FileIndex[0].start=fn[0]+fn[1]+fn[2]+fn[3]+fn[4]+fn[5])+(fn[6]+7>>3),fn}(I),V=Zt(b[7]<<9),U=0,X=0;{for(U=0;U<8;++U)V.write_shift(1,he[U]);for(U=0;U<8;++U)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),U=0;U<3;++U)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,b[2]),V.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:F),V.write_shift(4,b[3]),V.write_shift(-4,b[1]?b[0]-1:F),V.write_shift(4,b[1]),U=0;U<109;++U)V.write_shift(-4,U<b[2]?b[1]+U:-1)}if(b[1])for(X=0;X<b[1];++X){for(;U<236+X*127;++U)V.write_shift(-4,U<b[2]?b[1]+U:-1);V.write_shift(-4,X===b[1]-1?F:X+1)}var ee=function(Ae){for(X+=Ae;U<X-1;++U)V.write_shift(-4,U+1);Ae&&(++U,V.write_shift(-4,F))};for(X=U=0,X+=b[1];U<X;++U)V.write_shift(-4,ve.DIFSECT);for(X+=b[2];U<X;++U)V.write_shift(-4,ve.FATSECT);ee(b[3]),ee(b[4]);for(var Y=0,Q=0,J=I.FileIndex[0];Y<I.FileIndex.length;++Y)J=I.FileIndex[Y],J.content&&(Q=J.content.length,!(Q<4096)&&(J.start=X,ee(Q+511>>9)));for(ee(b[6]+7>>3);V.l&511;)V.write_shift(-4,ve.ENDOFCHAIN);for(X=U=0,Y=0;Y<I.FileIndex.length;++Y)J=I.FileIndex[Y],J.content&&(Q=J.content.length,!(!Q||Q>=4096)&&(J.start=X,ee(Q+63>>6)));for(;V.l&511;)V.write_shift(-4,ve.ENDOFCHAIN);for(U=0;U<b[4]<<2;++U){var oe=I.FullPaths[U];if(!oe||oe.length===0){for(Y=0;Y<17;++Y)V.write_shift(4,0);for(Y=0;Y<3;++Y)V.write_shift(4,-1);for(Y=0;Y<12;++Y)V.write_shift(4,0);continue}J=I.FileIndex[U],U===0&&(J.start=J.size?J.start-1:F);var pe=U===0&&O.root||J.name;if(Q=2*(pe.length+1),V.write_shift(64,pe,"utf16le"),V.write_shift(2,Q),V.write_shift(1,J.type),V.write_shift(1,J.color),V.write_shift(-4,J.L),V.write_shift(-4,J.R),V.write_shift(-4,J.C),J.clsid)V.write_shift(16,J.clsid,"hex");else for(Y=0;Y<4;++Y)V.write_shift(4,0);V.write_shift(4,J.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,J.start),V.write_shift(4,J.size),V.write_shift(4,0)}for(U=1;U<I.FileIndex.length;++U)if(J=I.FileIndex[U],J.size>=4096)if(V.l=J.start+1<<9,Ye&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+511&-512;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&511;++Y)V.write_shift(1,0)}for(U=1;U<I.FileIndex.length;++U)if(J=I.FileIndex[U],J.size>0&&J.size<4096)if(Ye&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+63&-64;else{for(Y=0;Y<J.size;++Y)V.write_shift(1,J.content[Y]);for(;Y&63;++Y)V.write_shift(1,0)}if(Ye)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function R(I,M){var O=I.FullPaths.map(function(Y){return Y.toUpperCase()}),b=O.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),V=!1;M.charCodeAt(0)===47?(V=!0,M=O[0].slice(0,-1)+M):V=M.indexOf("/")!==-1;var U=M.toUpperCase(),X=V===!0?O.indexOf(U):b.indexOf(U);if(X!==-1)return I.FileIndex[X];var ee=!U.match(Ml);for(U=U.replace(Kr,""),ee&&(U=U.replace(Ml,"!")),X=0;X<O.length;++X)if((ee?O[X].replace(Ml,"!"):O[X]).replace(Kr,"")==U||(ee?b[X].replace(Ml,"!"):b[X]).replace(Kr,"")==U)return I.FileIndex[X];return null}var N=64,F=-2,Ee="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(I,M,O){c();var b=C(I,O);l.writeFileSync(M,b)}function W(I){for(var M=new Array(I.length),O=0;O<I.length;++O)M[O]=String.fromCharCode(I[O]);return M.join("")}function le(I,M){var O=C(I,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:W(O);case"base64":return Fv(typeof O=="string"?O:W(O));case"buffer":if(Ye)return Buffer.isBuffer(O)?O:za(O);case"array":return typeof O=="string"?qn(O):O}return O}var we;function L(I){try{var M=I.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)we=I;else throw new Error("zlib does not expose bytesRead")}catch(b){console.error("cannot use native zlib: "+(b.message||b))}}function K(I,M){if(!we)return ai(I,M);var O=we.InflateRaw,b=new O,V=b._processChunk(I.slice(I.l),b._finishFlushFlag);return I.l+=b.bytesRead,V}function G(I){return we?we.deflateRawSync(I):je(I)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(I){var M=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(M>>16|M>>8|M)&255}for(var de=typeof Uint8Array<"u",ie=de?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)ie[Ue]=xe(Ue);function j(I,M){var O=ie[I&255];return M<=8?O>>>8-M:(O=O<<8|ie[I>>8&255],M<=16?O>>>16-M:(O=O<<8|ie[I>>16&255],O>>>24-M))}function ht(I,M){var O=M&7,b=M>>>3;return(I[b]|(O<=6?0:I[b+1]<<8))>>>O&3}function $e(I,M){var O=M&7,b=M>>>3;return(I[b]|(O<=5?0:I[b+1]<<8))>>>O&7}function Ge(I,M){var O=M&7,b=M>>>3;return(I[b]|(O<=4?0:I[b+1]<<8))>>>O&15}function Be(I,M){var O=M&7,b=M>>>3;return(I[b]|(O<=3?0:I[b+1]<<8))>>>O&31}function ge(I,M){var O=M&7,b=M>>>3;return(I[b]|(O<=1?0:I[b+1]<<8))>>>O&127}function gt(I,M,O){var b=M&7,V=M>>>3,U=(1<<O)-1,X=I[V]>>>b;return O<8-b||(X|=I[V+1]<<8-b,O<16-b)||(X|=I[V+2]<<16-b,O<24-b)||(X|=I[V+3]<<24-b),X&U}function ur(I,M,O){var b=M&7,V=M>>>3;return b<=5?I[V]|=(O&7)<<b:(I[V]|=O<<b&255,I[V+1]=(O&7)>>8-b),M+3}function Er(I,M,O){var b=M&7,V=M>>>3;return O=(O&1)<<b,I[V]|=O,M+1}function Qr(I,M,O){var b=M&7,V=M>>>3;return O<<=b,I[V]|=O&255,O>>>=8,I[V+1]=O,M+8}function Ns(I,M,O){var b=M&7,V=M>>>3;return O<<=b,I[V]|=O&255,O>>>=8,I[V+1]=O&255,I[V+2]=O>>>8,M+16}function Jr(I,M){var O=I.length,b=2*O>M?2*O:M+5,V=0;if(O>=M)return I;if(Ye){var U=Dv(b);if(I.copy)I.copy(U);else for(;V<I.length;++V)U[V]=I[V];return U}else if(de){var X=new Uint8Array(b);if(X.set)X.set(I);else for(;V<O;++V)X[V]=I[V];return X}return I.length=b,I}function Jt(I){for(var M=new Array(I),O=0;O<I;++O)M[O]=0;return M}function Zr(I,M,O){var b=1,V=0,U=0,X=0,ee=0,Y=I.length,Q=de?new Uint16Array(32):Jt(32);for(U=0;U<32;++U)Q[U]=0;for(U=Y;U<O;++U)I[U]=0;Y=I.length;var J=de?new Uint16Array(Y):Jt(Y);for(U=0;U<Y;++U)Q[V=I[U]]++,b<V&&(b=V),J[U]=0;for(Q[0]=0,U=1;U<=b;++U)Q[U+16]=ee=ee+Q[U-1]<<1;for(U=0;U<Y;++U)ee=I[U],ee!=0&&(J[U]=Q[ee+16]++);var oe=0;for(U=0;U<Y;++U)if(oe=I[U],oe!=0)for(ee=j(J[U],b)>>b-oe,X=(1<<b+4-oe)-1;X>=0;--X)M[ee|X<<oe]=oe&15|U<<4;return b}var dt=de?new Uint16Array(512):Jt(512),At=de?new Uint16Array(32):Jt(32);if(!de){for(var Dt=0;Dt<512;++Dt)dt[Dt]=0;for(Dt=0;Dt<32;++Dt)At[Dt]=0}(function(){for(var I=[],M=0;M<32;M++)I.push(5);Zr(I,At,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);Zr(O,dt,288)})();var Br=function(){for(var M=de?new Uint8Array(32768):[],O=0,b=0;O<fe.length-1;++O)for(;b<fe[O+1];++b)M[b]=O;for(;b<32768;++b)M[b]=29;var V=de?new Uint8Array(259):[];for(O=0,b=0;O<te.length-1;++O)for(;b<te[O+1];++b)V[b]=O;function U(ee,Y){for(var Q=0;Q<ee.length;){var J=Math.min(65535,ee.length-Q),oe=Q+J==ee.length;for(Y.write_shift(1,+oe),Y.write_shift(2,J),Y.write_shift(2,~J&65535);J-- >0;)Y[Y.l++]=ee[Q++]}return Y.l}function X(ee,Y){for(var Q=0,J=0,oe=de?new Uint16Array(32768):[];J<ee.length;){var pe=Math.min(65535,ee.length-J);if(pe<10){for(Q=ur(Y,Q,+(J+pe==ee.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,pe),Y.write_shift(2,~pe&65535);pe-- >0;)Y[Y.l++]=ee[J++];Q=Y.l*8;continue}Q=ur(Y,Q,+(J+pe==ee.length)+2);for(var Ae=0;pe-- >0;){var ue=ee[J];Ae=(Ae<<5^ue)&32767;var _e=-1,be=0;if((_e=oe[Ae])&&(_e|=J&-32768,_e>J&&(_e-=32768),_e<J))for(;ee[_e+be]==ee[J+be]&&be<250;)++be;if(be>2){ue=V[be],ue<=22?Q=Qr(Y,Q,ie[ue+1]>>1)-1:(Qr(Y,Q,3),Q+=5,Qr(Y,Q,ie[ue-23]>>5),Q+=3);var pt=ue<8?0:ue-4>>2;pt>0&&(Ns(Y,Q,be-te[ue]),Q+=pt),ue=M[J-_e],Q=Qr(Y,Q,ie[ue]>>3),Q-=3;var lt=ue<4?0:ue-2>>1;lt>0&&(Ns(Y,Q,J-_e-fe[ue]),Q+=lt);for(var St=0;St<be;++St)oe[Ae]=J&32767,Ae=(Ae<<5^ee[J])&32767,++J;pe-=be-1}else ue<=143?ue=ue+48:Q=Er(Y,Q,1),Q=Qr(Y,Q,ie[ue]),oe[Ae]=J&32767,++J}Q=Qr(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?U(Y,Q):X(Y,Q)}}();function je(I){var M=Zt(50+Math.floor(I.length*1.1)),O=Br(I,M);return M.slice(0,O)}var it=de?new Uint16Array(32768):Jt(32768),Ht=de?new Uint16Array(32768):Jt(32768),ut=de?new Uint16Array(128):Jt(128),An=1,ii=1;function aa(I,M){var O=Be(I,M)+257;M+=5;var b=Be(I,M)+1;M+=5;var V=Ge(I,M)+4;M+=4;for(var U=0,X=de?new Uint8Array(19):Jt(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=de?new Uint8Array(8):Jt(8),J=de?new Uint8Array(8):Jt(8),oe=X.length,pe=0;pe<V;++pe)X[H[pe]]=U=$e(I,M),Y<U&&(Y=U),Q[U]++,M+=3;var Ae=0;for(Q[0]=0,pe=1;pe<=Y;++pe)J[pe]=Ae=Ae+Q[pe-1]<<1;for(pe=0;pe<oe;++pe)(Ae=X[pe])!=0&&(ee[pe]=J[Ae]++);var ue=0;for(pe=0;pe<oe;++pe)if(ue=X[pe],ue!=0){Ae=ie[ee[pe]]>>8-ue;for(var _e=(1<<7-ue)-1;_e>=0;--_e)ut[Ae|_e<<ue]=ue&7|pe<<3}var be=[];for(Y=1;be.length<O+b;)switch(Ae=ut[ge(I,M)],M+=Ae&7,Ae>>>=3){case 16:for(U=3+ht(I,M),M+=2,Ae=be[be.length-1];U-- >0;)be.push(Ae);break;case 17:for(U=3+$e(I,M),M+=3;U-- >0;)be.push(0);break;case 18:for(U=11+ge(I,M),M+=7;U-- >0;)be.push(0);break;default:be.push(Ae),Y<Ae&&(Y=Ae);break}var pt=be.slice(0,O),lt=be.slice(O);for(pe=O;pe<286;++pe)pt[pe]=0;for(pe=b;pe<30;++pe)lt[pe]=0;return An=Zr(pt,it,286),ii=Zr(lt,Ht,30),M}function gl(I,M){if(I[0]==3&&!(I[1]&3))return[Hi(M),2];for(var O=0,b=0,V=Dv(M||1<<18),U=0,X=V.length>>>0,ee=0,Y=0;!(b&1);){if(b=$e(I,O),O+=3,b>>>1)b>>1==1?(ee=9,Y=5):(O=aa(I,O),ee=An,Y=ii);else{O&7&&(O+=8-(O&7));var Q=I[O>>>3]|I[(O>>>3)+1]<<8;if(O+=32,Q>0)for(!M&&X<U+Q&&(V=Jr(V,U+Q),X=V.length);Q-- >0;)V[U++]=I[O>>>3],O+=8;continue}for(;;){!M&&X<U+32767&&(V=Jr(V,U+32767),X=V.length);var J=gt(I,O,ee),oe=b>>>1==1?dt[J]:it[J];if(O+=oe&15,oe>>>=4,!(oe>>>8&255))V[U++]=oe;else{if(oe==256)break;oe-=257;var pe=oe<8?0:oe-4>>2;pe>5&&(pe=0);var Ae=U+te[oe];pe>0&&(Ae+=gt(I,O,pe),O+=pe),J=gt(I,O,Y),oe=b>>>1==1?At[J]:Ht[J],O+=oe&15,oe>>>=4;var ue=oe<4?0:oe-2>>1,_e=fe[oe];for(ue>0&&(_e+=gt(I,O,ue),O+=ue),!M&&X<Ae&&(V=Jr(V,Ae+100),X=V.length);U<Ae;)V[U]=V[U-_e],++U}}}return M?[V,O+7>>>3]:[V.slice(0,U),O+7>>>3]}function ai(I,M){var O=I.slice(I.l||0),b=gl(O,M);return I.l+=b[1],b[0]}function oa(I,M){if(I)typeof console<"u"&&console.error(M);else throw new Error(M)}function ne(I,M){var O=I;pr(O,0);var b=[],V=[],U={FileIndex:b,FullPaths:V};y(U,{root:M.root});for(var X=O.length-4;(O[X]!=80||O[X+1]!=75||O[X+2]!=5||O[X+3]!=6)&&X>=0;)--X;O.l=X+4,O.l+=4;var ee=O.read_shift(2);O.l+=6;var Y=O.read_shift(4);for(O.l=Y,X=0;X<ee;++X){O.l+=20;var Q=O.read_shift(4),J=O.read_shift(4),oe=O.read_shift(2),pe=O.read_shift(2),Ae=O.read_shift(2);O.l+=8;var ue=O.read_shift(4),_e=o(O.slice(O.l+oe,O.l+oe+pe));O.l+=oe+pe+Ae;var be=O.l;O.l=ue+4,Ie(O,Q,J,U,_e),O.l=be}return U}function Ie(I,M,O,b,V){I.l+=2;var U=I.read_shift(2),X=I.read_shift(2),ee=a(I);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Y=I.read_shift(4),Q=I.read_shift(4),J=I.read_shift(4),oe=I.read_shift(2),pe=I.read_shift(2),Ae="",ue=0;ue<oe;++ue)Ae+=String.fromCharCode(I[I.l++]);if(pe){var _e=o(I.slice(I.l,I.l+pe));(_e[21589]||{}).mt&&(ee=_e[21589].mt),((V||{})[21589]||{}).mt&&(ee=V[21589].mt)}I.l+=pe;var be=I.slice(I.l,I.l+Q);switch(X){case 8:be=K(I,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var pt=!1;U&8&&(Y=I.read_shift(4),Y==134695760&&(Y=I.read_shift(4),pt=!0),Q=I.read_shift(4),J=I.read_shift(4)),Q!=M&&oa(pt,"Bad compressed size: "+M+" != "+Q),J!=O&&oa(pt,"Bad uncompressed size: "+O+" != "+J),wr(b,Ae,be,{unsafe:!0,mt:ee})}function Oe(I,M){var O=M||{},b=[],V=[],U=Zt(1),X=O.compression?8:0,ee=0,Y=0,Q=0,J=0,oe=0,pe=I.FullPaths[0],Ae=pe,ue=I.FileIndex[0],_e=[],be=0;for(Y=1;Y<I.FullPaths.length;++Y)if(Ae=I.FullPaths[Y].slice(pe.length),ue=I.FileIndex[Y],!(!ue.size||!ue.content||Ae=="Sh33tJ5")){var pt=J,lt=Zt(Ae.length);for(Q=0;Q<Ae.length;++Q)lt.write_shift(1,Ae.charCodeAt(Q)&127);lt=lt.slice(0,lt.l),_e[oe]=I3.buf(ue.content,0);var St=ue.content;X==8&&(St=G(St)),U=Zt(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,X),ue.mt?i(U,ue.mt):U.write_shift(4,0),U.write_shift(-4,_e[oe]),U.write_shift(4,St.length),U.write_shift(4,ue.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),J+=U.length,b.push(U),J+=lt.length,b.push(lt),J+=St.length,b.push(St),U=Zt(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ee),U.write_shift(2,X),U.write_shift(4,0),U.write_shift(-4,_e[oe]),U.write_shift(4,St.length),U.write_shift(4,ue.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,pt),be+=U.l,V.push(U),be+=lt.length,V.push(lt),++oe}return U=Zt(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,oe),U.write_shift(2,oe),U.write_shift(4,be),U.write_shift(4,J),U.write_shift(2,0),vi([vi(b),vi(V),U])}var Ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ye(I,M){if(I.ctype)return I.ctype;var O=I.name||"",b=O.match(/\.([^\.]+)$/);return b&&Ne[b[1]]||M&&(b=(O=M).match(/[\.\\]([^\.\\])+$/),b&&Ne[b[1]])?Ne[b[1]]:"application/octet-stream"}function Qe(I){for(var M=Fv(I),O=[],b=0;b<M.length;b+=76)O.push(M.slice(b,b+76));return O.join(`\r
`)+`\r
`}function rt(I){var M=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var J=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],b=M.split(`\r
`),V=0;V<b.length;++V){var U=b[V];if(U.length==0){O.push("");continue}for(var X=0;X<U.length;){var ee=76,Y=U.slice(X,X+ee);Y.charAt(ee-1)=="="?ee--:Y.charAt(ee-2)=="="?ee-=2:Y.charAt(ee-3)=="="&&(ee-=3),Y=U.slice(X,X+ee),X+=ee,X<U.length&&(Y+="="),O.push(Y)}}return O.join(`\r
`)}function ft(I){for(var M=[],O=0;O<I.length;++O){for(var b=I[O];O<=I.length&&b.charAt(b.length-1)=="=";)b=b.slice(0,b.length-1)+I[++O];M.push(b)}for(var V=0;V<M.length;++V)M[V]=M[V].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return qn(M.join(`\r
`))}function kt(I,M,O){for(var b="",V="",U="",X,ee=0;ee<10;++ee){var Y=M[ee];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":b=Q[2].trim();break;case"content-type":U=Q[2].trim();break;case"content-transfer-encoding":V=Q[2].trim();break}}switch(++ee,V.toLowerCase()){case"base64":X=qn(En(M.slice(ee).join("")));break;case"quoted-printable":X=ft(M.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var J=wr(I,b.slice(O.length),X,{unsafe:!0});U&&(J.ctype=U)}function Bn(I,M){if(W(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",b=(Ye&&Buffer.isBuffer(I)?I.toString("binary"):W(I)).split(`\r
`),V=0,U="";for(V=0;V<b.length;++V)if(U=b[V],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),O||(O=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),U.slice(0,O.length)!=O););var X=(b[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var ee="--"+(X[1]||""),Y=[],Q=[],J={FileIndex:Y,FullPaths:Q};y(J);var oe,pe=0;for(V=0;V<b.length;++V){var Ae=b[V];Ae!==ee&&Ae!==ee+"--"||(pe++&&kt(J,b.slice(oe,V),O),oe=V)}return J}function Je(I,M){var O=M||{},b=O.boundary||"SheetJS";b="------="+b;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+b.slice(2)+'"',"","",""],U=I.FullPaths[0],X=U,ee=I.FileIndex[0],Y=1;Y<I.FullPaths.length;++Y)if(X=I.FullPaths[Y].slice(U.length),ee=I.FileIndex[Y],!(!ee.size||!ee.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(be){return"_x"+be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(be){return"_u"+be.charCodeAt(0).toString(16)+"_"});for(var Q=ee.content,J=Ye&&Buffer.isBuffer(Q)?Q.toString("binary"):W(Q),oe=0,pe=Math.min(1024,J.length),Ae=0,ue=0;ue<=pe;++ue)(Ae=J.charCodeAt(ue))>=32&&Ae<128&&++oe;var _e=oe>=pe*4/5;V.push(b),V.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+X),V.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),V.push("Content-Type: "+ye(ee,X)),V.push(""),V.push(_e?rt(J):Qe(J))}return V.push(b+`--\r
`),V.join(`\r
`)}function jr(I){var M={};return y(M,I),M}function wr(I,M,O,b){var V=b&&b.unsafe;V||y(I);var U=!V&&et.find(I,M);if(!U){var X=I.FullPaths[0];M.slice(0,X.length)==X?X=M:(X.slice(-1)!="/"&&(X+="/"),X=(X+M).replace("//","/")),U={name:s(M),type:2},I.FileIndex.push(U),I.FullPaths.push(X),V||et.utils.cfb_gc(I)}return U.content=O,U.size=O?O.length:0,b&&(b.CLSID&&(U.clsid=b.CLSID),b.mt&&(U.mt=b.mt),b.ct&&(U.ct=b.ct)),U}function un(I,M){y(I);var O=et.find(I,M);if(O){for(var b=0;b<I.FileIndex.length;++b)if(I.FileIndex[b]==O)return I.FileIndex.splice(b,1),I.FullPaths.splice(b,1),!0}return!1}function O0(I,M,O){y(I);var b=et.find(I,M);if(b){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==b)return I.FileIndex[V].name=s(O),I.FullPaths[V]=O,!0}return!1}function b0(I){k(I,!0)}return e.find=R,e.read=B,e.parse=f,e.write=le,e.writeFile=ae,e.utils={cfb_new:jr,cfb_add:wr,cfb_del:un,cfb_mov:O0,cfb_gc:b0,ReadShift:tc,CheckField:yT,prep_blob:pr,bconcat:vi,use_zlib:L,_deflateRaw:je,_inflateRaw:ai,consts:ve},e}();function C3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ks(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function _g(t){for(var e=[],r=ks(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var fh=new Date(1899,11,30,0,0,0);function qr(t,e){var r=t.getTime(),n=fh.getTime()+(t.getTimezoneOffset()-fh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Zw=new Date,R3=fh.getTime()+(Zw.getTimezoneOffset()-fh.getTimezoneOffset())*6e4,jv=Zw.getTimezoneOffset();function s0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+R3),e.getTimezoneOffset()!==jv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-jv)*6e4),e}function N3(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var zv=new Date("2017-02-19T19:06:09.000Z"),eT=isNaN(zv.getFullYear())?new Date("2/19/17"):zv,P3=eT.getFullYear()==2017;function cr(t,e){var r=new Date(t);if(P3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(eT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Fa(t,e){if(Ye&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ul(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ul(Bw(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ul(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ul(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function xr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=xr(t[r]));return e}function Lt(t,e){for(var r="";r.length<e;)r+=t;return r}function es(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var F3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ko(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&F3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var D3=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function tT(t){return t?t.content&&t.type?Fa(t.content,!0):t.data?Ll(t.data):t.asNodeBuffer&&Ye?Ll(t.asNodeBuffer().toString("binary")):t.asBinary?Ll(t.asBinary()):t._data&&t._data.getContent?Ll(Fa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function rT(t){if(!t)return null;if(t.data)return Nv(t.data);if(t.asNodeBuffer&&Ye)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Nv(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function O3(t){return t&&t.name.slice(-4)===".bin"?rT(t):tT(t)}function In(t,e){for(var r=t.FullPaths||ks(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function yg(t,e){var r=In(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Kt(t,e,r){if(!r)return O3(yg(t,e));if(!e)return null;try{return Kt(t,e)}catch{return null}}function mn(t,e,r){if(!r)return tT(yg(t,e));if(!e)return null;try{return mn(t,e)}catch{return null}}function b3(t,e,r){return rT(yg(t,e))}function $v(t){for(var e=t.FullPaths||ks(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function L3(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ye?n=za(r):n=t3(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function nT(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Vl(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var sT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,V3=/<[^>]*>/g,Ur=sT.match(Hv)?Hv:V3,U3=/<\w*:/,B3=/<(\/?)\w+:/;function De(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(M3),o=0,l="",c=0,f="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(d=(s=h.charCodeAt(i+1))==34||s==39?1:0,l=h.slice(i+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Cs(t){return t.replace(B3,"<$1")}var iT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j3=_g(iT),st=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return iT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),z3=/[&<>'"]/g,$3=/[\u0000-\u001f]/g;function Eg(t){var e=t+"";return e.replace(z3,function(r){return j3[r]}).replace(/\n/g,"<br/>").replace($3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Wv=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function It(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function md(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Gv(t){var e=Hi(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Kv(t){return za(t,"binary").toString("utf8")}var Yu="foo bar baz",_t=Ye&&(Kv(Yu)==md(Yu)&&Kv||Gv(Yu)==md(Yu)&&Gv)||md,Ul=Ye?function(t){return za(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Lc=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),aT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),H3=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),W3=/<\/?(?:vt:)?variant>/g,G3=/<(?:vt:)([^>]*)>([\s\S]*)</;function qv(t,e){var r=De(t),n=t.match(H3(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(W3,"").match(G3);a&&s.push({v:_t(a[2]),t:a[1]})}),s}var K3=/(^\s|\s$|\n)/;function q3(t){return ks(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function X3(t,e,r){return"<"+t+(r!=null?q3(r):"")+(e!=null?(e.match(K3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function wg(t){if(Ye&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return _t($a(gg(t)));throw new Error("Bad input format: expected Buffer or string")}var Mc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Y3={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Q3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function J3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Z3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Xv=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Yv=Ye?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:za(e)})):Xv(t)}:Xv,Qv=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Us(t,s)));return n.join("").replace(Kr,"")},Tg=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Kr,""):Qv(t,e,r)}:Qv,Jv=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},oT=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Jv(t,e,r)}:Jv,Zv=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(ao(t,s)));return n.join("")},nu=Ye?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Zv(e,r,n)}:Zv,lT=function(t,e){var r=pn(t,e);return r>0?nu(t,e+4,e+4+r-1):""},cT=lT,uT=function(t,e){var r=pn(t,e);return r>0?nu(t,e+4,e+4+r-1):""},fT=uT,hT=function(t,e){var r=2*pn(t,e);return r>0?nu(t,e+4,e+4+r-1):""},dT=hT,pT=function(e,r){var n=pn(e,r);return n>0?Tg(e,r+4,r+4+n):""},mT=pT,gT=function(t,e){var r=pn(t,e);return r>0?nu(t,e+4,e+4+r):""},xT=gT,vT=function(t,e){return J3(t,e)},hh=vT,_T=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ye&&(cT=function(e,r){if(!Buffer.isBuffer(e))return lT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},fT=function(e,r){if(!Buffer.isBuffer(e))return uT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},dT=function(e,r){if(!Buffer.isBuffer(e))return hT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},mT=function(e,r){if(!Buffer.isBuffer(e))return pT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},xT=function(e,r){if(!Buffer.isBuffer(e))return gT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},hh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):vT(e,r)},_T=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ao=function(t,e){return t[e]},Us=function(t,e){return t[e+1]*256+t[e]},eN=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},pn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},pa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},tN=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function tc(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Us(this,c)),c+=2;t*=2;break;case"utf8":r=nu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Tg(this,this.l,this.l+t);break;case"wstr":return tc.call(this,t,"dbcs");case"lpstr-ansi":r=cT(this,this.l),t=4+pn(this,this.l);break;case"lpstr-cp":r=fT(this,this.l),t=4+pn(this,this.l);break;case"lpwstr":r=dT(this,this.l),t=4+2*pn(this,this.l);break;case"lpp4":t=4+pn(this,this.l),r=mT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+pn(this,this.l),r=xT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=ao(this,this.l+t++))!==0;)i.push(Xu(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Us(this,this.l+t))!==0;)i.push(Xu(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ao(this,c),this.l=c+1,o=tc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Xu(Us(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ao(this,c),this.l=c+1,o=tc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Xu(ao(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=ao(this,this.l),this.l++,n;case 2:return n=(e==="i"?eN:Us)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?pa:tN)(this,this.l),this.l+=4,n):(s=pn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=hh(this,this.l):s=hh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=oT(this,this.l,t);break}}return this.l+=t,r}var rN=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},nN=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},sN=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function iN(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)sN(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,rN(this,e,this.l);break;case 8:if(n=8,r==="f"){Z3(this,e,this.l);break}case 16:break;case-4:n=4,nN(this,e,this.l);break}return this.l+=n,this}function yT(t,e){var r=oT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function pr(t,e){t.l=e,t.read_shift=tc,t.chk=yT,t.write_shift=iN}function Mr(t,e){t.l+=e}function Zt(t){var e=Hi(t);return pr(e,0),e}function ni(t,e,r){if(t){var n,s,i;pr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=vh[o]||vh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var f=c.f&&c.f(t,i,r);if(t.l=l,e(f,c,o))return}}}function Op(){var t=[],e=Ye?256:2048,r=function(c){var f=Zt(c);return pr(f,0),f},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),vi(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function rc(t,e,r){var n=xr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function e_(t,e,r){var n=xr(t);return n.s=rc(n.s,e.s,r),n.e=rc(n.e,e.s,r),n}function nc(t,e){if(t.cRel&&t.c<0)for(t=xr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=xr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Me(t);return!t.cRel&&t.cRel!=null&&(r=lN(r)),!t.rRel&&t.rRel!=null&&(r=aN(r)),r}function gd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+rr(t.s.c)+":"+(t.e.cRel?"":"$")+rr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+vr(t.s.r)+":"+(t.e.rRel?"":"$")+vr(t.e.r):nc(t.s,e.biff)+":"+nc(t.e,e.biff)}function Ag(t){return parseInt(oN(t),10)-1}function vr(t){return""+(t+1)}function aN(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oN(t){return t.replace(/\$(\d+)$/,"$1")}function kg(t){for(var e=cN(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function rr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function lN(t){return t.replace(/^([A-Z])/,"$$$1")}function cN(t){return t.replace(/^\$([A-Z])/,"$1")}function uN(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Me(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function al(t){var e=t.indexOf(":");return e==-1?{s:Wr(t),e:Wr(t)}:{s:Wr(t.slice(0,e)),e:Wr(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Me(t)),typeof e!="string"&&(e=Me(e)),t==e?t:t+":"+e)}function Mt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function t_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Vn(t.z,r?qr(e):e)}catch{}try{return t.w=Vn((t.XF||{}).numFmtId||(r?14:0),r?qr(e):e)}catch{return""+e}}function Qs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ga[t.v]||t.v:e==null?t_(t,t.v):t_(t,e))}function ra(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function ET(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wr(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Mt(i["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},x=a+h,g=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ze[14],n.cellDates?(m.t="d",m.w=Vn(m.z,qr(m.v))):(m.t="n",m.v=qr(m.v),m.w=Vn(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(m.z=i[x][g].z),i[x][g]=m;else{var w=Me({c:g,r:x});i[w]&&i[w].z&&(m.z=i[w].z),i[w]=m}}}return c.s.c<1e7&&(i["!ref"]=tt(c)),i}function ol(t,e){return ET(null,t,e)}function fN(t){return t.read_shift(4,"i")}function br(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function hN(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Sg(t,e){var r=t.l,n=t.read_shift(1),s=br(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(hN(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var dN=Sg;function Un(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ha(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var pN=br;function Ig(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var mN=br,bp=Ig;function Cg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?hh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):pa(e,0)>>2;return r?s/100:s}function wT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Wa=wT;function Dr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function gN(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Aa[s];c&&(e.rgb=Uc(c));break;case 2:e.rgb=Uc([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function xN(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function TT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function vN(t){return TT(t,1)}function _N(t){return TT(t,2)}var Rg=2,en=3,Qu=11,r_=12,dh=19,Ju=64,yN=65,EN=71,wN=4108,TN=4126,ir=80,AT=81,AN=[ir,AT],kN={1:{n:"CodePage",t:Rg},2:{n:"Category",t:ir},3:{n:"PresentationFormat",t:ir},4:{n:"ByteCount",t:en},5:{n:"LineCount",t:en},6:{n:"ParagraphCount",t:en},7:{n:"SlideCount",t:en},8:{n:"NoteCount",t:en},9:{n:"HiddenCount",t:en},10:{n:"MultimediaClipCount",t:en},11:{n:"ScaleCrop",t:Qu},12:{n:"HeadingPairs",t:wN},13:{n:"TitlesOfParts",t:TN},14:{n:"Manager",t:ir},15:{n:"Company",t:ir},16:{n:"LinksUpToDate",t:Qu},17:{n:"CharacterCount",t:en},19:{n:"SharedDoc",t:Qu},22:{n:"HyperlinksChanged",t:Qu},23:{n:"AppVersion",t:en,p:"version"},24:{n:"DigSig",t:yN},26:{n:"ContentType",t:ir},27:{n:"ContentStatus",t:ir},28:{n:"Language",t:ir},29:{n:"Version",t:ir},255:{},2147483648:{n:"Locale",t:dh},2147483651:{n:"Behavior",t:dh},1919054434:{}},SN={1:{n:"CodePage",t:Rg},2:{n:"Title",t:ir},3:{n:"Subject",t:ir},4:{n:"Author",t:ir},5:{n:"Keywords",t:ir},6:{n:"Comments",t:ir},7:{n:"Template",t:ir},8:{n:"LastAuthor",t:ir},9:{n:"RevNumber",t:ir},10:{n:"EditTime",t:Ju},11:{n:"LastPrinted",t:Ju},12:{n:"CreatedDate",t:Ju},13:{n:"ModifiedDate",t:Ju},14:{n:"PageCount",t:en},15:{n:"WordCount",t:en},16:{n:"CharCount",t:en},17:{n:"Thumbnail",t:EN},18:{n:"Application",t:ir},19:{n:"DocSecurity",t:en},255:{},2147483648:{n:"Locale",t:dh},2147483651:{n:"Behavior",t:dh},1919054434:{}},n_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},IN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var RN=CN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Aa=xr(RN),Ga={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},s_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function NN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function PN(t){var e=NN();if(!t||!t.match)return e;var r={};if((t.match(Ur)||[]).forEach(function(n){var s=De(n);switch(s[0].replace(U3,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[s_[s.ContentType]]!==void 0&&e[s_[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Y3.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Ao={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Lp(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function sc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Ur)||[]).forEach(function(s){var i=De(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Vl(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var FN="application/vnd.oasis.opendocument.spreadsheet";function DN(t,e){for(var r=wg(t),n,s;n=Mc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=De(n[0],!1),s.path=="/"&&s.type!==FN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var ic=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ON=function(){for(var t=new Array(ic.length),e=0;e<ic.length;++e){var r=ic[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function ST(t){var e={};t=_t(t);for(var r=0;r<ic.length;++r){var n=ic[r],s=t.match(ON[r]);s!=null&&s.length>0&&(e[n[1]]=st(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=cr(e[n[1]]))}return e}var bN=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function IT(t,e,r,n){var s=[];if(typeof t=="string")s=qv(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(f){return{v:f}}));var a=typeof e=="string"?qv(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function LN(t,e,r){var n={};return e||(e={}),t=_t(t),bN.forEach(function(s){var i=(t.match(Lc(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=st(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&IT(n.HeadingPairs,n.TitlesOfParts,e,r),e}var MN=/<[^>]+>[^<]*/g;function VN(t,e){var r={},n="",s=t.match(MN);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=De(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=st(f);break;case"bool":r[n]=It(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=cr(f);break;case"cy":case"error":r[n]=st(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var UN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xd;function BN(t,e,r){xd||(xd=_g(UN)),e=xd[e]||e,t[e]=r}function Ng(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function CT(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function RT(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function NT(t,e,r){return e===31?RT(t):CT(t,e,r)}function Mp(t,e,r){return NT(t,e,r===!1?0:4)}function jN(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return NT(t,e,0)}function zN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Kr,""),t.l-s&2&&(t.l+=2)}return r}function $N(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Kr,"");return r}function HN(t){var e=t.l,r=ph(t,AT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ph(t,en);return[r,n]}function WN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(HN(t));return r}function i_(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Kr,"").replace(Ml,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function PT(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function GN(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ph(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==r_&&n!==e&&AN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===r_?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return CT(t,n,4).replace(Kr,"");case 31:return RT(t);case 64:return Ng(t);case 65:return PT(t);case 71:return GN(t);case 80:return Mp(t,n,!i.raw).replace(Kr,"");case 81:return jN(t,n).replace(Kr,"");case 4108:return WN(t);case 4126:case 4127:return n==4127?zN(t):$N(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function a_(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var f=t.read_shift(4),h=t.read_shift(4);i[a]=[f,h+r]}i.sort(function(_,v){return _[1]-v[1]});var d={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var m=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(m=!1,t.l=i[a][1]),m)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var x=e[i[a][0]];if(d[x.n]=ph(t,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xn(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(i[a][0]===1){if(o=d.CodePage=ph(t,Rg),Xn(o),l!==-1){var g=t.l;t.l=i[l][1],c=i_(t,o),t.l=g}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=i_(t,o)}else{var w=c[i[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=PT(t);break;case 30:t.l+=4,T=Mp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Mp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Ut(t,4);break;case 64:t.l+=4,T=cr(Ng(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[w]=T}}return t.l=r+n,d}function o_(t,e,r){var n=t.content;if(!n)return{};pr(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==et.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=a_(n,e),d={SystemIdentifier:c};for(var m in h)d[m]=h[m];if(d.FMTID=i,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=a_(n,null)}catch{}for(m in x)d[m]=x[m];return d.FMTID=[i,a],d}function fi(t,e){return t.read_shift(e),null}function KN(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Ut(t,e){return t.read_shift(e)===1}function qt(t){return t.read_shift(2,"u")}function FT(t,e){return KN(t,e,qt)}function qN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function su(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function XN(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Da(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function iu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Da(t,n,r)}function Ka(t,e,r){if(r.biff>5)return iu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function YN(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function QN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Kr,"");return n&&(t.l+=24),s}function JN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Kr,"");return r+a}function ZN(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return QN(t);case"0303000000000000c000000000000046":return JN(t);default:throw new Error("Unsupported Moniker "+r)}}function Zu(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Kr,""):"";return r}function eP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",f,h;s&16&&(i=Zu(t,r-t.l)),s&128&&(a=Zu(t,r-t.l)),(s&257)===257&&(o=Zu(t,r-t.l)),(s&257)===1&&(l=ZN(t,r-t.l)),s&8&&(c=Zu(t,r-t.l)),s&32&&(f=t.read_shift(16)),s&64&&(h=Ng(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return f&&(m.guid=f),h&&(m.time=h),i&&(m.Tooltip=i),m}function DT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function OT(t,e){var r=DT(t);return r[3]=0,r}function Rs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function tP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function rP(t,e,r){return e===0?"":Ka(t,e,r)}function nP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function bT(t){var e=t.read_shift(2),r=Cg(t);return[e,r]}function sP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=su(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function i0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function LT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var iP=LT;function MT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function aP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function oP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ir(t){t.l+=2,t.l+=t.read_shift(2)}var lP={0:Ir,4:Ir,5:Ir,6:Ir,7:oP,8:Ir,9:Ir,10:Ir,11:Ir,12:Ir,13:aP,14:Ir,15:Ir,16:Ir,17:Ir,18:Ir,19:Ir,20:Ir,21:MT};function cP(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(lP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function ef(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function uP(t,e){return e===0||t.read_shift(2),1200}function fP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Ka(t,0,r);return t.read_shift(e+n-t.l),s}function hP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dP(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=su(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function pP(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(XN(t));return i.Count=n,i.Unique=s,i}function mP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function gP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function xP(t){var e=tP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function vP(t){return t.read_shift(2),t.read_shift(4)}function l_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function _P(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function yP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function EP(){}function wP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=su(t,0,r),n}function TP(t){var e=Rs(t);return e.isst=t.read_shift(4),e}function AP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Rs(t);r.biff==2&&t.l++;var i=iu(t,n-t.l,r);return s.val=i,s}function kP(t,e,r){var n=t.read_shift(2),s=Ka(t,0,r);return[n,s]}var SP=Ka;function c_(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function IP(t){var e=t.read_shift(2),r=t.read_shift(2),n=bT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function CP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(bT(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function RP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function NP(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=IN[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function PP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=NP(t,e,n.fStyle,r),n}function FP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function u_(t,e,r){var n=Rs(t);(r.biff==2||e==9)&&++t.l;var s=qN(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function DP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Rs(t),s=Dr(t);return n.val=s,n}var f_=rP;function OP(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Da(t,i),o=[];n>t.l;)o.push(iu(t));return[i,s,a,o]}function h_(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=sP(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var bP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function d_(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Da(t,a,r);s&32&&(c=bP[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:gO(t,f,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function VT(t,e,r){if(r.biff<8)return LP(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(nP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function LP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=su(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function MP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Da(t,n,r),a=Da(t,s,r);return[i,a]}function VP(t,e,r){var n=LT(t);t.l++;var s=t.read_shift(1);return e-=8,[xO(t,e,r),s,n]}function p_(t,e,r){var n=iP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,pO(t,e,r)]}function UP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function BP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Ka(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function jP(t,e,r){return BP(t,e,r)}function zP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(i0(t));return r}function $P(t,e,r){if(r&&r.biff<8)return WP(t,e,r);var n=MT(t),s=cP(t,e-22,n[1]);return{cmo:n,ft:s}}var HP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function WP(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((HP[n]||Mr)(t,e,r)),{cmo:[s,n,i],ft:a}}function GP(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=YN(t,6,r);var o=t.read_shift(2);t.read_shift(2),qt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Da(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function KP(t,e){var r=i0(t);t.l+=16;var n=eP(t,e-24);return[r,n]}function qP(t,e){t.read_shift(2);var r=i0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Kr,""),[r,n]}function XP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=n_[r]||r,r=t.read_shift(2),e[1]=n_[r]||r,e}function YP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OT(t));return r}function QP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OT(t));return r}function JP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function UT(t,e,r){if(!r.cellStyles)return Mr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function ZP(t,e){var r={};return e<32||(t.l+=16,r.header=Dr(t),r.footer=Dr(t),t.l+=2),r}function eF(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var tF=Rs,rF=FT,nF=iu;function sF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function iF(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Rs(t);++t.l;var s=Ka(t,e-7,r);return n.t="str",n.val=s,n}function aF(t){var e=Rs(t);++t.l;var r=Dr(t);return e.t="n",e.val=r,e}function oF(t){var e=Rs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function lF(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function cF(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function uF(t,e,r){var n=t.l+e,s=Rs(t),i=t.read_shift(2),a=Da(t,i,r);return t.l=n,s.t="str",s.val=a,s}var fF=[2,3,48,49,131,139,140,245],m_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=_g({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Hi(1);switch(l.type){case"base64":f=qn(En(o));break;case"binary":f=qn(o);break;case"buffer":case"array":f=o;break}pr(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=f.read_shift(2));var T=f.read_shift(2),_=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=t[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var v=[],D={},z=Math.min(f.length,h==2?521:w-10-(m?264:0)),B=x?32:11;f.l<z&&f[f.l]!=13;)switch(D={},D.name=Oc.utils.decode(_,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,D.type=String.fromCharCode(f.read_shift(1)),h!=2&&!x&&(D.offset=f.read_shift(4)),D.len=f.read_shift(1),h==2&&(D.offset=f.read_shift(2)),D.dec=f.read_shift(1),D.name.length&&v.push(D),h!=2&&(f.l+=x?13:14),D.type){case"B":(!m||D.len!=8)&&l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var y=0,A=0;for(c[0]=[],A=0;A!=v.length;++A)c[0][A]=v[A].name;for(;g-- >0;){if(f[f.l]===42){f.l+=T;continue}for(++f.l,c[++y]=[],A=0,A=0;A!=v.length;++A){var k=f.slice(f.l,f.l+v[A].len);f.l+=v[A].len,pr(k,0);var C=Oc.utils.decode(_,k);switch(v[A].type){case"C":C.trim().length&&(c[y][A]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[y][A]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[y][A]=C;break;case"F":c[y][A]=parseFloat(C.trim());break;case"+":case"I":c[y][A]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[y][A]=!0;break;case"N":case"F":c[y][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[y][A]="##MEMO##"+(x?parseInt(C.trim(),10):k.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[y][A]=+C||0);break;case"@":c[y][A]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[y][A]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[y][A]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][A]=-k.read_shift(-8,"f");break;case"B":if(m&&v[A].len==8){c[y][A]=k.read_shift(8,"f");break}case"G":case"P":k.l+=v[A].len;break;case"0":if(v[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[A].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=ol(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function s(o,l){try{return ra(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Xn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Op(),h=$p(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),x=o["!cols"]||[],g=0,w=0,T=0,_=1;for(g=0;g<d.length;++g){if(((x[g]||{}).DBF||{}).name){d[g]=x[g].DBF.name,++T;continue}if(d[g]!=null){if(++T,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(w=0;w<1024;++w)if(d.indexOf(d[g]+"_"+w)==-1){d[g]+="_"+w;break}}}}var v=Mt(o["!ref"]),D=[],z=[],B=[];for(g=0;g<=v.e.c-v.s.c;++g){var y="",A="",k=0,C=[];for(w=0;w<m.length;++w)m[w][g]!=null&&C.push(m[w][g]);if(C.length==0||d[g]==null){D[g]="?";continue}for(w=0;w<C.length;++w){switch(typeof C[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=C[w]instanceof Date?"D":"C";break;default:A="C"}k=Math.max(k,String(C[w]).length),y=y&&y!=A?"C":A}k>250&&(k=250),A=((x[g]||{}).DBF||{}).type,A=="C"&&x[g].DBF.len>k&&(k=x[g].DBF.len),y=="B"&&A=="N"&&(y="N",B[g]=x[g].DBF.dec,k=x[g].DBF.len),z[g]=y=="C"||A=="N"?k:i[y]||0,_+=z[g],D[g]=y}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*T),R.write_shift(2,_),g=0;g<4;++g)R.write_shift(4,0);for(R.write_shift(4,0|(+e[Vw]||3)<<8),g=0,w=0;g<d.length;++g)if(d[g]!=null){var N=f.next(32),F=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,F,"sbcs"),N.write_shift(1,D[g]=="?"?"C":D[g],"sbcs"),N.write_shift(4,w),N.write_shift(1,z[g]||i[D[g]]||0),N.write_shift(1,B[g]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),w+=z[g]||i[D[g]]||0}var Ee=f.next(264);for(Ee.write_shift(4,13),g=0;g<65;++g)Ee.write_shift(4,0);for(g=0;g<m.length;++g){var he=f.next(_);for(he.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(D[w]){case"L":he.write_shift(1,m[g][w]==null?63:m[g][w]?84:70);break;case"B":he.write_shift(8,m[g][w]||0,"f");break;case"N":var ke="0";for(typeof m[g][w]=="number"&&(ke=m[g][w].toFixed(B[w]||0)),T=0;T<z[w]-ke.length;++T)he.write_shift(1,32);he.write_shift(1,ke,"sbcs");break;case"D":m[g][w]?(he.write_shift(4,("0000"+m[g][w].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(m[g][w].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+m[g][w].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(m[g][w]!=null?m[g][w]:"").slice(0,z[w]);for(he.write_shift(1,ve,"sbcs"),T=0;T<z[w]-ve.length;++T)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),hF=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ks(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var x=t[m];return typeof x=="number"?Pv(x):x},n=function(d,m,x){var g=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?d:Pv(g)};t["|"]=254;function s(d,m){switch(m.type){case"base64":return i(En(d),m);case"binary":return i(d,m);case"buffer":return i(Ye&&Buffer.isBuffer(d)?d.toString("binary"):$a(d),m);case"array":return i(Fa(d),m)}throw new Error("Unrecognized type "+m.type)}function i(d,m){var x=d.split(/[\n\r]+/),g=-1,w=-1,T=0,_=0,v=[],D=[],z=null,B={},y=[],A=[],k=[],C=0,R;for(+m.codepage>=0&&Xn(+m.codepage);T!==x.length;++T){C=0;var N=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=N.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),Ee=F[0],he;if(N.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&D.push(N.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,ve=!1,ae=!1,W=!1,le=-1,we=-1;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"A":break;case"X":w=parseInt(F[_].slice(1))-1,ve=!0;break;case"Y":for(g=parseInt(F[_].slice(1))-1,ve||(w=0),R=v.length;R<=g;++R)v[R]=[];break;case"K":he=F[_].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(es(he))?isNaN(Ko(he).getDate())||(he=cr(he)):(he=es(he),z!==null&&il(z)&&(he=s0(he))),ke=!0;break;case"E":W=!0;var L=Do(F[_].slice(1),{r:g,c:w});v[g][w]=[v[g][w],L];break;case"S":ae=!0,v[g][w]=[v[g][w],"S5S"];break;case"G":break;case"R":le=parseInt(F[_].slice(1))-1;break;case"C":we=parseInt(F[_].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}if(ke&&(v[g][w]&&v[g][w].length==2?v[g][w][0]=he:v[g][w]=he,z=null),ae){if(W)throw new Error("SYLK shared formula cannot have own formula");var K=le>-1&&v[le][we];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");v[g][w][1]=XT(K[1],{r:g-le,c:w-we})}break;case"F":var G=0;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"X":w=parseInt(F[_].slice(1))-1,++G;break;case"Y":for(g=parseInt(F[_].slice(1))-1,R=v.length;R<=g;++R)v[R]=[];break;case"M":C=parseInt(F[_].slice(1))/20;break;case"F":break;case"G":break;case"P":z=D[parseInt(F[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=F[_].slice(1).split(" "),R=parseInt(k[0],10);R<=parseInt(k[1],10);++R)C=parseInt(k[2],10),A[R-1]=C===0?{hidden:!0}:{wch:C},qo(A[R-1]);break;case"C":w=parseInt(F[_].slice(1))-1,A[w]||(A[w]={});break;case"R":g=parseInt(F[_].slice(1))-1,y[g]||(y[g]={}),C>0?(y[g].hpt=C,y[g].hpx=Bc(C)):C===0&&(y[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}G<1&&(z=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}}return y.length>0&&(B["!rows"]=y),A.length>0&&(B["!cols"]=A),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,B]}function a(d,m){var x=s(d,m),g=x[0],w=x[1],T=ol(g,m);return ks(w).forEach(function(_){T[_]=w[_]}),T}function o(d,m){return ra(a(d,m),m)}function l(d,m,x,g){var w="C;Y"+(x+1)+";X"+(g+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+JD(d.f,{r:x,c:g}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(d,m){m.forEach(function(x,g){var w="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=gh(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=xh(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function f(d,m){m.forEach(function(x,g){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*GT(x.hpx)+";"),w.length>2&&d.push(w+"R"+(g+1))})}function h(d,m){var x=["ID;PWXL;N;E"],g=[],w=Mt(d["!ref"]),T,_=Array.isArray(d),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&f(x,d["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var D=w.s.r;D<=w.e.r;++D)for(var z=w.s.c;z<=w.e.c;++z){var B=Me({r:D,c:z});T=_?(d[D]||[])[z]:d[B],!(!T||T.v==null&&(!T.f||T.F))&&g.push(l(T,d,D,z))}return x.join(v)+v+g.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),dF=function(){function t(i,a){switch(a.type){case"base64":return e(En(i),a);case"binary":return e(i,a);case"buffer":return e(Ye&&Buffer.isBuffer(i)?i.toString("binary"):$a(i),a);case"array":return e(Fa(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),m=d[0],x=d[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(es(x))?isNaN(Ko(x).getDate())?h[l][c]=x:h[l][c]=cr(x):h[l][c]=es(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return ol(t(i,a),a)}function n(i,a){return ra(r(i,a),a)}var s=function(){var i=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=Mt(l["!ref"]),h,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,f.e.r-f.s.r+1,""),i(c,"TUPLES",0,f.e.c-f.s.c+1,""),i(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(c,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var g=Me({r:m,c:x});if(h=d?(l[m]||[])[x]:l[g],!h){a(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Vn(h.z||ze[14],qr(cr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,_=c.join(T);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),pF=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),x=-1,g=-1,w=0,T=[];w!==m.length;++w){var _=m[w].trim().split(":");if(_[0]==="cell"){var v=Wr(_[1]);if(T.length<=v.r)for(x=T.length;x<=v.r;++x)T[x]||(T[x]=[]);switch(x=v.r,g=v.c,_[2]){case"t":T[x][g]=t(_[3]);break;case"v":T[x][g]=+_[3];break;case"vtf":var D=_[_.length-1];case"vtc":switch(_[3]){case"nl":T[x][g]=!!+_[4];break;default:T[x][g]=+_[4];break}_[2]=="vtf"&&(T[x][g]=[T[x][g],D])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return ol(r(h,d),d)}function s(h,d){return ra(n(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],x,g="",w=al(h["!ref"]),T=Array.isArray(h),_=w.s.r;_<=w.e.r;++_)for(var v=w.s.c;v<=w.e.c;++v)if(g=Me({r:_,c:v}),x=T?(h[_]||[])[v]:h[g],!(!x||x.v==null||x.t==="z")){switch(m=["cell",g,"t"],x.t){case"s":case"str":m.push(e(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=e(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var D=qr(cr(x.v));m[2]="vtc",m[3]="nd",m[4]=""+D,m[5]=x.w||Vn(x.z||ze[14],D);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[i,a,o,a,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),Vc=function(){function t(f,h,d,m,x){x.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(es(f))?isNaN(Ko(f).getDate())?h[d][m]=f:h[d][m]=cr(f):h[d][m]=es(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var w=10,T=0,_=0;_<=g;++_)T=x[_].indexOf(" "),T==-1?T=x[_].length:T++,w=Math.max(w,T);for(_=0;_<=g;++_){m[_]=[];var v=0;for(t(x[_].slice(0,w).trim(),m,_,v,d),v=1;v<=(x[_].length-w)/10+1;++v)t(x[_].slice(w+(v-1)*10,w+v*10).trim(),m,_,v,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},d=!1,m=0,x=0;m<f.length;++m)(x=f.charCodeAt(m))==34?d=!d:!d&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m]);if(!x.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m])}return x.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[x.pop()[1]]||44}function i(f,h){var d=h||{},m="",x=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):d&&d.FS?m=d.FS:m=s(f.slice(0,1024));var w=0,T=0,_=0,v=0,D=0,z=m.charCodeAt(0),B=!1,y=0,A=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?k3(d.dateNF):null;function C(){var R=f.slice(v,D),N={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)N.t="z";else if(d.raw)N.t="s",N.v=R;else if(R.trim().length===0)N.t="s",N.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(N.t="s",N.v=R.slice(2,-1).replace(/""/g,'"')):e6(R)?(N.t="n",N.f=R.slice(1)):(N.t="s",N.v=R);else if(R=="TRUE")N.t="b",N.v=!0;else if(R=="FALSE")N.t="b",N.v=!1;else if(!isNaN(_=es(R)))N.t="n",d.cellText!==!1&&(N.w=R),N.v=_;else if(!isNaN(Ko(R).getDate())||k&&R.match(k)){N.z=d.dateNF||ze[14];var F=0;k&&R.match(k)&&(R=S3(R,d.dateNF,R.match(k)||[]),F=1),d.cellDates?(N.t="d",N.v=cr(R,F)):(N.t="n",N.v=qr(cr(R,F))),d.cellText!==!1&&(N.w=Vn(N.z,N.v instanceof Date?qr(N.v):N.v)),d.cellNF||delete N.z}else N.t="s",N.v=R;if(N.t=="z"||(d.dense?(x[w]||(x[w]=[]),x[w][T]=N):x[Me({c:T,r:w})]=N),v=D+1,A=f.charCodeAt(v),g.e.c<T&&(g.e.c=T),g.e.r<w&&(g.e.r=w),y==z)++T;else if(T=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;D<f.length;++D)switch(y=f.charCodeAt(D)){case 34:A===34&&(B=!B);break;case z:case 10:case 13:if(!B&&C())break e;break}return D-v>0&&C(),x["!ref"]=tt(g),x}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):ol(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:Vg(f,h);switch(h.type){case"base64":d=En(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Oc<"u"||(d=Ye&&Buffer.isBuffer(f)?f.toString("binary"):$a(f));break;case"array":d=Fa(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=_t(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=_t(d):h.type=="binary"&&typeof Oc<"u",d.slice(0,19)=="socialcalc:version:"?pF.to_sheet(h.type=="string"?d:_t(d),h):a(d,h)}function l(f,h){return ra(o(f,h),h)}function c(f){for(var h=[],d=Mt(f["!ref"]),m,x=Array.isArray(f),g=d.s.r;g<=d.e.r;++g){for(var w=[],T=d.s.c;T<=d.e.c;++T){var _=Me({r:g,c:T});if(m=x?(f[g]||[])[T]:f[_],!m||m.v==null){w.push("          ");continue}for(var v=(m.w||(Qs(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";w.push(v+(T===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function mF(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=hF.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Vc.to_workbook(t,e)}}var ac=function(){function t(L,K,G){if(L){pr(L,L.l||0);for(var H=G.Enum||le;L.l<L.length;){var te=L.read_shift(2),fe=H[te]||H[65535],xe=L.read_shift(2),de=L.l+xe,ie=fe.f&&fe.f(L,xe,G);if(L.l=de,K(ie,fe,te))return}}}function e(L,K){switch(K.type){case"base64":return r(qn(En(L)),K);case"binary":return r(qn(L),K);case"buffer":case"array":return r(L,K)}throw"Unsupported type "+K.type}function r(L,K){if(!L)return L;var G=K||{},H=G.dense?[]:{},te="Sheet1",fe="",xe=0,de={},ie=[],Ue=[],j={s:{r:0,c:0},e:{r:0,c:0}},ht=G.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)G.Enum=le,t(L,function(ge,gt,ur){switch(ur){case 0:G.vers=ge,ge>=4096&&(G.qpro=!0);break;case 6:j=ge;break;case 204:ge&&(fe=ge);break;case 222:fe=ge;break;case 15:case 51:G.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:ur==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=G.dateNF||ze[14],G.cellDates&&(ge[1].t="d",ge[1].v=s0(ge[1].v))),G.qpro&&ge[3]>xe&&(H["!ref"]=tt(j),de[te]=H,ie.push(te),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},xe=ge[3],te=fe||"Sheet"+(xe+1),fe="");var Er=G.dense?(H[ge[0].r]||[])[ge[0].c]:H[Me(ge[0])];if(Er){Er.t=ge[1].t,Er.v=ge[1].v,ge[1].z!=null&&(Er.z=ge[1].z),ge[1].f!=null&&(Er.f=ge[1].f);break}G.dense?(H[ge[0].r]||(H[ge[0].r]=[]),H[ge[0].r][ge[0].c]=ge[1]):H[Me(ge[0])]=ge[1];break}},G);else if(L[2]==26||L[2]==14)G.Enum=we,L[2]==14&&(G.qpro=!0,L.l=0),t(L,function(ge,gt,ur){switch(ur){case 204:te=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>xe&&(H["!ref"]=tt(j),de[te]=H,ie.push(te),H=G.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},xe=ge[3],te="Sheet"+(xe+1)),ht>0&&ge[0].r>=ht)break;G.dense?(H[ge[0].r]||(H[ge[0].r]=[]),H[ge[0].r][ge[0].c]=ge[1]):H[Me(ge[0])]=ge[1],j.e.c<ge[0].c&&(j.e.c=ge[0].c),j.e.r<ge[0].r&&(j.e.r=ge[0].r);break;case 27:ge[14e3]&&(Ue[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Ue[ge[0]]=ge[1],ge[0]==xe&&(te=ge[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(H["!ref"]=tt(j),de[fe||te]=H,ie.push(fe||te),!Ue.length)return{SheetNames:ie,Sheets:de};for(var $e={},Ge=[],Be=0;Be<Ue.length;++Be)de[ie[Be]]?(Ge.push(Ue[Be]||ie[Be]),$e[Ue[Be]]=de[Ue[Be]]||de[ie[Be]]):(Ge.push(Ue[Be]),$e[Ue[Be]]={"!ref":"A1"});return{SheetNames:Ge,Sheets:$e}}function n(L,K){var G=K||{};if(+G.codepage>=0&&Xn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Op(),te=Mt(L["!ref"]),fe=Array.isArray(L),xe=[];Hn(H,0,i(1030)),Hn(H,6,l(te));for(var de=Math.min(te.e.r,8191),ie=te.s.r;ie<=de;++ie)for(var Ue=vr(ie),j=te.s.c;j<=te.e.c;++j){ie===te.s.r&&(xe[j]=rr(j));var ht=xe[j]+Ue,$e=fe?(L[ie]||[])[j]:L[ht];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Hn(H,13,m(ie,j,$e.v)):Hn(H,14,g(ie,j,$e.v));else{var Ge=Qs($e);Hn(H,15,h(ie,j,Ge.slice(0,239)))}}return Hn(H,1),H.end()}function s(L,K){var G=K||{};if(+G.codepage>=0&&Xn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Op();Hn(H,0,a(L));for(var te=0,fe=0;te<L.SheetNames.length;++te)(L.Sheets[L.SheetNames[te]]||{})["!ref"]&&Hn(H,27,W(L.SheetNames[te],fe++));var xe=0;for(te=0;te<L.SheetNames.length;++te){var de=L.Sheets[L.SheetNames[te]];if(!(!de||!de["!ref"])){for(var ie=Mt(de["!ref"]),Ue=Array.isArray(de),j=[],ht=Math.min(ie.e.r,8191),$e=ie.s.r;$e<=ht;++$e)for(var Ge=vr($e),Be=ie.s.c;Be<=ie.e.c;++Be){$e===ie.s.r&&(j[Be]=rr(Be));var ge=j[Be]+Ge,gt=Ue?(de[$e]||[])[Be]:de[ge];if(!(!gt||gt.t=="z"))if(gt.t=="n")Hn(H,23,C($e,Be,xe,gt.v));else{var ur=Qs(gt);Hn(H,22,y($e,Be,xe,ur.slice(0,239)))}}++xe}}return Hn(H,1),H.end()}function i(L){var K=Zt(2);return K.write_shift(2,L),K}function a(L){var K=Zt(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var G=0,H=0,te=0,fe=0;fe<L.SheetNames.length;++fe){var xe=L.SheetNames[fe],de=L.Sheets[xe];if(!(!de||!de["!ref"])){++te;var ie=al(de["!ref"]);G<ie.e.r&&(G=ie.e.r),H<ie.e.c&&(H=ie.e.c)}}return G>8191&&(G=8191),K.write_shift(2,G),K.write_shift(1,te),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(L,K,G){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&G.qpro?(H.s.c=L.read_shift(1),L.l++,H.s.r=L.read_shift(2),H.e.c=L.read_shift(1),L.l++,H.e.r=L.read_shift(2),H):(H.s.c=L.read_shift(2),H.s.r=L.read_shift(2),K==12&&G.qpro&&(L.l+=2),H.e.c=L.read_shift(2),H.e.r=L.read_shift(2),K==12&&G.qpro&&(L.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function l(L){var K=Zt(8);return K.write_shift(2,L.s.c),K.write_shift(2,L.s.r),K.write_shift(2,L.e.c),K.write_shift(2,L.e.r),K}function c(L,K,G){var H=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(H[0].c=L.read_shift(1),H[3]=L.read_shift(1),H[0].r=L.read_shift(2),L.l+=2):(H[2]=L.read_shift(1),H[0].c=L.read_shift(2),H[0].r=L.read_shift(2)),H}function f(L,K,G){var H=L.l+K,te=c(L,K,G);if(te[1].t="s",G.vers==20768){L.l++;var fe=L.read_shift(1);return te[1].v=L.read_shift(fe,"utf8"),te}return G.qpro&&L.l++,te[1].v=L.read_shift(H-L.l,"cstr"),te}function h(L,K,G){var H=Zt(7+G.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(1,39);for(var te=0;te<H.length;++te){var fe=G.charCodeAt(te);H.write_shift(1,fe>=128?95:fe)}return H.write_shift(1,0),H}function d(L,K,G){var H=c(L,K,G);return H[1].v=L.read_shift(2,"i"),H}function m(L,K,G){var H=Zt(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(2,G,"i"),H}function x(L,K,G){var H=c(L,K,G);return H[1].v=L.read_shift(8,"f"),H}function g(L,K,G){var H=Zt(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,L),H.write_shift(8,G,"f"),H}function w(L,K,G){var H=L.l+K,te=c(L,K,G);if(te[1].v=L.read_shift(8,"f"),G.qpro)L.l=H;else{var fe=L.read_shift(2);D(L.slice(L.l,L.l+fe),te),L.l+=fe}return te}function T(L,K,G){var H=K&32768;return K&=-32769,K=(H?L:0)+(K>=8192?K-16384:K),(H?"":"$")+(G?rr(K):vr(K))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(L,K){pr(L,0);for(var G=[],H=0,te="",fe="",xe="",de="";L.l<L.length;){var ie=L[L.l++];switch(ie){case 0:G.push(L.read_shift(8,"f"));break;case 1:fe=T(K[0].c,L.read_shift(2),!0),te=T(K[0].r,L.read_shift(2),!1),G.push(fe+te);break;case 2:{var Ue=T(K[0].c,L.read_shift(2),!0),j=T(K[0].r,L.read_shift(2),!1);fe=T(K[0].c,L.read_shift(2),!0),te=T(K[0].r,L.read_shift(2),!1),G.push(Ue+j+":"+fe+te)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(L.read_shift(2));break;case 6:{for(var ht="";ie=L[L.l++];)ht+=String.fromCharCode(ie);G.push('"'+ht.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:de=G.pop(),xe=G.pop(),G.push(["AND","OR"][ie-20]+"("+xe+","+de+")");break;default:if(ie<32&&v[ie])de=G.pop(),xe=G.pop(),G.push(xe+v[ie]+de);else if(_[ie]){if(H=_[ie][1],H==69&&(H=L[L.l++]),H>G.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+G.join("|")+"|");return}var $e=G.slice(-H);G.length-=H,G.push(_[ie][0]+"("+$e.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}G.length==1?K[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function z(L){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=L.read_shift(2),K[3]=L[L.l++],K[0].c=L[L.l++],K}function B(L,K){var G=z(L);return G[1].t="s",G[1].v=L.read_shift(K-4,"cstr"),G}function y(L,K,G,H){var te=Zt(6+H.length);te.write_shift(2,L),te.write_shift(1,G),te.write_shift(1,K),te.write_shift(1,39);for(var fe=0;fe<H.length;++fe){var xe=H.charCodeAt(fe);te.write_shift(1,xe>=128?95:xe)}return te.write_shift(1,0),te}function A(L,K){var G=z(L);G[1].v=L.read_shift(2);var H=G[1].v>>1;if(G[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return G[1].v=H,G}function k(L,K){var G=z(L),H=L.read_shift(4),te=L.read_shift(4),fe=L.read_shift(2);if(fe==65535)return H===0&&te===3221225472?(G[1].t="e",G[1].v=15):H===0&&te===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var xe=fe&32768;return fe=(fe&32767)-16446,G[1].v=(1-xe*2)*(te*Math.pow(2,fe+32)+H*Math.pow(2,fe)),G}function C(L,K,G,H){var te=Zt(14);if(te.write_shift(2,L),te.write_shift(1,G),te.write_shift(1,K),H==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var fe=0,xe=0,de=0,ie=0;return H<0&&(fe=1,H=-H),xe=Math.log2(H)|0,H/=Math.pow(2,xe-31),ie=H>>>0,ie&2147483648||(H/=2,++xe,ie=H>>>0),H-=ie,ie|=2147483648,ie>>>=0,H*=Math.pow(2,32),de=H>>>0,te.write_shift(4,de),te.write_shift(4,ie),xe+=16383+(fe?32768:0),te.write_shift(2,xe),te}function R(L,K){var G=k(L);return L.l+=K-14,G}function N(L,K){var G=z(L),H=L.read_shift(4);return G[1].v=H>>6,G}function F(L,K){var G=z(L),H=L.read_shift(8,"f");return G[1].v=H,G}function Ee(L,K){var G=F(L);return L.l+=K-10,G}function he(L,K){return L[L.l+K-1]==0?L.read_shift(K,"cstr"):""}function ke(L,K){var G=L[L.l++];G>K-1&&(G=K-1);for(var H="";H.length<G;)H+=String.fromCharCode(L[L.l++]);return H}function ve(L,K,G){if(!(!G.qpro||K<21)){var H=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var te=L.read_shift(K-21,"cstr");return[H,te]}}function ae(L,K){for(var G={},H=L.l+K;L.l<H;){var te=L.read_shift(2);if(te==14e3){for(G[te]=[0,""],G[te][0]=L.read_shift(2);L[L.l];)G[te][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return G}function W(L,K){var G=Zt(5+L.length);G.write_shift(2,14e3),G.write_shift(2,K);for(var H=0;H<L.length;++H){var te=L.charCodeAt(H);G[G.l++]=te>127?95:te}return G[G.l++]=0,G}var le={0:{n:"BOF",f:qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function gF(t){var e={},r=t.match(Ur),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=De(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=pg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var xF=function(){var t=Lc("t"),e=Lc("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:st(a[1])},l=i.match(e);return l&&(o.s=gF(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),vF=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),_F=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yF=/<(?:\w+:)?r>/,EF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(_t(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=_t(t),r&&(n.h=Eg(n.t))):t.match(yF)&&(n.r=_t(t),n.t=st(_t((t.replace(EF,"").match(_F)||[]).join("").replace(Ur,""))),r&&(n.h=vF(xF(n.r)))),n):{t:""}}var wF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,TF=/<(?:\w+:)?(?:si|sstItem)>/g,AF=/<\/(?:\w+:)?(?:si|sstItem)>/;function kF(t,e){var r=[],n="";if(!t)return r;var s=t.match(wF);if(s){n=s[2].replace(TF,"").split(AF);for(var i=0;i!=n.length;++i){var a=Pg(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=De(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function SF(t){return[t.read_shift(4),t.read_shift(4)]}function IF(t,e){var r=[],n=!1;return ni(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function BT(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Hs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function CF(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Hs(t,4),e.U=Hs(t,4),e.W=Hs(t,4),e}function RF(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function NF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(RF(t));return e}function PF(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function FF(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Hs(t,4),e.U=Hs(t,4),e.W=Hs(t,4),e}function DF(t){var e=FF(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function jT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function zT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function OF(t){var e=Hs(t);switch(e.Minor){case 2:return[e.Minor,bF(t)];case 3:return[e.Minor,LF()];case 4:return[e.Minor,MF(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function bF(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=jT(t,r),s=zT(t,t.length-t.l);return{t:"Std",h:n,v:s}}function LF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function MF(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Ur,function(i){var a=De(i);switch(Cs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function VF(t,e){var r={},n=r.EncryptionVersionInfo=Hs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=jT(t,s),e-=s,r.EncryptionVerifier=zT(t,e),r}function UF(t){var e={},r=e.EncryptionVersionInfo=Hs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function BF(t){var e=0,r,n=BT(t),s=n.length+1,i,a,o,l,c;for(r=Hi(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var $T=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=BT(a),l=i(o),c=o.length,f=Hi(16),h=0;h!=16;++h)f[h]=0;var d,m,x;for((c&1)===1&&(d=l>>8,f[c]=s(t[0],d),--c,d=l&255,m=o[o.length-1],f[c]=s(m,d));c>0;)--c,d=l>>8,f[c]=s(o[c],d),--c,d=l&255,f[c]=s(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,f[c]=s(t[x],d),--c,--x,d=l&255,f[c]=s(o[c],d),--c,--x;return f}}(),jF=function(t,e,r,n,s){s||(s=e),n||(n=$T(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},zF=function(t){var e=0,r=$T(t);return function(n){var s=jF("",n,e,r);return e=s[1],s[0]}};function $F(t,e,r,n){var s={key:qt(t),verificationBytes:qt(t)};return r.password&&(s.verifier=BF(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=zF(r.password)),s}function HF(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=UF(t):n.Data=VF(t,e),n}function WF(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?HF(t,e-2,n):$F(t,r.biff>=8?e:e-2,r,n),n}var GF=function(){function t(s,i){switch(i.type){case"base64":return e(En(s),i);case"binary":return e(s,i);case"buffer":return e(Ye&&Buffer.isBuffer(s)?s.toString("binary"):$a(s),i);case"array":return e(Fa(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,x,g=-1;x=d.exec(f);){switch(x[0]){case"\\cell":var w=f.slice(m,d.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[h][g]=T:o[Me({r:h,c:g})]=T}break}m=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=tt(c),o}function r(s,i){return ra(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Mt(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Me({r:c,c:f});o=l?(s[c]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Qs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function KF(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Uc(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function qF(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function XF(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function mh(t,e){if(e===0)return t;var r=qF(KF(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Uc(XF(r))}var HT=6,YF=15,QF=1,Hr=HT;function gh(t){return Math.floor((t+Math.round(128/Hr)/256)*Hr)}function xh(t){return Math.floor((t-5)/Hr*100+.5)/100}function Vp(t){return Math.round((t*Hr+5)/Hr*256)/256}function vd(t){return Vp(xh(gh(t)))}function Fg(t){var e=Math.abs(t-vd(t)),r=Hr;if(e>.005)for(Hr=QF;Hr<YF;++Hr)Math.abs(t-vd(t))<=e&&(e=Math.abs(t-vd(t)),r=Hr);Hr=r}function qo(t){t.width?(t.wpx=gh(t.width),t.wch=xh(t.wpx),t.MDW=Hr):t.wpx?(t.wch=xh(t.wpx),t.width=Vp(t.wch),t.MDW=Hr):typeof t.wch=="number"&&(t.width=Vp(t.wch),t.wpx=gh(t.width),t.MDW=Hr),t.customWidth&&delete t.customWidth}var JF=96,WT=JF;function GT(t){return t*96/WT}function Bc(t){return t*WT/96}var ZF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eD(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Ur)||[]).forEach(function(a){var o=De(a);switch(Cs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=It(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=It(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function tD(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Ur)||[]).forEach(function(a){var o=De(a);switch(Cs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function rD(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Ur)||[]).forEach(function(a){var o=De(a);switch(Cs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=_t(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?It(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?It(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?It(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?It(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?It(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?It(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?It(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=pg[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=It(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Aa[s.color.index];s.color.index==81&&(l=Aa[1]),l||(l=Aa[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=mh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function nD(t,e,r){e.NumberFmt=[];for(var n=ks(ze),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ze[n[s]];var i=t[0].match(Ur);if(i)for(s=0;s<i.length;++s){var a=De(i[s]);switch(Cs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(_t(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Ta(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var tf=["numFmtId","fillId","fontId","borderId","xfId"],rf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function sD(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Ur)||[]).forEach(function(i){var a=De(i),o=0;switch(Cs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<tf.length;++o)n[tf[o]]&&(n[tf[o]]=parseInt(n[tf[o]],10));for(o=0;o<rf.length;++o)n[rf[o]]&&(n[rf[o]]=It(n[rf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=It(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var iD=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&nD(h,f,c),(h=o.match(s))&&rD(h,f,l,c),(h=o.match(n))&&tD(h,f,l,c),(h=o.match(i))&&eD(h,f,l,c),(h=o.match(r))&&sD(h,f,c),f}}();function aD(t,e){var r=t.read_shift(2),n=br(t);return[r,n]}function oD(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=xN(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=gN(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=br(t),n}var lD=Mr;function cD(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var uD=Mr;function fD(t,e,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return ni(t,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Ta(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=mh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(f),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(f);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var hD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dD(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Ur)||[]).forEach(function(s){var i=De(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[hD.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function pD(){}function mD(){}var gD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,xD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function _D(t,e,r){e.themeElements={};var n;[["clrScheme",gD,dD],["fontScheme",xD,pD],["fmtScheme",vD,mD]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var yD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function KT(t,e){(!t||t.length===0)&&(t=ED());var r,n={};if(!(r=t.match(yD)))throw new Error("themeElements not found in theme");return _D(r[0],n,e),n.raw=t,n}function ED(t,e){var r=[sT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wD(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=nT(i,{type:"array"})}catch{return}var o=mn(a,"theme/theme/theme1.xml",!0);if(o)return KT(o,r)}}function TD(t){return t.read_shift(4)}function AD(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kD(t,4);break;case 2:e.xclrValue=DT(t);break;case 3:e.xclrValue=TD(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kD(t,e){return Mr(t,e)}function SD(t,e){return Mr(t,e)}function ID(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=AD(t);break;case 6:n[1]=SD(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function CD(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(ID(t,r-t.l));return{ixfe:n,ext:i}}function RD(t,e){e.forEach(function(r){switch(r[0]){}})}function ND(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:br(t)}}function PD(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function FD(t){return t.l+=4,t.read_shift(4)!=0}function DD(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return ni(t,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(f),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function OD(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Ur,function(o){var l=De(o);switch(Cs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function bD(t){var e=[];if(!t)return e;var r=1;return(t.match(Ur)||[]).forEach(function(n){var s=De(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function LD(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Me(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function MD(t,e,r){var n=[];return ni(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function VD(t,e,r,n){if(!t)return t;var s=n||{},i=!1;ni(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function UD(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function g_(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Wr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Mt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=tt(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}i.c.push(f)})}function BD(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=De(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Wr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Pg(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function jD(t,e){var r=[],n=!1,s={},i=0;return t.replace(Ur,function(o,l){var c=De(o);switch(Cs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function zD(t,e){var r=[],n=!1;return t.replace(Ur,function(i){var a=De(i);switch(Cs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function $D(t){var e={};e.iauthor=t.read_shift(4);var r=Wa(t);return e.rfx=r.s,e.ref=Me(r.s),t.l+=16,e}var HD=br;function WD(t,e){var r=[],n=[],s={},i=!1;return ni(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var GD="application/vnd.ms-office.vbaProject";function KD(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,s,t.FileIndex[n].content)}}),et.write(e)}function qD(){return{"!type":"dialog"}}function XD(){return{"!type":"dialog"}}function YD(){return{"!type":"macro"}}function QD(){return{"!type":"macro"}}var Do=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,s+(o?"":"$")+rr(f)+(l?"":"$")+vr(c)}return function(s,i){return e=i,s.replace(t,r)}}(),qT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,JD=function(){return function(e,r){return e.replace(qT,function(n,s,i,a,o,l){var c=kg(a)-(i?0:r.c),f=Ag(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":i?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function XT(t,e){return t.replace(qT,function(r,n,s,i,a,o){return n+(s=="$"?s+i:rr(kg(i)+e.c))+(a=="$"?a+o:vr(Ag(o)+e.r))})}function ZD(t,e,r){var n=al(e),s=n.s,i=Wr(r),a={r:i.r-s.r,c:i.c-s.c};return XT(t,a)}function e6(t){return t.length!=1}function x_(t){return t.replace(/_xlfn\./g,"")}function Wt(t){t.l+=1}function Wi(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function YT(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return QT(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Wi(t),o=Wi(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function QT(t){var e=Wi(t),r=Wi(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function t6(t,e,r){if(r.biff<8)return QT(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Wi(t),a=Wi(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function JT(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return r6(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Wi(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function r6(t){var e=Wi(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function n6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function s6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return i6(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function i6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function a6(t,e,r){var n=(t[t.l++]&96)>>5,s=YT(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function o6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=YT(t,i,r);return[n,s,a]}function l6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function c6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function u6(t,e,r){var n=(t[t.l++]&96)>>5,s=t6(t,e-1,r);return[n,s]}function f6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function h6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function d6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function p6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function m6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function g6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function ZT(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function x6(t){return t.read_shift(2),ZT(t)}function v6(t){return t.read_shift(2),ZT(t)}function _6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=JT(t,0,r);return[n,s]}function y6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=s6(t,0,r);return[n,s]}function E6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=JT(t,0,r);return[n,s,i]}function w6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[TO[s],rA[s],n]}function T6(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:A6(t);return[s,(i[0]===0?rA:wO)[i[1]]]}function A6(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function k6(t,e,r){t.l+=r&&r.biff==2?3:4}function S6(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function I6(t){return t.l++,Ga[t.read_shift(1)]}function C6(t){return t.l++,t.read_shift(2)}function R6(t){return t.l++,t.read_shift(1)!==0}function N6(t){return t.l++,Dr(t)}function P6(t,e,r){return t.l++,su(t,e-1,r)}function F6(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ut(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ga[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Dr(t);break;case 2:r[1]=Ka(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function D6(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Wa:i0)(t));return s}function O6(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=F6(t,r.biff);return a}function b6(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function L6(t,e,r){if(r.biff==5)return M6(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function M6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function V6(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function U6(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function B6(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function j6(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var z6=Mr,$6=Mr,H6=Mr;function au(t,e,r){return t.l+=2,[n6(t)]}function Dg(t){return t.l+=6,[]}var W6=au,G6=Dg,K6=Dg,q6=au;function eA(t){return t.l+=2,[qt(t),t.read_shift(2)&1]}var X6=au,Y6=eA,Q6=Dg,J6=au,Z6=au,eO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tO(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=eO[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function rO(t){return t.l+=2,[t.read_shift(4)]}function nO(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function sO(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iO(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function aO(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function oO(t){return t.l+=4,[0,0]}var __={1:{n:"PtgExp",f:S6},2:{n:"PtgTbl",f:H6},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:P6},26:{n:"PtgSheet",f:nO},27:{n:"PtgEndSheet",f:sO},28:{n:"PtgErr",f:I6},29:{n:"PtgBool",f:R6},30:{n:"PtgInt",f:C6},31:{n:"PtgNum",f:N6},32:{n:"PtgArray",f:f6},33:{n:"PtgFunc",f:w6},34:{n:"PtgFuncVar",f:T6},35:{n:"PtgName",f:b6},36:{n:"PtgRef",f:_6},37:{n:"PtgArea",f:a6},38:{n:"PtgMemArea",f:V6},39:{n:"PtgMemErr",f:z6},40:{n:"PtgMemNoMem",f:$6},41:{n:"PtgMemFunc",f:U6},42:{n:"PtgRefErr",f:B6},43:{n:"PtgAreaErr",f:l6},44:{n:"PtgRefN",f:y6},45:{n:"PtgAreaN",f:u6},46:{n:"PtgMemAreaN",f:iO},47:{n:"PtgMemNoMemN",f:aO},57:{n:"PtgNameX",f:L6},58:{n:"PtgRef3d",f:E6},59:{n:"PtgArea3d",f:o6},60:{n:"PtgRefErr3d",f:j6},61:{n:"PtgAreaErr3d",f:c6},255:{}},lO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cO={1:{n:"PtgElfLel",f:eA},2:{n:"PtgElfRw",f:J6},3:{n:"PtgElfCol",f:W6},6:{n:"PtgElfRwV",f:Z6},7:{n:"PtgElfColV",f:q6},10:{n:"PtgElfRadical",f:X6},11:{n:"PtgElfRadicalS",f:Q6},13:{n:"PtgElfColS",f:G6},15:{n:"PtgElfColSV",f:K6},16:{n:"PtgElfRadicalLel",f:Y6},25:{n:"PtgList",f:tO},29:{n:"PtgSxName",f:rO},255:{}},uO={0:{n:"PtgAttrNoop",f:oO},1:{n:"PtgAttrSemi",f:g6},2:{n:"PtgAttrIf",f:p6},4:{n:"PtgAttrChoose",f:h6},8:{n:"PtgAttrGoto",f:d6},16:{n:"PtgAttrSum",f:k6},32:{n:"PtgAttrBaxcel",f:v_},33:{n:"PtgAttrBaxcel",f:v_},64:{n:"PtgAttrSpace",f:x6},65:{n:"PtgAttrSpaceSemi",f:v6},128:{n:"PtgAttrIfError",f:m6},255:{}};function ou(t,e,r,n){if(n.biff<8)return Mr(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=O6(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=D6(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Mr(t,e)),i}function lu(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=__[i]||__[lO[i]],(i===24||i===25)&&(s=(i===24?cO:uO)[t[t.l+1]]),!s||!s.f?Mr(t,e):a.push([s.n,s.f(t,e,r)]);return a}function fO(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var hO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dO(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function tA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y_(t,e,r){var n=tA(t,e,r);return n=="#REF"?n:dO(n,r)}function Nr(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,m,x="";if(!t[0]||!t[0][0])return"";for(var g=-1,w="",T=0,_=t[0].length;T<_;++T){var v=t[0][T];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:w=Lt(" ",t[0][g][1][1]);break;case 1:w=Lt("\r",t[0][g][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+w,g=-1}o.push(c+hO[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=rc(v[1][1],a,s),o.push(nc(f,i));break;case"PtgRefN":f=r?rc(v[1][1],r,s):v[1][1],o.push(nc(f,i));break;case"PtgRef3d":h=v[1][1],f=rc(v[1][2],a,s),x=y_(n,h,s),o.push(x+"!"+nc(f,i));break;case"PtgFunc":case"PtgFuncVar":var D=v[1][0],z=v[1][1];D||(D=0),D&=127;var B=D==0?[]:o.slice(-D);o.length-=D,z==="User"&&(z=B.shift()),o.push(z+"("+B.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":m=e_(v[1][1],r?{s:r}:a,s),o.push(gd(m,s));break;case"PtgArea":m=e_(v[1][1],a,s),o.push(gd(m,s));break;case"PtgArea3d":h=v[1][1],m=v[1][2],x=y_(n,h,s),o.push(x+"!"+gd(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],A=y?y.Name:"SH33TJSNAME"+String(d);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var k=v[1][1];d=v[1][2];var C;if(s.biff<=5)k<0&&(k=-k),n[k]&&(C=n[k][d]);else{var R="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(R=n.SheetNames[n[k][d].itab-1]+"!"):R=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])R+=n[k][d].Name;else if(n[0]&&n[0][d])R+=n[0][d].Name;else{var N=(tA(n,k,s)||"").split(";;");N[d-1]?R=N[d-1]:R+="SH33TJSERRX"}o.push(R);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var F="(",Ee=")";if(g>=0){switch(w="",t[0][g][1][0]){case 2:F=Lt(" ",t[0][g][1][1])+F;break;case 3:F=Lt("\r",t[0][g][1][1])+F;break;case 4:Ee=Lt(" ",t[0][g][1][1])+Ee;break;case 5:Ee=Lt("\r",t[0][g][1][1])+Ee;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(F+o.pop()+Ee);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Me(f)]){var ke=n.sharedf[Me(f)];o.push(Nr(ke,a,he,n,s))}else{var ve=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Nr(c[1],a,he,n,s)),ve=!0;break}ve||o.push(v[1])}break;case"PtgArray":o.push("{"+fO(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&ae.indexOf(t[0][T][0])==-1){v=t[0][g];var W=!0;switch(v[1][0]){case 4:W=!1;case 0:w=Lt(" ",v[1][1]);break;case 5:W=!1;case 1:w=Lt("\r",v[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((W?w:"")+o.pop()+(W?"":w)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function pO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Mr(t,e-2)];var o=lu(t,a,r);return e!==a+s&&(i=ou(t,e-a-s,o,r)),t.l=n,[o,i]}function mO(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Mr(t,e-2)];var o=lu(t,a,r);return e!==a+s&&(i=ou(t,e-a-s,o,r)),t.l=n,[o,i]}function gO(t,e,r,n){var s=t.l+e,i=lu(t,n,r),a;return s!==t.l&&(a=ou(t,s-t.l,i,r)),[i,a]}function xO(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=lu(t,i,r);return i==65535?[[],Mr(t,e-2)]:(e!==i+2&&(s=ou(t,n-i-2,a,r)),[a,s])}function vO(t){var e;if(Us(t,t.l+6)!==65535)return[Dr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function _d(t,e,r){var n=t.l+e,s=Rs(t);r.biff==2&&++t.l;var i=vO(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=mO(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function a0(t,e,r){var n=t.read_shift(4),s=lu(t,n,r),i=t.read_shift(4),a=i>0?ou(t,i,s,r):null;return[s,a]}var _O=a0,o0=a0,yO=a0,EO=a0,wO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function E_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function yd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var oc={},Oo={};function lc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function nA(t,e,r,n,s,i){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=cr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&Ta(A3[e]||"General",e),t.t==="e")t.w=t.w||Ga[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=bc(t.v);else if(t.t==="d"){var a=qr(t.v);(a|0)===a?t.w=a.toString(10):t.w=bc(a)}else{if(t.v===void 0)return"";t.w=Pa(t.v,Oo)}else t.t==="d"?t.w=Vn(e,qr(t.v),Oo):t.w=Vn(e,t.v,Oo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=mh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=mh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function AO(t,e){var r=Mt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=tt(r))}var kO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,SO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IO=/<(?:\w:)?hyperlink [^>]*>/mg,CO=/"(\w*:\w*)"/,RO=/<(?:\w:)?col\b[^>]*[\/]?>/g,NO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,PO=/<(?:\w:)?pageMargins[^>]*\/>/g,sA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,FO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,DO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function OO(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(SO);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var d=c.match(sA);d?Og(d[0],o,s,r):(d=c.match(FO))&&bO(d[0],d[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=c.slice(m,m+50).match(CO);x&&AO(o,x[1])}var g=c.match(DO);g&&g[1]&&jO(g[1],s);var w=[];if(e.cellStyles){var T=c.match(RO);T&&VO(w,T)}h&&zO(h[1],o,e,l,i,a);var _=f.match(NO);_&&(o["!autofilter"]=UO(_[0]));var v=[],D=f.match(kO);if(D)for(m=0;m!=D.length;++m)v[m]=Mt(D[m].slice(D[m].indexOf('"')+1));var z=f.match(IO);z&&LO(o,z,n);var B=f.match(PO);if(B&&(o["!margins"]=MO(De(B[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=tt(l)),e.sheetRows>0&&o["!ref"]){var y=Mt(o["!ref"]);e.sheetRows<=+y.e.r&&(y.e.r=e.sheetRows-1,y.e.r>l.e.r&&(y.e.r=l.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>l.e.c&&(y.e.c=l.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(y))}return w.length>0&&(o["!cols"]=w),v.length>0&&(o["!merges"]=v),o}function Og(t,e,r,n){var s=De(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=st(_t(s.codeName)))}function bO(t,e,r,n,s){Og(t.slice(0,t.indexOf(">")),r,n,s)}function LO(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=De(_t(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+st(i.location))):(i.Target="#"+st(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Mt(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Me({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=i)}}}function MO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function VO(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=De(e[n],!0);s.hidden&&(s.hidden=It(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Fg(s.width)),qo(s);i<=a;)t[i++]=xr(s)}}function UO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var BO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jO(t,e){e.Views||(e.Views=[{}]),(t.match(BO)||[]).forEach(function(r,n){var s=De(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),It(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var zO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Lc("v"),a=Lc("f");return function(l,c,f,h,d,m){for(var x=0,g="",w=[],T=[],_=0,v=0,D=0,z="",B,y,A=0,k=0,C,R,N=0,F=0,Ee=Array.isArray(m.CellXf),he,ke=[],ve=[],ae=Array.isArray(c),W=[],le={},we=!1,L=!!f.sheetStubs,K=l.split(e),G=0,H=K.length;G!=H;++G){g=K[G].trim();var te=g.length;if(te!==0){var fe=0;e:for(x=0;x<te;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(y=De(g.slice(fe,x),!0),A=y.r!=null?parseInt(y.r,10):A+1,k=-1,f.sheetRows&&f.sheetRows<A)continue;le={},we=!1,y.ht&&(we=!0,le.hpt=parseFloat(y.ht),le.hpx=Bc(le.hpt)),y.hidden=="1"&&(we=!0,le.hidden=!0),y.outlineLevel!=null&&(we=!0,le.level=+y.outlineLevel),we&&(W[A-1]=le)}break;case"<":fe=x;break}if(fe>=x)break;if(y=De(g.slice(fe,x),!0),A=y.r!=null?parseInt(y.r,10):A+1,k=-1,!(f.sheetRows&&f.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),f&&f.cellStyles&&(le={},we=!1,y.ht&&(we=!0,le.hpt=parseFloat(y.ht),le.hpx=Bc(le.hpt)),y.hidden=="1"&&(we=!0,le.hidden=!0),y.outlineLevel!=null&&(we=!0,le.level=+y.outlineLevel),we&&(W[A-1]=le)),w=g.slice(x).split(t);for(var xe=0;xe!=w.length&&w[xe].trim().charAt(0)=="<";++xe);for(w=w.slice(xe),x=0;x!=w.length;++x)if(g=w[x].trim(),g.length!==0){if(T=g.match(r),_=x,v=0,D=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,T!=null&&T.length===2){for(_=0,z=T[1],v=0;v!=z.length&&!((D=z.charCodeAt(v)-64)<1||D>26);++v)_=26*_+D;--_,k=_}else++k;for(v=0;v!=g.length&&g.charCodeAt(v)!==62;++v);if(++v,y=De(g.slice(0,v),!0),y.r||(y.r=Me({r:A-1,c:k})),z=g.slice(v),B={t:""},(T=z.match(i))!=null&&T[1]!==""&&(B.v=st(T[1])),f.cellFormula){if((T=z.match(a))!=null&&T[1]!==""){if(B.f=st(_t(T[1])).replace(/\r\n/g,`
`),f.xlfn||(B.f=x_(B.f)),T[0].indexOf('t="array"')>-1)B.F=(z.match(s)||[])[1],B.F.indexOf(":")>-1&&ke.push([Mt(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){R=De(T[0]);var de=st(_t(T[1]));f.xlfn||(de=x_(de)),ve[parseInt(R.si,10)]=[R,de,y.r]}}else(T=z.match(/<f[^>]*\/>/))&&(R=De(T[0]),ve[R.si]&&(B.f=ZD(ve[R.si][1],ve[R.si][2],y.r)));var ie=Wr(y.r);for(v=0;v<ke.length;++v)ie.r>=ke[v][0].s.r&&ie.r<=ke[v][0].e.r&&ie.c>=ke[v][0].s.c&&ie.c<=ke[v][0].e.c&&(B.F=ke[v][1])}if(y.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(L)B.t="z";else continue;else B.t=y.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),B.t){case"n":if(B.v==""||B.v==null){if(!L)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!L)continue;B.t="z"}else C=oc[parseInt(B.v,10)],B.v=C.t,B.r=C.r,f.cellHTML&&(B.h=C.h);break;case"str":B.t="s",B.v=B.v!=null?_t(B.v):"",f.cellHTML&&(B.h=Eg(B.v));break;case"inlineStr":T=z.match(n),B.t="s",T!=null&&(C=Pg(T[1]))?(B.v=C.t,f.cellHTML&&(B.h=C.h)):B.v="";break;case"b":B.v=It(B.v);break;case"d":f.cellDates?B.v=cr(B.v,1):(B.v=qr(cr(B.v,1)),B.t="n");break;case"e":(!f||f.cellText!==!1)&&(B.w=B.v),B.v=kT[B.v];break}if(N=F=0,he=null,Ee&&y.s!==void 0&&(he=m.CellXf[y.s],he!=null&&(he.numFmtId!=null&&(N=he.numFmtId),f.cellStyles&&he.fillId!=null&&(F=he.fillId))),nA(B,N,F,f,d,m),f.cellDates&&Ee&&B.t=="n"&&il(ze[N])&&(B.t="d",B.v=s0(B.v)),y.cm&&f.xlmeta){var Ue=(f.xlmeta.Cell||[])[+y.cm-1];Ue&&Ue.type=="XLDAPR"&&(B.D=!0)}if(ae){var j=Wr(y.r);c[j.r]||(c[j.r]=[]),c[j.r][j.c]=B}else c[y.r]=B}}}}W.length>0&&(c["!rows"]=W)}}();function $O(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var HO=Wa;function WO(){}function GO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=pN(t),r}function KO(t){var e=Un(t);return[e]}function qO(t){var e=Ha(t);return[e]}function XO(t){var e=Un(t),r=t.read_shift(1);return[e,r,"b"]}function YO(t){var e=Ha(t),r=t.read_shift(1);return[e,r,"b"]}function QO(t){var e=Un(t),r=t.read_shift(1);return[e,r,"e"]}function JO(t){var e=Ha(t),r=t.read_shift(1);return[e,r,"e"]}function ZO(t){var e=Un(t),r=t.read_shift(4);return[e,r,"s"]}function eb(t){var e=Ha(t),r=t.read_shift(4);return[e,r,"s"]}function tb(t){var e=Un(t),r=Dr(t);return[e,r,"n"]}function iA(t){var e=Ha(t),r=Dr(t);return[e,r,"n"]}function rb(t){var e=Un(t),r=Cg(t);return[e,r,"n"]}function nb(t){var e=Ha(t),r=Cg(t);return[e,r,"n"]}function sb(t){var e=Un(t),r=Sg(t);return[e,r,"is"]}function ib(t){var e=Un(t),r=br(t);return[e,r,"str"]}function ab(t){var e=Ha(t),r=br(t);return[e,r,"str"]}function ob(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=o0(t,n-t.l,r);a[3]=Nr(o,null,s,r.supbooks,r)}else t.l=n;return a}function lb(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=o0(t,n-t.l,r);a[3]=Nr(o,null,s,r.supbooks,r)}else t.l=n;return a}function cb(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=Dr(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=o0(t,n-t.l,r);a[3]=Nr(o,null,s,r.supbooks,r)}else t.l=n;return a}function ub(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=br(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=o0(t,n-t.l,r);a[3]=Nr(o,null,s,r.supbooks,r)}else t.l=n;return a}var fb=Wa;function hb(t,e){var r=t.l+e,n=Wa(t),s=Ig(t),i=br(t),a=br(t),o=br(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function db(){}function pb(t,e,r){var n=t.l+e,s=wT(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=_O(t,n-t.l,r);a[1]=o}else t.l=n;return a}function mb(t,e,r){var n=t.l+e,s=Wa(t),i=[s];if(r.cellFormula){var a=EO(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var gb=["left","right","top","bottom","header","footer"];function xb(t){var e={};return gb.forEach(function(r){e[r]=Dr(t)}),e}function vb(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function _b(){}function yb(){}function Eb(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,x,g,w,T,_,v,D,z,B=[];o.biff=12,o["!row"]=0;var y=0,A=!1,k=[],C={},R=o.supbooks||s.supbooks||[[]];if(R.sharedf=C,R.arrayf=k,R.SheetNames=s.SheetNames||s.Sheets.map(function(ae){return ae.name}),!o.supbooks&&(o.supbooks=R,s.Names))for(var N=0;N<s.Names.length;++N)R[0][N+1]=s.Names[N];var F=[],Ee=[],he=!1;vh[16]={n:"BrtShortReal",f:iA};var ke;if(ni(t,function(W,le,we){if(!d)switch(we){case 148:c=W;break;case 0:m=W,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),D=vr(w=m.r),o["!row"]=m.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Bc(W.hpt)),Ee[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:W[2]},W[2]){case"n":x.v=W[1];break;case"s":v=oc[W[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!W[1];break;case"e":x.v=W[1],o.cellText!==!1&&(x.w=Ga[x.v]);break;case"str":x.t="s",x.v=W[1];break;case"is":x.t="s",x.v=W[1].t;break}if((g=a.CellXf[W[0].iStyleRef])&&nA(x,g.numFmtId,null,o,i,a),T=W[0].c==-1?T+1:W[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=x):l[rr(T)+D]=x,o.cellFormula){for(A=!1,y=0;y<k.length;++y){var L=k[y];m.r>=L[0].s.r&&m.r<=L[0].e.r&&T>=L[0].s.c&&T<=L[0].e.c&&(x.F=tt(L[0]),A=!0)}!A&&W.length>3&&(x.f=W[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),o.cellDates&&g&&x.t=="n"&&il(ze[g.numFmtId])){var K=va(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}ke&&(ke.type=="XLDAPR"&&(x.D=!0),ke=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},T=W[0].c==-1?T+1:W[0].c,o.dense?(l[w]||(l[w]=[]),l[w][T]=x):l[rr(T)+D]=x,f.s.r>m.r&&(f.s.r=m.r),f.s.c>T&&(f.s.c=T),f.e.r<m.r&&(f.e.r=m.r),f.e.c<T&&(f.e.c=T),ke&&(ke.type=="XLDAPR"&&(x.D=!0),ke=void 0);break;case 176:B.push(W);break;case 49:ke=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var G=n["!id"][W.relId];for(G?(W.Target=G.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=G):W.relId==""&&(W.Target="#"+W.loc),w=W.rfx.s.r;w<=W.rfx.e.r;++w)for(T=W.rfx.s.c;T<=W.rfx.e.c;++T)o.dense?(l[w]||(l[w]=[]),l[w][T]||(l[w][T]={t:"z",v:void 0}),l[w][T].l=W):(_=Me({c:T,r:w}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=W);break;case 426:if(!o.cellFormula)break;k.push(W),z=o.dense?l[w][T]:l[rr(T)+D],z.f=Nr(W[1],f,{r:m.r,c:T},R,o),z.F=tt(W[0]);break;case 427:if(!o.cellFormula)break;C[Me(W[0].s)]=W[1],z=o.dense?l[w][T]:l[rr(T)+D],z.f=Nr(W[1],f,{r:m.r,c:T},R,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)F[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},he||(he=!0,Fg(W.w/256)),qo(F[W.e+1]);break;case 161:l["!autofilter"]={ref:tt(W)};break;case 476:l["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(l["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!le.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+we.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=tt(c||f)),o.sheetRows&&l["!ref"]){var ve=Mt(l["!ref"]);o.sheetRows<=+ve.e.r&&(ve.e.r=o.sheetRows-1,ve.e.r>f.e.r&&(ve.e.r=f.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>f.e.c&&(ve.e.c=f.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),l["!fullref"]=l["!ref"],l["!ref"]=tt(ve))}return B.length>0&&(l["!merges"]=B),F.length>0&&(l["!cols"]=F),Ee.length>0&&(l["!rows"]=Ee),l}function wb(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=st((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function Tb(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=wb(h);f.s.r=f.s.c=0,f.e.c=o,c=rr(o),d[0].forEach(function(m,x){a[c+vr(x)]={t:"n",v:m,z:d[1]},l=x}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=tt(f)),a}function Ab(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(sA);return o&&Og(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function kb(t,e){t.l+=10;var r=br(t);return{name:r}}function Sb(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ni(t,function(l,c,f){switch(f){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var aA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ib=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Cb=[],Rb=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=It(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function T_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=It(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function oA(t){T_(t.WBProps,aA),T_(t.CalcPr,Rb),w_(t.WBView,Ib),w_(t.Sheets,Cb),Oo.date1904=It(t.WBProps.date1904)}var Nb="][*?/\\".split("");function Pb(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Nb.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Fb=/<\w+:workbook/;function Db(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Ur,function(l,c){var f=De(l);switch(Cs(f[0])){case"<?xml":break;case"<workbook":l.match(Fb)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":aA.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=It(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=_t(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=st(_t(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=_t(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),It(f.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=st(_t(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),Q3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return oA(r),r}function Ob(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=bp(t),r.name=br(t),r}function bb(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?br(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Lb(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Mb(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=mN(t),a=yO(t,0,r),o=Ig(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function Vb(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],vh[16]={n:"BrtFRTArchID$",f:Lb},ni(t,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Nr(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),oA(r),r.Names=i,r.supbooks=a,r}function Ub(t,e,r){return e.slice(-4)===".bin"?Vb(t,r):Db(t,r)}function Bb(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Eb(t,n,r,s,i,a,o):OO(t,n,r,s,i,a,o)}function jb(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Sb(t,n,r,s,i):Ab(t,n,r,s,i)}function zb(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?YD():QD()}function $b(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?qD():XD()}function Hb(t,e,r,n){return e.slice(-4)===".bin"?fD(t,r,n):iD(t,r,n)}function Wb(t,e,r){return KT(t,r)}function Gb(t,e,r){return e.slice(-4)===".bin"?IF(t,r):kF(t,r)}function Kb(t,e,r){return e.slice(-4)===".bin"?WD(t,r):BD(t,r)}function qb(t,e,r){return e.slice(-4)===".bin"?MD(t):bD(t)}function Xb(t,e,r,n){return r.slice(-4)===".bin"?VD(t,e,r,n):void 0}function Yb(t,e,r){return e.slice(-4)===".bin"?DD(t,e,r):OD(t,e,r)}var lA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $n(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(lA),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(cA),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Qb(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(lA),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(cA),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var cc;function Jb(t,e){var r=cc[t]||st(t);return r==="General"?Pa(e):Vn(r,e)}function Zb(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=It(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=cr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[st(e)]=s}function eL(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ga[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=bc(t.v):t.w=Pa(t.v):t.w=Jb(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=cc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&il(n)){var s=va(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function tL(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=ZF[n.Pattern]||n.Pattern)}t[e.ID]=e}function rL(t,e,r,n,s,i,a,o,l,c){var f="General",h=n.StyleID,d={};c=c||{};var m=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&m.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=It(t);break;case"String":n.t="s",n.r=Wv(st(t)),n.v=t.indexOf("<")>-1?st(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(cr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=kT[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Wv(e||t));break}if(eL(n,f,c),c.cellFormula!==!1)if(n.Formula){var g=st(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Do(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Do("RC:RC",s):n.ArrayRange&&(n.F=Do(n.ArrayRange,s),l.push([Mt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(m.forEach(function(w){!d.patternType&&w.patternType&&(d.patternType=w.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function nL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Ed(t,e){var r=e||{};Qw();var n=Ll(wg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=_t(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=xr(r);return a.type="string",Vc.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(gt){s.indexOf("<"+gt)>=0&&(i=!0)}),i)return hL(n,r);cc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},h=[],d=r.dense?[]:{},m="",x={},g={},w=$n('<Data ss:Type="String">'),T=0,_=0,v=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},B={},y="",A=0,k=[],C={},R={},N=0,F=[],Ee=[],he={},ke=[],ve,ae=!1,W=[],le=[],we={},L=0,K=0,G={Sheets:[],WBProps:{date1904:!1}},H={};Mc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=Mc.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?rL(n.slice(T,o.index),y,w,l[l.length-1][0]=="comment"?he:x,{c:_,r:v},z,ke[_],g,W,r):(y="",w=$n(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ee.length>0&&(x.c=Ee),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(d[v]||(d[v]=[]),d[v][_]=x):d[rr(_)+vr(v)]=x),x.HRef&&(x.l={Target:st(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(L=_+(parseInt(x.MergeAcross,10)|0),K=v+(parseInt(x.MergeDown,10)|0),k.push({s:{c:_,r:v},e:{c:L,r:K}})),!r.sheetStubs)x.MergeAcross?_=L+1:++_;else if(x.MergeAcross||x.MergeDown){for(var fe=_;fe<=L;++fe)for(var xe=v;xe<=K;++xe)(fe>_||xe>v)&&(r.dense?(d[xe]||(d[xe]=[]),d[xe][fe]={t:"z"}):d[rr(fe)+vr(xe)]={t:"z"});_=L+1}else++_;else x=Qb(o[0]),x.Index&&(_=+x.Index-1),_<D.s.c&&(D.s.c=_),_>D.e.c&&(D.e.c=_),o[0].slice(-2)==="/>"&&++_,Ee=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<D.s.r&&(D.s.r=v),v>D.e.r&&(D.e.r=v),o[0].slice(-2)==="/>"&&(g=$n(o[0]),g.Index&&(v=+g.Index-1)),_=0,++v):(g=$n(o[0]),g.Index&&(v=+g.Index-1),we={},(g.AutoFitHeight=="0"||g.Height)&&(we.hpx=parseInt(g.Height,10),we.hpt=GT(we.hpx),le[v]=we),g.Hidden=="1"&&(we.hidden=!0,le[v]=we));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(d["!ref"]=tt(D),r.sheetRows&&r.sheetRows<=D.e.r&&(d["!fullref"]=d["!ref"],D.e.r=r.sheetRows-1,d["!ref"]=tt(D))),k.length&&(d["!merges"]=k),ke.length>0&&(d["!cols"]=ke),le.length>0&&(d["!rows"]=le),f[m]=d}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,l.push([o[3],!1]),c=$n(o[0]),m=st(c.Name),d=r.dense?[]:{},k=[],W=[],le=[],H={name:m,Hidden:0},G.Sheets.push(H);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ke=[],ae=!1}break;case"style":o[1]==="/"?tL(z,B,r):B=$n(o[0]);break;case"numberformat":B.nf=st($n(o[0]).Format||"General"),cc[B.nf]&&(B.nf=cc[B.nf]);for(var de=0;de!=392&&ze[de]!=B.nf;++de);if(de==392){for(de=57;de!=392;++de)if(ze[de]==null){Ta(B.nf,de);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ve=$n(o[0]),ve.Hidden&&(ve.hidden=!0,delete ve.Hidden),ve.Width&&(ve.wpx=parseInt(ve.Width,10)),!ae&&ve.wpx>10){ae=!0,Hr=HT;for(var ie=0;ie<ke.length;++ie)ke[ie]&&qo(ke[ie])}ae&&qo(ve),ke[ve.Index-1||ke.length]=ve;for(var Ue=0;Ue<+ve.Span;++Ue)ke[ke.length]=xr(ve);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var j=De(o[0]),ht={Name:j.Name,Ref:Do(j.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(ht.Sheet=G.Sheets.length-1),G.Names.push(ht);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=$n(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?BN(C,te,n.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));nL(he),Ee.push(he)}else l.push([o[3],!1]),c=$n(o[0]),he={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=$n(o[0]);d["!autofilter"]={ref:Do($e.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return R_(n,r);var Ge=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ge=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ge=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ge=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ge=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(N,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else N=o.index+o[0].length;break;case"header":d["!margins"]||lc(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].header=+De(o[0]).Margin);break;case"footer":d["!margins"]||lc(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var Be=De(o[0]);d["!margins"]||lc(d["!margins"]={},"xlml"),isNaN(+Be.Top)||(d["!margins"].top=+Be.Top),isNaN(+Be.Left)||(d["!margins"].left=+Be.Left),isNaN(+Be.Right)||(d["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(d["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ge=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ge=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ge=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ge=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ge=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ge=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ge=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ge=!1}break;case"smarttags":break;default:Ge=!1;break}if(Ge||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Zb(R,te,F,n.slice(N,o.index)):(F=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ge={};return!r.bookSheets&&!r.bookProps&&(ge.Sheets=f),ge.SheetNames=h,ge.Workbook=G,ge.SSF=xr(ze),ge.Props=C,ge.Custprops=R,ge}function Up(t,e){switch(Mg(e=e||{}),e.type||"base64"){case"base64":return Ed(En(t),e);case"binary":case"buffer":case"file":return Ed(t,e);case"array":return Ed($a(t),e)}}function sL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=vN(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=_N(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var iL=[60,1084,2066,2165,2175];function aL(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=Us(r,r.l),c=Bp[l],f=0;c!=null&&iL.indexOf(l)>-1;)i=Us(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+i),a.push(o),r.l+=4+i,c=Bp[l=Us(r,r.l)];var h=vi(a);pr(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function cs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ga[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=bc(t.v):t.w=Pa(t.v):t.w=Vn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&il(ze[n]||String(n))){var s=va(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function nf(t,e,r){return{v:t,ixfe:e,t:r}}function oL(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",f={},h,d="",m,x,g,w,T={},_=[],v,D,z=[],B=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},k=function(je){return je<8?Aa[je]:je<64&&B[je-8]||Aa[je]},C=function(je,it,Ht){var ut=it.XF.data;if(!(!ut||!ut.patternType||!Ht||!Ht.cellStyles)){it.s={},it.s.patternType=ut.patternType;var An;(An=Uc(k(ut.icvFore)))&&(it.s.fgColor={rgb:An}),(An=Uc(k(ut.icvBack)))&&(it.s.bgColor={rgb:An})}},R=function(je,it,Ht){if(!(we>1)&&!(Ht.sheetRows&&je.r>=Ht.sheetRows)){if(Ht.cellStyles&&it.XF&&it.XF.data&&C(je,it,Ht),delete it.ixfe,delete it.XF,h=je,d=Me(je),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),je.r<a.s.r&&(a.s.r=je.r),je.c<a.s.c&&(a.s.c=je.c),je.r+1>a.e.r&&(a.e.r=je.r+1),je.c+1>a.e.c&&(a.e.c=je.c+1),Ht.cellFormula&&it.f){for(var ut=0;ut<_.length;++ut)if(!(_[ut][0].s.c>je.c||_[ut][0].s.r>je.r)&&!(_[ut][0].e.c<je.c||_[ut][0].e.r<je.r)){it.F=tt(_[ut][0]),(_[ut][0].s.c!=je.c||_[ut][0].s.r!=je.r)&&delete it.f,it.f&&(it.f=""+Nr(_[ut][1],a,je,W,N));break}}Ht.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=it):s[d]=it}},N={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var F,Ee=[],he=[],ke=[],ve=[],ae=!1,W=[];W.SheetNames=N.snames,W.sharedf=N.sharedf,W.arrayf=N.arrayf,W.names=[],W.XTI=[];var le=0,we=0,L=0,K=[],G=[],H;N.codepage=1200,Xn(1200);for(var te=!1;t.l<t.length-1;){var fe=t.l,xe=t.read_shift(2);if(xe===0&&le===10)break;var de=t.l===t.length?0:t.read_shift(2),ie=Bp[xe];if(ie&&ie.f){if(e.bookSheets&&le===133&&xe!==133)break;if(le=xe,ie.r===2||ie.r==12){var Ue=t.read_shift(2);if(de-=2,!N.enc&&Ue!==xe&&((Ue&255)<<8|Ue>>8)!==xe)throw new Error("rt mismatch: "+Ue+"!="+xe);ie.r==12&&(t.l+=10,de-=10)}var j={};if(xe===10?j=ie.f(t,de,N):j=aL(xe,ie,t,de,N),we==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(xe){case 34:r.opts.Date1904=y.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=j;break;case 66:var ht=Number(j);switch(ht){case 21010:ht=1200;break;case 32768:ht=1e4;break;case 32769:ht=1252;break}Xn(N.codepage=ht),te=!0;break;case 317:N.rrtabid=j;break;case 25:N.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:N.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:z.push(j);break;case 430:W.push([j]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(j);break;case 24:case 536:H={Name:j.Name,Ref:Nr(j.rgce,a,null,W,N)},j.itab>0&&(H.Sheet=j.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(G[j.itab-1]={ref:tt(j.rgce[0][0][1][2])});break;case 22:N.ExternCount=j;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(j),W.XTI=W.XTI.concat(j);break;case 2196:if(N.biff<8)break;H!=null&&(H.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&N.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,N.snames.push(j.name);break;case 10:{if(--we)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var $e=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=tt(a),a.e.r=$e}a.e.r++,a.e.c++}Ee.length>0&&(s["!merges"]=Ee),he.length>0&&(s["!objects"]=he),ke.length>0&&(s["!cols"]=ke),ve.length>0&&(s["!rows"]=ve),y.Sheets.push(A)}c===""?f=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),N.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(N.biff=5,te=!0,Xn(N.codepage=28591)),N.biff==8&&j.BIFFVer==0&&j.dt==16&&(N.biff=2),we++)break;if(s=e.dense?[]:{},N.biff<8&&!te&&(te=!0,Xn(N.codepage=e.codepage||1252)),N.biff<5||j.BIFFVer==0&&j.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ge={pos:t.l-de,name:c};i[Ge.pos]=Ge,N.snames.push(c)}else c=(i[fe]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),Ee=[],he=[],N.arrayf=_=[],ke=[],ve=[],ae=!1,A={Hidden:(i[fe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[j.r]||[])[j.c]:s[Me({c:j.c,r:j.r})])&&++j.c,v={ixfe:j.ixfe,XF:z[j.ixfe]||{},v:j.val,t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e);break;case 5:case 517:v={ixfe:j.ixfe,XF:z[j.ixfe],v:j.val,t:j.t},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e);break;case 638:v={ixfe:j.ixfe,XF:z[j.ixfe],v:j.rknum,t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e);break;case 189:for(var Be=j.c;Be<=j.C;++Be){var ge=j.rkrec[Be-j.c][0];v={ixfe:ge,XF:z[ge],v:j.rkrec[Be-j.c][1],t:"n"},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:Be,r:j.r},v,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(v=nf(j.val,j.cell.ixfe,j.tt),v.XF=z[v.ixfe],e.cellFormula){var gt=j.formula;if(gt&&gt[0]&&gt[0][0]&&gt[0][0][0]=="PtgExp"){var ur=gt[0][0][1][0],Er=gt[0][0][1][1],Qr=Me({r:ur,c:Er});T[Qr]?v.f=""+Nr(j.formula,a,j.cell,W,N):v.F=((e.dense?(s[ur]||[])[Er]:s[Qr])||{}).F}else v.f=""+Nr(j.formula,a,j.cell,W,N)}L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R(j.cell,v,e),o=j}break;case 7:case 519:if(o)o.val=j,v=nf(j,o.cell.ixfe,"s"),v.XF=z[v.ixfe],e.cellFormula&&(v.f=""+Nr(o.formula,a,o.cell,W,N)),L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(j);var Ns=Me(j[0].s);if(m=e.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[Ns],e.cellFormula&&m){if(!o||!Ns||!m)break;m.f=""+Nr(j[1],a,j[0],W,N),m.F=tt(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Me(o.cell)]=j[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Me(o.cell)],(m||{}).f=""+Nr(j[0],a,h,W,N)}}break;case 253:v=nf(l[j.isst].t,j.ixfe,"s"),l[j.isst].h&&(v.h=l[j.isst].h),v.XF=z[v.ixfe],L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:j.ixfe,XF:z[j.ixfe],t:"z"},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e));break;case 190:if(e.sheetStubs)for(var Jr=j.c;Jr<=j.C;++Jr){var Jt=j.ixfe[Jr-j.c];v={ixfe:Jt,XF:z[Jt],t:"z"},L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:Jr,r:j.r},v,e)}break;case 214:case 516:case 4:v=nf(j.val,j.ixfe,"s"),v.XF=z[v.ixfe],L>0&&(v.z=K[v.ixfe>>8&63]),cs(v,e,r.opts.Date1904),R({c:j.c,r:j.r},v,e);break;case 0:case 512:we===1&&(a=j);break;case 252:l=j;break;case 1054:if(N.biff==4){K[L++]=j[1];for(var Zr=0;Zr<L+163&&ze[Zr]!=j[1];++Zr);Zr>=163&&Ta(j[1],L+163)}else Ta(j[1],j[0]);break;case 30:{K[L++]=j;for(var dt=0;dt<L+163&&ze[dt]!=j;++dt);dt>=163&&Ta(j,L+163)}break;case 229:Ee=Ee.concat(j);break;case 93:he[j.cmo[0]]=N.lastobj=j;break;case 438:N.lastobj.TxO=j;break;case 127:N.lastobj.ImData=j;break;case 440:for(w=j[0].s.r;w<=j[0].e.r;++w)for(g=j[0].s.c;g<=j[0].e.c;++g)m=e.dense?(s[w]||[])[g]:s[Me({c:g,r:w})],m&&(m.l=j[1]);break;case 2048:for(w=j[0].s.r;w<=j[0].e.r;++w)for(g=j[0].s.c;g<=j[0].e.c;++g)m=e.dense?(s[w]||[])[g]:s[Me({c:g,r:w})],m&&m.l&&(m.l.Tooltip=j[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;m=e.dense?(s[j[0].r]||[])[j[0].c]:s[Me(j[0])];var At=he[j[2]];m||(e.dense?(s[j[0].r]||(s[j[0].r]=[]),m=s[j[0].r][j[0].c]={t:"z"}):m=s[Me(j[0])]={t:"z"},a.e.r=Math.max(a.e.r,j[0].r),a.s.r=Math.min(a.s.r,j[0].r),a.e.c=Math.max(a.e.c,j[0].c),a.s.c=Math.min(a.s.c,j[0].c)),m.c||(m.c=[]),x={a:j[1],t:At.TxO.t},m.c.push(x)}break;case 2173:RD(z[j.ixfe],j.ext);break;case 125:{if(!N.cellStyles)break;for(;j.e>=j.s;)ke[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ae||(ae=!0,Fg(j.w/256)),qo(ke[j.e+1])}break;case 520:{var Dt={};j.level!=null&&(ve[j.r]=Dt,Dt.level=j.level),j.hidden&&(ve[j.r]=Dt,Dt.hidden=!0),j.hpt&&(ve[j.r]=Dt,Dt.hpt=j.hpt,Dt.hpx=Bc(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||lc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=j;break;case 161:s["!margins"]||lc(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(y.Views[0].RTL=!0);break;case 146:B=j;break;case 2198:F=j;break;case 140:D=j;break;case 442:c?A.CodeName=j||A.name:y.WBProps.CodeName=j||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),t.l+=de}return r.SheetNames=ks(i).sort(function(Br,je){return Number(Br)-Number(je)}).map(function(Br){return i[Br].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&G.forEach(function(Br,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Br}),r.Strings=l,r.SSF=xr(ze),N.enc&&(r.Encryption=N.enc),F&&(r.Themes=F),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),W.names.length>0&&(y.Names=W.names),r.Workbook=y,r}var A_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lL(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=o_(n,kN,A_.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=o_(a,SN,A_.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(IT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function uA(t,e){e||(e={}),Mg(e),Uw(),e.codepage&&mg(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=qn(En(t));break;case"binary":t=qn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}pr(t,0),n={content:t}}var s,i;if(r&&sL(r),e.bookProps&&!e.bookSheets)s={};else{var a=Ye?"buffer":"array";if(n&&n.content)s=oL(n.content,e);else if((i=et.find(t,"PerfectOffice_MAIN"))&&i.content)s=ac.to_workbook(i.content,(e.type=a,e));else if((i=et.find(t,"NativeContent_MAIN"))&&i.content)s=ac.to_workbook(i.content,(e.type=a,e));else throw(i=et.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=KD(t))}var o={};return t.FullPaths&&lL(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var vh={0:{f:$O},1:{f:KO},2:{f:rb},3:{f:QO},4:{f:XO},5:{f:tb},6:{f:ib},7:{f:ZO},8:{f:ub},9:{f:cb},10:{f:ob},11:{f:lb},12:{f:qO},13:{f:nb},14:{f:JO},15:{f:YO},16:{f:iA},17:{f:ab},18:{f:eb},19:{f:Sg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Mb},40:{},42:{},43:{f:oD},44:{f:aD},45:{f:lD},46:{f:uD},47:{f:cD},48:{},49:{f:fN},50:{},51:{f:PD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:UT},62:{f:sb},63:{f:LD},64:{f:_b},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GO},148:{f:HO,p:16},151:{f:db},152:{},153:{f:bb},154:{},155:{},156:{f:Ob},157:{},158:{},159:{T:1,f:SF},160:{T:-1},161:{T:1,f:Wa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ND},336:{T:-1},337:{f:FD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pb},427:{f:mb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HD},633:{T:1},634:{T:-1},635:{T:1,f:$D},636:{T:-1},637:{f:dN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bp={6:{f:_d},10:{f:fi},12:{f:qt},13:{f:qt},14:{f:Ut},15:{f:Ut},16:{f:Dr},17:{f:Ut},18:{f:Ut},19:{f:qt},20:{f:f_},21:{f:f_},23:{f:VT},24:{f:d_},25:{f:Ut},26:{},27:{},28:{f:jP},29:{},34:{f:Ut},35:{f:h_},38:{f:Dr},39:{f:Dr},40:{f:Dr},41:{f:Dr},42:{f:Ut},43:{f:Ut},47:{f:WF},49:{f:wP},51:{f:qt},60:{},61:{f:_P},64:{f:Ut},65:{f:EP},66:{f:qt},77:{},80:{},81:{},82:{},85:{f:qt},89:{},90:{},91:{},92:{f:fP},93:{f:$P},94:{},95:{f:Ut},96:{},97:{},99:{f:Ut},125:{f:UT},128:{f:FP},129:{f:hP},130:{f:qt},131:{f:Ut},132:{f:Ut},133:{f:dP},134:{},140:{f:XP},141:{f:qt},144:{},146:{f:QP},151:{},152:{},153:{},154:{},155:{},156:{f:qt},157:{},158:{},160:{f:rF},161:{f:ZP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:CP},190:{f:RP},193:{f:fi},197:{},198:{},199:{},200:{},201:{},202:{f:Ut},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qt},220:{},221:{f:Ut},222:{},224:{f:PP},225:{f:uP},226:{f:fi},227:{},229:{f:zP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pP},253:{f:TP},255:{f:mP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:FT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ut},353:{f:fi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:OP},431:{f:Ut},432:{},433:{},434:{},437:{},438:{f:GP},439:{f:Ut},440:{f:KP},441:{},442:{f:iu},443:{},444:{f:qt},445:{},446:{},448:{f:fi},449:{f:vP,r:2},450:{f:fi},512:{f:c_},513:{f:tF},515:{f:DP},516:{f:AP},517:{f:u_},519:{f:nF},520:{f:gP},523:{},545:{f:p_},549:{f:l_},566:{},574:{f:yP},638:{f:IP},659:{},1048:{},1054:{f:kP},1084:{},1212:{f:VP},2048:{f:qP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ef},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:fi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JP,r:12},2173:{f:CD,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ut,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:MP,r:12},2197:{},2198:{f:wD,r:12},2199:{},2200:{},2201:{},2202:{f:UP,r:12},2203:{f:fi},2204:{},2205:{},2206:{},2207:{},2211:{f:xP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:YP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:c_},1:{},2:{f:oF},3:{f:aF},4:{f:iF},5:{f:u_},7:{f:lF},8:{},9:{f:ef},11:{},22:{f:qt},30:{f:SP},31:{},32:{},33:{f:p_},36:{},37:{f:l_},50:{f:cF},62:{},52:{},67:{},68:{f:qt},69:{},86:{},126:{},127:{f:sF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:uF},223:{},234:{},354:{},421:{},518:{f:_d},521:{f:ef},536:{f:d_},547:{f:h_},561:{},579:{},1030:{f:_d},1033:{f:ef},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hn(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&_T(r)&&t.push(r)}}function k_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=D3(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<l.length;++a){var g=l[a].trim(),w=g.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var T=g.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var _=T[o].trim();if(_.match(/<t[dh]/i)){for(var v=_,D=0;v.charAt(0)=="<"&&(D=v.indexOf(">"))>-1;)v=v.slice(D+1);for(var z=0;z<x.length;++z){var B=x[z];B.s.c==f&&B.s.r<c&&c<=B.e.r&&(f=B.e.c+1,z=-1)}var y=De(_.slice(0,_.indexOf(">")));d=y.colspan?+y.colspan:1,((h=+y.rowspan)>1||d>1)&&x.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var A=y.t||y["data-t"]||"";if(!v.length){f+=d;continue}if(v=aT(v),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!v.length){f+=d;continue}var k={t:"s",v};r.raw||!v.trim().length||A=="s"||(v==="TRUE"?k={t:"b",v:!0}:v==="FALSE"?k={t:"b",v:!1}:isNaN(es(v))?isNaN(Ko(v).getDate())||(k={t:"d",v:cr(v)},r.cellDates||(k={t:"n",v:qr(k.v)}),k.z=r.dateNF||ze[14]):k={t:"n",v:es(v)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=k):n[Me({r:c,c:f})]=k,f+=d}}}}return n["!ref"]=tt(m),x.length&&(n["!merges"]=x),n}function cL(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var f=Me({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||Eg(h.w||(Qs(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,i.push(X3("td",d,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var uL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fL="</body></html>";function hL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ra(k_(r[0],e),e);var n=Ug();return r.forEach(function(s,i){Bg(n,k_(s,e),"Sheet"+(i+1))}),n}function dL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pL(t,e){var r=e||{},n=r.header!=null?r.header:uL,s=r.footer!=null?r.footer:fL,i=[n],a=al(t["!ref"]);r.dense=Array.isArray(t),i.push(dL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(cL(t,a,o,r));return i.push("</table>"+s),i.join("")}function fA(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Wr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var f=al(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),x=0,g=0,w=0,T=0,_=0,v=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&g<l;++x){var D=o[x];if(S_(D)){if(n.display)continue;m[g]={hidden:!0}}var z=D.children;for(w=T=0;w<z.length;++w){var B=z[w];if(!(n.display&&S_(B))){var y=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):aT(B.innerHTML),A=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==T+i&&k.s.r<g+s&&g+s<=k.e.r&&(T=k.e.c+1-i,d=-1)}v=+B.getAttribute("colspan")||1,((_=+B.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:g+s,c:T+i},e:{r:g+s+(_||1)-1,c:T+i+(v||1)-1}});var C={t:"s",v:y},R=B.getAttribute("data-t")||B.getAttribute("t")||"";y!=null&&(y.length==0?C.t=R||"z":n.raw||y.trim().length==0||R=="s"||(y==="TRUE"?C={t:"b",v:!0}:y==="FALSE"?C={t:"b",v:!1}:isNaN(es(y))?isNaN(Ko(y).getDate())||(C={t:"d",v:cr(y)},n.cellDates||(C={t:"n",v:qr(C.v)}),C.z=n.dateNF||ze[14]):C={t:"n",v:es(y)})),C.z===void 0&&A!=null&&(C.z=A);var N="",F=B.getElementsByTagName("A");if(F&&F.length)for(var Ee=0;Ee<F.length&&!(F[Ee].hasAttribute("href")&&(N=F[Ee].getAttribute("href"),N.charAt(0)!="#"));++Ee);N&&N.charAt(0)!="#"&&(C.l={Target:N}),n.dense?(t[g+s]||(t[g+s]=[]),t[g+s][T+i]=C):t[Me({c:T+i,r:g+s})]=C,c.e.c<T+i&&(c.e.c=T+i),T+=v}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),t["!ref"]=tt(c),g>=l&&(t["!fullref"]=tt((c.e.r=o.length-x+g-1+s,c))),t}function hA(t,e){var r=e||{},n=r.dense?[]:{};return fA(n,t,e)}function mL(t,e){return ra(hA(t,e),e)}function S_(t){var e="",r=gL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function gL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function xL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(e.replace(/<[^>]*>/g,""));return[r]}var I_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dA(t,e){var r=e||{},n=wg(t),s=[],i,a,o={name:""},l="",c=0,f,h,d={},m=[],x=r.dense?[]:{},g,w,T={value:""},_="",v=0,D=[],z=-1,B=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,k={},C=[],R={},N=0,F=0,Ee=[],he=1,ke=1,ve=[],ae={Names:[]},W={},le=["",""],we=[],L={},K="",G=0,H=!1,te=!1,fe=0;for(Mc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Mc.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?x["!ref"]=tt(y):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(x["!fullref"]=x["!ref"],y.e.r=r.sheetRows-1,x["!ref"]=tt(y)),C.length&&(x["!merges"]=C),Ee.length&&(x["!rows"]=Ee),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),d[f.name]=x,te=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=De(g[0],!1),z=B=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,x=r.dense?[]:{},C=[],Ee=[],te=!0);break;case"table-row-group":g[1]==="/"?--A:++A;break;case"table-row":case"":if(g[1]==="/"){z+=he,he=1;break}if(h=De(g[0],!1),h.?z=h.-1:z==-1&&(z=0),he=+h["number-rows-repeated"]||1,he<10)for(fe=0;fe<he;++fe)A>0&&(Ee[z+fe]={level:A});B=-1;break;case"covered-table-cell":g[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(x[z]||(x[z]=[]),x[z][B]={t:"z"}):x[Me({r:z,c:B})]={t:"z"}),_="",D=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++B,T=De(g[0],!1),ke=parseInt(T["number-columns-repeated"]||"1",10),w={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(w.f=E_(st(T.formula))),(T.||T["value-type"])=="string"&&(w.t="s",w.v=st(T["string-value"]||""),r.dense?(x[z]||(x[z]=[]),x[z][B]=w):x[Me({r:z,c:B})]=w),B+=ke-1;else if(g[1]!=="/"){++B,_="",v=0,D=[],ke=1;var xe=he?z+he-1:z;if(B>y.e.c&&(y.e.c=B),B<y.s.c&&(y.s.c=B),z<y.s.r&&(y.s.r=z),xe>y.e.r&&(y.e.r=xe),T=De(g[0],!1),we=[],L={},w={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=st(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(N=parseInt(T["number-matrix-rows-spanned"],10)||0,F=parseInt(T["number-matrix-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+N-1,c:B+F-1}},w.F=tt(R),ve.push([R,w.F])),T.formula)w.f=E_(T.formula);else for(fe=0;fe<ve.length;++fe)z>=ve[fe][0].s.r&&z<=ve[fe][0].e.r&&B>=ve[fe][0].s.c&&B<=ve[fe][0].e.c&&(w.F=ve[fe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(N=parseInt(T["number-rows-spanned"],10)||0,F=parseInt(T["number-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+N-1,c:B+F-1}},C.push(R)),T["number-columns-repeated"]&&(ke=parseInt(T["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=It(T["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(T.value);break;case"percentage":w.t="n",w.v=parseFloat(T.value);break;case"currency":w.t="n",w.v=parseFloat(T.value);break;case"date":w.t="d",w.v=cr(T["date-value"]),r.cellDates||(w.t="n",w.v=qr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=N3(T["time-value"])/86400,r.cellDates&&(w.t="d",w.v=s0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(T.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",T["string-value"]!=null&&(_=st(T["string-value"]),D=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(H=!1,w.t==="s"&&(w.v=_||"",D.length&&(w.R=D),H=v==0),W.Target&&(w.l=W),we.length>0&&(w.c=we,we=[]),_&&r.cellText!==!1&&(w.w=_),H&&(w.t="z",delete w.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var de=0;de<he;++de){if(ke=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(x[z+de]||(x[z+de]=[]),x[z+de][B]=de==0?w:xr(w);--ke>0;)x[z+de][B+ke]=xr(w);else for(x[Me({r:z+de,c:B})]=w;--ke>0;)x[Me({r:z+de,c:B+ke})]=xr(w);y.e.c<=B&&(y.e.c=B)}ke=parseInt(T["number-columns-repeated"]||"1",10),B+=ke-1,ke=0,w={},_="",D=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;L.t=_,D.length&&(L.R=D),L.a=K,we.push(L)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);K="",G=0,_="",v=0,D=[];break;case"creator":g[1]==="/"?K=n.slice(G,g.index):G=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);_="",v=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(k[o.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=De(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=De(g[0],!1),l+=I_[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=De(g[0],!1),l+=I_[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":a=De(g[0],!1),le=yd(a["cell-range-address"]);var ie={Name:a.name,Ref:le[0]+"!"+le[1]};te&&(ie.Sheet=m.length),ae.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!T||!T["string-value"])){var Ue=xL(n.slice(v,g.index));_=(_.length>0?_+`
`:"")+Ue[0]}else De(g[0],!1),v=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{le=yd(De(g[0])["target-range-address"]),d[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(W=De(g[0],!1),!W.href)break;W.Target=st(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(le=yd(W.Target.slice(1)),W.Target="#"+le[0]+"!"+le[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var j={Sheets:d,SheetNames:m,Workbook:ae};return r.bookSheets&&delete j.Sheets,j}function C_(t,e){e=e||{},In(t,"META-INF/manifest.xml")&&DN(Kt(t,"META-INF/manifest.xml"),e);var r=mn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=dA(_t(r),e);return In(t,"meta.xml")&&(n.Props=ST(Kt(t,"meta.xml"))),n}function R_(t,e){return dA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function jp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):_t($a(t))}function zp(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function N_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function vL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function jc(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function nr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Or(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=jc(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=jc(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Lg(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function _L(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=jc(t,n),i=Or(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:nr(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Or(o.data),c=nr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=nr(i[3][0].data)>>>0>0),r.push(a)}return r}function yL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=jc(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[zp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var f=zp(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function EL(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(yL(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return zp(e)}function wL(t,e,r,n){var s=bg(t),i=s.getUint32(4,!0),a=(n>1?12:8)+N_(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=N_(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function TL(t,e,r){var n=bg(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);s&1&&(l=vL(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function AL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return wL(t,e,r,t[0]);case 5:return TL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Li(t){var e=Or(t);return jc(e[1][0].data)}function P_(t,e){var r=Or(e.data),n=nr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Or(a.data),l=nr(o[1][0].data)>>>0;switch(n){case 1:i[l]=jp(o[3][0].data);break;case 8:{var c=t[Li(o[9][0].data)][0],f=Or(c.data),h=t[Li(f[1][0].data)][0],d=nr(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=Or(h.data);i[l]=m[3].map(function(x){return jp(x.data)}).join("")}break}}),i}function kL(t,e){var r,n,s,i,a,o,l,c,f,h,d,m,x,g,w=Or(t),T=nr(w[1][0].data)>>>0,_=nr(w[2][0].data)>>>0,v=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&nr(w[8][0].data)>0||!1,D,z;if((i=(s=w[7])==null?void 0:s[0])!=null&&i.data&&e!=0)D=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,z=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&e!=1)D=(m=(d=w[4])==null?void 0:d[0])==null?void 0:m.data,z=(g=(x=w[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=v?4:1,y=bg(D),A=[],k=0;k<D.length/2;++k){var C=y.getUint16(k*2,!0);C<65535&&A.push([k,C])}if(A.length!=_)throw"Expected ".concat(_," cells, found ").concat(A.length);var R=[];for(k=0;k<A.length-1;++k)R[A[k][0]]=z.subarray(A[k][1]*B,A[k+1][1]*B);return A.length>=1&&(R[A[A.length-1][0]]=z.subarray(A[A.length-1][1]*B)),{R:T,cells:R}}function SL(t,e){var r,n=Or(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?nr(n[7][0].data)>>>0>0?1:0:-1,i=Lg(n[5],function(a){return kL(a,s)});return{nrows:nr(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function IL(t,e,r){var n,s=Or(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(nr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(nr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=tt(i);var a=Or(s[4][0].data),o=P_(t,t[Li(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?P_(t,t[Li(a[17][0].data)][0]):[],c=Or(a[3][0].data),f=0;c[1].forEach(function(h){var d=Or(h.data),m=t[Li(d[2][0].data)][0],x=nr(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=SL(t,m);g.data.forEach(function(w,T){w.forEach(function(_,v){var D=Me({r:f+T,c:v}),z=AL(_,o,l);z&&(r[D]=z)})}),f+=g.nrows})}function CL(t,e){var r=Or(e.data),n={"!ref":"A1"},s=t[Li(r[2][0].data)],i=nr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return IL(t,s[0],n),n}function RL(t,e){var r,n=Or(e.data),s={name:(r=n[1])!=null&&r[0]?jp(n[1][0].data):"",sheets:[]},i=Lg(n[2],Li);return i.forEach(function(a){t[a].forEach(function(o){var l=nr(o.meta[1][0].data);l==6e3&&s.sheets.push(CL(t,o))})}),s}function NL(t,e){var r=Ug(),n=Or(e.data),s=Lg(n[1],Li);if(s.forEach(function(i){t[i].forEach(function(a){var o=nr(a.meta[1][0].data);if(o==2){var l=RL(t,a);l.sheets.forEach(function(c,f){Bg(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function wd(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=EL(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=_L(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&nr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var f=nr(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return NL(i,o)}function PL(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Mg(t){PL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function FL(t){return Ao.WS.indexOf(t)>-1?"sheet":t==Ao.CS?"chart":t==Ao.DS?"dialog":t==Ao.MS?"macro":t&&t.length?t:"sheet"}function DL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,FL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function OL(t,e,r,n,s,i,a,o,l,c,f,h){try{i[n]=sc(mn(t,r,!0),e);var d=Kt(t,e),m;switch(o){case"sheet":m=Bb(d,e,s,l,i[n],c,f,h);break;case"chart":if(m=jb(d,e,s,l,i[n],c,f,h),!m||!m["!drawel"])break;var x=Vl(m["!drawel"].Target,e),g=Lp(x),w=UD(mn(t,x,!0),sc(mn(t,g,!0),x)),T=Vl(w,x),_=Lp(T);m=Tb(mn(t,T,!0),T,l,sc(mn(t,_,!0),T),c,m);break;case"macro":m=zb(d,e,s,l,i[n],c,f,h);break;case"dialog":m=$b(d,e,s,l,i[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var v=[];i&&i[n]&&ks(i[n]).forEach(function(D){var z="";if(i[n][D].Type==Ao.CMNT){z=Vl(i[n][D].Target,e);var B=Kb(Kt(t,z,!0),z,l);if(!B||!B.length)return;g_(m,B,!1)}i[n][D].Type==Ao.TCMNT&&(z=Vl(i[n][D].Target,e),v=v.concat(jD(Kt(t,z,!0),l)))}),v&&v.length&&g_(m,v,!0,l.people||[])}catch(D){if(l.WTF)throw D}}function kn(t){return t.charAt(0)=="/"?t.slice(1):t}function bL(t,e){if(Qw(),e=e||{},Mg(e),In(t,"META-INF/manifest.xml")||In(t,"objectdata.xml"))return C_(t,e);if(In(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wd<"u"){if(t.FileIndex)return wd(t);var r=et.utils.cfb_new();return $v(t).forEach(function(Ee){L3(r,Ee,b3(t,Ee))}),wd(r)}throw new Error("Unsupported NUMBERS file")}if(!In(t,"[Content_Types].xml"))throw In(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):In(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=$v(t),s=PN(mn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Kt(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Kt(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(oc=[],s.sst)try{oc=Gb(Kt(t,kn(s.sst)),s.sst,e)}catch(Ee){if(e.WTF)throw Ee}e.cellStyles&&s.themes.length&&(l=Wb(mn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=Hb(Kt(t,kn(s.style)),s.style,l,e))}s.links.map(function(Ee){try{var he=sc(mn(t,Lp(kn(Ee))),Ee);return Xb(Kt(t,kn(Ee)),he,Ee,e)}catch{}});var f=Ub(Kt(t,kn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=Kt(t,kn(s.coreprops[0]),!0),d&&(h=ST(d)),s.extprops.length!==0&&(d=Kt(t,kn(s.extprops[0]),!0),d&&LN(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=mn(t,kn(s.custprops[0]),!0),d&&(m=VN(d,e)));var x={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=m),e.bookSheets&&typeof a<"u"&&(x.SheetNames=a),e.bookSheets?x.SheetNames:e.bookProps))return x;a={};var g={};e.bookDeps&&s.calcchain&&(g=qb(Kt(t,kn(s.calcchain)),s.calcchain));var w=0,T={},_,v;{var D=f.Sheets;h.Worksheets=D.length,h.SheetNames=[];for(var z=0;z!=D.length;++z)h.SheetNames[z]=D[z].name}var B=i?"bin":"xml",y=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,y+1)+"_rels/"+s.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");In(t,A)||(A="xl/_rels/workbook."+B+".rels");var k=sc(mn(t,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Yb(Kt(t,kn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=zD(Kt(t,kn(s.people[0])),e)),k&&(k=DL(k,f.Sheets));var C=Kt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var R="sheet";if(k&&k[w]?(_="xl/"+k[w][1].replace(/[\/]?xl\//,""),In(t,_)||(_=k[w][1]),In(t,_)||(_=A.replace(/_rels\/.*$/,"")+k[w][1]),R=k[w][2]):(_="xl/worksheets/sheet"+(w+1-C)+"."+B,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==w&&(N=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[w].toLowerCase()&&(N=1);if(!N)continue e}}OL(t,_,v,h.SheetNames[w],w,T,a,R,e,f,l,c)}return x={Directory:s,Workbook:f,Props:h,Custprops:m,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:oc,Styles:c,Themes:l,SSF:xr(ze)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(Ee,he){Ee=Ee.replace(/^Root Entry[\/]/,""),x.keys.push(Ee),x.files[Ee]=t.FileIndex[he]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Kt(t,kn(s.vba[0]),!0):s.defaults&&s.defaults.bin===GD&&(x.vbaraw=Kt(t,"xl/vbaProject.bin",!0))),x}function LL(t,e){var r=e||{},n="Workbook",s=et.find(t,n);try{if(n="/!DataSpaces/Version",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(CF(s.content),n="/!DataSpaces/DataSpaceMap",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=NF(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=PF(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);DF(s.content)}catch{}if(n="/EncryptionInfo",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=OF(s.content);if(n="/EncryptedPackage",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Vg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=En(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ML(t,e){return et.find(t,"EncryptedPackage")?LL(t,e):uA(t,e)}function VL(t,e){var r,n=t,s=e||{};return s.type||(s.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r=nT(n,s),bL(r,s)}function pA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Up(t.slice(r),e);default:break e}return Vc.to_workbook(t,e)}function UL(t,e){var r="",n=Vg(t,e);switch(e.type){case"base64":r=En(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Fa(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=_t(r)),e.type="binary",pA(r,e)}function BL(t,e){var r=t;return e.type=="base64"&&(r=En(r)),r=Oc.utils.decode(1200,r.slice(2),"str"),e.type="binary",pA(r,e)}function jL(t){return t.match(/[^\x00-\x7F]/)?Ul(t):t}function Td(t,e,r,n){return n?(r.type="string",Vc.to_workbook(t,r)):Vc.to_workbook(e,r)}function _h(t,e){Uw();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return _h(new Uint8Array(t),(r=xr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oo={},r.dateNF&&(Oo.dateNF=r.dateNF),r.type||(r.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ye?"buffer":"binary",n=C3(t),typeof Uint8Array<"u"&&!Ye&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=jL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=xr(r),r.type="array",_h(gg(n),r)}switch((s=Vg(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return ML(et.read(n,r),r);break;case 9:if(s[1]<=8)return uA(n,r);break;case 60:return Up(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return mF(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return dF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?VL(n,r):Td(t,n,r,i);case 239:return s[3]===60?Up(n,r):Td(t,n,r,i);case 255:if(s[1]===254)return BL(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ac.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ac.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return m_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return GF.to_workbook(n,r);break;case 10:case 13:case 32:return UL(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fF.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?m_.to_workbook(n,r):Td(t,n,r,i)}function zL(t,e,r,n,s,i,a,o){var l=vr(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var x=a?t[r][m]:t[n[m]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;i[m]!=null&&(d[i[m]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(g==null)if(x.t=="e"&&g===null)d[i[m]]=null;else if(c!==void 0)d[i[m]]=c;else if(f&&g===null)d[i[m]]=null;else continue;else d[i[m]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Qs(x,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function $p(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Mt(f);break;case"number":l=Mt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var h=vr(l.s.r),d=[],m=[],x=0,g=0,w=Array.isArray(t),T=l.s.r,_=0,v={};w&&!t[T]&&(t[T]=[]);var D=c.skipHidden&&t["!cols"]||[],z=c.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(D[_]||{}).hidden)switch(d[_]=rr(_),r=w?t[T][_]:t[d[_]+h],n){case 1:i[_]=_-l.s.c;break;case 2:i[_]=d[_];break;case 3:i[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Qs(r,null,c),g=v[a]||0,!g)v[a]=1;else{do o=a+"_"+g++;while(v[o]);v[a]=g,v[o]=1}i[_]=o}for(T=l.s.r+s;T<=l.e.r;++T)if(!(z[T]||{}).hidden){var B=zL(t,l,T,d,n,i,w,c);(B.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[x++]=B.row)}return m.length=x,m}var F_=/"/g;function $L(t,e,r,n,s,i,a,o){for(var l=!0,c=[],f="",h=vr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Qs(m,null,o));for(var x=0,g=0;x!==f.length;++x)if((g=f.charCodeAt(x))===s||g===i||g===34||o.forceQuotes){f='"'+f.replace(F_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(F_,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function mA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Mt(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(d[x]||{}).hidden||(h[x]=rr(x));for(var g=0,w=s.s.r;w<=s.e.r;++w)(m[w]||{}).hidden||(f=$L(t,s,w,h,a,l,i,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function HL(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=mA(t,e);return r}function WL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Mt(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=rr(o);for(var f=s.s.r;f<=s.e.r;++f)for(i=vr(f),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function gA(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wr(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=Mt(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+s)}else a==-1&&(a=0,f.e.r=e.length-1+s);var d=n.header||[],m=0;e.forEach(function(g,w){ks(g).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var _=g[T],v="z",D="",z=Me({c:o+m,r:a+w+s});c=zc(i,z),_&&typeof _=="object"&&!(_ instanceof Date)?i[z]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",n.cellDates||(v="n",_=qr(_)),D=n.dateNF||ze[14]):_===null&&n.nullError&&(v="e",_=0),c?(c.t=v,c.v=_,delete c.w,delete c.R,D&&(c.z=D)):i[z]=c={t:v,v:_},D&&(c.z=D))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var x=vr(a);if(s)for(m=0;m<d.length;++m)i[rr(m+o)+x]={t:"s",v:d[m]};return i["!ref"]=tt(f),i}function GL(t,e){return gA(null,t,e)}function zc(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Wr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?zc(t,Me(e)):zc(t,Me({r:e,c:r||0}))}function KL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Ug(){return{SheetNames:[],Sheets:{}}}function Bg(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(Pb(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function qL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=KL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function XL(t,e){return t.z=e,t}function xA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function YL(t,e,r){return xA(t,"#"+e,r)}function QL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function JL(t,e,r,n){for(var s=typeof e!="string"?e:Mt(e),i=typeof e=="string"?e:tt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=zc(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var D_={encode_col:rr,encode_row:vr,encode_cell:Me,encode_range:tt,decode_col:kg,decode_row:Ag,split_cell:uN,decode_cell:Wr,decode_range:al,format_cell:Qs,sheet_add_aoa:ET,sheet_add_json:gA,sheet_add_dom:fA,aoa_to_sheet:ol,json_to_sheet:GL,table_to_sheet:hA,table_to_book:mL,sheet_to_csv:mA,sheet_to_txt:HL,sheet_to_json:$p,sheet_to_html:pL,sheet_to_formulae:WL,sheet_to_row_object_array:$p,sheet_get_cell:zc,book_new:Ug,book_append_sheet:Bg,book_set_sheet_visibility:qL,cell_set_number_format:XL,cell_set_hyperlink:xA,cell_set_internal_link:YL,cell_add_comment:QL,sheet_set_array_formula:JL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ZL=()=>{};var O_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},e8=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},_A={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,f=i>>2,h=(i&3)<<4|o>>4;let d=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):e8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||h==null)throw new t8;const d=i<<2|o>>4;if(n.push(d),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class t8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r8=function(t){const e=vA(t);return _A.encodeByteArray(e,!0)},yh=function(t){return r8(t).replace(/\./g,"")},yA=function(t){try{return _A.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=()=>n8().__FIREBASE_DEFAULTS__,i8=()=>{if(typeof process>"u"||typeof O_>"u")return;const t=O_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},a8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yA(t[1]);return e&&JSON.parse(e)},l0=()=>{try{return ZL()||s8()||i8()||a8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},EA=t=>{var e,r;return(r=(e=l0())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},o8=t=>{const e=EA(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},wA=()=>{var t;return(t=l0())==null?void 0:t.config},TA=t=>{var e;return(e=l0())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AA(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[yh(JSON.stringify(r)),yh(JSON.stringify(a)),""].join(".")}const uc={};function u8(){const t={prod:[],emulator:[]};for(const e of Object.keys(uc))uc[e]?t.emulator.push(e):t.prod.push(e);return t}function f8(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let b_=!1;function kA(t,e){if(typeof window>"u"||typeof document>"u"||!ll(window.location.host)||uc[t]===e||uc[t]||b_)return;uc[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",i=u8().prod.length>0;function a(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{b_=!0,a()},d}function f(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=f8(n),m=r("text"),x=document.getElementById(m)||document.createElement("span"),g=r("learnmore"),w=document.getElementById(g)||document.createElement("a"),T=r("preprendIcon"),_=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const v=d.element;o(v),f(w,g);const D=c();l(_,T),v.append(_,x,w,D),document.body.appendChild(v)}i?(x.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function h8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vr())}function d8(){var e;const t=(e=l0())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function p8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function SA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function m8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function g8(){const t=Vr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function x8(){return!d8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function IA(){try{return typeof indexedDB=="object"}catch{return!1}}function CA(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}function v8(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _8="FirebaseError";class as extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=_8,Object.setPrototypeOf(this,as.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qa.prototype.create)}}class qa{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?y8(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new as(s,o,n)}}function y8(t,e){return t.replace(E8,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const E8=/\{\$([^}]+)}/g;function w8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(L_(i)&&L_(a)){if(!Gi(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function L_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Bl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function jl(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function T8(t,e){const r=new A8(t,e);return r.subscribe.bind(r)}class A8{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");k8(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Ad),s.error===void 0&&(s.error=Ad),s.complete===void 0&&(s.complete=Ad);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k8(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Ad(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8=1e3,I8=2,C8=4*60*60*1e3,R8=.5;function M_(t,e=S8,r=I8){const n=e*Math.pow(r,t),s=Math.round(R8*n*(Math.random()-.5)*2);return Math.min(C8,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(t){return t&&t._delegate?t._delegate:t}class rs{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new l8;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(F8(e))try{this.getOrInitializeService({instanceIdentifier:da})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=da){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=da){return this.instances.has(e)}getOptions(e=da){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:P8(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=da){return this.component?this.component.multipleInstances?e:da:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function P8(t){return t===da?void 0:t}function F8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new N8(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ke||(Ke={}));const O8={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},b8=Ke.INFO,L8={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},M8=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=L8[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class c0{constructor(e){this.name=e,this._logLevel=b8,this._logHandler=M8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?O8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const V8=(t,e)=>e.some(r=>t instanceof r);let V_,U_;function U8(){return V_||(V_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function B8(){return U_||(U_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RA=new WeakMap,Hp=new WeakMap,NA=new WeakMap,kd=new WeakMap,jg=new WeakMap;function j8(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Mi(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&RA.set(r,t)}).catch(()=>{}),jg.set(e,t),e}function z8(t){if(Hp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Hp.set(t,e)}let Wp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Hp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||NA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Mi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $8(t){Wp=t(Wp)}function H8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Sd(this),e,...r);return NA.set(n,e.sort?e.sort():[e]),Mi(n)}:B8().includes(t)?function(...e){return t.apply(Sd(this),e),Mi(RA.get(this))}:function(...e){return Mi(t.apply(Sd(this),e))}}function W8(t){return typeof t=="function"?H8(t):(t instanceof IDBTransaction&&z8(t),V8(t,U8())?new Proxy(t,Wp):t)}function Mi(t){if(t instanceof IDBRequest)return j8(t);if(kd.has(t))return kd.get(t);const e=W8(t);return e!==t&&(kd.set(t,e),jg.set(e,t)),e}const Sd=t=>jg.get(t);function PA(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=Mi(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Mi(a.result),l.oldVersion,l.newVersion,Mi(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const G8=["get","getKey","getAll","getAllKeys","count"],K8=["put","add","delete","clear"],Id=new Map;function B_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Id.get(e))return Id.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=K8.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||G8.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return Id.set(e,i),i}$8(t=>({...t,get:(e,r,n)=>B_(e,r)||t.get(e,r,n),has:(e,r)=>!!B_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(X8(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function X8(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Gp="@firebase/app",j_="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new c0("@firebase/app"),Y8="@firebase/app-compat",Q8="@firebase/analytics-compat",J8="@firebase/analytics",Z8="@firebase/app-check-compat",e5="@firebase/app-check",t5="@firebase/auth",r5="@firebase/auth-compat",n5="@firebase/database",s5="@firebase/data-connect",i5="@firebase/database-compat",a5="@firebase/functions",o5="@firebase/functions-compat",l5="@firebase/installations",c5="@firebase/installations-compat",u5="@firebase/messaging",f5="@firebase/messaging-compat",h5="@firebase/performance",d5="@firebase/performance-compat",p5="@firebase/remote-config",m5="@firebase/remote-config-compat",g5="@firebase/storage",x5="@firebase/storage-compat",v5="@firebase/firestore",_5="@firebase/ai",y5="@firebase/firestore-compat",E5="firebase",w5="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="[DEFAULT]",T5={[Gp]:"fire-core",[Y8]:"fire-core-compat",[J8]:"fire-analytics",[Q8]:"fire-analytics-compat",[e5]:"fire-app-check",[Z8]:"fire-app-check-compat",[t5]:"fire-auth",[r5]:"fire-auth-compat",[n5]:"fire-rtdb",[s5]:"fire-data-connect",[i5]:"fire-rtdb-compat",[a5]:"fire-fn",[o5]:"fire-fn-compat",[l5]:"fire-iid",[c5]:"fire-iid-compat",[u5]:"fire-fcm",[f5]:"fire-fcm-compat",[h5]:"fire-perf",[d5]:"fire-perf-compat",[p5]:"fire-rc",[m5]:"fire-rc-compat",[g5]:"fire-gcs",[x5]:"fire-gcs-compat",[v5]:"fire-fst",[y5]:"fire-fst-compat",[_5]:"fire-vertex","fire-js":"fire-js",[E5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh=new Map,A5=new Map,qp=new Map;function z_(t,e){try{t.container.addComponent(e)}catch(r){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ss(t){const e=t.name;if(qp.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;qp.set(e,t);for(const r of Eh.values())z_(r,t);for(const r of A5.values())z_(r,t);return!0}function Xa(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vi=new qa("app","Firebase",k5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new rs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=w5;function FA(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Kp,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Vi.create("bad-app-name",{appName:String(s)});if(r||(r=wA()),!r)throw Vi.create("no-options");const i=Eh.get(s);if(i){if(Gi(r,i.options)&&Gi(n,i.config))return i;throw Vi.create("duplicate-app",{appName:s})}const a=new D8(s);for(const l of qp.values())a.addComponent(l);const o=new S5(r,n,a);return Eh.set(s,o),o}function zg(t=Kp){const e=Eh.get(t);if(!e&&t===Kp&&wA())return FA();if(!e)throw Vi.create("no-app",{appName:t});return e}function On(t,e,r){let n=T5[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(a.join(" "));return}Ss(new rs(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5="firebase-heartbeat-database",C5=1,$c="firebase-heartbeat-store";let Cd=null;function DA(){return Cd||(Cd=PA(I5,C5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore($c)}catch(r){console.warn(r)}}}}).catch(t=>{throw Vi.create("idb-open",{originalErrorMessage:t.message})})),Cd}async function R5(t){try{const r=(await DA()).transaction($c),n=await r.objectStore($c).get(OA(t));return await r.done,n}catch(e){if(e instanceof as)Js.warn(e.message);else{const r=Vi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Js.warn(r.message)}}}async function $_(t,e){try{const n=(await DA()).transaction($c,"readwrite");await n.objectStore($c).put(e,OA(t)),await n.done}catch(r){if(r instanceof as)Js.warn(r.message);else{const n=Vi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Js.warn(n.message)}}}function OA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5=1024,P5=30;class F5{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new O5(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=H_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>P5){const a=b5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Js.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=H_(),{heartbeatsToSend:n,unsentEntries:s}=D5(this._heartbeatsCache.heartbeats),i=yh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Js.warn(r),""}}}function H_(){return new Date().toISOString().substring(0,10)}function D5(t,e=N5){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),W_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),W_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class O5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return IA()?CA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await R5(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return $_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return $_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function W_(t){return yh(JSON.stringify({version:2,heartbeats:t})).length}function b5(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t){Ss(new rs("platform-logger",e=>new q8(e),"PRIVATE")),Ss(new rs("heartbeat",e=>new F5(e),"PRIVATE")),On(Gp,j_,t),On(Gp,j_,"esm2020"),On("fire-js","")}L5("");function bA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const M5=bA,LA=new qa("auth","Firebase",bA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=new c0("@firebase/auth");function V5(t,...e){wh.logLevel<=Ke.WARN&&wh.warn(`Auth (${cl}): ${t}`,...e)}function If(t,...e){wh.logLevel<=Ke.ERROR&&wh.error(`Auth (${cl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(t,...e){throw $g(t,...e)}function _s(t,...e){return $g(t,...e)}function MA(t,e,r){const n={...M5(),[e]:r};return new qa("auth","Firebase",n).create(e,{appName:t.name})}function Ws(t){return MA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $g(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return LA.create(t,...e)}function Pe(t,e,...r){if(!t)throw $g(e,...r)}function Bs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw If(e),new Error(e)}function Zs(t,e){t||Bs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function U5(){return G_()==="http:"||G_()==="https:"}function G_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(U5()||SA()||"connection"in navigator)?navigator.onLine:!0}function j5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Zs(r>e,"Short delay should be less than long delay!"),this.isMobile=h8()||m8()}get(){return B5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t,e){Zs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],H5=new uu(3e4,6e4);function na(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function si(t,e,r,n,s={}){return UA(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=cu({key:t.config.apiKey,...a}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...i};return p8()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&ll(t.emulatorConfig.host)&&(c.credentials="include"),VA.fetch()(await BA(t,t.config.apiHost,r,o),c)})}async function UA(t,e,r){t._canInitEmulator=!1;const n={...z5,...e};try{const s=new G5(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw sf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw sf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw sf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw sf(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw MA(t,f,c);ns(t,f)}}catch(s){if(s instanceof as)throw s;ns(t,"network-request-failed",{message:String(s)})}}async function fu(t,e,r,n,s={}){const i=await si(t,e,r,n,s);return"mfaPendingCredential"in i&&ns(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function BA(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?Hg(t.config,s):`${t.config.apiScheme}://${s}`;return $5.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function W5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class G5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_s(this.auth,"network-request-failed")),H5.get())})}}function sf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=_s(t,e,n);return s.customData._tokenResponse=r,s}function K_(t){return t!==void 0&&t.enterprise!==void 0}class K5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return W5(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function q5(t,e){return si(t,"GET","/v2/recaptchaConfig",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5(t,e){return si(t,"POST","/v1/accounts:delete",e)}async function Th(t,e){return si(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Y5(t,e=!1){const r=$t(t),n=await r.getIdToken(e),s=Wg(n);Pe(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:fc(Rd(s.auth_time)),issuedAtTime:fc(Rd(s.iat)),expirationTime:fc(Rd(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Rd(t){return Number(t)*1e3}function Wg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return If("JWT malformed, contained fewer than 3 sections"),null;try{const s=yA(r);return s?JSON.parse(s):(If("Failed to decode base64 JWT payload"),null)}catch(s){return If("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function q_(t){const e=Wg(t);return Pe(e,"internal-error"),Pe(typeof e.exp<"u","internal-error"),Pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof as&&Q5(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Q5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=fc(this.lastLoginAt),this.creationTime=fc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ah(t){var h;const e=t.auth,r=await t.getIdToken(),n=await Xo(t,Th(e,{idToken:r}));Pe(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?jA(s.providerUserInfo):[],a=eM(t.providerData,i),o=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),c=o?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Yp(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,f)}async function Z5(t){const e=$t(t);await Ah(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eM(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function jA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tM(t,e){const r=await UA(t,{},async()=>{const n=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await BA(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&ll(t.emulatorConfig.host)&&(l.credentials="include"),VA.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function rM(t,e){return si(t,"POST","/v2/accounts:revokeToken",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pe(e.idToken,"internal-error"),Pe(typeof e.idToken<"u","internal-error"),Pe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):q_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Pe(e.length!==0,"internal-error");const r=q_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await tM(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new bo;return n&&(Pe(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Pe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Pe(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bo,this.toJSON())}_performRefresh(){return Bs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){Pe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qn{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new J5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Yp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Xo(this,this.stsTokenManager.getToken(this.auth,e));return Pe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Y5(this,e)}reload(){return Z5(this)}_assign(e){this!==e&&(Pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ah(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nn(this.auth.app))return Promise.reject(Ws(this.auth));const e=await this.getIdToken();return await Xo(this,X5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:m,providerData:x,stsTokenManager:g}=r;Pe(h&&g,e,"internal-error");const w=bo.fromJSON(this.name,g);Pe(typeof h=="string",e,"internal-error"),hi(n,e.name),hi(s,e.name),Pe(typeof d=="boolean",e,"internal-error"),Pe(typeof m=="boolean",e,"internal-error"),hi(i,e.name),hi(a,e.name),hi(o,e.name),hi(l,e.name),hi(c,e.name),hi(f,e.name);const T=new Qn({uid:h,auth:e,email:s,emailVerified:d,displayName:n,isAnonymous:m,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:f});return x&&Array.isArray(x)&&(T.providerData=x.map(_=>({..._}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new bo;s.updateFromServerResponse(r);const i=new Qn({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Ah(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Pe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jA(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new bo;o.updateFromIdToken(n);const l=new Qn({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Yp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=new Map;function js(t){Zs(t instanceof Function,"Expected a class definition");let e=X_.get(t);return e?(Zs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,X_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}zA.type="NONE";const Y_=zA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t,e,r){return`firebase:${t}:${e}:${r}`}class Lo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Cf(this.userKey,s.apiKey,i),this.fullPersistenceKey=Cf("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Th(this.auth,{idToken:e}).catch(()=>{});return r?Qn._fromGetAccountInfoResponse(this.auth,r,e):null}return Qn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Lo(js(Y_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||js(Y_);const a=Cf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(a);if(f){let h;if(typeof f=="string"){const d=await Th(e,{idToken:f}).catch(()=>{});if(!d)break;h=await Qn._fromGetAccountInfoResponse(e,d,f)}else h=Qn._fromJSON(e,f);c!==i&&(o=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Lo(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new Lo(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if($A(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qA(e))return"Blackberry";if(XA(e))return"Webos";if(HA(e))return"Safari";if((e.includes("chrome/")||WA(e))&&!e.includes("edge/"))return"Chrome";if(KA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function $A(t=Vr()){return/firefox\//i.test(t)}function HA(t=Vr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function WA(t=Vr()){return/crios\//i.test(t)}function GA(t=Vr()){return/iemobile/i.test(t)}function KA(t=Vr()){return/android/i.test(t)}function qA(t=Vr()){return/blackberry/i.test(t)}function XA(t=Vr()){return/webos/i.test(t)}function Gg(t=Vr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function nM(t=Vr()){var e;return Gg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function sM(){return g8()&&document.documentMode===10}function YA(t=Vr()){return Gg(t)||KA(t)||XA(t)||qA(t)||/windows phone/i.test(t)||GA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t,e=[]){let r;switch(t){case"Browser":r=Q_(Vr());break;case"Worker":r=`${Q_(Vr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${cl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(t,e={}){return si(t,"GET","/v2/passwordPolicy",na(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM=6;class lM{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??oM,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new J_(this),this.idTokenSubscription=new J_(this),this.beforeStateQueue=new iM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=js(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Lo.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Th(this,{idToken:e}),n=await Qn._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Nn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ah(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=j5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nn(this.app))return Promise.reject(Ws(this));const r=e?$t(e):null;return r&&Pe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nn(this.app)?Promise.reject(Ws(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nn(this.app)?Promise.reject(Ws(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(js(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aM(this),r=new lM(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qa("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await rM(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&js(e)||this._popupRedirectResolver;Pe(r,this,"argument-error"),this.redirectPersistenceManager=await Lo.create(this,[js(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pe(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(Nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&V5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ya(t){return $t(t)}class J_{constructor(e){this.auth=e,this.observer=null,this.addObserver=T8(r=>this.observer=r)}get next(){return Pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uM(t){u0=t}function JA(t){return u0.loadJS(t)}function fM(){return u0.recaptchaEnterpriseScript}function hM(){return u0.gapiScript}function dM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class pM{constructor(){this.enterprise=new mM}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class mM{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const gM="recaptcha-enterprise",ZA="NO_RECAPTCHA";class xM{constructor(e){this.type=gM,this.auth=Ya(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{q5(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new K5(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;K_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(ZA)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pM().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&K_(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=fM();l.length!==0&&(l+=o),JA(l).then(()=>{s(o,i,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function Z_(t,e,r,n=!1,s=!1){const i=new xM(t);let a;if(s)a=ZA;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Qp(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Z_(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Z_(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vM(t,e){const r=Xa(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Gi(i,e??{}))return s;ns(s,"already-initialized")}return r.initialize({options:e})}function _M(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(js);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function yM(t,e,r){const n=Ya(t);Pe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=ek(e),{host:a,port:o}=EM(e),l=o===null?"":`:${o}`,c={url:`${i}//${a}${l}/`},f=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Pe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Pe(Gi(c,n.config.emulator)&&Gi(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ll(a)?(AA(`${i}//${a}${l}`),kA("Auth",!0)):wM()}function ek(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function EM(t){const e=ek(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:ey(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:ey(a)}}}function ey(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function wM(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Bs("not implemented")}_getIdTokenResponse(e){return Bs("not implemented")}_linkToIdToken(e,r){return Bs("not implemented")}_getReauthenticationResolver(e){return Bs("not implemented")}}async function TM(t,e){return si(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AM(t,e){return fu(t,"POST","/v1/accounts:signInWithPassword",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kM(t,e){return fu(t,"POST","/v1/accounts:signInWithEmailLink",na(t,e))}async function SM(t,e){return fu(t,"POST","/v1/accounts:signInWithEmailLink",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc extends Kg{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Hc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Hc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,r,"signInWithPassword",AM);case"emailLink":return kM(e,{email:this._email,oobCode:this._password});default:ns(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,n,"signUpPassword",TM);case"emailLink":return SM(e,{idToken:r,email:this._email,oobCode:this._password});default:ns(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mo(t,e){return fu(t,"POST","/v1/accounts:signInWithIdp",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM="http://localhost";class Oa extends Kg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Oa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ns("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new Oa(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Mo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Mo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Mo(e,r)}buildRequest(){const e={requestUri:IM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=cu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RM(t){const e=Bl(jl(t)).link,r=e?Bl(jl(e)).deep_link_id:null,n=Bl(jl(t)).deep_link_id;return(n?Bl(jl(n)).link:null)||n||r||e||t}class qg{constructor(e){const r=Bl(jl(e)),n=r.apiKey??null,s=r.oobCode??null,i=CM(r.mode??null);Pe(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=RM(e);try{return new qg(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this.providerId=ul.PROVIDER_ID}static credential(e,r){return Hc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=qg.parseLink(r);return Pe(n,"argument-error"),Hc._fromEmailAndCode(e,n.code,n.tenantId)}}ul.PROVIDER_ID="password";ul.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ul.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends tk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends hu{constructor(){super("facebook.com")}static credential(e){return Oa._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _i.credential(e.oauthAccessToken)}catch{return null}}}_i.FACEBOOK_SIGN_IN_METHOD="facebook.com";_i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Oa._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return yi.credential(r,n)}catch{return null}}}yi.GOOGLE_SIGN_IN_METHOD="google.com";yi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends hu{constructor(){super("github.com")}static credential(e){return Oa._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends hu{constructor(){super("twitter.com")}static credential(e,r){return Oa._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return wi.credential(r,n)}catch{return null}}}wi.TWITTER_SIGN_IN_METHOD="twitter.com";wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NM(t,e){return fu(t,"POST","/v1/accounts:signUp",na(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Qn._fromIdTokenResponse(e,n,s),a=ty(n);return new ba({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=ty(n);return new ba({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function ty(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends as{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new kh(e,r,n,s)}}function rk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,i,e,n):i})}async function PM(t,e,r=!1){const n=await Xo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ba._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FM(t,e,r=!1){const{auth:n}=t;if(Nn(n.app))return Promise.reject(Ws(n));const s="reauthenticate";try{const i=await Xo(t,rk(n,s,e,t),r);Pe(i.idToken,n,"internal-error");const a=Wg(i.idToken);Pe(a,n,"internal-error");const{sub:o}=a;return Pe(t.uid===o,n,"user-mismatch"),ba._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ns(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nk(t,e,r=!1){if(Nn(t.app))return Promise.reject(Ws(t));const n="signIn",s=await rk(t,n,e),i=await ba._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function DM(t,e){return nk(Ya(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sk(t){const e=Ya(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function OM(t,e,r){if(Nn(t.app))return Promise.reject(Ws(t));const n=Ya(t),a=await Qp(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",NM).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&sk(t),l}),o=await ba._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function bM(t,e,r){return Nn(t.app)?Promise.reject(Ws(t)):DM($t(t),ul.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&sk(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LM(t,e){return si(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MM(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=$t(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Xo(n,LM(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function VM(t,e,r,n){return $t(t).onIdTokenChanged(e,r,n)}function UM(t,e,r){return $t(t).beforeAuthStateChanged(e,r)}function BM(t,e,r,n){return $t(t).onAuthStateChanged(e,r,n)}function jM(t){return $t(t).signOut()}const Sh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Sh,"1"),this.storage.removeItem(Sh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM=1e3,$M=10;class ak extends ik{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);sM()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$M):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},zM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}ak.type="LOCAL";const HM=ak;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok extends ik{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}ok.type="SESSION";const lk=ok;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new f0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await WM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}f0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=Xg("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(d.data.response);break;default:clearTimeout(f),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(){return window}function KM(t){ys().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(){return typeof ys().WorkerGlobalScope<"u"&&typeof ys().importScripts=="function"}async function qM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function YM(){return ck()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk="firebaseLocalStorageDb",QM=1,Ih="firebaseLocalStorage",fk="fbase_key";class du{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function h0(t,e){return t.transaction([Ih],e?"readwrite":"readonly").objectStore(Ih)}function JM(){const t=indexedDB.deleteDatabase(uk);return new du(t).toPromise()}function Jp(){const t=indexedDB.open(uk,QM);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Ih,{keyPath:fk})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Ih)?e(n):(n.close(),await JM(),e(await Jp()))})})}async function ry(t,e,r){const n=h0(t,!0).put({[fk]:e,value:r});return new du(n).toPromise()}async function ZM(t,e){const r=h0(t,!1).get(e),n=await new du(r).toPromise();return n===void 0?null:n.value}function ny(t,e){const r=h0(t,!0).delete(e);return new du(r).toPromise()}const e9=800,t9=3;class hk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>t9)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ck()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=f0._getInstance(YM()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await qM(),!this.activeServiceWorker)return;this.sender=new GM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jp();return await ry(e,Sh,"1"),await ny(e,Sh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ry(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>ZM(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>ny(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=h0(s,!1).getAll();return new du(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),e9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hk.type="LOCAL";const r9=hk;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t,e){return e?js(e):(Pe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends Kg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Mo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Mo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function s9(t){return nk(t.auth,new Yg(t),t.bypassAuthState)}function i9(t){const{auth:e,user:r}=t;return Pe(r,e,"internal-error"),FM(r,new Yg(t),t.bypassAuthState)}async function a9(t){const{auth:e,user:r}=t;return Pe(r,e,"internal-error"),PM(r,new Yg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s9;case"linkViaPopup":case"linkViaRedirect":return a9;case"reauthViaPopup":case"reauthViaRedirect":return i9;default:ns(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o9=new uu(2e3,1e4);class ko extends dk{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,ko.currentPopupAction&&ko.currentPopupAction.cancel(),ko.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pe(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ko.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o9.get())};e()}}ko.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l9="pendingRedirect",Rf=new Map;class c9 extends dk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Rf.get(this.auth._key());if(!e){try{const n=await u9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Rf.set(this.auth._key(),e)}return this.bypassAuthState||Rf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function u9(t,e){const r=d9(e),n=h9(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function f9(t,e){Rf.set(t._key(),e)}function h9(t){return js(t._redirectPersistence)}function d9(t){return Cf(l9,t.config.apiKey,t.name)}async function p9(t,e,r=!1){if(Nn(t.app))return Promise.reject(Ws(t));const n=Ya(t),s=n9(n,e),a=await new c9(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9=10*60*1e3;class g9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x9(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!pk(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(_s(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=m9&&this.cachedEventUids.clear(),this.cachedEventUids.has(sy(e))}saveEventToCache(e){this.cachedEventUids.add(sy(e)),this.lastProcessedEventTime=Date.now()}}function sy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function pk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function x9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v9(t,e={}){return si(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,y9=/^https?/;async function E9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await v9(t);for(const r of e)try{if(w9(r))return}catch{}ns(t,"unauthorized-domain")}function w9(t){const e=Xp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!y9.test(r))return!1;if(_9.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9=new uu(3e4,6e4);function iy(){const t=ys().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function A9(t){return new Promise((e,r)=>{var s,i,a;function n(){iy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iy(),r(_s(t,"network-request-failed"))},timeout:T9.get()})}if((i=(s=ys().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=ys().gapi)!=null&&a.load)n();else{const o=dM("iframefcb");return ys()[o]=()=>{gapi.load?n():r(_s(t,"network-request-failed"))},JA(`${hM()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Nf=null,e})}let Nf=null;function k9(t){return Nf=Nf||A9(t),Nf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S9=new uu(5e3,15e3),I9="__/auth/iframe",C9="emulator/auth/iframe",R9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},N9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P9(t){const e=t.config;Pe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Hg(e,C9):`https://${t.config.authDomain}/${I9}`,n={apiKey:e.apiKey,appName:t.name,v:cl},s=N9.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${cu(n).slice(1)}`}async function F9(t){const e=await k9(t),r=ys().gapi;return Pe(r,t,"internal-error"),e.open({where:document.body,url:P9(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:R9,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=_s(t,"network-request-failed"),o=ys().setTimeout(()=>{i(a)},S9.get());function l(){ys().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},O9=500,b9=600,L9="_blank",M9="http://localhost";class ay{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V9(t,e,r,n=O9,s=b9){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...D9,width:n.toString(),height:s.toString(),top:i,left:a},c=Vr().toLowerCase();r&&(o=WA(c)?L9:r),$A(c)&&(e=e||M9,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[m,x])=>`${d}${m}=${x},`,"");if(nM(c)&&o!=="_self")return U9(e||"",o),new ay(null);const h=window.open(e||"",o,f);Pe(h,t,"popup-blocked");try{h.focus()}catch{}return new ay(h)}function U9(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9="__/auth/handler",j9="emulator/auth/handler",z9=encodeURIComponent("fac");async function oy(t,e,r,n,s,i){Pe(t.config.authDomain,t,"auth-domain-config-required"),Pe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:cl,eventId:s};if(e instanceof tk){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",w8(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof hu){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${z9}=${encodeURIComponent(l)}`:"";return`${$9(t)}?${cu(o).slice(1)}${c}`}function $9({config:t}){return t.emulator?Hg(t,j9):`https://${t.authDomain}/${B9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="webStorageSupport";class H9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lk,this._completeRedirectFn=p9,this._overrideRedirectResult=f9}async _openPopup(e,r,n,s){var a;Zs((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await oy(e,r,n,Xp(),s);return V9(e,i,Xg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await oy(e,r,n,Xp(),s);return KM(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Zs(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await F9(e),n=new g9(e);return r.register("authEvent",s=>(Pe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Nd,{type:Nd},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Nd];i!==void 0&&r(!!i),ns(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=E9(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return YA()||HA()||Gg()}}const W9=H9;var ly="@firebase/auth",cy="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function q9(t){Ss(new rs("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Pe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QA(t)},c=new cM(n,s,i,l);return _M(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ss(new rs("auth-internal",e=>{const r=Ya(e.getProvider("auth").getImmediate());return(n=>new G9(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),On(ly,cy,K9(t)),On(ly,cy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X9=5*60,Y9=TA("authIdTokenMaxAge")||X9;let uy=null;const Q9=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Y9)return;const s=r==null?void 0:r.token;uy!==s&&(uy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function J9(t=zg()){const e=Xa(t,"auth");if(e.isInitialized())return e.getImmediate();const r=vM(t,{popupRedirectResolver:W9,persistence:[r9,HM,lk]}),n=TA("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=Q9(i.toString());UM(r,a,()=>a(r.currentUser)),VM(r,o=>a(o))}}const s=EA("auth");return s&&yM(r,`http://${s}`),r}function Z9(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}uM({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=_s("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",Z9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});q9("Browser");var eV="firebase",tV="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On(eV,tV,"app");var fy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ui,mk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,A){function k(){}k.prototype=A.prototype,y.D=A.prototype,y.prototype=new k,y.prototype.constructor=y,y.C=function(C,R,N){for(var F=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)F[Ee-2]=arguments[Ee];return A.prototype[R].apply(C,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,A,k){k||(k=0);var C=Array(16);if(typeof A=="string")for(var R=0;16>R;++R)C[R]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(R=0;16>R;++R)C[R]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=y.g[0],k=y.g[1],R=y.g[2];var N=y.g[3],F=A+(N^k&(R^N))+C[0]+3614090360&4294967295;A=k+(F<<7&4294967295|F>>>25),F=N+(R^A&(k^R))+C[1]+3905402710&4294967295,N=A+(F<<12&4294967295|F>>>20),F=R+(k^N&(A^k))+C[2]+606105819&4294967295,R=N+(F<<17&4294967295|F>>>15),F=k+(A^R&(N^A))+C[3]+3250441966&4294967295,k=R+(F<<22&4294967295|F>>>10),F=A+(N^k&(R^N))+C[4]+4118548399&4294967295,A=k+(F<<7&4294967295|F>>>25),F=N+(R^A&(k^R))+C[5]+1200080426&4294967295,N=A+(F<<12&4294967295|F>>>20),F=R+(k^N&(A^k))+C[6]+2821735955&4294967295,R=N+(F<<17&4294967295|F>>>15),F=k+(A^R&(N^A))+C[7]+4249261313&4294967295,k=R+(F<<22&4294967295|F>>>10),F=A+(N^k&(R^N))+C[8]+1770035416&4294967295,A=k+(F<<7&4294967295|F>>>25),F=N+(R^A&(k^R))+C[9]+2336552879&4294967295,N=A+(F<<12&4294967295|F>>>20),F=R+(k^N&(A^k))+C[10]+4294925233&4294967295,R=N+(F<<17&4294967295|F>>>15),F=k+(A^R&(N^A))+C[11]+2304563134&4294967295,k=R+(F<<22&4294967295|F>>>10),F=A+(N^k&(R^N))+C[12]+1804603682&4294967295,A=k+(F<<7&4294967295|F>>>25),F=N+(R^A&(k^R))+C[13]+4254626195&4294967295,N=A+(F<<12&4294967295|F>>>20),F=R+(k^N&(A^k))+C[14]+2792965006&4294967295,R=N+(F<<17&4294967295|F>>>15),F=k+(A^R&(N^A))+C[15]+1236535329&4294967295,k=R+(F<<22&4294967295|F>>>10),F=A+(R^N&(k^R))+C[1]+4129170786&4294967295,A=k+(F<<5&4294967295|F>>>27),F=N+(k^R&(A^k))+C[6]+3225465664&4294967295,N=A+(F<<9&4294967295|F>>>23),F=R+(A^k&(N^A))+C[11]+643717713&4294967295,R=N+(F<<14&4294967295|F>>>18),F=k+(N^A&(R^N))+C[0]+3921069994&4294967295,k=R+(F<<20&4294967295|F>>>12),F=A+(R^N&(k^R))+C[5]+3593408605&4294967295,A=k+(F<<5&4294967295|F>>>27),F=N+(k^R&(A^k))+C[10]+38016083&4294967295,N=A+(F<<9&4294967295|F>>>23),F=R+(A^k&(N^A))+C[15]+3634488961&4294967295,R=N+(F<<14&4294967295|F>>>18),F=k+(N^A&(R^N))+C[4]+3889429448&4294967295,k=R+(F<<20&4294967295|F>>>12),F=A+(R^N&(k^R))+C[9]+568446438&4294967295,A=k+(F<<5&4294967295|F>>>27),F=N+(k^R&(A^k))+C[14]+3275163606&4294967295,N=A+(F<<9&4294967295|F>>>23),F=R+(A^k&(N^A))+C[3]+4107603335&4294967295,R=N+(F<<14&4294967295|F>>>18),F=k+(N^A&(R^N))+C[8]+1163531501&4294967295,k=R+(F<<20&4294967295|F>>>12),F=A+(R^N&(k^R))+C[13]+2850285829&4294967295,A=k+(F<<5&4294967295|F>>>27),F=N+(k^R&(A^k))+C[2]+4243563512&4294967295,N=A+(F<<9&4294967295|F>>>23),F=R+(A^k&(N^A))+C[7]+1735328473&4294967295,R=N+(F<<14&4294967295|F>>>18),F=k+(N^A&(R^N))+C[12]+2368359562&4294967295,k=R+(F<<20&4294967295|F>>>12),F=A+(k^R^N)+C[5]+4294588738&4294967295,A=k+(F<<4&4294967295|F>>>28),F=N+(A^k^R)+C[8]+2272392833&4294967295,N=A+(F<<11&4294967295|F>>>21),F=R+(N^A^k)+C[11]+1839030562&4294967295,R=N+(F<<16&4294967295|F>>>16),F=k+(R^N^A)+C[14]+4259657740&4294967295,k=R+(F<<23&4294967295|F>>>9),F=A+(k^R^N)+C[1]+2763975236&4294967295,A=k+(F<<4&4294967295|F>>>28),F=N+(A^k^R)+C[4]+1272893353&4294967295,N=A+(F<<11&4294967295|F>>>21),F=R+(N^A^k)+C[7]+4139469664&4294967295,R=N+(F<<16&4294967295|F>>>16),F=k+(R^N^A)+C[10]+3200236656&4294967295,k=R+(F<<23&4294967295|F>>>9),F=A+(k^R^N)+C[13]+681279174&4294967295,A=k+(F<<4&4294967295|F>>>28),F=N+(A^k^R)+C[0]+3936430074&4294967295,N=A+(F<<11&4294967295|F>>>21),F=R+(N^A^k)+C[3]+3572445317&4294967295,R=N+(F<<16&4294967295|F>>>16),F=k+(R^N^A)+C[6]+76029189&4294967295,k=R+(F<<23&4294967295|F>>>9),F=A+(k^R^N)+C[9]+3654602809&4294967295,A=k+(F<<4&4294967295|F>>>28),F=N+(A^k^R)+C[12]+3873151461&4294967295,N=A+(F<<11&4294967295|F>>>21),F=R+(N^A^k)+C[15]+530742520&4294967295,R=N+(F<<16&4294967295|F>>>16),F=k+(R^N^A)+C[2]+3299628645&4294967295,k=R+(F<<23&4294967295|F>>>9),F=A+(R^(k|~N))+C[0]+4096336452&4294967295,A=k+(F<<6&4294967295|F>>>26),F=N+(k^(A|~R))+C[7]+1126891415&4294967295,N=A+(F<<10&4294967295|F>>>22),F=R+(A^(N|~k))+C[14]+2878612391&4294967295,R=N+(F<<15&4294967295|F>>>17),F=k+(N^(R|~A))+C[5]+4237533241&4294967295,k=R+(F<<21&4294967295|F>>>11),F=A+(R^(k|~N))+C[12]+1700485571&4294967295,A=k+(F<<6&4294967295|F>>>26),F=N+(k^(A|~R))+C[3]+2399980690&4294967295,N=A+(F<<10&4294967295|F>>>22),F=R+(A^(N|~k))+C[10]+4293915773&4294967295,R=N+(F<<15&4294967295|F>>>17),F=k+(N^(R|~A))+C[1]+2240044497&4294967295,k=R+(F<<21&4294967295|F>>>11),F=A+(R^(k|~N))+C[8]+1873313359&4294967295,A=k+(F<<6&4294967295|F>>>26),F=N+(k^(A|~R))+C[15]+4264355552&4294967295,N=A+(F<<10&4294967295|F>>>22),F=R+(A^(N|~k))+C[6]+2734768916&4294967295,R=N+(F<<15&4294967295|F>>>17),F=k+(N^(R|~A))+C[13]+1309151649&4294967295,k=R+(F<<21&4294967295|F>>>11),F=A+(R^(k|~N))+C[4]+4149444226&4294967295,A=k+(F<<6&4294967295|F>>>26),F=N+(k^(A|~R))+C[11]+3174756917&4294967295,N=A+(F<<10&4294967295|F>>>22),F=R+(A^(N|~k))+C[2]+718787259&4294967295,R=N+(F<<15&4294967295|F>>>17),F=k+(N^(R|~A))+C[9]+3951481745&4294967295,y.g[0]=y.g[0]+A&4294967295,y.g[1]=y.g[1]+(R+(F<<21&4294967295|F>>>11))&4294967295,y.g[2]=y.g[2]+R&4294967295,y.g[3]=y.g[3]+N&4294967295}n.prototype.u=function(y,A){A===void 0&&(A=y.length);for(var k=A-this.blockSize,C=this.B,R=this.h,N=0;N<A;){if(R==0)for(;N<=k;)s(this,y,N),N+=this.blockSize;if(typeof y=="string"){for(;N<A;)if(C[R++]=y.charCodeAt(N++),R==this.blockSize){s(this,C),R=0;break}}else for(;N<A;)if(C[R++]=y[N++],R==this.blockSize){s(this,C),R=0;break}}this.h=R,this.o+=A},n.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var A=1;A<y.length-8;++A)y[A]=0;var k=8*this.o;for(A=y.length-8;A<y.length;++A)y[A]=k&255,k/=256;for(this.u(y),y=Array(16),A=k=0;4>A;++A)for(var C=0;32>C;C+=8)y[k++]=this.g[A]>>>C&255;return y};function i(y,A){var k=o;return Object.prototype.hasOwnProperty.call(k,y)?k[y]:k[y]=A(y)}function a(y,A){this.h=A;for(var k=[],C=!0,R=y.length-1;0<=R;R--){var N=y[R]|0;C&&N==A||(k[R]=N,C=!1)}this.g=k}var o={};function l(y){return-128<=y&&128>y?i(y,function(A){return new a([A|0],0>A?-1:0)}):new a([y|0],0>y?-1:0)}function c(y){if(isNaN(y)||!isFinite(y))return h;if(0>y)return w(c(-y));for(var A=[],k=1,C=0;y>=k;C++)A[C]=y/k|0,k*=4294967296;return new a(A,0)}function f(y,A){if(y.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(y.charAt(0)=="-")return w(f(y.substring(1),A));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(A,8)),C=h,R=0;R<y.length;R+=8){var N=Math.min(8,y.length-R),F=parseInt(y.substring(R,R+N),A);8>N?(N=c(Math.pow(A,N)),C=C.j(N).add(c(F))):(C=C.j(k),C=C.add(c(F)))}return C}var h=l(0),d=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-w(this).m();for(var y=0,A=1,k=0;k<this.g.length;k++){var C=this.i(k);y+=(0<=C?C:4294967296+C)*A,A*=4294967296}return y},t.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(x(this))return"0";if(g(this))return"-"+w(this).toString(y);for(var A=c(Math.pow(y,6)),k=this,C="";;){var R=D(k,A).g;k=T(k,R.j(A));var N=((0<k.g.length?k.g[0]:k.h)>>>0).toString(y);if(k=R,x(k))return N+C;for(;6>N.length;)N="0"+N;C=N+C}},t.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function x(y){if(y.h!=0)return!1;for(var A=0;A<y.g.length;A++)if(y.g[A]!=0)return!1;return!0}function g(y){return y.h==-1}t.l=function(y){return y=T(this,y),g(y)?-1:x(y)?0:1};function w(y){for(var A=y.g.length,k=[],C=0;C<A;C++)k[C]=~y.g[C];return new a(k,~y.h).add(d)}t.abs=function(){return g(this)?w(this):this},t.add=function(y){for(var A=Math.max(this.g.length,y.g.length),k=[],C=0,R=0;R<=A;R++){var N=C+(this.i(R)&65535)+(y.i(R)&65535),F=(N>>>16)+(this.i(R)>>>16)+(y.i(R)>>>16);C=F>>>16,N&=65535,F&=65535,k[R]=F<<16|N}return new a(k,k[k.length-1]&-2147483648?-1:0)};function T(y,A){return y.add(w(A))}t.j=function(y){if(x(this)||x(y))return h;if(g(this))return g(y)?w(this).j(w(y)):w(w(this).j(y));if(g(y))return w(this.j(w(y)));if(0>this.l(m)&&0>y.l(m))return c(this.m()*y.m());for(var A=this.g.length+y.g.length,k=[],C=0;C<2*A;C++)k[C]=0;for(C=0;C<this.g.length;C++)for(var R=0;R<y.g.length;R++){var N=this.i(C)>>>16,F=this.i(C)&65535,Ee=y.i(R)>>>16,he=y.i(R)&65535;k[2*C+2*R]+=F*he,_(k,2*C+2*R),k[2*C+2*R+1]+=N*he,_(k,2*C+2*R+1),k[2*C+2*R+1]+=F*Ee,_(k,2*C+2*R+1),k[2*C+2*R+2]+=N*Ee,_(k,2*C+2*R+2)}for(C=0;C<A;C++)k[C]=k[2*C+1]<<16|k[2*C];for(C=A;C<2*A;C++)k[C]=0;return new a(k,0)};function _(y,A){for(;(y[A]&65535)!=y[A];)y[A+1]+=y[A]>>>16,y[A]&=65535,A++}function v(y,A){this.g=y,this.h=A}function D(y,A){if(x(A))throw Error("division by zero");if(x(y))return new v(h,h);if(g(y))return A=D(w(y),A),new v(w(A.g),w(A.h));if(g(A))return A=D(y,w(A)),new v(w(A.g),A.h);if(30<y.g.length){if(g(y)||g(A))throw Error("slowDivide_ only works with positive integers.");for(var k=d,C=A;0>=C.l(y);)k=z(k),C=z(C);var R=B(k,1),N=B(C,1);for(C=B(C,2),k=B(k,2);!x(C);){var F=N.add(C);0>=F.l(y)&&(R=R.add(k),N=F),C=B(C,1),k=B(k,1)}return A=T(y,R.j(A)),new v(R,A)}for(R=h;0<=y.l(A);){for(k=Math.max(1,Math.floor(y.m()/A.m())),C=Math.ceil(Math.log(k)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),N=c(k),F=N.j(A);g(F)||0<F.l(y);)k-=C,N=c(k),F=N.j(A);x(N)&&(N=d),R=R.add(N),y=T(y,F)}return new v(R,y)}t.A=function(y){return D(this,y).h},t.and=function(y){for(var A=Math.max(this.g.length,y.g.length),k=[],C=0;C<A;C++)k[C]=this.i(C)&y.i(C);return new a(k,this.h&y.h)},t.or=function(y){for(var A=Math.max(this.g.length,y.g.length),k=[],C=0;C<A;C++)k[C]=this.i(C)|y.i(C);return new a(k,this.h|y.h)},t.xor=function(y){for(var A=Math.max(this.g.length,y.g.length),k=[],C=0;C<A;C++)k[C]=this.i(C)^y.i(C);return new a(k,this.h^y.h)};function z(y){for(var A=y.g.length+1,k=[],C=0;C<A;C++)k[C]=y.i(C)<<1|y.i(C-1)>>>31;return new a(k,y.h)}function B(y,A){var k=A>>5;A%=32;for(var C=y.g.length-k,R=[],N=0;N<C;N++)R[N]=0<A?y.i(N+k)>>>A|y.i(N+k+1)<<32-A:y.i(N+k);return new a(R,y.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,mk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Ui=a}).apply(typeof fy<"u"?fy:typeof self<"u"?self:typeof window<"u"?window:{});var af=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gk,zl,xk,Pf,Zp,vk,_k,yk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,E){return u==Array.prototype||u==Object.prototype||(u[p]=E.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof af=="object"&&af];for(var p=0;p<u.length;++p){var E=u[p];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=r(this);function s(u,p){if(p)e:{var E=n;u=u.split(".");for(var P=0;P<u.length-1;P++){var q=u[P];if(!(q in E))break e;E=E[q]}u=u[u.length-1],P=E[u],p=p(P),p!=P&&p!=null&&e(E,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var E=0,P=!1,q={next:function(){if(!P&&E<u.length){var Z=E++;return{value:p(Z,u[Z]),done:!1}}return P=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function f(u,p,E){return u.call.apply(u.bind,arguments)}function h(u,p,E){if(!u)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,P),u.apply(p,q)}}return function(){return u.apply(p,arguments)}}function d(u,p,E){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,p){var E=Array.prototype.slice.call(arguments,1);return function(){var P=E.slice();return P.push.apply(P,arguments),u.apply(this,P)}}function x(u,p){function E(){}E.prototype=p.prototype,u.aa=p.prototype,u.prototype=new E,u.prototype.constructor=u,u.Qb=function(P,q,Z){for(var me=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)me[mt-2]=arguments[mt];return p.prototype[q].apply(P,me)}}function g(u){const p=u.length;if(0<p){const E=Array(p);for(let P=0;P<p;P++)E[P]=u[P];return E}return[]}function w(u,p){for(let E=1;E<arguments.length;E++){const P=arguments[E];if(l(P)){const q=u.length||0,Z=P.length||0;u.length=q+Z;for(let me=0;me<Z;me++)u[q+me]=P[me]}else u.push(P)}}class T{constructor(p,E){this.i=p,this.j=E,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function _(u){return/^[\s\xa0]*$/.test(u)}function v(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function D(u){return D[" "](u),u}D[" "]=function(){};var z=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function B(u,p,E){for(const P in u)p.call(E,u[P],P,u)}function y(u,p){for(const E in u)p.call(void 0,u[E],E,u)}function A(u){const p={};for(const E in u)p[E]=u[E];return p}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let E,P;for(let q=1;q<arguments.length;q++){P=arguments[q];for(E in P)u[E]=P[E];for(let Z=0;Z<k.length;Z++)E=k[Z],Object.prototype.hasOwnProperty.call(P,E)&&(u[E]=P[E])}}function R(u){var p=1;u=u.split(":");const E=[];for(;0<p&&u.length;)E.push(u.shift()),p--;return u.length&&E.push(u.join(":")),E}function N(u){o.setTimeout(()=>{throw u},0)}function F(){var u=W;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Ee{constructor(){this.h=this.g=null}add(p,E){const P=he.get();P.set(p,E),this.h?this.h.next=P:this.g=P,this.h=P}}var he=new T(()=>new ke,u=>u.reset());class ke{constructor(){this.next=this.g=this.h=null}set(p,E){this.h=p,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,ae=!1,W=new Ee,le=()=>{const u=o.Promise.resolve(void 0);ve=()=>{u.then(we)}};var we=()=>{for(var u;u=F();){try{u.h.call(u.g)}catch(E){N(E)}var p=he;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ae=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const E=()=>{};o.addEventListener("test",E,p),o.removeEventListener("test",E,p)}catch{}return u}();function H(u,p){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var E=this.type=u.type,P=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(z){e:{try{D(p.nodeName);var q=!0;break e}catch{}q=!1}q||(p=null)}}else E=="mouseover"?p=u.fromElement:E=="mouseout"&&(p=u.toElement);this.relatedTarget=p,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:te[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}x(H,K);var te={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),xe=0;function de(u,p,E,P,q){this.listener=u,this.proxy=null,this.src=p,this.type=E,this.capture=!!P,this.ha=q,this.key=++xe,this.da=this.fa=!1}function ie(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ue(u){this.src=u,this.g={},this.h=0}Ue.prototype.add=function(u,p,E,P,q){var Z=u.toString();u=this.g[Z],u||(u=this.g[Z]=[],this.h++);var me=ht(u,p,P,q);return-1<me?(p=u[me],E||(p.fa=!1)):(p=new de(p,this.src,Z,!!P,q),p.fa=E,u.push(p)),p};function j(u,p){var E=p.type;if(E in u.g){var P=u.g[E],q=Array.prototype.indexOf.call(P,p,void 0),Z;(Z=0<=q)&&Array.prototype.splice.call(P,q,1),Z&&(ie(p),u.g[E].length==0&&(delete u.g[E],u.h--))}}function ht(u,p,E,P){for(var q=0;q<u.length;++q){var Z=u[q];if(!Z.da&&Z.listener==p&&Z.capture==!!E&&Z.ha==P)return q}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),Ge={};function Be(u,p,E,P,q){if(Array.isArray(p)){for(var Z=0;Z<p.length;Z++)Be(u,p[Z],E,P,q);return null}return E=Zr(E),u&&u[fe]?u.K(p,E,c(P)?!!P.capture:!1,q):ge(u,p,E,!1,P,q)}function ge(u,p,E,P,q,Z){if(!p)throw Error("Invalid event type");var me=c(q)?!!q.capture:!!q,mt=Jr(u);if(mt||(u[$e]=mt=new Ue(u)),E=mt.add(p,E,P,me,Z),E.proxy)return E;if(P=gt(),E.proxy=P,P.src=u,P.listener=E,u.addEventListener)G||(q=me),q===void 0&&(q=!1),u.addEventListener(p.toString(),P,q);else if(u.attachEvent)u.attachEvent(Qr(p.toString()),P);else if(u.addListener&&u.removeListener)u.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return E}function gt(){function u(E){return p.call(u.src,u.listener,E)}const p=Ns;return u}function ur(u,p,E,P,q){if(Array.isArray(p))for(var Z=0;Z<p.length;Z++)ur(u,p[Z],E,P,q);else P=c(P)?!!P.capture:!!P,E=Zr(E),u&&u[fe]?(u=u.i,p=String(p).toString(),p in u.g&&(Z=u.g[p],E=ht(Z,E,P,q),-1<E&&(ie(Z[E]),Array.prototype.splice.call(Z,E,1),Z.length==0&&(delete u.g[p],u.h--)))):u&&(u=Jr(u))&&(p=u.g[p.toString()],u=-1,p&&(u=ht(p,E,P,q)),(E=-1<u?p[u]:null)&&Er(E))}function Er(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[fe])j(p.i,u);else{var E=u.type,P=u.proxy;p.removeEventListener?p.removeEventListener(E,P,u.capture):p.detachEvent?p.detachEvent(Qr(E),P):p.addListener&&p.removeListener&&p.removeListener(P),(E=Jr(p))?(j(E,u),E.h==0&&(E.src=null,p[$e]=null)):ie(u)}}}function Qr(u){return u in Ge?Ge[u]:Ge[u]="on"+u}function Ns(u,p){if(u.da)u=!0;else{p=new H(p,this);var E=u.listener,P=u.ha||u.src;u.fa&&Er(u),u=E.call(P,p)}return u}function Jr(u){return u=u[$e],u instanceof Ue?u:null}var Jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zr(u){return typeof u=="function"?u:(u[Jt]||(u[Jt]=function(p){return u.handleEvent(p)}),u[Jt])}function dt(){L.call(this),this.i=new Ue(this),this.M=this,this.F=null}x(dt,L),dt.prototype[fe]=!0,dt.prototype.removeEventListener=function(u,p,E,P){ur(this,u,p,E,P)};function At(u,p){var E,P=u.F;if(P)for(E=[];P;P=P.F)E.push(P);if(u=u.M,P=p.type||p,typeof p=="string")p=new K(p,u);else if(p instanceof K)p.target=p.target||u;else{var q=p;p=new K(P,u),C(p,q)}if(q=!0,E)for(var Z=E.length-1;0<=Z;Z--){var me=p.g=E[Z];q=Dt(me,P,!0,p)&&q}if(me=p.g=u,q=Dt(me,P,!0,p)&&q,q=Dt(me,P,!1,p)&&q,E)for(Z=0;Z<E.length;Z++)me=p.g=E[Z],q=Dt(me,P,!1,p)&&q}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var E=u.g[p],P=0;P<E.length;P++)ie(E[P]);delete u.g[p],u.h--}}this.F=null},dt.prototype.K=function(u,p,E,P){return this.i.add(String(u),p,!1,E,P)},dt.prototype.L=function(u,p,E,P){return this.i.add(String(u),p,!0,E,P)};function Dt(u,p,E,P){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var q=!0,Z=0;Z<p.length;++Z){var me=p[Z];if(me&&!me.da&&me.capture==E){var mt=me.listener,fr=me.ha||me.src;me.fa&&j(u.i,me),q=mt.call(fr,P)!==!1&&q}}return q&&!P.defaultPrevented}function Br(u,p,E){if(typeof u=="function")E&&(u=d(u,E));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function je(u){u.g=Br(()=>{u.g=null,u.i&&(u.i=!1,je(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class it extends L{constructor(p,E){super(),this.m=p,this.l=E,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ht(u){L.call(this),this.h=u,this.g={}}x(Ht,L);var ut=[];function An(u){B(u.g,function(p,E){this.g.hasOwnProperty(E)&&Er(p)},u),u.g={}}Ht.prototype.N=function(){Ht.aa.N.call(this),An(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ii=o.JSON.stringify,aa=o.JSON.parse,gl=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function ai(){}ai.prototype.h=null;function oa(u){return u.h||(u.h=u.i())}function ne(){}var Ie={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Oe(){K.call(this,"d")}x(Oe,K);function Ne(){K.call(this,"c")}x(Ne,K);var ye={},Qe=null;function rt(){return Qe=Qe||new dt}ye.La="serverreachability";function ft(u){K.call(this,ye.La,u)}x(ft,K);function kt(u){const p=rt();At(p,new ft(p))}ye.STAT_EVENT="statevent";function Bn(u,p){K.call(this,ye.STAT_EVENT,u),this.stat=p}x(Bn,K);function Je(u){const p=rt();At(p,new Bn(p,u))}ye.Ma="timingevent";function jr(u,p){K.call(this,ye.Ma,u),this.size=p}x(jr,K);function wr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function un(){this.g=!0}un.prototype.xa=function(){this.g=!1};function O0(u,p,E,P,q,Z){u.info(function(){if(u.g)if(Z)for(var me="",mt=Z.split("&"),fr=0;fr<mt.length;fr++){var at=mt[fr].split("=");if(1<at.length){var Tr=at[0];at=at[1];var Ar=Tr.split("_");me=2<=Ar.length&&Ar[1]=="type"?me+(Tr+"="+at+"&"):me+(Tr+"=redacted&")}}else me=null;else me=Z;return"XMLHTTP REQ ("+P+") [attempt "+q+"]: "+p+`
`+E+`
`+me})}function b0(u,p,E,P,q,Z,me){u.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+q+"]: "+p+`
`+E+`
`+Z+" "+me})}function I(u,p,E,P){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+O(u,E)+(P?" "+P:"")})}function M(u,p){u.info(function(){return"TIMEOUT: "+p})}un.prototype.info=function(){};function O(u,p){if(!u.g)return p;if(!p)return null;try{var E=JSON.parse(p);if(E){for(u=0;u<E.length;u++)if(Array.isArray(E[u])){var P=E[u];if(!(2>P.length)){var q=P[1];if(Array.isArray(q)&&!(1>q.length)){var Z=q[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(var me=1;me<q.length;me++)q[me]=""}}}}return ii(E)}catch{return p}}var b={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function X(){}x(X,ai),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},U=new X;function ee(u,p,E,P){this.j=u,this.i=p,this.l=E,this.R=P||1,this.U=new Ht(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},J={};function oe(u,p,E){u.L=1,u.v=Tu(Fs(p)),u.m=E,u.P=!0,pe(u,null)}function pe(u,p){u.F=Date.now(),_e(u),u.A=Fs(u.v);var E=u.A,P=u.R;Array.isArray(P)||(P=[String(P)]),q1(E.i,"t",P),u.C=0,E=u.j.J,u.h=new Y,u.g=hx(u.j,E?p:null,!u.m),0<u.O&&(u.M=new it(d(u.Y,u,u.g),u.O)),p=u.U,E=u.g,P=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(ut[0]=q.toString()),q=ut);for(var Z=0;Z<q.length;Z++){var me=Be(E,q[Z],P||p.handleEvent,!1,p.h||p);if(!me)break;p.g[me.key]=me}p=u.H?A(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),kt(),O0(u.i,u.u,u.A,u.l,u.R,u.m)}ee.prototype.ca=function(u){u=u.target;const p=this.M;p&&Ds(u)==3?p.j():this.Y(u)},ee.prototype.Y=function(u){try{if(u==this.g)e:{const Ar=Ds(this.g);var p=this.g.Ba();const no=this.g.Z();if(!(3>Ar)&&(Ar!=3||this.g&&(this.h.h||this.g.oa()||tx(this.g)))){this.J||Ar!=4||p==7||(p==8||0>=no?kt(3):kt(2)),pt(this);var E=this.g.Z();this.X=E;t:if(Ae(this)){var P=tx(this.g);u="";var q=P.length,Z=Ds(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){St(this),lt(this);var me="";break t}this.h.i=new o.TextDecoder}for(p=0;p<q;p++)this.h.h=!0,u+=this.h.i.decode(P[p],{stream:!(Z&&p==q-1)});P.length=0,this.h.g+=u,this.C=0,me=this.h.g}else me=this.g.oa();if(this.o=E==200,b0(this.i,this.u,this.A,this.l,this.R,Ar,E),this.o){if(this.T&&!this.K){t:{if(this.g){var mt,fr=this.g;if((mt=fr.g?fr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(mt)){var at=mt;break t}}at=null}if(E=at)I(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ps(this,E);else{this.o=!1,this.s=3,Je(12),St(this),lt(this);break e}}if(this.P){E=!0;let jn;for(;!this.J&&this.C<me.length;)if(jn=ue(this,me),jn==J){Ar==4&&(this.s=4,Je(14),E=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==Q){this.s=4,Je(15),I(this.i,this.l,me,"[Invalid Chunk]"),E=!1;break}else I(this.i,this.l,jn,null),Ps(this,jn);if(Ae(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ar!=4||me.length!=0||this.h.h||(this.s=1,Je(16),E=!1),this.o=this.o&&E,!E)I(this.i,this.l,me,"[Invalid Chunked Response]"),St(this),lt(this);else if(0<me.length&&!this.W){this.W=!0;var Tr=this.j;Tr.g==this&&Tr.ba&&!Tr.M&&(Tr.j.info("Great, no buffering proxy detected. Bytes received: "+me.length),B0(Tr),Tr.M=!0,Je(11))}}else I(this.i,this.l,me,null),Ps(this,me);Ar==4&&St(this),this.o&&!this.J&&(Ar==4?lx(this.j,this):(this.o=!1,_e(this)))}else BI(this.g),E==400&&0<me.indexOf("Unknown SID")?(this.s=3,Je(12)):(this.s=0,Je(13)),St(this),lt(this)}}}catch{}finally{}};function Ae(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ue(u,p){var E=u.C,P=p.indexOf(`
`,E);return P==-1?J:(E=Number(p.substring(E,P)),isNaN(E)?Q:(P+=1,P+E>p.length?J:(p=p.slice(P,P+E),u.C=P+E,p)))}ee.prototype.cancel=function(){this.J=!0,St(this)};function _e(u){u.S=Date.now()+u.I,be(u,u.I)}function be(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=wr(d(u.ba,u),p)}function pt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ee.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(M(this.i,this.A),this.L!=2&&(kt(),Je(17)),St(this),this.s=2,lt(this)):be(this,this.S-u)};function lt(u){u.j.G==0||u.J||lx(u.j,u)}function St(u){pt(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,An(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Ps(u,p){try{var E=u.j;if(E.G!=0&&(E.g==u||fn(E.h,u))){if(!u.K&&fn(E.h,u)&&E.G==3){try{var P=E.Da.g.parse(p)}catch{P=null}if(Array.isArray(P)&&P.length==3){var q=P;if(q[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<u.F)Ru(E),Iu(E);else break e;U0(E),Je(18)}}else E.za=q[1],0<E.za-E.T&&37500>q[2]&&E.F&&E.v==0&&!E.C&&(E.C=wr(d(E.Za,E),6e3));if(1>=eo(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ua(E,11)}else if((u.K||E.g==u)&&Ru(E),!_(p))for(q=E.Da.g.parse(p),p=0;p<q.length;p++){let at=q[p];if(E.T=at[0],at=at[1],E.G==2)if(at[0]=="c"){E.K=at[1],E.ia=at[2];const Tr=at[3];Tr!=null&&(E.la=Tr,E.j.info("VER="+E.la));const Ar=at[4];Ar!=null&&(E.Aa=Ar,E.j.info("SVER="+E.Aa));const no=at[5];no!=null&&typeof no=="number"&&0<no&&(P=1.5*no,E.L=P,E.j.info("backChannelRequestTimeoutMs_="+P)),P=E;const jn=u.g;if(jn){const Pu=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pu){var Z=P.h;Z.g||Pu.indexOf("spdy")==-1&&Pu.indexOf("quic")==-1&&Pu.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(L0(Z,Z.h),Z.h=null))}if(P.D){const j0=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;j0&&(P.ya=j0,yt(P.I,P.D,j0))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-u.F,E.j.info("Handshake RTT: "+E.R+"ms")),P=E;var me=u;if(P.qa=fx(P,P.J?P.ia:null,P.W),me.K){B1(P.h,me);var mt=me,fr=P.L;fr&&(mt.I=fr),mt.B&&(pt(mt),_e(mt)),P.g=me}else ax(P);0<E.i.length&&Cu(E)}else at[0]!="stop"&&at[0]!="close"||ua(E,7);else E.G==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?ua(E,7):V0(E):at[0]!="noop"&&E.l&&E.l.ta(at),E.v=0)}}kt(4)}catch{}}var la=class{constructor(u,p){this.g=u,this.map=p}};function oi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function os(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function eo(u){return u.h?1:u.g?u.g.size:0}function fn(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function L0(u,p){u.g?u.g.add(p):u.h=p}function B1(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}oi.prototype.cancel=function(){if(this.i=j1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function j1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const E of u.g.values())p=p.concat(E.D);return p}return g(u.i)}function kI(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],E=u.length,P=0;P<E;P++)p.push(u[P]);return p}p=[],E=0;for(P in u)p[E++]=u[P];return p}function SI(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var E=0;E<u;E++)p.push(E);return p}p=[],E=0;for(const P in u)p[E++]=P;return p}}}function z1(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var E=SI(u),P=kI(u),q=P.length,Z=0;Z<q;Z++)p.call(void 0,P[Z],E&&E[Z],u)}var $1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function II(u,p){if(u){u=u.split("&");for(var E=0;E<u.length;E++){var P=u[E].indexOf("="),q=null;if(0<=P){var Z=u[E].substring(0,P);q=u[E].substring(P+1)}else Z=u[E];p(Z,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function ca(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ca){this.h=u.h,Eu(this,u.j),this.o=u.o,this.g=u.g,wu(this,u.s),this.l=u.l;var p=u.i,E=new _l;E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),H1(this,E),this.m=u.m}else u&&(p=String(u).match($1))?(this.h=!1,Eu(this,p[1]||"",!0),this.o=xl(p[2]||""),this.g=xl(p[3]||"",!0),wu(this,p[4]),this.l=xl(p[5]||"",!0),H1(this,p[6]||"",!0),this.m=xl(p[7]||"")):(this.h=!1,this.i=new _l(null,this.h))}ca.prototype.toString=function(){var u=[],p=this.j;p&&u.push(vl(p,W1,!0),":");var E=this.g;return(E||p=="file")&&(u.push("//"),(p=this.o)&&u.push(vl(p,W1,!0),"@"),u.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&u.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(vl(E,E.charAt(0)=="/"?NI:RI,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",vl(E,FI)),u.join("")};function Fs(u){return new ca(u)}function Eu(u,p,E){u.j=E?xl(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function wu(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function H1(u,p,E){p instanceof _l?(u.i=p,DI(u.i,u.h)):(E||(p=vl(p,PI)),u.i=new _l(p,u.h))}function yt(u,p,E){u.i.set(p,E)}function Tu(u){return yt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function xl(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function vl(u,p,E){return typeof u=="string"?(u=encodeURI(u).replace(p,CI),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function CI(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var W1=/[#\/\?@]/g,RI=/[#\?:]/g,NI=/[#\?]/g,PI=/[#\?@]/g,FI=/#/g;function _l(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function li(u){u.g||(u.g=new Map,u.h=0,u.i&&II(u.i,function(p,E){u.add(decodeURIComponent(p.replace(/\+/g," ")),E)}))}t=_l.prototype,t.add=function(u,p){li(this),this.i=null,u=to(this,u);var E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(p),this.h+=1,this};function G1(u,p){li(u),p=to(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function K1(u,p){return li(u),p=to(u,p),u.g.has(p)}t.forEach=function(u,p){li(this),this.g.forEach(function(E,P){E.forEach(function(q){u.call(p,q,P,this)},this)},this)},t.na=function(){li(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),E=[];for(let P=0;P<p.length;P++){const q=u[P];for(let Z=0;Z<q.length;Z++)E.push(p[P])}return E},t.V=function(u){li(this);let p=[];if(typeof u=="string")K1(this,u)&&(p=p.concat(this.g.get(to(this,u))));else{u=Array.from(this.g.values());for(let E=0;E<u.length;E++)p=p.concat(u[E])}return p},t.set=function(u,p){return li(this),this.i=null,u=to(this,u),K1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function q1(u,p,E){G1(u,p),0<E.length&&(u.i=null,u.g.set(to(u,p),g(E)),u.h+=E.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var E=0;E<p.length;E++){var P=p[E];const Z=encodeURIComponent(String(P)),me=this.V(P);for(P=0;P<me.length;P++){var q=Z;me[P]!==""&&(q+="="+encodeURIComponent(String(me[P]))),u.push(q)}}return this.i=u.join("&")};function to(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function DI(u,p){p&&!u.j&&(li(u),u.i=null,u.g.forEach(function(E,P){var q=P.toLowerCase();P!=q&&(G1(this,P),q1(this,q,E))},u)),u.j=p}function OI(u,p){const E=new un;if(o.Image){const P=new Image;P.onload=m(ci,E,"TestLoadImage: loaded",!0,p,P),P.onerror=m(ci,E,"TestLoadImage: error",!1,p,P),P.onabort=m(ci,E,"TestLoadImage: abort",!1,p,P),P.ontimeout=m(ci,E,"TestLoadImage: timeout",!1,p,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=u}else p(!1)}function bI(u,p){const E=new un,P=new AbortController,q=setTimeout(()=>{P.abort(),ci(E,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:P.signal}).then(Z=>{clearTimeout(q),Z.ok?ci(E,"TestPingServer: ok",!0,p):ci(E,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(q),ci(E,"TestPingServer: error",!1,p)})}function ci(u,p,E,P,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),P(E)}catch{}}function LI(){this.g=new gl}function MI(u,p,E){const P=E||"";try{z1(u,function(q,Z){let me=q;c(q)&&(me=ii(q)),p.push(P+Z+"="+encodeURIComponent(me))})}catch(q){throw p.push(P+"type="+encodeURIComponent("_badmap")),q}}function Au(u){this.l=u.Ub||null,this.j=u.eb||!1}x(Au,ai),Au.prototype.g=function(){return new ku(this.l,this.j)},Au.prototype.i=function(u){return function(){return u}}({});function ku(u,p){dt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(ku,dt),t=ku.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,El(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,El(this)),this.g&&(this.readyState=3,El(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;X1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function X1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?yl(this):El(this),this.readyState==3&&X1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,yl(this))},t.Qa=function(u){this.g&&(this.response=u,yl(this))},t.ga=function(){this.g&&yl(this)};function yl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,El(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var E=p.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=p.next();return u.join(`\r
`)};function El(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Y1(u){let p="";return B(u,function(E,P){p+=P,p+=":",p+=E,p+=`\r
`}),p}function M0(u,p,E){e:{for(P in E){var P=!1;break e}P=!0}P||(E=Y1(E),typeof u=="string"?E!=null&&encodeURIComponent(String(E)):yt(u,p,E))}function Ot(u){dt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Ot,dt);var VI=/^https?$/i,UI=["POST","PUT"];t=Ot.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,E,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?oa(this.o):oa(U),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(Z){Q1(this,Z);return}if(u=E||"",E=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var q in P)E.set(q,P[q]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const Z of P.keys())E.set(Z,P.get(Z));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(E.keys()).find(Z=>Z.toLowerCase()=="content-type"),q=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(UI,p,void 0))||P||q||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,me]of E)this.g.setRequestHeader(Z,me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ex(this),this.u=!0,this.g.send(u),this.u=!1}catch(Z){Q1(this,Z)}};function Q1(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,J1(u),Su(u)}function J1(u){u.A||(u.A=!0,At(u,"complete"),At(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,At(this,"complete"),At(this,"abort"),Su(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Su(this,!0)),Ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Z1(this):this.bb())},t.bb=function(){Z1(this)};function Z1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Ds(u)!=4||u.Z()!=2)){if(u.u&&Ds(u)==4)Br(u.Ea,0,u);else if(At(u,"readystatechange"),Ds(u)==4){u.h=!1;try{const me=u.Z();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var E;if(!(E=p)){var P;if(P=me===0){var q=String(u.D).match($1)[1]||null;!q&&o.self&&o.self.location&&(q=o.self.location.protocol.slice(0,-1)),P=!VI.test(q?q.toLowerCase():"")}E=P}if(E)At(u,"complete"),At(u,"success");else{u.m=6;try{var Z=2<Ds(u)?u.g.statusText:""}catch{Z=""}u.l=Z+" ["+u.Z()+"]",J1(u)}}finally{Su(u)}}}}function Su(u,p){if(u.g){ex(u);const E=u.g,P=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||At(u,"ready");try{E.onreadystatechange=P}catch{}}}function ex(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ds(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ds(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),aa(p)}};function tx(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function BI(u){const p={};u=(u.g&&2<=Ds(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<u.length;P++){if(_(u[P]))continue;var E=R(u[P]);const q=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const Z=p[q]||[];p[q]=Z,Z.push(E)}y(p,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wl(u,p,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||p}function rx(u){this.Aa=0,this.i=[],this.j=new un,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wl("baseRetryDelayMs",5e3,u),this.cb=wl("retryDelaySeedMs",1e4,u),this.Wa=wl("forwardChannelMaxRetries",2,u),this.wa=wl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new oi(u&&u.concurrentRequestLimit),this.Da=new LI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=rx.prototype,t.la=8,t.G=1,t.connect=function(u,p,E,P){Je(0),this.W=u,this.H=p||{},E&&P!==void 0&&(this.H.OSID=E,this.H.OAID=P),this.F=this.X,this.I=fx(this,null,this.W),Cu(this)};function V0(u){if(nx(u),u.G==3){var p=u.U++,E=Fs(u.I);if(yt(E,"SID",u.K),yt(E,"RID",p),yt(E,"TYPE","terminate"),Tl(u,E),p=new ee(u,u.j,p),p.L=2,p.v=Tu(Fs(E)),E=!1,o.navigator&&o.navigator.sendBeacon)try{E=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!E&&o.Image&&(new Image().src=p.v,E=!0),E||(p.g=hx(p.j,null),p.g.ea(p.v)),p.F=Date.now(),_e(p)}ux(u)}function Iu(u){u.g&&(B0(u),u.g.cancel(),u.g=null)}function nx(u){Iu(u),u.u&&(o.clearTimeout(u.u),u.u=null),Ru(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Cu(u){if(!os(u.h)&&!u.s){u.s=!0;var p=u.Ga;ve||le(),ae||(ve(),ae=!0),W.add(p,u),u.B=0}}function jI(u,p){return eo(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=wr(d(u.Ga,u,p),cx(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new ee(this,this.j,u);let Z=this.o;if(this.S&&(Z?(Z=A(Z),C(Z,this.S)):Z=this.S),this.m!==null||this.O||(q.H=Z,Z=null),this.P)e:{for(var p=0,E=0;E<this.i.length;E++){t:{var P=this.i[E];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(p+=P,4096<p){p=E;break e}if(p===4096||E===this.i.length-1){p=E+1;break e}}p=1e3}else p=1e3;p=ix(this,q,p),E=Fs(this.I),yt(E,"RID",u),yt(E,"CVER",22),this.D&&yt(E,"X-HTTP-Session-Id",this.D),Tl(this,E),Z&&(this.O?p="headers="+encodeURIComponent(String(Y1(Z)))+"&"+p:this.m&&M0(E,this.m,Z)),L0(this.h,q),this.Ua&&yt(E,"TYPE","init"),this.P?(yt(E,"$req",p),yt(E,"SID","null"),q.T=!0,oe(q,E,null)):oe(q,E,p),this.G=2}}else this.G==3&&(u?sx(this,u):this.i.length==0||os(this.h)||sx(this))};function sx(u,p){var E;p?E=p.l:E=u.U++;const P=Fs(u.I);yt(P,"SID",u.K),yt(P,"RID",E),yt(P,"AID",u.T),Tl(u,P),u.m&&u.o&&M0(P,u.m,u.o),E=new ee(u,u.j,E,u.B+1),u.m===null&&(E.H=u.o),p&&(u.i=p.D.concat(u.i)),p=ix(u,E,1e3),E.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),L0(u.h,E),oe(E,P,p)}function Tl(u,p){u.H&&B(u.H,function(E,P){yt(p,P,E)}),u.l&&z1({},function(E,P){yt(p,P,E)})}function ix(u,p,E){E=Math.min(u.i.length,E);var P=u.l?d(u.l.Na,u.l,u):null;e:{var q=u.i;let Z=-1;for(;;){const me=["count="+E];Z==-1?0<E?(Z=q[0].g,me.push("ofs="+Z)):Z=0:me.push("ofs="+Z);let mt=!0;for(let fr=0;fr<E;fr++){let at=q[fr].g;const Tr=q[fr].map;if(at-=Z,0>at)Z=Math.max(0,q[fr].g-100),mt=!1;else try{MI(Tr,me,"req"+at+"_")}catch{P&&P(Tr)}}if(mt){P=me.join("&");break e}}}return u=u.i.splice(0,E),p.D=u,P}function ax(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;ve||le(),ae||(ve(),ae=!0),W.add(p,u),u.v=0}}function U0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=wr(d(u.Fa,u),cx(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,ox(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=wr(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Je(10),Iu(this),ox(this))};function B0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function ox(u){u.g=new ee(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=Fs(u.qa);yt(p,"RID","rpc"),yt(p,"SID",u.K),yt(p,"AID",u.T),yt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&yt(p,"TO",u.ja),yt(p,"TYPE","xmlhttp"),Tl(u,p),u.m&&u.o&&M0(p,u.m,u.o),u.L&&(u.g.I=u.L);var E=u.g;u=u.ia,E.L=1,E.v=Tu(Fs(p)),E.m=null,E.P=!0,pe(E,u)}t.Za=function(){this.C!=null&&(this.C=null,Iu(this),U0(this),Je(19))};function Ru(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function lx(u,p){var E=null;if(u.g==p){Ru(u),B0(u),u.g=null;var P=2}else if(fn(u.h,p))E=p.D,B1(u.h,p),P=1;else return;if(u.G!=0){if(p.o)if(P==1){E=p.m?p.m.length:0,p=Date.now()-p.F;var q=u.B;P=rt(),At(P,new jr(P,E)),Cu(u)}else ax(u);else if(q=p.s,q==3||q==0&&0<p.X||!(P==1&&jI(u,p)||P==2&&U0(u)))switch(E&&0<E.length&&(p=u.h,p.i=p.i.concat(E)),q){case 1:ua(u,5);break;case 4:ua(u,10);break;case 3:ua(u,6);break;default:ua(u,2)}}}function cx(u,p){let E=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(E*=2),E*p}function ua(u,p){if(u.j.info("Error code "+p),p==2){var E=d(u.fb,u),P=u.Xa;const q=!P;P=new ca(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Eu(P,"https"),Tu(P),q?OI(P.toString(),E):bI(P.toString(),E)}else Je(2);u.G=0,u.l&&u.l.sa(p),ux(u),nx(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Je(2)):(this.j.info("Failed to ping google.com"),Je(1))};function ux(u){if(u.G=0,u.ka=[],u.l){const p=j1(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ka,p),w(u.ka,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.ra()}}function fx(u,p,E){var P=E instanceof ca?Fs(E):new ca(E);if(P.g!="")p&&(P.g=p+"."+P.g),wu(P,P.s);else{var q=o.location;P=q.protocol,p=p?p+"."+q.hostname:q.hostname,q=+q.port;var Z=new ca(null);P&&Eu(Z,P),p&&(Z.g=p),q&&wu(Z,q),E&&(Z.l=E),P=Z}return E=u.D,p=u.ya,E&&p&&yt(P,E,p),yt(P,"VER",u.la),Tl(u,P),P}function hx(u,p,E){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Ot(new Au({eb:E})):new Ot(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function dx(){}t=dx.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Nu(){}Nu.prototype.g=function(u,p){return new hn(u,p)};function hn(u,p){dt.call(this),this.g=new rx(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!_(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!_(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new ro(this)}x(hn,dt),hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},hn.prototype.close=function(){V0(this.g)},hn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.u&&(E={},E.__data__=ii(u),u=E);p.i.push(new la(p.Ya++,u)),p.G==3&&Cu(p)},hn.prototype.N=function(){this.g.l=null,delete this.j,V0(this.g),delete this.g,hn.aa.N.call(this)};function px(u){Oe.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const E in p){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}x(px,Oe);function mx(){Ne.call(this),this.status=1}x(mx,Ne);function ro(u){this.g=u}x(ro,dx),ro.prototype.ua=function(){At(this.g,"a")},ro.prototype.ta=function(u){At(this.g,new px(u))},ro.prototype.sa=function(u){At(this.g,new mx)},ro.prototype.ra=function(){At(this.g,"b")},Nu.prototype.createWebChannel=Nu.prototype.g,hn.prototype.send=hn.prototype.o,hn.prototype.open=hn.prototype.m,hn.prototype.close=hn.prototype.close,yk=function(){return new Nu},_k=function(){return rt()},vk=ye,Zp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},b.NO_ERROR=0,b.TIMEOUT=8,b.HTTP_ERROR=6,Pf=b,V.COMPLETE="complete",xk=V,ne.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",dt.prototype.listen=dt.prototype.K,zl=ne,Ot.prototype.listenOnce=Ot.prototype.L,Ot.prototype.getLastError=Ot.prototype.Ka,Ot.prototype.getLastErrorCode=Ot.prototype.Ba,Ot.prototype.getStatus=Ot.prototype.Z,Ot.prototype.getResponseJson=Ot.prototype.Oa,Ot.prototype.getResponseText=Ot.prototype.oa,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Ha,gk=Ot}).apply(typeof af<"u"?af:typeof self<"u"?self:typeof window<"u"?window:{});const hy="@firebase/firestore",dy="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rr.UNAUTHENTICATED=new Rr(null),Rr.GOOGLE_CREDENTIALS=new Rr("google-credentials-uid"),Rr.FIRST_PARTY=new Rr("first-party-uid"),Rr.MOCK_USER=new Rr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new c0("@firebase/firestore");function oo(){return La.logLevel}function Se(t,...e){if(La.logLevel<=Ke.DEBUG){const r=e.map(Qg);La.debug(`Firestore (${fl}): ${t}`,...r)}}function ei(t,...e){if(La.logLevel<=Ke.ERROR){const r=e.map(Qg);La.error(`Firestore (${fl}): ${t}`,...r)}}function Yo(t,...e){if(La.logLevel<=Ke.WARN){const r=e.map(Qg);La.warn(`Firestore (${fl}): ${t}`,...r)}}function Qg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Ek(t,n,r)}function Ek(t,e,r){let n=`FIRESTORE (${fl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ei(n),new Error(n)}function ot(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||Ek(e,s,n)}function Ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends as{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Rr.UNAUTHENTICATED))}shutdown(){}}class nV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class sV{constructor(e){this.t=e,this.currentUser=Rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ot(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new Gs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gs,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gs)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ot(typeof n.accessToken=="string",31837,{l:n}),new wk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new Rr(e)}}class iV{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Rr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class aV{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new iV(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Rr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class py{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oV{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){ot(this.o===void 0,3512);const n=i=>{i.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new py(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ot(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new py(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=lV(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function qe(t,e){return t<e?-1:t>e?1:0}function em(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Pd(s)===Pd(i)?qe(s,i):Pd(s)?1:-1}return qe(t.length,e.length)}const cV=55296,uV=57343;function Pd(t){const e=t.charCodeAt(0);return e>=cV&&e<=uV}function Qo(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="__name__";class hs{constructor(e,r,n){r===void 0?r=0:r>e.length&&Fe(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Fe(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return hs.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof hs?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=hs.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return qe(e.length,r.length)}static compareSegments(e,r){const n=hs.isNumericId(e),s=hs.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?hs.extractNumericId(e).compare(hs.extractNumericId(r)):em(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ui.fromString(e.substring(4,e.length-2))}}class xt extends hs{construct(e,r,n){return new xt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new xt(r)}static emptyPath(){return new xt([])}}const fV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mr extends hs{construct(e,r,n){return new mr(e,r,n)}static isValidIdentifier(e){return fV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===my}static keyField(){return new mr([my])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Te(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Te(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Te(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Te(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mr(r)}static emptyPath(){return new mr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.path=e}static fromPath(e){return new Re(xt.fromString(e))}static fromName(e){return new Re(xt.fromString(e).popFirst(5))}static empty(){return new Re(xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return xt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Re(new xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(t,e,r){if(!r)throw new Te(re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function hV(t,e,r,n){if(e===!0&&n===!0)throw new Te(re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function gy(t){if(!Re.isDocumentKey(t))throw new Te(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xy(t){if(Re.isDocumentKey(t))throw new Te(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ak(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function d0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Fe(12329,{type:typeof t})}function ss(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=d0(t);throw new Te(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t,e){const r={typeString:t};return e&&(r.value=e),r}function pu(t,e){if(!Ak(t))throw new Te(re.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Te(re.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy=-62135596800,_y=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*_y);return new wt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Te(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<vy)throw new Te(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_y}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pu(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-vy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:Qt("string",wt._jsonSchemaVersion),seconds:Qt("number"),nanoseconds:Qt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{static fromTimestamp(e){return new Le(e)}static min(){return new Le(new wt(0,0))}static max(){return new Le(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=-1;function dV(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Le.fromTimestamp(n===1e9?new wt(r+1,0):new wt(r,n));return new Ki(s,Re.empty(),e)}function pV(t){return new Ki(t.readTime,t.key,Wc)}class Ki{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ki(Le.min(),Re.empty(),Wc)}static max(){return new Ki(Le.max(),Re.empty(),Wc)}}function mV(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Re.comparator(t.documentKey,e.documentKey),r!==0?r:qe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(t){if(t.code!==re.FAILED_PRECONDITION||t.message!==gV)throw t;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new se((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof se?r:se.resolve(r)}catch(r){return se.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):se.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):se.reject(r)}static resolve(e){return new se((r,n)=>{r(e)})}static reject(e){return new se((r,n)=>{n(e)})}static waitFor(e){return new se((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=se.resolve(!1);for(const n of e)r=r.next(s=>s?se.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new se((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(f=>{a[c]=f,++o,o===i&&n(a)},f=>s(f))}})}static doWhile(e,r){return new se((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function vV(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function dl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}p0.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg=-1;function m0(t){return t==null}function Ch(t){return t===0&&1/t==-1/0}function _V(t){return typeof t=="number"&&Number.isInteger(t)&&!Ch(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="";function yV(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=yy(e)),e=EV(t.get(r),e);return yy(e)}function EV(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case kk:r+="";break;default:r+=i}}return r}function yy(t){return t+kk+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ey(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function sa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Sk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,r){this.comparator=e,this.root=r||dr.EMPTY}insert(e,r){return new Ft(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new Ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new of(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new of(this.root,e,this.comparator,!1)}getReverseIterator(){return new of(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new of(this.root,e,this.comparator,!0)}}class of{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??dr.RED,this.left=s??dr.EMPTY,this.right=i??dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new dr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return dr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Fe(27949);return e+(this.isRed()?0:1)}}dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1;dr.EMPTY=new class{constructor(){this.size=0}get key(){throw Fe(57766)}get value(){throw Fe(16141)}get color(){throw Fe(16727)}get left(){throw Fe(29726)}get right(){throw Fe(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new dr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.comparator=e,this.data=new Ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new wy(this.data.getIterator())}getIteratorFrom(e){return new wy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof sr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new sr(this.comparator);return r.data=e,r}}class wy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.fields=e,e.sort(mr.comparator)}static empty(){return new xn([])}unionWith(e){let r=new sr(mr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new xn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Qo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ik("Invalid base64 string: "+i):i}}(e);return new yr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new yr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yr.EMPTY_BYTE_STRING=new yr("");const wV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){if(ot(!!t,39018),typeof t=="string"){let e=0;const r=wV.exec(t);if(ot(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Bt(t.seconds),nanos:Bt(t.nanos)}}function Bt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xi(t){return typeof t=="string"?yr.fromBase64String(t):yr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="server_timestamp",Rk="__type__",Nk="__previous_value__",Pk="__local_write_time__";function e1(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[Rk])==null?void 0:n.stringValue)===Ck}function g0(t){const e=t.mapValue.fields[Nk];return e1(e)?g0(e):e}function Gc(t){const e=qi(t.mapValue.fields[Pk].timestampValue);return new wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(e,r,n,s,i,a,o,l,c,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const Rh="(default)";class Kc{constructor(e,r){this.projectId=e,this.database=r||Rh}static empty(){return new Kc("","")}get isDefaultDatabase(){return this.database===Rh}isEqual(e){return e instanceof Kc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk="__type__",AV="__max__",lf={mapValue:{}},Dk="__vector__",Nh="value";function Yi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?e1(t)?4:SV(t)?9007199254740991:kV(t)?10:11:Fe(28295,{value:t})}function Is(t,e){if(t===e)return!0;const r=Yi(t);if(r!==Yi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Gc(t).isEqual(Gc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=qi(s.timestampValue),o=qi(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Xi(s.bytesValue).isEqual(Xi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Bt(s.geoPointValue.latitude)===Bt(i.geoPointValue.latitude)&&Bt(s.geoPointValue.longitude)===Bt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Bt(s.integerValue)===Bt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Bt(s.doubleValue),o=Bt(i.doubleValue);return a===o?Ch(a)===Ch(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Qo(t.arrayValue.values||[],e.arrayValue.values||[],Is);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Ey(a)!==Ey(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Is(a[l],o[l])))return!1;return!0}(t,e);default:return Fe(52216,{left:t})}}function qc(t,e){return(t.values||[]).find(r=>Is(r,e))!==void 0}function Jo(t,e){if(t===e)return 0;const r=Yi(t),n=Yi(e);if(r!==n)return qe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return qe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Bt(i.integerValue||i.doubleValue),l=Bt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return Ty(t.timestampValue,e.timestampValue);case 4:return Ty(Gc(t),Gc(e));case 5:return em(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Xi(i),l=Xi(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=qe(o[c],l[c]);if(f!==0)return f}return qe(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=qe(Bt(i.latitude),Bt(a.latitude));return o!==0?o:qe(Bt(i.longitude),Bt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Ay(t.arrayValue,e.arrayValue);case 10:return function(i,a){var d,m,x,g;const o=i.fields||{},l=a.fields||{},c=(d=o[Nh])==null?void 0:d.arrayValue,f=(m=l[Nh])==null?void 0:m.arrayValue,h=qe(((x=c==null?void 0:c.values)==null?void 0:x.length)||0,((g=f==null?void 0:f.values)==null?void 0:g.length)||0);return h!==0?h:Ay(c,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===lf.mapValue&&a===lf.mapValue)return 0;if(i===lf.mapValue)return 1;if(a===lf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=em(l[h],f[h]);if(d!==0)return d;const m=Jo(o[l[h]],c[f[h]]);if(m!==0)return m}return qe(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Fe(23264,{he:r})}}function Ty(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return qe(t,e);const r=qi(t),n=qi(e),s=qe(r.seconds,n.seconds);return s!==0?s:qe(r.nanos,n.nanos)}function Ay(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Jo(r[s],n[s]);if(i)return i}return qe(r.length,n.length)}function Zo(t){return tm(t)}function tm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=qi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Xi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Re.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=tm(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${tm(r.fields[a])}`;return s+"}"}(t.mapValue):Fe(61005,{value:t})}function Ff(t){switch(Yi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=g0(t);return e?16+Ff(e):16;case 5:return 2*t.stringValue.length;case 6:return Xi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+Ff(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return sa(n.fields,(i,a)=>{s+=i.length+Ff(a)}),s}(t.mapValue);default:throw Fe(13486,{value:t})}}function ky(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rm(t){return!!t&&"integerValue"in t}function t1(t){return!!t&&"arrayValue"in t}function Sy(t){return!!t&&"nullValue"in t}function Iy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Df(t){return!!t&&"mapValue"in t}function kV(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[Fk])==null?void 0:n.stringValue)===Dk}function hc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return sa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=hc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=hc(t.arrayValue.values[r]);return e}return{...t}}function SV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===AV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Df(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=hc(r)}setAll(e){let r=mr.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=hc(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Df(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Is(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Df(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){sa(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new nn(hc(this.value))}}function Ok(t){const e=[];return sa(t.fields,(r,n)=>{const s=new mr([r]);if(Df(n)){const i=Ok(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Fr(e,0,Le.min(),Le.min(),Le.min(),nn.empty(),0)}static newFoundDocument(e,r,n,s){return new Fr(e,1,r,Le.min(),n,s,0)}static newNoDocument(e,r){return new Fr(e,2,r,Le.min(),Le.min(),nn.empty(),0)}static newUnknownDocument(e,r){return new Fr(e,3,r,Le.min(),Le.min(),nn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,r){this.position=e,this.inclusive=r}}function Cy(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Re.comparator(Re.fromName(a.referenceValue),r.key):n=Jo(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Ry(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Is(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r="asc"){this.field=e,this.dir=r}}function IV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{}class Yt extends bk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new RV(e,r,n):r==="array-contains"?new FV(e,n):r==="in"?new DV(e,n):r==="not-in"?new OV(e,n):r==="array-contains-any"?new bV(e,n):new Yt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new NV(e,n):new PV(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Jo(r,this.value)):r!==null&&Yi(this.value)===Yi(r)&&this.matchesComparison(Jo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class is extends bk{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new is(e,r)}matches(e){return Lk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Lk(t){return t.op==="and"}function Mk(t){return CV(t)&&Lk(t)}function CV(t){for(const e of t.filters)if(e instanceof is)return!1;return!0}function nm(t){if(t instanceof Yt)return t.field.canonicalString()+t.op.toString()+Zo(t.value);if(Mk(t))return t.filters.map(e=>nm(e)).join(",");{const e=t.filters.map(r=>nm(r)).join(",");return`${t.op}(${e})`}}function Vk(t,e){return t instanceof Yt?function(n,s){return s instanceof Yt&&n.op===s.op&&n.field.isEqual(s.field)&&Is(n.value,s.value)}(t,e):t instanceof is?function(n,s){return s instanceof is&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&Vk(a,s.filters[o]),!0):!1}(t,e):void Fe(19439)}function Uk(t){return t instanceof Yt?function(r){return`${r.field.canonicalString()} ${r.op} ${Zo(r.value)}`}(t):t instanceof is?function(r){return r.op.toString()+" {"+r.getFilters().map(Uk).join(" ,")+"}"}(t):"Filter"}class RV extends Yt{constructor(e,r,n){super(e,r,n),this.key=Re.fromName(n.referenceValue)}matches(e){const r=Re.comparator(e.key,this.key);return this.matchesComparison(r)}}class NV extends Yt{constructor(e,r){super(e,"in",r),this.keys=Bk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class PV extends Yt{constructor(e,r){super(e,"not-in",r),this.keys=Bk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Bk(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Re.fromName(n.referenceValue))}class FV extends Yt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return t1(r)&&qc(r.arrayValue,this.value)}}class DV extends Yt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&qc(this.value.arrayValue,r)}}class OV extends Yt{constructor(e,r){super(e,"not-in",r)}matches(e){if(qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!qc(this.value.arrayValue,r)}}class bV extends Yt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!t1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>qc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function Ny(t,e=null,r=[],n=[],s=null,i=null,a=null){return new LV(t,e,r,n,s,i,a)}function r1(t){const e=Ve(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>nm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),m0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Zo(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Zo(n)).join(",")),e.Te=r}return e.Te}function n1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!IV(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Vk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ry(t.startAt,e.startAt)&&Ry(t.endAt,e.endAt)}function sm(t){return Re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MV(t,e,r,n,s,i,a,o){return new mu(t,e,r,n,s,i,a,o)}function s1(t){return new mu(t)}function Py(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jk(t){return t.collectionGroup!==null}function dc(t){const e=Ve(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new sr(mr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Fh(i,n))}),r.has(mr.keyField().canonicalString())||e.Ie.push(new Fh(mr.keyField(),n))}return e.Ie}function Es(t){const e=Ve(t);return e.Ee||(e.Ee=VV(e,dc(t))),e.Ee}function VV(t,e){if(t.limitType==="F")return Ny(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Fh(s.field,i)});const r=t.endAt?new Ph(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ph(t.startAt.position,t.startAt.inclusive):null;return Ny(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function im(t,e){const r=t.filters.concat([e]);return new mu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function am(t,e,r){return new mu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function x0(t,e){return n1(Es(t),Es(e))&&t.limitType===e.limitType}function zk(t){return`${r1(Es(t))}|lt:${t.limitType}`}function lo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Uk(s)).join(", ")}]`),m0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Zo(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Zo(s)).join(",")),`Target(${n})`}(Es(t))}; limitType=${t.limitType})`}function v0(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Re.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of dc(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=Cy(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,dc(n),s)||n.endAt&&!function(a,o,l){const c=Cy(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,dc(n),s))}(t,e)}function UV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function $k(t){return(e,r)=>{let n=!1;for(const s of dc(t)){const i=BV(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function BV(t,e,r){const n=t.field.isKeyField()?Re.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?Jo(l,c):Fe(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Fe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){sa(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return Sk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV=new Ft(Re.comparator);function ti(){return jV}const Hk=new Ft(Re.comparator);function $l(...t){let e=Hk;for(const r of t)e=e.insert(r.key,r);return e}function Wk(t){let e=Hk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function _a(){return pc()}function Gk(){return pc()}function pc(){return new Qa(t=>t.toString(),(t,e)=>t.isEqual(e))}const zV=new Ft(Re.comparator),$V=new sr(Re.comparator);function Xe(...t){let e=$V;for(const r of t)e=e.add(r);return e}const HV=new sr(qe);function WV(){return HV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ch(e)?"-0":e}}function Kk(t){return{integerValue:""+t}}function GV(t,e){return _V(e)?Kk(e):i1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(){this._=void 0}}function KV(t,e,r){return t instanceof Dh?function(s,i){const a={fields:{[Rk]:{stringValue:Ck},[Pk]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&e1(i)&&(i=g0(i)),i&&(a.fields[Nk]=i),{mapValue:a}}(r,e):t instanceof Xc?Xk(t,e):t instanceof Yc?Yk(t,e):function(s,i){const a=qk(s,i),o=Fy(a)+Fy(s.Ae);return rm(a)&&rm(s.Ae)?Kk(o):i1(s.serializer,o)}(t,e)}function qV(t,e,r){return t instanceof Xc?Xk(t,e):t instanceof Yc?Yk(t,e):r}function qk(t,e){return t instanceof Oh?function(n){return rm(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Dh extends _0{}class Xc extends _0{constructor(e){super(),this.elements=e}}function Xk(t,e){const r=Qk(e);for(const n of t.elements)r.some(s=>Is(s,n))||r.push(n);return{arrayValue:{values:r}}}class Yc extends _0{constructor(e){super(),this.elements=e}}function Yk(t,e){let r=Qk(e);for(const n of t.elements)r=r.filter(s=>!Is(s,n));return{arrayValue:{values:r}}}class Oh extends _0{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Fy(t){return Bt(t.integerValue||t.doubleValue)}function Qk(t){return t1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function XV(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Xc&&s instanceof Xc||n instanceof Yc&&s instanceof Yc?Qo(n.elements,s.elements,Is):n instanceof Oh&&s instanceof Oh?Is(n.Ae,s.Ae):n instanceof Dh&&s instanceof Dh}(t.transform,e.transform)}class YV{constructor(e,r){this.version=e,this.transformResults=r}}class bn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new bn}static exists(e){return new bn(void 0,e)}static updateTime(e){return new bn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Of(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class y0{}function Jk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new a1(t.key,bn.none()):new gu(t.key,t.data,bn.none());{const r=t.data,n=nn.empty();let s=new sr(mr.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new ia(t.key,n,new xn(s.toArray()),bn.none())}}function QV(t,e,r){t instanceof gu?function(s,i,a){const o=s.value.clone(),l=Oy(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ia?function(s,i,a){if(!Of(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Oy(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Zk(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function mc(t,e,r,n){return t instanceof gu?function(i,a,o,l){if(!Of(i.precondition,a))return o;const c=i.value.clone(),f=by(i.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof ia?function(i,a,o,l){if(!Of(i.precondition,a))return o;const c=by(i.fieldTransforms,l,a),f=a.data;return f.setAll(Zk(i)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return Of(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function JV(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=qk(n.transform,s||null);i!=null&&(r===null&&(r=nn.empty()),r.set(n.field,i))}return r||null}function Dy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Qo(n,s,(i,a)=>XV(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class gu extends y0{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ia extends y0{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Zk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Oy(t,e,r){const n=new Map;ot(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,qV(a,o,r[s]))}return n}function by(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,KV(i,a,e))}return n}class a1 extends y0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZV extends y0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&QV(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=mc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=mc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Gk();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=Jk(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Le.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&Qo(this.mutations,e.mutations,(r,n)=>Dy(r,n))&&Qo(this.baseMutations,e.baseMutations,(r,n)=>Dy(r,n))}}class o1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){ot(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return zV}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new o1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,Ze;function n7(t){switch(t){case re.OK:return Fe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Fe(15467,{code:t})}}function eS(t){if(t===void 0)return ei("GRPC error has no .code"),re.UNKNOWN;switch(t){case Gt.OK:return re.OK;case Gt.CANCELLED:return re.CANCELLED;case Gt.UNKNOWN:return re.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return re.INTERNAL;case Gt.UNAVAILABLE:return re.UNAVAILABLE;case Gt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Gt.NOT_FOUND:return re.NOT_FOUND;case Gt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Gt.ABORTED:return re.ABORTED;case Gt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Gt.DATA_LOSS:return re.DATA_LOSS;default:return Fe(39323,{code:t})}}(Ze=Gt||(Gt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7=new Ui([4294967295,4294967295],0);function Ly(t){const e=s7().encode(t),r=new mk;return r.update(e),new Uint8Array(r.digest())}function My(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ui([r,n],0),new Ui([s,i],0)]}class l1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Hl(`Invalid padding: ${r}`);if(n<0)throw new Hl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Hl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Hl(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ui.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Ui.fromNumber(n)));return s.compare(i7)===1&&(s=new Ui([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ly(e),[n,s]=My(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new l1(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=Ly(e),[n,s]=My(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,xu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new E0(Le.min(),s,new Ft(qe),ti(),Xe())}}class xu{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new xu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class tS{constructor(e,r){this.targetId=e,this.Ce=r}}class rS{constructor(e,r,n=yr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Vy{constructor(){this.ve=0,this.Fe=Uy(),this.Me=yr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),r=Xe(),n=Xe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Fe(38017,{changeType:i})}}),new xu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Uy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class a7{constructor(e){this.Ge=e,this.ze=new Map,this.je=ti(),this.Je=cf(),this.He=cf(),this.Ye=new Ft(qe)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Fe(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(sm(i))if(n===0){const a=new Re(i.path);this.et(r,a,Fr.newNoDocument(a,Le.min()))}else ot(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Xi(n).toUint8Array()}catch(l){if(l instanceof Ik)return Yo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new l1(a,s,i)}catch(l){return Yo(l instanceof Hl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const o=this.ot(a);if(o){if(i.current&&sm(o.target)){const l=new Re(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Fr.newNoDocument(l,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=Xe();this.He.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new E0(e,r,this.Ye,this.je,n);return this.je=ti(),this.Je=cf(),this.He=cf(),this.Ye=new Ft(qe),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Vy,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sr(qe),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sr(qe),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Se("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vy),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function cf(){return new Ft(Re.comparator)}function Uy(){return new Ft(Re.comparator)}const o7={asc:"ASCENDING",desc:"DESCENDING"},l7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},c7={and:"AND",or:"OR"};class u7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function om(t,e){return t.useProto3Json||m0(e)?e:{value:e}}function bh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function f7(t,e){return bh(t,e.toTimestamp())}function ws(t){return ot(!!t,49232),Le.fromTimestamp(function(r){const n=qi(r);return new wt(n.seconds,n.nanos)}(t))}function c1(t,e){return lm(t,e).canonicalString()}function lm(t,e){const r=function(s){return new xt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function sS(t){const e=xt.fromString(t);return ot(cS(e),10190,{key:e.toString()}),e}function cm(t,e){return c1(t.databaseId,e.path)}function Fd(t,e){const r=sS(e);if(r.get(1)!==t.databaseId.projectId)throw new Te(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Te(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Re(aS(r))}function iS(t,e){return c1(t.databaseId,e)}function h7(t){const e=sS(t);return e.length===4?xt.emptyPath():aS(e)}function um(t){return new xt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function aS(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function By(t,e,r){return{name:cm(t,e),fields:r.value.mapValue.fields}}function d7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Fe(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,f){return c.useProto3Json?(ot(f===void 0||typeof f=="string",58123),yr.fromBase64String(f||"")):(ot(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),yr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const f=c.code===void 0?re.UNKNOWN:eS(c.code);return new Te(f,c.message||"")}(a);r=new rS(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Fd(t,n.document.name),i=ws(n.document.updateTime),a=n.document.createTime?ws(n.document.createTime):Le.min(),o=new nn({mapValue:{fields:n.document.fields}}),l=Fr.newFoundDocument(s,i,a,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new bf(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Fd(t,n.document),i=n.readTime?ws(n.readTime):Le.min(),a=Fr.newNoDocument(s,i),o=n.removedTargetIds||[];r=new bf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Fd(t,n.document),i=n.removedTargetIds||[];r=new bf([],i,s,null)}else{if(!("filter"in e))return Fe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new r7(s,i),o=n.targetId;r=new tS(o,a)}}return r}function p7(t,e){let r;if(e instanceof gu)r={update:By(t,e.key,e.value)};else if(e instanceof a1)r={delete:cm(t,e.key)};else if(e instanceof ia)r={update:By(t,e.key,e.data),updateMask:T7(e.fieldMask)};else{if(!(e instanceof ZV))return Fe(16599,{Vt:e.type});r={verify:cm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof Dh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Xc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Yc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Oh)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Fe(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:f7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Fe(27497)}(t,e.precondition)),r}function m7(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?ws(s.updateTime):ws(i);return a.isEqual(Le.min())&&(a=ws(i)),new YV(a,s.transformResults||[])}(r,e))):[]}function g7(t,e){return{documents:[iS(t,e.path)]}}function x7(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=iS(t,s);const i=function(c){if(c.length!==0)return lS(is.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:co(d.field),direction:y7(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=om(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:s}}function v7(t){let e=h7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){ot(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(h){const d=oS(h);return d instanceof is&&Mk(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(x){return new Fh(uo(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,m0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,m=h.values||[];return new Ph(m,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,m=h.values||[];return new Ph(m,d)}(r.endAt)),MV(e,s,a,i,o,"F",l,c)}function _7(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fe(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function oS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=uo(r.unaryFilter.field);return Yt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=uo(r.unaryFilter.field);return Yt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=uo(r.unaryFilter.field);return Yt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=uo(r.unaryFilter.field);return Yt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Fe(61313);default:return Fe(60726)}}(t):t.fieldFilter!==void 0?function(r){return Yt.create(uo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Fe(58110);default:return Fe(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return is.create(r.compositeFilter.filters.map(n=>oS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Fe(1026)}}(r.compositeFilter.op))}(t):Fe(30097,{filter:t})}function y7(t){return o7[t]}function E7(t){return l7[t]}function w7(t){return c7[t]}function co(t){return{fieldPath:t.canonicalString()}}function uo(t){return mr.fromServerFormat(t.fieldPath)}function lS(t){return t instanceof Yt?function(r){if(r.op==="=="){if(Iy(r.value))return{unaryFilter:{field:co(r.field),op:"IS_NAN"}};if(Sy(r.value))return{unaryFilter:{field:co(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Iy(r.value))return{unaryFilter:{field:co(r.field),op:"IS_NOT_NAN"}};if(Sy(r.value))return{unaryFilter:{field:co(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:co(r.field),op:E7(r.op),value:r.value}}}(t):t instanceof is?function(r){const n=r.getFilters().map(s=>lS(s));return n.length===1?n[0]:{compositeFilter:{op:w7(r.op),filters:n}}}(t):Fe(54877,{filter:t})}function T7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function cS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,r,n,s,i=Le.min(),a=Le.min(),o=yr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ii(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e){this.yt=e}}function k7(t){const e=v7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?am(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(){this.Cn=new I7}addToCollectionParentIndex(e,r){return this.Cn.add(r),se.resolve()}getCollectionParents(e,r){return se.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return se.resolve()}deleteFieldIndex(e,r){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,r){return se.resolve()}getDocumentsMatchingTarget(e,r){return se.resolve(null)}getIndexType(e,r){return se.resolve(0)}getFieldIndexes(e,r){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,r){return se.resolve(Ki.min())}getMinOffsetFromCollectionGroup(e,r){return se.resolve(Ki.min())}updateCollectionGroup(e,r,n){return se.resolve()}updateIndexEntries(e,r){return se.resolve()}}class I7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new sr(xt.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new sr(xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uS=41943040;class tn{static withCacheSize(e){return new tn(e,tn.DEFAULT_COLLECTION_PERCENTILE,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tn.DEFAULT_COLLECTION_PERCENTILE=10,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tn.DEFAULT=new tn(uS,tn.DEFAULT_COLLECTION_PERCENTILE,tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tn.DISABLED=new tn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new el(0)}static cr(){return new el(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy="LruGarbageCollector",C7=1048576;function $y([t,e],[r,n]){const s=qe(t,r);return s===0?qe(e,n):s}class R7{constructor(e){this.Ir=e,this.buffer=new sr($y),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();$y(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class N7{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Se(zy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){dl(r)?Se(zy,"Ignoring IndexedDB error during garbage collection: ",r):await hl(r)}await this.Vr(3e5)})}}class P7{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return se.resolve(p0.ce);const n=new R7(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(jy)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jy):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,o,l,c;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,a=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),oo()<=Ke.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function F7(t,e){return new P7(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D7{constructor(){this.changes=new Qa(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Fr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?se.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&mc(n.mutation,s,xn.empty(),wt.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const s=_a();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=$l();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=_a();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=ti();const a=pc(),o=function(){return pc()}();return r.forEach((l,c)=>{const f=n.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof ia)?i=i.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),mc(f.mutation,c,f.mutation.getFieldMask(),wt.now())):a.set(c.key,xn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,f)=>a.set(c,f)),r.forEach((c,f)=>o.set(c,new O7(f,a.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=pc();let s=new Ft((a,o)=>a-o),i=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||xn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(s.get(o.batchId)||Xe()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=Gk();f.forEach(d=>{if(!i.has(d)){const m=Jk(r.get(d),n.get(d));m!==null&&h.set(d,m),i=i.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return se.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Re.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):jk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):se.resolve(_a());let o=Wc,l=i;return a.next(c=>se.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(f)?se.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Xe())).next(f=>({batchId:o,changes:Wk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Re(r)).next(n=>{let s=$l();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=$l();return this.indexManager.getCollectionParents(e,i).next(o=>se.forEach(o,l=>{const c=function(h,d){return new mu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,Fr.newInvalidDocument(f)))});let o=$l();return a.forEach((l,c)=>{const f=i.get(l);f!==void 0&&mc(f.mutation,c,xn.empty(),wt.now()),v0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return se.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ws(s.createTime)}}(r)),se.resolve()}getNamedQuery(e,r){return se.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:k7(s.bundledQuery),readTime:ws(s.readTime)}}(r)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M7{constructor(){this.overlays=new Ft(Re.comparator),this.qr=new Map}getOverlay(e,r){return se.resolve(this.overlays.get(r))}getOverlays(e,r){const n=_a();return se.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),se.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),se.resolve()}getOverlaysForCollection(e,r,n){const s=_a(),i=r.length+1,a=new Re(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return se.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Ft((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=i.get(c.largestBatchId);f===null&&(f=_a(),i=i.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=_a(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=s)););return se.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new t7(r,n));let i=this.qr.get(r);i===void 0&&(i=Xe(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(){this.sessionToken=yr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(){this.Qr=new sr(ar.$r),this.Ur=new sr(ar.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new ar(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new ar(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Re(new xt([])),n=new ar(r,e),s=new ar(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Re(new xt([])),n=new ar(r,e),s=new ar(r,e+1);let i=Xe();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new ar(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ar{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Re.comparator(e.key,r.key)||qe(e.Yr,r.Yr)}static Kr(e,r){return qe(e.Yr,r.Yr)||Re.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sr(ar.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new e7(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new ar(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(a)}lookupMutationBatch(e,r){return se.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?Zg:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ar(r,0),s=new ar(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const o=this.Xr(a.Yr);i.push(o)}),se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sr(qe);return r.forEach(s=>{const i=new ar(s,0),a=new ar(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],o=>{n=n.add(o.Yr)})}),se.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Re.isDocumentKey(i)||(i=i.child(""));const a=new ar(new Re(i),0);let o=new sr(qe);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)},a),se.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){ot(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return se.forEach(r.mutations,s=>{const i=new ar(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new ar(r,0),s=this.Zr.firstAfterOrEqual(n);return se.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e){this.ri=e,this.docs=function(){return new Ft(Re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return se.resolve(n?n.document.mutableCopy():Fr.newInvalidDocument(r))}getEntries(e,r){let n=ti();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Fr.newInvalidDocument(s))}),se.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=ti();const a=r.path,o=new Re(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||mV(pV(f),n)<=0||(s.has(f.key)||v0(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return se.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Fe(9500)}ii(e,r){return se.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new j7(this)}getSize(e){return se.resolve(this.size)}}class j7 extends D7{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),se.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z7{constructor(e){this.persistence=e,this.si=new Qa(r=>r1(r),n1),this.lastRemoteSnapshotVersion=Le.min(),this.highestTargetId=0,this.oi=0,this._i=new u1,this.targetCount=0,this.ai=el.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),se.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new el(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,se.resolve()}updateTargetData(e,r){return this.Pr(r),se.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(i).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return se.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),se.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),se.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),se.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return se.resolve(n)}containsKey(e,r){return se.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r){this.ui={},this.overlays={},this.ci=new p0(0),this.li=!1,this.li=!0,this.hi=new V7,this.referenceDelegate=e(this),this.Pi=new z7(this),this.indexManager=new S7,this.remoteDocumentCache=function(s){return new B7(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new A7(r),this.Ii=new L7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new M7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new U7(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Se("MemoryPersistence","Starting transaction:",e);const s=new $7(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return se.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class $7 extends xV{constructor(e){super(),this.currentSequenceNumber=e}}class f1{constructor(e){this.persistence=e,this.Ri=new u1,this.Vi=null}static mi(e){return new f1(e)}get fi(){if(this.Vi)return this.Vi;throw Fe(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),se.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),se.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,n=>{const s=Re.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,Le.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return se.or([()=>se.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Lh{constructor(e,r){this.persistence=e,this.pi=new Qa(n=>yV(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=F7(this,r)}static mi(e,r){return new Lh(e,r)}Ei(){}di(e){return se.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return se.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?se.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,i.removeEntry(a,Le.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Ff(e.data.value)),r}br(e,r,n){return se.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return se.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=Xe(),s=Xe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new h1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return x8()?8:vV(Vr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new H7;return this.Ss(e,r,a).next(o=>{if(i.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(oo()<=Ke.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",lo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(oo()<=Ke.DEBUG&&Se("QueryEngine","Query:",lo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(oo()<=Ke.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",lo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Es(r))):se.resolve())}ys(e,r){if(Py(r))return se.resolve(null);let n=Es(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=am(r,null,"F"),n=Es(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Xe(...i);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,a,l.readTime)?this.ys(e,am(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,s){return Py(r)||s.isEqual(Le.min())?se.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?se.resolve(null):(oo()<=Ke.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lo(r)),this.vs(e,a,r,dV(s,Wc)).next(o=>o))})}Ds(e,r){let n=new sr($k(e));return r.forEach((s,i)=>{v0(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return oo()<=Ke.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",lo(r)),this.ps.getDocumentsMatchingQuery(e,r,Ki.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1="LocalStore",G7=3e8;class K7{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Ft(qe),this.xs=new Qa(i=>r1(i),n1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new b7(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function q7(t,e,r,n){return new K7(t,e,r,n)}async function hS(t,e){const r=Ve(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=Xe();for(const c of s){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of i){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:a,addedBatchIds:o}))})})}function X7(t,e){const r=Ve(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let m=se.resolve();return d.forEach(x=>{m=m.next(()=>f.getEntry(l,x)).next(g=>{const w=c.docVersions.get(x);ot(w!==null,48541),g.version.compareTo(w)<0&&(h.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),f.addEntry(g)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function dS(t){const e=Ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function Y7(t,e){const r=Ve(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=s.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(i,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(i,f.addedDocuments,h)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(yr.EMPTY_BYTE_STRING,Le.min()).withLastLimboFreeSnapshotVersion(Le.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),s=s.insert(h,m),function(g,w,T){return g.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=G7?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,f)&&o.push(r.Pi.updateTargetData(i,m))});let l=ti(),c=Xe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),o.push(Q7(i,a,e.documentUpdates).next(f=>{l=f.ks,c=f.qs})),!n.isEqual(Le.min())){const f=r.Pi.getLastRemoteSnapshotVersion(i).next(h=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(f)}return se.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.Ms=s,i))}function Q7(t,e,r){let n=Xe(),s=Xe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=ti();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Le.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Se(d1,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:a,qs:s}})}function J7(t,e){const r=Ve(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Zg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Z7(t,e){const r=Ve(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,se.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new Ii(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function fm(t,e,r){const n=Ve(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!dl(a))throw a;Se(d1,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function Hy(t,e,r){const n=Ve(t);let s=Le.min(),i=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const h=Ve(l),d=h.xs.get(f);return d!==void 0?se.resolve(h.Ms.get(d)):h.Pi.getTargetData(c,f)}(n,a,Es(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:Le.min(),r?i:Xe())).next(o=>(eU(n,UV(e),o),{documents:o,Qs:i})))}function eU(t,e,r){let n=t.Os.get(e)||Le.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class Wy{constructor(){this.activeTargetIds=WV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tU{constructor(){this.Mo=new Wy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Wy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy="ConnectivityMonitor";class Ky{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Se(Gy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Se(Gy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uf=null;function hm(){return uf===null?uf=function(){return 268435456+Math.round(2147483648*Math.random())}():uf++,"0x"+uf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="RestConnection",nU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Rh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=hm(),o=this.zo(e,r.toUriEncodedString());Se(Dd,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(o),f=ll(c);return this.Jo(e,o,l,n,f).then(h=>(Se(Dd,`Received RPC '${e}' ${a}: `,h),h),h=>{throw Yo(Dd,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=nU[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="WebChannelConnection";class aU extends sU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=hm();return new Promise((o,l)=>{const c=new gk;c.setWithCredentials(!0),c.listenOnce(xk.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Pf.NO_ERROR:const h=c.getResponseJson();Se(Cr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case Pf.TIMEOUT:Se(Cr,`RPC '${e}' ${a} timed out`),l(new Te(re.DEADLINE_EXCEEDED,"Request time out"));break;case Pf.HTTP_ERROR:const d=c.getStatus();if(Se(Cr,`RPC '${e}' ${a} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const x=m==null?void 0:m.error;if(x&&x.status&&x.message){const g=function(T){const _=T.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(_)>=0?_:re.UNKNOWN}(x.status);l(new Te(g,x.message))}else l(new Te(re.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Te(re.UNAVAILABLE,"Connection failed."));break;default:Fe(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Se(Cr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(s);Se(Cr,`RPC '${e}' ${a} sending request:`,s),c.send(r,"POST",f,n,15)})}T_(e,r,n){const s=hm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=yk(),o=_k(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=i.join("");Se(Cr,`Creating RPC '${e}' stream ${s}: ${f}`,l);const h=a.createWebChannel(f,l);this.I_(h);let d=!1,m=!1;const x=new iU({Yo:w=>{m?Se(Cr,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(d||(Se(Cr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Se(Cr,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},Zo:()=>h.close()}),g=(w,T,_)=>{w.listen(T,v=>{try{_(v)}catch(D){setTimeout(()=>{throw D},0)}})};return g(h,zl.EventType.OPEN,()=>{m||(Se(Cr,`RPC '${e}' stream ${s} transport opened.`),x.o_())}),g(h,zl.EventType.CLOSE,()=>{m||(m=!0,Se(Cr,`RPC '${e}' stream ${s} transport closed`),x.a_(),this.E_(h))}),g(h,zl.EventType.ERROR,w=>{m||(m=!0,Yo(Cr,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),x.a_(new Te(re.UNAVAILABLE,"The operation could not be completed")))}),g(h,zl.EventType.MESSAGE,w=>{var T;if(!m){const _=w.data[0];ot(!!_,16349);const v=_,D=(v==null?void 0:v.error)||((T=v[0])==null?void 0:T.error);if(D){Se(Cr,`RPC '${e}' stream ${s} received error:`,D);const z=D.status;let B=function(k){const C=Gt[k];if(C!==void 0)return eS(C)}(z),y=D.message;B===void 0&&(B=re.INTERNAL,y="Unknown error status: "+z+" with message "+D.message),m=!0,x.a_(new Te(B,y)),h.close()}else Se(Cr,`RPC '${e}' stream ${s} received:`,_),x.u_(_)}}),g(o,vk.STAT_EVENT,w=>{w.stat===Zp.PROXY?Se(Cr,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===Zp.NOPROXY&&Se(Cr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Od(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(t){return new u7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="PersistentStream";class mS{constructor(e,r,n,s,i,a,o,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pS(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===re.RESOURCE_EXHAUSTED?(ei(r.toString()),ei("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Te(re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Se(qy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Se(qy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oU extends mS{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=d7(this.serializer,e),n=function(i){if(!("targetChange"in i))return Le.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Le.min():a.readTime?ws(a.readTime):Le.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=um(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=sm(l)?{documents:g7(i,l)}:{query:x7(i,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=nS(i,a.resumeToken);const c=om(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Le.min())>0){o.readTime=bh(i,a.snapshotVersion.toTimestamp());const c=om(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=_7(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=um(this.serializer),r.removeTarget=e,this.q_(r)}}class lU extends mS{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=m7(e.writeResults,e.commitTime),n=ws(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=um(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>p7(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{}class uU extends cU{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Te(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,lm(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(re.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,lm(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Te(re.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class fU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ei(r),this.aa=!1):Se("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="RemoteStore";class hU{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Ja(this)&&(Se(Ma,"Restarting streams for network reachability change."),await async function(l){const c=Ve(l);c.Ea.add(4),await vu(c),c.Ra.set("Unknown"),c.Ea.delete(4),await T0(c)}(this))})}),this.Ra=new fU(n,s)}}async function T0(t){if(Ja(t))for(const e of t.da)await e(!0)}async function vu(t){for(const e of t.da)await e(!1)}function gS(t,e){const r=Ve(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),x1(r)?g1(r):pl(r).O_()&&m1(r,e))}function p1(t,e){const r=Ve(t),n=pl(r);r.Ia.delete(e),n.O_()&&xS(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ja(r)&&r.Ra.set("Unknown"))}function m1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Le.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}pl(t).Y_(e)}function xS(t,e){t.Va.Ue(e),pl(t).Z_(e)}function g1(t){t.Va=new a7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),pl(t).start(),t.Ra.ua()}function x1(t){return Ja(t)&&!pl(t).x_()&&t.Ia.size>0}function Ja(t){return Ve(t).Ea.size===0}function vS(t){t.Va=void 0}async function dU(t){t.Ra.set("Online")}async function pU(t){t.Ia.forEach((e,r)=>{m1(t,e)})}async function mU(t,e){vS(t),x1(t)?(t.Ra.ha(e),g1(t)):t.Ra.set("Unknown")}async function gU(t,e,r){if(t.Ra.set("Online"),e instanceof rS&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){Se(Ma,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Mh(t,n)}else if(e instanceof bf?t.Va.Ze(e):e instanceof tS?t.Va.st(e):t.Va.tt(e),!r.isEqual(Le.min()))try{const n=await dS(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=i.Ia.get(c);f&&i.Ia.set(c,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const f=i.Ia.get(l);if(!f)return;i.Ia.set(l,f.withResumeToken(yr.EMPTY_BYTE_STRING,f.snapshotVersion)),xS(i,l);const h=new Ii(f.target,l,c,f.sequenceNumber);m1(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Se(Ma,"Failed to raise snapshot:",n),await Mh(t,n)}}async function Mh(t,e,r){if(!dl(e))throw e;t.Ea.add(1),await vu(t),t.Ra.set("Offline"),r||(r=()=>dS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Se(Ma,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await T0(t)})}function _S(t,e){return e().catch(r=>Mh(t,r,e))}async function A0(t){const e=Ve(t),r=Qi(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Zg;for(;xU(e);)try{const s=await J7(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,vU(e,s)}catch(s){await Mh(e,s)}yS(e)&&ES(e)}function xU(t){return Ja(t)&&t.Ta.length<10}function vU(t,e){t.Ta.push(e);const r=Qi(t);r.O_()&&r.X_&&r.ea(e.mutations)}function yS(t){return Ja(t)&&!Qi(t).x_()&&t.Ta.length>0}function ES(t){Qi(t).start()}async function _U(t){Qi(t).ra()}async function yU(t){const e=Qi(t);for(const r of t.Ta)e.ea(r.mutations)}async function EU(t,e,r){const n=t.Ta.shift(),s=o1.from(n,e,r);await _S(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await A0(t)}async function wU(t,e){e&&Qi(t).X_&&await async function(n,s){if(function(a){return n7(a)&&a!==re.ABORTED}(s.code)){const i=n.Ta.shift();Qi(n).B_(),await _S(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await A0(n)}}(t,e),yS(t)&&ES(t)}async function Xy(t,e){const r=Ve(t);r.asyncQueue.verifyOperationInProgress(),Se(Ma,"RemoteStore received new credentials");const n=Ja(r);r.Ea.add(3),await vu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await T0(r)}async function TU(t,e){const r=Ve(t);e?(r.Ea.delete(2),await T0(r)):e||(r.Ea.add(2),await vu(r),r.Ra.set("Unknown"))}function pl(t){return t.ma||(t.ma=function(r,n,s){const i=Ve(r);return i.sa(),new oU(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:dU.bind(null,t),t_:pU.bind(null,t),r_:mU.bind(null,t),H_:gU.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),x1(t)?g1(t):t.Ra.set("Unknown")):(await t.ma.stop(),vS(t))})),t.ma}function Qi(t){return t.fa||(t.fa=function(r,n,s){const i=Ve(r);return i.sa(),new lU(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:_U.bind(null,t),r_:wU.bind(null,t),ta:yU.bind(null,t),na:EU.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await A0(t)):(await t.fa.stop(),t.Ta.length>0&&(Se(Ma,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new v1(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _1(t,e){if(ei("AsyncQueue",`${e}: ${t}`),dl(t))return new Te(re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{static emptySet(e){return new Vo(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Re.comparator(r.key,n.key):(r,n)=>Re.comparator(r.key,n.key),this.keyedMap=$l(),this.sortedSet=new Ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Vo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(){this.ga=new Ft(Re.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Fe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class tl{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new tl(e,r,Vo.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&x0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class kU{constructor(){this.queries=Qy(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Ve(r),i=s.queries;s.queries=Qy(),i.forEach((a,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new Te(re.ABORTED,"Firestore shutting down"))}}function Qy(){return new Qa(t=>zk(t),x0)}async function wS(t,e){const r=Ve(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new AU,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=_1(a,`Initialization of query '${lo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&y1(r)}async function TS(t,e){const r=Ve(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function SU(t,e){const r=Ve(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&y1(r)}function IU(t,e,r){const n=Ve(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function y1(t){t.Ca.forEach(e=>{e.next()})}var dm,Jy;(Jy=dm||(dm={})).Ma="default",Jy.Cache="cache";class AS{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new tl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==dm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e){this.key=e}}class SS{constructor(e){this.key=e}}class CU{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=$k(e),this.tu=new Vo(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Yy,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,h)=>{const d=s.get(f),m=v0(this.query,h)?h:null,x=!!d&&this.mutatedKeys.has(d.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;d&&m?d.data.isEqual(m.data)?x!==g&&(n.track({type:3,doc:m}),w=!0):this.su(d,m)||(n.track({type:2,doc:m}),w=!0,(l&&this.eu(m,l)>0||c&&this.eu(m,c)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),w=!0):d&&!m&&(n.track({type:1,doc:d}),w=!0,(l||c)&&(o=!0)),w&&(m?(a=a.add(m),i=g?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,h)=>function(m,x){const g=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fe(20277,{Rt:w})}};return g(m)-g(x)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new tl(this.query,e.tu,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Yy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new SS(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new kS(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Xe();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return tl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const E1="SyncEngine";class RU{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class NU{constructor(e){this.key=e,this.hu=!1}}class PU{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Qa(o=>zk(o),x0),this.Iu=new Map,this.Eu=new Set,this.du=new Ft(Re.comparator),this.Au=new Map,this.Ru=new u1,this.Vu={},this.mu=new Map,this.fu=el.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FU(t,e,r=!0){const n=FS(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await IS(n,e,r,!0),s}async function DU(t,e){const r=FS(t);await IS(r,e,!0,!1)}async function IS(t,e,r,n){const s=await Z7(t.localStore,Es(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await OU(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&gS(t.remoteStore,s),o}async function OU(t,e,r,n,s){t.pu=(h,d,m)=>async function(g,w,T,_){let v=w.view.ru(T);v.Cs&&(v=await Hy(g.localStore,w.query,!1).then(({documents:y})=>w.view.ru(y,v)));const D=_&&_.targetChanges.get(w.targetId),z=_&&_.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(v,g.isPrimaryClient,D,z);return eE(g,w.targetId,B.au),B.snapshot}(t,h,d,m);const i=await Hy(t.localStore,e,!0),a=new CU(e,i.Qs),o=a.ru(i.documents),l=xu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);eE(t,r,c.au);const f=new RU(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function bU(t,e,r){const n=Ve(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!x0(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await fm(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&p1(n.remoteStore,s.targetId),pm(n,s.targetId)}).catch(hl)):(pm(n,s.targetId),await fm(n.localStore,s.targetId,!0))}async function LU(t,e){const r=Ve(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),p1(r.remoteStore,n.targetId))}async function MU(t,e,r){const n=HU(t);try{const s=await function(a,o){const l=Ve(a),c=wt.now(),f=o.reduce((m,x)=>m.add(x.key),Xe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let x=ti(),g=Xe();return l.Ns.getEntries(m,f).next(w=>{x=w,x.forEach((T,_)=>{_.isValidDocument()||(g=g.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,x)).next(w=>{h=w;const T=[];for(const _ of o){const v=JV(_,h.get(_.key).overlayedDocument);v!=null&&T.push(new ia(_.key,v,Ok(v.value.mapValue),bn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,T,o)}).next(w=>{d=w;const T=w.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(m,w.batchId,T)})}).then(()=>({batchId:d.batchId,changes:Wk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Ft(qe)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c}(n,s.batchId,r),await _u(n,s.changes),await A0(n.remoteStore)}catch(s){const i=_1(s,"Failed to persist write");r.reject(i)}}async function CS(t,e){const r=Ve(t);try{const n=await Y7(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(ot(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ot(a.hu,14607):s.removedDocuments.size>0&&(ot(a.hu,42227),a.hu=!1))}),await _u(r,n,e)}catch(n){await hl(n)}}function Zy(t,e,r){const n=Ve(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Ve(a);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(c=!0)}),c&&y1(l)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function VU(t,e,r){const n=Ve(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new Ft(Re.comparator);a=a.insert(i,Fr.newNoDocument(i,Le.min()));const o=Xe().add(i),l=new E0(Le.min(),new Map,new Ft(qe),a,o);await CS(n,l),n.du=n.du.remove(i),n.Au.delete(e),w1(n)}else await fm(n.localStore,e,!1).then(()=>pm(n,e,r)).catch(hl)}async function UU(t,e){const r=Ve(t),n=e.batch.batchId;try{const s=await X7(r.localStore,e);NS(r,n,null),RS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await _u(r,s)}catch(s){await hl(s)}}async function BU(t,e,r){const n=Ve(t);try{const s=await function(a,o){const l=Ve(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(ot(h!==null,37113),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);NS(n,e,r),RS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await _u(n,s)}catch(s){await hl(s)}}function RS(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function NS(t,e,r){const n=Ve(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function pm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||PS(t,n)})}function PS(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(p1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),w1(t))}function eE(t,e,r){for(const n of r)n instanceof kS?(t.Ru.addReference(n.key,e),jU(t,n)):n instanceof SS?(Se(E1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||PS(t,n.key)):Fe(19791,{wu:n})}function jU(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Se(E1,"New document in limbo: "+r),t.Eu.add(n),w1(t))}function w1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Re(xt.fromString(e)),n=t.fu.next();t.Au.set(n,new NU(r)),t.du=t.du.insert(r,n),gS(t.remoteStore,new Ii(Es(s1(r.path)),n,"TargetPurposeLimboResolution",p0.ce))}}async function _u(t,e,r){const n=Ve(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{a.push(n.pu(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=h1.As(l.targetId,c);i.push(h)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(l,c){const f=Ve(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>se.forEach(c,d=>se.forEach(d.Es,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>se.forEach(d.ds,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!dl(h))throw h;Se(d1,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const m=f.Ms.get(d),x=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(x);f.Ms=f.Ms.insert(d,g)}}}(n.localStore,i))}async function zU(t,e){const r=Ve(t);if(!r.currentUser.isEqual(e)){Se(E1,"User change. New user:",e.toKey());const n=await hS(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(o=>{o.forEach(l=>{l.reject(new Te(re.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await _u(r,n.Ls)}}function $U(t,e){const r=Ve(t),n=r.Au.get(e);if(n&&n.hu)return Xe().add(n.key);{let s=Xe();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const o=r.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function FS(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=CS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$U.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=VU.bind(null,e),e.Pu.H_=SU.bind(null,e.eventManager),e.Pu.yu=IU.bind(null,e.eventManager),e}function HU(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BU.bind(null,e),e}class Vh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=w0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return q7(this.persistence,new W7,e.initialUser,this.serializer)}Cu(e){return new fS(f1.mi,this.serializer)}Du(e){return new tU}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vh.provider={build:()=>new Vh};class WU extends Vh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){ot(this.persistence.referenceDelegate instanceof Lh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new N7(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?tn.withCacheSize(this.cacheSizeBytes):tn.DEFAULT;return new fS(n=>Lh.mi(n,r),this.serializer)}}class mm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Zy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=zU.bind(null,this.syncEngine),await TU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new kU}()}createDatastore(e){const r=w0(e.databaseInfo.databaseId),n=function(i){return new aU(i)}(e.databaseInfo);return function(i,a,o,l){return new uU(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new hU(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Zy(this.syncEngine,r,0),function(){return Ky.v()?new Ky:new rU}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,f){const h=new PU(s,i,a,o,l,c);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ve(s);Se(Ma,"RemoteStore shutting down."),i.Ea.add(5),await vu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}mm.provider={build:()=>new mm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ei("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="FirestoreClient";class GU{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Rr.UNAUTHENTICATED,this.clientId=Jg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Se(Ji,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Se(Ji,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=_1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function bd(t,e){t.asyncQueue.verifyOperationInProgress(),Se(Ji,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await hS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function tE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await KU(t);Se(Ji,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Xy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>Xy(e.remoteStore,s)),t._onlineComponents=e}async function KU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Se(Ji,"Using user provided OfflineComponentProvider");try{await bd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===re.FAILED_PRECONDITION||s.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Yo("Error using user provided cache. Falling back to memory cache: "+r),await bd(t,new Vh)}}else Se(Ji,"Using default OfflineComponentProvider"),await bd(t,new WU(void 0));return t._offlineComponents}async function OS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Se(Ji,"Using user provided OnlineComponentProvider"),await tE(t,t._uninitializedComponentsProvider._online)):(Se(Ji,"Using default OnlineComponentProvider"),await tE(t,new mm))),t._onlineComponents}function qU(t){return OS(t).then(e=>e.syncEngine)}async function bS(t){const e=await OS(t),r=e.eventManager;return r.onListen=FU.bind(null,e.syncEngine),r.onUnlisten=bU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=DU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=LU.bind(null,e.syncEngine),r}function XU(t,e,r={}){const n=new Gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const f=new DS({next:d=>{f.Nu(),a.enqueueAndForget(()=>TS(i,h));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Te(re.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&l&&l.source==="server"?c.reject(new Te(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new AS(s1(o.path),f,{includeMetadataChanges:!0,qa:!0});return wS(i,h)}(await bS(t),t.asyncQueue,e,r,n)),n.promise}function YU(t,e,r={}){const n=new Gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const f=new DS({next:d=>{f.Nu(),a.enqueueAndForget(()=>TS(i,h)),d.fromCache&&l.source==="server"?c.reject(new Te(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new AS(o,f,{includeMetadataChanges:!0,qa:!0});return wS(i,h)}(await bS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="firestore.googleapis.com",nE=!0;class sE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=MS,this.ssl=nE}else this.host=e.host,this.ssl=e.ssl??nE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=uS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<C7)throw new Te(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LS(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Te(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Te(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Te(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class k0{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new rV;switch(n.type){case"firstParty":return new aV(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=rE.get(r);n&&(Se("ComponentProvider","Removing Datastore"),rE.delete(r),n.terminate())}(this),Promise.resolve()}}function QU(t,e,r,n={}){var c;t=ss(t,k0);const s=ll(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(AA(`https://${o}`),kA("Firestore",!0)),i.host!==MS&&i.host!==o&&Yo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:s,emulatorOptions:n};if(!Gi(l,a)&&(t._setSettings(l),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=Rr.MOCK_USER;else{f=c8(n.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Te(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Rr(d)}t._authCredentials=new nV(new wk(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ml(this.firestore,e,this._query)}}class zt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zt(this.firestore,e,this._key)}toJSON(){return{type:zt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(pu(r,zt._jsonSchema))return new zt(e,n||null,new Re(xt.fromString(r.referencePath)))}}zt._jsonSchemaVersion="firestore/documentReference/1.0",zt._jsonSchema={type:Qt("string",zt._jsonSchemaVersion),referencePath:Qt("string")};class Bi extends ml{constructor(e,r,n){super(e,r,s1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zt(this.firestore,null,new Re(e))}withConverter(e){return new Bi(this.firestore,e,this._path)}}function gm(t,e,...r){if(t=$t(t),Tk("collection","path",e),t instanceof k0){const n=xt.fromString(e,...r);return xy(n),new Bi(t,null,n)}{if(!(t instanceof zt||t instanceof Bi))throw new Te(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xt.fromString(e,...r));return xy(n),new Bi(t.firestore,null,n)}}function ji(t,e,...r){if(t=$t(t),arguments.length===1&&(e=Jg.newId()),Tk("doc","path",e),t instanceof k0){const n=xt.fromString(e,...r);return gy(n),new zt(t,null,new Re(n))}{if(!(t instanceof zt||t instanceof Bi))throw new Te(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xt.fromString(e,...r));return gy(n),new zt(t.firestore,t instanceof Bi?t.converter:null,new Re(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="AsyncQueue";class aE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pS(this,"async_queue_retry"),this._c=()=>{const n=Od();n&&Se(iE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Od();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Od();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Gs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!dl(e))throw e;Se(iE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,ei("INTERNAL UNHANDLED ERROR: ",oE(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=v1.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Fe(47125,{Pc:oE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function oE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Za extends k0{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new aE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aE(e),this._firestoreClient=void 0,await e}}}function JU(t,e){const r=typeof t=="object"?t:zg(),n=typeof t=="string"?t:Rh,s=Xa(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=o8("firestore");i&&QU(s,...i)}return s}function T1(t){if(t._terminated)throw new Te(re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ZU(t),t._firestoreClient}function ZU(t){var n,s,i;const e=t._freezeSettings(),r=function(o,l,c,f){return new TV(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,LS(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new GU(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pn(yr.fromBase64String(e))}catch(r){throw new Te(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Pn(yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pu(e,Pn._jsonSchema))return Pn.fromBase64String(e.bytes)}}Pn._jsonSchemaVersion="firestore/bytes/1.0",Pn._jsonSchema={type:Qt("string",Pn._jsonSchemaVersion),bytes:Qt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Te(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Te(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Te(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ts._jsonSchemaVersion}}static fromJSON(e){if(pu(e,Ts._jsonSchema))return new Ts(e.latitude,e.longitude)}}Ts._jsonSchemaVersion="firestore/geoPoint/1.0",Ts._jsonSchema={type:Qt("string",Ts._jsonSchemaVersion),latitude:Qt("number"),longitude:Qt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:As._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pu(e,As._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new As(e.vectorValues);throw new Te(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}As._jsonSchemaVersion="firestore/vectorValue/1.0",As._jsonSchema={type:Qt("string",As._jsonSchemaVersion),vectorValues:Qt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eB=/^__.*__$/;class tB{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ia(e,this.data,this.fieldMask,r,this.fieldTransforms):new gu(e,this.data,r,this.fieldTransforms)}}class VS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ia(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function US(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fe(40011,{Ac:t})}}class k1{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new k1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Uh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(US(this.Ac)&&eB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rB{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||w0(e)}Cc(e,r,n,s=!1){return new k1({Ac:e,methodName:r,Dc:n,path:mr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function I0(t){const e=t._freezeSettings(),r=w0(t._databaseId);return new rB(t._databaseId,!!e.ignoreUndefinedProperties,r)}function BS(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);S1("Data must be an object, but it was:",a,n);const o=jS(n,a);let l,c;if(i.merge)l=new xn(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const h of i.mergeFields){const d=xm(e,h,r);if(!a.contains(d))throw new Te(re.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);$S(f,d)||f.push(d)}l=new xn(f),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new tB(new nn(o),l,c)}class C0 extends A1{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof C0}}function nB(t,e,r,n){const s=t.Cc(1,e,r);S1("Data must be an object, but it was:",s,n);const i=[],a=nn.empty();sa(n,(l,c)=>{const f=I1(e,l,r);c=$t(c);const h=s.yc(f);if(c instanceof C0)i.push(f);else{const d=yu(c,h);d!=null&&(i.push(f),a.set(f,d))}});const o=new xn(i);return new VS(a,o,s.fieldTransforms)}function sB(t,e,r,n,s,i){const a=t.Cc(1,e,r),o=[xm(e,n,r)],l=[s];if(i.length%2!=0)throw new Te(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(xm(e,i[d])),l.push(i[d+1]);const c=[],f=nn.empty();for(let d=o.length-1;d>=0;--d)if(!$S(c,o[d])){const m=o[d];let x=l[d];x=$t(x);const g=a.yc(m);if(x instanceof C0)c.push(m);else{const w=yu(x,g);w!=null&&(c.push(m),f.set(m,w))}}const h=new xn(c);return new VS(f,h,a.fieldTransforms)}function iB(t,e,r,n=!1){return yu(r,t.Cc(n?4:3,e))}function yu(t,e){if(zS(t=$t(t)))return S1("Unsupported field value:",e,t),jS(t,e);if(t instanceof A1)return function(n,s){if(!US(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=yu(o,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=$t(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return GV(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=wt.fromDate(n);return{timestampValue:bh(s.serializer,i)}}if(n instanceof wt){const i=new wt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:bh(s.serializer,i)}}if(n instanceof Ts)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Pn)return{bytesValue:nS(s.serializer,n._byteString)};if(n instanceof zt){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:c1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof As)return function(a,o){return{mapValue:{fields:{[Fk]:{stringValue:Dk},[Nh]:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return i1(o.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${d0(n)}`)}(t,e)}function jS(t,e){const r={};return Sk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):sa(t,(n,s)=>{const i=yu(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function zS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof wt||t instanceof Ts||t instanceof Pn||t instanceof zt||t instanceof A1||t instanceof As)}function S1(t,e,r){if(!zS(r)||!Ak(r)){const n=d0(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function xm(t,e,r){if((e=$t(e))instanceof S0)return e._internalPath;if(typeof e=="string")return I1(t,e);throw Uh("Field path arguments must be of type string or ",t,!1,void 0,r)}const aB=new RegExp("[~\\*/\\[\\]]");function I1(t,e,r){if(e.search(aB)>=0)throw Uh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new S0(...e.split("."))._internalPath}catch{throw Uh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Uh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new Te(re.INVALID_ARGUMENT,o+t+l)}function $S(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(C1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class oB extends HS{data(){return super.data()}}function C1(t,e){return typeof e=="string"?I1(t,e):e instanceof S0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class R1{}class cB extends R1{}function WS(t,e,...r){let n=[];e instanceof R1&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof N1).length,o=i.filter(l=>l instanceof R0).length;if(a>1||a>0&&o>0)throw new Te(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class R0 extends cB{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new R0(e,r,n)}_apply(e){const r=this._parse(e);return KS(e._query,r),new ml(e.firestore,e.converter,im(e._query,r))}_parse(e){const r=I0(e.firestore);return function(i,a,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Te(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){cE(h,f);const x=[];for(const g of h)x.push(lE(l,i,g));d={arrayValue:{values:x}}}else d=lE(l,i,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||cE(h,f),d=iB(o,a,h,f==="in"||f==="not-in");return Yt.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function GS(t,e,r){const n=e,s=C1("where",t);return R0._create(s,n,r)}class N1 extends R1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new N1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:is.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)KS(a,l),a=im(a,l)}(e._query,r),new ml(e.firestore,e.converter,im(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function lE(t,e,r){if(typeof(r=$t(r))=="string"){if(r==="")throw new Te(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jk(e)&&r.indexOf("/")!==-1)throw new Te(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(xt.fromString(r));if(!Re.isDocumentKey(n))throw new Te(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ky(t,new Re(n))}if(r instanceof zt)return ky(t,r._key);throw new Te(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${d0(r)}.`)}function cE(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function KS(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Te(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class uB{convertValue(e,r="none"){switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Xi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Fe(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return sa(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[Nh].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>Bt(a.doubleValue));return new As(r)}convertGeoPoint(e){return new Ts(Bt(e.latitude),Bt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=g0(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Gc(e));default:return null}}convertTimestamp(e){const r=qi(e);return new wt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=xt.fromString(e);ot(cS(n),9688,{name:e});const s=new Kc(n.get(1),n.get(3)),i=new Re(n.popFirst(5));return s.isEqual(r)||ei(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Wl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ka extends HS{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Lf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(C1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ka._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ka._jsonSchemaVersion="firestore/documentSnapshot/1.0",ka._jsonSchema={type:Qt("string",ka._jsonSchemaVersion),bundleSource:Qt("string","DocumentSnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class Lf extends ka{data(e={}){return super.data(e)}}class Uo{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Wl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Lf(this._firestore,this._userDataWriter,n.key,n,new Wl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Lf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Wl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Lf(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Wl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:fB(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Uo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t){t=ss(t,zt);const e=ss(t.firestore,Za);return XU(T1(e),t._key).then(r=>pB(e,t,r))}Uo._jsonSchemaVersion="firestore/querySnapshot/1.0",Uo._jsonSchema={type:Qt("string",Uo._jsonSchemaVersion),bundleSource:Qt("string","QuerySnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class YS extends uB{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new zt(this.firestore,null,r)}}function QS(t){t=ss(t,ml);const e=ss(t.firestore,Za),r=T1(e),n=new YS(e);return lB(t._query),YU(r,t._query).then(s=>new Uo(e,n,t,s))}function JS(t,e,r){t=ss(t,zt);const n=ss(t.firestore,Za),s=qS(t.converter,e);return N0(n,[BS(I0(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,bn.none())])}function hB(t,e,r,...n){t=ss(t,zt);const s=ss(t.firestore,Za),i=I0(s);let a;return a=typeof(e=$t(e))=="string"||e instanceof S0?sB(i,"updateDoc",t._key,e,r,n):nB(i,"updateDoc",t._key,e),N0(s,[a.toMutation(t._key,bn.exists(!0))])}function ZS(t){return N0(ss(t.firestore,Za),[new a1(t._key,bn.none())])}function dB(t,e){const r=ss(t.firestore,Za),n=ji(t),s=qS(t.converter,e);return N0(r,[BS(I0(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,bn.exists(!1))]).then(()=>n)}function N0(t,e){return function(n,s){const i=new Gs;return n.asyncQueue.enqueueAndForget(async()=>MU(await qU(n),s,i)),i.promise}(T1(t),e)}function pB(t,e,r){const n=r.docs.get(e._key),s=new YS(t);return new ka(t,s,e._key,n,new Wl(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){fl=s})(cl),Ss(new rs("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new Za(new sV(n.getProvider("auth-internal")),new oV(a,n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Te(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kc(c.options.projectId,f)}(a,s),a);return i={useFetchStreams:r,...i},o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),On(hy,dy,e),On(hy,dy,"esm2020")})();const eI="@firebase/installations",P1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=1e4,rI=`w:${P1}`,nI="FIS_v2",mB="https://firebaseinstallations.googleapis.com/v1",gB=60*60*1e3,xB="installations",vB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Va=new qa(xB,vB,_B);function sI(t){return t instanceof as&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI({projectId:t}){return`${mB}/projects/${t}/installations`}function aI(t){return{token:t.token,requestStatus:2,expiresIn:EB(t.expiresIn),creationTime:Date.now()}}async function oI(t,e){const n=(await e.json()).error;return Va.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function lI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function yB(t,{refreshToken:e}){const r=lI(t);return r.append("Authorization",wB(e)),r}async function cI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function EB(t){return Number(t.replace("s","000"))}function wB(t){return`${nI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TB({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=iI(t),s=lI(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={fid:r,authVersion:nI,appId:t.appId,sdkVersion:rI},o={method:"POST",headers:s,body:JSON.stringify(a)},l=await cI(()=>fetch(n,o));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:aI(c.authToken)}}else throw await oI("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kB=/^[cdef][\w-]{21}$/,vm="";function SB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=IB(t);return kB.test(r)?r:vm}catch{return vm}}function IB(t){return AB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=new Map;function hI(t,e){const r=P0(t);dI(r,e),CB(r,e)}function dI(t,e){const r=fI.get(t);if(r)for(const n of r)n(e)}function CB(t,e){const r=RB();r&&r.postMessage({key:t,fid:e}),NB()}let ya=null;function RB(){return!ya&&"BroadcastChannel"in self&&(ya=new BroadcastChannel("[Firebase] FID Change"),ya.onmessage=t=>{dI(t.data.key,t.data.fid)}),ya}function NB(){fI.size===0&&ya&&(ya.close(),ya=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PB="firebase-installations-database",FB=1,Ua="firebase-installations-store";let Ld=null;function F1(){return Ld||(Ld=PA(PB,FB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ua)}}})),Ld}async function Bh(t,e){const r=P0(t),s=(await F1()).transaction(Ua,"readwrite"),i=s.objectStore(Ua),a=await i.get(r);return await i.put(e,r),await s.done,(!a||a.fid!==e.fid)&&hI(t,e.fid),e}async function pI(t){const e=P0(t),n=(await F1()).transaction(Ua,"readwrite");await n.objectStore(Ua).delete(e),await n.done}async function F0(t,e){const r=P0(t),s=(await F1()).transaction(Ua,"readwrite"),i=s.objectStore(Ua),a=await i.get(r),o=e(a);return o===void 0?await i.delete(r):await i.put(o,r),await s.done,o&&(!a||a.fid!==o.fid)&&hI(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D1(t){let e;const r=await F0(t.appConfig,n=>{const s=DB(n),i=OB(t,s);return e=i.registrationPromise,i.installationEntry});return r.fid===vm?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function DB(t){const e=t||{fid:SB(),registrationStatus:0};return mI(e)}function OB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Va.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=bB(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:LB(t)}:{installationEntry:e}}async function bB(t,e){try{const r=await TB(t,e);return Bh(t.appConfig,r)}catch(r){throw sI(r)&&r.customData.serverCode===409?await pI(t.appConfig):await Bh(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function LB(t){let e=await uE(t.appConfig);for(;e.registrationStatus===1;)await uI(100),e=await uE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await D1(t);return n||r}return e}function uE(t){return F0(t,e=>{if(!e)throw Va.create("installation-not-found");return mI(e)})}function mI(t){return MB(t)?{fid:t.fid,registrationStatus:0}:t}function MB(t){return t.registrationStatus===1&&t.registrationTime+tI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VB({appConfig:t,heartbeatServiceProvider:e},r){const n=UB(t,r),s=yB(t,r),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={installation:{sdkVersion:rI,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(a)},l=await cI(()=>fetch(n,o));if(l.ok){const c=await l.json();return aI(c)}else throw await oI("Generate Auth Token",l)}function UB(t,{fid:e}){return`${iI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(t,e=!1){let r;const n=await F0(t.appConfig,i=>{if(!gI(i))throw Va.create("not-registered");const a=i.authToken;if(!e&&zB(a))return i;if(a.requestStatus===1)return r=BB(t,e),i;{if(!navigator.onLine)throw Va.create("app-offline");const o=HB(i);return r=jB(t,o),o}});return r?await r:n.authToken}async function BB(t,e){let r=await fE(t.appConfig);for(;r.authToken.requestStatus===1;)await uI(100),r=await fE(t.appConfig);const n=r.authToken;return n.requestStatus===0?O1(t,e):n}function fE(t){return F0(t,e=>{if(!gI(e))throw Va.create("not-registered");const r=e.authToken;return WB(r)?{...e,authToken:{requestStatus:0}}:e})}async function jB(t,e){try{const r=await VB(t,e),n={...e,authToken:r};return await Bh(t.appConfig,n),r}catch(r){if(sI(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await pI(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Bh(t.appConfig,n)}throw r}}function gI(t){return t!==void 0&&t.registrationStatus===2}function zB(t){return t.requestStatus===2&&!$B(t)}function $B(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+gB}function HB(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function WB(t){return t.requestStatus===1&&t.requestTime+tI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GB(t){const e=t,{installationEntry:r,registrationPromise:n}=await D1(e);return n?n.catch(console.error):O1(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KB(t,e=!1){const r=t;return await qB(r),(await O1(r,e)).token}async function qB(t){const{registrationPromise:e}=await D1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(t){if(!t||!t.options)throw Md("App Configuration");if(!t.name)throw Md("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw Md(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Md(t){return Va.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="installations",YB="installations-internal",QB=t=>{const e=t.getProvider("app").getImmediate(),r=XB(e),n=Xa(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},JB=t=>{const e=t.getProvider("app").getImmediate(),r=Xa(e,xI).getImmediate();return{getId:()=>GB(r),getToken:s=>KB(r,s)}};function ZB(){Ss(new rs(xI,QB,"PUBLIC")),Ss(new rs(YB,JB,"PRIVATE"))}ZB();On(eI,P1);On(eI,P1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh="analytics",ej="firebase_id",tj="origin",rj=60*1e3,nj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",b1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=new c0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},_n=new qa("analytics","Analytics",sj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(t){if(!t.startsWith(b1)){const e=_n.create("invalid-gtag-resource",{gtagURL:t});return cn.warn(e.message),""}return t}function vI(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function aj(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function oj(t,e){const r=aj("firebase-js-sdk-policy",{createScriptURL:ij}),n=document.createElement("script"),s=`${b1}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function lj(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function cj(t,e,r,n,s,i){const a=n[s];try{if(a)await e[a];else{const l=(await vI(r)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(o){cn.error(o)}t("config",s,i)}async function uj(t,e,r,n,s){try{let i=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const o=await vI(r);for(const l of a){const c=o.find(h=>h.measurementId===l),f=c&&e[c.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",n,s||{})}catch(i){cn.error(i)}}function fj(t,e,r,n){async function s(i,...a){try{if(i==="event"){const[o,l]=a;await uj(t,e,r,o,l)}else if(i==="config"){const[o,l]=a;await cj(t,e,r,n,o,l)}else if(i==="consent"){const[o,l]=a;t("consent",o,l)}else if(i==="get"){const[o,l,c]=a;t("get",o,l,c)}else if(i==="set"){const[o]=a;t("set",o)}else t(i,...a)}catch(o){cn.error(o)}}return s}function hj(t,e,r,n,s){let i=function(...a){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=fj(i,t,e,r),{gtagCore:i,wrappedGtag:window[s]}}function dj(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(b1)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=30,mj=1e3;class gj{constructor(e={},r=mj){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const _I=new gj;function xj(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function vj(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:xj(r)},s=nj.replace("{app-id}",e),i=await fetch(s,n);if(i.status!==200&&i.status!==304){let o="";try{const l=await i.json();(a=l.error)!=null&&a.message&&(o=l.error.message)}catch{}throw _n.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function _j(t,e=_I,r){const{appId:n,apiKey:s,measurementId:i}=t.options;if(!n)throw _n.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw _n.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new wj;return setTimeout(async()=>{o.abort()},rj),yI({appId:n,apiKey:s,measurementId:i},a,o,e)}async function yI(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=_I){var o;const{appId:i,measurementId:a}=t;try{await yj(n,e)}catch(l){if(a)return cn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:a};throw l}try{const l=await vj(t);return s.deleteThrottleMetadata(i),l}catch(l){const c=l;if(!Ej(c)){if(s.deleteThrottleMetadata(i),a)return cn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:a};throw l}const f=Number((o=c==null?void 0:c.customData)==null?void 0:o.httpStatus)===503?M_(r,s.intervalMillis,pj):M_(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return s.setThrottleMetadata(i,h),cn.debug(`Calling attemptFetch again in ${f} millis`),yI(t,h,n,s)}}function yj(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(i),n(_n.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ej(t){if(!(t instanceof as)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class wj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Tj(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const i=await e,a={...n,send_to:i};t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(){if(IA())try{await CA()}catch(t){return cn.warn(_n.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return cn.warn(_n.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function kj(t,e,r,n,s,i,a){const o=_j(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&cn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>cn.error(d)),e.push(o);const l=Aj().then(d=>{if(d)return n.getId()}),[c,f]=await Promise.all([o,l]);dj(i)||oj(i,c.measurementId),s("js",new Date);const h=(a==null?void 0:a.config)??{};return h[tj]="firebase",h.update=!0,f!=null&&(h[ej]=f),s("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.app=e}_delete(){return delete gc[this.app.options.appId],Promise.resolve()}}let gc={},hE=[];const dE={};let Vd="dataLayer",Ij="gtag",pE,EI,mE=!1;function Cj(){const t=[];if(SA()&&t.push("This is a browser extension environment."),v8()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=_n.create("invalid-analytics-context",{errorInfo:e});cn.warn(r.message)}}function Rj(t,e,r){Cj();const n=t.options.appId;if(!n)throw _n.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)cn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw _n.create("no-api-key");if(gc[n]!=null)throw _n.create("already-exists",{id:n});if(!mE){lj(Vd);const{wrappedGtag:i,gtagCore:a}=hj(gc,hE,dE,Vd,Ij);EI=i,pE=a,mE=!0}return gc[n]=kj(t,hE,dE,e,pE,Vd,r),new Sj(t)}function Nj(t=zg()){t=$t(t);const e=Xa(t,jh);return e.isInitialized()?e.getImmediate():Pj(t)}function Pj(t,e={}){const r=Xa(t,jh);if(r.isInitialized()){const s=r.getImmediate();if(Gi(e,r.getOptions()))return s;throw _n.create("already-initialized")}return r.initialize({options:e})}function Fj(t,e,r,n){t=$t(t),Tj(EI,gc[t.app.options.appId],e,r,n).catch(s=>cn.error(s))}const gE="@firebase/analytics",xE="0.10.18";function Dj(){Ss(new rs(jh,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Rj(n,s,r)},"PUBLIC")),Ss(new rs("analytics-internal",t,"PRIVATE")),On(gE,xE),On(gE,xE,"esm2020");function t(e){try{const r=e.getProvider(jh).getImmediate();return{logEvent:(n,s,i)=>Fj(r,n,s,i)}}catch(r){throw _n.create("interop-component-reg-failed",{reason:r})}}}Dj();const Oj={apiKey:"AIzaSyDA4Ia0fnlZ3NgQbCtWHQIeosBS0PUVLeo",authDomain:"centralteleoperadores.firebaseapp.com",projectId:"centralteleoperadores",storageBucket:"centralteleoperadores.firebasestorage.app",messagingSenderId:"260173879227",appId:"1:260173879227:web:80577712429c58d201969e",measurementId:"G-TLLE9RJBPM"},L1=FA(Oj),ff=J9(L1),ps=JU(L1);typeof window<"u"&&Nj(L1);const wI=He.createContext(),M1=()=>{const t=He.useContext(wI);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},bj=({children:t})=>{const[e,r]=He.useState(null),[n,s]=He.useState(!0),[i,a]=He.useState(null),o=async(h,d,m)=>{try{a(null);const x=await OM(ff,h,d);return m&&await MM(x.user,{displayName:m}),x.user}catch(x){throw a(x.message),x}},l=async(h,d)=>{try{return a(null),(await bM(ff,h,d)).user}catch(m){throw a(m.message),m}},c=async()=>{try{a(null),await jM(ff)}catch(h){throw a(h.message),h}};He.useEffect(()=>BM(ff,d=>{r(d),s(!1)}),[]);const f={user:e,loading:n,error:i,register:o,login:l,logout:c,clearError:()=>a(null)};return S.jsx(wI.Provider,{value:f,children:t})},ms={OPERATORS:"operators",ASSIGNMENTS:"assignments",CALL_DATA:"callData",USER_DATA:"userData"};let Qc=!1;const gs=(t,e)=>{if(t.code==="permission-denied")return Qc||(console.warn(" Firebase Firestore: Permisos insuficientes. La aplicacin funciona en modo demo."),console.info(" Para habilitar persistencia, configura Firestore siguiendo las instrucciones en FIREBASE_SETUP.md"),Qc=!0),null;if(t.code==="failed-precondition"&&t.message.includes("index"))return console.info(" Firebase est creando ndices necesarios. Usando datos locales temporalmente."),console.info(" Estado del ndice: https://console.firebase.google.com/project/centralteleoperadores/firestore/indexes"),null;throw console.error(`Error en ${e}:`,t),t},Ud={async create(t,e){try{return{id:(await dB(gm(ps,ms.OPERATORS),{...e,userId:t,createdAt:new Date,updatedAt:new Date})).id,...e}}catch(r){return gs(r,"crear operador")}},async getByUser(t){if(Qc)return[];try{const e=WS(gm(ps,ms.OPERATORS),GS("userId","==",t));return(await QS(e)).docs.map(s=>({id:s.id,...s.data()})).sort((s,i)=>{var l,c,f,h;const a=((c=(l=s.createdAt)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(0);return(((h=(f=i.createdAt)==null?void 0:f.toDate)==null?void 0:h.call(f))||new Date(0))-a})}catch(e){return gs(e,"obtener operadores")||[]}},async update(t,e){try{const r=ji(ps,ms.OPERATORS,t);return await hB(r,{...e,updatedAt:new Date}),!0}catch(r){return gs(r,"actualizar operador")}},async delete(t){try{return await ZS(ji(ps,ms.OPERATORS,t)),!0}catch(e){return gs(e,"eliminar operador")}}},hf={async saveOperatorAssignments(t,e,r){try{const n=ji(ps,ms.ASSIGNMENTS,`${t}_${e}`);return await JS(n,{userId:t,operatorId:e,assignments:r,updatedAt:new Date}),!0}catch(n){return gs(n,"guardar asignaciones")}},async getOperatorAssignments(t,e){try{const r=ji(ps,ms.ASSIGNMENTS,`${t}_${e}`),n=await XS(r);return n.exists()?n.data().assignments||[]:[]}catch(r){return gs(r,"obtener asignaciones")||[]}},async getAllUserAssignments(t){if(Qc)return{};try{const e=WS(gm(ps,ms.ASSIGNMENTS),GS("userId","==",t)),r=await QS(e),n={};return r.docs.forEach(s=>{const i=s.data();n[i.operatorId]=i.assignments||[]}),n}catch(e){return gs(e,"obtener todas las asignaciones")||{}}},async deleteOperatorAssignments(t,e){try{return await ZS(ji(ps,ms.ASSIGNMENTS,`${t}_${e}`)),!0}catch(r){return gs(r,"eliminar asignaciones")}}},vE={async saveCallData(t,e){try{const r=ji(ps,ms.CALL_DATA,t);return await JS(r,{userId:t,callData:e,updatedAt:new Date}),!0}catch(r){return gs(r,"guardar datos de llamadas")}},async getCallData(t){if(Qc)return[];try{const e=ji(ps,ms.CALL_DATA,t),r=await XS(e);return r.exists()?r.data().callData||[]:[]}catch(e){return gs(e,"obtener datos de llamadas")||[]}}},_E=t=>{let e;const r=new Set,n=(c,f)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const d=e;e=f??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(m=>m(e,d))}},s=()=>e,o={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,s,o);return o},Lj=t=>t?_E(t):_E,Mj=t=>t;function Vj(t,e=Mj){const r=Mf.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Mf.useDebugValue(r),r}const yE=t=>{const e=Lj(t),r=n=>Vj(e,n);return Object.assign(r,e),r},V1=t=>t?yE(t):yE;function D0(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var i;const a=l=>l===null?null:JSON.parse(l,void 0),o=(i=r.getItem(s))!=null?i:null;return o instanceof Promise?o.then(a):a(o)},setItem:(s,i)=>r.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>r.removeItem(s)}}const _m=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return _m(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return _m(n)(r)}}}},Uj=(t,e)=>(r,n,s)=>{let i={storage:D0(()=>localStorage),partialize:g=>g,version:0,merge:(g,w)=>({...w,...g}),...e},a=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,s);const f=()=>{const g=i.partialize({...n()});return c.setItem(i.name,{state:g,version:i.version})},h=s.setState;s.setState=(g,w)=>{h(g,w),f()};const d=t((...g)=>{r(...g),f()},n,s);s.getInitialState=()=>d;let m;const x=()=>{var g,w;if(!c)return;a=!1,o.forEach(_=>{var v;return _((v=n())!=null?v:d)});const T=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(g=n())!=null?g:d))||void 0;return _m(c.getItem.bind(c))(i.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==i.version){if(i.migrate){const v=i.migrate(_.state,_.version);return v instanceof Promise?v.then(D=>[!0,D]):[!0,v]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var v;const[D,z]=_;if(m=i.merge(z,(v=n())!=null?v:d),r(m,!0),D)return f()}).then(()=>{T==null||T(m,void 0),m=n(),a=!0,l.forEach(_=>_(m))}).catch(_=>{T==null||T(void 0,_)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(c=g.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},i.skipHydration||x(),m||d},U1=Uj;V1(U1((t,e)=>({user:null,isAuthenticated:!1,loading:!1,error:null,setUser:r=>{t({user:r,isAuthenticated:!!r,error:null})},setLoading:r=>{t({loading:r})},setError:r=>{t({error:r})},logout:()=>{t({user:null,isAuthenticated:!1,loading:!1,error:null})},updateUser:r=>{const n=e().user;n&&t({user:{...n,...r}})},getUserDisplayName:()=>{const{user:r}=e();return(r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"Usuario"},getUserEmail:()=>{const{user:r}=e();return(r==null?void 0:r.email)||""},isAdmin:()=>{const{user:r}=e();return(r==null?void 0:r.role)==="admin"||!1}}),{name:"user-storage",storage:D0(()=>localStorage),partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated})}));const TI=V1(U1((t,e)=>({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},isLoading:!1,lastUpdated:null,dataSource:null,filters:{dateRange:null,operator:null,status:"all",commune:null},setCallData:(r,n="excel")=>{const s=new Date().toISOString();t({callData:r,dataSource:n,lastUpdated:s,isLoading:!1}),e().analyzeCallData()},setLoading:r=>{t({isLoading:r})},analyzeCallData:()=>{const{callData:r}=e();if(!r||r.length===0){t({processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0}});return}const n=r.map(f=>({...f,duracion:parseInt(f.duracion)||0,isSuccessful:f.categoria==="exitosa"||f.result==="Llamado exitoso",fecha:f.fecha?new Date(f.fecha):new Date,hora:f.hora?parseInt(f.hora.split(":")[0]):null})),s=n.filter(f=>f.isSuccessful),i=new Set(n.map(f=>f.beneficiario||f.beneficiary)).size,a=n.reduce((f,h)=>f+(h.duracion||0),0),o=n.length>0?Math.round(a/n.length):0,l=n.length>0?Math.round(s.length/n.length*100):0,c={totalCalls:n.length,successfulCalls:s.length,failedCalls:n.length-s.length,averageDuration:o,uniqueBeneficiaries:i,protocolCompliance:l};t({processedData:n,callMetrics:c})},setFilters:r=>{t(n=>({filters:{...n.filters,...r}}))},getFilteredData:()=>{const{processedData:r,filters:n}=e();let s=[...r];if(n.operator&&n.operator!=="all"&&(s=s.filter(i=>i.operator===n.operator)),n.status&&n.status!=="all"&&(n.status==="successful"?s=s.filter(i=>i.isSuccessful):n.status==="failed"&&(s=s.filter(i=>!i.isSuccessful))),n.commune&&n.commune!=="all"&&(s=s.filter(i=>i.commune===n.commune)),n.dateRange){const{start:i,end:a}=n.dateRange;s=s.filter(o=>{const l=new Date(o.date);return l>=new Date(i)&&l<=new Date(a)})}return s},clearData:()=>{t({callData:[],processedData:[],callMetrics:{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},lastUpdated:null,dataSource:null})},getOperatorMetrics:(r=null)=>{const{processedData:n}=e();if(!r||typeof r!="object"){const i={},a=o=>!o||typeof o!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(o)||/^\d+$/.test(o)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(o)||!isNaN(Date.parse(o))||o.trim().length<3?!1:!!(o.trim().split(/\s+/).filter(c=>c.length>1).length>=2||/^[a-zA-Z\s\-\.]{3,}$/.test(o));return n.forEach(o=>{let l=o.operador||o.operator||o.teleoperadora||o.agente;(!a(l)||l===o.beneficiario||l===o.beneficiary)&&(l="No identificado"),l!=="No identificado"&&(/^\d{1,2}:\d{2}/.test(o.operador)||o.operador===o.beneficiario||o.operador===o.beneficiary)&&console.warn(` Operador problemtico detectado: "${o.operador}"  corregido a: "${l}" de llamada:`,{operadorOriginal:o.operador,beneficiario:o.beneficiario,operadorFinal:l}),i[l]||(i[l]={operador:l,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0});const c=i[l];c.totalLlamadas++,o.categoria==="exitosa"&&c.llamadasExitosas++,c.tiempoTotal+=o.duracion||0}),Object.values(i).forEach(o=>{o.promedioLlamada=o.totalLlamadas>0?Math.round(o.tiempoTotal/o.totalLlamadas):0}),Object.values(i)}const s={};try{Object.values(r).flat().forEach(i=>{i.operatorName&&!s[i.operatorName]&&(s[i.operatorName]={operador:i.operatorName,totalLlamadas:0,llamadasExitosas:0,tiempoTotal:0,promedioLlamada:0})})}catch(i){return console.warn("Error procesando operatorAssignments:",i),[]}return n.forEach(i=>{try{const a=Object.values(r).flat().find(o=>o.beneficiary===i.beneficiary);if(a&&s[a.operatorName]){const o=s[a.operatorName];o.totalLlamadas++,i.categoria==="exitosa"&&o.llamadasExitosas++,o.tiempoTotal+=i.duracion||0}}catch(a){console.warn("Error procesando call data:",a)}}),Object.values(s).forEach(i=>{i.promedioLlamada=i.totalLlamadas>0?Math.round(i.tiempoTotal/i.totalLlamadas):0}),Object.values(s)},getHourlyDistribution:()=>{const{processedData:r}=e(),n=Array.from({length:24},(s,i)=>({hour:i,calls:0}));return Array.isArray(r)&&r.forEach(s=>{try{let i=null;if(s.hora){const o=s.hora.toString().match(/^(\d{1,2})/);o&&(i=parseInt(o[1]))}else s.hour!==void 0&&(i=parseInt(s.hour));i!==null&&i>=0&&i<24&&n[i].calls++}catch(i){console.warn("Error procesando hora de llamada:",i)}}),n},getFollowUpData:r=>{const{processedData:n}=e(),s={};return n.forEach(i=>{const a=i.beneficiary;s[a]||(s[a]={beneficiary:a,calls:[],lastResult:i.result,lastDate:i.date}),s[a].calls.push(i),new Date(i.date)>new Date(s[a].lastDate)&&(s[a].lastResult=i.result,s[a].lastDate=i.date)}),Object.values(s).map(i=>{const a=r.find(c=>c.beneficiary===i.beneficiary);let o="pendiente",l="bg-yellow-100 text-yellow-800";return i.lastResult==="Llamado exitoso"?(o="al-dia",l="bg-green-100 text-green-800"):i.calls.length>3&&(o="urgente",l="bg-red-100 text-red-800"),{id:i.beneficiary,operator:a?a.operator:"Sin asignar",beneficiary:i.beneficiary,phone:a?a.phone:"N/A",commune:a?a.commune:"N/A",status:o,lastCall:i.lastDate,callCount:i.calls.length,colorClass:l}})},hasData:()=>{const{callData:r}=e();return r&&r.length>0},getSuccessRate:()=>{const{callMetrics:r}=e();return!r||!r.totalCalls||r.totalCalls===0?0:Math.round(r.successfulCalls/r.totalCalls*100)},getDataSummary:()=>{const{callMetrics:r,lastUpdated:n,dataSource:s}=e();return{...r,lastUpdated:n,dataSource:s,successRate:e().getSuccessRate()}}}),{name:"call-audit-storage",storage:D0(()=>localStorage),partialize:t=>({callData:t.callData,processedData:t.processedData,callMetrics:t.callMetrics,lastUpdated:t.lastUpdated,dataSource:t.dataSource,filters:t.filters})})),AI=V1(U1((t,e)=>({operators:[],operatorAssignments:{},activeTab:"dashboard",isLoading:!1,settings:{autoRefresh:!1,refreshInterval:3e4,defaultView:"dashboard"},setOperators:r=>{t({operators:r||[]})},addOperator:r=>{t(n=>({operators:[...n.operators,r]}))},updateOperator:(r,n)=>{t(s=>({operators:s.operators.map(i=>i.id===r?{...i,...n}:i)}))},removeOperator:r=>{t(n=>({operators:n.operators.filter(s=>s.id!==r),operatorAssignments:Object.fromEntries(Object.entries(n.operatorAssignments).filter(([s])=>s!==r))}))},setOperatorAssignments:r=>{t({operatorAssignments:r||{}})},updateOperatorAssignments:(r,n)=>{t(s=>({operatorAssignments:{...s.operatorAssignments,[r]:n}}))},clearOperatorAssignments:r=>{t(n=>{const s={...n.operatorAssignments};return delete s[r],{operatorAssignments:s}})},setActiveTab:r=>{t({activeTab:r})},setLoading:r=>{t({isLoading:r})},updateSettings:r=>{t(n=>({settings:{...n.settings,...r}}))},getOperatorById:r=>{const{operators:n}=e();return n.find(s=>s.id===r)||null},getOperatorAssignments:r=>{const{operatorAssignments:n}=e();return n[r]||[]},getAllAssignments:()=>{const{operatorAssignments:r,operators:n}=e(),s=[];return Object.entries(r).forEach(([i,a])=>{const o=n.find(l=>l.id===i);o&&a&&a.forEach(l=>{s.push({id:l.id,operator:o.name,beneficiary:l.beneficiary,phone:l.primaryPhone,commune:l.commune})})}),s},getTotalAssignments:()=>{const{operatorAssignments:r}=e();return Object.values(r).reduce((n,s)=>n+((s==null?void 0:s.length)||0),0)},clearAllData:()=>{t({operators:[],operatorAssignments:{},activeTab:"dashboard"})}}),{name:"app-storage",storage:D0(()=>localStorage),partialize:t=>({operators:t.operators,operatorAssignments:t.operatorAssignments,settings:t.settings})}));function Bj(){const{callData:t,callMetrics:e,processedData:r,isLoading:n,lastUpdated:s,dataSource:i,clearData:a,hasData:o,getSuccessRate:l,getOperatorMetrics:c,getHourlyDistribution:f}=TI(),{operators:h}=AI(),d=g=>{if(!g||isNaN(g))return"0:00";const w=Math.floor(g/60),T=g%60;return`${w}:${T.toString().padStart(2,"0")}`},m=g=>{if(!g)return"N/A";try{return new Date(g).toLocaleString()}catch{return"N/A"}},x=c?c():[];return f&&f(),S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[S.jsx(kf,{className:"w-6 h-6 text-blue-600"}),"Auditora Avanzada de Llamadas"]}),S.jsxs("p",{className:"text-gray-600",children:["Anlisis detallado y mtricas en tiempo real de todas las llamadas registradas en el sistema. Estado de datos: ",S.jsx("span",{className:"font-semibold",children:o&&o()?"Datos cargados":"Sin datos"}),s&&` | ltima actualizacin: ${m(s)}`]})]}),o&&o()&&S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[S.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Total Llamadas"}),S.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(e==null?void 0:e.totalCalls)||0})]}),S.jsx(Ls,{className:"w-8 h-8 text-blue-500"})]}),S.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Registros procesados"})]}),S.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Tasa de xito"}),S.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l?l():0,"%"]})]}),S.jsx(Lw,{className:"w-8 h-8 text-green-500"})]}),S.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Llamadas exitosas"})]}),S.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-purple-800 mb-1",children:"Operadores Activos"}),S.jsx("p",{className:"text-2xl font-bold text-purple-600",children:(x==null?void 0:x.length)||0})]}),S.jsx(di,{className:"w-8 h-8 text-purple-500"})]}),S.jsx("p",{className:"text-xs text-purple-600 mt-2",children:"Con actividad registrada"})]}),S.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-orange-800 mb-1",children:"Duracin Promedio"}),S.jsx("p",{className:"text-2xl font-bold text-orange-600",children:d((e==null?void 0:e.averageDuration)||0)})]}),S.jsx(Sf,{className:"w-8 h-8 text-orange-500"})]}),S.jsx("p",{className:"text-xs text-orange-600 mt-2",children:"Tiempo por llamada"})]})]}),(!o||!o())&&S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[S.jsx(bw,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),S.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No hay datos de auditora disponibles"}),S.jsx("p",{className:"text-gray-500 mb-4",children:'Sube un archivo Excel en la seccin "Registro de Llamadas" para comenzar el anlisis de auditora avanzada.'}),S.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:S.jsxs("p",{className:"text-blue-800 text-sm",children:[S.jsx("strong",{children:"Tip:"})," Una vez que subas datos, vers mtricas detalladas, anlisis por operador y distribucin temporal de llamadas."]})})]}),o&&o()&&S.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"text-sm text-gray-600",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Fuente de datos:"})," ",i||"Desconocida"]}),S.jsxs("p",{children:[S.jsx("strong",{children:"ltima actualizacin:"})," ",m(s)]})]}),a&&S.jsx("button",{onClick:a,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Limpiar Datos"})]})})]})}class EE extends Mf.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error capturado por ErrorBoundary:",e,r)}render(){return this.state.hasError?S.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 m-4",children:[S.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error en la aplicacin"}),S.jsx("p",{className:"text-red-600 mb-4",children:"Ha ocurrido un error inesperado. Por favor, recarga la pgina."}),S.jsxs("details",{className:"text-sm text-red-700",children:[S.jsx("summary",{className:"cursor-pointer",children:"Detalles tcnicos"}),S.jsx("pre",{className:"mt-2 whitespace-pre-wrap",children:this.state.error&&this.state.error.toString()})]}),S.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Recargar pgina"})]}):this.props.children}}const jj=()=>{const{user:t,logout:e}=M1(),{callData:r,processedData:n,callMetrics:s,setCallData:i,analyzeCallData:a,getOperatorMetrics:o,getHourlyDistribution:l,getFollowUpData:c,hasData:f}=TI(),{operators:h,operatorAssignments:d,activeTab:m,setOperators:x,setOperatorAssignments:g,setActiveTab:w,getAllAssignments:T}=AI(),[_,v]=He.useState("dashboard"),[D,z]=He.useState([]),[B,y]=He.useState([]),[A,k]=He.useState([]),[C,R]=He.useState("connecting"),[N,F]=He.useState({totalCalls:0,successfulCalls:0,failedCalls:0,beneficiaries:0,activeAssignments:0,operators:0,protocolCompliance:0,pendingFollowUps:0}),[Ee,he]=He.useState([]),[ke,ve]=He.useState([]),[ae,W]=He.useState("all"),[le,we]=He.useState(""),[L,K]=He.useState([]),[G,H]=He.useState(!1),[te,fe]=He.useState(null),[xe,de]=He.useState({name:"",email:"",phone:""}),[ie,Ue]=He.useState({}),[j,ht]=He.useState(null),$e=[{id:1,operator:"Mara Gonzlez",beneficiary:"Juan Prez",phone:"987654321",commune:"Santiago"},{id:2,operator:"Ana Rodrguez",beneficiary:"Carmen Silva",phone:"987654322",commune:"Valparaso"},{id:3,operator:"Luis Martnez",beneficiary:"Pedro Lpez",phone:"987654323",commune:"Concepcin"},{id:4,operator:"Mara Gonzlez",beneficiary:"Rosa Morales",phone:"987654324",commune:"Santiago"},{id:5,operator:"Ana Rodrguez",beneficiary:"Carlos Daz",phone:"987654325",commune:"Valparaso"}],Ge=He.useRef(!1),[Be,ge]=He.useState(!1);He.useEffect(()=>{t&&!Be&&!Ge.current&&gt()},[t,Be]),He.useEffect(()=>{D.length>0&&B.length>0&&(console.log(" Re-analizando datos tras actualizacin de asignaciones..."),a(D))},[B]);const gt=async()=>{if(!Ge.current){Ge.current=!0,R("connecting");try{const ne=await Ud.getByUser(t.uid);if(ne!==null){K(ne||[]);const Ie=await hf.getAllUserAssignments(t.uid);Ue(Ie||{});const Oe=await vE.getCallData(t.uid);z(Oe||[]),ur(Ie||{},ne||[]),Oe&&Oe.length>0?(console.log(" Analizando datos reales de llamadas..."),setTimeout(()=>a(Oe),100)):(console.log(" No hay datos de llamadas, inicializando mtricas por defecto..."),At()),R("connected"),ge(!0),console.log(" Conectado a Firebase - persistencia habilitada")}else throw new Error("Insufficient permissions")}catch{R("demo"),ge(!0),Er()}finally{Ge.current=!1}}},ur=(ne,Ie)=>{const Oe=[];Object.entries(ne).forEach(([Ne,ye])=>{const Qe=Ie.find(rt=>rt.id===Ne);Qe&&ye&&ye.forEach(rt=>{Oe.push({id:rt.id,operator:Qe.name,beneficiary:rt.beneficiary,phone:rt.primaryPhone,commune:rt.commune})})}),y(Oe)},Er=()=>{console.log(" Inicializando con datos de ejemplo..."),y($e),Qr(),At(),console.log(" Datos de ejemplo inicializados")},Qr=()=>{const Ie=[{id:"sample-1",name:"Mara Gonzlez",email:"maria.gonzalez@central.cl",phone:"987654321",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-2",name:"Ana Rodrguez",email:"ana.rodriguez@central.cl",phone:"987654322",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-3",name:"Luis Martnez",email:"luis.martinez@central.cl",phone:"987654323",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-4",name:"Carmen Torres",email:"carmen.torres@central.cl",phone:"987654324",userId:(t==null?void 0:t.uid)||"demo-user"},{id:"sample-5",name:"Pedro Snchez",email:"pedro.sanchez@central.cl",phone:"987654325",userId:(t==null?void 0:t.uid)||"demo-user"}].filter(Oe=>Oe&&Oe.id&&Oe.name);K(Ie)},Ns=async()=>{if(xe.name.trim()!=="")try{const ne=await Ud.create(t.uid,xe);K([...L,ne]),de({name:"",email:"",phone:""}),H(!1)}catch(ne){console.error("Error creating operator:",ne),alert("Error al crear teleoperador. Intenta nuevamente.")}},Jr=async ne=>{try{await Ud.delete(ne),await hf.deleteOperatorAssignments(t.uid,ne),K(L.filter(Ne=>Ne.id!==ne));const Ie={...ie};delete Ie[ne],Ue(Ie);const Oe=B.filter(Ne=>!Ne.id.toString().startsWith(`${ne}-`));y(Oe)}catch(Ie){console.error("Error deleting operator:",Ie),alert("Error al eliminar teleoperador. Intenta nuevamente.")}},Jt=(ne,Ie)=>{const Oe=ne.target.files[0];if(Oe){const Ne=new FileReader;Ne.onload=ye=>{const Qe=new Uint8Array(ye.target.result),rt=_h(Qe,{type:"array"}),ft=rt.SheetNames[0],kt=rt.Sheets[ft],Bn=D_.sheet_to_json(kt,{header:1});Zr(Bn,Ie)},Ne.readAsArrayBuffer(Oe)}ne.target.value=""},Zr=async(ne,Ie)=>{if(ne.length<2)return;const Oe=L.find(ye=>ye.id===Ie);if(!Oe)return;const Ne=ne.slice(1).map((ye,Qe)=>{const rt=ye[1]?String(ye[1]).split(/[\|\-\s]+/).filter(ft=>ft.trim().length===9):[];return{id:`${Ie}-${Qe}`,operatorId:Ie,operatorName:Oe.name,beneficiary:ye[0]||"",phones:rt,primaryPhone:rt[0]||"",commune:ye[2]||""}}).filter(ye=>ye.beneficiary&&ye.primaryPhone);try{await hf.saveOperatorAssignments(t.uid,Ie,Ne),Ue(Qe=>({...Qe,[Ie]:Ne}));const ye=Ne.map(Qe=>({id:Qe.id,operator:Qe.operatorName,beneficiary:Qe.beneficiary,phone:Qe.primaryPhone,commune:Qe.commune}));y(Qe=>[...Qe.filter(ft=>!ft.id.toString().startsWith(`${Ie}-`)),...ye]),ht(null)}catch(ye){console.error("Error saving assignments:",ye),alert("Error al guardar asignaciones. Intenta nuevamente.")}},dt=async ne=>{try{await hf.deleteOperatorAssignments(t.uid,ne);const Ie={...ie};delete Ie[ne],Ue(Ie),y(Oe=>Oe.filter(Ne=>!Ne.id.toString().startsWith(`${ne}-`)))}catch(Ie){console.error("Error clearing assignments:",Ie),alert("Error al limpiar asignaciones. Intenta nuevamente.")}},At=()=>{if(D.length>0){console.log(" Datos reales disponibles, omitiendo generacin de datos de ejemplo");return}console.log(" Generando datos de ejemplo...");const Ie=(L.length>0?L.map(ft=>ft.name):["Mara Gonzlez","Ana Rodrguez","Luis Martnez","Carmen Torres","Pedro Snchez"]).map(ft=>({operator:ft,totalCalls:Math.floor(Math.random()*50)+20,totalMinutes:Math.floor(Math.random()*500)+100,avgDuration:Math.floor(Math.random()*10)+3})),Oe=Array.from({length:24},(ft,kt)=>({hour:kt,calls:Math.floor(Math.random()*20)+1}));he(Ie),ve(Oe),F({totalCalls:150,successfulCalls:120,failedCalls:30,beneficiaries:85,activeAssignments:B.length||5,operators:L.length||5,protocolCompliance:85,pendingFollowUps:12});const Ne=["al-dia","pendiente","urgente"],ye={"al-dia":"bg-green-100 text-green-800",pendiente:"bg-yellow-100 text-yellow-800",urgente:"bg-red-100 text-red-800"},rt=(B.length>0?B:$e).map(ft=>({...ft,status:Ne[Math.floor(Math.random()*Ne.length)],lastCall:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString(),callCount:Math.floor(Math.random()*10)+1,colorClass:ye[Ne[Math.floor(Math.random()*Ne.length)]]}));k(rt)},Dt=ne=>{const Ie=ne.target.files[0];if(Ie){const Oe=new FileReader;Oe.onload=Ne=>{const ye=new Uint8Array(Ne.target.result),Qe=_h(ye,{type:"array"}),rt=Qe.SheetNames[0],ft=Qe.Sheets[rt],kt=D_.sheet_to_json(ft,{header:1});Br(kt)},Oe.readAsArrayBuffer(Ie)}},Br=async ne=>{if(ne.length<2)return;const Oe=(ye=>{const Qe=ye.slice(1,Math.min(6,ye.length)),rt=Je=>!Je||typeof Je!="string"||/^\d{1,2}:\d{2}(:\d{2})?$/.test(Je)||/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(Je)||!isNaN(Date.parse(Je))||/^\d+$/.test(Je)||Je.trim().length<3?!1:!!(Je.trim().split(/\s+/).filter(wr=>wr.length>1).length>=2||/^[a-zA-Z\s\-\.]+$/.test(Je)),ft={};for(let Je=0;Je<15;Je++){let jr=0;const wr=Qe.map(un=>un[Je]).filter(un=>un!=null);if(wr.length!==0){for(const un of wr)rt(String(un))&&jr++;jr>0&&(ft[Je]={score:jr,percentage:jr/wr.length*100,sampleValues:wr.slice(0,3)})}}console.log(" Anlisis de columnas para detectar operadores:",ft);let kt=7,Bn=0;for(const[Je,jr]of Object.entries(ft))(jr.score>Bn||jr.score===Bn&&jr.percentage>50)&&(Bn=jr.score,kt=parseInt(Je));return console.log(` Columna de operadores detectada: ${kt} (puntuacin: ${Bn})`),kt})(ne),Ne=ne.slice(1).map((ye,Qe)=>{Qe<3&&console.log(`Fila ${Qe}:`,{col0:ye[0],col1:ye[1],col2:ye[2],col3:ye[3],col4:ye[4],col5:ye[5],col6:ye[6],col7:ye[7],col8:ye[8],col9:ye[9],col10:ye[10],col11:ye[11],operadorDetectado:ye[Oe]});let rt=ye[Oe];if(rt&&/^\d{1,2}:\d{2}/.test(String(rt))){console.warn(` Valor de operador parece ser hora: "${rt}". Buscando en otras columnas...`);for(let ft=0;ft<ye.length;ft++){const kt=ye[ft];if(kt&&typeof kt=="string"&&!/^\d{1,2}:\d{2}/.test(kt)&&!/^\d+$/.test(kt)&&kt.trim().split(/\s+/).length>=2){rt=kt,console.log(` Operador encontrado en columna ${ft}: "${rt}"`);break}}}return{id:ye[0]||`call-${Qe}-${Date.now()}`,fecha:ye[1],beneficiario:ye[2],comuna:ye[3],tipo_llamada:ye[4]==="Entrante"?"entrante":"saliente",numero_cliente:ye[5],hora:ye[6]||"09:00:00",operador:rt||"No identificado",duracion:parseInt(ye[8])||0,categoria:ye[9]==="Llamado exitoso"?"exitosa":"fallida",resultado:ye[9],observacion:ye[10],apiId:ye[11]}});try{C==="connected"&&await vE.saveCallData(t.uid,Ne)&&console.log(" Datos de llamadas guardados en Firebase")}catch(ye){console.error("Error guardando datos en Firebase:",ye)}i(Ne,"excel"),console.log(` Procesados ${Ne.length} registros en Zustand`)},je=A.filter(ne=>{const Ie=ae==="all"||ne.status===ae,Oe=ne.beneficiary.toLowerCase().includes(le.toLowerCase())||ne.operator.toLowerCase().includes(le.toLowerCase());return Ie&&Oe}),it=({title:ne,value:Ie,subtitle:Oe,icon:Ne,trend:ye,color:Qe="blue"})=>S.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-sm text-gray-600 mb-1",children:ne}),S.jsx("p",{className:`text-2xl font-bold text-${Qe}-600 mb-1`,children:Ie}),S.jsx("p",{className:"text-xs text-gray-500",children:Oe})]}),S.jsxs("div",{className:"flex items-center",children:[S.jsx(Ne,{className:`w-8 h-8 text-${Qe}-500 mr-2`}),ye&&S.jsx("div",{className:`flex items-center ${ye>0?"text-green-500":"text-red-500"}`,children:ye>0?S.jsx(Lw,{className:"w-4 h-4"}):S.jsx(HR,{className:"w-4 h-4"})})]})]})}),Ht=()=>S.jsxs("div",{className:"w-64 bg-white shadow-lg h-full flex flex-col",children:[S.jsxs("div",{className:"p-6 flex-1",children:[S.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Mistatas - Seguimiento de llamadas"}),S.jsx("p",{className:"text-xs text-gray-500 mb-6",children:" 2025"}),S.jsxs("nav",{className:"space-y-2",children:[S.jsx(ut,{icon:kf,label:"Panel principal",active:_==="dashboard",onClick:()=>v("dashboard")}),S.jsx(ut,{icon:Ls,label:"Registro de Llamadas",active:_==="calls",onClick:()=>v("calls")}),S.jsx(ut,{icon:di,label:"Asignaciones",active:_==="assignments",onClick:()=>v("assignments")}),S.jsx(ut,{icon:Sf,label:"Historial de Seguimientos",active:_==="history",onClick:()=>v("history")}),S.jsx(ut,{icon:kf,label:"Auditora Avanzada",active:_==="audit",onClick:()=>v("audit")})]})]}),S.jsxs("div",{className:"p-6 border-t border-gray-200",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[S.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:S.jsx(Mw,{className:"w-5 h-5 text-blue-600"})}),S.jsxs("div",{className:"flex-1 min-w-0",children:[S.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(t==null?void 0:t.displayName)||"Usuario"}),S.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]}),S.jsxs("div",{className:"mb-4 p-2 rounded-lg bg-gray-50",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:`w-2 h-2 rounded-full ${C==="connected"?"bg-green-500":C==="connecting"?"bg-yellow-500":"bg-orange-500"}`}),S.jsx("span",{className:"text-xs text-gray-600",children:C==="connected"?"Firebase conectado":C==="connecting"?"Conectando...":"Modo demo"})]}),D.length>0&&S.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[D.length," llamadas cargadas"]})]}),S.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[S.jsx(OR,{className:"w-4 h-4"}),"Cerrar Sesin"]})]})]}),ut=({icon:ne,label:Ie,active:Oe,onClick:Ne})=>S.jsxs("button",{onClick:Ne,className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${Oe?"bg-blue-50 text-blue-600 border-l-4 border-blue-500":"text-gray-600 hover:bg-gray-50"}`,children:[S.jsx(ne,{className:"w-5 h-5 mr-3"}),S.jsx("span",{className:"text-sm",children:Ie})]}),An=()=>{const Ie=C==="connecting"?{color:"bg-yellow-50 border-yellow-200",icon:"",title:"Conectando...",message:"Conectando con Firebase para cargar datos"}:C==="connected"?D.length>0?{color:"bg-green-50 border-green-200",icon:"",title:"Datos reales activos",message:`Mostrando datos reales de ${D.length} llamadas registradas`}:{color:"bg-blue-50 border-blue-200",icon:"",title:"Firebase conectado - Sin datos de llamadas",message:"Conectado a Firebase. Sube un archivo Excel para ver datos reales"}:{color:"bg-orange-50 border-orange-200",icon:"",title:"Modo demostracin",message:"Mostrando datos de ejemplo. Configura Firebase para persistencia completa"},Oe=async()=>{C==="connected"&&(ge(!1),await gt())};return S.jsx("div",{className:`${Ie.color} border rounded-lg p-4 mb-6`,children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center",children:[S.jsx("span",{className:"text-lg mr-3",children:Ie.icon}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-gray-800",children:Ie.title}),S.jsx("p",{className:"text-sm text-gray-600",children:Ie.message})]})]}),C==="connected"&&S.jsx("button",{onClick:Oe,className:"px-3 py-1 text-xs bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",title:"Recargar datos desde Firebase",children:" Sincronizar"})]})})},ii=()=>{const ne=s||{totalCalls:0,successfulCalls:0,failedCalls:0,averageDuration:0,uniqueBeneficiaries:0,protocolCompliance:0},Ie=h.length,Oe=d?Object.keys(d).length:0;return S.jsxs("div",{className:"space-y-6",children:[S.jsx(An,{}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[S.jsx(it,{title:"Llamadas totales",value:ne.totalCalls,subtitle:"Anlisis en tiempo real con Zustand",icon:Ls,color:"blue"}),S.jsx(it,{title:"Llamadas exitosas",value:ne.successfulCalls,subtitle:"Llamadas con resultado exitoso",icon:Ls,trend:1,color:"green"}),S.jsx(it,{title:"Llamadas no exitosas",value:ne.failedCalls,subtitle:"No contestadas, fallidas u otro",icon:Ls,trend:-1,color:"red"}),S.jsx(it,{title:"Beneficiarios nicos",value:ne.uniqueBeneficiaries,subtitle:"Personas contactadas nicas",icon:di,color:"purple"})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[S.jsx(it,{title:"Asignaciones activas",value:Oe,subtitle:"Relaciones vigentes beneficiario-teleoperadora",icon:di,color:"blue"}),S.jsx(it,{title:"Teleoperadoras",value:Ie,subtitle:"Operadoras registradas en el sistema",icon:di,color:"blue"}),S.jsx(it,{title:"Cumplimiento de protocolo",value:`${ne.protocolCompliance}%`,subtitle:"Adherencia a procedimientos establecidos",icon:kf,color:"green"}),S.jsx(it,{title:"Duracin promedio",value:`${Math.round(ne.averageDuration/60)}min`,subtitle:"Tiempo promedio por llamada",icon:Sf,color:"orange"})]}),S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Mdulos principales"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[S.jsx(aa,{title:"Registro de Llamadas",description:"Sube historiales, analiza resultados y clasifica por beneficiario y teleoperadora.",icon:Ls,color:"green",onClick:()=>v("calls")}),S.jsx(aa,{title:"Asignaciones",description:"Gestiona relaciones entre beneficiarios y teleoperadoras.",icon:di,color:"blue",onClick:()=>v("assignments")}),S.jsx(aa,{title:"Historial de Seguimientos",description:"Clasifica beneficiarios por frecuencia y estado de contacto.",icon:Sf,color:"orange",onClick:()=>v("history")})]})]}),S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Detalle por Teleoperadora"}),S.jsx("div",{className:"overflow-x-auto",children:S.jsxs("table",{className:"w-full",children:[S.jsx("thead",{children:S.jsxs("tr",{className:"bg-gray-50",children:[S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Teleoperadora"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Cantidad de llamados"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Minutos totales"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Tiempo promedio"})]})}),S.jsxs("tbody",{children:[(o&&o()||[]).map((Ne,ye)=>S.jsxs("tr",{className:"border-b",children:[S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Ne.operador}),S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Ne.totalLlamadas}),S.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(Ne.tiempoTotal/60)," min"]}),S.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[Math.round(Ne.promedioLlamada/60)," min"]})]},ye)),(!o||o().length===0)&&S.jsx("tr",{children:S.jsx("td",{colSpan:"4",className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No hay datos de operadores disponibles. Sube un archivo Excel para ver las mtricas."})})]})]})})]})]})},aa=({title:ne,description:Ie,icon:Oe,color:Ne,onClick:ye})=>S.jsxs("div",{className:`bg-${Ne}-50 rounded-lg p-6 border border-${Ne}-200`,children:[S.jsx("div",{className:"flex items-center justify-center mb-4",children:S.jsx("div",{className:`w-16 h-16 bg-${Ne}-500 rounded-lg flex items-center justify-center`,children:S.jsx(Oe,{className:"w-8 h-8 text-white"})})}),S.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:ne}),S.jsx("p",{className:"text-sm text-gray-600 mb-4",children:Ie}),S.jsx("button",{onClick:ye,className:`w-full bg-${Ne}-500 text-white py-2 px-4 rounded-lg hover:bg-${Ne}-600 transition-colors`,children:"Entrar"})]}),gl=()=>S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registro de Llamadas"}),S.jsx("p",{className:"text-gray-600 mb-6",children:"Sube el archivo Excel con el registro de llamadas para realizar el anlisis automtico."}),S.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[S.jsx(Cv,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),S.jsxs("label",{className:"cursor-pointer",children:[S.jsx("span",{className:"text-blue-600 font-medium",children:"Seleccionar archivo Excel"}),S.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:Dt,className:"hidden"})]}),S.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Formatos soportados: .xlsx, .xls"})]})]}),D.length>0&&S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Datos Procesados"}),S.jsx("div",{className:"overflow-x-auto",children:S.jsxs("table",{className:"w-full",children:[S.jsx("thead",{children:S.jsxs("tr",{className:"bg-gray-50",children:[S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"ID"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Fecha"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Beneficiario"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Evento"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Resultado"}),S.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Duracin"})]})}),S.jsx("tbody",{children:D.slice(0,10).map((ne,Ie)=>S.jsxs("tr",{className:"border-b",children:[S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.id}),S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.date}),S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.beneficiary}),S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.event}),S.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:S.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ne.result==="Llamado exitoso"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ne.result})}),S.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[ne.duration,"s"]})]},Ie))})]})})]})]}),ai=()=>S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsxs("div",{className:"flex justify-between items-center mb-4",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold",children:"Gestin de Asignaciones"}),S.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona teleoperadores y sus asignaciones de beneficiarios"})]}),S.jsxs("button",{onClick:()=>H(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[S.jsx(Rv,{className:"w-4 h-4"}),"Crear Teleoperador"]})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[S.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-sm text-gray-600",children:"Total Teleoperadores"}),S.jsx("p",{className:"text-2xl font-bold text-blue-600",children:L.length})]}),S.jsx(di,{className:"w-8 h-8 text-blue-500"})]})}),S.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-sm text-gray-600",children:"Beneficiarios Asignados"}),S.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(ie).reduce((ne,Ie)=>ne+Ie.length,0)})]}),S.jsx(Ls,{className:"w-8 h-8 text-green-500"})]})}),S.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-sm text-gray-600",children:"Operadores con Asignaciones"}),S.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.keys(ie).length})]}),S.jsx(bw,{className:"w-8 h-8 text-purple-500"})]})})]})]}),G&&S.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:S.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[S.jsxs("div",{className:"flex justify-between items-center mb-4",children:[S.jsx("h4",{className:"text-lg font-semibold",children:"Crear Nuevo Teleoperador"}),S.jsx("button",{onClick:()=>H(!1),className:"text-gray-500 hover:text-gray-700",children:S.jsx(QR,{className:"w-5 h-5"})})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),S.jsx("input",{type:"text",value:xe.name,onChange:ne=>de({...xe,name:ne.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Mara Gonzlez"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),S.jsx("input",{type:"email",value:xe.email,onChange:ne=>de({...xe,email:ne.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"maria.gonzalez@central.cl"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),S.jsx("input",{type:"tel",value:xe.phone,onChange:ne=>de({...xe,phone:ne.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"987654321"})]})]}),S.jsxs("div",{className:"flex gap-3 mt-6",children:[S.jsxs("button",{onClick:Ns,disabled:!xe.name.trim(),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[S.jsx(UR,{className:"w-4 h-4"}),"Crear Teleoperador"]}),S.jsx("button",{onClick:()=>H(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})}),S.jsxs("div",{className:"space-y-4",children:[L.filter(ne=>ne&&ne.id).map(ne=>S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsxs("div",{className:"flex justify-between items-start mb-4",children:[S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[S.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:ne.name||"Operador sin nombre"}),ie[ne.id]&&S.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:[ie[ne.id].length," beneficiarios"]})]}),S.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[ne.email&&S.jsxs("p",{children:[" ",ne.email]}),ne.phone&&S.jsxs("p",{children:[" ",ne.phone]})]})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsxs("label",{className:"cursor-pointer bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[S.jsx(Cv,{className:"w-4 h-4"}),"Subir Excel",S.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:Ie=>Jt(Ie,ne.id),className:"hidden"})]}),ie[ne.id]&&S.jsxs("button",{onClick:()=>dt(ne.id),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-sm",children:[S.jsx(Iv,{className:"w-4 h-4"}),"Limpiar"]}),S.jsxs("button",{onClick:()=>Jr(ne.id),className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 text-sm",children:[S.jsx(Iv,{className:"w-4 h-4"}),"Eliminar"]})]})]}),S.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[S.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Formato Excel esperado:"}),S.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Columna A:"})," Nombre del beneficiario"]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Columna B:"})," Telfono(s) - separados por |, - o espacios (9 dgitos cada uno)"]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Columna C:"})," Comuna"]})]})]}),ie[ne.id]&&ie[ne.id].length>0&&S.jsxs("div",{className:"border-t pt-4",children:[S.jsxs("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:["Beneficiarios Asignados (",ie[ne.id].length,")"]}),S.jsx("div",{className:"overflow-x-auto",children:S.jsxs("table",{className:"w-full text-sm",children:[S.jsx("thead",{children:S.jsxs("tr",{className:"bg-gray-50",children:[S.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Beneficiario"}),S.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Telfono Principal"}),S.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Otros Telfonos"}),S.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Comuna"})]})}),S.jsxs("tbody",{children:[ie[ne.id].slice(0,5).map(Ie=>S.jsxs("tr",{className:"border-b",children:[S.jsx("td",{className:"px-3 py-2 text-gray-900",children:Ie.beneficiary}),S.jsx("td",{className:"px-3 py-2 text-gray-900",children:Ie.primaryPhone}),S.jsx("td",{className:"px-3 py-2 text-gray-600",children:Ie.phones.length>1?Ie.phones.slice(1).join(", "):"-"}),S.jsx("td",{className:"px-3 py-2 text-gray-900",children:Ie.commune})]},Ie.id)),ie[ne.id].length>5&&S.jsx("tr",{children:S.jsxs("td",{colSpan:"4",className:"px-3 py-2 text-center text-gray-500 text-sm",children:["... y ",ie[ne.id].length-5," beneficiarios ms"]})})]})]})})]})]},ne.id)),L.length===0&&S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[S.jsx(di,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),S.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay teleoperadores"}),S.jsx("p",{className:"text-gray-600 mb-4",children:"Crea tu primer teleoperador para comenzar a gestionar asignaciones"}),S.jsxs("button",{onClick:()=>H(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[S.jsx(Rv,{className:"w-4 h-4"}),"Crear Primer Teleoperador"]})]})]})]}),oa=()=>S.jsx("div",{className:"space-y-6",children:S.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[S.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historial de Seguimientos"}),S.jsx("p",{className:"text-gray-600 mb-6",children:"Clasifica beneficiarios por frecuencia y estado de contacto."}),S.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(PR,{className:"w-4 h-4 text-gray-400"}),S.jsxs("select",{value:ae,onChange:ne=>W(ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[S.jsx("option",{value:"all",children:"Todos los estados"}),S.jsx("option",{value:"al-dia",children:"Al da"}),S.jsx("option",{value:"pendiente",children:"Pendiente"}),S.jsx("option",{value:"urgente",children:"Urgente"})]})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(jR,{className:"w-4 h-4 text-gray-400"}),S.jsx("input",{type:"text",placeholder:"Buscar beneficiario o teleoperadora...",value:le,onChange:ne=>we(ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm"})]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:je.map(ne=>S.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[S.jsxs("div",{className:"flex items-start justify-between mb-2",children:[S.jsx("h4",{className:"font-medium text-gray-900",children:ne.beneficiary}),S.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ne.status==="al-dia"?"bg-green-100 text-green-800":ne.status==="pendiente"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ne.status==="al-dia"?"Al da":ne.status==="pendiente"?"Pendiente":"Urgente"})]}),S.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Teleoperadora: ",ne.operator]}),S.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["ltima llamada: ",ne.lastCall]}),S.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Total llamadas: ",ne.callCount]}),S.jsxs("p",{className:"text-sm text-gray-600",children:["Telfono: ",ne.phone]}),ne.status==="urgente"&&S.jsxs("div",{className:"mt-2 flex items-center text-red-600 text-sm",children:[S.jsx(Dp,{className:"w-4 h-4 mr-1"}),"Requiere atencin inmediata"]})]},ne.id))})]})});return S.jsxs("div",{className:"flex h-screen bg-gray-100",children:[S.jsx(Ht,{}),S.jsx("div",{className:"flex-1 overflow-auto",children:S.jsxs("div",{className:"p-6",children:[S.jsx("div",{className:"mb-6",children:S.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[_==="dashboard"&&"Panel principal",_==="calls"&&"Registro de Llamadas",_==="assignments"&&"Asignaciones",_==="history"&&"Historial de Seguimientos",_==="audit"&&"Auditora Avanzada"]})}),C==="demo"&&S.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(Dp,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),S.jsxs("div",{className:"flex-1",children:[S.jsx("h3",{className:"text-blue-800 font-medium",children:"Modo Local"}),S.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"La aplicacin funciona con datos locales. Para persistencia en la nube, completa la configuracin de Firebase."}),S.jsx("p",{className:"text-blue-600 text-xs mt-2",children:" Consulta FIREBASE_SETUP.md para instrucciones de configuracin"})]})]})}),C==="connecting"&&S.jsx("div",{className:"mb-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),S.jsx("span",{className:"text-slate-700 text-sm",children:"Verificando configuracin de Firebase..."})]})}),_==="dashboard"&&S.jsx(EE,{children:S.jsx(ii,{})}),_==="calls"&&S.jsx(gl,{}),_==="assignments"&&S.jsx(ai,{}),_==="history"&&S.jsx(oa,{}),_==="audit"&&S.jsx(EE,{children:S.jsx(Bj,{})})]})})]})},zj=()=>{const[t,e]=He.useState(!0),[r,n]=He.useState(!1),[s,i]=He.useState({email:"",password:"",confirmPassword:"",displayName:""}),[a,o]=He.useState(!1),{login:l,register:c,error:f,clearError:h}=M1(),d=w=>{const{name:T,value:_}=w.target;i(v=>({...v,[T]:_})),h()},m=async w=>{w.preventDefault(),o(!0);try{if(t)await l(s.email,s.password);else{if(s.password!==s.confirmPassword)throw new Error("Las contraseas no coinciden");if(s.password.length<6)throw new Error("La contrasea debe tener al menos 6 caracteres");if(!s.displayName.trim())throw new Error("El nombre es requerido");await c(s.email,s.password,s.displayName)}}catch(T){console.error("Error en autenticacin:",T)}finally{o(!1)}},x=()=>{e(!t),i({email:"",password:"",confirmPassword:"",displayName:""}),h()},g=w=>w?w.includes("user-not-found")?"Usuario no encontrado":w.includes("wrong-password")?"Contrasea incorrecta":w.includes("email-already-in-use")?"Este email ya est registrado":w.includes("weak-password")?"La contrasea es muy dbil":w.includes("invalid-email")?"Email invlido":w.includes("too-many-requests")?"Demasiados intentos. Intenta ms tarde":w:"";return S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:S.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[S.jsxs("div",{className:"text-center mb-8",children:[S.jsx("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:S.jsx(Ls,{className:"w-8 h-8 text-blue-600"})}),S.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),S.jsx("p",{className:"text-gray-600",children:t?"Inicia sesin en tu cuenta":"Crea tu cuenta nueva"})]}),f&&S.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[S.jsx(Dp,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error de autenticacin"}),S.jsx("p",{className:"text-red-600 text-sm mt-1",children:g(f)})]})]}),S.jsxs("form",{onSubmit:m,className:"space-y-6",children:[!t&&S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),S.jsxs("div",{className:"relative",children:[S.jsx(Mw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),S.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tu nombre completo",required:!t})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),S.jsxs("div",{className:"relative",children:[S.jsx(LR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),S.jsx("input",{type:"email",name:"email",value:s.email,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu@email.com",required:!0})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),S.jsxs("div",{className:"relative",children:[S.jsx(Sv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),S.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:d,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!0}),S.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?S.jsx(SR,{className:"w-5 h-5"}):S.jsx(CR,{className:"w-5 h-5"})})]})]}),!t&&S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar contrasea"}),S.jsxs("div",{className:"relative",children:[S.jsx(Sv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),S.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:d,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"",required:!t})]})]}),S.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:a?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),t?"Iniciando sesin...":"Creando cuenta..."]}):S.jsx(S.Fragment,{children:t?"Iniciar Sesin":"Crear Cuenta"})})]}),S.jsxs("div",{className:"mt-8 text-center",children:[S.jsx("p",{className:"text-gray-600",children:t?"No tienes cuenta?":"Ya tienes cuenta?"}),S.jsx("button",{onClick:x,className:"mt-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:t?"Crear cuenta nueva":"Iniciar sesin"})]}),S.jsx("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(TR,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Seguridad garantizada"}),S.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Tus datos estn protegidos con encriptacin de nivel empresarial mediante Firebase Authentication."})]})]})})]})})},$j=()=>S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg",children:S.jsx(Ls,{className:"w-10 h-10 text-blue-600 animate-pulse"})}),S.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mistatas - Seguimiento de llamadas"}),S.jsxs("div",{className:"flex items-center justify-center gap-2",children:[S.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),S.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),S.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),S.jsx("p",{className:"text-gray-600 mt-4",children:"Verificando autenticacin..."})]})}),Hj=()=>{const{user:t,loading:e}=M1();return e?S.jsx($j,{}):t?S.jsx(jj,{}):S.jsx(zj,{})};Bd.createRoot(document.getElementById("root")).render(S.jsx(Mf.StrictMode,{children:S.jsx(bj,{children:S.jsx(Hj,{})})}));
